Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.663302421569824
Epoch: 1, Steps: 1 | Train Loss: 1.463 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7984340190887451
Epoch: 2, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9951009750366211
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9885799884796143
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7707870006561279
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9613819122314453
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7873439788818359
Epoch: 7, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8357870578765869
Epoch: 8, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7839787006378174
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.8594620227813721
Epoch: 10, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8380630016326904
Epoch: 11, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.895611047744751
Epoch: 12, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8526825904846191
Epoch: 13, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7385754585266113
Epoch: 14, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8278787136077881
Epoch: 15, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8575558662414551
Epoch: 16, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9707174301147461
Epoch: 17, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9180667400360107
Epoch: 18, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.053 Vali Acc: 0.267 Test Loss: 1.053 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0153203010559082
Epoch: 19, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14951743
model size : 62.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.971480131149292
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8332254886627197
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7219302654266357
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7634487152099609
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8050565719604492
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9376449584960938
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.082496166229248
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.845536470413208
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7616479396820068
Epoch: 9, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7132487297058105
Epoch: 10, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8351466655731201
Epoch: 11, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0402767658233643
Epoch: 12, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7872114181518555
Epoch: 13, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.210658073425293
Epoch: 14, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8951435089111328
Epoch: 15, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.7266106605529785
Epoch: 16, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9856066703796387
Epoch: 17, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2920949459075928
Epoch: 18, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1273658275604248
Epoch: 19, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8728060722351074
Epoch: 20, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3599884510040283
Epoch: 21, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9924697875976562
Epoch: 22, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1313817501068115
Epoch: 23, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9076099395751953
Epoch: 24, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8513519763946533
Epoch: 25, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14850879
model size : 61.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2870683670043945
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.8161048889160156
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9399876594543457
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9473307132720947
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8548121452331543
Epoch: 5, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9981062412261963
Epoch: 6, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8710446357727051
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8039953708648682
Epoch: 8, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.0649724006652832
Epoch: 9, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7070343494415283
Epoch: 10, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7456684112548828
Epoch: 11, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9241311550140381
Epoch: 12, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.766610860824585
Epoch: 13, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7054593563079834
Epoch: 14, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7550821304321289
Epoch: 15, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.8664970397949219
Epoch: 16, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9288613796234131
Epoch: 17, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8833396434783936
Epoch: 18, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9511749744415283
Epoch: 19, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0002405643463135
Epoch: 20, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.948735237121582
Epoch: 21, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8278660774230957
Epoch: 22, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8260478973388672
Epoch: 23, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9033761024475098
Epoch: 24, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9218165874481201
Epoch: 25, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14750015
model size : 61.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5668275356292725
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8334569931030273
Epoch: 2, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8889214992523193
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7266750335693359
Epoch: 4, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9453978538513184
Epoch: 5, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8210313320159912
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9481396675109863
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8960423469543457
Epoch: 8, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0709261894226074
Epoch: 9, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9418566226959229
Epoch: 10, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.08015775680542
Epoch: 11, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.890822172164917
Epoch: 12, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.9445607662200928
Epoch: 13, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.962418794631958
Epoch: 14, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.112926721572876
Epoch: 15, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9537451267242432
Epoch: 16, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.065662145614624
Epoch: 17, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9986083507537842
Epoch: 18, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2498891353607178
Epoch: 19, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0316216945648193
Epoch: 20, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.144434928894043
Epoch: 21, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0495867729187012
Epoch: 22, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14649151
model size : 60.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2758824825286865
Epoch: 1, Steps: 1 | Train Loss: 1.332 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8802382946014404
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.9684298038482666
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8040707111358643
Epoch: 4, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9599292278289795
Epoch: 5, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9072051048278809
Epoch: 6, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0702786445617676
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8893730640411377
Epoch: 8, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9347057342529297
Epoch: 9, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1124365329742432
Epoch: 10, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.7950708866119385
Epoch: 11, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0085055828094482
Epoch: 12, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.130683422088623
Epoch: 13, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9746561050415039
Epoch: 14, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.178849458694458
Epoch: 15, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.016258716583252
Epoch: 16, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.0265953540802002
Epoch: 17, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1562273502349854
Epoch: 18, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0844361782073975
Epoch: 19, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2976031303405762
Epoch: 20, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8608527183532715
Epoch: 21, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0362746715545654
Epoch: 22, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0688281059265137
Epoch: 23, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.082759141921997
Epoch: 24, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8713815212249756
Epoch: 25, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.328 Vali Acc: 0.267 Test Loss: 1.328 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9830653667449951
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.382 Vali Acc: 0.267 Test Loss: 1.382 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 12587839
model size : 53.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.296297073364258
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9963297843933105
Epoch: 2, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8033037185668945
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9668848514556885
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8702535629272461
Epoch: 5, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8950276374816895
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.018075704574585
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1103734970092773
Epoch: 8, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9176125526428223
Epoch: 9, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.9659867286682129
Epoch: 10, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0239007472991943
Epoch: 11, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9538984298706055
Epoch: 12, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0436296463012695
Epoch: 13, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0290699005126953
Epoch: 14, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9651694297790527
Epoch: 15, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9192638397216797
Epoch: 16, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8133523464202881
Epoch: 17, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7492160797119141
Epoch: 18, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9618353843688965
Epoch: 19, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9596824645996094
Epoch: 20, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8694334030151367
Epoch: 21, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8639922142028809
Epoch: 22, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7724506855010986
Epoch: 23, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9407956600189209
Epoch: 24, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.002272129058838
Epoch: 25, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8149142265319824
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0847969055175781
Epoch: 27, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.391 Vali Acc: 0.333 Test Loss: 1.391 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12486975
model size : 52.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.923130512237549
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.91615891456604
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8436377048492432
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7469067573547363
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7341146469116211
Epoch: 5, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.757946252822876
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7570774555206299
Epoch: 7, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7794406414031982
Epoch: 8, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6625819206237793
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.9012770652770996
Epoch: 10, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.8381631374359131
Epoch: 11, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7768957614898682
Epoch: 12, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8926212787628174
Epoch: 13, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7527437210083008
Epoch: 14, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7446956634521484
Epoch: 15, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.687614917755127
Epoch: 16, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9339611530303955
Epoch: 17, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8703255653381348
Epoch: 18, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7354810237884521
Epoch: 19, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9081177711486816
Epoch: 20, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9774918556213379
Epoch: 21, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.8639225959777832
Epoch: 22, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.751274585723877
Epoch: 23, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7721617221832275
Epoch: 24, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.748140811920166
Epoch: 25, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7371020317077637
Epoch: 26, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.788264274597168
Epoch: 27, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7814202308654785
Epoch: 28, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8100697994232178
Epoch: 29, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8663458824157715
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7897377014160156
Epoch: 31, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 12386111
model size : 52.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.279062271118164
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.80619215965271
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8330082893371582
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8858060836791992
Epoch: 4, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.764240026473999
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8648819923400879
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9153375625610352
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8423845767974854
Epoch: 8, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7821018695831299
Epoch: 9, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6973385810852051
Epoch: 10, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9571647644042969
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.7336804866790771
Epoch: 12, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7059199810028076
Epoch: 13, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8752682209014893
Epoch: 14, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8902533054351807
Epoch: 15, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8894009590148926
Epoch: 16, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.879603385925293
Epoch: 17, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7872226238250732
Epoch: 18, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8413946628570557
Epoch: 19, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9729654788970947
Epoch: 20, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8407187461853027
Epoch: 21, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8873028755187988
Epoch: 22, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.783724308013916
Epoch: 23, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 12285247
model size : 51.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4306142330169678
Epoch: 1, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7622857093811035
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6739358901977539
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7628607749938965
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.837843656539917
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7866108417510986
Epoch: 6, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0100250244140625
Epoch: 7, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8069939613342285
Epoch: 8, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9498233795166016
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1331682205200195
Epoch: 10, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0999336242675781
Epoch: 11, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.9383296966552734
Epoch: 12, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8225674629211426
Epoch: 13, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.119455099105835
Epoch: 14, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9560463428497314
Epoch: 15, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8856406211853027
Epoch: 16, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.041184902191162
Epoch: 17, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.109043836593628
Epoch: 18, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9295263290405273
Epoch: 19, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1170001029968262
Epoch: 20, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1297314167022705
Epoch: 21, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11405887
model size : 48.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0208122730255127
Epoch: 1, Steps: 1 | Train Loss: 1.333 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9456558227539062
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8510122299194336
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9632852077484131
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9741995334625244
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7952752113342285
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8263332843780518
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7440810203552246
Epoch: 8, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8393440246582031
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8715569972991943
Epoch: 10, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7969157695770264
Epoch: 11, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8736615180969238
Epoch: 12, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8501284122467041
Epoch: 13, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8957624435424805
Epoch: 14, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.048 Vali Acc: 0.267 Test Loss: 1.048 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9969785213470459
Epoch: 15, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8426141738891602
Epoch: 16, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.815455436706543
Epoch: 17, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8752410411834717
Epoch: 18, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8916418552398682
Epoch: 19, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.8803830146789551
Epoch: 20, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.025 Vali Acc: 0.333 Test Loss: 1.025 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8551023006439209
Epoch: 21, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9505751132965088
Epoch: 22, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.906242847442627
Epoch: 23, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9712851047515869
Epoch: 24, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8560211658477783
Epoch: 25, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1298294067382812
Epoch: 26, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9372408390045166
Epoch: 27, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.347 Vali Acc: 0.267 Test Loss: 1.347 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9245264530181885
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.391 Vali Acc: 0.267 Test Loss: 1.391 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0423712730407715
Epoch: 29, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.384 Vali Acc: 0.333 Test Loss: 1.384 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11305023
model size : 48.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0793159008026123
Epoch: 1, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8662374019622803
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9314260482788086
Epoch: 3, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8224098682403564
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9782295227050781
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7928433418273926
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.840278148651123
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8270759582519531
Epoch: 8, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8407704830169678
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.776146650314331
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.8029193878173828
Epoch: 11, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8259556293487549
Epoch: 12, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7991504669189453
Epoch: 13, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9668622016906738
Epoch: 14, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.928257942199707
Epoch: 15, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9866492748260498
Epoch: 16, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0574183464050293
Epoch: 17, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9966943264007568
Epoch: 18, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.7902648448944092
Epoch: 19, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.7465081214904785
Epoch: 20, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8604629039764404
Epoch: 21, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2229785919189453
Epoch: 22, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9580540657043457
Epoch: 23, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8539161682128906
Epoch: 24, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.09967041015625
Epoch: 25, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.75455641746521
Epoch: 26, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.819347620010376
Epoch: 27, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8501772880554199
Epoch: 28, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9847514629364014
Epoch: 29, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11204159
model size : 47.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.930945873260498
Epoch: 1, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7198936939239502
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.727790355682373
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7433328628540039
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9398579597473145
Epoch: 5, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9152653217315674
Epoch: 6, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.0906708240509033
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9228923320770264
Epoch: 8, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8473272323608398
Epoch: 9, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7431018352508545
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9150550365447998
Epoch: 11, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8415260314941406
Epoch: 12, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9082856178283691
Epoch: 13, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7914273738861084
Epoch: 14, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7823684215545654
Epoch: 15, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9479773044586182
Epoch: 16, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11103295
model size : 47.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9945733547210693
Epoch: 1, Steps: 1 | Train Loss: 1.343 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8250889778137207
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.8563516139984131
Epoch: 3, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7616803646087646
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7714934349060059
Epoch: 5, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5985817909240723
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8430802822113037
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0708935260772705
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7419450283050537
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8668212890625
Epoch: 10, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8923215866088867
Epoch: 11, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9036684036254883
Epoch: 12, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.833324670791626
Epoch: 13, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7998306751251221
Epoch: 14, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8809444904327393
Epoch: 15, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7446928024291992
Epoch: 16, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7841901779174805
Epoch: 17, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8665633201599121
Epoch: 18, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9512770175933838
Epoch: 19, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8906805515289307
Epoch: 20, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8912086486816406
Epoch: 21, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1203906536102295
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10814911
model size : 46.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.200376272201538
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0439262390136719
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8638319969177246
Epoch: 3, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7936198711395264
Epoch: 4, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3434240818023682
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8447113037109375
Epoch: 6, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.0387914180755615
Epoch: 7, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9253745079040527
Epoch: 8, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7698924541473389
Epoch: 9, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7901904582977295
Epoch: 10, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9614622592926025
Epoch: 11, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8076522350311279
Epoch: 12, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.7228178977966309
Epoch: 13, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7428619861602783
Epoch: 14, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8734140396118164
Epoch: 15, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0954642295837402
Epoch: 16, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8454287052154541
Epoch: 17, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8651576042175293
Epoch: 18, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.7744169235229492
Epoch: 19, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9001243114471436
Epoch: 20, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8947334289550781
Epoch: 21, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8923094272613525
Epoch: 22, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7327749729156494
Epoch: 23, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8604156970977783
Epoch: 24, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7868030071258545
Epoch: 25, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9027304649353027
Epoch: 26, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9646987915039062
Epoch: 27, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9368445873260498
Epoch: 28, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 10714047
model size : 45.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7867677211761475
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8729140758514404
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7866458892822266
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.0039677619934082
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.1100401878356934
Epoch: 5, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9245531558990479
Epoch: 6, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7996630668640137
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.959341287612915
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.8735466003417969
Epoch: 9, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7670698165893555
Epoch: 10, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.8023779392242432
Epoch: 11, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.7605514526367188
Epoch: 12, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9306216239929199
Epoch: 13, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.8123064041137695
Epoch: 14, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7961475849151611
Epoch: 15, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7921092510223389
Epoch: 16, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 1.1129262447357178
Epoch: 17, Steps: 1 | Train Loss: 0.250 Vali Loss: 0.999 Vali Acc: 0.333 Test Loss: 0.999 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9994966983795166
Epoch: 18, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0498743057250977
Epoch: 19, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.162600040435791
Epoch: 20, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9243979454040527
Epoch: 21, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.041 Vali Acc: 0.267 Test Loss: 1.041 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8756921291351318
Epoch: 22, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8263702392578125
Epoch: 23, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.761237621307373
Epoch: 24, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8405907154083252
Epoch: 25, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8991079330444336
Epoch: 26, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.335 Vali Acc: 0.267 Test Loss: 1.335 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 10613183
model size : 45.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.914290189743042
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9332931041717529
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9068357944488525
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0662834644317627
Epoch: 4, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0391159057617188
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9939379692077637
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8178989887237549
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.004837989807129
Epoch: 8, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9729082584381104
Epoch: 9, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.9187469482421875
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9319989681243896
Epoch: 11, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7620487213134766
Epoch: 12, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8752713203430176
Epoch: 13, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8062846660614014
Epoch: 14, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9640762805938721
Epoch: 15, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.9074487686157227
Epoch: 16, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1402876377105713
Epoch: 17, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8908469676971436
Epoch: 18, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9996113777160645
Epoch: 19, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9275338649749756
Epoch: 20, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9216153621673584
Epoch: 21, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9667136669158936
Epoch: 22, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8240573406219482
Epoch: 23, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8146140575408936
Epoch: 24, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7837533950805664
Epoch: 25, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.226 Vali Acc: 0.467 Test Loss: 1.226 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 10512319
model size : 45.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0727345943450928
Epoch: 1, Steps: 1 | Train Loss: 1.557 Vali Loss: 1.320 Vali Acc: 0.333 Test Loss: 1.320 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8351211547851562
Epoch: 2, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6719796657562256
Epoch: 3, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.191 Vali Acc: 0.067 Test Loss: 1.191 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9462385177612305
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7366909980773926
Epoch: 5, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.225 Vali Acc: 0.133 Test Loss: 1.225 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7622616291046143
Epoch: 6, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8257031440734863
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.801060676574707
Epoch: 8, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7279727458953857
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.931265115737915
Epoch: 10, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.7375538349151611
Epoch: 11, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9479849338531494
Epoch: 12, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.7971236705780029
Epoch: 13, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8684396743774414
Epoch: 14, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7224626541137695
Epoch: 15, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7598938941955566
Epoch: 16, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0794682502746582
Epoch: 17, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.9112851619720459
Epoch: 18, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0953691005706787
Epoch: 19, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.846198558807373
Epoch: 20, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.88596510887146
Epoch: 21, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7723891735076904
Epoch: 22, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7830932140350342
Epoch: 23, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9509313106536865
Epoch: 24, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8537125587463379
Epoch: 25, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8872294425964355
Epoch: 26, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7975244522094727
Epoch: 27, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5121215
model size : 22.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.512251853942871
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9267728328704834
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9462265968322754
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8611307144165039
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7618231773376465
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.021195411682129
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1030898094177246
Epoch: 7, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8167417049407959
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9397573471069336
Epoch: 9, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9903922080993652
Epoch: 10, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7823214530944824
Epoch: 11, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8140401840209961
Epoch: 12, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.855283260345459
Epoch: 13, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.0203638076782227
Epoch: 14, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.8586390018463135
Epoch: 15, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.7155671119689941
Epoch: 16, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8976941108703613
Epoch: 17, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0619087219238281
Epoch: 18, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8361425399780273
Epoch: 19, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.8216381072998047
Epoch: 20, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9128148555755615
Epoch: 21, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8531584739685059
Epoch: 22, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7162468433380127
Epoch: 23, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8668067455291748
Epoch: 24, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8303091526031494
Epoch: 25, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8338327407836914
Epoch: 26, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.777421236038208
Epoch: 27, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7081770896911621
Epoch: 28, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.795177698135376
Epoch: 29, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5070783
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.008087158203125
Epoch: 1, Steps: 1 | Train Loss: 1.663 Vali Loss: 1.337 Vali Acc: 0.333 Test Loss: 1.337 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.88448166847229
Epoch: 2, Steps: 1 | Train Loss: 1.348 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.958674430847168
Epoch: 3, Steps: 1 | Train Loss: 1.374 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8366153240203857
Epoch: 4, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.170086145401001
Epoch: 5, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0418694019317627
Epoch: 6, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9768180847167969
Epoch: 7, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9459092617034912
Epoch: 8, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8884713649749756
Epoch: 9, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8090195655822754
Epoch: 10, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6956760883331299
Epoch: 11, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.7646276950836182
Epoch: 12, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7924935817718506
Epoch: 13, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9348752498626709
Epoch: 14, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0694963932037354
Epoch: 15, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9010052680969238
Epoch: 16, Steps: 1 | Train Loss: 0.755 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.814929723739624
Epoch: 17, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8642978668212891
Epoch: 18, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.821723222732544
Epoch: 19, Steps: 1 | Train Loss: 0.628 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8977804183959961
Epoch: 20, Steps: 1 | Train Loss: 0.553 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8872623443603516
Epoch: 21, Steps: 1 | Train Loss: 0.484 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8785226345062256
Epoch: 22, Steps: 1 | Train Loss: 0.475 Vali Loss: 0.981 Vali Acc: 0.400 Test Loss: 0.981 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0381300449371338
Epoch: 23, Steps: 1 | Train Loss: 0.470 Vali Loss: 0.963 Vali Acc: 0.667 Test Loss: 0.963 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 24 cost time: 0.8160264492034912
Epoch: 24, Steps: 1 | Train Loss: 0.331 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8831350803375244
Epoch: 25, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7366056442260742
Epoch: 26, Steps: 1 | Train Loss: 0.303 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.833233118057251
Epoch: 27, Steps: 1 | Train Loss: 0.231 Vali Loss: 0.950 Vali Acc: 0.533 Test Loss: 0.950 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9802474975585938
Epoch: 28, Steps: 1 | Train Loss: 0.224 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8443863391876221
Epoch: 29, Steps: 1 | Train Loss: 0.171 Vali Loss: 0.951 Vali Acc: 0.467 Test Loss: 0.951 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8370108604431152
Epoch: 30, Steps: 1 | Train Loss: 0.139 Vali Loss: 0.971 Vali Acc: 0.467 Test Loss: 0.971 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7184042930603027
Epoch: 31, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.001 Vali Acc: 0.333 Test Loss: 1.001 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7713344097137451
Epoch: 32, Steps: 1 | Train Loss: 0.091 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7442193031311035
Epoch: 33, Steps: 1 | Train Loss: 0.068 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 5020351
model size : 21.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.661886215209961
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8523142337799072
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7578639984130859
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8867204189300537
Epoch: 4, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.739774227142334
Epoch: 5, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.81534743309021
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8932907581329346
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9194035530090332
Epoch: 8, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7599658966064453
Epoch: 9, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.93998122215271
Epoch: 10, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8556652069091797
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6970257759094238
Epoch: 12, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7095174789428711
Epoch: 13, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.833702564239502
Epoch: 14, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6238751411437988
Epoch: 15, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8462779521942139
Epoch: 16, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7543790340423584
Epoch: 17, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.9695508480072021
Epoch: 18, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.7584586143493652
Epoch: 19, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8684442043304443
Epoch: 20, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8389186859130859
Epoch: 21, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.918931245803833
Epoch: 22, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9199647903442383
Epoch: 23, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9972426891326904
Epoch: 24, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.703563928604126
Epoch: 25, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8845481872558594
Epoch: 26, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8135106563568115
Epoch: 27, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7467870712280273
Epoch: 28, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4969919
model size : 21.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0571656227111816
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.8165104389190674
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8242895603179932
Epoch: 3, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7069647312164307
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7316668033599854
Epoch: 5, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8485982418060303
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9253110885620117
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8527102470397949
Epoch: 8, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7333722114562988
Epoch: 9, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7734229564666748
Epoch: 10, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8799824714660645
Epoch: 11, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6480896472930908
Epoch: 12, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9149763584136963
Epoch: 13, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.854198694229126
Epoch: 14, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3936959
model size : 17.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1496338844299316
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.0551831722259521
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.6511824131011963
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7276725769042969
Epoch: 4, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.6126973628997803
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.7113733291625977
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1226160526275635
Epoch: 7, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6907587051391602
Epoch: 8, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.6968889236450195
Epoch: 9, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6539363861083984
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8672399520874023
Epoch: 11, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.7746574878692627
Epoch: 12, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.8389339447021484
Epoch: 13, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8177850246429443
Epoch: 14, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8480367660522461
Epoch: 15, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.764763593673706
Epoch: 16, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.056 Vali Acc: 0.267 Test Loss: 1.056 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6913950443267822
Epoch: 17, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.051 Vali Acc: 0.267 Test Loss: 1.051 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8401377201080322
Epoch: 18, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.049 Vali Acc: 0.267 Test Loss: 1.049 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7551720142364502
Epoch: 19, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.049 Vali Acc: 0.267 Test Loss: 1.049 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8981099128723145
Epoch: 20, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.775301456451416
Epoch: 21, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6639559268951416
Epoch: 22, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.049 Vali Acc: 0.267 Test Loss: 1.049 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3886527
model size : 17.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9031763076782227
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7527565956115723
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5803358554840088
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6576638221740723
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7922689914703369
Epoch: 5, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6724896430969238
Epoch: 6, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.680051326751709
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7496147155761719
Epoch: 8, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8112995624542236
Epoch: 9, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7093877792358398
Epoch: 10, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6941723823547363
Epoch: 11, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.7822699546813965
Epoch: 12, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9431788921356201
Epoch: 13, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7388095855712891
Epoch: 14, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.7502405643463135
Epoch: 15, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7271716594696045
Epoch: 16, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8334264755249023
Epoch: 17, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8317079544067383
Epoch: 18, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6988945007324219
Epoch: 19, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7445077896118164
Epoch: 20, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.782045841217041
Epoch: 21, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7607433795928955
Epoch: 22, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.8464715480804443
Epoch: 23, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.819523811340332
Epoch: 24, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7623140811920166
Epoch: 25, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9660813808441162
Epoch: 26, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8376281261444092
Epoch: 27, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0324077606201172
Epoch: 28, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8915150165557861
Epoch: 29, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9363348484039307
Epoch: 30, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9084043502807617
Epoch: 31, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8874750137329102
Epoch: 32, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3836095
model size : 17.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0940728187561035
Epoch: 1, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7593700885772705
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8198704719543457
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8296689987182617
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.686272382736206
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7884180545806885
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6542189121246338
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6594259738922119
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7444736957550049
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7485511302947998
Epoch: 10, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7136120796203613
Epoch: 11, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7477679252624512
Epoch: 12, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6580865383148193
Epoch: 13, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2734687328338623
Epoch: 14, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7728533744812012
Epoch: 15, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.963451623916626
Epoch: 16, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.9704961776733398
Epoch: 17, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.9444756507873535
Epoch: 18, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8829984664916992
Epoch: 19, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9013571739196777
Epoch: 20, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6777439117431641
Epoch: 21, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.612311840057373
Epoch: 22, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7557973861694336
Epoch: 23, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0367145538330078
Epoch: 24, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0213143825531006
Epoch: 25, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8665874004364014
Epoch: 26, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7033064365386963
Epoch: 27, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3785663
model size : 17.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7376582622528076
Epoch: 1, Steps: 1 | Train Loss: 1.392 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6844840049743652
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9115793704986572
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.171 Vali Acc: 0.000 Test Loss: 1.171 Test Acc: 0.000
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9056460857391357
Epoch: 4, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.181 Vali Acc: 0.067 Test Loss: 1.181 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7560527324676514
Epoch: 5, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9654886722564697
Epoch: 6, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7602808475494385
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.163 Vali Acc: 0.067 Test Loss: 1.163 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7804107666015625
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7173607349395752
Epoch: 9, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7142791748046875
Epoch: 10, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9859392642974854
Epoch: 11, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 1.0228888988494873
Epoch: 12, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0541343688964844
Epoch: 13, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1362192630767822
Epoch: 14, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.8051705360412598
Epoch: 15, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.8107779026031494
Epoch: 16, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6812429428100586
Epoch: 17, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.817669153213501
Epoch: 18, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7897543907165527
Epoch: 19, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 1.018296480178833
Epoch: 20, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8898167610168457
Epoch: 21, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8968477249145508
Epoch: 22, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7767868041992188
Epoch: 23, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7897121906280518
Epoch: 24, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8464133739471436
Epoch: 25, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7765312194824219
Epoch: 26, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9508106708526611
Epoch: 27, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7911522388458252
Epoch: 28, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.080 Vali Acc: 0.200 Test Loss: 1.080 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8670580387115479
Epoch: 29, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3344831
model size : 15.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4710702896118164
Epoch: 1, Steps: 1 | Train Loss: 1.328 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7153444290161133
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8715956211090088
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7119481563568115
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6561267375946045
Epoch: 5, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6275942325592041
Epoch: 6, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7678990364074707
Epoch: 7, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8547561168670654
Epoch: 8, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7195820808410645
Epoch: 9, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8357458114624023
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.830808162689209
Epoch: 11, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6424846649169922
Epoch: 12, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7217385768890381
Epoch: 13, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.6594109535217285
Epoch: 14, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7317757606506348
Epoch: 15, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.678473949432373
Epoch: 16, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.6793668270111084
Epoch: 17, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.900763750076294
Epoch: 18, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.7090721130371094
Epoch: 19, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5673701763153076
Epoch: 20, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6752839088439941
Epoch: 21, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 1.0147368907928467
Epoch: 22, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8469679355621338
Epoch: 23, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6902031898498535
Epoch: 24, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7410976886749268
Epoch: 25, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.022 Vali Acc: 0.400 Test Loss: 1.022 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7071948051452637
Epoch: 26, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.739945650100708
Epoch: 27, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7395451068878174
Epoch: 28, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.714951753616333
Epoch: 29, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6435747146606445
Epoch: 30, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.6335394382476807
Epoch: 31, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.721442461013794
Epoch: 32, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8094232082366943
Epoch: 33, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6742384433746338
Epoch: 34, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7235002517700195
Epoch: 35, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8256511688232422
Epoch: 36, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.82275390625
Epoch: 37, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7870416641235352
Epoch: 38, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6796345710754395
Epoch: 39, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7498078346252441
Epoch: 40, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3294399
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1033225059509277
Epoch: 1, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6360478401184082
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8019914627075195
Epoch: 3, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8120589256286621
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.631072998046875
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6168501377105713
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6630961894989014
Epoch: 7, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7309093475341797
Epoch: 8, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6804111003875732
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6676323413848877
Epoch: 10, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6097118854522705
Epoch: 11, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9066216945648193
Epoch: 12, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.7556631565093994
Epoch: 13, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.708064079284668
Epoch: 14, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.7275066375732422
Epoch: 15, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7150139808654785
Epoch: 16, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7261571884155273
Epoch: 17, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6442093849182129
Epoch: 18, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6223366260528564
Epoch: 19, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7353060245513916
Epoch: 20, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6590893268585205
Epoch: 21, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.872929573059082
Epoch: 22, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.6072394847869873
Epoch: 23, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6601157188415527
Epoch: 24, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7434713840484619
Epoch: 25, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8233819007873535
Epoch: 26, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6862514019012451
Epoch: 27, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.686377763748169
Epoch: 28, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.753455400466919
Epoch: 29, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.671471118927002
Epoch: 30, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.686002254486084
Epoch: 31, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7693328857421875
Epoch: 32, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3243967
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.76953387260437
Epoch: 1, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.847813606262207
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9151482582092285
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7072503566741943
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9077680110931396
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8644282817840576
Epoch: 6, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7416763305664062
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8014588356018066
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7375268936157227
Epoch: 9, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0681440830230713
Epoch: 10, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.6752345561981201
Epoch: 11, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7293272018432617
Epoch: 12, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6702418327331543
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9254729747772217
Epoch: 14, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7421352863311768
Epoch: 15, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7813405990600586
Epoch: 16, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8627557754516602
Epoch: 17, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6644546985626221
Epoch: 18, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7631704807281494
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8450772762298584
Epoch: 20, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3193535
model size : 14.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8890552520751953
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7095663547515869
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6882128715515137
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.707360029220581
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6378295421600342
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.712160587310791
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9112801551818848
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.650820255279541
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.846156120300293
Epoch: 9, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8597927093505859
Epoch: 10, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.65340256690979
Epoch: 11, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7143211364746094
Epoch: 12, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8031723499298096
Epoch: 13, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.6768913269042969
Epoch: 14, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6655948162078857
Epoch: 15, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9836540222167969
Epoch: 16, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8125178813934326
Epoch: 17, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0261282920837402
Epoch: 18, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9226169586181641
Epoch: 19, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.8037214279174805
Epoch: 20, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7373323440551758
Epoch: 21, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8295462131500244
Epoch: 22, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0756521224975586
Epoch: 23, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.693732500076294
Epoch: 24, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7945370674133301
Epoch: 25, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7398219108581543
Epoch: 26, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6825222969055176
Epoch: 27, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7585604190826416
Epoch: 28, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7415816783905029
Epoch: 29, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0190720558166504
Epoch: 30, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8614187240600586
Epoch: 31, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9358067512512207
Epoch: 32, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9873745441436768
Epoch: 33, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3048767
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1994335651397705
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7483108043670654
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7204883098602295
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9812543392181396
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9808697700500488
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.029684066772461
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8071660995483398
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.997298002243042
Epoch: 8, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9424772262573242
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8970301151275635
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8479766845703125
Epoch: 11, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8942067623138428
Epoch: 12, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2998335
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.002436637878418
Epoch: 1, Steps: 1 | Train Loss: 1.368 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7323808670043945
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.8210792541503906
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7005810737609863
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8642761707305908
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6871211528778076
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8515908718109131
Epoch: 7, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7933018207550049
Epoch: 8, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8260524272918701
Epoch: 9, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8863458633422852
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8326807022094727
Epoch: 11, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6923155784606934
Epoch: 12, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.7817273139953613
Epoch: 13, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.7286574840545654
Epoch: 14, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 15 cost time: 0.6615192890167236
Epoch: 15, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0055720806121826
Epoch: 16, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0703752040863037
Epoch: 17, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8338940143585205
Epoch: 18, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.973015308380127
Epoch: 19, Steps: 1 | Train Loss: 0.587 Vali Loss: 0.992 Vali Acc: 0.667 Test Loss: 0.992 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 20 cost time: 0.8234024047851562
Epoch: 20, Steps: 1 | Train Loss: 0.515 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8434514999389648
Epoch: 21, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7746591567993164
Epoch: 22, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7422735691070557
Epoch: 23, Steps: 1 | Train Loss: 0.389 Vali Loss: 0.985 Vali Acc: 0.400 Test Loss: 0.985 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9021317958831787
Epoch: 24, Steps: 1 | Train Loss: 0.309 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7756774425506592
Epoch: 25, Steps: 1 | Train Loss: 0.245 Vali Loss: 0.963 Vali Acc: 0.667 Test Loss: 0.963 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.8948402404785156
Epoch: 26, Steps: 1 | Train Loss: 0.289 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8781449794769287
Epoch: 27, Steps: 1 | Train Loss: 0.223 Vali Loss: 0.996 Vali Acc: 0.333 Test Loss: 0.996 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7996020317077637
Epoch: 28, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8167645931243896
Epoch: 29, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7813799381256104
Epoch: 30, Steps: 1 | Train Loss: 0.131 Vali Loss: 0.972 Vali Acc: 0.467 Test Loss: 0.972 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8834071159362793
Epoch: 31, Steps: 1 | Train Loss: 0.104 Vali Loss: 0.969 Vali Acc: 0.533 Test Loss: 0.969 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7568154335021973
Epoch: 32, Steps: 1 | Train Loss: 0.103 Vali Loss: 0.987 Vali Acc: 0.333 Test Loss: 0.987 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8330144882202148
Epoch: 33, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.040 Vali Acc: 0.267 Test Loss: 1.040 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9639067649841309
Epoch: 34, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7511100769042969
Epoch: 35, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 2947903
model size : 13.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.780156135559082
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.7525599002838135
Epoch: 2, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6549737453460693
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8988680839538574
Epoch: 4, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.726057767868042
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6404433250427246
Epoch: 6, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.699744701385498
Epoch: 7, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6499874591827393
Epoch: 8, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7519774436950684
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8237948417663574
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7021942138671875
Epoch: 11, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2897471
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7688565254211426
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.750075101852417
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8216533660888672
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7623515129089355
Epoch: 4, Steps: 1 | Train Loss: 1.209 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8127849102020264
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0271050930023193
Epoch: 6, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8025426864624023
Epoch: 7, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7213020324707031
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7158617973327637
Epoch: 9, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7807705402374268
Epoch: 10, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.8706672191619873
Epoch: 11, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.7705223560333252
Epoch: 12, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.6382362842559814
Epoch: 13, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.7158675193786621
Epoch: 14, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.7431964874267578
Epoch: 15, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.681800365447998
Epoch: 16, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.8235907554626465
Epoch: 17, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.7655408382415771
Epoch: 18, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.796867847442627
Epoch: 19, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9050061702728271
Epoch: 20, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8048701286315918
Epoch: 21, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3010873794555664
Epoch: 22, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8602316379547119
Epoch: 23, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8296041488647461
Epoch: 24, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6557300090789795
Epoch: 25, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7558572292327881
Epoch: 26, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7417948246002197
Epoch: 27, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1975423
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.691025495529175
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7915382385253906
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7775576114654541
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7556095123291016
Epoch: 4, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8176901340484619
Epoch: 5, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0599987506866455
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7128374576568604
Epoch: 7, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9677457809448242
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9628522396087646
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1613085269927979
Epoch: 10, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7645056247711182
Epoch: 11, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1950207
model size : 8.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.546509265899658
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9676008224487305
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.84010910987854
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6960244178771973
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7128345966339111
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7514169216156006
Epoch: 6, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8751592636108398
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6686811447143555
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0994594097137451
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9207766056060791
Epoch: 10, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6227705478668213
Epoch: 11, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.6457953453063965
Epoch: 12, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7940325736999512
Epoch: 13, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.7324795722961426
Epoch: 14, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6563434600830078
Epoch: 15, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7380599975585938
Epoch: 16, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9432408809661865
Epoch: 17, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7519843578338623
Epoch: 18, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7823407649993896
Epoch: 19, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8023350238800049
Epoch: 20, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8623418807983398
Epoch: 21, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6961972713470459
Epoch: 22, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.023 Vali Acc: 0.333 Test Loss: 1.023 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7576243877410889
Epoch: 23, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 24 cost time: 0.6880555152893066
Epoch: 24, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6864800453186035
Epoch: 25, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.650191068649292
Epoch: 26, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6535630226135254
Epoch: 27, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7121572494506836
Epoch: 28, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7572720050811768
Epoch: 29, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8591125011444092
Epoch: 30, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8753786087036133
Epoch: 31, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6091792583465576
Epoch: 32, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7463855743408203
Epoch: 33, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1924991
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8781652450561523
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7712957859039307
Epoch: 2, Steps: 1 | Train Loss: 1.310 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6563613414764404
Epoch: 3, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7719476222991943
Epoch: 4, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.670123815536499
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6579723358154297
Epoch: 6, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.840355634689331
Epoch: 7, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7605617046356201
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6487112045288086
Epoch: 9, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.6720259189605713
Epoch: 10, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6586244106292725
Epoch: 11, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9917783737182617
Epoch: 12, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7650835514068604
Epoch: 13, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.8596940040588379
Epoch: 14, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.663306474685669
Epoch: 15, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.805884838104248
Epoch: 16, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6837344169616699
Epoch: 17, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8021812438964844
Epoch: 18, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6584494113922119
Epoch: 19, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6904866695404053
Epoch: 20, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6652686595916748
Epoch: 21, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.630375862121582
Epoch: 22, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6156375408172607
Epoch: 23, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1899775
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5255091190338135
Epoch: 1, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.9445066452026367
Epoch: 2, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7383630275726318
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6490330696105957
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9500198364257812
Epoch: 5, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7955820560455322
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9479858875274658
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7954106330871582
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.204071283340454
Epoch: 9, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8891217708587646
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8578977584838867
Epoch: 11, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7547543048858643
Epoch: 12, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6580562591552734
Epoch: 13, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7543139457702637
Epoch: 14, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.807523250579834
Epoch: 15, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0430305004119873
Epoch: 16, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8703138828277588
Epoch: 17, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8088886737823486
Epoch: 18, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9236857891082764
Epoch: 19, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.7916805744171143
Epoch: 20, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7759954929351807
Epoch: 21, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7178893089294434
Epoch: 22, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8354182243347168
Epoch: 23, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9641871452331543
Epoch: 24, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.099914789199829
Epoch: 25, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9034419059753418
Epoch: 26, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8963780403137207
Epoch: 27, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.7258355617523193
Epoch: 28, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8390078544616699
Epoch: 29, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1144890785217285
Epoch: 30, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.775404691696167
Epoch: 31, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9040853977203369
Epoch: 32, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9082937240600586
Epoch: 33, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7741658687591553
Epoch: 34, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8590478897094727
Epoch: 35, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0875544548034668
Epoch: 36, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6719515323638916
Epoch: 37, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1380991
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0025811195373535
Epoch: 1, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7468135356903076
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.6949808597564697
Epoch: 3, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.9698326587677002
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8540287017822266
Epoch: 5, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7644839286804199
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.834028959274292
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7235231399536133
Epoch: 8, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8352301120758057
Epoch: 9, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8071298599243164
Epoch: 10, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1537585258483887
Epoch: 11, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8093137741088867
Epoch: 12, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0329232215881348
Epoch: 13, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1355775
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7586395740509033
Epoch: 1, Steps: 1 | Train Loss: 1.452 Vali Loss: 1.470 Vali Acc: 0.333 Test Loss: 1.470 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 0.8327608108520508
Epoch: 2, Steps: 1 | Train Loss: 1.361 Vali Loss: 1.337 Vali Acc: 0.333 Test Loss: 1.337 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.6737236976623535
Epoch: 3, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6627957820892334
Epoch: 4, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7903366088867188
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7243244647979736
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6839852333068848
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7203683853149414
Epoch: 8, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8635990619659424
Epoch: 9, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8964574337005615
Epoch: 10, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8488881587982178
Epoch: 11, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4030389785766602
Epoch: 12, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.917665958404541
Epoch: 13, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2443442344665527
Epoch: 14, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9804806709289551
Epoch: 15, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9578518867492676
Epoch: 16, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9367203712463379
Epoch: 17, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0664710998535156
Epoch: 18, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1330559
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5984318256378174
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7228965759277344
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7618498802185059
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6982929706573486
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9153168201446533
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.72129225730896
Epoch: 6, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.655595064163208
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8640351295471191
Epoch: 8, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7593512535095215
Epoch: 9, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7177441120147705
Epoch: 10, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7263798713684082
Epoch: 11, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7537457942962646
Epoch: 12, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.204138994216919
Epoch: 13, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.691540002822876
Epoch: 14, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6368088722229004
Epoch: 15, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7758011817932129
Epoch: 16, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8224656581878662
Epoch: 17, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0175254344940186
Epoch: 18, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.7198951244354248
Epoch: 19, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.9320428371429443
Epoch: 20, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8625872135162354
Epoch: 21, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8373994827270508
Epoch: 22, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6988520622253418
Epoch: 23, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8013708591461182
Epoch: 24, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7655806541442871
Epoch: 25, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7853250503540039
Epoch: 26, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7711682319641113
Epoch: 27, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8070051670074463
Epoch: 28, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7819902896881104
Epoch: 29, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1305343
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.857281446456909
Epoch: 1, Steps: 1 | Train Loss: 1.357 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7395026683807373
Epoch: 2, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8685579299926758
Epoch: 3, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.761631965637207
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6877906322479248
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.690812349319458
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7343564033508301
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8927009105682373
Epoch: 8, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8864994049072266
Epoch: 9, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.655200719833374
Epoch: 10, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7922477722167969
Epoch: 11, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6667482852935791
Epoch: 12, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1083775
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.765922784805298
Epoch: 1, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7478110790252686
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7408936023712158
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9512476921081543
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0009069442749023
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.153 Vali Acc: 0.133 Test Loss: 1.153 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8655827045440674
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1610174179077148
Epoch: 7, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.036851406097412
Epoch: 8, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8681156635284424
Epoch: 9, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9312331676483154
Epoch: 10, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8083915710449219
Epoch: 11, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9290363788604736
Epoch: 12, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1058559
model size : 5.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9483492374420166
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8703298568725586
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.951481819152832
Epoch: 3, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2626161575317383
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8062360286712646
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0620648860931396
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.942152738571167
Epoch: 7, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.03975510597229
Epoch: 8, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9388995170593262
Epoch: 9, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8964941501617432
Epoch: 10, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7228183746337891
Epoch: 11, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.873187780380249
Epoch: 12, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.851898193359375
Epoch: 13, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9519081115722656
Epoch: 14, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9172675609588623
Epoch: 15, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.8536593914031982
Epoch: 16, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9458351135253906
Epoch: 17, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7608470916748047
Epoch: 18, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7761468887329102
Epoch: 19, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7015981674194336
Epoch: 20, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.0263409614562988
Epoch: 21, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7656769752502441
Epoch: 22, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8007678985595703
Epoch: 23, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8374602794647217
Epoch: 24, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.7445716857910156
Epoch: 25, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.8290064334869385
Epoch: 26, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8704128265380859
Epoch: 27, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0045254230499268
Epoch: 28, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7748212814331055
Epoch: 29, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7917065620422363
Epoch: 30, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.710453987121582
Epoch: 31, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7923133373260498
Epoch: 32, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.877913236618042
Epoch: 33, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7531120777130127
Epoch: 34, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8687403202056885
Epoch: 35, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1033343
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2220826148986816
Epoch: 1, Steps: 1 | Train Loss: 1.297 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7357196807861328
Epoch: 2, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6471114158630371
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.825498104095459
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9541068077087402
Epoch: 5, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8073477745056152
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9167783260345459
Epoch: 7, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7337164878845215
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7603349685668945
Epoch: 9, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.834975004196167
Epoch: 10, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7348289489746094
Epoch: 11, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.7357170581817627
Epoch: 12, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.793353796005249
Epoch: 13, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7604184150695801
Epoch: 14, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0784473419189453
Epoch: 15, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6992604732513428
Epoch: 16, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8660459518432617
Epoch: 17, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7268149852752686
Epoch: 18, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.8970301151275635
Epoch: 19, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7434079647064209
Epoch: 20, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8327622413635254
Epoch: 21, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9018042087554932
Epoch: 22, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1184797286987305
Epoch: 23, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.903242826461792
Epoch: 24, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.05476713180542
Epoch: 25, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9777383804321289
Epoch: 26, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 1.3068187236785889
Epoch: 27, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9848239421844482
Epoch: 28, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8738956451416016
Epoch: 29, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9193572998046875
Epoch: 30, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8583939075469971
Epoch: 31, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9083778858184814
Epoch: 32, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 0.9456126689910889
Epoch: 33, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9176156520843506
Epoch: 34, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0388562679290771
Epoch: 35, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 36 cost time: 0.831697940826416
Epoch: 36, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7887029647827148
Epoch: 37, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.762354850769043
Epoch: 38, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9168646335601807
Epoch: 39, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6976888179779053
Epoch: 40, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8500092029571533
Epoch: 41, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.850597620010376
Epoch: 42, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7886979579925537
Epoch: 43, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.856581449508667
Epoch: 44, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7434189319610596
Epoch: 45, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1008127
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.669860601425171
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6442339420318604
Epoch: 2, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9760255813598633
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8739049434661865
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.78035569190979
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.017225742340088
Epoch: 6, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9530007839202881
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8346478939056396
Epoch: 8, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7945857048034668
Epoch: 9, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0156748294830322
Epoch: 10, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7847485542297363
Epoch: 11, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.6458427906036377
Epoch: 12, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9345216751098633
Epoch: 13, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9579129219055176
Epoch: 14, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9156620502471924
Epoch: 15, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1149263381958008
Epoch: 16, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9232237339019775
Epoch: 17, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8581075668334961
Epoch: 18, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.8219761848449707
Epoch: 19, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9898419380187988
Epoch: 20, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9297564029693604
Epoch: 21, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9475083351135254
Epoch: 22, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.8283755779266357
Epoch: 23, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 24 cost time: 0.8118896484375
Epoch: 24, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7288522720336914
Epoch: 25, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6730940341949463
Epoch: 26, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0372538566589355
Epoch: 27, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.7935783863067627
Epoch: 28, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.9078130722045898
Epoch: 29, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 1.1910030841827393
Epoch: 30, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8352441787719727
Epoch: 31, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9983024597167969
Epoch: 32, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2027873992919922
Epoch: 33, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 34 cost time: 0.9181478023529053
Epoch: 34, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.048269510269165
Epoch: 35, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0119030475616455
Epoch: 36, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9723553657531738
Epoch: 37, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6773715019226074
Epoch: 38, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7708876132965088
Epoch: 39, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2276208400726318
Epoch: 40, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7961666584014893
Epoch: 41, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1394953727722168
Epoch: 42, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7840063571929932
Epoch: 43, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 935167
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.069483518600464
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7716078758239746
Epoch: 2, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.9075405597686768
Epoch: 3, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7070164680480957
Epoch: 4, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7422153949737549
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7815563678741455
Epoch: 6, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9798882007598877
Epoch: 7, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6844749450683594
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7613227367401123
Epoch: 9, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9176483154296875
Epoch: 10, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7360365390777588
Epoch: 11, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9641427993774414
Epoch: 12, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9241676330566406
Epoch: 13, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.957721471786499
Epoch: 14, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7858898639678955
Epoch: 15, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6134140491485596
Epoch: 16, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9359509944915771
Epoch: 17, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6155400276184082
Epoch: 18, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 909951
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5549204349517822
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6779992580413818
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6625232696533203
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.81622314453125
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7934296131134033
Epoch: 5, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6274631023406982
Epoch: 6, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7071998119354248
Epoch: 7, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8004593849182129
Epoch: 8, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6673965454101562
Epoch: 9, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9876790046691895
Epoch: 10, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7559795379638672
Epoch: 11, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 884735
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.051496982574463
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7462069988250732
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8265085220336914
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.7799551486968994
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8953607082366943
Epoch: 5, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8301920890808105
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8660402297973633
Epoch: 7, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0468647480010986
Epoch: 8, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8910596370697021
Epoch: 9, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.127579927444458
Epoch: 10, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7882177829742432
Epoch: 11, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8753945827484131
Epoch: 12, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8301405906677246
Epoch: 13, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8454251289367676
Epoch: 14, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8487229347229004
Epoch: 15, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 859519
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.05727481842041
Epoch: 1, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6328825950622559
Epoch: 2, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.9099934101104736
Epoch: 3, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.823746919631958
Epoch: 4, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.7704479694366455
Epoch: 5, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.7069017887115479
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.7663133144378662
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8843932151794434
Epoch: 8, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7660105228424072
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.025 Vali Acc: 0.667 Test Loss: 1.025 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.66463303565979
Epoch: 10, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.7031261920928955
Epoch: 11, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.739356517791748
Epoch: 12, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8421003818511963
Epoch: 13, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.019 Vali Acc: 0.667 Test Loss: 1.019 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.8328771591186523
Epoch: 14, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6951384544372559
Epoch: 15, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8834915161132812
Epoch: 16, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9533655643463135
Epoch: 17, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8193204402923584
Epoch: 18, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 19 cost time: 0.9146218299865723
Epoch: 19, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7392284870147705
Epoch: 20, Steps: 1 | Train Loss: 0.822 Vali Loss: 0.998 Vali Acc: 0.667 Test Loss: 0.998 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.7541449069976807
Epoch: 21, Steps: 1 | Train Loss: 0.840 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8244044780731201
Epoch: 22, Steps: 1 | Train Loss: 0.837 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 23 cost time: 0.7335588932037354
Epoch: 23, Steps: 1 | Train Loss: 0.832 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7043776512145996
Epoch: 24, Steps: 1 | Train Loss: 0.631 Vali Loss: 0.981 Vali Acc: 0.667 Test Loss: 0.981 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 0.9521124362945557
Epoch: 25, Steps: 1 | Train Loss: 0.693 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 26 cost time: 0.7143197059631348
Epoch: 26, Steps: 1 | Train Loss: 0.725 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.956639289855957
Epoch: 27, Steps: 1 | Train Loss: 0.655 Vali Loss: 0.964 Vali Acc: 0.667 Test Loss: 0.964 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 0.745764970779419
Epoch: 28, Steps: 1 | Train Loss: 0.646 Vali Loss: 0.959 Vali Acc: 0.533 Test Loss: 0.959 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7496986389160156
Epoch: 29, Steps: 1 | Train Loss: 0.595 Vali Loss: 0.956 Vali Acc: 0.533 Test Loss: 0.956 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8476600646972656
Epoch: 30, Steps: 1 | Train Loss: 0.577 Vali Loss: 0.953 Vali Acc: 0.467 Test Loss: 0.953 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6722450256347656
Epoch: 31, Steps: 1 | Train Loss: 0.544 Vali Loss: 0.951 Vali Acc: 0.533 Test Loss: 0.951 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9708693027496338
Epoch: 32, Steps: 1 | Train Loss: 0.528 Vali Loss: 0.950 Vali Acc: 0.467 Test Loss: 0.950 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9491419792175293
Epoch: 33, Steps: 1 | Train Loss: 0.445 Vali Loss: 0.948 Vali Acc: 0.467 Test Loss: 0.948 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9205896854400635
Epoch: 34, Steps: 1 | Train Loss: 0.408 Vali Loss: 0.945 Vali Acc: 0.467 Test Loss: 0.945 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9440274238586426
Epoch: 35, Steps: 1 | Train Loss: 0.418 Vali Loss: 0.938 Vali Acc: 0.533 Test Loss: 0.938 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9557676315307617
Epoch: 36, Steps: 1 | Train Loss: 0.372 Vali Loss: 0.932 Vali Acc: 0.600 Test Loss: 0.932 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.78031325340271
Epoch: 37, Steps: 1 | Train Loss: 0.342 Vali Loss: 0.929 Vali Acc: 0.600 Test Loss: 0.929 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 844895
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6829493045806885
Epoch: 1, Steps: 1 | Train Loss: 1.341 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6176369190216064
Epoch: 2, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9361612796783447
Epoch: 3, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9078531265258789
Epoch: 4, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8641211986541748
Epoch: 5, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8643207550048828
Epoch: 6, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9589431285858154
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8525710105895996
Epoch: 8, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8542904853820801
Epoch: 9, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.724811315536499
Epoch: 10, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.8236956596374512
Epoch: 11, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.115 Vali Acc: 0.133 Test Loss: 1.115 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8641057014465332
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7964816093444824
Epoch: 13, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.6716876029968262
Epoch: 14, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9418401718139648
Epoch: 15, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8418164253234863
Epoch: 16, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7892863750457764
Epoch: 17, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2288601398468018
Epoch: 18, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.54008150100708
Epoch: 19, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 1.1509208679199219
Epoch: 20, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2043333053588867
Epoch: 21, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 22 cost time: 0.9326949119567871
Epoch: 22, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7199523448944092
Epoch: 23, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 24 cost time: 0.788881778717041
Epoch: 24, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 25 cost time: 0.8568017482757568
Epoch: 25, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 26 cost time: 0.9469552040100098
Epoch: 26, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9628603458404541
Epoch: 27, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0134029388427734
Epoch: 28, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8136849403381348
Epoch: 29, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7948577404022217
Epoch: 30, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 31 cost time: 0.9150130748748779
Epoch: 31, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9295156002044678
Epoch: 32, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 33 cost time: 0.8841457366943359
Epoch: 33, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 34 cost time: 0.8397235870361328
Epoch: 34, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 0.7546091079711914
Epoch: 35, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0436720848083496
Epoch: 36, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7311363220214844
Epoch: 37, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7876946926116943
Epoch: 38, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 39 cost time: 0.8762884140014648
Epoch: 39, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8231463432312012
Epoch: 40, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0982730388641357
Epoch: 41, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9373753070831299
Epoch: 42, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8521685600280762
Epoch: 43, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0028128623962402
Epoch: 44, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0349352359771729
Epoch: 45, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9453818798065186
Epoch: 46, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.95050048828125
Epoch: 47, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8577091693878174
Epoch: 48, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 832287
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.741537094116211
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6384274959564209
Epoch: 2, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6830196380615234
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.8209161758422852
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8209230899810791
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6974961757659912
Epoch: 6, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7841894626617432
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8083357810974121
Epoch: 8, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.7518148422241211
Epoch: 9, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.7167205810546875
Epoch: 10, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0056917667388916
Epoch: 11, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6825292110443115
Epoch: 12, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8440291881561279
Epoch: 13, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6728978157043457
Epoch: 14, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7906162738800049
Epoch: 15, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6302742958068848
Epoch: 16, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8615057468414307
Epoch: 17, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6780407428741455
Epoch: 18, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7522192001342773
Epoch: 19, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 819679
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5878591537475586
Epoch: 1, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9416089057922363
Epoch: 2, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.691180944442749
Epoch: 3, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6803810596466064
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9062135219573975
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8761043548583984
Epoch: 6, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7338509559631348
Epoch: 7, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9067122936248779
Epoch: 8, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8238482475280762
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8584463596343994
Epoch: 10, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.819800615310669
Epoch: 11, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.78566575050354
Epoch: 12, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 807071
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5197036266326904
Epoch: 1, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7538321018218994
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9702503681182861
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7490496635437012
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.130 Vali Acc: 0.133 Test Loss: 1.130 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7575008869171143
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7095930576324463
Epoch: 6, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6770446300506592
Epoch: 7, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7436637878417969
Epoch: 8, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0466232299804688
Epoch: 9, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8641443252563477
Epoch: 10, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.8321099281311035
Epoch: 11, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.9916930198669434
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7437734603881836
Epoch: 13, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8060603141784668
Epoch: 14, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.8973548412322998
Epoch: 15, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9995522499084473
Epoch: 16, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9075663089752197
Epoch: 17, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.781005859375
Epoch: 18, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6458747386932373
Epoch: 19, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6570644378662109
Epoch: 20, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.6408088207244873
Epoch: 21, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.76944899559021
Epoch: 22, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8286333084106445
Epoch: 23, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.9034667015075684
Epoch: 24, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9209332466125488
Epoch: 25, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9238288402557373
Epoch: 26, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8114845752716064
Epoch: 27, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8419272899627686
Epoch: 28, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.9689013957977295
Epoch: 29, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.7268741130828857
Epoch: 30, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.6975550651550293
Epoch: 31, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.8485305309295654
Epoch: 32, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 33 cost time: 0.7451019287109375
Epoch: 33, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7488298416137695
Epoch: 34, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7086915969848633
Epoch: 35, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7325470447540283
Epoch: 36, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7772564888000488
Epoch: 37, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9389047622680664
Epoch: 38, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0817408561706543
Epoch: 39, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6696023941040039
Epoch: 40, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.822922945022583
Epoch: 41, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8534624576568604
Epoch: 42, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 545375
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.889373540878296
Epoch: 1, Steps: 1 | Train Loss: 1.316 Vali Loss: 1.215 Vali Acc: 0.133 Test Loss: 1.215 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.8178586959838867
Epoch: 2, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.8925731182098389
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.9422721862792969
Epoch: 4, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.88265061378479
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0485649108886719
Epoch: 6, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8283495903015137
Epoch: 7, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7584447860717773
Epoch: 8, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0512871742248535
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0073282718658447
Epoch: 10, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.9329948425292969
Epoch: 11, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.7600502967834473
Epoch: 12, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.8553688526153564
Epoch: 13, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.9840719699859619
Epoch: 14, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.8135230541229248
Epoch: 15, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8066225051879883
Epoch: 16, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7464959621429443
Epoch: 17, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8903923034667969
Epoch: 18, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1835319995880127
Epoch: 19, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8157811164855957
Epoch: 20, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9938712120056152
Epoch: 21, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8956620693206787
Epoch: 22, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9985322952270508
Epoch: 23, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9651839733123779
Epoch: 24, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 25 cost time: 0.6738996505737305
Epoch: 25, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 26 cost time: 0.833118200302124
Epoch: 26, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 27 cost time: 0.8013865947723389
Epoch: 27, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9791500568389893
Epoch: 28, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8930206298828125
Epoch: 29, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9286487102508545
Epoch: 30, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 31 cost time: 0.792198657989502
Epoch: 31, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0450072288513184
Epoch: 32, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 33 cost time: 0.9491939544677734
Epoch: 33, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 34 cost time: 0.8006539344787598
Epoch: 34, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 35 cost time: 0.7906017303466797
Epoch: 35, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 36 cost time: 0.7560069561004639
Epoch: 36, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 37 cost time: 0.8820524215698242
Epoch: 37, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8115077018737793
Epoch: 38, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.876678466796875
Epoch: 39, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.312896728515625
Epoch: 40, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 41 cost time: 0.9413149356842041
Epoch: 41, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1470081806182861
Epoch: 42, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8869645595550537
Epoch: 43, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.025028944015503
Epoch: 44, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7728314399719238
Epoch: 45, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 46 cost time: 1.007910966873169
Epoch: 46, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8194475173950195
Epoch: 47, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9291770458221436
Epoch: 48, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8144657611846924
Epoch: 49, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.940044641494751
Epoch: 50, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9593284130096436
Epoch: 51, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9546582698822021
Epoch: 52, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8642539978027344
Epoch: 53, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8254084587097168
Epoch: 54, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9659574031829834
Epoch: 55, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 532767
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0154645442962646
Epoch: 1, Steps: 1 | Train Loss: 1.349 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8069596290588379
Epoch: 2, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7580008506774902
Epoch: 3, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6221122741699219
Epoch: 4, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8379056453704834
Epoch: 5, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6119880676269531
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.089 Vali Acc: 0.200 Test Loss: 1.089 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9155673980712891
Epoch: 7, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6375036239624023
Epoch: 8, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8469681739807129
Epoch: 9, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8924574851989746
Epoch: 10, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7829782962799072
Epoch: 11, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8797414302825928
Epoch: 12, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8059935569763184
Epoch: 13, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.06923246383667
Epoch: 14, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9256458282470703
Epoch: 15, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 520159
model size : 2.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5940723419189453
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.775122880935669
Epoch: 2, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8303189277648926
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8082129955291748
Epoch: 4, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7394380569458008
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5680654048919678
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6218738555908203
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6362361907958984
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6418514251708984
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7219240665435791
Epoch: 10, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7047176361083984
Epoch: 11, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8193690776824951
Epoch: 12, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9781455993652344
Epoch: 13, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 507551
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5017876625061035
Epoch: 1, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6722118854522705
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8882882595062256
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7461404800415039
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6506752967834473
Epoch: 5, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7135906219482422
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6440913677215576
Epoch: 7, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.6352283954620361
Epoch: 8, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6574373245239258
Epoch: 9, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7940502166748047
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5803613662719727
Epoch: 11, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.66788649559021
Epoch: 12, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0731573104858398
Epoch: 13, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7082335948944092
Epoch: 14, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6726365089416504
Epoch: 15, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0911712646484375
Epoch: 16, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.719435453414917
Epoch: 17, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 395615
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3126165866851807
Epoch: 1, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7940762042999268
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6842496395111084
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8005354404449463
Epoch: 4, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7568976879119873
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6270451545715332
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7196359634399414
Epoch: 7, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8724160194396973
Epoch: 8, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6873390674591064
Epoch: 9, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8032588958740234
Epoch: 10, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6929945945739746
Epoch: 11, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 383007
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.207576036453247
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6303942203521729
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.081 Vali Acc: 0.200 Test Loss: 1.081 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9775550365447998
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9274177551269531
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.6143689155578613
Epoch: 5, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5516374111175537
Epoch: 6, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6359078884124756
Epoch: 7, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7025496959686279
Epoch: 8, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6156222820281982
Epoch: 9, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5928215980529785
Epoch: 10, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6778972148895264
Epoch: 11, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7560575008392334
Epoch: 12, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7135336399078369
Epoch: 13, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8309335708618164
Epoch: 14, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6294677257537842
Epoch: 15, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6422321796417236
Epoch: 16, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8667020797729492
Epoch: 17, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.69277024269104
Epoch: 18, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7953813076019287
Epoch: 19, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7305002212524414
Epoch: 20, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 370399
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.767381191253662
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8142209053039551
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6926553249359131
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7115728855133057
Epoch: 4, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6344728469848633
Epoch: 5, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.594806432723999
Epoch: 6, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.6823620796203613
Epoch: 7, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6821455955505371
Epoch: 8, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.739912748336792
Epoch: 9, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.825331449508667
Epoch: 10, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.7440273761749268
Epoch: 11, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.6517000198364258
Epoch: 12, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8472433090209961
Epoch: 13, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9959986209869385
Epoch: 14, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8272144794464111
Epoch: 15, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9517860412597656
Epoch: 16, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8374717235565186
Epoch: 17, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9269287586212158
Epoch: 18, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6285262107849121
Epoch: 19, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.933100700378418
Epoch: 20, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8436665534973145
Epoch: 21, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 357791
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.706472396850586
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7213430404663086
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6764750480651855
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9781961441040039
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7845830917358398
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.126 Vali Acc: 0.133 Test Loss: 1.126 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8579607009887695
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.126 Vali Acc: 0.133 Test Loss: 1.126 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8256011009216309
Epoch: 7, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7609996795654297
Epoch: 8, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.8115041255950928
Epoch: 9, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8226144313812256
Epoch: 10, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.8788602352142334
Epoch: 11, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8338594436645508
Epoch: 12, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.832000732421875
Epoch: 13, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7416024208068848
Epoch: 14, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6543073654174805
Epoch: 15, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7613697052001953
Epoch: 16, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6637670993804932
Epoch: 17, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7176127433776855
Epoch: 18, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.683851957321167
Epoch: 19, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6773934364318848
Epoch: 20, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7174689769744873
Epoch: 21, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.7743501663208008
Epoch: 22, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1662724018096924
Epoch: 23, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8012816905975342
Epoch: 24, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9587247371673584
Epoch: 25, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.791400671005249
Epoch: 26, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7541205883026123
Epoch: 27, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9015984535217285
Epoch: 28, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7659115791320801
Epoch: 29, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9950144290924072
Epoch: 30, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6963229179382324
Epoch: 31, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 320735
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4640822410583496
Epoch: 1, Steps: 1 | Train Loss: 1.426 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.5745353698730469
Epoch: 2, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.610945463180542
Epoch: 3, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8484025001525879
Epoch: 4, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7620604038238525
Epoch: 5, Steps: 1 | Train Loss: 1.354 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8191103935241699
Epoch: 6, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8165345191955566
Epoch: 7, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9448623657226562
Epoch: 8, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0559117794036865
Epoch: 9, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9064416885375977
Epoch: 10, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9698994159698486
Epoch: 11, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9500935077667236
Epoch: 12, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9166243076324463
Epoch: 13, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0407376289367676
Epoch: 14, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 308127
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6522607803344727
Epoch: 1, Steps: 1 | Train Loss: 1.455 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.6516745090484619
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.746422529220581
Epoch: 3, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.934302568435669
Epoch: 4, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6937921047210693
Epoch: 5, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.8869032859802246
Epoch: 6, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.9459600448608398
Epoch: 7, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.8708434104919434
Epoch: 8, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0275931358337402
Epoch: 9, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8341541290283203
Epoch: 10, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9405868053436279
Epoch: 11, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8022909164428711
Epoch: 12, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0319957733154297
Epoch: 13, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8935801982879639
Epoch: 14, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8320314884185791
Epoch: 15, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8898928165435791
Epoch: 16, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.809424638748169
Epoch: 17, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 295519
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.358348846435547
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5902729034423828
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6725165843963623
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7710962295532227
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8430898189544678
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7787654399871826
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8896574974060059
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9313561916351318
Epoch: 8, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6934599876403809
Epoch: 9, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8277249336242676
Epoch: 10, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8304128646850586
Epoch: 11, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9504270553588867
Epoch: 12, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 282911
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.773916721343994
Epoch: 1, Steps: 1 | Train Loss: 1.279 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7874660491943359
Epoch: 2, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8466088771820068
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0737638473510742
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9801895618438721
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7801270484924316
Epoch: 6, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.7992186546325684
Epoch: 7, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8470563888549805
Epoch: 8, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 1.0771658420562744
Epoch: 9, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8265273571014404
Epoch: 10, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8874959945678711
Epoch: 11, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7581894397735596
Epoch: 12, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8996195793151855
Epoch: 13, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8097953796386719
Epoch: 14, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.8659706115722656
Epoch: 15, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8413755893707275
Epoch: 16, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9209103584289551
Epoch: 17, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8275582790374756
Epoch: 18, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.766366720199585
Epoch: 19, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9102795124053955
Epoch: 20, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9299521446228027
Epoch: 21, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9121241569519043
Epoch: 22, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9021615982055664
Epoch: 23, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1240668296813965
Epoch: 24, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 11838003
model size : 50.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.941537857055664
Epoch: 1, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0399889945983887
Epoch: 2, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8747560977935791
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0064606666564941
Epoch: 4, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.8987581729888916
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7861447334289551
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6849889755249023
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8157808780670166
Epoch: 8, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8082480430603027
Epoch: 9, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7801272869110107
Epoch: 10, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.9897847175598145
Epoch: 11, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9439306259155273
Epoch: 12, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8697476387023926
Epoch: 13, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7995362281799316
Epoch: 14, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9127089977264404
Epoch: 15, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.8233160972595215
Epoch: 16, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7697896957397461
Epoch: 17, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8169529438018799
Epoch: 18, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8133759498596191
Epoch: 19, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8397603034973145
Epoch: 20, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7332420349121094
Epoch: 21, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.64306640625
Epoch: 22, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8102247714996338
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7345576286315918
Epoch: 24, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.467 Test Loss: 1.218 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7774631977081299
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 11744051
model size : 49.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.196671962738037
Epoch: 1, Steps: 1 | Train Loss: 1.481 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8035602569580078
Epoch: 2, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8420820236206055
Epoch: 3, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.732823371887207
Epoch: 4, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7266876697540283
Epoch: 5, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7032694816589355
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9878537654876709
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.7774052619934082
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8464710712432861
Epoch: 9, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8700087070465088
Epoch: 10, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9255905151367188
Epoch: 11, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8191895484924316
Epoch: 12, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8525445461273193
Epoch: 13, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8771445751190186
Epoch: 14, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1678292751312256
Epoch: 15, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8624184131622314
Epoch: 16, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0211238861083984
Epoch: 17, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.059549331665039
Epoch: 18, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7912595272064209
Epoch: 19, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8481612205505371
Epoch: 20, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0160269737243652
Epoch: 21, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9462521076202393
Epoch: 22, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9611756801605225
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11650099
model size : 49.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.174032211303711
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.81219482421875
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7751243114471436
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8423366546630859
Epoch: 4, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7479977607727051
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7664916515350342
Epoch: 6, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7368967533111572
Epoch: 7, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8916888236999512
Epoch: 8, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7120590209960938
Epoch: 9, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7104306221008301
Epoch: 10, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6718020439147949
Epoch: 11, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8368253707885742
Epoch: 12, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8445641994476318
Epoch: 13, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8317296504974365
Epoch: 14, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8004190921783447
Epoch: 15, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7827537059783936
Epoch: 16, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7127323150634766
Epoch: 17, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7417712211608887
Epoch: 18, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7105147838592529
Epoch: 19, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7776248455047607
Epoch: 20, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 11556147
model size : 49.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.870875597000122
Epoch: 1, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9177427291870117
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7785866260528564
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7860379219055176
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8547770977020264
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8400430679321289
Epoch: 6, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0725646018981934
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.9480500221252441
Epoch: 8, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8292250633239746
Epoch: 9, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 1.055375576019287
Epoch: 10, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2357759475708008
Epoch: 11, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2064714431762695
Epoch: 12, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3193333148956299
Epoch: 13, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9921822547912598
Epoch: 14, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.135080337524414
Epoch: 15, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8833916187286377
Epoch: 16, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9821007251739502
Epoch: 17, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2685728073120117
Epoch: 18, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2028584480285645
Epoch: 19, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 9999411
model size : 43.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2301530838012695
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.915128231048584
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8366124629974365
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8288967609405518
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8639850616455078
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9623074531555176
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8828363418579102
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0176019668579102
Epoch: 8, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9026224613189697
Epoch: 9, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.794384241104126
Epoch: 10, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.983278751373291
Epoch: 11, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.8985583782196045
Epoch: 12, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.775904655456543
Epoch: 13, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7012324333190918
Epoch: 14, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7810182571411133
Epoch: 15, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 0.6583037376403809
Epoch: 16, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8199927806854248
Epoch: 17, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9701600074768066
Epoch: 18, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.013 Vali Acc: 0.667 Test Loss: 1.013 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9661753177642822
Epoch: 19, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1137847900390625
Epoch: 20, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7797636985778809
Epoch: 21, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8402025699615479
Epoch: 22, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8822493553161621
Epoch: 23, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.878223180770874
Epoch: 24, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0680372714996338
Epoch: 25, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 9905459
model size : 42.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.796002149581909
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8090300559997559
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.169165849685669
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8378102779388428
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7578439712524414
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.083688497543335
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9261720180511475
Epoch: 7, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9382469654083252
Epoch: 8, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9888155460357666
Epoch: 9, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0386064052581787
Epoch: 10, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9711835384368896
Epoch: 11, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 1.0376250743865967
Epoch: 12, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8034999370574951
Epoch: 13, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2176311016082764
Epoch: 14, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0756940841674805
Epoch: 15, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9075765609741211
Epoch: 16, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0576717853546143
Epoch: 17, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.016 Vali Acc: 0.200 Test Loss: 1.016 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1287765502929688
Epoch: 18, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8514337539672852
Epoch: 19, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.295 Vali Acc: 0.533 Test Loss: 1.295 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9179553985595703
Epoch: 20, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.160 Vali Acc: 0.533 Test Loss: 1.160 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.97141432762146
Epoch: 21, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 9811507
model size : 42.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.728034257888794
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.7936928272247314
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9965329170227051
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1637589931488037
Epoch: 4, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9246413707733154
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8844740390777588
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9460573196411133
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.735365629196167
Epoch: 8, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7796096801757812
Epoch: 9, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.9664738178253174
Epoch: 10, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.8373143672943115
Epoch: 11, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9845657348632812
Epoch: 12, Steps: 1 | Train Loss: 0.493 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.8051393032073975
Epoch: 13, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.733311653137207
Epoch: 14, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7714869976043701
Epoch: 15, Steps: 1 | Train Loss: 0.306 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7594778537750244
Epoch: 16, Steps: 1 | Train Loss: 0.197 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9617998600006104
Epoch: 17, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8123383522033691
Epoch: 18, Steps: 1 | Train Loss: 0.136 Vali Loss: 0.979 Vali Acc: 0.467 Test Loss: 0.979 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.865135908126831
Epoch: 19, Steps: 1 | Train Loss: 0.089 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0095365047454834
Epoch: 20, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9957103729248047
Epoch: 21, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8606460094451904
Epoch: 22, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 9717555
model size : 42.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0526959896087646
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9218997955322266
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7535216808319092
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.7543587684631348
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8576564788818359
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9889552593231201
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9377553462982178
Epoch: 7, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8691411018371582
Epoch: 8, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9284613132476807
Epoch: 9, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7091238498687744
Epoch: 10, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8394546508789062
Epoch: 11, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.811147928237915
Epoch: 12, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9033730030059814
Epoch: 13, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7274520397186279
Epoch: 14, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8063881397247314
Epoch: 15, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.808330774307251
Epoch: 16, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7048318386077881
Epoch: 17, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.845372200012207
Epoch: 18, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7729594707489014
Epoch: 19, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8610713481903076
Epoch: 20, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8578968048095703
Epoch: 21, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.8812968730926514
Epoch: 22, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7913382053375244
Epoch: 23, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7943210601806641
Epoch: 24, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.308 Vali Acc: 0.267 Test Loss: 1.308 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8152639865875244
Epoch: 25, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8280870914459229
Epoch: 26, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8689436912536621
Epoch: 27, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.801605224609375
Epoch: 28, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.467 Test Loss: 1.230 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8004469871520996
Epoch: 29, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.267 Vali Acc: 0.467 Test Loss: 1.267 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.062589406967163
Epoch: 30, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.686643123626709
Epoch: 31, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.333 Test Loss: 1.339 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9080115
model size : 39.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3156790733337402
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.132 Vali Acc: 0.133 Test Loss: 1.132 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.9196538925170898
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9783658981323242
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8817291259765625
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8204038143157959
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8351171016693115
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8420290946960449
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9633617401123047
Epoch: 8, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.753000020980835
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8450713157653809
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7830986976623535
Epoch: 11, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9839808940887451
Epoch: 12, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.1646671295166016
Epoch: 13, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9056172370910645
Epoch: 14, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9314696788787842
Epoch: 15, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8844516277313232
Epoch: 16, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0388014316558838
Epoch: 17, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8733780384063721
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.8447146415710449
Epoch: 19, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7274384498596191
Epoch: 20, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.724306583404541
Epoch: 21, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.053 Vali Acc: 0.267 Test Loss: 1.053 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8243505954742432
Epoch: 22, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.225 Vali Acc: 0.467 Test Loss: 1.225 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 23 cost time: 0.8353028297424316
Epoch: 23, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.282 Vali Acc: 0.467 Test Loss: 1.282 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8659756183624268
Epoch: 24, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0713284015655518
Epoch: 25, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.944467306137085
Epoch: 26, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9866237640380859
Epoch: 27, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.466654 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 0.8370182514190674
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.98134446144104
Epoch: 29, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.364 Vali Acc: 0.333 Test Loss: 1.364 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9791128635406494
Epoch: 30, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.539 Vali Acc: 0.333 Test Loss: 1.539 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7976813316345215
Epoch: 31, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.658 Vali Acc: 0.333 Test Loss: 1.658 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8522963523864746
Epoch: 32, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.718 Vali Acc: 0.333 Test Loss: 1.718 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7540464401245117
Epoch: 33, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.713 Vali Acc: 0.333 Test Loss: 1.713 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9165136814117432
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.333 Test Loss: 1.677 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9476709365844727
Epoch: 35, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.333 Test Loss: 1.638 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7712225914001465
Epoch: 36, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.267 Test Loss: 1.608 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9144418239593506
Epoch: 37, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.333 Test Loss: 1.592 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8986163
model size : 39.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.955300807952881
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.124 Vali Acc: 0.133 Test Loss: 1.124 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7368485927581787
Epoch: 2, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.134 Vali Acc: 0.133 Test Loss: 1.134 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7955408096313477
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.9322125911712646
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.6697325706481934
Epoch: 5, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8039073944091797
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6808247566223145
Epoch: 7, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7413971424102783
Epoch: 8, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7623567581176758
Epoch: 9, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7533023357391357
Epoch: 10, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.945976734161377
Epoch: 11, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.9009127616882324
Epoch: 12, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.6819133758544922
Epoch: 13, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7998087406158447
Epoch: 14, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8033204078674316
Epoch: 15, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9225401878356934
Epoch: 16, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8245420455932617
Epoch: 17, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9803047180175781
Epoch: 18, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9361200332641602
Epoch: 19, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8890442848205566
Epoch: 20, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8072047233581543
Epoch: 21, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8750176429748535
Epoch: 22, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8892211
model size : 38.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.223884344100952
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.183 Vali Acc: 0.133 Test Loss: 1.183 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7828066349029541
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9121706485748291
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.980865478515625
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 1.1868951320648193
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8692395687103271
Epoch: 6, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.9496662616729736
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 1.0102612972259521
Epoch: 8, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.9200310707092285
Epoch: 9, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9638619422912598
Epoch: 10, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7253103256225586
Epoch: 11, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.9474349021911621
Epoch: 12, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.8986184597015381
Epoch: 13, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7504134178161621
Epoch: 14, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7894959449768066
Epoch: 15, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.8729462623596191
Epoch: 16, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9373881816864014
Epoch: 17, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7829055786132812
Epoch: 18, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8864543437957764
Epoch: 19, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9858992099761963
Epoch: 20, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.291 Vali Acc: 0.267 Test Loss: 1.291 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9208180904388428
Epoch: 21, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.309 Vali Acc: 0.267 Test Loss: 1.309 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9073176383972168
Epoch: 22, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.362 Vali Acc: 0.267 Test Loss: 1.362 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7730953693389893
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.371 Vali Acc: 0.267 Test Loss: 1.371 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8158767223358154
Epoch: 24, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.394 Vali Acc: 0.333 Test Loss: 1.394 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7913060188293457
Epoch: 25, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.434 Vali Acc: 0.333 Test Loss: 1.434 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 8798259
model size : 38.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2321853637695312
Epoch: 1, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8556761741638184
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1303353309631348
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8559484481811523
Epoch: 4, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7985544204711914
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8739726543426514
Epoch: 6, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.040118932723999
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.111654281616211
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.0557959079742432
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.117 Vali Acc: 0.133 Test Loss: 1.117 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8528141975402832
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0039818286895752
Epoch: 11, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8346116542816162
Epoch: 12, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9579384326934814
Epoch: 13, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9769055843353271
Epoch: 14, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.1133332252502441
Epoch: 15, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8721983432769775
Epoch: 16, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.898665189743042
Epoch: 17, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9883980751037598
Epoch: 18, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9266302585601807
Epoch: 19, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9014806747436523
Epoch: 20, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8184590339660645
Epoch: 21, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9649972915649414
Epoch: 22, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1310946941375732
Epoch: 23, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8856205940246582
Epoch: 24, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 8620467
model size : 37.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7480711936950684
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6512417793273926
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.721973180770874
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.639976978302002
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8459928035736084
Epoch: 5, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.705996036529541
Epoch: 6, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6962890625
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8450963497161865
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.806429386138916
Epoch: 9, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8340339660644531
Epoch: 10, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7361979484558105
Epoch: 11, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8968808650970459
Epoch: 12, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.114884614944458
Epoch: 13, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8526515
model size : 37.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0493993759155273
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.822948694229126
Epoch: 2, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7889020442962646
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6905155181884766
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7992026805877686
Epoch: 5, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7584059238433838
Epoch: 6, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7325353622436523
Epoch: 7, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7746384143829346
Epoch: 8, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6584408283233643
Epoch: 9, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7016844749450684
Epoch: 10, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.8368468284606934
Epoch: 11, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8266804218292236
Epoch: 12, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7604269981384277
Epoch: 13, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.727391242980957
Epoch: 14, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.6975781917572021
Epoch: 15, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7736971378326416
Epoch: 16, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.7074856758117676
Epoch: 17, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7287397384643555
Epoch: 18, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7380795478820801
Epoch: 19, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6568987369537354
Epoch: 20, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7484431266784668
Epoch: 21, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7717232704162598
Epoch: 22, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8083112239837646
Epoch: 23, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6545755863189697
Epoch: 24, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8086330890655518
Epoch: 25, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6192023754119873
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8432563
model size : 37.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8147993087768555
Epoch: 1, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7385265827178955
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8259198665618896
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.6681833267211914
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7615556716918945
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6692714691162109
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8713724613189697
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.8235156536102295
Epoch: 8, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8822393417358398
Epoch: 9, Steps: 1 | Train Loss: 0.726 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9536335468292236
Epoch: 10, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8162541389465332
Epoch: 11, Steps: 1 | Train Loss: 0.461 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.8410594463348389
Epoch: 12, Steps: 1 | Train Loss: 0.435 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 0.9547543525695801
Epoch: 13, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.007 Vali Acc: 0.333 Test Loss: 1.007 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.937084436416626
Epoch: 14, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7536327838897705
Epoch: 15, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.017 Vali Acc: 0.667 Test Loss: 1.017 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7537102699279785
Epoch: 16, Steps: 1 | Train Loss: 0.184 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7939093112945557
Epoch: 17, Steps: 1 | Train Loss: 0.139 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7771599292755127
Epoch: 18, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7958860397338867
Epoch: 19, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6722333431243896
Epoch: 20, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7855439186096191
Epoch: 21, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8595809936523438
Epoch: 22, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 8338611
model size : 36.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.62068510055542
Epoch: 1, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.848762035369873
Epoch: 2, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.786940336227417
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8962793350219727
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8450086116790771
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.8558251857757568
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8216564655303955
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6981518268585205
Epoch: 8, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.787940502166748
Epoch: 9, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7662150859832764
Epoch: 10, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7130780220031738
Epoch: 11, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.7772781848907471
Epoch: 12, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9123044013977051
Epoch: 13, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8425416946411133
Epoch: 14, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7535479068756104
Epoch: 15, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6717536449432373
Epoch: 16, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8969504833221436
Epoch: 17, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8869411945343018
Epoch: 18, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8693029880523682
Epoch: 19, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8088788986206055
Epoch: 20, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0480663776397705
Epoch: 21, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4087603
model size : 18.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.015089750289917
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9055111408233643
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7857310771942139
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7425758838653564
Epoch: 4, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7464509010314941
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8511898517608643
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7999434471130371
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6417067050933838
Epoch: 8, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9300634860992432
Epoch: 9, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6770174503326416
Epoch: 10, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9210753440856934
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7267317771911621
Epoch: 12, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.8176665306091309
Epoch: 13, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.9169051647186279
Epoch: 14, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.030 Vali Acc: 0.333 Test Loss: 1.030 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5923233032226562
Epoch: 15, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6857814788818359
Epoch: 16, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.7600417137145996
Epoch: 17, Steps: 1 | Train Loss: 0.405 Vali Loss: 0.999 Vali Acc: 0.400 Test Loss: 0.999 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7605628967285156
Epoch: 18, Steps: 1 | Train Loss: 0.379 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 0.6128675937652588
Epoch: 19, Steps: 1 | Train Loss: 0.297 Vali Loss: 0.985 Vali Acc: 0.400 Test Loss: 0.985 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6153576374053955
Epoch: 20, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7019751071929932
Epoch: 21, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8841521739959717
Epoch: 22, Steps: 1 | Train Loss: 0.180 Vali Loss: 0.999 Vali Acc: 0.400 Test Loss: 0.999 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6342113018035889
Epoch: 23, Steps: 1 | Train Loss: 0.127 Vali Loss: 0.973 Vali Acc: 0.400 Test Loss: 0.973 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8354806900024414
Epoch: 24, Steps: 1 | Train Loss: 0.112 Vali Loss: 0.976 Vali Acc: 0.467 Test Loss: 0.976 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 25 cost time: 0.7305316925048828
Epoch: 25, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6341242790222168
Epoch: 26, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6506407260894775
Epoch: 27, Steps: 1 | Train Loss: 0.044 Vali Loss: 0.999 Vali Acc: 0.333 Test Loss: 0.999 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6620707511901855
Epoch: 28, Steps: 1 | Train Loss: 0.027 Vali Loss: 0.998 Vali Acc: 0.333 Test Loss: 0.998 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.805687427520752
Epoch: 29, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.013 Vali Acc: 0.333 Test Loss: 1.013 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7502315044403076
Epoch: 30, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.784369945526123
Epoch: 31, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6739425659179688
Epoch: 32, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.677802562713623
Epoch: 33, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.78468918800354
Epoch: 34, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4040627
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.550584554672241
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7440884113311768
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7723569869995117
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7720293998718262
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9682409763336182
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9154770374298096
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7385678291320801
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8032665252685547
Epoch: 8, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8029494285583496
Epoch: 9, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.751563310623169
Epoch: 10, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7054741382598877
Epoch: 11, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7630681991577148
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 13 cost time: 0.7139115333557129
Epoch: 13, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9184346199035645
Epoch: 14, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8051173686981201
Epoch: 15, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7541847229003906
Epoch: 16, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7891786098480225
Epoch: 17, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.7537219524383545
Epoch: 18, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.696652889251709
Epoch: 19, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8172390460968018
Epoch: 20, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.833606481552124
Epoch: 21, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.74627685546875
Epoch: 22, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9881918430328369
Epoch: 23, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8931176662445068
Epoch: 24, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8825602531433105
Epoch: 25, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8749866485595703
Epoch: 26, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6970570087432861
Epoch: 27, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3993651
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.550550699234009
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.775144100189209
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.679145336151123
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.199989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6207964420318604
Epoch: 4, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7029972076416016
Epoch: 5, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.70194411277771
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9232566356658936
Epoch: 7, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8340115547180176
Epoch: 8, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7184205055236816
Epoch: 9, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6678133010864258
Epoch: 10, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7251813411712646
Epoch: 11, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6980323791503906
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8151991367340088
Epoch: 13, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.723395586013794
Epoch: 14, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7647716999053955
Epoch: 15, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8723084926605225
Epoch: 16, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8199174404144287
Epoch: 17, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7325963973999023
Epoch: 18, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7437117099761963
Epoch: 19, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8487062454223633
Epoch: 20, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.674860954284668
Epoch: 21, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.064 Vali Acc: 0.133 Test Loss: 1.064 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8503274917602539
Epoch: 22, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.075 Vali Acc: 0.200 Test Loss: 1.075 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8461332321166992
Epoch: 23, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8343729972839355
Epoch: 24, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.824594259262085
Epoch: 25, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7413856983184814
Epoch: 26, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7041170597076416
Epoch: 27, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8133018016815186
Epoch: 28, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6834936141967773
Epoch: 29, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7772355079650879
Epoch: 30, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3946675
model size : 17.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.083406925201416
Epoch: 1, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8343045711517334
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7523195743560791
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7302262783050537
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8740718364715576
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9885344505310059
Epoch: 6, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0914182662963867
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7247872352600098
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7334563732147217
Epoch: 9, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7658557891845703
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7741641998291016
Epoch: 11, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8814964294433594
Epoch: 12, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8084192276000977
Epoch: 13, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.9156808853149414
Epoch: 14, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.720076322555542
Epoch: 15, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.8111631870269775
Epoch: 16, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8596065044403076
Epoch: 17, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.715268611907959
Epoch: 18, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7002325057983398
Epoch: 19, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.830681324005127
Epoch: 20, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7556560039520264
Epoch: 21, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8717770576477051
Epoch: 22, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.842313289642334
Epoch: 23, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9831233024597168
Epoch: 24, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0822539329528809
Epoch: 25, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6905684471130371
Epoch: 26, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9229030609130859
Epoch: 27, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.652106523513794
Epoch: 28, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7466263771057129
Epoch: 29, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8199255466461182
Epoch: 30, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8645496368408203
Epoch: 31, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.310 Vali Acc: 0.267 Test Loss: 1.310 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6994683742523193
Epoch: 32, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.372 Vali Acc: 0.333 Test Loss: 1.372 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3166515
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7766737937927246
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8518288135528564
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9256308078765869
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9668545722961426
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9222877025604248
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.0777921676635742
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9290149211883545
Epoch: 7, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0746088027954102
Epoch: 8, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7635562419891357
Epoch: 9, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7737207412719727
Epoch: 10, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.860619306564331
Epoch: 11, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9927349090576172
Epoch: 12, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6852734088897705
Epoch: 13, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.9821960926055908
Epoch: 14, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8698384761810303
Epoch: 15, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0464906692504883
Epoch: 16, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0110292434692383
Epoch: 17, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1005847454071045
Epoch: 18, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.997035026550293
Epoch: 19, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7783558368682861
Epoch: 20, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0053961277008057
Epoch: 21, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0737686157226562
Epoch: 22, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9026813507080078
Epoch: 23, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3119539
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8694241046905518
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.9556257724761963
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.104 Vali Acc: 0.133 Test Loss: 1.104 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7516477108001709
Epoch: 3, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8099989891052246
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8937149047851562
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8514952659606934
Epoch: 6, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9139692783355713
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.039867639541626
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8383357524871826
Epoch: 9, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9706277847290039
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8636176586151123
Epoch: 11, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7779097557067871
Epoch: 12, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8820600509643555
Epoch: 13, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.7270348072052002
Epoch: 14, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.064 Vali Acc: 0.267 Test Loss: 1.064 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7626833915710449
Epoch: 15, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8881020545959473
Epoch: 16, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8218293190002441
Epoch: 17, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.745065450668335
Epoch: 18, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6740350723266602
Epoch: 19, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1101741790771484
Epoch: 20, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8292319774627686
Epoch: 21, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5028645992279053
Epoch: 22, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 1.0391862392425537
Epoch: 23, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0426549911499023
Epoch: 24, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.835552453994751
Epoch: 25, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0394783020019531
Epoch: 26, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8691210746765137
Epoch: 27, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.788278341293335
Epoch: 28, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8365633487701416
Epoch: 29, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0222222805023193
Epoch: 30, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.00740647315979
Epoch: 31, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7366034984588623
Epoch: 32, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3072563
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0956687927246094
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8610367774963379
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7973763942718506
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8041436672210693
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7958970069885254
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9994676113128662
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9175248146057129
Epoch: 7, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9202816486358643
Epoch: 8, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0647549629211426
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8775718212127686
Epoch: 10, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4229786396026611
Epoch: 11, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8508074283599854
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9331645965576172
Epoch: 13, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 1.2727882862091064
Epoch: 14, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9991450309753418
Epoch: 15, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8168439865112305
Epoch: 16, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.898817777633667
Epoch: 17, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9445343017578125
Epoch: 18, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0093026161193848
Epoch: 19, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9076592922210693
Epoch: 20, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.832449197769165
Epoch: 21, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7666177749633789
Epoch: 22, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8738675117492676
Epoch: 23, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3025587
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6565229892730713
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7483382225036621
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8014950752258301
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7443907260894775
Epoch: 4, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7504189014434814
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7178330421447754
Epoch: 6, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8463544845581055
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7662820816040039
Epoch: 8, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6818504333496094
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7614953517913818
Epoch: 10, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.8166987895965576
Epoch: 11, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7655854225158691
Epoch: 12, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9314010143280029
Epoch: 13, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8038210868835449
Epoch: 14, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8694150447845459
Epoch: 15, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.760138988494873
Epoch: 16, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6805953979492188
Epoch: 17, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.8149199485778809
Epoch: 18, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.753303050994873
Epoch: 19, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 1.1771254539489746
Epoch: 20, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.7949988842010498
Epoch: 21, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8376424312591553
Epoch: 22, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9958827495574951
Epoch: 23, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7981753349304199
Epoch: 24, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8198919296264648
Epoch: 25, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7340235710144043
Epoch: 26, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.845592737197876
Epoch: 27, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9319567680358887
Epoch: 28, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9235966205596924
Epoch: 29, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7963409423828125
Epoch: 30, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2705971
model size : 12.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.672154188156128
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8531079292297363
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8921158313751221
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0041849613189697
Epoch: 4, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8724300861358643
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.70442795753479
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7863574028015137
Epoch: 7, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9541361331939697
Epoch: 8, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8893942832946777
Epoch: 9, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.9692716598510742
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.041236162185669
Epoch: 11, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.057 Vali Acc: 0.267 Test Loss: 1.057 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1352500915527344
Epoch: 12, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.99591064453125
Epoch: 13, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.746638298034668
Epoch: 14, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.029768466949463
Epoch: 15, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.9908254146575928
Epoch: 16, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.8426907062530518
Epoch: 17, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.030 Vali Acc: 0.333 Test Loss: 1.030 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8165764808654785
Epoch: 18, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8281779289245605
Epoch: 19, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.823469877243042
Epoch: 20, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9142277240753174
Epoch: 21, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.025 Vali Acc: 0.267 Test Loss: 1.025 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7509510517120361
Epoch: 22, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6313436031341553
Epoch: 23, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9143288135528564
Epoch: 24, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7382049560546875
Epoch: 25, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.832791805267334
Epoch: 26, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2658995
model size : 12.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5035972595214844
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.2332756519317627
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0107812881469727
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.885352611541748
Epoch: 4, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.0712497234344482
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1678340435028076
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9111301898956299
Epoch: 7, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.917027473449707
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1298651695251465
Epoch: 9, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.782001256942749
Epoch: 10, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0481219291687012
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0112226009368896
Epoch: 12, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0885953903198242
Epoch: 13, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0302996635437012
Epoch: 14, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.082597017288208
Epoch: 15, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0739171504974365
Epoch: 16, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9016280174255371
Epoch: 17, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9854898452758789
Epoch: 18, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1374495029449463
Epoch: 19, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2612019
model size : 12.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1542179584503174
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8382322788238525
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9091100692749023
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8876428604125977
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1468040943145752
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.973560094833374
Epoch: 6, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.8718955516815186
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8694949150085449
Epoch: 8, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9645354747772217
Epoch: 9, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8384840488433838
Epoch: 10, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.008254051208496
Epoch: 11, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2833857536315918
Epoch: 12, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.122196912765503
Epoch: 13, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7711260318756104
Epoch: 14, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.031900405883789
Epoch: 15, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.8722317218780518
Epoch: 16, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9430763721466064
Epoch: 17, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9093172550201416
Epoch: 18, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9485907554626465
Epoch: 19, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7358129024505615
Epoch: 20, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7891993522644043
Epoch: 21, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6653532981872559
Epoch: 22, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.7681598663330078
Epoch: 23, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7978243827819824
Epoch: 24, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0615241527557373
Epoch: 25, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.256 Vali Acc: 0.400 Test Loss: 1.256 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9217824935913086
Epoch: 26, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8333992958068848
Epoch: 27, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8061232566833496
Epoch: 28, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8426761627197266
Epoch: 29, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8834209442138672
Epoch: 30, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9796004295349121
Epoch: 31, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.302 Vali Acc: 0.333 Test Loss: 1.302 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9454867839813232
Epoch: 32, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2565043
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.282238006591797
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.1243889331817627
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9110889434814453
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3147568702697754
Epoch: 4, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9083366394042969
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8396780490875244
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8448293209075928
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2253122329711914
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0214624404907227
Epoch: 9, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9475886821746826
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.0709526538848877
Epoch: 11, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9774842262268066
Epoch: 12, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9780340194702148
Epoch: 13, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8441433906555176
Epoch: 14, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 1.2098984718322754
Epoch: 15, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2500905990600586
Epoch: 16, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2258782386779785
Epoch: 17, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8321497440338135
Epoch: 18, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0621469020843506
Epoch: 19, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.055 Vali Acc: 0.267 Test Loss: 1.055 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9849686622619629
Epoch: 20, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7354137897491455
Epoch: 21, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1429316997528076
Epoch: 22, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0697274208068848
Epoch: 23, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0046613216400146
Epoch: 24, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2475699
model size : 12.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3131966590881348
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.9716494083404541
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7619681358337402
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0107815265655518
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2867028713226318
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7109756469726562
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.7994992733001709
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8783128261566162
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9275081157684326
Epoch: 9, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8228623867034912
Epoch: 10, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9140539169311523
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7643537521362305
Epoch: 12, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7811906337738037
Epoch: 13, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.739701509475708
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.8308796882629395
Epoch: 15, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.8056762218475342
Epoch: 16, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.023 Vali Acc: 0.400 Test Loss: 1.023 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7420921325683594
Epoch: 17, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.028 Vali Acc: 0.333 Test Loss: 1.028 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.860464334487915
Epoch: 18, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.016 Vali Acc: 0.333 Test Loss: 1.016 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.020578145980835
Epoch: 19, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.012 Vali Acc: 0.400 Test Loss: 1.012 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9860951900482178
Epoch: 20, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.9886643886566162
Epoch: 21, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.759258508682251
Epoch: 22, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.012 Vali Acc: 0.333 Test Loss: 1.012 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0805392265319824
Epoch: 23, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8486709594726562
Epoch: 24, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.032 Vali Acc: 0.267 Test Loss: 1.032 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0346858501434326
Epoch: 25, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0541915893554688
Epoch: 26, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0204946994781494
Epoch: 27, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8376634120941162
Epoch: 28, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.033 Vali Acc: 0.333 Test Loss: 1.033 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7820601463317871
Epoch: 29, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7450282573699951
Epoch: 30, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2428723
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.988612174987793
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8976786136627197
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9207980632781982
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7655677795410156
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.841681718826294
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9780194759368896
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7701096534729004
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7894067764282227
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1019916534423828
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7758822441101074
Epoch: 10, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0904057025909424
Epoch: 11, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1131012439727783
Epoch: 12, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.939600944519043
Epoch: 13, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8407166004180908
Epoch: 14, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.8219029903411865
Epoch: 15, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1063556671142578
Epoch: 16, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8215532302856445
Epoch: 17, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7683935165405273
Epoch: 18, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0854957103729248
Epoch: 19, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8414928913116455
Epoch: 20, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9954793453216553
Epoch: 21, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9750816822052002
Epoch: 22, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.961700439453125
Epoch: 23, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8829421997070312
Epoch: 24, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8535418510437012
Epoch: 25, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1452550888061523
Epoch: 26, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2557389736175537
Epoch: 27, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.142481803894043
Epoch: 28, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8712992668151855
Epoch: 29, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.020345687866211
Epoch: 30, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8378140926361084
Epoch: 31, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2381747
model size : 11.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8190462589263916
Epoch: 1, Steps: 1 | Train Loss: 1.376 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7604925632476807
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8236374855041504
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8209028244018555
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6763017177581787
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7902064323425293
Epoch: 6, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.0060324668884277
Epoch: 7, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7783663272857666
Epoch: 8, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9551990032196045
Epoch: 9, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9650702476501465
Epoch: 10, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7486922740936279
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.7318966388702393
Epoch: 12, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8194804191589355
Epoch: 13, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7745559215545654
Epoch: 14, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7777094841003418
Epoch: 15, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8428781032562256
Epoch: 16, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9732787609100342
Epoch: 17, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7194638252258301
Epoch: 18, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.8062970638275146
Epoch: 19, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8555705547332764
Epoch: 20, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7854938507080078
Epoch: 21, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.7409520149230957
Epoch: 22, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6810567378997803
Epoch: 23, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5887293815612793
Epoch: 24, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9356241226196289
Epoch: 25, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7465934753417969
Epoch: 26, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0159685611724854
Epoch: 27, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8633694648742676
Epoch: 28, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3510410785675049
Epoch: 29, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8141353130340576
Epoch: 30, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0006036758422852
Epoch: 31, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2334771
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3523645401000977
Epoch: 1, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.9333951473236084
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8483891487121582
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0927793979644775
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5090272426605225
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.9087717533111572
Epoch: 6, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8721013069152832
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.013319492340088
Epoch: 8, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.080456018447876
Epoch: 9, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2603707313537598
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 1.2192554473876953
Epoch: 11, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0111064910888672
Epoch: 12, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1074016094207764
Epoch: 13, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0038354396820068
Epoch: 14, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9273827075958252
Epoch: 15, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0069918632507324
Epoch: 16, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9330511093139648
Epoch: 17, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8393721580505371
Epoch: 18, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3442940711975098
Epoch: 19, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.9656422138214111
Epoch: 20, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9784162044525146
Epoch: 21, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0630505084991455
Epoch: 22, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 23 cost time: 0.9632461071014404
Epoch: 23, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.065932035446167
Epoch: 24, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0848464965820312
Epoch: 25, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9298899173736572
Epoch: 26, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9401764869689941
Epoch: 27, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 1.0628347396850586
Epoch: 28, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.184 Vali Acc: 0.533 Test Loss: 1.184 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8990776538848877
Epoch: 29, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9801051616668701
Epoch: 30, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8814747333526611
Epoch: 31, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1489827632904053
Epoch: 32, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9355645179748535
Epoch: 33, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.104119062423706
Epoch: 34, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1548569202423096
Epoch: 35, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9066479206085205
Epoch: 36, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0390856266021729
Epoch: 37, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1588659
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1946334838867188
Epoch: 1, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8165364265441895
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9619886875152588
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9314942359924316
Epoch: 4, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9833829402923584
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.992194652557373
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.777470588684082
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.952157735824585
Epoch: 8, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8093831539154053
Epoch: 9, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8534958362579346
Epoch: 10, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.79805588722229
Epoch: 11, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8874318599700928
Epoch: 12, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9175589084625244
Epoch: 13, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.97379469871521
Epoch: 14, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.818230152130127
Epoch: 15, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.9173672199249268
Epoch: 16, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.7772135734558105
Epoch: 17, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8925931453704834
Epoch: 18, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8688826560974121
Epoch: 19, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8541054725646973
Epoch: 20, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9135844707489014
Epoch: 21, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7676200866699219
Epoch: 22, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.038294792175293
Epoch: 23, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9418501853942871
Epoch: 24, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.074 Vali Acc: 0.267 Test Loss: 1.074 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.885218620300293
Epoch: 25, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.006457805633545
Epoch: 26, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0940401554107666
Epoch: 27, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8792455196380615
Epoch: 28, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8659870624542236
Epoch: 29, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1565171
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.704258441925049
Epoch: 1, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0738334655761719
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7237687110900879
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9464719295501709
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9205143451690674
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8260514736175537
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.994757890701294
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.717707633972168
Epoch: 8, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.8630640506744385
Epoch: 9, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7990167140960693
Epoch: 10, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.9391121864318848
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.893357515335083
Epoch: 12, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.0593297481536865
Epoch: 13, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.9955179691314697
Epoch: 14, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2041263580322266
Epoch: 15, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0206797122955322
Epoch: 16, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.036374807357788
Epoch: 17, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9624967575073242
Epoch: 18, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9688162803649902
Epoch: 19, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.957343578338623
Epoch: 20, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.1888442039489746
Epoch: 21, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 1.1016309261322021
Epoch: 22, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2418556213378906
Epoch: 23, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2272932529449463
Epoch: 24, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3088219165802002
Epoch: 25, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3858697414398193
Epoch: 26, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.424457311630249
Epoch: 27, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3513526916503906
Epoch: 28, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2857685089111328
Epoch: 29, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9082581996917725
Epoch: 30, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1765170097351074
Epoch: 31, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1541683
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.177006959915161
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9086153507232666
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0078155994415283
Epoch: 3, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9948866367340088
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9043009281158447
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7787735462188721
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8702692985534668
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9193778038024902
Epoch: 8, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.007603406906128
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.894148588180542
Epoch: 10, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8592071533203125
Epoch: 11, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9168429374694824
Epoch: 12, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8459162712097168
Epoch: 13, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0328192710876465
Epoch: 14, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0668859481811523
Epoch: 15, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.066209077835083
Epoch: 16, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2202577590942383
Epoch: 17, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9036526679992676
Epoch: 18, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0949254035949707
Epoch: 19, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9732987880706787
Epoch: 20, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8940625190734863
Epoch: 21, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.895798921585083
Epoch: 22, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8078269958496094
Epoch: 23, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9118359088897705
Epoch: 24, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5088369846343994
Epoch: 25, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8391573429107666
Epoch: 26, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0983891487121582
Epoch: 27, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9021546840667725
Epoch: 28, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8103437423706055
Epoch: 29, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9621016979217529
Epoch: 30, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.048 Vali Acc: 0.267 Test Loss: 1.048 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8512201309204102
Epoch: 31, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1518195
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.375555992126465
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1256392002105713
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5565154552459717
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.0315544605255127
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9605441093444824
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9153532981872559
Epoch: 6, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9660422801971436
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9534173011779785
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.083592414855957
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8412635326385498
Epoch: 10, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7360637187957764
Epoch: 11, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0362534523010254
Epoch: 12, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2966349124908447
Epoch: 13, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1126323
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.143519639968872
Epoch: 1, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0000879764556885
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.91908860206604
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8627865314483643
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8945028781890869
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9109060764312744
Epoch: 6, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2641019821166992
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.171 Vali Acc: 0.067 Test Loss: 1.171 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0109338760375977
Epoch: 8, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0368759632110596
Epoch: 9, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2419729232788086
Epoch: 10, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.190244436264038
Epoch: 11, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.789078950881958
Epoch: 12, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1102835
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9678924083709717
Epoch: 1, Steps: 1 | Train Loss: 1.382 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7394156455993652
Epoch: 2, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6506571769714355
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1108579635620117
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7514572143554688
Epoch: 5, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9926414489746094
Epoch: 6, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7871019840240479
Epoch: 7, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.656015157699585
Epoch: 8, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8816606998443604
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9548802375793457
Epoch: 10, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8220090866088867
Epoch: 11, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7822103500366211
Epoch: 12, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7433183193206787
Epoch: 13, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7220849990844727
Epoch: 14, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1079347
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.944486141204834
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9114081859588623
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.163 Vali Acc: 0.067 Test Loss: 1.163 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.855006217956543
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.671494722366333
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.914893388748169
Epoch: 5, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7833325862884521
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8012375831604004
Epoch: 7, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6729035377502441
Epoch: 8, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9585905075073242
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8447346687316895
Epoch: 10, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.867621660232544
Epoch: 11, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1055859
model size : 5.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.674809694290161
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.8519396781921387
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8754503726959229
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9150445461273193
Epoch: 4, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9314854145050049
Epoch: 5, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9683558940887451
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0096912384033203
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8547203540802002
Epoch: 8, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9055688381195068
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7323532104492188
Epoch: 10, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9923632144927979
Epoch: 11, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 895155
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7252187728881836
Epoch: 1, Steps: 1 | Train Loss: 1.320 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8512308597564697
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7903110980987549
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7195842266082764
Epoch: 4, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7408795356750488
Epoch: 5, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5881929397583008
Epoch: 6, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.825934886932373
Epoch: 7, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7742226123809814
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7729072570800781
Epoch: 9, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2523038387298584
Epoch: 10, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7000877857208252
Epoch: 11, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6963014602661133
Epoch: 12, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6733229160308838
Epoch: 13, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 871667
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.720381021499634
Epoch: 1, Steps: 1 | Train Loss: 1.374 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8393702507019043
Epoch: 2, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7829222679138184
Epoch: 3, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.6454930305480957
Epoch: 4, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7662811279296875
Epoch: 5, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7763898372650146
Epoch: 6, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8453764915466309
Epoch: 7, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7065534591674805
Epoch: 8, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.8416695594787598
Epoch: 9, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8884644508361816
Epoch: 10, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.762462854385376
Epoch: 11, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9683985710144043
Epoch: 12, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9211893081665039
Epoch: 13, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7436051368713379
Epoch: 14, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8361690044403076
Epoch: 15, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.759284257888794
Epoch: 16, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8676393032073975
Epoch: 17, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.748305082321167
Epoch: 18, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.7957973480224609
Epoch: 19, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8444561958312988
Epoch: 20, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7629721164703369
Epoch: 21, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7886762619018555
Epoch: 22, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8176207542419434
Epoch: 23, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9303016662597656
Epoch: 24, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9390866756439209
Epoch: 25, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.91310715675354
Epoch: 26, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7375733852386475
Epoch: 27, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.035 Vali Acc: 0.267 Test Loss: 1.035 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9035494327545166
Epoch: 28, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.034 Vali Acc: 0.267 Test Loss: 1.034 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 848179
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4090654850006104
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1908400058746338
Epoch: 2, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1081807613372803
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1543095111846924
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6756424903869629
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9295549392700195
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6961839199066162
Epoch: 7, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2764744758605957
Epoch: 8, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1613571643829346
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9729094505310059
Epoch: 10, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8487958908081055
Epoch: 11, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1515231132507324
Epoch: 12, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.8744287490844727
Epoch: 13, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.8436856269836426
Epoch: 14, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.8128361701965332
Epoch: 15, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.7563509941101074
Epoch: 16, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1429529190063477
Epoch: 17, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.812941312789917
Epoch: 18, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9244399070739746
Epoch: 19, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9222109317779541
Epoch: 20, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8271112442016602
Epoch: 21, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7584776878356934
Epoch: 22, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.7481088638305664
Epoch: 23, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8906979560852051
Epoch: 24, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8733913898468018
Epoch: 25, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2670412063598633
Epoch: 26, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7928187847137451
Epoch: 27, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4038074016571045
Epoch: 28, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.850407600402832
Epoch: 29, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1884279251098633
Epoch: 30, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.849869966506958
Epoch: 31, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0506126880645752
Epoch: 32, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 824691
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.954434633255005
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0950415134429932
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7193710803985596
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9085187911987305
Epoch: 4, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7405524253845215
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5971431732177734
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.00514554977417
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.754974365234375
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9404630661010742
Epoch: 9, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8516840934753418
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7590811252593994
Epoch: 11, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.9341826438903809
Epoch: 12, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6795976161956787
Epoch: 13, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9640161991119385
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0573854446411133
Epoch: 15, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0098528861999512
Epoch: 16, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9050054550170898
Epoch: 17, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7675924301147461
Epoch: 18, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9014606475830078
Epoch: 19, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7213258743286133
Epoch: 20, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.8954217433929443
Epoch: 21, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7331068515777588
Epoch: 22, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0013017654418945
Epoch: 23, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3376004695892334
Epoch: 24, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.963362455368042
Epoch: 25, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0036613941192627
Epoch: 26, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9273161888122559
Epoch: 27, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2989213466644287
Epoch: 28, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 1.4020538330078125
Epoch: 29, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8366150856018066
Epoch: 30, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7633516788482666
Epoch: 31, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7523808479309082
Epoch: 32, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9321272373199463
Epoch: 33, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.037 Vali Acc: 0.267 Test Loss: 1.037 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9975385665893555
Epoch: 34, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0016543865203857
Epoch: 35, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9294302463531494
Epoch: 36, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2878913879394531
Epoch: 37, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1192359924316406
Epoch: 38, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 779571
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.972337484359741
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.8422608375549316
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0114514827728271
Epoch: 3, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7481951713562012
Epoch: 4, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.7545750141143799
Epoch: 5, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6792852878570557
Epoch: 6, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.7713046073913574
Epoch: 7, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8858685493469238
Epoch: 8, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.8373227119445801
Epoch: 9, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.0087611675262451
Epoch: 10, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.7385587692260742
Epoch: 11, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.8843202590942383
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.792142391204834
Epoch: 13, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8474955558776855
Epoch: 14, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.7095298767089844
Epoch: 15, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.8071980476379395
Epoch: 16, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9235405921936035
Epoch: 17, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 18 cost time: 1.1712007522583008
Epoch: 18, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 19 cost time: 0.7091398239135742
Epoch: 19, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0610806941986084
Epoch: 20, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8271975517272949
Epoch: 21, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7628390789031982
Epoch: 22, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8598182201385498
Epoch: 23, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9754366874694824
Epoch: 24, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8504493236541748
Epoch: 25, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8462038040161133
Epoch: 26, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7282097339630127
Epoch: 27, Steps: 1 | Train Loss: 0.376 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7650220394134521
Epoch: 28, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 756083
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7593295574188232
Epoch: 1, Steps: 1 | Train Loss: 1.338 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.005368709564209
Epoch: 2, Steps: 1 | Train Loss: 1.254 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.6791589260101318
Epoch: 3, Steps: 1 | Train Loss: 1.179 Vali Loss: 0.986 Vali Acc: 0.667 Test Loss: 0.986 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.8371033668518066
Epoch: 4, Steps: 1 | Train Loss: 1.156 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.076678991317749
Epoch: 5, Steps: 1 | Train Loss: 1.156 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8574397563934326
Epoch: 6, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0348281860351562
Epoch: 7, Steps: 1 | Train Loss: 1.143 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1330318450927734
Epoch: 8, Steps: 1 | Train Loss: 1.049 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0471160411834717
Epoch: 9, Steps: 1 | Train Loss: 1.078 Vali Loss: 0.974 Vali Acc: 0.733 Test Loss: 0.974 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 1.2826027870178223
Epoch: 10, Steps: 1 | Train Loss: 1.049 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8032059669494629
Epoch: 11, Steps: 1 | Train Loss: 0.984 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9044284820556641
Epoch: 12, Steps: 1 | Train Loss: 0.979 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2347393035888672
Epoch: 13, Steps: 1 | Train Loss: 0.952 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.8719203472137451
Epoch: 14, Steps: 1 | Train Loss: 0.896 Vali Loss: 0.960 Vali Acc: 0.733 Test Loss: 0.960 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.8674252033233643
Epoch: 15, Steps: 1 | Train Loss: 0.851 Vali Loss: 0.960 Vali Acc: 0.733 Test Loss: 0.960 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7810623645782471
Epoch: 16, Steps: 1 | Train Loss: 0.853 Vali Loss: 0.956 Vali Acc: 0.733 Test Loss: 0.956 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.8383207321166992
Epoch: 17, Steps: 1 | Train Loss: 0.803 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9086172580718994
Epoch: 18, Steps: 1 | Train Loss: 0.687 Vali Loss: 0.945 Vali Acc: 0.800 Test Loss: 0.945 Test Acc: 0.800
Validation loss decreased (-0.733324 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.8503539562225342
Epoch: 19, Steps: 1 | Train Loss: 0.695 Vali Loss: 0.937 Vali Acc: 0.733 Test Loss: 0.937 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8312504291534424
Epoch: 20, Steps: 1 | Train Loss: 0.659 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8576304912567139
Epoch: 21, Steps: 1 | Train Loss: 0.616 Vali Loss: 0.931 Vali Acc: 0.733 Test Loss: 0.931 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7515225410461426
Epoch: 22, Steps: 1 | Train Loss: 0.608 Vali Loss: 0.929 Vali Acc: 0.667 Test Loss: 0.929 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7923178672790527
Epoch: 23, Steps: 1 | Train Loss: 0.564 Vali Loss: 0.924 Vali Acc: 0.733 Test Loss: 0.924 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9448132514953613
Epoch: 24, Steps: 1 | Train Loss: 0.510 Vali Loss: 0.915 Vali Acc: 0.733 Test Loss: 0.915 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8254342079162598
Epoch: 25, Steps: 1 | Train Loss: 0.499 Vali Loss: 0.910 Vali Acc: 0.733 Test Loss: 0.910 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6911067962646484
Epoch: 26, Steps: 1 | Train Loss: 0.406 Vali Loss: 0.910 Vali Acc: 0.667 Test Loss: 0.910 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7267775535583496
Epoch: 27, Steps: 1 | Train Loss: 0.358 Vali Loss: 0.912 Vali Acc: 0.600 Test Loss: 0.912 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8103117942810059
Epoch: 28, Steps: 1 | Train Loss: 0.382 Vali Loss: 0.905 Vali Acc: 0.733 Test Loss: 0.905 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.8
model parameter : 732595
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8601489067077637
Epoch: 1, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.8200626373291016
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.844897985458374
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0359418392181396
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0734190940856934
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.7458655834197998
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9206864833831787
Epoch: 7, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0304462909698486
Epoch: 8, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0660021305084229
Epoch: 9, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7784652709960938
Epoch: 10, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9276723861694336
Epoch: 11, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8332424163818359
Epoch: 12, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9475395679473877
Epoch: 13, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0116238594055176
Epoch: 14, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.007110834121704
Epoch: 15, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 709107
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1616034507751465
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8177270889282227
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.199989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.713228702545166
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6527090072631836
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8623373508453369
Epoch: 5, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8516440391540527
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9682083129882812
Epoch: 7, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.020676612854004
Epoch: 8, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.9095966815948486
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9493222236633301
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9946379661560059
Epoch: 11, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.041353702545166
Epoch: 12, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.774360179901123
Epoch: 13, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0453760623931885
Epoch: 14, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9119784832000732
Epoch: 15, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.6812922954559326
Epoch: 16, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.814216136932373
Epoch: 17, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.034386396408081
Epoch: 18, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8910253047943115
Epoch: 19, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.996309757232666
Epoch: 20, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.115384578704834
Epoch: 21, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 1.093775749206543
Epoch: 22, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7743539810180664
Epoch: 23, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9112875461578369
Epoch: 24, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7595913410186768
Epoch: 25, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 26 cost time: 1.0720953941345215
Epoch: 26, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7219023704528809
Epoch: 27, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7909958362579346
Epoch: 28, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7439706325531006
Epoch: 29, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6382746696472168
Epoch: 30, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7231433391571045
Epoch: 31, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8242478370666504
Epoch: 32, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7054886817932129
Epoch: 33, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0001957416534424
Epoch: 34, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9917194843292236
Epoch: 35, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 683251
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8023080825805664
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.901360034942627
Epoch: 2, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8139779567718506
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.850405216217041
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.853217601776123
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9139814376831055
Epoch: 6, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.0439307689666748
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8950858116149902
Epoch: 8, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.8647475242614746
Epoch: 9, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7890286445617676
Epoch: 10, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0441484451293945
Epoch: 11, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8987784385681152
Epoch: 12, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9439589977264404
Epoch: 13, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0469677448272705
Epoch: 14, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1444566249847412
Epoch: 15, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9025046825408936
Epoch: 16, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2842183113098145
Epoch: 17, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8237297534942627
Epoch: 18, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 671507
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.279937744140625
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8071208000183105
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.7768599987030029
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8505022525787354
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7575340270996094
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7247633934020996
Epoch: 6, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.7785041332244873
Epoch: 7, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.8154075145721436
Epoch: 8, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8776164054870605
Epoch: 9, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8270859718322754
Epoch: 10, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2062904834747314
Epoch: 11, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7464566230773926
Epoch: 12, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8803150653839111
Epoch: 13, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7716288566589355
Epoch: 14, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8573570251464844
Epoch: 15, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8413612842559814
Epoch: 16, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8137023448944092
Epoch: 17, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 659763
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.95085072517395
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8560013771057129
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8032352924346924
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.755037784576416
Epoch: 4, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.009446144104004
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.079153299331665
Epoch: 6, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9823997020721436
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8455350399017334
Epoch: 8, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7699580192565918
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.950124979019165
Epoch: 10, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0123522281646729
Epoch: 11, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.964289665222168
Epoch: 12, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7523939609527588
Epoch: 13, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.058673620223999
Epoch: 14, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8118627071380615
Epoch: 15, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7907555103302002
Epoch: 16, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.905543327331543
Epoch: 17, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7667925357818604
Epoch: 18, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.7326266765594482
Epoch: 19, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9652221202850342
Epoch: 20, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.9404647350311279
Epoch: 21, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0673184394836426
Epoch: 22, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8454239368438721
Epoch: 23, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.792649507522583
Epoch: 24, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9481887817382812
Epoch: 25, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0796911716461182
Epoch: 26, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7863497734069824
Epoch: 27, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9388360977172852
Epoch: 28, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4358341693878174
Epoch: 29, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2404520511627197
Epoch: 30, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 648019
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8018391132354736
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7266402244567871
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.826444149017334
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7792007923126221
Epoch: 4, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7322769165039062
Epoch: 5, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.8054277896881104
Epoch: 6, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.7414987087249756
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.8841726779937744
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.846433162689209
Epoch: 9, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.073 Vali Acc: 0.667 Test Loss: 1.073 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.6720354557037354
Epoch: 10, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.992133617401123
Epoch: 11, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7834069728851318
Epoch: 12, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.078883409500122
Epoch: 13, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6760399341583252
Epoch: 14, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7935237884521484
Epoch: 15, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9167628288269043
Epoch: 16, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.820448637008667
Epoch: 17, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2230801582336426
Epoch: 18, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8963682651519775
Epoch: 19, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 450291
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.150402784347534
Epoch: 1, Steps: 1 | Train Loss: 1.350 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.031766653060913
Epoch: 2, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0034558773040771
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.7686514854431152
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.829674482345581
Epoch: 5, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9818298816680908
Epoch: 6, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8180651664733887
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9952750205993652
Epoch: 8, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8155434131622314
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8603017330169678
Epoch: 10, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7092015743255615
Epoch: 11, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0996918678283691
Epoch: 12, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0229732990264893
Epoch: 13, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 438547
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1291162967681885
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0055489540100098
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7651844024658203
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8903088569641113
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.062077283859253
Epoch: 5, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7624139785766602
Epoch: 6, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9549202919006348
Epoch: 7, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8906331062316895
Epoch: 8, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8385004997253418
Epoch: 9, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0730035305023193
Epoch: 10, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8588199615478516
Epoch: 11, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6576573848724365
Epoch: 12, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 426803
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6064963340759277
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9935717582702637
Epoch: 2, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7902085781097412
Epoch: 3, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7731220722198486
Epoch: 4, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8464090824127197
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.790203332901001
Epoch: 6, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7766876220703125
Epoch: 7, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.883824348449707
Epoch: 8, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.668752908706665
Epoch: 9, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.8623020648956299
Epoch: 10, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.8412210941314697
Epoch: 11, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.6379914283752441
Epoch: 12, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.7034618854522705
Epoch: 13, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.624732494354248
Epoch: 14, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6886441707611084
Epoch: 15, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.673912763595581
Epoch: 16, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.8080191612243652
Epoch: 17, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7426695823669434
Epoch: 18, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7520568370819092
Epoch: 19, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9285590648651123
Epoch: 20, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7333202362060547
Epoch: 21, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7941153049468994
Epoch: 22, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8065686225891113
Epoch: 23, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6077258586883545
Epoch: 24, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8146326541900635
Epoch: 25, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8152904510498047
Epoch: 26, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 415059
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.610241651535034
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8141157627105713
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6602394580841064
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6812384128570557
Epoch: 4, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7432937622070312
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9106588363647461
Epoch: 6, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7811000347137451
Epoch: 7, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8882896900177002
Epoch: 8, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7308499813079834
Epoch: 9, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.143 Vali Acc: 0.133 Test Loss: 1.143 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.046792984008789
Epoch: 10, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7365293502807617
Epoch: 11, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0062053203582764
Epoch: 12, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7431440353393555
Epoch: 13, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.7324793338775635
Epoch: 14, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7525243759155273
Epoch: 15, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.6585092544555664
Epoch: 16, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.7218289375305176
Epoch: 17, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9779601097106934
Epoch: 18, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8855087757110596
Epoch: 19, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.9356250762939453
Epoch: 20, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9046497344970703
Epoch: 21, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9117162227630615
Epoch: 22, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 1.0135228633880615
Epoch: 23, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9900193214416504
Epoch: 24, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7633910179138184
Epoch: 25, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.675199031829834
Epoch: 26, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7062885761260986
Epoch: 27, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7790336608886719
Epoch: 28, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7807049751281738
Epoch: 29, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8069052696228027
Epoch: 30, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7416465282440186
Epoch: 31, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.849646806716919
Epoch: 32, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 0.812774658203125
Epoch: 33, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0249528884887695
Epoch: 34, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8977980613708496
Epoch: 35, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8946049213409424
Epoch: 36, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.920074462890625
Epoch: 37, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0223984718322754
Epoch: 38, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7476136684417725
Epoch: 39, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9189226627349854
Epoch: 40, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9977104663848877
Epoch: 41, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8537731170654297
Epoch: 42, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 333811
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7570290565490723
Epoch: 1, Steps: 1 | Train Loss: 1.339 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8679049015045166
Epoch: 2, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9973869323730469
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7863342761993408
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.738084077835083
Epoch: 5, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9813497066497803
Epoch: 6, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8463630676269531
Epoch: 7, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9673917293548584
Epoch: 8, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6363708972930908
Epoch: 9, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0562951564788818
Epoch: 10, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.184494972229004
Epoch: 11, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.7422521114349365
Epoch: 12, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8289940357208252
Epoch: 13, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8804230690002441
Epoch: 14, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9924740791320801
Epoch: 15, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0061829090118408
Epoch: 16, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9231491088867188
Epoch: 17, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9307141304016113
Epoch: 18, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8828983306884766
Epoch: 19, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1107594966888428
Epoch: 20, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1414668560028076
Epoch: 21, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 322067
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3094494342803955
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.1141061782836914
Epoch: 2, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0403814315795898
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1386339664459229
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.3204541206359863
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1520342826843262
Epoch: 6, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.8924417495727539
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.917625904083252
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9000444412231445
Epoch: 9, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1624724864959717
Epoch: 10, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0433917045593262
Epoch: 11, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.157261610031128
Epoch: 12, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 1.030797004699707
Epoch: 13, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.7859501838684082
Epoch: 14, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0042974948883057
Epoch: 15, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.7912356853485107
Epoch: 16, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9601166248321533
Epoch: 17, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.8908259868621826
Epoch: 18, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8360610008239746
Epoch: 19, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8843533992767334
Epoch: 20, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.9147307872772217
Epoch: 21, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9534347057342529
Epoch: 22, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.075624942779541
Epoch: 23, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8450963497161865
Epoch: 24, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8871617317199707
Epoch: 25, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9113187789916992
Epoch: 26, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6023304462432861
Epoch: 27, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8400287628173828
Epoch: 28, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7773973941802979
Epoch: 29, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 30 cost time: 0.8106856346130371
Epoch: 30, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 31 cost time: 0.8833475112915039
Epoch: 31, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 32 cost time: 1.0100810527801514
Epoch: 32, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0374257564544678
Epoch: 33, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3534369468688965
Epoch: 34, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0988411903381348
Epoch: 35, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1895997524261475
Epoch: 36, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9256212711334229
Epoch: 37, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2774152755737305
Epoch: 38, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8984711170196533
Epoch: 39, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9507148265838623
Epoch: 40, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1472070217132568
Epoch: 41, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 310323
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.704737424850464
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8164479732513428
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0907630920410156
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7913975715637207
Epoch: 4, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.90224289894104
Epoch: 5, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.009528398513794
Epoch: 6, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.11185622215271
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8277616500854492
Epoch: 8, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0580620765686035
Epoch: 9, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8605353832244873
Epoch: 10, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.9386265277862549
Epoch: 11, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1312065124511719
Epoch: 12, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8488674163818359
Epoch: 13, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8693220615386963
Epoch: 14, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.9011197090148926
Epoch: 15, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 1.0918316841125488
Epoch: 16, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 17 cost time: 0.8035273551940918
Epoch: 17, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8610849380493164
Epoch: 18, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.210371732711792
Epoch: 19, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.058197021484375
Epoch: 20, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7856001853942871
Epoch: 21, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8509740829467773
Epoch: 22, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1252124309539795
Epoch: 23, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 24 cost time: 0.8738646507263184
Epoch: 24, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.9502549171447754
Epoch: 25, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8803317546844482
Epoch: 26, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9159383773803711
Epoch: 27, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7456917762756348
Epoch: 28, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9601166248321533
Epoch: 29, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 30 cost time: 0.8969075679779053
Epoch: 30, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8817763328552246
Epoch: 31, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.476820468902588
Epoch: 32, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0899159908294678
Epoch: 33, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8605813980102539
Epoch: 34, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8752627372741699
Epoch: 35, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9866838455200195
Epoch: 36, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8560006618499756
Epoch: 37, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8964719772338867
Epoch: 38, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.007739782333374
Epoch: 39, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 298579
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8672237396240234
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8463709354400635
Epoch: 2, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8412058353424072
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7454819679260254
Epoch: 4, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7213232517242432
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7139124870300293
Epoch: 6, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7827093601226807
Epoch: 7, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9540410041809082
Epoch: 8, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.828723669052124
Epoch: 9, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.9751784801483154
Epoch: 10, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8951988220214844
Epoch: 11, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8315689563751221
Epoch: 12, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9035122394561768
Epoch: 13, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7416985034942627
Epoch: 14, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8031227588653564
Epoch: 15, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8460462093353271
Epoch: 16, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9206292629241943
Epoch: 17, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8716919422149658
Epoch: 18, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.851665735244751
Epoch: 19, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8371515274047852
Epoch: 20, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6947603225708008
Epoch: 21, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7498784065246582
Epoch: 22, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9560244083404541
Epoch: 23, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.821298360824585
Epoch: 24, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.210813283920288
Epoch: 25, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.7847902774810791
Epoch: 26, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9605410099029541
Epoch: 27, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 1.0664267539978027
Epoch: 28, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 29 cost time: 0.9522204399108887
Epoch: 29, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8829300403594971
Epoch: 30, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0038115978240967
Epoch: 31, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8603513240814209
Epoch: 32, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8753855228424072
Epoch: 33, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7625813484191895
Epoch: 34, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 35 cost time: 0.8676681518554688
Epoch: 35, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 36 cost time: 0.8175792694091797
Epoch: 36, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7692780494689941
Epoch: 37, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6751537322998047
Epoch: 38, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1082501411437988
Epoch: 39, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7136697769165039
Epoch: 40, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8604123592376709
Epoch: 41, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8212368488311768
Epoch: 42, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.869065523147583
Epoch: 43, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1614980697631836
Epoch: 44, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9230599403381348
Epoch: 45, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 275571
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8012444972991943
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7148215770721436
Epoch: 2, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8591954708099365
Epoch: 3, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8121054172515869
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7625854015350342
Epoch: 5, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8876907825469971
Epoch: 6, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6914553642272949
Epoch: 7, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8717880249023438
Epoch: 8, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8615381717681885
Epoch: 9, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7102100849151611
Epoch: 10, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7431976795196533
Epoch: 11, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7219135761260986
Epoch: 12, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8553109169006348
Epoch: 13, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7957680225372314
Epoch: 14, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8211543560028076
Epoch: 15, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6695177555084229
Epoch: 16, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7936747074127197
Epoch: 17, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8760039806365967
Epoch: 18, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7498524188995361
Epoch: 19, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8275561332702637
Epoch: 20, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.806511402130127
Epoch: 21, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.9834649562835693
Epoch: 22, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.9142396450042725
Epoch: 23, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0390849113464355
Epoch: 24, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9664132595062256
Epoch: 25, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 26 cost time: 0.934136152267456
Epoch: 26, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.9634966850280762
Epoch: 27, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 28 cost time: 0.6483497619628906
Epoch: 28, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6684374809265137
Epoch: 29, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.825533390045166
Epoch: 30, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7052407264709473
Epoch: 31, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7129654884338379
Epoch: 32, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 33 cost time: 0.6764061450958252
Epoch: 33, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8557999134063721
Epoch: 34, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8036205768585205
Epoch: 35, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8436942100524902
Epoch: 36, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8029696941375732
Epoch: 37, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8660013675689697
Epoch: 38, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7802121639251709
Epoch: 39, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8328611850738525
Epoch: 40, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7388818264007568
Epoch: 41, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7880287170410156
Epoch: 42, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 263827
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6723921298980713
Epoch: 1, Steps: 1 | Train Loss: 1.359 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.769855260848999
Epoch: 2, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6986575126647949
Epoch: 3, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6032042503356934
Epoch: 4, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8312318325042725
Epoch: 5, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.799727201461792
Epoch: 6, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7108557224273682
Epoch: 7, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7836899757385254
Epoch: 8, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7227296829223633
Epoch: 9, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.702937126159668
Epoch: 10, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9723124504089355
Epoch: 11, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6772959232330322
Epoch: 12, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7084274291992188
Epoch: 13, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8391404151916504
Epoch: 14, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7913193702697754
Epoch: 15, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.7962119579315186
Epoch: 16, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8498618602752686
Epoch: 17, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6970946788787842
Epoch: 18, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7494845390319824
Epoch: 19, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6665573120117188
Epoch: 20, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6704258918762207
Epoch: 21, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8860552310943604
Epoch: 22, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9072933197021484
Epoch: 23, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2165019512176514
Epoch: 24, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.811349630355835
Epoch: 25, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 252083
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9220945835113525
Epoch: 1, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9654600620269775
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9824132919311523
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.036724328994751
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.7465298175811768
Epoch: 5, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8749723434448242
Epoch: 6, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8433482646942139
Epoch: 7, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7779231071472168
Epoch: 8, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.789315938949585
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7753105163574219
Epoch: 10, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8066580295562744
Epoch: 11, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.003739595413208
Epoch: 12, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0103325843811035
Epoch: 13, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2314167022705078
Epoch: 14, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3730733394622803
Epoch: 15, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 1.1161432266235352
Epoch: 16, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.9554948806762695
Epoch: 17, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.9193706512451172
Epoch: 18, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9297401905059814
Epoch: 19, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.9805464744567871
Epoch: 20, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 21 cost time: 0.8036212921142578
Epoch: 21, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7893517017364502
Epoch: 22, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 23 cost time: 0.8587503433227539
Epoch: 23, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.204582691192627
Epoch: 24, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0847997665405273
Epoch: 25, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.221158504486084
Epoch: 26, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0162465572357178
Epoch: 27, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.066596269607544
Epoch: 28, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.206763505935669
Epoch: 29, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8855283260345459
Epoch: 30, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9780845642089844
Epoch: 31, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1720106601715088
Epoch: 32, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 240339
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.430067539215088
Epoch: 1, Steps: 1 | Train Loss: 1.665 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6986732482910156
Epoch: 2, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.830101490020752
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8371551036834717
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2040824890136719
Epoch: 5, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8365693092346191
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8827598094940186
Epoch: 7, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7784607410430908
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9902527332305908
Epoch: 9, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0777547359466553
Epoch: 10, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0039880275726318
Epoch: 11, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8664178848266602
Epoch: 12, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 8777511
model size : 38.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.173896074295044
Epoch: 1, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6960275173187256
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0713229179382324
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.794325590133667
Epoch: 4, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.7595603466033936
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8528029918670654
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9891088008880615
Epoch: 7, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8968491554260254
Epoch: 8, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7650384902954102
Epoch: 9, Steps: 1 | Train Loss: 0.619 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.8492939472198486
Epoch: 10, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0582082271575928
Epoch: 11, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0676863193511963
Epoch: 12, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7990982532501221
Epoch: 13, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9386272430419922
Epoch: 14, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8941147327423096
Epoch: 15, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9015412330627441
Epoch: 16, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9350221157073975
Epoch: 17, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0366926193237305
Epoch: 18, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.173360824584961
Epoch: 19, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8697127
model size : 38.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1130495071411133
Epoch: 1, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.199 Vali Acc: 0.133 Test Loss: 1.199 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.8205242156982422
Epoch: 2, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.207 Vali Acc: 0.133 Test Loss: 1.207 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9699931144714355
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.179 Vali Acc: 0.133 Test Loss: 1.179 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 0.8254458904266357
Epoch: 4, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.7589538097381592
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.6349217891693115
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9114589691162109
Epoch: 7, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7969985008239746
Epoch: 8, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8946659564971924
Epoch: 9, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8218374252319336
Epoch: 10, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.8557660579681396
Epoch: 11, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.025578498840332
Epoch: 12, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7089338302612305
Epoch: 13, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.8884775638580322
Epoch: 14, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.272 Vali Acc: 0.400 Test Loss: 1.272 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7746982574462891
Epoch: 15, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8510570526123047
Epoch: 16, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9344353675842285
Epoch: 17, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.276 Vali Acc: 0.467 Test Loss: 1.276 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0032024383544922
Epoch: 18, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.313 Vali Acc: 0.333 Test Loss: 1.313 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7798848152160645
Epoch: 19, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.364 Vali Acc: 0.267 Test Loss: 1.364 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7629523277282715
Epoch: 20, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.045590877532959
Epoch: 21, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9208126068115234
Epoch: 22, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.340 Vali Acc: 0.333 Test Loss: 1.340 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9531209468841553
Epoch: 23, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.504 Vali Acc: 0.333 Test Loss: 1.504 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8616743
model size : 37.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.309467315673828
Epoch: 1, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9263801574707031
Epoch: 2, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.9430394172668457
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1385111808776855
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9011993408203125
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0207979679107666
Epoch: 6, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0430986881256104
Epoch: 7, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.9572772979736328
Epoch: 8, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8598182201385498
Epoch: 9, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9163379669189453
Epoch: 10, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.949167013168335
Epoch: 11, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0317466259002686
Epoch: 12, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0378925800323486
Epoch: 13, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1617989540100098
Epoch: 14, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0736584663391113
Epoch: 15, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.328 Vali Acc: 0.333 Test Loss: 1.328 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.039407730102539
Epoch: 16, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0477261543273926
Epoch: 17, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 8536359
model size : 37.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4567270278930664
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.9364497661590576
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9480395317077637
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9038035869598389
Epoch: 4, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0166935920715332
Epoch: 5, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7804412841796875
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0538601875305176
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9623758792877197
Epoch: 8, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.9752616882324219
Epoch: 9, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7896966934204102
Epoch: 10, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.082 Vali Acc: 0.200 Test Loss: 1.082 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9650771617889404
Epoch: 11, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9619858264923096
Epoch: 12, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.149 Vali Acc: 0.533 Test Loss: 1.149 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.796316385269165
Epoch: 13, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8695523738861084
Epoch: 14, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0696439743041992
Epoch: 15, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.77146315574646
Epoch: 16, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8762907981872559
Epoch: 17, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8767492771148682
Epoch: 18, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7464231
model size : 33.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.094871759414673
Epoch: 1, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9930000305175781
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9411132335662842
Epoch: 3, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7583506107330322
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7053244113922119
Epoch: 5, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.96431565284729
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7838137149810791
Epoch: 7, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8912270069122314
Epoch: 8, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7965061664581299
Epoch: 9, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7361893653869629
Epoch: 10, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9461672306060791
Epoch: 11, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7821109294891357
Epoch: 12, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7847683429718018
Epoch: 13, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.859398365020752
Epoch: 14, Steps: 1 | Train Loss: 0.246 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.9766950607299805
Epoch: 15, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9538521766662598
Epoch: 16, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8229458332061768
Epoch: 17, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8569161891937256
Epoch: 18, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.994940996170044
Epoch: 19, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.175 Vali Acc: 0.533 Test Loss: 1.175 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0977709293365479
Epoch: 20, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9437940120697021
Epoch: 21, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9023447036743164
Epoch: 22, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8986096382141113
Epoch: 23, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8005959987640381
Epoch: 24, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.268 Vali Acc: 0.467 Test Loss: 1.268 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7383847
model size : 33.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.20660400390625
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9301586151123047
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8233442306518555
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7707493305206299
Epoch: 4, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9378554821014404
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8717858791351318
Epoch: 6, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9478716850280762
Epoch: 7, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.8217031955718994
Epoch: 8, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7686471939086914
Epoch: 9, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8299448490142822
Epoch: 10, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8457977771759033
Epoch: 11, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8957655429840088
Epoch: 12, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9775998592376709
Epoch: 13, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9260749816894531
Epoch: 14, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1350510120391846
Epoch: 15, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7949159145355225
Epoch: 16, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7327680587768555
Epoch: 17, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7303463
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.783505916595459
Epoch: 1, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7219858169555664
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7123303413391113
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6308746337890625
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6387224197387695
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8469550609588623
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8654544353485107
Epoch: 7, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8197288513183594
Epoch: 8, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7441818714141846
Epoch: 9, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7488570213317871
Epoch: 10, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7872292995452881
Epoch: 11, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7123916149139404
Epoch: 12, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.7682523727416992
Epoch: 13, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8321752548217773
Epoch: 14, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6819403171539307
Epoch: 15, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.7421872615814209
Epoch: 16, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8472106456756592
Epoch: 17, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7350165843963623
Epoch: 18, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7269043922424316
Epoch: 19, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8261046409606934
Epoch: 20, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7740395069122314
Epoch: 21, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8106062412261963
Epoch: 22, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.547 Vali Acc: 0.333 Test Loss: 1.547 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8541367053985596
Epoch: 23, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0548489093780518
Epoch: 24, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9400327205657959
Epoch: 25, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7223079
model size : 32.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3868095874786377
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2473700046539307
Epoch: 2, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6784374713897705
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8511765003204346
Epoch: 4, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8545949459075928
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.2413811683654785
Epoch: 6, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7800447940826416
Epoch: 7, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.477 Vali Acc: 0.333 Test Loss: 1.477 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8427770137786865
Epoch: 8, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.394 Vali Acc: 0.467 Test Loss: 1.394 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 9 cost time: 0.9357614517211914
Epoch: 9, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466653 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.8647184371948242
Epoch: 10, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7712140083312988
Epoch: 11, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.698 Vali Acc: 0.333 Test Loss: 1.698 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8988559246063232
Epoch: 12, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.409 Vali Acc: 0.333 Test Loss: 1.409 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2596564292907715
Epoch: 13, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9157037734985352
Epoch: 14, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.470 Vali Acc: 0.333 Test Loss: 1.470 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1003079414367676
Epoch: 15, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.698 Vali Acc: 0.333 Test Loss: 1.698 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1783602237701416
Epoch: 16, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9326577186584473
Epoch: 17, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0317494869232178
Epoch: 18, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9291102886199951
Epoch: 19, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6807591
model size : 30.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3438384532928467
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8760511875152588
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.890833854675293
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2761123180389404
Epoch: 4, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6825573444366455
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7256083488464355
Epoch: 6, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8884305953979492
Epoch: 7, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8632721900939941
Epoch: 8, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8424067497253418
Epoch: 9, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2367241382598877
Epoch: 10, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8842661380767822
Epoch: 11, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.812239408493042
Epoch: 12, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9043705463409424
Epoch: 13, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.774132251739502
Epoch: 14, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8412642478942871
Epoch: 15, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7646234035491943
Epoch: 16, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7314238548278809
Epoch: 17, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7755875587463379
Epoch: 18, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6944353580474854
Epoch: 19, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7878692150115967
Epoch: 20, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6636898517608643
Epoch: 21, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.272 Vali Acc: 0.467 Test Loss: 1.272 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8262195587158203
Epoch: 22, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7528481483459473
Epoch: 23, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9667232036590576
Epoch: 24, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.327 Vali Acc: 0.333 Test Loss: 1.327 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.816093921661377
Epoch: 25, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.428 Vali Acc: 0.333 Test Loss: 1.428 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6727207
model size : 30.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9412620067596436
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8268647193908691
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.958838939666748
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6843798160552979
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9451055526733398
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7007968425750732
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9025392532348633
Epoch: 7, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7886886596679688
Epoch: 8, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7825839519500732
Epoch: 9, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6729402542114258
Epoch: 10, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8264095783233643
Epoch: 11, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.013512134552002
Epoch: 12, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8250143527984619
Epoch: 13, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9634790420532227
Epoch: 14, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.034163475036621
Epoch: 15, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8890588283538818
Epoch: 16, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.974959135055542
Epoch: 17, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7669527530670166
Epoch: 18, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7814667224884033
Epoch: 19, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9387121200561523
Epoch: 20, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1401772499084473
Epoch: 21, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.362 Vali Acc: 0.267 Test Loss: 1.362 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6646823
model size : 30.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.432812452316284
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7536976337432861
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8613955974578857
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9776747226715088
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8224954605102539
Epoch: 5, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8606529235839844
Epoch: 6, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6558070182800293
Epoch: 7, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6023750305175781
Epoch: 8, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.6814823150634766
Epoch: 9, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7135813236236572
Epoch: 10, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8796987533569336
Epoch: 11, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9024732112884521
Epoch: 12, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8691844940185547
Epoch: 13, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8088555335998535
Epoch: 14, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9293274879455566
Epoch: 15, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9647698402404785
Epoch: 16, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6996803283691406
Epoch: 17, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0283317565917969
Epoch: 18, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6566439
model size : 30.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1062514781951904
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.139 Vali Acc: 0.000 Test Loss: 1.139 Test Acc: 0.000
Validation loss decreased (inf --> 0.000011).  Saving model ...
Epoch: 2 cost time: 0.8193697929382324
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (0.000011 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8406596183776855
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6347825527191162
Epoch: 4, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8369593620300293
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8414506912231445
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.129577875137329
Epoch: 7, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.108 Vali Acc: 0.133 Test Loss: 1.108 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8333468437194824
Epoch: 8, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0326764583587646
Epoch: 9, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.9380455017089844
Epoch: 10, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8053979873657227
Epoch: 11, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8899667263031006
Epoch: 12, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9653134346008301
Epoch: 13, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8929884433746338
Epoch: 14, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.7484025955200195
Epoch: 15, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.006592035293579
Epoch: 16, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9646034240722656
Epoch: 17, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.201 Vali Acc: 0.467 Test Loss: 1.201 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.7232334613800049
Epoch: 18, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4900660514831543
Epoch: 19, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9114124774932861
Epoch: 20, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.345 Vali Acc: 0.333 Test Loss: 1.345 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8844437599182129
Epoch: 21, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.943004846572876
Epoch: 22, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.255 Vali Acc: 0.467 Test Loss: 1.255 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7534792423248291
Epoch: 23, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0200610160827637
Epoch: 24, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.453 Vali Acc: 0.333 Test Loss: 1.453 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.889197826385498
Epoch: 25, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.400 Test Loss: 1.602 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7835502624511719
Epoch: 26, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.333 Test Loss: 1.747 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8954074382781982
Epoch: 27, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.834 Vali Acc: 0.333 Test Loss: 1.834 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6479271
model size : 29.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8678526878356934
Epoch: 1, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0322575569152832
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8508925437927246
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1671254634857178
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.900115966796875
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9927670955657959
Epoch: 6, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0291943550109863
Epoch: 7, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0005295276641846
Epoch: 8, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7528181076049805
Epoch: 9, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8080542087554932
Epoch: 10, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1037538051605225
Epoch: 11, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6398887
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8339133262634277
Epoch: 1, Steps: 1 | Train Loss: 1.494 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9172263145446777
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7100021839141846
Epoch: 3, Steps: 1 | Train Loss: 1.288 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8005871772766113
Epoch: 4, Steps: 1 | Train Loss: 1.317 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8092305660247803
Epoch: 5, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7335538864135742
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.7542245388031006
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7185955047607422
Epoch: 8, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9937169551849365
Epoch: 9, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8246428966522217
Epoch: 10, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4447872638702393
Epoch: 11, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9296445846557617
Epoch: 12, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8283638954162598
Epoch: 13, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0847234725952148
Epoch: 14, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.349806308746338
Epoch: 15, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.294419288635254
Epoch: 16, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9150674343109131
Epoch: 17, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9370841979980469
Epoch: 18, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.259 Vali Acc: 0.467 Test Loss: 1.259 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.180180311203003
Epoch: 19, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0192270278930664
Epoch: 20, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9218411445617676
Epoch: 21, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.385 Vali Acc: 0.333 Test Loss: 1.385 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6318503
model size : 29.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5429956912994385
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.8707008361816406
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8152422904968262
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.8826966285705566
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1484911441802979
Epoch: 5, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.068394660949707
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.410329818725586
Epoch: 7, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2045459747314453
Epoch: 8, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2272758483886719
Epoch: 9, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.297598123550415
Epoch: 10, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1409471035003662
Epoch: 11, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9357404708862305
Epoch: 12, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0952949523925781
Epoch: 13, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6238119
model size : 28.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.992492437362671
Epoch: 1, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7938225269317627
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.5239877700805664
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.9248306751251221
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8065283298492432
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8450889587402344
Epoch: 6, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.700897216796875
Epoch: 7, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8148465156555176
Epoch: 8, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6843559741973877
Epoch: 9, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9393572807312012
Epoch: 10, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9329781532287598
Epoch: 11, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7296504974365234
Epoch: 12, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.047 Vali Acc: 0.267 Test Loss: 1.047 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8254287242889404
Epoch: 13, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.8469011783599854
Epoch: 14, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 15 cost time: 0.8825469017028809
Epoch: 15, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.6744134426116943
Epoch: 16, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6656825542449951
Epoch: 17, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7014486789703369
Epoch: 18, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7398443222045898
Epoch: 19, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.770310640335083
Epoch: 20, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7794032096862793
Epoch: 21, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9624369144439697
Epoch: 22, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0753681659698486
Epoch: 23, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9685580730438232
Epoch: 24, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.900139570236206
Epoch: 25, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.215 Vali Acc: 0.467 Test Loss: 1.215 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3080615
model size : 14.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.708374500274658
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9334454536437988
Epoch: 2, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9185101985931396
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6630086898803711
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7629148960113525
Epoch: 5, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8551924228668213
Epoch: 6, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8787434101104736
Epoch: 7, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.0651018619537354
Epoch: 8, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0287859439849854
Epoch: 9, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8469705581665039
Epoch: 10, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7781126499176025
Epoch: 11, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7165565490722656
Epoch: 12, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.7654240131378174
Epoch: 13, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8785755634307861
Epoch: 14, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.057 Vali Acc: 0.200 Test Loss: 1.057 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8377254009246826
Epoch: 15, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.716515064239502
Epoch: 16, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.8569948673248291
Epoch: 17, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7976229190826416
Epoch: 18, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8888788223266602
Epoch: 19, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7839546203613281
Epoch: 20, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7048921585083008
Epoch: 21, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7245955467224121
Epoch: 22, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9725980758666992
Epoch: 23, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8782162666320801
Epoch: 24, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9034368991851807
Epoch: 25, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7709107398986816
Epoch: 26, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.312 Vali Acc: 0.267 Test Loss: 1.312 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3040423
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.880786657333374
Epoch: 1, Steps: 1 | Train Loss: 1.331 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7663836479187012
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.87306809425354
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.772355318069458
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7686614990234375
Epoch: 5, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.851280927658081
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7599844932556152
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7158007621765137
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7928190231323242
Epoch: 9, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8622186183929443
Epoch: 10, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9574682712554932
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7799882888793945
Epoch: 12, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8466503620147705
Epoch: 13, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9249012470245361
Epoch: 14, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.7689268589019775
Epoch: 15, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6890952587127686
Epoch: 16, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7941005229949951
Epoch: 17, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.687396764755249
Epoch: 18, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7568647861480713
Epoch: 19, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6804277896881104
Epoch: 20, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.897899866104126
Epoch: 21, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8681027889251709
Epoch: 22, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7463667392730713
Epoch: 23, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 24 cost time: 0.8980202674865723
Epoch: 24, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8418030738830566
Epoch: 25, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8772239685058594
Epoch: 26, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9101245403289795
Epoch: 27, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0675299167633057
Epoch: 28, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.321 Vali Acc: 0.467 Test Loss: 1.321 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.159266471862793
Epoch: 29, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.317 Vali Acc: 0.467 Test Loss: 1.317 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1435174942016602
Epoch: 30, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.227 Vali Acc: 0.467 Test Loss: 1.227 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8525702953338623
Epoch: 31, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0661184787750244
Epoch: 32, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7068514823913574
Epoch: 33, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3000231
model size : 13.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2195186614990234
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.0345594882965088
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8323185443878174
Epoch: 3, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7892556190490723
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.081796646118164
Epoch: 5, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8958272933959961
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.961899995803833
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.9987373352050781
Epoch: 8, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.913393497467041
Epoch: 9, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0415222644805908
Epoch: 10, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.034559965133667
Epoch: 11, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.829918384552002
Epoch: 12, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.000626802444458
Epoch: 13, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8716754913330078
Epoch: 14, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8557565212249756
Epoch: 15, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7670297622680664
Epoch: 16, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8740475177764893
Epoch: 17, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.9015114307403564
Epoch: 18, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0080456733703613
Epoch: 19, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0418791770935059
Epoch: 20, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9340178966522217
Epoch: 21, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9756917953491211
Epoch: 22, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8857181072235107
Epoch: 23, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1147935390472412
Epoch: 24, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8243227005004883
Epoch: 25, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0445597171783447
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9741230010986328
Epoch: 27, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.648 Vali Acc: 0.333 Test Loss: 1.648 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2960039
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8261878490448
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7316105365753174
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8154993057250977
Epoch: 3, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7767698764801025
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.122 Vali Acc: 0.133 Test Loss: 1.122 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.902226448059082
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.823631763458252
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.358184576034546
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7709860801696777
Epoch: 8, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7887058258056641
Epoch: 9, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8207123279571533
Epoch: 10, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8599517345428467
Epoch: 11, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0141992568969727
Epoch: 12, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9416069984436035
Epoch: 13, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0328052043914795
Epoch: 14, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8551361560821533
Epoch: 15, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7781908512115479
Epoch: 16, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.821587085723877
Epoch: 17, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.794802188873291
Epoch: 18, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9692261219024658
Epoch: 19, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9677350521087646
Epoch: 20, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8340098857879639
Epoch: 21, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9336676597595215
Epoch: 22, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7755427360534668
Epoch: 23, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9887335300445557
Epoch: 24, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9344589710235596
Epoch: 25, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2422695
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.926706552505493
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8672306537628174
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8517427444458008
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.7375564575195312
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9219658374786377
Epoch: 5, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8721423149108887
Epoch: 6, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0101580619812012
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1831185817718506
Epoch: 8, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8635110855102539
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.087770700454712
Epoch: 10, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.9866082668304443
Epoch: 11, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9720208644866943
Epoch: 12, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3225069046020508
Epoch: 13, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9883952140808105
Epoch: 14, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8762826919555664
Epoch: 15, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0522785186767578
Epoch: 16, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.005561113357544
Epoch: 17, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1364576816558838
Epoch: 18, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2019627094268799
Epoch: 19, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9986140727996826
Epoch: 20, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2382503
model size : 11.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0919265747070312
Epoch: 1, Steps: 1 | Train Loss: 1.450 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7685947418212891
Epoch: 2, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8977320194244385
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6903715133666992
Epoch: 4, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0882704257965088
Epoch: 5, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9079923629760742
Epoch: 6, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.821272611618042
Epoch: 7, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6773920059204102
Epoch: 8, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7637884616851807
Epoch: 9, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9888746738433838
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7215299606323242
Epoch: 11, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9509356021881104
Epoch: 12, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6844339370727539
Epoch: 13, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.6973876953125
Epoch: 14, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8359701633453369
Epoch: 15, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9673829078674316
Epoch: 16, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0654706954956055
Epoch: 17, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9021182060241699
Epoch: 18, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.761883020401001
Epoch: 19, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8478736877441406
Epoch: 20, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9097638130187988
Epoch: 21, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7631206512451172
Epoch: 22, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6985557079315186
Epoch: 23, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2342311
model size : 11.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0226168632507324
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.762793779373169
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9890131950378418
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7702224254608154
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.79634690284729
Epoch: 5, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9784867763519287
Epoch: 6, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9102485179901123
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.068 Vali Acc: 0.600 Test Loss: 1.068 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.8895602226257324
Epoch: 8, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.894660234451294
Epoch: 9, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8244762420654297
Epoch: 10, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7621533870697021
Epoch: 11, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9013881683349609
Epoch: 12, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.024 Vali Acc: 0.667 Test Loss: 1.024 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.6296133995056152
Epoch: 13, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9676625728607178
Epoch: 14, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7152523994445801
Epoch: 15, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6437230110168457
Epoch: 16, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7368309497833252
Epoch: 17, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7612354755401611
Epoch: 18, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8621845245361328
Epoch: 19, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.000 Vali Acc: 0.400 Test Loss: 1.000 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8181028366088867
Epoch: 20, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0418701171875
Epoch: 21, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7707784175872803
Epoch: 22, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 2302119
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6810107231140137
Epoch: 1, Steps: 1 | Train Loss: 1.375 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7270643711090088
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.106 Vali Acc: 0.133 Test Loss: 1.106 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9966244697570801
Epoch: 3, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.0778048038482666
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1784210205078125
Epoch: 5, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7272121906280518
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8497567176818848
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.6748714447021484
Epoch: 8, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8639535903930664
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1305139064788818
Epoch: 10, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.02121901512146
Epoch: 11, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.064033031463623
Epoch: 12, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1973381042480469
Epoch: 13, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8311331272125244
Epoch: 14, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8587954044342041
Epoch: 15, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7742304801940918
Epoch: 16, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9954869747161865
Epoch: 17, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2093735
model size : 10.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3897554874420166
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7653522491455078
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9216799736022949
Epoch: 3, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6855111122131348
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7141063213348389
Epoch: 5, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8274469375610352
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7728145122528076
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0273828506469727
Epoch: 8, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7265551090240479
Epoch: 9, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8909978866577148
Epoch: 10, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9825048446655273
Epoch: 11, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.8267462253570557
Epoch: 12, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8072779178619385
Epoch: 13, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9862632751464844
Epoch: 14, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.030 Vali Acc: 0.333 Test Loss: 1.030 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0875389575958252
Epoch: 15, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6746468544006348
Epoch: 16, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.9162635803222656
Epoch: 17, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6374690532684326
Epoch: 18, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7120449542999268
Epoch: 19, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.737311840057373
Epoch: 20, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7560973167419434
Epoch: 21, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0410254001617432
Epoch: 22, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.122 Vali Acc: 0.533 Test Loss: 1.122 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7990617752075195
Epoch: 23, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8970859050750732
Epoch: 24, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6884689331054688
Epoch: 25, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9521660804748535
Epoch: 26, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2053543
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1918423175811768
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.8080189228057861
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8291871547698975
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8513593673706055
Epoch: 4, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9825589656829834
Epoch: 5, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9706599712371826
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.8914554119110107
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7098708152770996
Epoch: 8, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0353550910949707
Epoch: 9, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8034842014312744
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9262068271636963
Epoch: 11, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6802098751068115
Epoch: 12, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8178234100341797
Epoch: 13, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8327884674072266
Epoch: 14, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.056 Vali Acc: 0.267 Test Loss: 1.056 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8411273956298828
Epoch: 15, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7659749984741211
Epoch: 16, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2013351
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0770111083984375
Epoch: 1, Steps: 1 | Train Loss: 1.681 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8931190967559814
Epoch: 2, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6828553676605225
Epoch: 3, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.877070426940918
Epoch: 4, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9213628768920898
Epoch: 5, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.049638032913208
Epoch: 6, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9887247085571289
Epoch: 7, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8825933933258057
Epoch: 8, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0121698379516602
Epoch: 9, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9321951866149902
Epoch: 10, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0636506080627441
Epoch: 11, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2469508647918701
Epoch: 12, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0554442405700684
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.853708028793335
Epoch: 14, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.972508430480957
Epoch: 15, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9602892398834229
Epoch: 16, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9810881614685059
Epoch: 17, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3141024112701416
Epoch: 18, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.174128770828247
Epoch: 19, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.7352166175842285
Epoch: 20, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0339064598083496
Epoch: 21, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.835259199142456
Epoch: 22, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8080661296844482
Epoch: 23, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.973153829574585
Epoch: 24, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.049809217453003
Epoch: 25, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0385632514953613
Epoch: 26, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7914462089538574
Epoch: 27, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1606924533843994
Epoch: 28, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9496133327484131
Epoch: 29, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1973159
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.210474729537964
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8453719615936279
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8233497142791748
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8294477462768555
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.96431565284729
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.704740047454834
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.7116029262542725
Epoch: 7, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0061144828796387
Epoch: 8, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7571742534637451
Epoch: 9, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8789019584655762
Epoch: 10, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8952579498291016
Epoch: 11, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.842803955078125
Epoch: 12, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0548760890960693
Epoch: 13, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8005311489105225
Epoch: 14, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.777855634689331
Epoch: 15, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9431393146514893
Epoch: 16, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.015367031097412
Epoch: 17, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9285190105438232
Epoch: 18, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.960761308670044
Epoch: 19, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8357837200164795
Epoch: 20, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1851129531860352
Epoch: 21, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9888272285461426
Epoch: 22, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7740147113800049
Epoch: 23, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8645403385162354
Epoch: 24, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1929255
model size : 9.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.938711166381836
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8376204967498779
Epoch: 2, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1596224308013916
Epoch: 3, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9782378673553467
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.1033315658569336
Epoch: 5, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0238256454467773
Epoch: 6, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8004231452941895
Epoch: 7, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9047343730926514
Epoch: 8, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.235219955444336
Epoch: 9, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.38157057762146
Epoch: 10, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.0947248935699463
Epoch: 11, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.053025245666504
Epoch: 12, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.7990195751190186
Epoch: 13, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.946448802947998
Epoch: 14, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9012026786804199
Epoch: 15, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9219908714294434
Epoch: 16, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0490410327911377
Epoch: 17, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7652266025543213
Epoch: 18, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.8300426006317139
Epoch: 19, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 0.8798422813415527
Epoch: 20, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9053547382354736
Epoch: 21, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8346598148345947
Epoch: 22, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7668986320495605
Epoch: 23, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9094841480255127
Epoch: 24, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8260364532470703
Epoch: 25, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.790928840637207
Epoch: 26, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7572078704833984
Epoch: 27, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0530939102172852
Epoch: 28, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8556609153747559
Epoch: 29, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1889063
model size : 9.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.741361141204834
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6880519390106201
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9870903491973877
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6385772228240967
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8719954490661621
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.9628911018371582
Epoch: 6, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.96993088722229
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.850494384765625
Epoch: 8, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9364888668060303
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8847079277038574
Epoch: 10, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8438479900360107
Epoch: 11, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8157267570495605
Epoch: 12, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9218630790710449
Epoch: 13, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7965481281280518
Epoch: 14, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7827272415161133
Epoch: 15, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1848871
model size : 9.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.975355625152588
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.635873556137085
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9082307815551758
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7755789756774902
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7843413352966309
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6677541732788086
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0797584056854248
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.679124116897583
Epoch: 8, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7568824291229248
Epoch: 9, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8063449859619141
Epoch: 10, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7742307186126709
Epoch: 11, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9151554107666016
Epoch: 12, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0959291458129883
Epoch: 13, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9555919170379639
Epoch: 14, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.8823184967041016
Epoch: 15, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.6596839427947998
Epoch: 16, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9210662841796875
Epoch: 17, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6655445098876953
Epoch: 18, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7684173583984375
Epoch: 19, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7861988544464111
Epoch: 20, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9575238227844238
Epoch: 21, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8451886177062988
Epoch: 22, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9925997257232666
Epoch: 23, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0554759502410889
Epoch: 24, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8804271221160889
Epoch: 25, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1808679
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1686322689056396
Epoch: 1, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8945116996765137
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.7993338108062744
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7102882862091064
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9361340999603271
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9958276748657227
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7556984424591064
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.879429817199707
Epoch: 8, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7223324775695801
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8054165840148926
Epoch: 10, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8061473369598389
Epoch: 11, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.7430989742279053
Epoch: 12, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8506319522857666
Epoch: 13, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8728158473968506
Epoch: 14, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8167986869812012
Epoch: 15, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.083381175994873
Epoch: 16, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1664063930511475
Epoch: 17, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8214001655578613
Epoch: 18, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9885883331298828
Epoch: 19, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 20 cost time: 0.9283761978149414
Epoch: 20, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9588799476623535
Epoch: 21, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8163845539093018
Epoch: 22, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7371678352355957
Epoch: 23, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8055546283721924
Epoch: 24, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7077248096466064
Epoch: 25, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7563209533691406
Epoch: 26, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8292603492736816
Epoch: 27, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8392698764801025
Epoch: 28, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.089966058731079
Epoch: 29, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1215207
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.014249801635742
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7265722751617432
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8415391445159912
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.831392765045166
Epoch: 4, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.894193172454834
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.702507495880127
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.797795295715332
Epoch: 7, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.794806957244873
Epoch: 8, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0799205303192139
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6672623157501221
Epoch: 10, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7801716327667236
Epoch: 11, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8214111328125
Epoch: 12, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8218796253204346
Epoch: 13, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9524507522583008
Epoch: 14, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8362996578216553
Epoch: 15, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.1764049530029297
Epoch: 16, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9039695262908936
Epoch: 17, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9292576313018799
Epoch: 18, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9131519794464111
Epoch: 19, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0430388450622559
Epoch: 20, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.9149916172027588
Epoch: 21, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8180418014526367
Epoch: 22, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8644425868988037
Epoch: 23, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7213788032531738
Epoch: 24, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.103987216949463
Epoch: 25, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7966492176055908
Epoch: 26, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9064474105834961
Epoch: 27, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.982567548751831
Epoch: 28, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9405803680419922
Epoch: 29, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8879997730255127
Epoch: 30, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1195111
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.729170322418213
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.139 Vali Acc: 0.067 Test Loss: 1.139 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.9369039535522461
Epoch: 2, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.066655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8867385387420654
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0048556327819824
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8622395992279053
Epoch: 5, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1639935970306396
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.139 Vali Acc: 0.067 Test Loss: 1.139 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0000267028808594
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.144 Vali Acc: 0.133 Test Loss: 1.144 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9722328186035156
Epoch: 8, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9411861896514893
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.120 Vali Acc: 0.133 Test Loss: 1.120 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9984405040740967
Epoch: 10, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.8083357810974121
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8712148666381836
Epoch: 12, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1684520244598389
Epoch: 13, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9718887805938721
Epoch: 14, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7760031223297119
Epoch: 15, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0659894943237305
Epoch: 16, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8631675243377686
Epoch: 17, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0799853801727295
Epoch: 18, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8119902610778809
Epoch: 19, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.744659423828125
Epoch: 20, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1175015
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1523382663726807
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.9894542694091797
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9835331439971924
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.921210765838623
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8858530521392822
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8859429359436035
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8248717784881592
Epoch: 7, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7382011413574219
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9287045001983643
Epoch: 9, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7974612712860107
Epoch: 10, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9252583980560303
Epoch: 11, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.7143833637237549
Epoch: 12, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.858823299407959
Epoch: 13, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7858917713165283
Epoch: 14, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.083 Vali Acc: 0.200 Test Loss: 1.083 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1669950485229492
Epoch: 15, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.873478889465332
Epoch: 16, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9010469913482666
Epoch: 17, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9401569366455078
Epoch: 18, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.9002599716186523
Epoch: 19, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.9100275039672852
Epoch: 20, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9122843742370605
Epoch: 21, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8981401920318604
Epoch: 22, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0189478397369385
Epoch: 23, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8073520660400391
Epoch: 24, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9930431842803955
Epoch: 25, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.138324499130249
Epoch: 26, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7913274765014648
Epoch: 27, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7183594703674316
Epoch: 28, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.860072135925293
Epoch: 29, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1154919
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4748971462249756
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.110 Vali Acc: 0.133 Test Loss: 1.110 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7776095867156982
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.133322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7577784061431885
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9950206279754639
Epoch: 4, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1158907413482666
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.104 Vali Acc: 0.133 Test Loss: 1.104 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7063291072845459
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.848992109298706
Epoch: 7, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7439637184143066
Epoch: 8, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8645410537719727
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0339720249176025
Epoch: 10, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9112982749938965
Epoch: 11, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9002771377563477
Epoch: 12, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 884967
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.444814682006836
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9496831893920898
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0317811965942383
Epoch: 3, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.959169864654541
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.017857313156128
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9002821445465088
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.8245720863342285
Epoch: 7, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8571438789367676
Epoch: 8, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9041271209716797
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.791863203048706
Epoch: 10, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7533330917358398
Epoch: 11, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6856293678283691
Epoch: 12, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7786328792572021
Epoch: 13, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 1.0162532329559326
Epoch: 14, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.060 Vali Acc: 0.267 Test Loss: 1.060 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7657577991485596
Epoch: 15, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9273519515991211
Epoch: 16, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8160130977630615
Epoch: 17, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9717507362365723
Epoch: 18, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7523312568664551
Epoch: 19, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.8282761573791504
Epoch: 20, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0650193691253662
Epoch: 21, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.046 Vali Acc: 0.333 Test Loss: 1.046 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8830351829528809
Epoch: 22, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.055 Vali Acc: 0.267 Test Loss: 1.055 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0225682258605957
Epoch: 23, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.048 Vali Acc: 0.267 Test Loss: 1.048 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9506902694702148
Epoch: 24, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9627439975738525
Epoch: 25, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9163737297058105
Epoch: 26, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0450446605682373
Epoch: 27, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9359719753265381
Epoch: 28, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8042304515838623
Epoch: 29, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 864871
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7777481079101562
Epoch: 1, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6064367294311523
Epoch: 2, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8274898529052734
Epoch: 3, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.6068463325500488
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7196524143218994
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7341959476470947
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7448124885559082
Epoch: 7, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9383342266082764
Epoch: 8, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6107690334320068
Epoch: 9, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7001807689666748
Epoch: 10, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7684228420257568
Epoch: 11, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7943801879882812
Epoch: 12, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.9048337936401367
Epoch: 13, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.7062625885009766
Epoch: 14, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9793779850006104
Epoch: 15, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9876952171325684
Epoch: 16, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.876246452331543
Epoch: 17, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0375118255615234
Epoch: 18, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7989609241485596
Epoch: 19, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.774712085723877
Epoch: 20, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.642786979675293
Epoch: 21, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7336921691894531
Epoch: 22, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9364542961120605
Epoch: 23, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 844775
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6109466552734375
Epoch: 1, Steps: 1 | Train Loss: 1.529 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.856665849685669
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6820087432861328
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2098205089569092
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8017082214355469
Epoch: 5, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0986323356628418
Epoch: 6, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7999057769775391
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8066716194152832
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8379318714141846
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.8649687767028809
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8088548183441162
Epoch: 11, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.851783037185669
Epoch: 12, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.672675609588623
Epoch: 13, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8648781776428223
Epoch: 14, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.84110426902771
Epoch: 15, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7919039726257324
Epoch: 16, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7913141250610352
Epoch: 17, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8285245895385742
Epoch: 18, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8165903091430664
Epoch: 19, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 824679
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.705388307571411
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7115991115570068
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7273223400115967
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6922867298126221
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7581138610839844
Epoch: 5, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.830718994140625
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0311768054962158
Epoch: 7, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9576880931854248
Epoch: 8, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8091702461242676
Epoch: 9, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.8147115707397461
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6996872425079346
Epoch: 11, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9638586044311523
Epoch: 12, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.979008674621582
Epoch: 13, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.7012917995452881
Epoch: 14, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8416550159454346
Epoch: 15, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.6441030502319336
Epoch: 16, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9094319343566895
Epoch: 17, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 1.0299854278564453
Epoch: 18, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7742159366607666
Epoch: 19, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0501956939697266
Epoch: 20, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8036086559295654
Epoch: 21, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8851850032806396
Epoch: 22, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0383751392364502
Epoch: 23, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.152235984802246
Epoch: 24, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8863577842712402
Epoch: 25, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8808178901672363
Epoch: 26, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9817218780517578
Epoch: 27, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 719847
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.86722469329834
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8217368125915527
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7695484161376953
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8123738765716553
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6873786449432373
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5967552661895752
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9267163276672363
Epoch: 7, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7693736553192139
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8545358180999756
Epoch: 9, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7465035915374756
Epoch: 10, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.108 Vali Acc: 0.133 Test Loss: 1.108 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.609072208404541
Epoch: 11, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8900175094604492
Epoch: 12, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.72849440574646
Epoch: 13, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8333826065063477
Epoch: 14, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6867725849151611
Epoch: 15, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9670302867889404
Epoch: 16, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1555063724517822
Epoch: 17, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6809823513031006
Epoch: 18, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 699751
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.308718204498291
Epoch: 1, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8545947074890137
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8300929069519043
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.868943452835083
Epoch: 4, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8192439079284668
Epoch: 5, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.7186141014099121
Epoch: 6, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.781651496887207
Epoch: 7, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.147 Vali Acc: 0.000 Test Loss: 1.147 Test Acc: 0.000
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.983259916305542
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.6657795906066895
Epoch: 9, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6663498878479004
Epoch: 10, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.8365747928619385
Epoch: 11, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.9570362567901611
Epoch: 12, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8599154949188232
Epoch: 13, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.6831374168395996
Epoch: 14, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7286436557769775
Epoch: 15, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0036587715148926
Epoch: 16, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8022732734680176
Epoch: 17, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7213799953460693
Epoch: 18, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8082849979400635
Epoch: 19, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6294667720794678
Epoch: 20, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.5652022361755371
Epoch: 21, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9210109710693359
Epoch: 22, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7252423763275146
Epoch: 23, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7155508995056152
Epoch: 24, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7608857154846191
Epoch: 25, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7475314140319824
Epoch: 26, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.773073673248291
Epoch: 27, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0726275444030762
Epoch: 28, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8043577671051025
Epoch: 29, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7760567665100098
Epoch: 30, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 679655
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.249091148376465
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8345515727996826
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9028670787811279
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8473591804504395
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6679573059082031
Epoch: 5, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7830162048339844
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7319536209106445
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.640017032623291
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7667880058288574
Epoch: 9, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8568532466888428
Epoch: 10, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7755343914031982
Epoch: 11, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9579627513885498
Epoch: 12, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.8783199787139893
Epoch: 13, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.905773401260376
Epoch: 14, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9800503253936768
Epoch: 15, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.943718671798706
Epoch: 16, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9081547260284424
Epoch: 17, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0963854789733887
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1899254322052002
Epoch: 19, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.015573501586914
Epoch: 20, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8364319801330566
Epoch: 21, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7380514144897461
Epoch: 22, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9316308498382568
Epoch: 23, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 659559
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9605982303619385
Epoch: 1, Steps: 1 | Train Loss: 1.364 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.107686996459961
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2158052921295166
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.716677188873291
Epoch: 4, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7414834499359131
Epoch: 5, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8378174304962158
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.126908302307129
Epoch: 7, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8030598163604736
Epoch: 8, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9080250263214111
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.462782859802246
Epoch: 10, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1953866481781006
Epoch: 11, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9841737747192383
Epoch: 12, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.0413856506347656
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.003199577331543
Epoch: 14, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1693165302276611
Epoch: 15, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0335655212402344
Epoch: 16, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.9243848323822021
Epoch: 17, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.967026948928833
Epoch: 18, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2704064846038818
Epoch: 19, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.96327805519104
Epoch: 20, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0418579578399658
Epoch: 21, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9179906845092773
Epoch: 22, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.8796093463897705
Epoch: 23, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0230088233947754
Epoch: 24, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2156598567962646
Epoch: 25, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1140339374542236
Epoch: 26, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.028 Vali Acc: 0.333 Test Loss: 1.028 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2532765865325928
Epoch: 27, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1501190662384033
Epoch: 28, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.000715970993042
Epoch: 29, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.9905776977539062
Epoch: 30, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8992352485656738
Epoch: 31, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1260480880737305
Epoch: 32, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9723031520843506
Epoch: 33, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1316699981689453
Epoch: 34, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0536105632781982
Epoch: 35, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2029483318328857
Epoch: 36, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8848567008972168
Epoch: 37, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0076854228973389
Epoch: 38, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.827547550201416
Epoch: 39, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 637287
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.840397357940674
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.9496760368347168
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.7578656673431396
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.023 Vali Acc: 0.667 Test Loss: 1.023 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 0.7661478519439697
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0338594913482666
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8580889701843262
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.018 Vali Acc: 0.667 Test Loss: 1.018 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.749093770980835
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.015 Vali Acc: 0.667 Test Loss: 1.015 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.8826320171356201
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.177309513092041
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9914445877075195
Epoch: 10, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.015 Vali Acc: 0.667 Test Loss: 1.015 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 1.0647618770599365
Epoch: 11, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9262135028839111
Epoch: 12, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7716333866119385
Epoch: 13, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9872217178344727
Epoch: 14, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9298932552337646
Epoch: 15, Steps: 1 | Train Loss: 0.588 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0746707916259766
Epoch: 16, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.119415521621704
Epoch: 17, Steps: 1 | Train Loss: 0.510 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9430127143859863
Epoch: 18, Steps: 1 | Train Loss: 0.455 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1708307266235352
Epoch: 19, Steps: 1 | Train Loss: 0.401 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9230859279632568
Epoch: 20, Steps: 1 | Train Loss: 0.376 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 617191
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.978593349456787
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8907976150512695
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7977700233459473
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8950328826904297
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6420536041259766
Epoch: 5, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6924431324005127
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7052426338195801
Epoch: 7, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6674075126647949
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.6366591453552246
Epoch: 9, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8844418525695801
Epoch: 10, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8533036708831787
Epoch: 11, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9436674118041992
Epoch: 12, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8781516551971436
Epoch: 13, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0249333381652832
Epoch: 14, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6797444820404053
Epoch: 15, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.730320930480957
Epoch: 16, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0669996738433838
Epoch: 17, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6752641201019287
Epoch: 18, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 597095
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4787983894348145
Epoch: 1, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.8928160667419434
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6575078964233398
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9530901908874512
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7913467884063721
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9303820133209229
Epoch: 6, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8475706577301025
Epoch: 7, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7750828266143799
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8329372406005859
Epoch: 9, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8843514919281006
Epoch: 10, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6685607433319092
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9720044136047363
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.721421480178833
Epoch: 13, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8632564544677734
Epoch: 14, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8381590843200684
Epoch: 15, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6591482162475586
Epoch: 16, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7788999080657959
Epoch: 17, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7046506404876709
Epoch: 18, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.691908597946167
Epoch: 19, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7572436332702637
Epoch: 20, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8243319988250732
Epoch: 21, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8653664588928223
Epoch: 22, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7154324054718018
Epoch: 23, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.810478687286377
Epoch: 24, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6337583065032959
Epoch: 25, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0259742736816406
Epoch: 26, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.918942928314209
Epoch: 27, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0447943210601807
Epoch: 28, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 576999
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2069101333618164
Epoch: 1, Steps: 1 | Train Loss: 1.385 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.2107658386230469
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.043710708618164
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8914167881011963
Epoch: 4, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.365490436553955
Epoch: 5, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9866089820861816
Epoch: 6, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2487478256225586
Epoch: 7, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8058280944824219
Epoch: 8, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3548569679260254
Epoch: 9, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0118098258972168
Epoch: 10, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 1.2320513725280762
Epoch: 11, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1543068885803223
Epoch: 12, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1998443603515625
Epoch: 13, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8338065147399902
Epoch: 14, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9451758861541748
Epoch: 15, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8106100559234619
Epoch: 16, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9108126163482666
Epoch: 17, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.078127145767212
Epoch: 18, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.8499970436096191
Epoch: 19, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.7815027236938477
Epoch: 20, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 1.0036897659301758
Epoch: 21, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.9327206611633301
Epoch: 22, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0045270919799805
Epoch: 23, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1016695499420166
Epoch: 24, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 1.3283944129943848
Epoch: 25, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.900263786315918
Epoch: 26, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9481973648071289
Epoch: 27, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1661252975463867
Epoch: 28, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8924031257629395
Epoch: 29, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8576850891113281
Epoch: 30, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9134232997894287
Epoch: 31, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 32 cost time: 0.9075601100921631
Epoch: 32, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.115156650543213
Epoch: 33, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7885918617248535
Epoch: 34, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.055415391921997
Epoch: 35, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8047728538513184
Epoch: 36, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9227137565612793
Epoch: 37, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1024177074432373
Epoch: 38, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9891746044158936
Epoch: 39, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9228525161743164
Epoch: 40, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3376564979553223
Epoch: 41, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 528263
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1853671073913574
Epoch: 1, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1192045211791992
Epoch: 2, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.732123851776123
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.9599719047546387
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7233395576477051
Epoch: 5, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8210771083831787
Epoch: 6, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9292380809783936
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9169943332672119
Epoch: 8, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.8907456398010254
Epoch: 9, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.008193016052246
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9957280158996582
Epoch: 11, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0418179035186768
Epoch: 12, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4119737148284912
Epoch: 13, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.391409158706665
Epoch: 14, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0084834098815918
Epoch: 15, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9278571605682373
Epoch: 16, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9487528800964355
Epoch: 17, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7836053371429443
Epoch: 18, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 518215
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0449905395507812
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.8870642185211182
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6923933029174805
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7510926723480225
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7972023487091064
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7780020236968994
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.1526191234588623
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.8031015396118164
Epoch: 8, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9542362689971924
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9263761043548584
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8350441455841064
Epoch: 11, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8753242492675781
Epoch: 12, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.00933837890625
Epoch: 13, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0846757888793945
Epoch: 14, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7359774112701416
Epoch: 15, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8641119003295898
Epoch: 16, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.8276574611663818
Epoch: 17, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.9341380596160889
Epoch: 18, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.760624885559082
Epoch: 19, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0498154163360596
Epoch: 20, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9573793411254883
Epoch: 21, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7831261157989502
Epoch: 22, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2014811038970947
Epoch: 23, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7962682247161865
Epoch: 24, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.034534215927124
Epoch: 25, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.848477840423584
Epoch: 26, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7543549537658691
Epoch: 27, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 508167
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.369184970855713
Epoch: 1, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.060920000076294
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0835797786712646
Epoch: 3, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1973953247070312
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0749964714050293
Epoch: 5, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3016843795776367
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8285479545593262
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.993441104888916
Epoch: 8, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3413426876068115
Epoch: 9, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9488790035247803
Epoch: 10, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0370566844940186
Epoch: 11, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1245110034942627
Epoch: 12, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 1.0042235851287842
Epoch: 13, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8350496292114258
Epoch: 14, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1181631088256836
Epoch: 15, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9886422157287598
Epoch: 16, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9495968818664551
Epoch: 17, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0358550548553467
Epoch: 18, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1337711811065674
Epoch: 19, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.031470537185669
Epoch: 20, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.918980598449707
Epoch: 21, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 1.04111647605896
Epoch: 22, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.827221155166626
Epoch: 23, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8036682605743408
Epoch: 24, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7777535915374756
Epoch: 25, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0285966396331787
Epoch: 26, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0955991744995117
Epoch: 27, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0436644554138184
Epoch: 28, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 29 cost time: 0.8887104988098145
Epoch: 29, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9755620956420898
Epoch: 30, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 31 cost time: 0.9245827198028564
Epoch: 31, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9628493785858154
Epoch: 32, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 33 cost time: 1.0616943836212158
Epoch: 33, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.960261344909668
Epoch: 34, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1402461528778076
Epoch: 35, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1435861587524414
Epoch: 36, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9361097812652588
Epoch: 37, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9891586303710938
Epoch: 38, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9686479568481445
Epoch: 39, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9737083911895752
Epoch: 40, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0285944938659668
Epoch: 41, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9181320667266846
Epoch: 42, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 498119
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1170263290405273
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8882031440734863
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7499539852142334
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8554747104644775
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6800315380096436
Epoch: 5, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9520714282989502
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6855442523956299
Epoch: 7, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.061880111694336
Epoch: 8, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8164157867431641
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.9291303157806396
Epoch: 10, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0868592262268066
Epoch: 11, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7103829383850098
Epoch: 12, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1471924781799316
Epoch: 13, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8960638046264648
Epoch: 14, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.2558550834655762
Epoch: 15, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7888157367706299
Epoch: 16, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8290433883666992
Epoch: 17, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9904050827026367
Epoch: 18, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8995921611785889
Epoch: 19, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.6859982013702393
Epoch: 20, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.8412449359893799
Epoch: 21, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.6909642219543457
Epoch: 22, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9947187900543213
Epoch: 23, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9653835296630859
Epoch: 24, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7424311637878418
Epoch: 25, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0365679264068604
Epoch: 26, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9473838806152344
Epoch: 27, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7232859134674072
Epoch: 28, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.068 Vali Acc: 0.267 Test Loss: 1.068 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8444221019744873
Epoch: 29, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7991149425506592
Epoch: 30, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7829697132110596
Epoch: 31, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 361863
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2245635986328125
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.8389770984649658
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 1.0044374465942383
Epoch: 3, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8300051689147949
Epoch: 4, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.781620979309082
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7846438884735107
Epoch: 6, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.998859167098999
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8754916191101074
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8764102458953857
Epoch: 9, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8463635444641113
Epoch: 10, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9440834522247314
Epoch: 11, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8809525966644287
Epoch: 12, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7885370254516602
Epoch: 13, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7819037437438965
Epoch: 14, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 351815
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6967577934265137
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7534613609313965
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.057433843612671
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7651522159576416
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0938823223114014
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.735236406326294
Epoch: 6, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8254163265228271
Epoch: 7, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8828957080841064
Epoch: 8, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.594193696975708
Epoch: 9, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9086880683898926
Epoch: 10, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6423320770263672
Epoch: 11, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.9508476257324219
Epoch: 12, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7201266288757324
Epoch: 13, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9124648571014404
Epoch: 14, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7607769966125488
Epoch: 15, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.771127462387085
Epoch: 16, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8140299320220947
Epoch: 17, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.7428925037384033
Epoch: 18, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.7419230937957764
Epoch: 19, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.8017404079437256
Epoch: 20, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 21 cost time: 0.6893486976623535
Epoch: 21, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.822624921798706
Epoch: 22, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8772666454315186
Epoch: 23, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9315683841705322
Epoch: 24, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.940255880355835
Epoch: 25, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8136663436889648
Epoch: 26, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7076563835144043
Epoch: 27, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 28 cost time: 0.6740560531616211
Epoch: 28, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6699025630950928
Epoch: 29, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7476005554199219
Epoch: 30, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7746622562408447
Epoch: 31, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0779919624328613
Epoch: 32, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7514762878417969
Epoch: 33, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6956963539123535
Epoch: 34, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 35 cost time: 0.7531156539916992
Epoch: 35, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8142406940460205
Epoch: 36, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6941685676574707
Epoch: 37, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7498114109039307
Epoch: 38, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8613524436950684
Epoch: 39, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.146765947341919
Epoch: 40, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8724112510681152
Epoch: 41, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7924520969390869
Epoch: 42, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8113832473754883
Epoch: 43, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8557653427124023
Epoch: 44, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 341767
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.347188711166382
Epoch: 1, Steps: 1 | Train Loss: 1.439 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5936505794525146
Epoch: 2, Steps: 1 | Train Loss: 1.299 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7400381565093994
Epoch: 3, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7095973491668701
Epoch: 4, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.7415845394134521
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9253711700439453
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.155 Vali Acc: 0.533 Test Loss: 1.155 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0132856369018555
Epoch: 7, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.157 Vali Acc: 0.533 Test Loss: 1.157 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9122257232666016
Epoch: 8, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8386964797973633
Epoch: 9, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0125374794006348
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9678781032562256
Epoch: 11, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.341247320175171
Epoch: 12, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1831417083740234
Epoch: 13, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.100 Vali Acc: 0.133 Test Loss: 1.100 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0759551525115967
Epoch: 14, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.092 Vali Acc: 0.133 Test Loss: 1.092 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 331719
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.960768222808838
Epoch: 1, Steps: 1 | Train Loss: 1.408 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6826105117797852
Epoch: 2, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7102067470550537
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.853705644607544
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0199947357177734
Epoch: 5, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9484508037567139
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9255063533782959
Epoch: 7, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9814932346343994
Epoch: 8, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.708251953125
Epoch: 9, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.8394007682800293
Epoch: 10, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0397300720214844
Epoch: 11, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9819362163543701
Epoch: 12, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8716170787811279
Epoch: 13, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.039748191833496
Epoch: 14, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9953787326812744
Epoch: 15, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9202852249145508
Epoch: 16, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1433775424957275
Epoch: 17, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7779397964477539
Epoch: 18, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0765933990478516
Epoch: 19, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 278663
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.845026731491089
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7644209861755371
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7510676383972168
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0126774311065674
Epoch: 4, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7665097713470459
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6046397686004639
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6364693641662598
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8475255966186523
Epoch: 8, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6590144634246826
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8181228637695312
Epoch: 10, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8508405685424805
Epoch: 11, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7524597644805908
Epoch: 12, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7825989723205566
Epoch: 13, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7381651401519775
Epoch: 14, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7166104316711426
Epoch: 15, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.6037650108337402
Epoch: 16, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7497844696044922
Epoch: 17, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.6134328842163086
Epoch: 18, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.71323561668396
Epoch: 19, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7240722179412842
Epoch: 20, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8794031143188477
Epoch: 21, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0454866886138916
Epoch: 22, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7919676303863525
Epoch: 23, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7848405838012695
Epoch: 24, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9365541934967041
Epoch: 25, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8673059940338135
Epoch: 26, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8757245540618896
Epoch: 27, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9961917400360107
Epoch: 28, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 268615
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.699274778366089
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7661352157592773
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.943270206451416
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6834163665771484
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7901773452758789
Epoch: 5, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5925107002258301
Epoch: 6, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6852209568023682
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8822417259216309
Epoch: 8, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8838574886322021
Epoch: 9, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6624131202697754
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7720563411712646
Epoch: 11, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6158196926116943
Epoch: 12, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.6544268131256104
Epoch: 13, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7333109378814697
Epoch: 14, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0029571056365967
Epoch: 15, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.898822546005249
Epoch: 16, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7077963352203369
Epoch: 17, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.798412561416626
Epoch: 18, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0439834594726562
Epoch: 19, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.8635563850402832
Epoch: 20, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7842028141021729
Epoch: 21, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9494423866271973
Epoch: 22, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.025542974472046
Epoch: 23, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6963930130004883
Epoch: 24, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7375001907348633
Epoch: 25, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6827504634857178
Epoch: 26, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7645909786224365
Epoch: 27, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7903850078582764
Epoch: 28, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.048 Vali Acc: 0.200 Test Loss: 1.048 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8532416820526123
Epoch: 29, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.8308441638946533
Epoch: 30, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7022936344146729
Epoch: 31, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6878700256347656
Epoch: 32, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6954517364501953
Epoch: 33, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6190338134765625
Epoch: 34, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6342837810516357
Epoch: 35, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6546471118927002
Epoch: 36, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6379990577697754
Epoch: 37, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.052 Vali Acc: 0.267 Test Loss: 1.052 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6990644931793213
Epoch: 38, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5700137615203857
Epoch: 39, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 258567
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.343846082687378
Epoch: 1, Steps: 1 | Train Loss: 1.307 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6145315170288086
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7519750595092773
Epoch: 3, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.7575299739837646
Epoch: 4, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8307485580444336
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6912877559661865
Epoch: 6, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.60927414894104
Epoch: 7, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8492968082427979
Epoch: 8, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.852506160736084
Epoch: 9, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9540438652038574
Epoch: 10, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.7679920196533203
Epoch: 11, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8533272743225098
Epoch: 12, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8953557014465332
Epoch: 13, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6792957782745361
Epoch: 14, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6882123947143555
Epoch: 15, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7523751258850098
Epoch: 16, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8696513175964355
Epoch: 17, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7904500961303711
Epoch: 18, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8351786136627197
Epoch: 19, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7477657794952393
Epoch: 20, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.6265954971313477
Epoch: 21, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.75174880027771
Epoch: 22, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6519424915313721
Epoch: 23, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8204717636108398
Epoch: 24, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9035634994506836
Epoch: 25, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.003 Vali Acc: 0.600 Test Loss: 1.003 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7345595359802246
Epoch: 26, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0562469959259033
Epoch: 27, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 0.7467348575592041
Epoch: 28, Steps: 1 | Train Loss: 0.439 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7468757629394531
Epoch: 29, Steps: 1 | Train Loss: 0.391 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6702744960784912
Epoch: 30, Steps: 1 | Train Loss: 0.362 Vali Loss: 0.979 Vali Acc: 0.400 Test Loss: 0.979 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7649903297424316
Epoch: 31, Steps: 1 | Train Loss: 0.295 Vali Loss: 0.986 Vali Acc: 0.267 Test Loss: 0.986 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0137989521026611
Epoch: 32, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.004 Vali Acc: 0.333 Test Loss: 1.004 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.62249755859375
Epoch: 33, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9769463539123535
Epoch: 34, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6345691680908203
Epoch: 35, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7524745464324951
Epoch: 36, Steps: 1 | Train Loss: 0.223 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7486834526062012
Epoch: 37, Steps: 1 | Train Loss: 0.180 Vali Loss: 0.977 Vali Acc: 0.400 Test Loss: 0.977 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 248519
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.993330717086792
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9703309535980225
Epoch: 2, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2776129245758057
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.209141492843628
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7972157001495361
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9509842395782471
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1213445663452148
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 1.0767288208007812
Epoch: 8, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 1.0019094944000244
Epoch: 9, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.094043254852295
Epoch: 10, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0547752380371094
Epoch: 11, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0674896240234375
Epoch: 12, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0988624095916748
Epoch: 13, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1567437648773193
Epoch: 14, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0304358005523682
Epoch: 15, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1066250801086426
Epoch: 16, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4500010013580322
Epoch: 17, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8643076419830322
Epoch: 18, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 237063
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.109435796737671
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.044520616531372
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9158287048339844
Epoch: 3, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8157103061676025
Epoch: 4, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.994941234588623
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9112679958343506
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.9473729133605957
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0273463726043701
Epoch: 8, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.084259271621704
Epoch: 9, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7548177242279053
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7162888050079346
Epoch: 11, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0601913928985596
Epoch: 12, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.933819055557251
Epoch: 13, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0647368431091309
Epoch: 14, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0313193798065186
Epoch: 15, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.068 Vali Acc: 0.667 Test Loss: 1.068 Test Acc: 0.667
Validation loss decreased (-0.533322 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.7274007797241211
Epoch: 16, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7842245101928711
Epoch: 17, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7402281761169434
Epoch: 18, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8826432228088379
Epoch: 19, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9072756767272949
Epoch: 20, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8343133926391602
Epoch: 21, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9400522708892822
Epoch: 22, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6944506168365479
Epoch: 23, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.845170259475708
Epoch: 24, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7973456382751465
Epoch: 25, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 227015
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.6095311641693115
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7649073600769043
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9831805229187012
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4375381469726562
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1904544830322266
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.095463752746582
Epoch: 6, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.152864694595337
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8318638801574707
Epoch: 8, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1372301578521729
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8616597652435303
Epoch: 10, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.835658073425293
Epoch: 11, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.044102430343628
Epoch: 12, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8836302757263184
Epoch: 13, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1296560764312744
Epoch: 14, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0902154445648193
Epoch: 15, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3173596858978271
Epoch: 16, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.95851731300354
Epoch: 17, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.8614439964294434
Epoch: 18, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0318219661712646
Epoch: 19, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0199074745178223
Epoch: 20, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 21 cost time: 1.0590224266052246
Epoch: 21, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0389740467071533
Epoch: 22, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4534022808074951
Epoch: 23, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.557220220565796
Epoch: 24, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0375523567199707
Epoch: 25, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1606643199920654
Epoch: 26, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3049132823944092
Epoch: 27, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2336418628692627
Epoch: 28, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1107125282287598
Epoch: 29, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2845094203948975
Epoch: 30, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 216967
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.726350784301758
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.829747200012207
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.0406215190887451
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9296565055847168
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8117399215698242
Epoch: 5, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6744658946990967
Epoch: 6, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4640827178955078
Epoch: 7, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7923810482025146
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8698017597198486
Epoch: 9, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8639733791351318
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8876540660858154
Epoch: 11, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9038205146789551
Epoch: 12, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0432438850402832
Epoch: 13, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8504440784454346
Epoch: 14, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.043 Vali Acc: 0.733 Test Loss: 1.043 Test Acc: 0.733
Validation loss decreased (-0.533323 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 0.8202865123748779
Epoch: 15, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8320395946502686
Epoch: 16, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1395576000213623
Epoch: 17, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0655286312103271
Epoch: 18, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7506821155548096
Epoch: 19, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0340313911437988
Epoch: 20, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8486447334289551
Epoch: 21, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0219030380249023
Epoch: 22, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9572017192840576
Epoch: 23, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.019 Vali Acc: 0.667 Test Loss: 1.019 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9093689918518066
Epoch: 24, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.015 Vali Acc: 0.667 Test Loss: 1.015 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 206919
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.392009973526001
Epoch: 1, Steps: 1 | Train Loss: 1.284 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9376888275146484
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.9717907905578613
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.333321 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.9048404693603516
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8665556907653809
Epoch: 5, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6936469078063965
Epoch: 6, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.730705976486206
Epoch: 7, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6445038318634033
Epoch: 8, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7005982398986816
Epoch: 9, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.670 Vali Acc: 0.333 Test Loss: 1.670 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7987546920776367
Epoch: 10, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.457 Vali Acc: 0.333 Test Loss: 1.457 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.991077184677124
Epoch: 11, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9151899814605713
Epoch: 12, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.381 Vali Acc: 0.333 Test Loss: 1.381 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9560420513153076
Epoch: 13, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5823515
model size : 27.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3794033527374268
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.0110158920288086
Epoch: 2, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.25246262550354
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.173553466796875
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8459460735321045
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.9367702007293701
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0775177478790283
Epoch: 7, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6577889919281006
Epoch: 8, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.8226931095123291
Epoch: 9, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.080399990081787
Epoch: 10, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4624788761138916
Epoch: 11, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4287481307983398
Epoch: 12, Steps: 1 | Train Loss: 0.158 Vali Loss: 2.141 Vali Acc: 0.333 Test Loss: 2.141 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6898226737976074
Epoch: 13, Steps: 1 | Train Loss: 0.428 Vali Loss: 2.268 Vali Acc: 0.333 Test Loss: 2.268 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.070260763168335
Epoch: 14, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7914848327636719
Epoch: 15, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.777 Vali Acc: 0.333 Test Loss: 1.777 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.204347848892212
Epoch: 16, Steps: 1 | Train Loss: 0.200 Vali Loss: 2.477 Vali Acc: 0.333 Test Loss: 2.477 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0534071922302246
Epoch: 17, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.710 Vali Acc: 0.333 Test Loss: 1.710 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.034757137298584
Epoch: 18, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.745 Vali Acc: 0.333 Test Loss: 1.745 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5770011
model size : 26.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1426162719726562
Epoch: 1, Steps: 1 | Train Loss: 1.326 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.8062279224395752
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8030776977539062
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9330809116363525
Epoch: 4, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1659340858459473
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8249309062957764
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.068265438079834
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3189668655395508
Epoch: 8, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7560513019561768
Epoch: 9, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.9559361934661865
Epoch: 10, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8132870197296143
Epoch: 11, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8683531284332275
Epoch: 12, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0322597026824951
Epoch: 13, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.049661636352539
Epoch: 14, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1916635036468506
Epoch: 15, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.642 Vali Acc: 0.333 Test Loss: 1.642 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0817575454711914
Epoch: 16, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.462 Vali Acc: 0.467 Test Loss: 1.462 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466652).  Saving model ...
Epoch: 17 cost time: 0.924290657043457
Epoch: 17, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.333 Vali Acc: 0.333 Test Loss: 1.333 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0795602798461914
Epoch: 18, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.649 Vali Acc: 0.333 Test Loss: 1.649 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0650815963745117
Epoch: 19, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.841 Vali Acc: 0.333 Test Loss: 1.841 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.108558177947998
Epoch: 20, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.730 Vali Acc: 0.400 Test Loss: 1.730 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0763227939605713
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.392 Vali Acc: 0.333 Test Loss: 2.392 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0700950622558594
Epoch: 22, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.730 Vali Acc: 0.333 Test Loss: 1.730 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3203351497650146
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.333 Test Loss: 1.545 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.160919189453125
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.008 Vali Acc: 0.467 Test Loss: 2.008 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9724228382110596
Epoch: 25, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.597 Vali Acc: 0.400 Test Loss: 2.597 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9717245101928711
Epoch: 26, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.900 Vali Acc: 0.400 Test Loss: 2.900 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5716507
model size : 26.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.063307523727417
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0606186389923096
Epoch: 2, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7902460098266602
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.78922438621521
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.689828634262085
Epoch: 5, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9161059856414795
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.857358455657959
Epoch: 7, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.988029956817627
Epoch: 8, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 1.5923564434051514
Epoch: 9, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.33486008644104
Epoch: 10, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.0189640522003174
Epoch: 11, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9210591316223145
Epoch: 12, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0393545627593994
Epoch: 13, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1057283878326416
Epoch: 14, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1978814601898193
Epoch: 15, Steps: 1 | Train Loss: 0.032 Vali Loss: 2.105 Vali Acc: 0.333 Test Loss: 2.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8312513828277588
Epoch: 16, Steps: 1 | Train Loss: 0.085 Vali Loss: 2.288 Vali Acc: 0.333 Test Loss: 2.288 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8981945514678955
Epoch: 17, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0813615322113037
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.499 Vali Acc: 0.467 Test Loss: 1.499 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1456279754638672
Epoch: 19, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.39017915725708
Epoch: 20, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.715 Vali Acc: 0.333 Test Loss: 1.715 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5663003
model size : 26.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9899046421051025
Epoch: 1, Steps: 1 | Train Loss: 1.256 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1026573181152344
Epoch: 2, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7532632350921631
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.018545150756836
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.8503749370574951
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0714423656463623
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1039071083068848
Epoch: 7, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.8912160396575928
Epoch: 8, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8327078819274902
Epoch: 9, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.0715723037719727
Epoch: 10, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8512392044067383
Epoch: 11, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0871868133544922
Epoch: 12, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7976357936859131
Epoch: 13, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.304 Vali Acc: 0.467 Test Loss: 1.304 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.775536298751831
Epoch: 14, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8291101455688477
Epoch: 15, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7312328815460205
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8431029319763184
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.428 Vali Acc: 0.333 Test Loss: 1.428 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.754570484161377
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.333 Test Loss: 1.417 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9637174606323242
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.441 Vali Acc: 0.400 Test Loss: 1.441 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5035547
model size : 24.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8986401557922363
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.8531737327575684
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.894629716873169
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.011174201965332
Epoch: 4, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.892657995223999
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.864065408706665
Epoch: 6, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1142528057098389
Epoch: 7, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7319967746734619
Epoch: 8, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8195416927337646
Epoch: 9, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.9078357219696045
Epoch: 10, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.454 Vali Acc: 0.333 Test Loss: 1.454 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8363990783691406
Epoch: 11, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9044723510742188
Epoch: 12, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9135961532592773
Epoch: 13, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8396360874176025
Epoch: 14, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9390721321105957
Epoch: 15, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.492 Vali Acc: 0.267 Test Loss: 1.492 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6758627891540527
Epoch: 16, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.377 Vali Acc: 0.400 Test Loss: 1.377 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8238816261291504
Epoch: 17, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8763480186462402
Epoch: 18, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.714 Vali Acc: 0.400 Test Loss: 1.714 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8327121734619141
Epoch: 19, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4982043
model size : 23.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.754558801651001
Epoch: 1, Steps: 1 | Train Loss: 1.377 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6724855899810791
Epoch: 2, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8010859489440918
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9267685413360596
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6470146179199219
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.9479541778564453
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.704 Vali Acc: 0.333 Test Loss: 1.704 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8173716068267822
Epoch: 7, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.829 Vali Acc: 0.333 Test Loss: 1.829 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9950239658355713
Epoch: 8, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8630695343017578
Epoch: 9, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1750171184539795
Epoch: 10, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.464 Vali Acc: 0.333 Test Loss: 1.464 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8912408351898193
Epoch: 11, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9556026458740234
Epoch: 12, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9788343906402588
Epoch: 13, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0327088832855225
Epoch: 14, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8817687034606934
Epoch: 15, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.459 Vali Acc: 0.333 Test Loss: 1.459 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4928539
model size : 23.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.143742084503174
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8937971591949463
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7834327220916748
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7903971672058105
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6981470584869385
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7391393184661865
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6361744403839111
Epoch: 7, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8854327201843262
Epoch: 8, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1476714611053467
Epoch: 9, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7522523403167725
Epoch: 10, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9554233551025391
Epoch: 11, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8028078079223633
Epoch: 12, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7957048416137695
Epoch: 13, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.829 Vali Acc: 0.333 Test Loss: 1.829 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8698134422302246
Epoch: 14, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.494 Vali Acc: 0.333 Test Loss: 1.494 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6916449069976807
Epoch: 15, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.808415412902832
Epoch: 16, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.541 Vali Acc: 0.400 Test Loss: 1.541 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8748073577880859
Epoch: 17, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6257619857788086
Epoch: 18, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.020 Vali Acc: 0.333 Test Loss: 2.020 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.856360673904419
Epoch: 19, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.505 Vali Acc: 0.333 Test Loss: 1.505 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4875035
model size : 23.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.129317283630371
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.3423058986663818
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9848678112030029
Epoch: 3, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9955034255981445
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.965125560760498
Epoch: 5, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9518744945526123
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.8240087032318115
Epoch: 7, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0623202323913574
Epoch: 8, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.051344871520996
Epoch: 9, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.386 Vali Acc: 0.333 Test Loss: 1.386 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0539004802703857
Epoch: 10, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.830535888671875
Epoch: 11, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0752205848693848
Epoch: 12, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8962812423706055
Epoch: 13, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9862864017486572
Epoch: 14, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.460 Vali Acc: 0.267 Test Loss: 1.460 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8860406875610352
Epoch: 15, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8653209209442139
Epoch: 16, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.762 Vali Acc: 0.333 Test Loss: 1.762 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4641563
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2651755809783936
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.280228853225708
Epoch: 2, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8026669025421143
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0251789093017578
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1329851150512695
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0379881858825684
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2811157703399658
Epoch: 7, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3043725490570068
Epoch: 8, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8583250045776367
Epoch: 9, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8727350234985352
Epoch: 10, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8703827857971191
Epoch: 11, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9907877445220947
Epoch: 12, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.397 Vali Acc: 0.333 Test Loss: 1.397 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0940568447113037
Epoch: 13, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.372 Vali Acc: 0.267 Test Loss: 1.372 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0147299766540527
Epoch: 14, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.7700614929199219
Epoch: 15, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.241 Vali Acc: 0.467 Test Loss: 1.241 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9921457767486572
Epoch: 16, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.439 Vali Acc: 0.333 Test Loss: 1.439 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0669934749603271
Epoch: 17, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.519 Vali Acc: 0.467 Test Loss: 1.519 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0569090843200684
Epoch: 18, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9267368316650391
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.916 Vali Acc: 0.267 Test Loss: 1.916 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3721034526824951
Epoch: 20, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.428 Vali Acc: 0.267 Test Loss: 1.428 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8591091632843018
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8002533912658691
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.766 Vali Acc: 0.400 Test Loss: 1.766 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.859368085861206
Epoch: 23, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.639 Vali Acc: 0.333 Test Loss: 1.639 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1696922779083252
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.267 Test Loss: 1.862 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4588059
model size : 22.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3931853771209717
Epoch: 1, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.0053484439849854
Epoch: 2, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7736856937408447
Epoch: 3, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0597023963928223
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7732076644897461
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0427095890045166
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.2262961864471436
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1026976108551025
Epoch: 8, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0317716598510742
Epoch: 9, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 10 cost time: 0.8351917266845703
Epoch: 10, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.483 Vali Acc: 0.333 Test Loss: 1.483 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8671417236328125
Epoch: 11, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.0085713863372803
Epoch: 12, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7669196128845215
Epoch: 13, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.475 Vali Acc: 0.333 Test Loss: 1.475 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8842625617980957
Epoch: 14, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8760995864868164
Epoch: 15, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.494 Vali Acc: 0.467 Test Loss: 1.494 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466652).  Saving model ...
Epoch: 16 cost time: 0.7738857269287109
Epoch: 16, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.317 Vali Acc: 0.467 Test Loss: 1.317 Test Acc: 0.467
Validation loss decreased (-0.466652 --> -0.466653).  Saving model ...
Epoch: 17 cost time: 0.8250937461853027
Epoch: 17, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.436 Vali Acc: 0.333 Test Loss: 1.436 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7235140800476074
Epoch: 18, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.533 Vali Acc: 0.400 Test Loss: 1.533 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7904212474822998
Epoch: 19, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8452160358428955
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.849 Vali Acc: 0.400 Test Loss: 1.849 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7866222858428955
Epoch: 21, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.787 Vali Acc: 0.333 Test Loss: 1.787 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9853465557098389
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.725 Vali Acc: 0.333 Test Loss: 1.725 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.036128044128418
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.267 Test Loss: 1.721 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7895281314849854
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.333 Test Loss: 1.820 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.796208381652832
Epoch: 25, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.999 Vali Acc: 0.467 Test Loss: 1.999 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7782669067382812
Epoch: 26, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.179 Vali Acc: 0.333 Test Loss: 2.179 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4534555
model size : 22.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6178109645843506
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0356028079986572
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7754311561584473
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9253664016723633
Epoch: 4, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.0544235706329346
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.102745532989502
Epoch: 6, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0609805583953857
Epoch: 7, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0854833126068115
Epoch: 8, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2682721614837646
Epoch: 9, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.459 Vali Acc: 0.333 Test Loss: 1.459 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7953546047210693
Epoch: 10, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8666751384735107
Epoch: 11, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1835336685180664
Epoch: 12, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.818 Vali Acc: 0.333 Test Loss: 1.818 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3301427364349365
Epoch: 13, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.506 Vali Acc: 0.333 Test Loss: 1.506 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7924072742462158
Epoch: 14, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8383607864379883
Epoch: 15, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.480 Vali Acc: 0.400 Test Loss: 1.480 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4481051
model size : 22.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3214917182922363
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8109323978424072
Epoch: 2, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.280 Vali Acc: 0.067 Test Loss: 1.280 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0143566131591797
Epoch: 3, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.1259369850158691
Epoch: 4, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9855616092681885
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7177999019622803
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8298132419586182
Epoch: 7, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0225017070770264
Epoch: 8, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9013469219207764
Epoch: 9, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.7486279010772705
Epoch: 10, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.314 Vali Acc: 0.333 Test Loss: 1.314 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.986072301864624
Epoch: 11, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9075539112091064
Epoch: 12, Steps: 1 | Train Loss: 0.149 Vali Loss: 2.250 Vali Acc: 0.333 Test Loss: 2.250 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0585386753082275
Epoch: 13, Steps: 1 | Train Loss: 0.304 Vali Loss: 2.321 Vali Acc: 0.333 Test Loss: 2.321 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9944431781768799
Epoch: 14, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9558620452880859
Epoch: 15, Steps: 1 | Train Loss: 0.043 Vali Loss: 2.251 Vali Acc: 0.333 Test Loss: 2.251 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0759479999542236
Epoch: 16, Steps: 1 | Train Loss: 0.247 Vali Loss: 2.876 Vali Acc: 0.333 Test Loss: 2.876 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8703286647796631
Epoch: 17, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.817 Vali Acc: 0.333 Test Loss: 1.817 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1336925029754639
Epoch: 18, Steps: 1 | Train Loss: 0.050 Vali Loss: 2.055 Vali Acc: 0.333 Test Loss: 2.055 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.138599157333374
Epoch: 19, Steps: 1 | Train Loss: 0.018 Vali Loss: 2.612 Vali Acc: 0.333 Test Loss: 2.612 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.092484951019287
Epoch: 20, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.829 Vali Acc: 0.267 Test Loss: 1.829 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9484350681304932
Epoch: 21, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4444571
model size : 21.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4051406383514404
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.051316738128662
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8202989101409912
Epoch: 3, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.2301287651062012
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9993801116943359
Epoch: 5, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9124794006347656
Epoch: 6, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0577409267425537
Epoch: 7, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7564294338226318
Epoch: 8, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5209617614746094
Epoch: 9, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7266280651092529
Epoch: 10, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.320 Vali Acc: 0.333 Test Loss: 1.320 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8580946922302246
Epoch: 11, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.325 Vali Acc: 0.467 Test Loss: 1.325 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 12 cost time: 1.1969778537750244
Epoch: 12, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7538316249847412
Epoch: 13, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9272544384002686
Epoch: 14, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466653 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 1.0150012969970703
Epoch: 15, Steps: 1 | Train Loss: 0.041 Vali Loss: 2.553 Vali Acc: 0.333 Test Loss: 2.553 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8512990474700928
Epoch: 16, Steps: 1 | Train Loss: 0.211 Vali Loss: 2.607 Vali Acc: 0.333 Test Loss: 2.607 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.81919264793396
Epoch: 17, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0382719039916992
Epoch: 18, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.748 Vali Acc: 0.333 Test Loss: 1.748 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1661419868469238
Epoch: 19, Steps: 1 | Train Loss: 0.035 Vali Loss: 2.097 Vali Acc: 0.400 Test Loss: 2.097 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7792103290557861
Epoch: 20, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.591 Vali Acc: 0.333 Test Loss: 1.591 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.006824016571045
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.021 Vali Acc: 0.333 Test Loss: 2.021 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0543360710144043
Epoch: 22, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.438 Vali Acc: 0.333 Test Loss: 2.438 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1514618396759033
Epoch: 23, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.053 Vali Acc: 0.400 Test Loss: 2.053 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9073672294616699
Epoch: 24, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.333 Test Loss: 1.718 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4391067
model size : 21.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3167288303375244
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.332 Vali Acc: 0.333 Test Loss: 1.332 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.2982940673828125
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.049468994140625
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0596051216125488
Epoch: 4, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7676053047180176
Epoch: 5, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7176127433776855
Epoch: 6, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7853786945343018
Epoch: 7, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8506605625152588
Epoch: 8, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.981926441192627
Epoch: 9, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8637442588806152
Epoch: 10, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8044264316558838
Epoch: 11, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.9187450408935547
Epoch: 12, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2438395023345947
Epoch: 13, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.8413631916046143
Epoch: 14, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.648 Vali Acc: 0.400 Test Loss: 1.648 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.049863338470459
Epoch: 15, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.804 Vali Acc: 0.400 Test Loss: 1.804 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.128685474395752
Epoch: 16, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.854957103729248
Epoch: 17, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7808771133422852
Epoch: 18, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.771 Vali Acc: 0.400 Test Loss: 1.771 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0093417167663574
Epoch: 19, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.340 Vali Acc: 0.200 Test Loss: 1.340 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0371577739715576
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0527236461639404
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.335 Vali Acc: 0.467 Test Loss: 1.335 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.237058401107788
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.450 Vali Acc: 0.267 Test Loss: 1.450 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.202702283859253
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.333 Test Loss: 1.688 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4337563
model size : 21.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1482787132263184
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.1709010601043701
Epoch: 2, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.271829605102539
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.1931366920471191
Epoch: 4, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0055556297302246
Epoch: 5, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0340721607208252
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7737629413604736
Epoch: 7, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.9384026527404785
Epoch: 8, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.287 Vali Acc: 0.333 Test Loss: 1.287 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9065766334533691
Epoch: 9, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0325191020965576
Epoch: 10, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.279 Vali Acc: 0.467 Test Loss: 1.279 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.028235912322998
Epoch: 11, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8789377212524414
Epoch: 12, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.367 Vali Acc: 0.333 Test Loss: 1.367 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9990136623382568
Epoch: 13, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.926152229309082
Epoch: 14, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.480 Vali Acc: 0.400 Test Loss: 1.480 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1774265766143799
Epoch: 15, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.499 Vali Acc: 0.400 Test Loss: 1.499 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1804158687591553
Epoch: 16, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8341846466064453
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.444 Vali Acc: 0.267 Test Loss: 1.444 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4284059
model size : 21.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0951035022735596
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8001823425292969
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8562543392181396
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8359835147857666
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0758750438690186
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8899679183959961
Epoch: 6, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8305902481079102
Epoch: 7, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.764012336730957
Epoch: 8, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7146551609039307
Epoch: 9, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7233502864837646
Epoch: 10, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.7075257301330566
Epoch: 11, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0030999183654785
Epoch: 12, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.688817024230957
Epoch: 13, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8480210304260254
Epoch: 14, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.189856767654419
Epoch: 15, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7330343723297119
Epoch: 16, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7455151081085205
Epoch: 17, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8389396667480469
Epoch: 18, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7249400615692139
Epoch: 19, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.263 Vali Acc: 0.533 Test Loss: 1.263 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8449780941009521
Epoch: 20, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.386 Vali Acc: 0.533 Test Loss: 1.386 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2126875
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3704721927642822
Epoch: 1, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.165 Vali Acc: 0.067 Test Loss: 1.165 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.9250271320343018
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.066655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.707524299621582
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9189128875732422
Epoch: 4, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.701444149017334
Epoch: 5, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7398626804351807
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.326 Vali Acc: 0.333 Test Loss: 1.326 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8676705360412598
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.566 Vali Acc: 0.333 Test Loss: 1.566 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8603799343109131
Epoch: 8, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.480 Vali Acc: 0.333 Test Loss: 1.480 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9032151699066162
Epoch: 9, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8367917537689209
Epoch: 10, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6429519653320312
Epoch: 11, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.396 Vali Acc: 0.333 Test Loss: 1.396 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3754396438598633
Epoch: 12, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.7760007381439209
Epoch: 13, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8956053256988525
Epoch: 14, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.367 Vali Acc: 0.400 Test Loss: 1.367 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 15 cost time: 0.8519127368927002
Epoch: 15, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.3670713901519775
Epoch: 16, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 1.0266087055206299
Epoch: 17, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8297626972198486
Epoch: 18, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.680739164352417
Epoch: 19, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7422709465026855
Epoch: 20, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.504 Vali Acc: 0.400 Test Loss: 1.504 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8432035446166992
Epoch: 21, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9050006866455078
Epoch: 22, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.332 Vali Acc: 0.333 Test Loss: 1.332 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1168742179870605
Epoch: 23, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.555 Vali Acc: 0.333 Test Loss: 1.555 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.811528205871582
Epoch: 24, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0791170597076416
Epoch: 25, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.739736795425415
Epoch: 26, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.822 Vali Acc: 0.333 Test Loss: 1.822 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2100123
model size : 10.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.050753355026245
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9538116455078125
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.2108397483825684
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8407704830169678
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.825270414352417
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8621969223022461
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.069633960723877
Epoch: 7, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9092869758605957
Epoch: 8, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0178337097167969
Epoch: 9, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8115174770355225
Epoch: 10, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6439852714538574
Epoch: 11, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7990968227386475
Epoch: 12, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7377951145172119
Epoch: 13, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6908226013183594
Epoch: 14, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8021674156188965
Epoch: 15, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 16 cost time: 0.8333423137664795
Epoch: 16, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.269209861755371
Epoch: 17, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7775795459747314
Epoch: 18, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.647367000579834
Epoch: 19, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.693040132522583
Epoch: 20, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9174642562866211
Epoch: 21, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.341 Vali Acc: 0.267 Test Loss: 1.341 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.791806697845459
Epoch: 22, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.294 Vali Acc: 0.467 Test Loss: 1.294 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1663355827331543
Epoch: 23, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7942719459533691
Epoch: 24, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6542568206787109
Epoch: 25, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.384 Vali Acc: 0.267 Test Loss: 1.384 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2073371
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.46632719039917
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9453363418579102
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9739806652069092
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8267526626586914
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0822429656982422
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0895767211914062
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1439576148986816
Epoch: 7, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3767428398132324
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1388823986053467
Epoch: 9, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 1.277883529663086
Epoch: 10, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1273036003112793
Epoch: 11, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9150214195251465
Epoch: 12, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2552745342254639
Epoch: 13, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9904317855834961
Epoch: 14, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9007303714752197
Epoch: 15, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1411628723144531
Epoch: 16, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1046583652496338
Epoch: 17, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.122758150100708
Epoch: 18, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4374938011169434
Epoch: 19, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.061295747756958
Epoch: 20, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1499660015106201
Epoch: 21, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2046619
model size : 10.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0531184673309326
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.141873836517334
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8571033477783203
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.8708951473236084
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7415370941162109
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8167521953582764
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.114750623703003
Epoch: 7, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7302594184875488
Epoch: 8, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.002176284790039
Epoch: 9, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8800554275512695
Epoch: 10, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.816084623336792
Epoch: 11, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8421752452850342
Epoch: 12, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7069668769836426
Epoch: 13, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1732123
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0171799659729004
Epoch: 1, Steps: 1 | Train Loss: 1.380 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.871044397354126
Epoch: 2, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.795295000076294
Epoch: 3, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.821143627166748
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.1112678050994873
Epoch: 5, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.681084156036377
Epoch: 6, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.359 Vali Acc: 0.333 Test Loss: 1.359 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2401981353759766
Epoch: 7, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.680 Vali Acc: 0.333 Test Loss: 1.680 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8641109466552734
Epoch: 8, Steps: 1 | Train Loss: 1.394 Vali Loss: 1.520 Vali Acc: 0.333 Test Loss: 1.520 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9050912857055664
Epoch: 9, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7833404541015625
Epoch: 10, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.324 Vali Acc: 0.333 Test Loss: 1.324 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8794596195220947
Epoch: 11, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.554 Vali Acc: 0.333 Test Loss: 1.554 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9670255184173584
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8870644569396973
Epoch: 13, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8056070804595947
Epoch: 14, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.574 Vali Acc: 0.333 Test Loss: 1.574 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0880203247070312
Epoch: 15, Steps: 1 | Train Loss: 0.591 Vali Loss: 2.003 Vali Acc: 0.333 Test Loss: 2.003 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9206457138061523
Epoch: 16, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.645 Vali Acc: 0.333 Test Loss: 1.645 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1200482845306396
Epoch: 17, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7376768589019775
Epoch: 18, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.683 Vali Acc: 0.333 Test Loss: 1.683 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8890070915222168
Epoch: 19, Steps: 1 | Train Loss: 0.374 Vali Loss: 2.119 Vali Acc: 0.333 Test Loss: 2.119 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8137218952178955
Epoch: 20, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.956 Vali Acc: 0.333 Test Loss: 1.956 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9089517593383789
Epoch: 21, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.500 Vali Acc: 0.333 Test Loss: 1.500 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8538014888763428
Epoch: 22, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7670331001281738
Epoch: 23, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.530 Vali Acc: 0.333 Test Loss: 1.530 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1705371
model size : 9.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3388099670410156
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 1.1034584045410156
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8579106330871582
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8394615650177002
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9437563419342041
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8394653797149658
Epoch: 6, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9610798358917236
Epoch: 7, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8130309581756592
Epoch: 8, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9425210952758789
Epoch: 9, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9090766906738281
Epoch: 10, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.133326768875122
Epoch: 11, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1678619
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8914601802825928
Epoch: 1, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8654396533966064
Epoch: 2, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8456399440765381
Epoch: 3, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6903698444366455
Epoch: 4, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8076002597808838
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.821453332901001
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7254583835601807
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7133326530456543
Epoch: 8, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.638375997543335
Epoch: 9, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7472293376922607
Epoch: 10, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7146580219268799
Epoch: 11, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1048643589019775
Epoch: 12, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.756035327911377
Epoch: 13, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8516678810119629
Epoch: 14, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7646334171295166
Epoch: 15, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 1.0933663845062256
Epoch: 16, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1676783561706543
Epoch: 17, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9337646961212158
Epoch: 18, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6734015941619873
Epoch: 19, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7691102027893066
Epoch: 20, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8290152549743652
Epoch: 21, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7565836906433105
Epoch: 22, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7788369655609131
Epoch: 23, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1820142269134521
Epoch: 24, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.429 Vali Acc: 0.333 Test Loss: 1.429 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0031001567840576
Epoch: 25, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.451 Vali Acc: 0.333 Test Loss: 1.451 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1651867
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.615891456604004
Epoch: 1, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7949666976928711
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9515719413757324
Epoch: 3, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.744051456451416
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5953598022460938
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9420900344848633
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9062387943267822
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.6750783920288086
Epoch: 8, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7940137386322021
Epoch: 9, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.863095760345459
Epoch: 10, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8494787216186523
Epoch: 11, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8448553085327148
Epoch: 12, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9483301639556885
Epoch: 13, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.922332763671875
Epoch: 14, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0232083797454834
Epoch: 15, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.985292911529541
Epoch: 16, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8356945514678955
Epoch: 17, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1534747
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3917617797851562
Epoch: 1, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.2298223972320557
Epoch: 2, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.848750114440918
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9791991710662842
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8666582107543945
Epoch: 5, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1380414962768555
Epoch: 6, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0202832221984863
Epoch: 7, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.930762767791748
Epoch: 8, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6709887981414795
Epoch: 9, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6902387142181396
Epoch: 10, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7830641269683838
Epoch: 11, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7649924755096436
Epoch: 12, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7273695468902588
Epoch: 13, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9123189449310303
Epoch: 14, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9405467510223389
Epoch: 15, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 16 cost time: 0.8604772090911865
Epoch: 16, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.702613115310669
Epoch: 17, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8190999031066895
Epoch: 18, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.998532772064209
Epoch: 19, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.801408052444458
Epoch: 20, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6908857822418213
Epoch: 21, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.962 Vali Acc: 0.333 Test Loss: 1.962 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8900082111358643
Epoch: 22, Steps: 1 | Train Loss: 0.048 Vali Loss: 2.308 Vali Acc: 0.333 Test Loss: 2.308 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9370958805084229
Epoch: 23, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.794 Vali Acc: 0.333 Test Loss: 1.794 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8207545280456543
Epoch: 24, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6493127346038818
Epoch: 25, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1507995
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.143831491470337
Epoch: 1, Steps: 1 | Train Loss: 1.285 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.0746715068817139
Epoch: 2, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.777841329574585
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0192832946777344
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.123565673828125
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7260839939117432
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1181612014770508
Epoch: 7, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7505321502685547
Epoch: 8, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8864376544952393
Epoch: 9, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.832639217376709
Epoch: 10, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2612311840057373
Epoch: 11, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0928232669830322
Epoch: 12, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0653660297393799
Epoch: 13, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.076 Vali Acc: 0.200 Test Loss: 1.076 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8790884017944336
Epoch: 14, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8559508323669434
Epoch: 15, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1852340698242188
Epoch: 16, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9297289848327637
Epoch: 17, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9652414321899414
Epoch: 18, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1047704219818115
Epoch: 19, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.397 Vali Acc: 0.267 Test Loss: 1.397 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1481243
model size : 8.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0830888748168945
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7903392314910889
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.594937801361084
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7550346851348877
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.7773706912994385
Epoch: 5, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6118395328521729
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8845651149749756
Epoch: 7, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8298680782318115
Epoch: 8, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.9018268585205078
Epoch: 9, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9242055416107178
Epoch: 10, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9983773231506348
Epoch: 11, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.102931261062622
Epoch: 12, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8438215255737305
Epoch: 13, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7461080551147461
Epoch: 14, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7416706085205078
Epoch: 15, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7973191738128662
Epoch: 16, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.7505521774291992
Epoch: 17, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.832244873046875
Epoch: 18, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.208981990814209
Epoch: 19, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7893984317779541
Epoch: 20, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.404 Vali Acc: 0.467 Test Loss: 1.404 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7545840740203857
Epoch: 21, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.494 Vali Acc: 0.400 Test Loss: 1.494 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9513027667999268
Epoch: 22, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.928272008895874
Epoch: 23, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.287 Vali Acc: 0.467 Test Loss: 1.287 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8947038650512695
Epoch: 24, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6655421257019043
Epoch: 25, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7034738063812256
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1454491
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.103801012039185
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7738609313964844
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9064698219299316
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9539356231689453
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9578835964202881
Epoch: 5, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9125747680664062
Epoch: 6, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.0803160667419434
Epoch: 7, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1326076984405518
Epoch: 8, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0551307201385498
Epoch: 9, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9960408210754395
Epoch: 10, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0542428493499756
Epoch: 11, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.7844274044036865
Epoch: 12, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.217498779296875
Epoch: 13, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0613765716552734
Epoch: 14, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9676520824432373
Epoch: 15, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9163568019866943
Epoch: 16, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.771329402923584
Epoch: 17, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1108882427215576
Epoch: 18, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.857285737991333
Epoch: 19, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8063340187072754
Epoch: 20, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9514706134796143
Epoch: 21, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.581 Vali Acc: 0.333 Test Loss: 1.581 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1436059
model size : 7.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2288978099823
Epoch: 1, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9023730754852295
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8896994590759277
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7995009422302246
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8049163818359375
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9217092990875244
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8519797325134277
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.6948134899139404
Epoch: 8, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.9314796924591064
Epoch: 9, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9046740531921387
Epoch: 10, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.798957347869873
Epoch: 11, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8468670845031738
Epoch: 12, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0558457374572754
Epoch: 13, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8828275203704834
Epoch: 14, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7811167240142822
Epoch: 15, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.016 Vali Acc: 0.333 Test Loss: 1.016 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9370951652526855
Epoch: 16, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7560749053955078
Epoch: 17, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8656513690948486
Epoch: 18, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1409307
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5329344272613525
Epoch: 1, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6406772136688232
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6510870456695557
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6294713020324707
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.979752779006958
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.809077262878418
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7641294002532959
Epoch: 7, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0591340065002441
Epoch: 8, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9619712829589844
Epoch: 9, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8972785472869873
Epoch: 10, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6918094158172607
Epoch: 11, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6901953220367432
Epoch: 12, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.7597548961639404
Epoch: 13, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2754969596862793
Epoch: 14, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9755401611328125
Epoch: 15, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9114964008331299
Epoch: 16, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8500227928161621
Epoch: 17, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0368518829345703
Epoch: 18, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.449 Vali Acc: 0.333 Test Loss: 1.449 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8160514831542969
Epoch: 19, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.421 Vali Acc: 0.333 Test Loss: 1.421 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0100054740905762
Epoch: 20, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3297793865203857
Epoch: 21, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0985920429229736
Epoch: 22, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1382555
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6864168643951416
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.834186315536499
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5951731204986572
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.6591339111328125
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6679284572601318
Epoch: 5, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7565593719482422
Epoch: 6, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.6448996067047119
Epoch: 7, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6534271240234375
Epoch: 8, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7637965679168701
Epoch: 9, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8879227638244629
Epoch: 10, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6131882667541504
Epoch: 11, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 0.7677211761474609
Epoch: 12, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6421763896942139
Epoch: 13, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6013338565826416
Epoch: 14, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6459164619445801
Epoch: 15, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6066381931304932
Epoch: 16, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.018 Vali Acc: 0.267 Test Loss: 1.018 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6814336776733398
Epoch: 17, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.008 Vali Acc: 0.267 Test Loss: 1.008 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8220274448394775
Epoch: 18, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7780842781066895
Epoch: 19, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7128326892852783
Epoch: 20, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8728008270263672
Epoch: 21, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1355803
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.175846576690674
Epoch: 1, Steps: 1 | Train Loss: 1.327 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8561294078826904
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8774878978729248
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
Validation loss decreased (-0.199988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.8295340538024902
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.8950564861297607
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.7268521785736084
Epoch: 6, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8446800708770752
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8231222629547119
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8863174915313721
Epoch: 9, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1295413970947266
Epoch: 10, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8875861167907715
Epoch: 11, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.6601853370666504
Epoch: 12, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8148493766784668
Epoch: 13, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6967501640319824
Epoch: 14, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8436460494995117
Epoch: 15, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8545987606048584
Epoch: 16, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8802986145019531
Epoch: 17, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.7444963455200195
Epoch: 18, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.114 Vali Acc: 0.133 Test Loss: 1.114 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8320126533508301
Epoch: 19, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9326326847076416
Epoch: 20, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0087308883666992
Epoch: 21, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.7770092487335205
Epoch: 22, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9288656711578369
Epoch: 23, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.880742073059082
Epoch: 24, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7927377223968506
Epoch: 25, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6870379447937012
Epoch: 26, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.850139856338501
Epoch: 27, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9376180171966553
Epoch: 28, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.320 Vali Acc: 0.333 Test Loss: 1.320 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9109413623809814
Epoch: 29, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9677739143371582
Epoch: 30, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9001002311706543
Epoch: 31, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 868379
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7336676120758057
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.8810861110687256
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.8372814655303955
Epoch: 3, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8961331844329834
Epoch: 4, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.9410829544067383
Epoch: 5, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7596099376678467
Epoch: 6, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9720079898834229
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7883267402648926
Epoch: 8, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7882130146026611
Epoch: 9, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7977592945098877
Epoch: 10, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.9321291446685791
Epoch: 11, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7951021194458008
Epoch: 12, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7650594711303711
Epoch: 13, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9268736839294434
Epoch: 14, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7574853897094727
Epoch: 15, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0155491828918457
Epoch: 16, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.877730131149292
Epoch: 17, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8069899082183838
Epoch: 18, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9188807010650635
Epoch: 19, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.287 Vali Acc: 0.333 Test Loss: 1.287 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9935717582702637
Epoch: 20, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0017509460449219
Epoch: 21, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9414706230163574
Epoch: 22, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1512978076934814
Epoch: 23, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1139707565307617
Epoch: 24, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4393532276153564
Epoch: 25, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8547172546386719
Epoch: 26, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 855003
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.98591685295105
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7683629989624023
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6188464164733887
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8822052478790283
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6440548896789551
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7477092742919922
Epoch: 6, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.8319990634918213
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7421424388885498
Epoch: 8, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9870445728302002
Epoch: 9, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7406885623931885
Epoch: 10, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7075352668762207
Epoch: 11, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8640954494476318
Epoch: 12, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9247984886169434
Epoch: 13, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.7086737155914307
Epoch: 14, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9541835784912109
Epoch: 15, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7379617691040039
Epoch: 16, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9480330944061279
Epoch: 17, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7158501148223877
Epoch: 18, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0490388870239258
Epoch: 19, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7829921245574951
Epoch: 20, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7579872608184814
Epoch: 21, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9728221893310547
Epoch: 22, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7255420684814453
Epoch: 23, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0146379470825195
Epoch: 24, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8354709148406982
Epoch: 25, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 841627
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6071858406066895
Epoch: 1, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9152543544769287
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9311788082122803
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9283084869384766
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8790454864501953
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.9743196964263916
Epoch: 6, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7340917587280273
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8368358612060547
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.939965009689331
Epoch: 9, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.818781852722168
Epoch: 10, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8282384872436523
Epoch: 11, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.702629566192627
Epoch: 12, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9684619903564453
Epoch: 13, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8026123046875
Epoch: 14, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8498878479003906
Epoch: 15, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0069580078125
Epoch: 16, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.055959939956665
Epoch: 17, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9605104923248291
Epoch: 18, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9485032558441162
Epoch: 19, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 828251
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4121508598327637
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8270382881164551
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9997334480285645
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9302666187286377
Epoch: 4, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9028110504150391
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.0349295139312744
Epoch: 6, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1567018032073975
Epoch: 7, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8915894031524658
Epoch: 8, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9367408752441406
Epoch: 9, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1684327125549316
Epoch: 10, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.1955511569976807
Epoch: 11, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9111847877502441
Epoch: 12, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.983647346496582
Epoch: 13, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9062488079071045
Epoch: 14, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8493146896362305
Epoch: 15, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.131772518157959
Epoch: 16, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3230717182159424
Epoch: 17, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2391443252563477
Epoch: 18, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8275940418243408
Epoch: 19, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0670602321624756
Epoch: 20, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4064068794250488
Epoch: 21, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8340730667114258
Epoch: 22, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.148646354675293
Epoch: 23, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2977588176727295
Epoch: 24, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0513718128204346
Epoch: 25, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 670235
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.146599292755127
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.0317609310150146
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9021944999694824
Epoch: 3, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9786016941070557
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8619482517242432
Epoch: 5, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.9683117866516113
Epoch: 6, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0000944137573242
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0460360050201416
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9252009391784668
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0416507720947266
Epoch: 10, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9861445426940918
Epoch: 11, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9893600940704346
Epoch: 12, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2072663307189941
Epoch: 13, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9081707000732422
Epoch: 14, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.7914226055145264
Epoch: 15, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0783007144927979
Epoch: 16, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8882956504821777
Epoch: 17, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1767630577087402
Epoch: 18, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8451352119445801
Epoch: 19, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1299426555633545
Epoch: 20, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9370896816253662
Epoch: 21, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0657694339752197
Epoch: 22, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.961815595626831
Epoch: 23, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9233603477478027
Epoch: 24, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 656859
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.04880690574646
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.771254301071167
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9471492767333984
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8912851810455322
Epoch: 4, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6680018901824951
Epoch: 5, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8974611759185791
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0004057884216309
Epoch: 7, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0674717426300049
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.8095347881317139
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7741701602935791
Epoch: 10, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0912091732025146
Epoch: 11, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7582497596740723
Epoch: 12, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0172312259674072
Epoch: 13, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.8080627918243408
Epoch: 14, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8807737827301025
Epoch: 15, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8441574573516846
Epoch: 16, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7561244964599609
Epoch: 17, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.086482286453247
Epoch: 18, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7408654689788818
Epoch: 19, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3233318328857422
Epoch: 20, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0709378719329834
Epoch: 21, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1678295135498047
Epoch: 22, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.840120792388916
Epoch: 23, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 643483
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4220547676086426
Epoch: 1, Steps: 1 | Train Loss: 1.391 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.957514762878418
Epoch: 2, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8503434658050537
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9412682056427002
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.833709716796875
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7782742977142334
Epoch: 6, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0208959579467773
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8006699085235596
Epoch: 8, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6940467357635498
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.796544075012207
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6706583499908447
Epoch: 11, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6956014633178711
Epoch: 12, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.051 Vali Acc: 0.200 Test Loss: 1.051 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0405185222625732
Epoch: 13, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0809566974639893
Epoch: 14, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.845999002456665
Epoch: 15, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0594689846038818
Epoch: 16, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9162836074829102
Epoch: 17, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.062 Vali Acc: 0.533 Test Loss: 1.062 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.9183471202850342
Epoch: 18, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.822587251663208
Epoch: 19, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8500485420227051
Epoch: 20, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.982689619064331
Epoch: 21, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7919812202453613
Epoch: 22, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7700212001800537
Epoch: 23, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8149430751800537
Epoch: 24, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7760608196258545
Epoch: 25, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8925065994262695
Epoch: 26, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1686546802520752
Epoch: 27, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 630107
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.780738353729248
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9292886257171631
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.105 Vali Acc: 0.133 Test Loss: 1.105 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6092512607574463
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.7119584083557129
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8886022567749023
Epoch: 5, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.122497797012329
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9326822757720947
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8407566547393799
Epoch: 8, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8188982009887695
Epoch: 9, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2045297622680664
Epoch: 10, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8261227607727051
Epoch: 11, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8118019104003906
Epoch: 12, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.042 Vali Acc: 0.267 Test Loss: 1.042 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8087503910064697
Epoch: 13, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.9108247756958008
Epoch: 14, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8609650135040283
Epoch: 15, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 1.068100929260254
Epoch: 16, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.028 Vali Acc: 0.267 Test Loss: 1.028 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7123396396636963
Epoch: 17, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9300267696380615
Epoch: 18, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0487117767333984
Epoch: 19, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8791015148162842
Epoch: 20, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8082458972930908
Epoch: 21, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.029 Vali Acc: 0.333 Test Loss: 1.029 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7981386184692383
Epoch: 22, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8513193130493164
Epoch: 23, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9801602363586426
Epoch: 24, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0122144222259521
Epoch: 25, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 571163
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7864813804626465
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7770390510559082
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0714778900146484
Epoch: 3, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8447048664093018
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.707230806350708
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.9200806617736816
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5880141258239746
Epoch: 7, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.7235465049743652
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9325594902038574
Epoch: 9, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7787940502166748
Epoch: 10, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9856998920440674
Epoch: 11, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.7832162380218506
Epoch: 12, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.9022877216339111
Epoch: 13, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8733930587768555
Epoch: 14, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7588536739349365
Epoch: 15, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0521984100341797
Epoch: 16, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7498519420623779
Epoch: 17, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7873244285583496
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7838010787963867
Epoch: 19, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9364619255065918
Epoch: 20, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.025 Vali Acc: 0.333 Test Loss: 1.025 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.882474422454834
Epoch: 21, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0117831230163574
Epoch: 22, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 557787
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.284494161605835
Epoch: 1, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2312641143798828
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8129978179931641
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1905908584594727
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9011681079864502
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.038757562637329
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1406042575836182
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7759621143341064
Epoch: 8, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9651477336883545
Epoch: 9, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.9489552974700928
Epoch: 10, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.252894401550293
Epoch: 11, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.8906354904174805
Epoch: 12, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7998068332672119
Epoch: 13, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8707602024078369
Epoch: 14, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 1.0712039470672607
Epoch: 15, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7636713981628418
Epoch: 16, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7347159385681152
Epoch: 17, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1035144329071045
Epoch: 18, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8383009433746338
Epoch: 19, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.9729249477386475
Epoch: 20, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9435434341430664
Epoch: 21, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 22 cost time: 0.6870729923248291
Epoch: 22, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7952792644500732
Epoch: 23, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8408529758453369
Epoch: 24, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9066123962402344
Epoch: 25, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0392677783966064
Epoch: 26, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8404312133789062
Epoch: 27, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9686880111694336
Epoch: 28, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8255932331085205
Epoch: 29, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9956328868865967
Epoch: 30, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7892451286315918
Epoch: 31, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 544411
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.508600950241089
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.1419942378997803
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7720892429351807
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.743704080581665
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.666677713394165
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7803635597229004
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8962879180908203
Epoch: 7, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.722062349319458
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7417829036712646
Epoch: 9, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9863440990447998
Epoch: 10, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8470728397369385
Epoch: 11, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.958322286605835
Epoch: 12, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8353519439697266
Epoch: 13, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 1.039189100265503
Epoch: 14, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8174335956573486
Epoch: 15, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1889240741729736
Epoch: 16, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 1.1473948955535889
Epoch: 17, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9613738059997559
Epoch: 18, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0741939544677734
Epoch: 19, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8406190872192383
Epoch: 20, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 1.0468299388885498
Epoch: 21, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9859435558319092
Epoch: 22, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0135185718536377
Epoch: 23, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8420073986053467
Epoch: 24, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8614823818206787
Epoch: 25, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8699851036071777
Epoch: 26, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9024269580841064
Epoch: 27, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7293829917907715
Epoch: 28, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.343 Vali Acc: 0.333 Test Loss: 1.343 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1482865810394287
Epoch: 29, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7520267963409424
Epoch: 30, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 531035
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6317176818847656
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7689089775085449
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8181829452514648
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6533489227294922
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6717572212219238
Epoch: 5, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7721354961395264
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7291920185089111
Epoch: 7, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.044053554534912
Epoch: 8, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.6293380260467529
Epoch: 9, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6699831485748291
Epoch: 10, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7407035827636719
Epoch: 11, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.054 Vali Acc: 0.267 Test Loss: 1.054 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8280489444732666
Epoch: 12, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6293327808380127
Epoch: 13, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.019 Vali Acc: 0.600 Test Loss: 1.019 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.6880283355712891
Epoch: 14, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7415761947631836
Epoch: 15, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8128046989440918
Epoch: 16, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.951343297958374
Epoch: 17, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8110589981079102
Epoch: 18, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5854167938232422
Epoch: 19, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7763626575469971
Epoch: 20, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9550745487213135
Epoch: 21, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7213249206542969
Epoch: 22, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8543820381164551
Epoch: 23, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 521627
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.98067045211792
Epoch: 1, Steps: 1 | Train Loss: 1.507 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8340399265289307
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8089993000030518
Epoch: 3, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8302974700927734
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0834012031555176
Epoch: 5, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7297251224517822
Epoch: 6, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.982499361038208
Epoch: 7, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5434932708740234
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0799014568328857
Epoch: 9, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7305092811584473
Epoch: 10, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7518115043640137
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8833732604980469
Epoch: 12, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.7064545154571533
Epoch: 13, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9350452423095703
Epoch: 14, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7499148845672607
Epoch: 15, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7005133628845215
Epoch: 16, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.746347188949585
Epoch: 17, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7011799812316895
Epoch: 18, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 19 cost time: 0.7896945476531982
Epoch: 19, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.755946159362793
Epoch: 20, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8804786205291748
Epoch: 21, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.031 Vali Acc: 0.333 Test Loss: 1.031 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.751225471496582
Epoch: 22, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.7982680797576904
Epoch: 23, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8971865177154541
Epoch: 24, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0391850471496582
Epoch: 25, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7376432418823242
Epoch: 26, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7319388389587402
Epoch: 27, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7948634624481201
Epoch: 28, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7689790725708008
Epoch: 29, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8924167156219482
Epoch: 30, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8249557018280029
Epoch: 31, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7023169994354248
Epoch: 32, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 508251
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2791991233825684
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8998403549194336
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.0173327922821045
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 1.0047402381896973
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9146506786346436
Epoch: 5, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1568241119384766
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.208019733428955
Epoch: 7, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3034911155700684
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.2233450412750244
Epoch: 9, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1112291812896729
Epoch: 10, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.489412784576416
Epoch: 11, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3534224033355713
Epoch: 12, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0667972564697266
Epoch: 13, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9744105339050293
Epoch: 14, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.896845817565918
Epoch: 15, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.020247459411621
Epoch: 16, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0041701793670654
Epoch: 17, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.8998432159423828
Epoch: 18, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2424874305725098
Epoch: 19, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1804676055908203
Epoch: 20, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.7012910842895508
Epoch: 21, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.007 Vali Acc: 0.400 Test Loss: 1.007 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.268796682357788
Epoch: 22, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7746663093566895
Epoch: 23, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.256 Vali Acc: 0.400 Test Loss: 1.256 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2048146724700928
Epoch: 24, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0807669162750244
Epoch: 25, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1519770622253418
Epoch: 26, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9478108882904053
Epoch: 27, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8907363414764404
Epoch: 28, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.857677698135376
Epoch: 29, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7830381393432617
Epoch: 30, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.541 Vali Acc: 0.267 Test Loss: 1.541 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 494875
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.763660430908203
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8304250240325928
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8112106323242188
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6408278942108154
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8069407939910889
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8695406913757324
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7053589820861816
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8514206409454346
Epoch: 8, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7165975570678711
Epoch: 9, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9294097423553467
Epoch: 10, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0607826709747314
Epoch: 11, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.8241386413574219
Epoch: 12, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.058192253112793
Epoch: 13, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9023759365081787
Epoch: 14, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7426824569702148
Epoch: 15, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7929396629333496
Epoch: 16, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7801218032836914
Epoch: 17, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.819735050201416
Epoch: 18, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.7963559627532959
Epoch: 19, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9542303085327148
Epoch: 20, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7873868942260742
Epoch: 21, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.046 Vali Acc: 0.267 Test Loss: 1.046 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8497176170349121
Epoch: 22, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.020 Vali Acc: 0.333 Test Loss: 1.020 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8883297443389893
Epoch: 23, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8281185626983643
Epoch: 24, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7291359901428223
Epoch: 25, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8078470230102539
Epoch: 26, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7421307563781738
Epoch: 27, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9101252555847168
Epoch: 28, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 481499
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.865938186645508
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5441310405731201
Epoch: 2, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6602120399475098
Epoch: 3, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6408321857452393
Epoch: 4, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8415484428405762
Epoch: 5, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7500290870666504
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6993436813354492
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8575103282928467
Epoch: 8, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.6604890823364258
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6600656509399414
Epoch: 10, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6542088985443115
Epoch: 11, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6489276885986328
Epoch: 12, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.079 Vali Acc: 0.200 Test Loss: 1.079 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6439385414123535
Epoch: 13, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.725109338760376
Epoch: 14, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.755936861038208
Epoch: 15, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.7811329364776611
Epoch: 16, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.6803045272827148
Epoch: 17, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0487089157104492
Epoch: 18, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8817880153656006
Epoch: 19, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0034544467926025
Epoch: 20, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.7947533130645752
Epoch: 21, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.690415620803833
Epoch: 22, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8052620887756348
Epoch: 23, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6608121395111084
Epoch: 24, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9696862697601318
Epoch: 25, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8504245281219482
Epoch: 26, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6951496601104736
Epoch: 27, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8880844116210938
Epoch: 28, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6722054481506348
Epoch: 29, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6675302982330322
Epoch: 30, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 386587
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.115272283554077
Epoch: 1, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6413066387176514
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0371222496032715
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.734738826751709
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7908110618591309
Epoch: 5, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8983004093170166
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.750159502029419
Epoch: 7, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7295634746551514
Epoch: 8, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6797568798065186
Epoch: 9, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7799243927001953
Epoch: 10, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.925776481628418
Epoch: 11, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 1.0218799114227295
Epoch: 12, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.15079927444458
Epoch: 13, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8365402221679688
Epoch: 14, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.7026705741882324
Epoch: 15, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8358006477355957
Epoch: 16, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9367685317993164
Epoch: 17, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8409991264343262
Epoch: 18, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0934889316558838
Epoch: 19, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.8383276462554932
Epoch: 20, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0256164073944092
Epoch: 21, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.818981409072876
Epoch: 22, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0731189250946045
Epoch: 23, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1963469982147217
Epoch: 24, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0634796619415283
Epoch: 25, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9214446544647217
Epoch: 26, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9620082378387451
Epoch: 27, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9008138179779053
Epoch: 28, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9653728008270264
Epoch: 29, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0842697620391846
Epoch: 30, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.681488037109375
Epoch: 31, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 379899
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.025461435317993
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6357991695404053
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6201636791229248
Epoch: 3, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5404438972473145
Epoch: 4, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.027198076248169
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.744225025177002
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9095385074615479
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7469360828399658
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9146733283996582
Epoch: 9, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6754460334777832
Epoch: 10, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9500799179077148
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.758652925491333
Epoch: 12, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.772456169128418
Epoch: 13, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8546674251556396
Epoch: 14, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7771697044372559
Epoch: 15, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9072716236114502
Epoch: 16, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 17 cost time: 0.6695780754089355
Epoch: 17, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.8138182163238525
Epoch: 18, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9178099632263184
Epoch: 19, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.041 Vali Acc: 0.333 Test Loss: 1.041 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1670403480529785
Epoch: 20, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.7284231185913086
Epoch: 21, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9483559131622314
Epoch: 22, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.8342137336730957
Epoch: 23, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8962936401367188
Epoch: 24, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7547008991241455
Epoch: 25, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7453248500823975
Epoch: 26, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7264928817749023
Epoch: 27, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7087552547454834
Epoch: 28, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 1.0892996788024902
Epoch: 29, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.737109899520874
Epoch: 30, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7725846767425537
Epoch: 31, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7163205146789551
Epoch: 32, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9111349582672119
Epoch: 33, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8781478404998779
Epoch: 34, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8649561405181885
Epoch: 35, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1667306423187256
Epoch: 36, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6323120594024658
Epoch: 37, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8998899459838867
Epoch: 38, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 373211
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3007571697235107
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8035218715667725
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.6006498336791992
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.5971643924713135
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7248551845550537
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8933160305023193
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8629415035247803
Epoch: 7, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.1017463207244873
Epoch: 8, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9024035930633545
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.056257724761963
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8573727607727051
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0410792827606201
Epoch: 12, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.019998550415039
Epoch: 13, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8714206218719482
Epoch: 14, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7095904350280762
Epoch: 15, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7994754314422607
Epoch: 16, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0831587314605713
Epoch: 17, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 366523
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.333625555038452
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.776491641998291
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8099055290222168
Epoch: 3, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8463904857635498
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.122673511505127
Epoch: 5, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.034111499786377
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.015868902206421
Epoch: 7, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.3267779350280762
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8482019901275635
Epoch: 9, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8039407730102539
Epoch: 10, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.7553977966308594
Epoch: 11, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0274105072021484
Epoch: 12, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.897322416305542
Epoch: 13, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8656594753265381
Epoch: 14, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2479772567749023
Epoch: 15, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8416776657104492
Epoch: 16, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.7847638130187988
Epoch: 17, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.6821808815002441
Epoch: 18, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.763559103012085
Epoch: 19, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8669579029083252
Epoch: 20, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.724797248840332
Epoch: 21, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6984906196594238
Epoch: 22, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.8124508857727051
Epoch: 23, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.884432315826416
Epoch: 24, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8173184394836426
Epoch: 25, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7160134315490723
Epoch: 26, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7998120784759521
Epoch: 27, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8443856239318848
Epoch: 28, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8520529270172119
Epoch: 29, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7197213172912598
Epoch: 30, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9483327865600586
Epoch: 31, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8269851207733154
Epoch: 32, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 286747
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2522387504577637
Epoch: 1, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.8526327610015869
Epoch: 2, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.133322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8169846534729004
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7042887210845947
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8322434425354004
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.724879264831543
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7675416469573975
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7533218860626221
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9973556995391846
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0770795345306396
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7706789970397949
Epoch: 11, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.980663537979126
Epoch: 12, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8610682487487793
Epoch: 13, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 0.7686457633972168
Epoch: 14, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.7669732570648193
Epoch: 15, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7667624950408936
Epoch: 16, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7481439113616943
Epoch: 17, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.6788108348846436
Epoch: 18, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.6196835041046143
Epoch: 19, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7843611240386963
Epoch: 20, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0643160343170166
Epoch: 21, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9097890853881836
Epoch: 22, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8072805404663086
Epoch: 23, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.026824712753296
Epoch: 24, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1610631942749023
Epoch: 25, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9557559490203857
Epoch: 26, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8101186752319336
Epoch: 27, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.739304780960083
Epoch: 28, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 280059
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.750290870666504
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.043 Vali Acc: 0.667 Test Loss: 1.043 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.8127946853637695
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1448407173156738
Epoch: 3, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7951130867004395
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0964019298553467
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8705925941467285
Epoch: 6, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0080575942993164
Epoch: 7, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8920247554779053
Epoch: 8, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8842239379882812
Epoch: 9, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9433321952819824
Epoch: 10, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9698808193206787
Epoch: 11, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 273371
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.941236972808838
Epoch: 1, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8106613159179688
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8212385177612305
Epoch: 3, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8856949806213379
Epoch: 4, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8907411098480225
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8570256233215332
Epoch: 6, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5966241359710693
Epoch: 7, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8006570339202881
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0386979579925537
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7537140846252441
Epoch: 10, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6139333248138428
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.7111568450927734
Epoch: 12, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7899777889251709
Epoch: 13, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6528470516204834
Epoch: 14, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.655536413192749
Epoch: 15, Steps: 1 | Train Loss: 0.559 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.664747953414917
Epoch: 16, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.7485692501068115
Epoch: 17, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7210438251495361
Epoch: 18, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6980960369110107
Epoch: 19, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.8762948513031006
Epoch: 20, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1623706817626953
Epoch: 21, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.344834566116333
Epoch: 22, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.261826992034912
Epoch: 23, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.196387767791748
Epoch: 24, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 25 cost time: 0.8271889686584473
Epoch: 25, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0794932842254639
Epoch: 26, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.059 Vali Acc: 0.267 Test Loss: 1.059 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.138106107711792
Epoch: 27, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1532351970672607
Epoch: 28, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3066327571868896
Epoch: 29, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4325242042541504
Epoch: 30, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4420380592346191
Epoch: 31, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2415413856506348
Epoch: 32, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2440822124481201
Epoch: 33, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2141389846801758
Epoch: 34, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 266683
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8184642791748047
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.151 Vali Acc: 0.067 Test Loss: 1.151 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.9777071475982666
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.066655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8168113231658936
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.798513650894165
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0941920280456543
Epoch: 5, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7991218566894531
Epoch: 6, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9729123115539551
Epoch: 7, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.0835299491882324
Epoch: 8, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8095626831054688
Epoch: 9, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.2995109558105469
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 1.0922818183898926
Epoch: 11, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9320018291473389
Epoch: 12, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1318297386169434
Epoch: 13, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.104743480682373
Epoch: 14, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 0.9035418033599854
Epoch: 15, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 1.0900263786315918
Epoch: 16, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.9962589740753174
Epoch: 17, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.116497278213501
Epoch: 18, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.080 Vali Acc: 0.267 Test Loss: 1.080 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8337457180023193
Epoch: 19, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.7847750186920166
Epoch: 20, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.8645930290222168
Epoch: 21, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 22 cost time: 0.8727819919586182
Epoch: 22, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3200483322143555
Epoch: 23, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.133901834487915
Epoch: 24, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.079 Vali Acc: 0.267 Test Loss: 1.079 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9784338474273682
Epoch: 25, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9047150611877441
Epoch: 26, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1931188106536865
Epoch: 27, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1169612407684326
Epoch: 28, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4057466983795166
Epoch: 29, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9722990989685059
Epoch: 30, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9600205421447754
Epoch: 31, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 236827
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6875693798065186
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.091 Vali Acc: 0.200 Test Loss: 1.091 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6883671283721924
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7749195098876953
Epoch: 3, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6727719306945801
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8058803081512451
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.6571784019470215
Epoch: 6, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7805945873260498
Epoch: 7, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7732672691345215
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7629592418670654
Epoch: 9, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8971738815307617
Epoch: 10, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7364647388458252
Epoch: 11, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7331619262695312
Epoch: 12, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7429685592651367
Epoch: 13, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.8091330528259277
Epoch: 14, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7376675605773926
Epoch: 15, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7713141441345215
Epoch: 16, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8989181518554688
Epoch: 17, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.9537913799285889
Epoch: 18, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7789115905761719
Epoch: 19, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.037 Vali Acc: 0.333 Test Loss: 1.037 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.160651683807373
Epoch: 20, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6475281715393066
Epoch: 21, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8922059535980225
Epoch: 22, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.030 Vali Acc: 0.333 Test Loss: 1.030 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7478141784667969
Epoch: 23, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.6628859043121338
Epoch: 24, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.8463594913482666
Epoch: 25, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.034156084060669
Epoch: 26, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6355428695678711
Epoch: 27, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.116260290145874
Epoch: 28, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9354915618896484
Epoch: 29, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7911202907562256
Epoch: 30, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9410402774810791
Epoch: 31, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8785369396209717
Epoch: 32, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8153135776519775
Epoch: 33, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7854843139648438
Epoch: 34, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 230139
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.278488874435425
Epoch: 1, Steps: 1 | Train Loss: 1.387 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.3064048290252686
Epoch: 2, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7703053951263428
Epoch: 3, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7795054912567139
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.8270716667175293
Epoch: 5, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.7499611377716064
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9065380096435547
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.0932257175445557
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.8259720802307129
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7754204273223877
Epoch: 10, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8465168476104736
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9104971885681152
Epoch: 12, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7756352424621582
Epoch: 13, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8289744853973389
Epoch: 14, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9793612957000732
Epoch: 15, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 16 cost time: 0.8460383415222168
Epoch: 16, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9009029865264893
Epoch: 17, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9442026615142822
Epoch: 18, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8776957988739014
Epoch: 19, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3236443996429443
Epoch: 20, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.8662502765655518
Epoch: 21, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1636250019073486
Epoch: 22, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1556117534637451
Epoch: 23, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3883066177368164
Epoch: 24, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2308149337768555
Epoch: 25, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2364282608032227
Epoch: 26, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0611281394958496
Epoch: 27, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 28 cost time: 1.1586859226226807
Epoch: 28, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1808340549468994
Epoch: 29, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0415918827056885
Epoch: 30, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.963364839553833
Epoch: 31, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8745911121368408
Epoch: 32, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6905922889709473
Epoch: 33, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 34 cost time: 0.880375862121582
Epoch: 34, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9204611778259277
Epoch: 35, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7393381595611572
Epoch: 36, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3534905910491943
Epoch: 37, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.436 Vali Acc: 0.333 Test Loss: 1.436 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7234272956848145
Epoch: 38, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.404 Vali Acc: 0.333 Test Loss: 1.404 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0475971698760986
Epoch: 39, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.766390323638916
Epoch: 40, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0029332637786865
Epoch: 41, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9151773452758789
Epoch: 42, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9324469566345215
Epoch: 43, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 223451
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2634215354919434
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9750368595123291
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.1185128688812256
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9550175666809082
Epoch: 4, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.651315450668335
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.054908275604248
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 1.1130211353302002
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8675036430358887
Epoch: 8, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 1.143378734588623
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.002082109451294
Epoch: 10, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9325284957885742
Epoch: 11, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9869778156280518
Epoch: 12, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8915669918060303
Epoch: 13, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0187535285949707
Epoch: 14, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.283299446105957
Epoch: 15, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8749904632568359
Epoch: 16, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0205268859863281
Epoch: 17, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7553393840789795
Epoch: 18, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 216763
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.626168966293335
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8812763690948486
Epoch: 2, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.199989 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.8266315460205078
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9599165916442871
Epoch: 4, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8926467895507812
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1886985301971436
Epoch: 6, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9189424514770508
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0730259418487549
Epoch: 8, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2373969554901123
Epoch: 9, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9299280643463135
Epoch: 10, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.9210109710693359
Epoch: 11, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9875767230987549
Epoch: 12, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8843250274658203
Epoch: 13, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0899629592895508
Epoch: 14, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.075321912765503
Epoch: 15, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.103 Vali Acc: 0.133 Test Loss: 1.103 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6809792518615723
Epoch: 16, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9053418636322021
Epoch: 17, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.466655 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 0.9310894012451172
Epoch: 18, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8309597969055176
Epoch: 19, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1155636310577393
Epoch: 20, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9596610069274902
Epoch: 21, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.278672695159912
Epoch: 22, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2369258403778076
Epoch: 23, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 1.0254838466644287
Epoch: 24, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.965822696685791
Epoch: 25, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1521878242492676
Epoch: 26, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8803517818450928
Epoch: 27, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9455540180206299
Epoch: 28, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9971866607666016
Epoch: 29, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2004797458648682
Epoch: 30, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9321343898773193
Epoch: 31, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0844035148620605
Epoch: 32, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.321845531463623
Epoch: 33, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 211867
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1409075260162354
Epoch: 1, Steps: 1 | Train Loss: 1.336 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8275156021118164
Epoch: 2, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7790298461914062
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9552838802337646
Epoch: 4, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9799027442932129
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.917813777923584
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9630208015441895
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9829981327056885
Epoch: 8, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1401970386505127
Epoch: 9, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0052428245544434
Epoch: 10, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9342772960662842
Epoch: 11, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2168736457824707
Epoch: 12, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.8750529289245605
Epoch: 13, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7427041530609131
Epoch: 14, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9601061344146729
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2284846305847168
Epoch: 16, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9583289623260498
Epoch: 17, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.415334939956665
Epoch: 18, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1175384521484375
Epoch: 19, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0292413234710693
Epoch: 20, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 1.266181230545044
Epoch: 21, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 0.6550328731536865
Epoch: 22, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.032 Vali Acc: 0.333 Test Loss: 1.032 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8945083618164062
Epoch: 23, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0651884078979492
Epoch: 24, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7498908042907715
Epoch: 25, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9595081806182861
Epoch: 26, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.016 Vali Acc: 0.533 Test Loss: 1.016 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8714103698730469
Epoch: 27, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8537783622741699
Epoch: 28, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9663436412811279
Epoch: 29, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8956685066223145
Epoch: 30, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8743612766265869
Epoch: 31, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 205179
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9892477989196777
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9014036655426025
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9237408638000488
Epoch: 3, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.776421308517456
Epoch: 4, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3192150592803955
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9394357204437256
Epoch: 6, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7186920642852783
Epoch: 7, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.8012642860412598
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.8163292407989502
Epoch: 9, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.9207606315612793
Epoch: 10, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9868452548980713
Epoch: 11, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.024437665939331
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.1298389434814453
Epoch: 13, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.9407134056091309
Epoch: 14, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5467197895050049
Epoch: 15, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3344175815582275
Epoch: 16, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2746918201446533
Epoch: 17, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.733412504196167
Epoch: 18, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.7866215705871582
Epoch: 19, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.077470064163208
Epoch: 20, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3410227298736572
Epoch: 21, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1955530643463135
Epoch: 22, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8482396602630615
Epoch: 23, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9008336067199707
Epoch: 24, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.7466411590576172
Epoch: 25, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0441820621490479
Epoch: 26, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4352283477783203
Epoch: 27, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1317112445831299
Epoch: 28, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0531525611877441
Epoch: 29, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1481614112854004
Epoch: 30, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9866008758544922
Epoch: 31, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0147426128387451
Epoch: 32, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8688113689422607
Epoch: 33, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8821055889129639
Epoch: 34, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 198491
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9869699478149414
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.147 Vali Acc: 0.133 Test Loss: 1.147 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 1.3819680213928223
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9977006912231445
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.267545461654663
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0782139301300049
Epoch: 5, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2525806427001953
Epoch: 6, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 1.02189302444458
Epoch: 7, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0657837390899658
Epoch: 8, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9975154399871826
Epoch: 9, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0244503021240234
Epoch: 10, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.1684324741363525
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3043599128723145
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1186177730560303
Epoch: 13, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0916533470153809
Epoch: 14, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0258879661560059
Epoch: 15, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9822483062744141
Epoch: 16, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9242253303527832
Epoch: 17, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 1.0740551948547363
Epoch: 18, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2516179084777832
Epoch: 19, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3154747486114502
Epoch: 20, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2137207984924316
Epoch: 21, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1026268005371094
Epoch: 22, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0874395370483398
Epoch: 23, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1302473545074463
Epoch: 24, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.273958683013916
Epoch: 25, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.206305980682373
Epoch: 26, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4213016033172607
Epoch: 27, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_Crossformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 191803
model size : 1.41MB
