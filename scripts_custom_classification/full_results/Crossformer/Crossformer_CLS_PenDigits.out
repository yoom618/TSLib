Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5007082
	speed: 0.1128s/iter; left time: 5279.7640s
	iters: 200, epoch: 1 | loss: 0.2322350
	speed: 0.0872s/iter; left time: 4072.6804s
	iters: 300, epoch: 1 | loss: 0.3172089
	speed: 0.0913s/iter; left time: 4254.1555s
	iters: 400, epoch: 1 | loss: 0.2128802
	speed: 0.0992s/iter; left time: 4613.1229s
Epoch: 1 cost time: 45.763320207595825
Epoch: 1, Steps: 469 | Train Loss: 0.481 Vali Loss: 0.632 Vali Acc: 0.824 Test Loss: 0.632 Test Acc: 0.824
Validation loss decreased (inf --> -0.824465).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3648989
	speed: 0.4748s/iter; left time: 21998.4111s
	iters: 200, epoch: 2 | loss: 0.1751276
	speed: 0.1069s/iter; left time: 4944.1091s
	iters: 300, epoch: 2 | loss: 0.4067082
	speed: 0.1064s/iter; left time: 4908.9208s
	iters: 400, epoch: 2 | loss: 0.2235468
	speed: 0.1077s/iter; left time: 4956.0985s
Epoch: 2 cost time: 51.732807874679565
Epoch: 2, Steps: 469 | Train Loss: 0.361 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
Validation loss decreased (-0.824465 --> -0.883644).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0553716
	speed: 0.4382s/iter; left time: 20098.1991s
	iters: 200, epoch: 3 | loss: 0.3555308
	speed: 0.1055s/iter; left time: 4828.3622s
	iters: 300, epoch: 3 | loss: 0.2940670
	speed: 0.1034s/iter; left time: 4721.8394s
	iters: 400, epoch: 3 | loss: 0.1599123
	speed: 0.1047s/iter; left time: 4768.8419s
Epoch: 3 cost time: 49.324519634246826
Epoch: 3, Steps: 469 | Train Loss: 0.390 Vali Loss: 1.203 Vali Acc: 0.625 Test Loss: 1.203 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6240361
	speed: 0.4353s/iter; left time: 19761.8800s
	iters: 200, epoch: 4 | loss: 1.6529452
	speed: 0.1160s/iter; left time: 5254.4665s
	iters: 300, epoch: 4 | loss: 2.3216789
	speed: 0.1096s/iter; left time: 4953.4637s
	iters: 400, epoch: 4 | loss: 2.2433755
	speed: 0.1303s/iter; left time: 5876.8387s
Epoch: 4 cost time: 54.52285385131836
Epoch: 4, Steps: 469 | Train Loss: 1.338 Vali Loss: 2.434 Vali Acc: 0.192 Test Loss: 2.434 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.5773931
	speed: 0.5560s/iter; left time: 24979.8416s
	iters: 200, epoch: 5 | loss: 2.3616540
	speed: 0.1217s/iter; left time: 5453.0963s
	iters: 300, epoch: 5 | loss: 2.2507291
	speed: 0.1232s/iter; left time: 5511.2674s
	iters: 400, epoch: 5 | loss: 2.3570135
	speed: 0.1241s/iter; left time: 5537.3444s
Epoch: 5 cost time: 58.14858031272888
Epoch: 5, Steps: 469 | Train Loss: 2.118 Vali Loss: 2.091 Vali Acc: 0.204 Test Loss: 2.091 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.1758235
	speed: 0.6370s/iter; left time: 28319.0916s
	iters: 200, epoch: 6 | loss: 1.7343434
	speed: 0.1368s/iter; left time: 6070.0135s
	iters: 300, epoch: 6 | loss: 1.8756378
	speed: 0.1375s/iter; left time: 6083.7618s
	iters: 400, epoch: 6 | loss: 1.7372267
	speed: 0.1562s/iter; left time: 6898.3773s
Epoch: 6 cost time: 68.66232705116272
Epoch: 6, Steps: 469 | Train Loss: 1.986 Vali Loss: 2.092 Vali Acc: 0.178 Test Loss: 2.092 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.9856719
	speed: 0.6001s/iter; left time: 26398.4582s
	iters: 200, epoch: 7 | loss: 1.9671494
	speed: 0.1278s/iter; left time: 5610.8993s
	iters: 300, epoch: 7 | loss: 2.0837319
	speed: 0.1238s/iter; left time: 5422.9370s
	iters: 400, epoch: 7 | loss: 2.2367427
	speed: 0.1264s/iter; left time: 5522.5849s
Epoch: 7 cost time: 60.83204126358032
Epoch: 7, Steps: 469 | Train Loss: 2.094 Vali Loss: 2.265 Vali Acc: 0.128 Test Loss: 2.265 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3058269
	speed: 0.5762s/iter; left time: 25076.3879s
	iters: 200, epoch: 8 | loss: 2.3729303
	speed: 0.1193s/iter; left time: 5180.9356s
	iters: 300, epoch: 8 | loss: 2.2750673
	speed: 0.1157s/iter; left time: 5011.6414s
	iters: 400, epoch: 8 | loss: 2.3139968
	speed: 0.1225s/iter; left time: 5295.1641s
Epoch: 8 cost time: 59.288246631622314
Epoch: 8, Steps: 469 | Train Loss: 2.315 Vali Loss: 2.307 Vali Acc: 0.104 Test Loss: 2.307 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3306658
	speed: 0.5742s/iter; left time: 24719.2154s
	iters: 200, epoch: 9 | loss: 2.2827618
	speed: 0.1330s/iter; left time: 5713.5322s
	iters: 300, epoch: 9 | loss: 2.2962267
	speed: 0.1215s/iter; left time: 5207.6826s
	iters: 400, epoch: 9 | loss: 2.2853506
	speed: 0.1148s/iter; left time: 4906.5983s
Epoch: 9 cost time: 59.238322734832764
Epoch: 9, Steps: 469 | Train Loss: 2.313 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2402251
	speed: 0.5845s/iter; left time: 24886.2471s
	iters: 200, epoch: 10 | loss: 2.3120565
	speed: 0.1252s/iter; left time: 5317.5890s
	iters: 300, epoch: 10 | loss: 2.3329029
	speed: 0.1258s/iter; left time: 5332.8815s
	iters: 400, epoch: 10 | loss: 2.2725585
	speed: 0.1431s/iter; left time: 6050.4771s
Epoch: 10 cost time: 63.153297901153564
Epoch: 10, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.309 Vali Acc: 0.104 Test Loss: 2.309 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3001873
	speed: 0.5970s/iter; left time: 25140.0164s
	iters: 200, epoch: 11 | loss: 2.3037665
	speed: 0.1136s/iter; left time: 4773.0542s
	iters: 300, epoch: 11 | loss: 2.2783794
	speed: 0.1322s/iter; left time: 5538.6614s
	iters: 400, epoch: 11 | loss: 2.2736058
	speed: 0.1207s/iter; left time: 5047.3192s
Epoch: 11 cost time: 59.85859298706055
Epoch: 11, Steps: 469 | Train Loss: 2.311 Vali Loss: 2.307 Vali Acc: 0.104 Test Loss: 2.307 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3126745
	speed: 0.5441s/iter; left time: 22656.0736s
	iters: 200, epoch: 12 | loss: 2.3607285
	speed: 0.1339s/iter; left time: 5560.6341s
	iters: 300, epoch: 12 | loss: 2.3142912
	speed: 0.1304s/iter; left time: 5404.4011s
	iters: 400, epoch: 12 | loss: 2.2999995
	speed: 0.1233s/iter; left time: 5096.3665s
Epoch: 12 cost time: 61.264917612075806
Epoch: 12, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.317 Vali Acc: 0.104 Test Loss: 2.317 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8836477987421384
model parameter : 14261062
model size : 59.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2455150
	speed: 0.1499s/iter; left time: 7016.8426s
	iters: 200, epoch: 1 | loss: 0.3602907
	speed: 0.1132s/iter; left time: 5285.4771s
	iters: 300, epoch: 1 | loss: 0.3605668
	speed: 0.1094s/iter; left time: 5098.0231s
	iters: 400, epoch: 1 | loss: 0.2522197
	speed: 0.1213s/iter; left time: 5641.4485s
Epoch: 1 cost time: 58.14577627182007
Epoch: 1, Steps: 469 | Train Loss: 0.495 Vali Loss: 0.367 Vali Acc: 0.885 Test Loss: 0.367 Test Acc: 0.885
Validation loss decreased (inf --> -0.884502).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2317238
	speed: 0.5774s/iter; left time: 26750.1066s
	iters: 200, epoch: 2 | loss: 0.4302098
	speed: 0.1217s/iter; left time: 5626.5699s
	iters: 300, epoch: 2 | loss: 0.1656209
	speed: 0.1271s/iter; left time: 5862.7773s
	iters: 400, epoch: 2 | loss: 0.4147094
	speed: 0.1207s/iter; left time: 5556.2207s
Epoch: 2 cost time: 59.62014627456665
Epoch: 2, Steps: 469 | Train Loss: 0.354 Vali Loss: 0.363 Vali Acc: 0.885 Test Loss: 0.363 Test Acc: 0.885
Validation loss decreased (-0.884502 --> -0.885359).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3195962
	speed: 0.5628s/iter; left time: 25810.7238s
	iters: 200, epoch: 3 | loss: 0.4271470
	speed: 0.1087s/iter; left time: 4975.2412s
	iters: 300, epoch: 3 | loss: 0.3802435
	speed: 0.1217s/iter; left time: 5555.1961s
	iters: 400, epoch: 3 | loss: 0.0871865
	speed: 0.1348s/iter; left time: 6140.4634s
Epoch: 3 cost time: 58.54848790168762
Epoch: 3, Steps: 469 | Train Loss: 0.320 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5008543
	speed: 0.5373s/iter; left time: 24391.3153s
	iters: 200, epoch: 4 | loss: 0.8633863
	speed: 0.1161s/iter; left time: 5260.4536s
	iters: 300, epoch: 4 | loss: 1.1436462
	speed: 0.1195s/iter; left time: 5401.1496s
	iters: 400, epoch: 4 | loss: 0.2741110
	speed: 0.1180s/iter; left time: 5321.0993s
Epoch: 4 cost time: 55.43730306625366
Epoch: 4, Steps: 469 | Train Loss: 0.651 Vali Loss: 0.459 Vali Acc: 0.865 Test Loss: 0.459 Test Acc: 0.865
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4760556
	speed: 0.5374s/iter; left time: 24141.6175s
	iters: 200, epoch: 5 | loss: 0.6901855
	speed: 0.1284s/iter; left time: 5754.2393s
	iters: 300, epoch: 5 | loss: 0.7732341
	speed: 0.1134s/iter; left time: 5072.7427s
	iters: 400, epoch: 5 | loss: 1.1432507
	speed: 0.1125s/iter; left time: 5018.2961s
Epoch: 5 cost time: 56.6887845993042
Epoch: 5, Steps: 469 | Train Loss: 0.610 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5627767
	speed: 0.5471s/iter; left time: 24323.0414s
	iters: 200, epoch: 6 | loss: 0.5230479
	speed: 0.1186s/iter; left time: 5260.7103s
	iters: 300, epoch: 6 | loss: 0.6515519
	speed: 0.1199s/iter; left time: 5306.9461s
	iters: 400, epoch: 6 | loss: 0.9775888
	speed: 0.1316s/iter; left time: 5811.6798s
Epoch: 6 cost time: 60.086885929107666
Epoch: 6, Steps: 469 | Train Loss: 0.746 Vali Loss: 1.154 Vali Acc: 0.592 Test Loss: 1.154 Test Acc: 0.592
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.2118621
	speed: 0.5850s/iter; left time: 25733.7202s
	iters: 200, epoch: 7 | loss: 0.8900633
	speed: 0.1224s/iter; left time: 5371.2023s
	iters: 300, epoch: 7 | loss: 0.4664963
	speed: 0.1290s/iter; left time: 5646.4851s
	iters: 400, epoch: 7 | loss: 0.4322104
	speed: 0.1207s/iter; left time: 5274.6921s
Epoch: 7 cost time: 58.94333338737488
Epoch: 7, Steps: 469 | Train Loss: 0.749 Vali Loss: 0.659 Vali Acc: 0.804 Test Loss: 0.659 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1825649
	speed: 0.5426s/iter; left time: 23613.8086s
	iters: 200, epoch: 8 | loss: 0.3858243
	speed: 0.1336s/iter; left time: 5798.6433s
	iters: 300, epoch: 8 | loss: 0.3757170
	speed: 0.1229s/iter; left time: 5323.2540s
	iters: 400, epoch: 8 | loss: 0.7126824
	speed: 0.1129s/iter; left time: 4879.8023s
Epoch: 8 cost time: 58.58856153488159
Epoch: 8, Steps: 469 | Train Loss: 0.590 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6122197
	speed: 0.5958s/iter; left time: 25649.1211s
	iters: 200, epoch: 9 | loss: 0.1375732
	speed: 0.1431s/iter; left time: 6143.9390s
	iters: 300, epoch: 9 | loss: 0.4533568
	speed: 0.1205s/iter; left time: 5163.1270s
	iters: 400, epoch: 9 | loss: 1.1367120
	speed: 0.1302s/iter; left time: 5567.5984s
Epoch: 9 cost time: 62.380661964416504
Epoch: 9, Steps: 469 | Train Loss: 0.528 Vali Loss: 0.984 Vali Acc: 0.714 Test Loss: 0.984 Test Acc: 0.714
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7161782
	speed: 0.5337s/iter; left time: 22725.7533s
	iters: 200, epoch: 10 | loss: 0.1974762
	speed: 0.1163s/iter; left time: 4941.4907s
	iters: 300, epoch: 10 | loss: 0.4979997
	speed: 0.1144s/iter; left time: 4846.7671s
	iters: 400, epoch: 10 | loss: 0.3214881
	speed: 0.1306s/iter; left time: 5520.4061s
Epoch: 10 cost time: 56.73576593399048
Epoch: 10, Steps: 469 | Train Loss: 0.517 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2990086
	speed: 0.5598s/iter; left time: 23574.2312s
	iters: 200, epoch: 11 | loss: 0.5660627
	speed: 0.1200s/iter; left time: 5040.1256s
	iters: 300, epoch: 11 | loss: 1.0460763
	speed: 0.1249s/iter; left time: 5234.6486s
	iters: 400, epoch: 11 | loss: 0.3543833
	speed: 0.1210s/iter; left time: 5057.9203s
Epoch: 11 cost time: 60.280455589294434
Epoch: 11, Steps: 469 | Train Loss: 0.523 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.9362551
	speed: 0.5418s/iter; left time: 22563.5025s
	iters: 200, epoch: 12 | loss: 2.9867618
	speed: 0.1185s/iter; left time: 4923.2628s
	iters: 300, epoch: 12 | loss: 0.2597843
	speed: 0.1350s/iter; left time: 5595.6742s
	iters: 400, epoch: 12 | loss: 0.5816779
	speed: 0.1196s/iter; left time: 4944.6925s
Epoch: 12 cost time: 58.061949729919434
Epoch: 12, Steps: 469 | Train Loss: 0.783 Vali Loss: 0.654 Vali Acc: 0.785 Test Loss: 0.654 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8853630646083476
model parameter : 14260038
model size : 59.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2574300
	speed: 0.1457s/iter; left time: 6818.9454s
	iters: 200, epoch: 1 | loss: 0.5727326
	speed: 0.1088s/iter; left time: 5080.8887s
	iters: 300, epoch: 1 | loss: 0.1755093
	speed: 0.1158s/iter; left time: 5395.0225s
	iters: 400, epoch: 1 | loss: 0.6021456
	speed: 0.1190s/iter; left time: 5534.9754s
Epoch: 1 cost time: 56.91669774055481
Epoch: 1, Steps: 469 | Train Loss: 0.493 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
Validation loss decreased (inf --> -0.866777).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4002331
	speed: 0.5198s/iter; left time: 24085.6630s
	iters: 200, epoch: 2 | loss: 0.1605060
	speed: 0.1103s/iter; left time: 5099.6755s
	iters: 300, epoch: 2 | loss: 0.2339781
	speed: 0.1255s/iter; left time: 5787.3652s
	iters: 400, epoch: 2 | loss: 0.1492892
	speed: 0.1168s/iter; left time: 5377.0624s
Epoch: 2 cost time: 54.719228982925415
Epoch: 2, Steps: 469 | Train Loss: 0.330 Vali Loss: 0.324 Vali Acc: 0.898 Test Loss: 0.324 Test Acc: 0.898
Validation loss decreased (-0.866777 --> -0.897938).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0649963
	speed: 0.5406s/iter; left time: 24791.2475s
	iters: 200, epoch: 3 | loss: 0.0860886
	speed: 0.1218s/iter; left time: 5574.7796s
	iters: 300, epoch: 3 | loss: 0.2312994
	speed: 0.1088s/iter; left time: 4967.1374s
	iters: 400, epoch: 3 | loss: 0.2861508
	speed: 0.1173s/iter; left time: 5343.0637s
Epoch: 3 cost time: 55.735061168670654
Epoch: 3, Steps: 469 | Train Loss: 0.346 Vali Loss: 0.450 Vali Acc: 0.860 Test Loss: 0.450 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0460972
	speed: 0.5286s/iter; left time: 23994.4116s
	iters: 200, epoch: 4 | loss: 0.7225220
	speed: 0.1082s/iter; left time: 4898.6502s
	iters: 300, epoch: 4 | loss: 0.0521626
	speed: 0.1115s/iter; left time: 5039.6604s
	iters: 400, epoch: 4 | loss: 0.0924921
	speed: 0.1093s/iter; left time: 4928.4319s
Epoch: 4 cost time: 53.089438915252686
Epoch: 4, Steps: 469 | Train Loss: 0.382 Vali Loss: 0.952 Vali Acc: 0.729 Test Loss: 0.952 Test Acc: 0.729
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5846027
	speed: 0.5129s/iter; left time: 23043.4734s
	iters: 200, epoch: 5 | loss: 0.0549646
	speed: 0.1118s/iter; left time: 5013.6316s
	iters: 300, epoch: 5 | loss: 3.3678577
	speed: 0.1112s/iter; left time: 4972.0182s
	iters: 400, epoch: 5 | loss: 2.2576642
	speed: 0.1224s/iter; left time: 5463.0114s
Epoch: 5 cost time: 54.276771783828735
Epoch: 5, Steps: 469 | Train Loss: 1.218 Vali Loss: 2.154 Vali Acc: 0.149 Test Loss: 2.154 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.5709269
	speed: 0.4710s/iter; left time: 20939.0000s
	iters: 200, epoch: 6 | loss: 2.5741265
	speed: 0.1067s/iter; left time: 4733.6178s
	iters: 300, epoch: 6 | loss: 2.3699293
	speed: 0.1020s/iter; left time: 4515.5740s
	iters: 400, epoch: 6 | loss: 2.3422556
	speed: 0.1184s/iter; left time: 5230.2444s
Epoch: 6 cost time: 51.43680548667908
Epoch: 6, Steps: 469 | Train Loss: 2.372 Vali Loss: 2.360 Vali Acc: 0.104 Test Loss: 2.360 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.4050996
	speed: 0.4673s/iter; left time: 20555.9349s
	iters: 200, epoch: 7 | loss: 2.3737445
	speed: 0.1162s/iter; left time: 5100.6731s
	iters: 300, epoch: 7 | loss: 2.3676028
	speed: 0.1090s/iter; left time: 4774.9312s
	iters: 400, epoch: 7 | loss: 2.2865131
	speed: 0.1041s/iter; left time: 4548.5671s
Epoch: 7 cost time: 51.39201378822327
Epoch: 7, Steps: 469 | Train Loss: 2.352 Vali Loss: 2.305 Vali Acc: 0.104 Test Loss: 2.305 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3357658
	speed: 0.4895s/iter; left time: 21300.0600s
	iters: 200, epoch: 8 | loss: 2.2705700
	speed: 0.1144s/iter; left time: 4968.1696s
	iters: 300, epoch: 8 | loss: 2.3237898
	speed: 0.1104s/iter; left time: 4783.4185s
	iters: 400, epoch: 8 | loss: 2.3377874
	speed: 0.1070s/iter; left time: 4624.4885s
Epoch: 8 cost time: 52.370370864868164
Epoch: 8, Steps: 469 | Train Loss: 2.322 Vali Loss: 2.310 Vali Acc: 0.104 Test Loss: 2.310 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3534021
	speed: 0.4891s/iter; left time: 21055.0147s
	iters: 200, epoch: 9 | loss: 2.3464963
	speed: 0.1250s/iter; left time: 5368.7716s
	iters: 300, epoch: 9 | loss: 2.3510466
	speed: 0.1111s/iter; left time: 4762.4150s
	iters: 400, epoch: 9 | loss: 2.3057318
	speed: 0.1229s/iter; left time: 5252.9960s
Epoch: 9 cost time: 56.83012557029724
Epoch: 9, Steps: 469 | Train Loss: 2.313 Vali Loss: 2.307 Vali Acc: 0.104 Test Loss: 2.307 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.3382897
	speed: 0.5407s/iter; left time: 23021.6591s
	iters: 200, epoch: 10 | loss: 2.3177521
	speed: 0.1247s/iter; left time: 5295.4532s
	iters: 300, epoch: 10 | loss: 2.3156104
	speed: 0.1165s/iter; left time: 4936.2403s
	iters: 400, epoch: 10 | loss: 2.3087325
	speed: 0.1181s/iter; left time: 4995.3806s
Epoch: 10 cost time: 57.15060043334961
Epoch: 10, Steps: 469 | Train Loss: 2.311 Vali Loss: 2.310 Vali Acc: 0.104 Test Loss: 2.310 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3600864
	speed: 0.5147s/iter; left time: 21672.5112s
	iters: 200, epoch: 11 | loss: 2.2346268
	speed: 0.1147s/iter; left time: 4816.9023s
	iters: 300, epoch: 11 | loss: 2.2535837
	speed: 0.1259s/iter; left time: 5274.6460s
	iters: 400, epoch: 11 | loss: 2.3088465
	speed: 0.1238s/iter; left time: 5178.1217s
Epoch: 11 cost time: 56.72816300392151
Epoch: 11, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3214235
	speed: 0.5174s/iter; left time: 21543.8611s
	iters: 200, epoch: 12 | loss: 2.3389354
	speed: 0.1174s/iter; left time: 4875.2427s
	iters: 300, epoch: 12 | loss: 2.2891433
	speed: 0.1163s/iter; left time: 4821.5151s
	iters: 400, epoch: 12 | loss: 2.3275867
	speed: 0.1102s/iter; left time: 4557.3942s
Epoch: 12 cost time: 53.86391520500183
Epoch: 12, Steps: 469 | Train Loss: 2.307 Vali Loss: 2.305 Vali Acc: 0.096 Test Loss: 2.305 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8979416809605489
model parameter : 14259014
model size : 59.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3036053
	speed: 0.1372s/iter; left time: 6419.4578s
	iters: 200, epoch: 1 | loss: 0.3188983
	speed: 0.1187s/iter; left time: 5544.3267s
	iters: 300, epoch: 1 | loss: 0.9995611
	speed: 0.1090s/iter; left time: 5080.2625s
	iters: 400, epoch: 1 | loss: 0.0375208
	speed: 0.1154s/iter; left time: 5367.2460s
Epoch: 1 cost time: 56.8972282409668
Epoch: 1, Steps: 469 | Train Loss: 0.521 Vali Loss: 0.609 Vali Acc: 0.835 Test Loss: 0.609 Test Acc: 0.835
Validation loss decreased (inf --> -0.834757).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1743949
	speed: 0.5155s/iter; left time: 23883.1396s
	iters: 200, epoch: 2 | loss: 0.8588807
	speed: 0.1097s/iter; left time: 5069.8987s
	iters: 300, epoch: 2 | loss: 0.0390411
	speed: 0.1026s/iter; left time: 4734.7465s
	iters: 400, epoch: 2 | loss: 0.2055254
	speed: 0.1161s/iter; left time: 5343.7435s
Epoch: 2 cost time: 52.70994830131531
Epoch: 2, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.448 Vali Acc: 0.865 Test Loss: 0.448 Test Acc: 0.865
Validation loss decreased (-0.834757 --> -0.865061).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0746111
	speed: 0.4637s/iter; left time: 21264.6714s
	iters: 200, epoch: 3 | loss: 0.3765824
	speed: 0.1034s/iter; left time: 4733.8280s
	iters: 300, epoch: 3 | loss: 0.0666622
	speed: 0.1108s/iter; left time: 5058.4467s
	iters: 400, epoch: 3 | loss: 0.0735438
	speed: 0.1137s/iter; left time: 5181.6289s
Epoch: 3 cost time: 50.76709055900574
Epoch: 3, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.402 Vali Acc: 0.882 Test Loss: 0.402 Test Acc: 0.882
Validation loss decreased (-0.865061 --> -0.881929).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5787656
	speed: 0.4606s/iter; left time: 20909.7504s
	iters: 200, epoch: 4 | loss: 0.4324412
	speed: 0.1039s/iter; left time: 4705.0324s
	iters: 300, epoch: 4 | loss: 0.3434386
	speed: 0.1139s/iter; left time: 5148.8931s
	iters: 400, epoch: 4 | loss: 0.5557404
	speed: 0.1357s/iter; left time: 6119.5289s
Epoch: 4 cost time: 54.245842933654785
Epoch: 4, Steps: 469 | Train Loss: 0.397 Vali Loss: 0.462 Vali Acc: 0.858 Test Loss: 0.462 Test Acc: 0.858
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0515633
	speed: 0.4950s/iter; left time: 22239.7435s
	iters: 200, epoch: 5 | loss: 0.3605520
	speed: 0.1187s/iter; left time: 5318.8832s
	iters: 300, epoch: 5 | loss: 0.1442184
	speed: 0.1152s/iter; left time: 5151.2532s
	iters: 400, epoch: 5 | loss: 0.0590172
	speed: 0.1059s/iter; left time: 4726.7870s
Epoch: 5 cost time: 53.48548221588135
Epoch: 5, Steps: 469 | Train Loss: 0.343 Vali Loss: 0.559 Vali Acc: 0.852 Test Loss: 0.559 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6745529
	speed: 0.5107s/iter; left time: 22705.0229s
	iters: 200, epoch: 6 | loss: 0.6252256
	speed: 0.1080s/iter; left time: 4791.2284s
	iters: 300, epoch: 6 | loss: 0.0720148
	speed: 0.1074s/iter; left time: 4751.6689s
	iters: 400, epoch: 6 | loss: 0.0724397
	speed: 0.1124s/iter; left time: 4963.9057s
Epoch: 6 cost time: 53.333019495010376
Epoch: 6, Steps: 469 | Train Loss: 0.307 Vali Loss: 0.564 Vali Acc: 0.842 Test Loss: 0.564 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2512107
	speed: 0.4873s/iter; left time: 21434.7722s
	iters: 200, epoch: 7 | loss: 0.2319067
	speed: 0.1063s/iter; left time: 4665.7056s
	iters: 300, epoch: 7 | loss: 0.3977600
	speed: 0.1048s/iter; left time: 4586.7674s
	iters: 400, epoch: 7 | loss: 0.0253565
	speed: 0.1050s/iter; left time: 4589.1523s
Epoch: 7 cost time: 50.92679452896118
Epoch: 7, Steps: 469 | Train Loss: 0.287 Vali Loss: 0.354 Vali Acc: 0.894 Test Loss: 0.354 Test Acc: 0.894
Validation loss decreased (-0.881929 --> -0.894222).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5965849
	speed: 0.4807s/iter; left time: 20917.1143s
	iters: 200, epoch: 8 | loss: 0.1419221
	speed: 0.1109s/iter; left time: 4816.9466s
	iters: 300, epoch: 8 | loss: 0.0555176
	speed: 0.1097s/iter; left time: 4751.0655s
	iters: 400, epoch: 8 | loss: 0.1487374
	speed: 0.1064s/iter; left time: 4599.6646s
Epoch: 8 cost time: 51.22698640823364
Epoch: 8, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
Validation loss decreased (-0.894222 --> -0.920237).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0372861
	speed: 0.4810s/iter; left time: 20706.6764s
	iters: 200, epoch: 9 | loss: 0.9327742
	speed: 0.1136s/iter; left time: 4878.8198s
	iters: 300, epoch: 9 | loss: 0.1571148
	speed: 0.1029s/iter; left time: 4408.9278s
	iters: 400, epoch: 9 | loss: 0.5274984
	speed: 0.1099s/iter; left time: 4696.3469s
Epoch: 9 cost time: 52.89069867134094
Epoch: 9, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
Validation loss decreased (-0.920237 --> -0.929671).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0187347
	speed: 0.4702s/iter; left time: 20020.7446s
	iters: 200, epoch: 10 | loss: 0.1397991
	speed: 0.1119s/iter; left time: 4754.4109s
	iters: 300, epoch: 10 | loss: 1.0153280
	speed: 0.1167s/iter; left time: 4943.7061s
	iters: 400, epoch: 10 | loss: 0.1208646
	speed: 0.1103s/iter; left time: 4661.5622s
Epoch: 10 cost time: 53.574676752090454
Epoch: 10, Steps: 469 | Train Loss: 0.254 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3987604
	speed: 0.4994s/iter; left time: 21030.0607s
	iters: 200, epoch: 11 | loss: 1.0899119
	speed: 0.1195s/iter; left time: 5020.7403s
	iters: 300, epoch: 11 | loss: 0.6470766
	speed: 0.1142s/iter; left time: 4787.7614s
	iters: 400, epoch: 11 | loss: 0.0470583
	speed: 0.1245s/iter; left time: 5204.7340s
Epoch: 11 cost time: 56.318819999694824
Epoch: 11, Steps: 469 | Train Loss: 0.313 Vali Loss: 0.331 Vali Acc: 0.907 Test Loss: 0.331 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0200987
	speed: 0.4893s/iter; left time: 20377.2563s
	iters: 200, epoch: 12 | loss: 0.0146651
	speed: 0.1163s/iter; left time: 4830.9908s
	iters: 300, epoch: 12 | loss: 0.2030447
	speed: 0.1131s/iter; left time: 4688.4168s
	iters: 400, epoch: 12 | loss: 0.0301010
	speed: 0.1115s/iter; left time: 4610.9818s
Epoch: 12 cost time: 53.987470388412476
Epoch: 12, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0658676
	speed: 0.4970s/iter; left time: 20462.3713s
	iters: 200, epoch: 13 | loss: 0.4473966
	speed: 0.1129s/iter; left time: 4636.8842s
	iters: 300, epoch: 13 | loss: 0.1030118
	speed: 0.1217s/iter; left time: 4984.9454s
	iters: 400, epoch: 13 | loss: 0.2372442
	speed: 0.1098s/iter; left time: 4488.5859s
Epoch: 13 cost time: 53.93942332267761
Epoch: 13, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2450995
	speed: 0.4769s/iter; left time: 19410.5906s
	iters: 200, epoch: 14 | loss: 0.2955167
	speed: 0.1108s/iter; left time: 4500.4482s
	iters: 300, epoch: 14 | loss: 0.1646253
	speed: 0.1070s/iter; left time: 4334.1209s
	iters: 400, epoch: 14 | loss: 0.0129387
	speed: 0.1146s/iter; left time: 4629.3498s
Epoch: 14 cost time: 53.132659912109375
Epoch: 14, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.929671 --> -0.932816).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0547192
	speed: 0.4890s/iter; left time: 19675.7005s
	iters: 200, epoch: 15 | loss: 0.0367478
	speed: 0.1011s/iter; left time: 4059.5506s
	iters: 300, epoch: 15 | loss: 0.1262768
	speed: 0.1023s/iter; left time: 4095.2561s
	iters: 400, epoch: 15 | loss: 0.5290053
	speed: 0.1013s/iter; left time: 4044.2379s
Epoch: 15 cost time: 49.27242183685303
Epoch: 15, Steps: 469 | Train Loss: 0.365 Vali Loss: 0.453 Vali Acc: 0.880 Test Loss: 0.453 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6049175
	speed: 0.4933s/iter; left time: 19617.7770s
	iters: 200, epoch: 16 | loss: 0.0499773
	speed: 0.1090s/iter; left time: 4322.8213s
	iters: 300, epoch: 16 | loss: 0.0763426
	speed: 0.1144s/iter; left time: 4527.9347s
	iters: 400, epoch: 16 | loss: 0.0288680
	speed: 0.1179s/iter; left time: 4654.1306s
Epoch: 16 cost time: 53.70802903175354
Epoch: 16, Steps: 469 | Train Loss: 0.219 Vali Loss: 0.283 Vali Acc: 0.929 Test Loss: 0.283 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3073034
	speed: 0.4750s/iter; left time: 18667.0209s
	iters: 200, epoch: 17 | loss: 0.0642588
	speed: 0.1055s/iter; left time: 4136.3660s
	iters: 300, epoch: 17 | loss: 0.0456586
	speed: 0.1189s/iter; left time: 4649.6044s
	iters: 400, epoch: 17 | loss: 0.0128823
	speed: 0.1226s/iter; left time: 4781.0926s
Epoch: 17 cost time: 54.2917001247406
Epoch: 17, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.177 Vali Acc: 0.947 Test Loss: 0.177 Test Acc: 0.947
Validation loss decreased (-0.932816 --> -0.946539).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0496758
	speed: 0.5089s/iter; left time: 19758.2153s
	iters: 200, epoch: 18 | loss: 0.0525149
	speed: 0.1222s/iter; left time: 4733.2450s
	iters: 300, epoch: 18 | loss: 0.1482804
	speed: 0.1126s/iter; left time: 4351.1817s
	iters: 400, epoch: 18 | loss: 0.0443141
	speed: 0.1177s/iter; left time: 4534.7478s
Epoch: 18 cost time: 56.89407920837402
Epoch: 18, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.946539 --> -0.959118).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0253368
	speed: 0.4888s/iter; left time: 18748.1942s
	iters: 200, epoch: 19 | loss: 0.1131467
	speed: 0.1175s/iter; left time: 4494.3209s
	iters: 300, epoch: 19 | loss: 0.0602667
	speed: 0.1201s/iter; left time: 4582.3765s
	iters: 400, epoch: 19 | loss: 0.1394447
	speed: 0.1143s/iter; left time: 4349.7008s
Epoch: 19 cost time: 54.37676930427551
Epoch: 19, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.244 Vali Acc: 0.954 Test Loss: 0.244 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1343046
	speed: 0.4878s/iter; left time: 18481.5191s
	iters: 200, epoch: 20 | loss: 0.0025924
	speed: 0.1100s/iter; left time: 4157.4882s
	iters: 300, epoch: 20 | loss: 0.0376137
	speed: 0.1088s/iter; left time: 4099.3082s
	iters: 400, epoch: 20 | loss: 0.2317121
	speed: 0.1086s/iter; left time: 4081.9045s
Epoch: 20 cost time: 52.702637672424316
Epoch: 20, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.271 Vali Acc: 0.946 Test Loss: 0.271 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0053079
	speed: 0.4808s/iter; left time: 17992.7784s
	iters: 200, epoch: 21 | loss: 0.2207325
	speed: 0.1104s/iter; left time: 4120.9190s
	iters: 300, epoch: 21 | loss: 0.0057522
	speed: 0.1123s/iter; left time: 4180.0251s
	iters: 400, epoch: 21 | loss: 0.2606575
	speed: 0.1150s/iter; left time: 4268.9793s
Epoch: 21 cost time: 53.60999035835266
Epoch: 21, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0121727
	speed: 0.4878s/iter; left time: 18025.3132s
	iters: 200, epoch: 22 | loss: 0.1208801
	speed: 0.1309s/iter; left time: 4824.3460s
	iters: 300, epoch: 22 | loss: 0.0313145
	speed: 0.1274s/iter; left time: 4682.8195s
	iters: 400, epoch: 22 | loss: 0.6550182
	speed: 0.1361s/iter; left time: 4987.5707s
Epoch: 22 cost time: 60.905672788619995
Epoch: 22, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0088417
	speed: 0.5301s/iter; left time: 19340.1351s
	iters: 200, epoch: 23 | loss: 0.0394379
	speed: 0.1269s/iter; left time: 4616.1397s
	iters: 300, epoch: 23 | loss: 0.0111675
	speed: 0.1266s/iter; left time: 4592.1199s
	iters: 400, epoch: 23 | loss: 0.0075842
	speed: 0.1244s/iter; left time: 4500.8987s
Epoch: 23 cost time: 58.66496229171753
Epoch: 23, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0386796
	speed: 0.5219s/iter; left time: 18795.4727s
	iters: 200, epoch: 24 | loss: 0.0038856
	speed: 0.1136s/iter; left time: 4079.9635s
	iters: 300, epoch: 24 | loss: 0.0419267
	speed: 0.1213s/iter; left time: 4343.8924s
	iters: 400, epoch: 24 | loss: 0.0737684
	speed: 0.1306s/iter; left time: 4663.5928s
Epoch: 24 cost time: 59.06432127952576
Epoch: 24, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
Validation loss decreased (-0.959118 --> -0.960547).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0173143
	speed: 0.5859s/iter; left time: 20825.5645s
	iters: 200, epoch: 25 | loss: 0.1121955
	speed: 0.1327s/iter; left time: 4703.0815s
	iters: 300, epoch: 25 | loss: 0.0885358
	speed: 0.1280s/iter; left time: 4525.4699s
	iters: 400, epoch: 25 | loss: 0.0312922
	speed: 0.1159s/iter; left time: 4083.2305s
Epoch: 25 cost time: 59.64252853393555
Epoch: 25, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.411 Vali Acc: 0.885 Test Loss: 0.411 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.8572837
	speed: 0.5346s/iter; left time: 18753.3633s
	iters: 200, epoch: 26 | loss: 0.0060059
	speed: 0.1203s/iter; left time: 4206.6983s
	iters: 300, epoch: 26 | loss: 0.6020910
	speed: 0.1329s/iter; left time: 4635.9034s
	iters: 400, epoch: 26 | loss: 0.0021535
	speed: 0.1304s/iter; left time: 4534.2776s
Epoch: 26 cost time: 59.17162275314331
Epoch: 26, Steps: 469 | Train Loss: 0.199 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0503959
	speed: 0.5153s/iter; left time: 17833.5834s
	iters: 200, epoch: 27 | loss: 0.0224322
	speed: 0.1370s/iter; left time: 4726.0435s
	iters: 300, epoch: 27 | loss: 0.0450025
	speed: 0.1278s/iter; left time: 4396.8999s
	iters: 400, epoch: 27 | loss: 0.0362177
	speed: 0.1129s/iter; left time: 3874.1911s
Epoch: 27 cost time: 58.45064926147461
Epoch: 27, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0071584
	speed: 0.5170s/iter; left time: 17649.9940s
	iters: 200, epoch: 28 | loss: 0.1507322
	speed: 0.1184s/iter; left time: 4030.8913s
	iters: 300, epoch: 28 | loss: 0.0363678
	speed: 0.1229s/iter; left time: 4169.9298s
	iters: 400, epoch: 28 | loss: 0.0096131
	speed: 0.1037s/iter; left time: 3509.7191s
Epoch: 28 cost time: 55.50047731399536
Epoch: 28, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0276180
	speed: 0.5017s/iter; left time: 16890.8328s
	iters: 200, epoch: 29 | loss: 0.0074085
	speed: 0.1051s/iter; left time: 3529.4402s
	iters: 300, epoch: 29 | loss: 0.0014876
	speed: 0.1050s/iter; left time: 3512.5939s
	iters: 400, epoch: 29 | loss: 0.0124348
	speed: 0.1231s/iter; left time: 4108.6215s
Epoch: 29 cost time: 54.52929615974426
Epoch: 29, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0142287
	speed: 0.4927s/iter; left time: 16356.1777s
	iters: 200, epoch: 30 | loss: 0.1304687
	speed: 0.1300s/iter; left time: 4302.7512s
	iters: 300, epoch: 30 | loss: 0.0118612
	speed: 0.1234s/iter; left time: 4072.3367s
	iters: 400, epoch: 30 | loss: 0.0059102
	speed: 0.1185s/iter; left time: 3897.1945s
Epoch: 30 cost time: 56.01711106300354
Epoch: 30, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0195794
	speed: 0.4719s/iter; left time: 15447.0717s
	iters: 200, epoch: 31 | loss: 0.0146255
	speed: 0.1172s/iter; left time: 3823.1234s
	iters: 300, epoch: 31 | loss: 0.0708350
	speed: 0.1224s/iter; left time: 3983.0952s
	iters: 400, epoch: 31 | loss: 0.0040345
	speed: 0.1023s/iter; left time: 3318.8163s
Epoch: 31 cost time: 52.91270923614502
Epoch: 31, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0957494
	speed: 0.4638s/iter; left time: 14963.9560s
	iters: 200, epoch: 32 | loss: 0.1476485
	speed: 0.1077s/iter; left time: 3464.2140s
	iters: 300, epoch: 32 | loss: 0.0223108
	speed: 0.1173s/iter; left time: 3762.1391s
	iters: 400, epoch: 32 | loss: 0.7443275
	speed: 0.1119s/iter; left time: 3575.6722s
Epoch: 32 cost time: 53.39789319038391
Epoch: 32, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0359457
	speed: 0.4945s/iter; left time: 15722.2025s
	iters: 200, epoch: 33 | loss: 0.0040761
	speed: 0.1108s/iter; left time: 3510.6624s
	iters: 300, epoch: 33 | loss: 0.0038511
	speed: 0.1261s/iter; left time: 3983.9866s
	iters: 400, epoch: 33 | loss: 0.0048360
	speed: 0.1037s/iter; left time: 3267.2031s
Epoch: 33 cost time: 54.91503071784973
Epoch: 33, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0371780
	speed: 0.5330s/iter; left time: 16695.2878s
	iters: 200, epoch: 34 | loss: 0.0159134
	speed: 0.1050s/iter; left time: 3278.1898s
	iters: 300, epoch: 34 | loss: 0.0035694
	speed: 0.1036s/iter; left time: 3225.6686s
	iters: 400, epoch: 34 | loss: 0.0092265
	speed: 0.1152s/iter; left time: 3573.4464s
Epoch: 34 cost time: 53.82105469703674
Epoch: 34, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.236 Vali Acc: 0.955 Test Loss: 0.236 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9605488850771869
model parameter : 14257990
model size : 59.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0342811
	speed: 0.1548s/iter; left time: 7245.0867s
	iters: 200, epoch: 1 | loss: 0.7196365
	speed: 0.1175s/iter; left time: 5488.5310s
	iters: 300, epoch: 1 | loss: 0.0286222
	speed: 0.1250s/iter; left time: 5824.4115s
	iters: 400, epoch: 1 | loss: 0.7884362
	speed: 0.1114s/iter; left time: 5178.3186s
Epoch: 1 cost time: 59.42331337928772
Epoch: 1, Steps: 469 | Train Loss: 0.484 Vali Loss: 0.495 Vali Acc: 0.849 Test Loss: 0.495 Test Acc: 0.849
Validation loss decreased (inf --> -0.849338).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4687391
	speed: 0.5040s/iter; left time: 23351.9892s
	iters: 200, epoch: 2 | loss: 0.0504143
	speed: 0.1274s/iter; left time: 5890.8280s
	iters: 300, epoch: 2 | loss: 0.3095372
	speed: 0.1304s/iter; left time: 6017.6749s
	iters: 400, epoch: 2 | loss: 0.3558711
	speed: 0.1235s/iter; left time: 5683.8007s
Epoch: 2 cost time: 59.73818016052246
Epoch: 2, Steps: 469 | Train Loss: 0.319 Vali Loss: 0.293 Vali Acc: 0.924 Test Loss: 0.293 Test Acc: 0.924
Validation loss decreased (-0.849338 --> -0.923668).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2215218
	speed: 0.5629s/iter; left time: 25815.0700s
	iters: 200, epoch: 3 | loss: 0.0763784
	speed: 0.1309s/iter; left time: 5989.6939s
	iters: 300, epoch: 3 | loss: 0.0278048
	speed: 0.1354s/iter; left time: 6182.6234s
	iters: 400, epoch: 3 | loss: 0.1679173
	speed: 0.1293s/iter; left time: 5889.8071s
Epoch: 3 cost time: 62.74135732650757
Epoch: 3, Steps: 469 | Train Loss: 0.280 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1505359
	speed: 0.5204s/iter; left time: 23623.3656s
	iters: 200, epoch: 4 | loss: 0.6695831
	speed: 0.1257s/iter; left time: 5695.3201s
	iters: 300, epoch: 4 | loss: 0.9502789
	speed: 0.1322s/iter; left time: 5976.5657s
	iters: 400, epoch: 4 | loss: 0.6768907
	speed: 0.1235s/iter; left time: 5569.9014s
Epoch: 4 cost time: 57.464001417160034
Epoch: 4, Steps: 469 | Train Loss: 0.757 Vali Loss: 2.643 Vali Acc: 0.201 Test Loss: 2.643 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.7728746
	speed: 0.5169s/iter; left time: 23223.0862s
	iters: 200, epoch: 5 | loss: 2.3855336
	speed: 0.1088s/iter; left time: 4877.5397s
	iters: 300, epoch: 5 | loss: 2.4466972
	speed: 0.1096s/iter; left time: 4901.9429s
	iters: 400, epoch: 5 | loss: 2.3818579
	speed: 0.1146s/iter; left time: 5112.8747s
Epoch: 5 cost time: 53.5131413936615
Epoch: 5, Steps: 469 | Train Loss: 2.403 Vali Loss: 2.376 Vali Acc: 0.104 Test Loss: 2.376 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.2413580
	speed: 0.4696s/iter; left time: 20876.5361s
	iters: 200, epoch: 6 | loss: 2.3192065
	speed: 0.1117s/iter; left time: 4955.9182s
	iters: 300, epoch: 6 | loss: 2.3818805
	speed: 0.1076s/iter; left time: 4760.3433s
	iters: 400, epoch: 6 | loss: 2.3246889
	speed: 0.1034s/iter; left time: 4565.0464s
Epoch: 6 cost time: 51.579145431518555
Epoch: 6, Steps: 469 | Train Loss: 2.349 Vali Loss: 2.320 Vali Acc: 0.096 Test Loss: 2.320 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.2863090
	speed: 0.4363s/iter; left time: 19192.9101s
	iters: 200, epoch: 7 | loss: 2.3937836
	speed: 0.1069s/iter; left time: 4689.5310s
	iters: 300, epoch: 7 | loss: 2.3144522
	speed: 0.1025s/iter; left time: 4489.4095s
	iters: 400, epoch: 7 | loss: 2.3580723
	speed: 0.1090s/iter; left time: 4762.1678s
Epoch: 7 cost time: 50.1938419342041
Epoch: 7, Steps: 469 | Train Loss: 2.323 Vali Loss: 2.311 Vali Acc: 0.104 Test Loss: 2.311 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.2779324
	speed: 0.4824s/iter; left time: 20994.7110s
	iters: 200, epoch: 8 | loss: 2.3095624
	speed: 0.1224s/iter; left time: 5316.0881s
	iters: 300, epoch: 8 | loss: 2.3070285
	speed: 0.1198s/iter; left time: 5189.2094s
	iters: 400, epoch: 8 | loss: 2.3124268
	speed: 0.1157s/iter; left time: 5002.3144s
Epoch: 8 cost time: 55.12694001197815
Epoch: 8, Steps: 469 | Train Loss: 2.317 Vali Loss: 2.305 Vali Acc: 0.104 Test Loss: 2.305 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3434017
	speed: 0.4838s/iter; left time: 20826.2047s
	iters: 200, epoch: 9 | loss: 2.3121684
	speed: 0.1129s/iter; left time: 4848.1714s
	iters: 300, epoch: 9 | loss: 2.3168888
	speed: 0.1177s/iter; left time: 5041.4764s
	iters: 400, epoch: 9 | loss: 2.3184543
	speed: 0.1120s/iter; left time: 4785.8841s
Epoch: 9 cost time: 54.29811096191406
Epoch: 9, Steps: 469 | Train Loss: 2.312 Vali Loss: 2.308 Vali Acc: 0.104 Test Loss: 2.308 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2670062
	speed: 0.4910s/iter; left time: 20908.6442s
	iters: 200, epoch: 10 | loss: 2.3540156
	speed: 0.1108s/iter; left time: 4706.1236s
	iters: 300, epoch: 10 | loss: 2.2803237
	speed: 0.1136s/iter; left time: 4813.2277s
	iters: 400, epoch: 10 | loss: 2.2771530
	speed: 0.1117s/iter; left time: 4723.5816s
Epoch: 10 cost time: 54.3335862159729
Epoch: 10, Steps: 469 | Train Loss: 2.308 Vali Loss: 2.310 Vali Acc: 0.104 Test Loss: 2.310 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.2872913
	speed: 0.4563s/iter; left time: 19215.5217s
	iters: 200, epoch: 11 | loss: 2.2198772
	speed: 0.1069s/iter; left time: 4491.4585s
	iters: 300, epoch: 11 | loss: 2.3040133
	speed: 0.0974s/iter; left time: 4080.5268s
	iters: 400, epoch: 11 | loss: 2.3587048
	speed: 0.1107s/iter; left time: 4626.4614s
Epoch: 11 cost time: 50.00287222862244
Epoch: 11, Steps: 469 | Train Loss: 2.309 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.2440472
	speed: 0.4527s/iter; left time: 18853.3819s
	iters: 200, epoch: 12 | loss: 2.3214543
	speed: 0.1049s/iter; left time: 4358.5575s
	iters: 300, epoch: 12 | loss: 2.2864943
	speed: 0.1100s/iter; left time: 4557.4906s
	iters: 400, epoch: 12 | loss: 2.2892833
	speed: 0.1114s/iter; left time: 4607.0161s
Epoch: 12 cost time: 50.55915093421936
Epoch: 12, Steps: 469 | Train Loss: 2.307 Vali Loss: 2.306 Vali Acc: 0.104 Test Loss: 2.306 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9236706689536878
model parameter : 11897158
model size : 50.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4742526
	speed: 0.1457s/iter; left time: 6819.1484s
	iters: 200, epoch: 1 | loss: 0.3232870
	speed: 0.1326s/iter; left time: 6194.4800s
	iters: 300, epoch: 1 | loss: 0.1637029
	speed: 0.1332s/iter; left time: 6206.3421s
	iters: 400, epoch: 1 | loss: 0.3466637
	speed: 0.1339s/iter; left time: 6224.8458s
Epoch: 1 cost time: 64.04971051216125
Epoch: 1, Steps: 469 | Train Loss: 0.516 Vali Loss: 0.523 Vali Acc: 0.840 Test Loss: 0.523 Test Acc: 0.840
Validation loss decreased (inf --> -0.840475).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0907759
	speed: 0.5335s/iter; left time: 24716.4734s
	iters: 200, epoch: 2 | loss: 0.1298689
	speed: 0.1447s/iter; left time: 6690.2514s
	iters: 300, epoch: 2 | loss: 0.0464599
	speed: 0.1357s/iter; left time: 6261.2962s
	iters: 400, epoch: 2 | loss: 0.2653737
	speed: 0.1510s/iter; left time: 6951.3798s
Epoch: 2 cost time: 66.3843343257904
Epoch: 2, Steps: 469 | Train Loss: 0.315 Vali Loss: 0.574 Vali Acc: 0.857 Test Loss: 0.574 Test Acc: 0.857
Validation loss decreased (-0.840475 --> -0.856770).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5530356
	speed: 0.5591s/iter; left time: 25640.6581s
	iters: 200, epoch: 3 | loss: 0.4610558
	speed: 0.1428s/iter; left time: 6535.0339s
	iters: 300, epoch: 3 | loss: 0.2321655
	speed: 0.1348s/iter; left time: 6154.9877s
	iters: 400, epoch: 3 | loss: 0.3895489
	speed: 0.1357s/iter; left time: 6182.5340s
Epoch: 3 cost time: 65.2320032119751
Epoch: 3, Steps: 469 | Train Loss: 0.307 Vali Loss: 0.310 Vali Acc: 0.920 Test Loss: 0.310 Test Acc: 0.920
Validation loss decreased (-0.856770 --> -0.920237).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1391682
	speed: 0.6089s/iter; left time: 27639.6737s
	iters: 200, epoch: 4 | loss: 0.0680197
	speed: 0.1431s/iter; left time: 6481.0959s
	iters: 300, epoch: 4 | loss: 0.4185154
	speed: 0.1317s/iter; left time: 5950.1173s
	iters: 400, epoch: 4 | loss: 0.2346498
	speed: 0.1184s/iter; left time: 5338.4281s
Epoch: 4 cost time: 62.425370931625366
Epoch: 4, Steps: 469 | Train Loss: 0.452 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7787026
	speed: 0.5285s/iter; left time: 23744.6425s
	iters: 200, epoch: 5 | loss: 0.5311184
	speed: 0.1244s/iter; left time: 5574.9759s
	iters: 300, epoch: 5 | loss: 0.4739856
	speed: 0.1241s/iter; left time: 5552.3889s
	iters: 400, epoch: 5 | loss: 1.1182219
	speed: 0.1193s/iter; left time: 5325.7302s
Epoch: 5 cost time: 59.85564684867859
Epoch: 5, Steps: 469 | Train Loss: 0.757 Vali Loss: 0.690 Vali Acc: 0.776 Test Loss: 0.690 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5594957
	speed: 0.5574s/iter; left time: 24781.7405s
	iters: 200, epoch: 6 | loss: 1.8947600
	speed: 0.1259s/iter; left time: 5584.9057s
	iters: 300, epoch: 6 | loss: 2.1296978
	speed: 0.1314s/iter; left time: 5813.5276s
	iters: 400, epoch: 6 | loss: 2.3767457
	speed: 0.1260s/iter; left time: 5563.5816s
Epoch: 6 cost time: 60.72978234291077
Epoch: 6, Steps: 469 | Train Loss: 1.619 Vali Loss: 2.457 Vali Acc: 0.096 Test Loss: 2.457 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3761122
	speed: 0.5351s/iter; left time: 23535.3336s
	iters: 200, epoch: 7 | loss: 2.3313589
	speed: 0.1381s/iter; left time: 6059.0514s
	iters: 300, epoch: 7 | loss: 2.2127037
	speed: 0.1557s/iter; left time: 6817.2704s
	iters: 400, epoch: 7 | loss: 2.3244667
	speed: 0.1320s/iter; left time: 5768.8253s
Epoch: 7 cost time: 65.13251090049744
Epoch: 7, Steps: 469 | Train Loss: 2.366 Vali Loss: 2.311 Vali Acc: 0.104 Test Loss: 2.311 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.4158664
	speed: 0.5777s/iter; left time: 25138.2197s
	iters: 200, epoch: 8 | loss: 2.3473399
	speed: 0.1436s/iter; left time: 6234.6615s
	iters: 300, epoch: 8 | loss: 2.3243537
	speed: 0.1350s/iter; left time: 5850.0944s
	iters: 400, epoch: 8 | loss: 2.2188556
	speed: 0.1245s/iter; left time: 5379.1056s
Epoch: 8 cost time: 62.821683168411255
Epoch: 8, Steps: 469 | Train Loss: 2.321 Vali Loss: 2.308 Vali Acc: 0.104 Test Loss: 2.308 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3243201
	speed: 0.5320s/iter; left time: 22902.8596s
	iters: 200, epoch: 9 | loss: 2.2847967
	speed: 0.1391s/iter; left time: 5974.0542s
	iters: 300, epoch: 9 | loss: 2.4015048
	speed: 0.1244s/iter; left time: 5332.2483s
	iters: 400, epoch: 9 | loss: 2.3023429
	speed: 0.1342s/iter; left time: 5736.2268s
Epoch: 9 cost time: 62.46529531478882
Epoch: 9, Steps: 469 | Train Loss: 2.314 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.2734158
	speed: 0.5500s/iter; left time: 23419.9388s
	iters: 200, epoch: 10 | loss: 2.3143120
	speed: 0.1202s/iter; left time: 5107.0206s
	iters: 300, epoch: 10 | loss: 2.2987862
	speed: 0.1263s/iter; left time: 5351.4802s
	iters: 400, epoch: 10 | loss: 2.3465581
	speed: 0.1244s/iter; left time: 5260.5223s
Epoch: 10 cost time: 58.1151008605957
Epoch: 10, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.3139608
	speed: 0.5339s/iter; left time: 22484.7989s
	iters: 200, epoch: 11 | loss: 2.2975707
	speed: 0.1161s/iter; left time: 4877.1778s
	iters: 300, epoch: 11 | loss: 2.3103662
	speed: 0.1284s/iter; left time: 5380.2513s
	iters: 400, epoch: 11 | loss: 2.2955716
	speed: 0.1398s/iter; left time: 5845.9872s
Epoch: 11 cost time: 61.50997877120972
Epoch: 11, Steps: 469 | Train Loss: 2.308 Vali Loss: 2.312 Vali Acc: 0.104 Test Loss: 2.312 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.3257763
	speed: 0.5181s/iter; left time: 21575.7647s
	iters: 200, epoch: 12 | loss: 2.3016779
	speed: 0.1152s/iter; left time: 4787.3943s
	iters: 300, epoch: 12 | loss: 2.2991765
	speed: 0.1227s/iter; left time: 5083.9697s
	iters: 400, epoch: 12 | loss: 2.3219347
	speed: 0.1258s/iter; left time: 5199.3154s
Epoch: 12 cost time: 57.2377188205719
Epoch: 12, Steps: 469 | Train Loss: 2.308 Vali Loss: 2.306 Vali Acc: 0.104 Test Loss: 2.306 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.2633843
	speed: 0.5407s/iter; left time: 22261.2607s
	iters: 200, epoch: 13 | loss: 2.2951558
	speed: 0.1199s/iter; left time: 4923.0393s
	iters: 300, epoch: 13 | loss: 2.3230345
	speed: 0.1481s/iter; left time: 6067.0219s
	iters: 400, epoch: 13 | loss: 2.2922480
	speed: 0.1425s/iter; left time: 5823.6365s
Epoch: 13 cost time: 63.78912162780762
Epoch: 13, Steps: 469 | Train Loss: 2.308 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9202401372212693
model parameter : 11896134
model size : 50.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4136483
	speed: 0.1580s/iter; left time: 7396.1564s
	iters: 200, epoch: 1 | loss: 0.1717471
	speed: 0.1473s/iter; left time: 6877.6330s
	iters: 300, epoch: 1 | loss: 0.1718930
	speed: 0.1411s/iter; left time: 6573.8059s
	iters: 400, epoch: 1 | loss: 1.0160414
	speed: 0.1411s/iter; left time: 6563.2932s
Epoch: 1 cost time: 67.4481372833252
Epoch: 1, Steps: 469 | Train Loss: 0.476 Vali Loss: 0.336 Vali Acc: 0.892 Test Loss: 0.336 Test Acc: 0.892
Validation loss decreased (inf --> -0.892221).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6976370
	speed: 0.5784s/iter; left time: 26800.2553s
	iters: 200, epoch: 2 | loss: 0.5520471
	speed: 0.1584s/iter; left time: 7321.0740s
	iters: 300, epoch: 2 | loss: 0.1378081
	speed: 0.1413s/iter; left time: 6518.3497s
	iters: 400, epoch: 2 | loss: 0.0717481
	speed: 0.1245s/iter; left time: 5732.4766s
Epoch: 2 cost time: 65.92694044113159
Epoch: 2, Steps: 469 | Train Loss: 0.311 Vali Loss: 0.384 Vali Acc: 0.897 Test Loss: 0.384 Test Acc: 0.897
Validation loss decreased (-0.892221 --> -0.896794).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1607559
	speed: 0.5185s/iter; left time: 23782.2056s
	iters: 200, epoch: 3 | loss: 0.1443760
	speed: 0.1323s/iter; left time: 6055.4501s
	iters: 300, epoch: 3 | loss: 0.4296055
	speed: 0.1398s/iter; left time: 6384.0244s
	iters: 400, epoch: 3 | loss: 0.5415709
	speed: 0.1340s/iter; left time: 6103.4107s
Epoch: 3 cost time: 62.46676158905029
Epoch: 3, Steps: 469 | Train Loss: 0.319 Vali Loss: 0.402 Vali Acc: 0.893 Test Loss: 0.402 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0962229
	speed: 0.5779s/iter; left time: 26231.5459s
	iters: 200, epoch: 4 | loss: 0.2635014
	speed: 0.1255s/iter; left time: 5686.3932s
	iters: 300, epoch: 4 | loss: 0.2076280
	speed: 0.1359s/iter; left time: 6141.3051s
	iters: 400, epoch: 4 | loss: 0.0921236
	speed: 0.1455s/iter; left time: 6562.0505s
Epoch: 4 cost time: 65.94109272956848
Epoch: 4, Steps: 469 | Train Loss: 0.447 Vali Loss: 0.882 Vali Acc: 0.767 Test Loss: 0.882 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1748650
	speed: 0.5609s/iter; left time: 25197.1752s
	iters: 200, epoch: 5 | loss: 0.1875620
	speed: 0.1529s/iter; left time: 6853.2296s
	iters: 300, epoch: 5 | loss: 0.3304852
	speed: 0.1180s/iter; left time: 5276.0706s
	iters: 400, epoch: 5 | loss: 0.5031669
	speed: 0.1316s/iter; left time: 5874.4005s
Epoch: 5 cost time: 60.254926443099976
Epoch: 5, Steps: 469 | Train Loss: 0.542 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1859135
	speed: 0.5617s/iter; left time: 24969.6004s
	iters: 200, epoch: 6 | loss: 0.1551913
	speed: 0.1419s/iter; left time: 6295.1361s
	iters: 300, epoch: 6 | loss: 1.2113829
	speed: 0.1352s/iter; left time: 5984.3919s
	iters: 400, epoch: 6 | loss: 0.2596013
	speed: 0.1449s/iter; left time: 6398.0698s
Epoch: 6 cost time: 67.97355818748474
Epoch: 6, Steps: 469 | Train Loss: 0.489 Vali Loss: 0.733 Vali Acc: 0.810 Test Loss: 0.733 Test Acc: 0.810
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9059010
	speed: 0.5993s/iter; left time: 26362.4001s
	iters: 200, epoch: 7 | loss: 0.0898845
	speed: 0.1386s/iter; left time: 6084.3910s
	iters: 300, epoch: 7 | loss: 0.2481728
	speed: 0.1360s/iter; left time: 5957.0449s
	iters: 400, epoch: 7 | loss: 0.1061711
	speed: 0.1269s/iter; left time: 5545.6207s
Epoch: 7 cost time: 64.92097187042236
Epoch: 7, Steps: 469 | Train Loss: 0.379 Vali Loss: 0.463 Vali Acc: 0.882 Test Loss: 0.463 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1789622
	speed: 0.5634s/iter; left time: 24517.3216s
	iters: 200, epoch: 8 | loss: 0.1668732
	speed: 0.1309s/iter; left time: 5681.9208s
	iters: 300, epoch: 8 | loss: 0.2789040
	speed: 0.1254s/iter; left time: 5432.3227s
	iters: 400, epoch: 8 | loss: 0.2966324
	speed: 0.1370s/iter; left time: 5919.1080s
Epoch: 8 cost time: 62.42876887321472
Epoch: 8, Steps: 469 | Train Loss: 0.360 Vali Loss: 0.625 Vali Acc: 0.816 Test Loss: 0.625 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3094559
	speed: 0.5920s/iter; left time: 25487.1479s
	iters: 200, epoch: 9 | loss: 0.4880689
	speed: 0.1442s/iter; left time: 6194.4603s
	iters: 300, epoch: 9 | loss: 1.3155586
	speed: 0.1338s/iter; left time: 5731.7071s
	iters: 400, epoch: 9 | loss: 1.4256041
	speed: 0.1293s/iter; left time: 5528.4419s
Epoch: 9 cost time: 64.20577645301819
Epoch: 9, Steps: 469 | Train Loss: 0.814 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2320294
	speed: 0.5476s/iter; left time: 23318.7592s
	iters: 200, epoch: 10 | loss: 0.3396407
	speed: 0.1164s/iter; left time: 4942.5969s
	iters: 300, epoch: 10 | loss: 0.4152395
	speed: 0.1251s/iter; left time: 5300.8605s
	iters: 400, epoch: 10 | loss: 0.4459289
	speed: 0.1357s/iter; left time: 5738.0464s
Epoch: 10 cost time: 62.191129207611084
Epoch: 10, Steps: 469 | Train Loss: 0.449 Vali Loss: 0.529 Vali Acc: 0.845 Test Loss: 0.529 Test Acc: 0.845
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1677560
	speed: 0.6072s/iter; left time: 25569.6001s
	iters: 200, epoch: 11 | loss: 0.5539449
	speed: 0.1359s/iter; left time: 5708.6584s
	iters: 300, epoch: 11 | loss: 0.0614651
	speed: 0.1443s/iter; left time: 6048.9524s
	iters: 400, epoch: 11 | loss: 0.0780838
	speed: 0.1508s/iter; left time: 6306.7795s
Epoch: 11 cost time: 68.23478412628174
Epoch: 11, Steps: 469 | Train Loss: 0.317 Vali Loss: 0.404 Vali Acc: 0.910 Test Loss: 0.404 Test Acc: 0.910
Validation loss decreased (-0.896794 --> -0.909944).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6407619
	speed: 0.5900s/iter; left time: 24567.4821s
	iters: 200, epoch: 12 | loss: 0.3144544
	speed: 0.1490s/iter; left time: 6188.9627s
	iters: 300, epoch: 12 | loss: 0.1562758
	speed: 0.1601s/iter; left time: 6636.8292s
	iters: 400, epoch: 12 | loss: 0.1058990
	speed: 0.1417s/iter; left time: 5857.1762s
Epoch: 12 cost time: 70.3166937828064
Epoch: 12, Steps: 469 | Train Loss: 0.276 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0840014
	speed: 0.5871s/iter; left time: 24174.1130s
	iters: 200, epoch: 13 | loss: 0.0763098
	speed: 0.1433s/iter; left time: 5885.4945s
	iters: 300, epoch: 13 | loss: 0.8930259
	speed: 0.1456s/iter; left time: 5964.9881s
	iters: 400, epoch: 13 | loss: 1.2887105
	speed: 0.1352s/iter; left time: 5526.5717s
Epoch: 13 cost time: 66.43638396263123
Epoch: 13, Steps: 469 | Train Loss: 0.363 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3813634
	speed: 0.6017s/iter; left time: 24492.5824s
	iters: 200, epoch: 14 | loss: 0.2966273
	speed: 0.1405s/iter; left time: 5706.2165s
	iters: 300, epoch: 14 | loss: 0.4793847
	speed: 0.1389s/iter; left time: 5624.8400s
	iters: 400, epoch: 14 | loss: 0.5182990
	speed: 0.1354s/iter; left time: 5469.1370s
Epoch: 14 cost time: 68.49725842475891
Epoch: 14, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.319 Vali Acc: 0.896 Test Loss: 0.319 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6123367
	speed: 0.5615s/iter; left time: 22592.4489s
	iters: 200, epoch: 15 | loss: 0.1355421
	speed: 0.1308s/iter; left time: 5248.7765s
	iters: 300, epoch: 15 | loss: 0.3755551
	speed: 0.1381s/iter; left time: 5530.4153s
	iters: 400, epoch: 15 | loss: 0.0405454
	speed: 0.1258s/iter; left time: 5023.1522s
Epoch: 15 cost time: 60.845446825027466
Epoch: 15, Steps: 469 | Train Loss: 0.269 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6176320
	speed: 0.5720s/iter; left time: 22747.1973s
	iters: 200, epoch: 16 | loss: 0.0860932
	speed: 0.1467s/iter; left time: 5820.2812s
	iters: 300, epoch: 16 | loss: 0.3637816
	speed: 0.1329s/iter; left time: 5257.2739s
	iters: 400, epoch: 16 | loss: 0.2712465
	speed: 0.1457s/iter; left time: 5751.3613s
Epoch: 16 cost time: 69.53712296485901
Epoch: 16, Steps: 469 | Train Loss: 0.320 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1621360
	speed: 0.6051s/iter; left time: 23780.1607s
	iters: 200, epoch: 17 | loss: 0.6647389
	speed: 0.1400s/iter; left time: 5489.5160s
	iters: 300, epoch: 17 | loss: 0.4891027
	speed: 0.1363s/iter; left time: 5329.5138s
	iters: 400, epoch: 17 | loss: 0.3668182
	speed: 0.1144s/iter; left time: 4462.9184s
Epoch: 17 cost time: 62.94468641281128
Epoch: 17, Steps: 469 | Train Loss: 0.290 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
Validation loss decreased (-0.909944 --> -0.916520).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2526178
	speed: 0.5470s/iter; left time: 21240.3572s
	iters: 200, epoch: 18 | loss: 0.3073202
	speed: 0.1369s/iter; left time: 5300.3236s
	iters: 300, epoch: 18 | loss: 0.4069339
	speed: 0.1417s/iter; left time: 5474.5351s
	iters: 400, epoch: 18 | loss: 0.6087449
	speed: 0.1407s/iter; left time: 5420.2962s
Epoch: 18 cost time: 65.4238452911377
Epoch: 18, Steps: 469 | Train Loss: 0.328 Vali Loss: 0.418 Vali Acc: 0.893 Test Loss: 0.418 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2182965
	speed: 0.5483s/iter; left time: 21031.3989s
	iters: 200, epoch: 19 | loss: 0.0150146
	speed: 0.1355s/iter; left time: 5184.4046s
	iters: 300, epoch: 19 | loss: 0.0497368
	speed: 0.1278s/iter; left time: 4875.1722s
	iters: 400, epoch: 19 | loss: 0.0262599
	speed: 0.1214s/iter; left time: 4620.3722s
Epoch: 19 cost time: 61.466249227523804
Epoch: 19, Steps: 469 | Train Loss: 0.281 Vali Loss: 0.373 Vali Acc: 0.888 Test Loss: 0.373 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0185319
	speed: 0.5458s/iter; left time: 20680.2844s
	iters: 200, epoch: 20 | loss: 0.1781052
	speed: 0.1548s/iter; left time: 5849.1791s
	iters: 300, epoch: 20 | loss: 0.0836306
	speed: 0.1279s/iter; left time: 4820.5160s
	iters: 400, epoch: 20 | loss: 0.0916759
	speed: 0.1459s/iter; left time: 5484.1721s
Epoch: 20 cost time: 66.725252866745
Epoch: 20, Steps: 469 | Train Loss: 0.226 Vali Loss: 0.410 Vali Acc: 0.894 Test Loss: 0.410 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4214233
	speed: 0.5739s/iter; left time: 21474.0597s
	iters: 200, epoch: 21 | loss: 0.2371780
	speed: 0.1394s/iter; left time: 5202.9032s
	iters: 300, epoch: 21 | loss: 0.1116280
	speed: 0.1429s/iter; left time: 5318.0058s
	iters: 400, epoch: 21 | loss: 0.0444774
	speed: 0.1337s/iter; left time: 4962.8355s
Epoch: 21 cost time: 64.36043286323547
Epoch: 21, Steps: 469 | Train Loss: 0.257 Vali Loss: 0.342 Vali Acc: 0.910 Test Loss: 0.342 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.5940979
	speed: 0.5438s/iter; left time: 20095.1734s
	iters: 200, epoch: 22 | loss: 0.1769913
	speed: 0.1558s/iter; left time: 5740.4184s
	iters: 300, epoch: 22 | loss: 0.0629401
	speed: 0.1360s/iter; left time: 4999.0912s
	iters: 400, epoch: 22 | loss: 0.1975932
	speed: 0.1394s/iter; left time: 5108.1754s
Epoch: 22 cost time: 66.760329246521
Epoch: 22, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.380 Vali Acc: 0.920 Test Loss: 0.380 Test Acc: 0.920
Validation loss decreased (-0.916520 --> -0.919665).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0317308
	speed: 0.5709s/iter; left time: 20826.9200s
	iters: 200, epoch: 23 | loss: 0.4248047
	speed: 0.1471s/iter; left time: 5352.1472s
	iters: 300, epoch: 23 | loss: 0.1533154
	speed: 0.1310s/iter; left time: 4754.1640s
	iters: 400, epoch: 23 | loss: 0.0849749
	speed: 0.1316s/iter; left time: 4762.6043s
Epoch: 23 cost time: 63.190248250961304
Epoch: 23, Steps: 469 | Train Loss: 0.245 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0326564
	speed: 0.5516s/iter; left time: 19865.2986s
	iters: 200, epoch: 24 | loss: 0.2158302
	speed: 0.1554s/iter; left time: 5579.5859s
	iters: 300, epoch: 24 | loss: 0.0075006
	speed: 0.1262s/iter; left time: 4518.1783s
	iters: 400, epoch: 24 | loss: 0.2290301
	speed: 0.1320s/iter; left time: 4714.8785s
Epoch: 24 cost time: 64.72985935211182
Epoch: 24, Steps: 469 | Train Loss: 0.209 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.919665 --> -0.936818).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0826355
	speed: 0.5750s/iter; left time: 20438.0776s
	iters: 200, epoch: 25 | loss: 0.0221790
	speed: 0.1333s/iter; left time: 4724.2918s
	iters: 300, epoch: 25 | loss: 0.0560432
	speed: 0.1304s/iter; left time: 4608.4794s
	iters: 400, epoch: 25 | loss: 0.3959403
	speed: 0.1356s/iter; left time: 4780.5979s
Epoch: 25 cost time: 61.540791511535645
Epoch: 25, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.326 Vali Acc: 0.929 Test Loss: 0.326 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0962366
	speed: 0.5520s/iter; left time: 19360.2021s
	iters: 200, epoch: 26 | loss: 0.1945478
	speed: 0.1345s/iter; left time: 4702.9392s
	iters: 300, epoch: 26 | loss: 0.1120479
	speed: 0.1336s/iter; left time: 4660.8893s
	iters: 400, epoch: 26 | loss: 0.0651999
	speed: 0.1393s/iter; left time: 4845.3511s
Epoch: 26 cost time: 64.92042279243469
Epoch: 26, Steps: 469 | Train Loss: 0.219 Vali Loss: 0.325 Vali Acc: 0.918 Test Loss: 0.325 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0340687
	speed: 0.5982s/iter; left time: 20703.1495s
	iters: 200, epoch: 27 | loss: 0.0181289
	speed: 0.1392s/iter; left time: 4803.9270s
	iters: 300, epoch: 27 | loss: 0.9601896
	speed: 0.1689s/iter; left time: 5809.7306s
	iters: 400, epoch: 27 | loss: 0.5684589
	speed: 0.1239s/iter; left time: 4251.6517s
Epoch: 27 cost time: 69.57285237312317
Epoch: 27, Steps: 469 | Train Loss: 0.241 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.3601676
	speed: 0.5934s/iter; left time: 20258.5916s
	iters: 200, epoch: 28 | loss: 0.1823287
	speed: 0.1339s/iter; left time: 4558.4964s
	iters: 300, epoch: 28 | loss: 0.6423584
	speed: 0.1287s/iter; left time: 4366.9765s
	iters: 400, epoch: 28 | loss: 0.0529533
	speed: 0.1440s/iter; left time: 4872.2998s
Epoch: 28 cost time: 64.42721056938171
Epoch: 28, Steps: 469 | Train Loss: 0.212 Vali Loss: 0.335 Vali Acc: 0.914 Test Loss: 0.335 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0412798
	speed: 0.5618s/iter; left time: 18914.4986s
	iters: 200, epoch: 29 | loss: 0.4184075
	speed: 0.1377s/iter; left time: 4621.8566s
	iters: 300, epoch: 29 | loss: 0.6452065
	speed: 0.1345s/iter; left time: 4501.0403s
	iters: 400, epoch: 29 | loss: 0.0468720
	speed: 0.1429s/iter; left time: 4768.8330s
Epoch: 29 cost time: 65.28075551986694
Epoch: 29, Steps: 469 | Train Loss: 0.209 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0690570
	speed: 0.5612s/iter; left time: 18631.9774s
	iters: 200, epoch: 30 | loss: 0.1818839
	speed: 0.1444s/iter; left time: 4780.4488s
	iters: 300, epoch: 30 | loss: 0.0391249
	speed: 0.1354s/iter; left time: 4469.2729s
	iters: 400, epoch: 30 | loss: 0.0911681
	speed: 0.1450s/iter; left time: 4771.5573s
Epoch: 30 cost time: 67.36418747901917
Epoch: 30, Steps: 469 | Train Loss: 0.191 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.936818 --> -0.939106).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0478223
	speed: 0.5798s/iter; left time: 18977.8088s
	iters: 200, epoch: 31 | loss: 0.2684717
	speed: 0.1522s/iter; left time: 4967.6158s
	iters: 300, epoch: 31 | loss: 0.0931361
	speed: 0.1468s/iter; left time: 4775.9275s
	iters: 400, epoch: 31 | loss: 0.0107638
	speed: 0.1548s/iter; left time: 5019.7112s
Epoch: 31 cost time: 69.33397960662842
Epoch: 31, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.324 Vali Acc: 0.921 Test Loss: 0.324 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.5783305
	speed: 0.5660s/iter; left time: 18260.4066s
	iters: 200, epoch: 32 | loss: 0.0095153
	speed: 0.1453s/iter; left time: 4672.4936s
	iters: 300, epoch: 32 | loss: 0.0478326
	speed: 0.1596s/iter; left time: 5118.2041s
	iters: 400, epoch: 32 | loss: 0.0633256
	speed: 0.1262s/iter; left time: 4033.4599s
Epoch: 32 cost time: 65.83742451667786
Epoch: 32, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.2578135
	speed: 0.5765s/iter; left time: 18327.5358s
	iters: 200, epoch: 33 | loss: 0.1647925
	speed: 0.1390s/iter; left time: 4406.8224s
	iters: 300, epoch: 33 | loss: 0.0683977
	speed: 0.1405s/iter; left time: 4438.9506s
	iters: 400, epoch: 33 | loss: 0.0175151
	speed: 0.1370s/iter; left time: 4315.9440s
Epoch: 33 cost time: 64.60756587982178
Epoch: 33, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.1619117
	speed: 0.5907s/iter; left time: 18503.9574s
	iters: 200, epoch: 34 | loss: 0.4239058
	speed: 0.1287s/iter; left time: 4019.4650s
	iters: 300, epoch: 34 | loss: 0.0304196
	speed: 0.1600s/iter; left time: 4979.9955s
	iters: 400, epoch: 34 | loss: 0.1809067
	speed: 0.1254s/iter; left time: 3889.9426s
Epoch: 34 cost time: 66.47466802597046
Epoch: 34, Steps: 469 | Train Loss: 0.198 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0470542
	speed: 0.5888s/iter; left time: 18166.3582s
	iters: 200, epoch: 35 | loss: 0.1910860
	speed: 0.1199s/iter; left time: 3688.0518s
	iters: 300, epoch: 35 | loss: 0.0517522
	speed: 0.1322s/iter; left time: 4052.0358s
	iters: 400, epoch: 35 | loss: 0.0081321
	speed: 0.1210s/iter; left time: 3695.6632s
Epoch: 35 cost time: 60.16907238960266
Epoch: 35, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
Validation loss decreased (-0.939106 --> -0.954544).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0273893
	speed: 0.5852s/iter; left time: 17781.4647s
	iters: 200, epoch: 36 | loss: 0.0341652
	speed: 0.1315s/iter; left time: 3982.9517s
	iters: 300, epoch: 36 | loss: 0.0082889
	speed: 0.1464s/iter; left time: 4419.0524s
	iters: 400, epoch: 36 | loss: 0.1409771
	speed: 0.1442s/iter; left time: 4338.6419s
Epoch: 36 cost time: 69.36103630065918
Epoch: 36, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.1489775
	speed: 0.6262s/iter; left time: 18734.9095s
	iters: 200, epoch: 37 | loss: 0.0045925
	speed: 0.1376s/iter; left time: 4101.6411s
	iters: 300, epoch: 37 | loss: 0.3864779
	speed: 0.1358s/iter; left time: 4034.1978s
	iters: 400, epoch: 37 | loss: 0.0084396
	speed: 0.1603s/iter; left time: 4746.2688s
Epoch: 37 cost time: 69.10627341270447
Epoch: 37, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.333 Vali Acc: 0.929 Test Loss: 0.333 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0163625
	speed: 0.6601s/iter; left time: 19437.9732s
	iters: 200, epoch: 38 | loss: 0.2365314
	speed: 0.1446s/iter; left time: 4243.4789s
	iters: 300, epoch: 38 | loss: 0.0192887
	speed: 0.1596s/iter; left time: 4667.7142s
	iters: 400, epoch: 38 | loss: 0.3148761
	speed: 0.1518s/iter; left time: 4424.6153s
Epoch: 38 cost time: 74.71891713142395
Epoch: 38, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0255897
	speed: 0.6523s/iter; left time: 18901.7271s
	iters: 200, epoch: 39 | loss: 0.0948486
	speed: 0.1442s/iter; left time: 4164.2412s
	iters: 300, epoch: 39 | loss: 0.3805462
	speed: 0.1235s/iter; left time: 3554.3700s
	iters: 400, epoch: 39 | loss: 0.0167359
	speed: 0.1286s/iter; left time: 3689.2083s
Epoch: 39 cost time: 65.2916738986969
Epoch: 39, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.211 Vali Acc: 0.945 Test Loss: 0.211 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.1491303
	speed: 0.6221s/iter; left time: 17736.2293s
	iters: 200, epoch: 40 | loss: 0.6256927
	speed: 0.1311s/iter; left time: 3723.4969s
	iters: 300, epoch: 40 | loss: 0.4584264
	speed: 0.1345s/iter; left time: 3807.4286s
	iters: 400, epoch: 40 | loss: 0.1110385
	speed: 0.1518s/iter; left time: 4282.8628s
Epoch: 40 cost time: 64.8785171508789
Epoch: 40, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.237 Vali Acc: 0.934 Test Loss: 0.237 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0885814
	speed: 0.5727s/iter; left time: 16058.2254s
	iters: 200, epoch: 41 | loss: 0.0818868
	speed: 0.1347s/iter; left time: 3762.7046s
	iters: 300, epoch: 41 | loss: 0.0177791
	speed: 0.1249s/iter; left time: 3476.5065s
	iters: 400, epoch: 41 | loss: 0.1309700
	speed: 0.1256s/iter; left time: 3483.2536s
Epoch: 41 cost time: 62.671319007873535
Epoch: 41, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0132017
	speed: 0.5849s/iter; left time: 16128.0710s
	iters: 200, epoch: 42 | loss: 0.0862010
	speed: 0.1442s/iter; left time: 3962.0267s
	iters: 300, epoch: 42 | loss: 0.0948655
	speed: 0.1382s/iter; left time: 3782.3964s
	iters: 400, epoch: 42 | loss: 0.0123901
	speed: 0.1456s/iter; left time: 3969.5431s
Epoch: 42 cost time: 66.39119696617126
Epoch: 42, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.271 Vali Acc: 0.940 Test Loss: 0.271 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0092233
	speed: 0.6320s/iter; left time: 17128.6458s
	iters: 200, epoch: 43 | loss: 0.1501028
	speed: 0.1589s/iter; left time: 4291.5716s
	iters: 300, epoch: 43 | loss: 0.0095735
	speed: 0.1505s/iter; left time: 4050.0807s
	iters: 400, epoch: 43 | loss: 0.2641393
	speed: 0.1493s/iter; left time: 4001.8717s
Epoch: 43 cost time: 71.36145091056824
Epoch: 43, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.279 Vali Acc: 0.940 Test Loss: 0.279 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0420105
	speed: 0.6352s/iter; left time: 16916.6601s
	iters: 200, epoch: 44 | loss: 0.0963349
	speed: 0.1581s/iter; left time: 4195.2022s
	iters: 300, epoch: 44 | loss: 0.0192708
	speed: 0.1380s/iter; left time: 3648.9739s
	iters: 400, epoch: 44 | loss: 0.0122723
	speed: 0.1704s/iter; left time: 4486.5983s
Epoch: 44 cost time: 70.6455385684967
Epoch: 44, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.252 Vali Acc: 0.929 Test Loss: 0.252 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.5563458
	speed: 0.5921s/iter; left time: 15493.0351s
	iters: 200, epoch: 45 | loss: 0.2275349
	speed: 0.1375s/iter; left time: 3585.2032s
	iters: 300, epoch: 45 | loss: 0.0708931
	speed: 0.1242s/iter; left time: 3225.1962s
	iters: 400, epoch: 45 | loss: 0.0767709
	speed: 0.1286s/iter; left time: 3326.3272s
Epoch: 45 cost time: 64.14101505279541
Epoch: 45, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9545454545454546
model parameter : 11895110
model size : 50.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5229140
	speed: 0.1602s/iter; left time: 7499.7284s
	iters: 200, epoch: 1 | loss: 0.2201123
	speed: 0.1277s/iter; left time: 5964.9857s
	iters: 300, epoch: 1 | loss: 0.4207756
	speed: 0.1364s/iter; left time: 6357.9368s
	iters: 400, epoch: 1 | loss: 0.4220317
	speed: 0.1274s/iter; left time: 5922.6026s
Epoch: 1 cost time: 63.669456005096436
Epoch: 1, Steps: 469 | Train Loss: 0.493 Vali Loss: 0.527 Vali Acc: 0.830 Test Loss: 0.527 Test Acc: 0.830
Validation loss decreased (inf --> -0.829612).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3722658
	speed: 0.5193s/iter; left time: 24061.2850s
	iters: 200, epoch: 2 | loss: 0.5322292
	speed: 0.1222s/iter; left time: 5651.7851s
	iters: 300, epoch: 2 | loss: 0.5153714
	speed: 0.1193s/iter; left time: 5505.2841s
	iters: 400, epoch: 2 | loss: 0.1788537
	speed: 0.1247s/iter; left time: 5741.0237s
Epoch: 2 cost time: 58.714083433151245
Epoch: 2, Steps: 469 | Train Loss: 0.313 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
Validation loss decreased (-0.829612 --> -0.927670).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2829296
	speed: 0.5609s/iter; left time: 25722.6399s
	iters: 200, epoch: 3 | loss: 0.4523813
	speed: 0.1358s/iter; left time: 6214.7846s
	iters: 300, epoch: 3 | loss: 0.1821811
	speed: 0.1386s/iter; left time: 6329.3067s
	iters: 400, epoch: 3 | loss: 0.4237577
	speed: 0.1258s/iter; left time: 5731.9861s
Epoch: 3 cost time: 63.75954055786133
Epoch: 3, Steps: 469 | Train Loss: 0.302 Vali Loss: 0.796 Vali Acc: 0.797 Test Loss: 0.796 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9152377
	speed: 0.5335s/iter; left time: 24215.6756s
	iters: 200, epoch: 4 | loss: 0.0189909
	speed: 0.1191s/iter; left time: 5393.8105s
	iters: 300, epoch: 4 | loss: 0.2368303
	speed: 0.1212s/iter; left time: 5477.8764s
	iters: 400, epoch: 4 | loss: 0.1764618
	speed: 0.1169s/iter; left time: 5270.1387s
Epoch: 4 cost time: 56.612698554992676
Epoch: 4, Steps: 469 | Train Loss: 0.283 Vali Loss: 0.430 Vali Acc: 0.882 Test Loss: 0.430 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0528096
	speed: 0.4926s/iter; left time: 22130.7521s
	iters: 200, epoch: 5 | loss: 0.0291981
	speed: 0.1199s/iter; left time: 5372.8871s
	iters: 300, epoch: 5 | loss: 0.0903273
	speed: 0.1189s/iter; left time: 5319.1307s
	iters: 400, epoch: 5 | loss: 0.1273561
	speed: 0.1233s/iter; left time: 5503.9281s
Epoch: 5 cost time: 57.12781643867493
Epoch: 5, Steps: 469 | Train Loss: 0.269 Vali Loss: 0.402 Vali Acc: 0.887 Test Loss: 0.402 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1696727
	speed: 0.5211s/iter; left time: 23164.2249s
	iters: 200, epoch: 6 | loss: 0.1533057
	speed: 0.1200s/iter; left time: 5322.7474s
	iters: 300, epoch: 6 | loss: 0.2867059
	speed: 0.1233s/iter; left time: 5455.6478s
	iters: 400, epoch: 6 | loss: 0.0562918
	speed: 0.1159s/iter; left time: 5119.5838s
Epoch: 6 cost time: 57.808314085006714
Epoch: 6, Steps: 469 | Train Loss: 0.283 Vali Loss: 0.379 Vali Acc: 0.864 Test Loss: 0.379 Test Acc: 0.864
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1330301
	speed: 0.5245s/iter; left time: 23070.6615s
	iters: 200, epoch: 7 | loss: 0.3094785
	speed: 0.1166s/iter; left time: 5118.1971s
	iters: 300, epoch: 7 | loss: 0.3598333
	speed: 0.1212s/iter; left time: 5305.5438s
	iters: 400, epoch: 7 | loss: 0.1540825
	speed: 0.1298s/iter; left time: 5670.2676s
Epoch: 7 cost time: 59.3930561542511
Epoch: 7, Steps: 469 | Train Loss: 0.268 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1358071
	speed: 0.5316s/iter; left time: 23134.5917s
	iters: 200, epoch: 8 | loss: 0.4475812
	speed: 0.1311s/iter; left time: 5691.0966s
	iters: 300, epoch: 8 | loss: 0.3704098
	speed: 0.1160s/iter; left time: 5024.8852s
	iters: 400, epoch: 8 | loss: 0.4904103
	speed: 0.1123s/iter; left time: 4855.5046s
Epoch: 8 cost time: 56.65393853187561
Epoch: 8, Steps: 469 | Train Loss: 0.230 Vali Loss: 0.476 Vali Acc: 0.876 Test Loss: 0.476 Test Acc: 0.876
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3518221
	speed: 0.4971s/iter; left time: 21400.5463s
	iters: 200, epoch: 9 | loss: 0.4072860
	speed: 0.1211s/iter; left time: 5200.9972s
	iters: 300, epoch: 9 | loss: 0.3553222
	speed: 0.1195s/iter; left time: 5119.2382s
	iters: 400, epoch: 9 | loss: 0.0387072
	speed: 0.1231s/iter; left time: 5261.6929s
Epoch: 9 cost time: 56.79361629486084
Epoch: 9, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.9331869
	speed: 0.5090s/iter; left time: 21673.2472s
	iters: 200, epoch: 10 | loss: 0.0127182
	speed: 0.1188s/iter; left time: 5048.1171s
	iters: 300, epoch: 10 | loss: 0.2470681
	speed: 0.1187s/iter; left time: 5031.4501s
	iters: 400, epoch: 10 | loss: 0.0549609
	speed: 0.1125s/iter; left time: 4757.9533s
Epoch: 10 cost time: 54.807297229766846
Epoch: 10, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4495037
	speed: 0.4641s/iter; left time: 19544.2022s
	iters: 200, epoch: 11 | loss: 0.0444445
	speed: 0.1236s/iter; left time: 5194.2136s
	iters: 300, epoch: 11 | loss: 0.6467135
	speed: 0.1214s/iter; left time: 5088.5091s
	iters: 400, epoch: 11 | loss: 0.0056280
	speed: 0.1172s/iter; left time: 4900.2612s
Epoch: 11 cost time: 56.32580280303955
Epoch: 11, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0754609
	speed: 0.5207s/iter; left time: 21684.9180s
	iters: 200, epoch: 12 | loss: 0.1315638
	speed: 0.1266s/iter; left time: 5261.1583s
	iters: 300, epoch: 12 | loss: 0.0283154
	speed: 0.1215s/iter; left time: 5035.1844s
	iters: 400, epoch: 12 | loss: 0.0645191
	speed: 0.1220s/iter; left time: 5042.1661s
Epoch: 12 cost time: 57.985331773757935
Epoch: 12, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9276729559748428
model parameter : 11894086
model size : 50.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1397755
	speed: 0.1836s/iter; left time: 8593.5471s
	iters: 200, epoch: 1 | loss: 0.1540088
	speed: 0.1755s/iter; left time: 8196.8240s
	iters: 300, epoch: 1 | loss: 0.6098183
	speed: 0.1363s/iter; left time: 6353.3886s
	iters: 400, epoch: 1 | loss: 0.7775231
	speed: 0.1596s/iter; left time: 7421.6464s
Epoch: 1 cost time: 75.15928387641907
Epoch: 1, Steps: 469 | Train Loss: 0.485 Vali Loss: 0.497 Vali Acc: 0.842 Test Loss: 0.497 Test Acc: 0.842
Validation loss decreased (inf --> -0.841905).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1377839
	speed: 0.6185s/iter; left time: 28654.7796s
	iters: 200, epoch: 2 | loss: 0.1883419
	speed: 0.1382s/iter; left time: 6387.1757s
	iters: 300, epoch: 2 | loss: 0.4360743
	speed: 0.1393s/iter; left time: 6424.1298s
	iters: 400, epoch: 2 | loss: 0.1451164
	speed: 0.1432s/iter; left time: 6591.2791s
Epoch: 2 cost time: 65.90821838378906
Epoch: 2, Steps: 469 | Train Loss: 0.311 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
Validation loss decreased (-0.841905 --> -0.883644).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7041684
	speed: 0.5929s/iter; left time: 27194.1626s
	iters: 200, epoch: 3 | loss: 0.2464604
	speed: 0.1498s/iter; left time: 6854.0458s
	iters: 300, epoch: 3 | loss: 0.5488544
	speed: 0.1541s/iter; left time: 7038.2904s
	iters: 400, epoch: 3 | loss: 0.2221718
	speed: 0.1488s/iter; left time: 6778.7842s
Epoch: 3 cost time: 70.38728666305542
Epoch: 3, Steps: 469 | Train Loss: 0.287 Vali Loss: 0.451 Vali Acc: 0.851 Test Loss: 0.451 Test Acc: 0.851
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2493667
	speed: 0.6143s/iter; left time: 27884.0723s
	iters: 200, epoch: 4 | loss: 0.4929841
	speed: 0.1555s/iter; left time: 7045.3856s
	iters: 300, epoch: 4 | loss: 0.2029055
	speed: 0.1359s/iter; left time: 6144.0352s
	iters: 400, epoch: 4 | loss: 1.1625109
	speed: 0.1278s/iter; left time: 5762.1470s
Epoch: 4 cost time: 69.37114000320435
Epoch: 4, Steps: 469 | Train Loss: 0.486 Vali Loss: 0.845 Vali Acc: 0.779 Test Loss: 0.845 Test Acc: 0.779
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3471825
	speed: 0.6197s/iter; left time: 27839.5233s
	iters: 200, epoch: 5 | loss: 0.3733684
	speed: 0.1902s/iter; left time: 8525.4524s
	iters: 300, epoch: 5 | loss: 1.0828384
	speed: 0.1551s/iter; left time: 6938.7220s
	iters: 400, epoch: 5 | loss: 0.8199637
	speed: 0.1407s/iter; left time: 6278.1172s
Epoch: 5 cost time: 72.91626620292664
Epoch: 5, Steps: 469 | Train Loss: 0.926 Vali Loss: 1.862 Vali Acc: 0.288 Test Loss: 1.862 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.2763524
	speed: 0.6005s/iter; left time: 26694.0632s
	iters: 200, epoch: 6 | loss: 2.5962713
	speed: 0.1343s/iter; left time: 5958.0429s
	iters: 300, epoch: 6 | loss: 2.3303561
	speed: 0.1453s/iter; left time: 6430.6072s
	iters: 400, epoch: 6 | loss: 2.3452158
	speed: 0.1531s/iter; left time: 6761.1814s
Epoch: 6 cost time: 68.48729681968689
Epoch: 6, Steps: 469 | Train Loss: 2.392 Vali Loss: 2.374 Vali Acc: 0.096 Test Loss: 2.374 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3267858
	speed: 0.6081s/iter; left time: 26747.3927s
	iters: 200, epoch: 7 | loss: 2.3973801
	speed: 0.1644s/iter; left time: 7216.5831s
	iters: 300, epoch: 7 | loss: 2.2638755
	speed: 0.1637s/iter; left time: 7166.3396s
	iters: 400, epoch: 7 | loss: 2.3057723
	speed: 0.1568s/iter; left time: 6849.7194s
Epoch: 7 cost time: 75.89671015739441
Epoch: 7, Steps: 469 | Train Loss: 2.286 Vali Loss: 2.004 Vali Acc: 0.174 Test Loss: 2.004 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.0809586
	speed: 0.6283s/iter; left time: 27343.6775s
	iters: 200, epoch: 8 | loss: 2.2594182
	speed: 0.1747s/iter; left time: 7584.9908s
	iters: 300, epoch: 8 | loss: 2.0687373
	speed: 0.1776s/iter; left time: 7691.9031s
	iters: 400, epoch: 8 | loss: 2.1875484
	speed: 0.1451s/iter; left time: 6271.0636s
Epoch: 8 cost time: 75.24637413024902
Epoch: 8, Steps: 469 | Train Loss: 2.158 Vali Loss: 2.273 Vali Acc: 0.117 Test Loss: 2.273 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3851063
	speed: 0.6418s/iter; left time: 27627.8183s
	iters: 200, epoch: 9 | loss: 2.3623242
	speed: 0.1631s/iter; left time: 7005.2138s
	iters: 300, epoch: 9 | loss: 2.1059725
	speed: 0.1536s/iter; left time: 6583.3639s
	iters: 400, epoch: 9 | loss: 2.2156131
	speed: 0.1649s/iter; left time: 7051.0797s
Epoch: 9 cost time: 77.10755515098572
Epoch: 9, Steps: 469 | Train Loss: 2.248 Vali Loss: 2.271 Vali Acc: 0.125 Test Loss: 2.271 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.0237999
	speed: 0.5868s/iter; left time: 24986.0095s
	iters: 200, epoch: 10 | loss: 2.1268647
	speed: 0.1517s/iter; left time: 6445.0259s
	iters: 300, epoch: 10 | loss: 2.2302432
	speed: 0.1386s/iter; left time: 5875.3191s
	iters: 400, epoch: 10 | loss: 2.1952977
	speed: 0.1594s/iter; left time: 6739.1542s
Epoch: 10 cost time: 69.15417575836182
Epoch: 10, Steps: 469 | Train Loss: 2.242 Vali Loss: 2.274 Vali Acc: 0.126 Test Loss: 2.274 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.2083368
	speed: 0.5951s/iter; left time: 25062.2379s
	iters: 200, epoch: 11 | loss: 1.7394181
	speed: 0.1414s/iter; left time: 5940.8053s
	iters: 300, epoch: 11 | loss: 1.9991962
	speed: 0.1442s/iter; left time: 6044.9521s
	iters: 400, epoch: 11 | loss: 1.9627248
	speed: 0.1244s/iter; left time: 5199.7939s
Epoch: 11 cost time: 65.30440640449524
Epoch: 11, Steps: 469 | Train Loss: 2.142 Vali Loss: 2.074 Vali Acc: 0.197 Test Loss: 2.074 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.0074537
	speed: 0.6106s/iter; left time: 25425.9156s
	iters: 200, epoch: 12 | loss: 1.7844379
	speed: 0.1491s/iter; left time: 6195.6420s
	iters: 300, epoch: 12 | loss: 1.8637251
	speed: 0.1581s/iter; left time: 6550.2200s
	iters: 400, epoch: 12 | loss: 1.8860333
	speed: 0.1644s/iter; left time: 6795.0370s
Epoch: 12 cost time: 76.54658389091492
Epoch: 12, Steps: 469 | Train Loss: 1.929 Vali Loss: 1.806 Vali Acc: 0.255 Test Loss: 1.806 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8836477987421384
model parameter : 10715206
model size : 45.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4697294
	speed: 0.1733s/iter; left time: 8108.5944s
	iters: 200, epoch: 1 | loss: 0.3159599
	speed: 0.1220s/iter; left time: 5696.2514s
	iters: 300, epoch: 1 | loss: 0.0694197
	speed: 0.1439s/iter; left time: 6705.4386s
	iters: 400, epoch: 1 | loss: 0.3221667
	speed: 0.1621s/iter; left time: 7538.8134s
Epoch: 1 cost time: 70.29646921157837
Epoch: 1, Steps: 469 | Train Loss: 0.495 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
Validation loss decreased (inf --> -0.841332).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2419399
	speed: 0.5951s/iter; left time: 27572.5131s
	iters: 200, epoch: 2 | loss: 0.1555155
	speed: 0.1635s/iter; left time: 7559.3550s
	iters: 300, epoch: 2 | loss: 0.1125285
	speed: 0.1662s/iter; left time: 7669.3867s
	iters: 400, epoch: 2 | loss: 0.7654790
	speed: 0.1609s/iter; left time: 7406.3971s
Epoch: 2 cost time: 75.83896327018738
Epoch: 2, Steps: 469 | Train Loss: 0.291 Vali Loss: 0.512 Vali Acc: 0.839 Test Loss: 0.512 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2223402
	speed: 0.5834s/iter; left time: 26756.9001s
	iters: 200, epoch: 3 | loss: 0.1485423
	speed: 0.1463s/iter; left time: 6697.1102s
	iters: 300, epoch: 3 | loss: 0.1792711
	speed: 0.1739s/iter; left time: 7941.2062s
	iters: 400, epoch: 3 | loss: 0.2498638
	speed: 0.1622s/iter; left time: 7388.5149s
Epoch: 3 cost time: 71.87522268295288
Epoch: 3, Steps: 469 | Train Loss: 0.287 Vali Loss: 0.303 Vali Acc: 0.921 Test Loss: 0.303 Test Acc: 0.921
Validation loss decreased (-0.841332 --> -0.920523).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3591517
	speed: 0.6389s/iter; left time: 29003.4428s
	iters: 200, epoch: 4 | loss: 0.1926620
	speed: 0.1636s/iter; left time: 7411.1477s
	iters: 300, epoch: 4 | loss: 0.2158421
	speed: 0.1427s/iter; left time: 6448.4988s
	iters: 400, epoch: 4 | loss: 0.7481371
	speed: 0.1620s/iter; left time: 7305.3821s
Epoch: 4 cost time: 73.94814658164978
Epoch: 4, Steps: 469 | Train Loss: 0.365 Vali Loss: 0.536 Vali Acc: 0.842 Test Loss: 0.536 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5409889
	speed: 0.6107s/iter; left time: 27436.4313s
	iters: 200, epoch: 5 | loss: 0.7148348
	speed: 0.1576s/iter; left time: 7065.0636s
	iters: 300, epoch: 5 | loss: 0.6643987
	speed: 0.1474s/iter; left time: 6592.1383s
	iters: 400, epoch: 5 | loss: 2.9002213
	speed: 0.1501s/iter; left time: 6696.7351s
Epoch: 5 cost time: 72.97302198410034
Epoch: 5, Steps: 469 | Train Loss: 1.202 Vali Loss: 2.833 Vali Acc: 0.095 Test Loss: 2.833 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.8804455
	speed: 0.5911s/iter; left time: 26277.2148s
	iters: 200, epoch: 6 | loss: 2.3852727
	speed: 0.1286s/iter; left time: 5704.3262s
	iters: 300, epoch: 6 | loss: 2.3836319
	speed: 0.1503s/iter; left time: 6651.5669s
	iters: 400, epoch: 6 | loss: 2.4759560
	speed: 0.1299s/iter; left time: 5737.1333s
Epoch: 6 cost time: 63.982176065444946
Epoch: 6, Steps: 469 | Train Loss: 2.405 Vali Loss: 2.356 Vali Acc: 0.104 Test Loss: 2.356 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.4894829
	speed: 0.6078s/iter; left time: 26735.1045s
	iters: 200, epoch: 7 | loss: 2.3952963
	speed: 0.1529s/iter; left time: 6710.7847s
	iters: 300, epoch: 7 | loss: 2.4425335
	speed: 0.1521s/iter; left time: 6657.8857s
	iters: 400, epoch: 7 | loss: 2.2453783
	speed: 0.1533s/iter; left time: 6698.7810s
Epoch: 7 cost time: 71.7547869682312
Epoch: 7, Steps: 469 | Train Loss: 2.361 Vali Loss: 2.314 Vali Acc: 0.104 Test Loss: 2.314 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.3418808
	speed: 0.6270s/iter; left time: 27284.0804s
	iters: 200, epoch: 8 | loss: 2.3406534
	speed: 0.1703s/iter; left time: 7395.0182s
	iters: 300, epoch: 8 | loss: 2.2960393
	speed: 0.1696s/iter; left time: 7346.3610s
	iters: 400, epoch: 8 | loss: 2.3678002
	speed: 0.1493s/iter; left time: 6452.5806s
Epoch: 8 cost time: 75.32667851448059
Epoch: 8, Steps: 469 | Train Loss: 2.322 Vali Loss: 2.313 Vali Acc: 0.104 Test Loss: 2.313 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.2018642
	speed: 0.6663s/iter; left time: 28684.4376s
	iters: 200, epoch: 9 | loss: 2.3191628
	speed: 0.1683s/iter; left time: 7226.1723s
	iters: 300, epoch: 9 | loss: 2.3229384
	speed: 0.1494s/iter; left time: 6399.7083s
	iters: 400, epoch: 9 | loss: 2.3504701
	speed: 0.1347s/iter; left time: 5757.4968s
Epoch: 9 cost time: 72.25819325447083
Epoch: 9, Steps: 469 | Train Loss: 2.316 Vali Loss: 2.315 Vali Acc: 0.104 Test Loss: 2.315 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.3419278
	speed: 0.5627s/iter; left time: 23960.0162s
	iters: 200, epoch: 10 | loss: 2.2562957
	speed: 0.1328s/iter; left time: 5640.8941s
	iters: 300, epoch: 10 | loss: 2.2686327
	speed: 0.1283s/iter; left time: 5437.8813s
	iters: 400, epoch: 10 | loss: 2.2998261
	speed: 0.1345s/iter; left time: 5684.5901s
Epoch: 10 cost time: 63.46580672264099
Epoch: 10, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.310 Vali Acc: 0.096 Test Loss: 2.310 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.3471689
	speed: 0.6399s/iter; left time: 26944.7810s
	iters: 200, epoch: 11 | loss: 2.2944925
	speed: 0.1555s/iter; left time: 6533.5929s
	iters: 300, epoch: 11 | loss: 2.3331389
	speed: 0.1606s/iter; left time: 6729.2094s
	iters: 400, epoch: 11 | loss: 2.2802844
	speed: 0.1589s/iter; left time: 6644.5802s
Epoch: 11 cost time: 75.98262763023376
Epoch: 11, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.305 Vali Acc: 0.096 Test Loss: 2.305 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.3012152
	speed: 0.6153s/iter; left time: 25623.3815s
	iters: 200, epoch: 12 | loss: 2.2774646
	speed: 0.1526s/iter; left time: 6339.4722s
	iters: 300, epoch: 12 | loss: 2.2995467
	speed: 0.1459s/iter; left time: 6045.1434s
	iters: 400, epoch: 12 | loss: 2.3135777
	speed: 0.1578s/iter; left time: 6523.9396s
Epoch: 12 cost time: 74.02466297149658
Epoch: 12, Steps: 469 | Train Loss: 2.309 Vali Loss: 2.305 Vali Acc: 0.096 Test Loss: 2.305 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.2894640
	speed: 0.6292s/iter; left time: 25906.5921s
	iters: 200, epoch: 13 | loss: 2.3357840
	speed: 0.1442s/iter; left time: 5924.5987s
	iters: 300, epoch: 13 | loss: 2.2403941
	speed: 0.1596s/iter; left time: 6538.0190s
	iters: 400, epoch: 13 | loss: 2.2868376
	speed: 0.1615s/iter; left time: 6602.0904s
Epoch: 13 cost time: 72.09512400627136
Epoch: 13, Steps: 469 | Train Loss: 2.307 Vali Loss: 2.307 Vali Acc: 0.104 Test Loss: 2.307 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9205260148656375
model parameter : 10714182
model size : 45.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5630136
	speed: 0.1566s/iter; left time: 7326.7500s
	iters: 200, epoch: 1 | loss: 0.3453350
	speed: 0.1340s/iter; left time: 6258.6961s
	iters: 300, epoch: 1 | loss: 0.1962622
	speed: 0.1175s/iter; left time: 5475.6033s
	iters: 400, epoch: 1 | loss: 0.3359767
	speed: 0.1225s/iter; left time: 5695.5514s
Epoch: 1 cost time: 62.11770462989807
Epoch: 1, Steps: 469 | Train Loss: 0.491 Vali Loss: 0.450 Vali Acc: 0.873 Test Loss: 0.450 Test Acc: 0.873
Validation loss decreased (inf --> -0.873352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1341975
	speed: 0.5099s/iter; left time: 23623.5665s
	iters: 200, epoch: 2 | loss: 0.1622664
	speed: 0.1089s/iter; left time: 5033.3931s
	iters: 300, epoch: 2 | loss: 0.2529366
	speed: 0.1187s/iter; left time: 5477.8399s
	iters: 400, epoch: 2 | loss: 0.0312131
	speed: 0.1075s/iter; left time: 4947.8690s
Epoch: 2 cost time: 55.53198051452637
Epoch: 2, Steps: 469 | Train Loss: 0.283 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.873352 --> -0.899654).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0016048
	speed: 0.5219s/iter; left time: 23937.4445s
	iters: 200, epoch: 3 | loss: 0.2145280
	speed: 0.1291s/iter; left time: 5908.8811s
	iters: 300, epoch: 3 | loss: 0.0647865
	speed: 0.1190s/iter; left time: 5433.8472s
	iters: 400, epoch: 3 | loss: 0.2676742
	speed: 0.1358s/iter; left time: 6187.5696s
Epoch: 3 cost time: 60.369898319244385
Epoch: 3, Steps: 469 | Train Loss: 0.319 Vali Loss: 0.422 Vali Acc: 0.863 Test Loss: 0.422 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2092948
	speed: 0.5270s/iter; left time: 23921.0918s
	iters: 200, epoch: 4 | loss: 0.0199557
	speed: 0.1374s/iter; left time: 6223.7407s
	iters: 300, epoch: 4 | loss: 0.3753166
	speed: 0.1271s/iter; left time: 5742.5208s
	iters: 400, epoch: 4 | loss: 1.1579318
	speed: 0.1234s/iter; left time: 5565.6462s
Epoch: 4 cost time: 60.22296690940857
Epoch: 4, Steps: 469 | Train Loss: 0.297 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.899654 --> -0.925097).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0649293
	speed: 0.4973s/iter; left time: 22342.2690s
	iters: 200, epoch: 5 | loss: 0.1209820
	speed: 0.1188s/iter; left time: 5324.7910s
	iters: 300, epoch: 5 | loss: 0.2636848
	speed: 0.1222s/iter; left time: 5465.0132s
	iters: 400, epoch: 5 | loss: 0.2242241
	speed: 0.1196s/iter; left time: 5337.1875s
Epoch: 5 cost time: 56.68602013587952
Epoch: 5, Steps: 469 | Train Loss: 0.395 Vali Loss: 0.599 Vali Acc: 0.788 Test Loss: 0.599 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2143682
	speed: 0.4879s/iter; left time: 21691.2559s
	iters: 200, epoch: 6 | loss: 0.2758174
	speed: 0.1127s/iter; left time: 4998.4632s
	iters: 300, epoch: 6 | loss: 0.3786256
	speed: 0.1195s/iter; left time: 5287.6982s
	iters: 400, epoch: 6 | loss: 0.1103619
	speed: 0.1165s/iter; left time: 5144.2259s
Epoch: 6 cost time: 55.675997734069824
Epoch: 6, Steps: 469 | Train Loss: 0.405 Vali Loss: 0.365 Vali Acc: 0.901 Test Loss: 0.365 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0818971
	speed: 0.5096s/iter; left time: 22414.6917s
	iters: 200, epoch: 7 | loss: 0.9156660
	speed: 0.1366s/iter; left time: 5993.6993s
	iters: 300, epoch: 7 | loss: 0.8938632
	speed: 0.1230s/iter; left time: 5386.7035s
	iters: 400, epoch: 7 | loss: 0.1028106
	speed: 0.1295s/iter; left time: 5655.5456s
Epoch: 7 cost time: 60.21037578582764
Epoch: 7, Steps: 469 | Train Loss: 0.405 Vali Loss: 0.706 Vali Acc: 0.782 Test Loss: 0.706 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8142157
	speed: 0.4828s/iter; left time: 21011.9620s
	iters: 200, epoch: 8 | loss: 0.7478999
	speed: 0.1151s/iter; left time: 4999.1427s
	iters: 300, epoch: 8 | loss: 0.5066879
	speed: 0.1173s/iter; left time: 5079.7583s
	iters: 400, epoch: 8 | loss: 0.1919489
	speed: 0.1146s/iter; left time: 4951.0319s
Epoch: 8 cost time: 55.93572664260864
Epoch: 8, Steps: 469 | Train Loss: 0.465 Vali Loss: 0.469 Vali Acc: 0.882 Test Loss: 0.469 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5884271
	speed: 0.5104s/iter; left time: 21973.5625s
	iters: 200, epoch: 9 | loss: 0.3823366
	speed: 0.1416s/iter; left time: 6081.2140s
	iters: 300, epoch: 9 | loss: 0.2371916
	speed: 0.1265s/iter; left time: 5419.4650s
	iters: 400, epoch: 9 | loss: 0.2238951
	speed: 0.1311s/iter; left time: 5604.3602s
Epoch: 9 cost time: 62.454946756362915
Epoch: 9, Steps: 469 | Train Loss: 0.381 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.8772062
	speed: 0.5374s/iter; left time: 22882.8640s
	iters: 200, epoch: 10 | loss: 0.0839669
	speed: 0.1184s/iter; left time: 5027.9934s
	iters: 300, epoch: 10 | loss: 0.7190353
	speed: 0.1269s/iter; left time: 5375.9361s
	iters: 400, epoch: 10 | loss: 0.4647547
	speed: 0.1278s/iter; left time: 5401.9027s
Epoch: 10 cost time: 60.11869740486145
Epoch: 10, Steps: 469 | Train Loss: 0.460 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2810118
	speed: 0.4989s/iter; left time: 21008.1292s
	iters: 200, epoch: 11 | loss: 0.5794749
	speed: 0.1312s/iter; left time: 5513.3519s
	iters: 300, epoch: 11 | loss: 0.8570409
	speed: 0.1285s/iter; left time: 5386.8488s
	iters: 400, epoch: 11 | loss: 0.5159528
	speed: 0.1324s/iter; left time: 5536.7869s
Epoch: 11 cost time: 60.53185677528381
Epoch: 11, Steps: 469 | Train Loss: 0.596 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2018305
	speed: 0.5152s/iter; left time: 21454.0008s
	iters: 200, epoch: 12 | loss: 1.1163967
	speed: 0.1299s/iter; left time: 5396.3923s
	iters: 300, epoch: 12 | loss: 0.1932106
	speed: 0.1289s/iter; left time: 5343.6432s
	iters: 400, epoch: 12 | loss: 0.1532376
	speed: 0.1218s/iter; left time: 5034.3121s
Epoch: 12 cost time: 59.83003306388855
Epoch: 12, Steps: 469 | Train Loss: 0.395 Vali Loss: 0.685 Vali Acc: 0.767 Test Loss: 0.685 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9360240
	speed: 0.5184s/iter; left time: 21344.0869s
	iters: 200, epoch: 13 | loss: 0.4167121
	speed: 0.1415s/iter; left time: 5813.0526s
	iters: 300, epoch: 13 | loss: 0.3073415
	speed: 0.1183s/iter; left time: 4845.9010s
	iters: 400, epoch: 13 | loss: 0.1738208
	speed: 0.1367s/iter; left time: 5585.5744s
Epoch: 13 cost time: 62.81782865524292
Epoch: 13, Steps: 469 | Train Loss: 0.364 Vali Loss: 0.440 Vali Acc: 0.878 Test Loss: 0.440 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1241478
	speed: 0.5474s/iter; left time: 22279.3412s
	iters: 200, epoch: 14 | loss: 0.1627719
	speed: 0.1286s/iter; left time: 5219.7232s
	iters: 300, epoch: 14 | loss: 0.6163367
	speed: 0.1350s/iter; left time: 5468.9160s
	iters: 400, epoch: 14 | loss: 0.2452078
	speed: 0.1331s/iter; left time: 5377.2625s
Epoch: 14 cost time: 63.213155031204224
Epoch: 14, Steps: 469 | Train Loss: 0.322 Vali Loss: 0.367 Vali Acc: 0.905 Test Loss: 0.367 Test Acc: 0.905
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9251000571755289
model parameter : 10713158
model size : 45.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6138011
	speed: 0.1575s/iter; left time: 7373.0652s
	iters: 200, epoch: 1 | loss: 0.1619935
	speed: 0.1174s/iter; left time: 5483.1477s
	iters: 300, epoch: 1 | loss: 0.1436595
	speed: 0.1216s/iter; left time: 5667.0442s
	iters: 400, epoch: 1 | loss: 0.0143098
	speed: 0.1144s/iter; left time: 5320.9055s
Epoch: 1 cost time: 59.070064306259155
Epoch: 1, Steps: 469 | Train Loss: 0.455 Vali Loss: 0.870 Vali Acc: 0.781 Test Loss: 0.870 Test Acc: 0.781
Validation loss decreased (inf --> -0.781009).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0883776
	speed: 0.5186s/iter; left time: 24027.9697s
	iters: 200, epoch: 2 | loss: 0.0455528
	speed: 0.1219s/iter; left time: 5636.3510s
	iters: 300, epoch: 2 | loss: 0.1315484
	speed: 0.1264s/iter; left time: 5832.3684s
	iters: 400, epoch: 2 | loss: 0.5651472
	speed: 0.1146s/iter; left time: 5276.0529s
Epoch: 2 cost time: 58.3996319770813
Epoch: 2, Steps: 469 | Train Loss: 0.319 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.781009 --> -0.850194).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2100213
	speed: 0.5319s/iter; left time: 24392.3133s
	iters: 200, epoch: 3 | loss: 0.1810886
	speed: 0.1311s/iter; left time: 5999.6996s
	iters: 300, epoch: 3 | loss: 0.1286766
	speed: 0.1282s/iter; left time: 5855.6876s
	iters: 400, epoch: 3 | loss: 0.0375098
	speed: 0.1380s/iter; left time: 6288.4915s
Epoch: 3 cost time: 63.03492784500122
Epoch: 3, Steps: 469 | Train Loss: 0.298 Vali Loss: 0.510 Vali Acc: 0.840 Test Loss: 0.510 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0631103
	speed: 0.5533s/iter; left time: 25115.7724s
	iters: 200, epoch: 4 | loss: 0.4080083
	speed: 0.1360s/iter; left time: 6159.7735s
	iters: 300, epoch: 4 | loss: 0.3041476
	speed: 0.1328s/iter; left time: 5999.8391s
	iters: 400, epoch: 4 | loss: 0.1241510
	speed: 0.1201s/iter; left time: 5416.2729s
Epoch: 4 cost time: 61.9096519947052
Epoch: 4, Steps: 469 | Train Loss: 0.273 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
Validation loss decreased (-0.850194 --> -0.890791).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3364325
	speed: 0.4984s/iter; left time: 22392.0235s
	iters: 200, epoch: 5 | loss: 0.4317191
	speed: 0.1322s/iter; left time: 5925.3515s
	iters: 300, epoch: 5 | loss: 0.1401953
	speed: 0.1228s/iter; left time: 5493.6552s
	iters: 400, epoch: 5 | loss: 0.2748519
	speed: 0.1214s/iter; left time: 5419.3993s
Epoch: 5 cost time: 58.96277141571045
Epoch: 5, Steps: 469 | Train Loss: 0.246 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.890791 --> -0.900224).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1387789
	speed: 0.5367s/iter; left time: 23858.6310s
	iters: 200, epoch: 6 | loss: 0.0980879
	speed: 0.1347s/iter; left time: 5973.7944s
	iters: 300, epoch: 6 | loss: 0.0912350
	speed: 0.1380s/iter; left time: 6105.7492s
	iters: 400, epoch: 6 | loss: 0.0745210
	speed: 0.1275s/iter; left time: 5628.9329s
Epoch: 6 cost time: 62.234360218048096
Epoch: 6, Steps: 469 | Train Loss: 0.262 Vali Loss: 0.326 Vali Acc: 0.897 Test Loss: 0.326 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2376505
	speed: 0.5306s/iter; left time: 23341.1422s
	iters: 200, epoch: 7 | loss: 0.1276008
	speed: 0.1250s/iter; left time: 5485.5177s
	iters: 300, epoch: 7 | loss: 0.2045971
	speed: 0.1324s/iter; left time: 5797.4202s
	iters: 400, epoch: 7 | loss: 0.1609568
	speed: 0.1309s/iter; left time: 5717.9159s
Epoch: 7 cost time: 60.77145457267761
Epoch: 7, Steps: 469 | Train Loss: 0.237 Vali Loss: 0.318 Vali Acc: 0.905 Test Loss: 0.318 Test Acc: 0.905
Validation loss decreased (-0.900224 --> -0.904514).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3992696
	speed: 0.5229s/iter; left time: 22754.6870s
	iters: 200, epoch: 8 | loss: 0.2391203
	speed: 0.1302s/iter; left time: 5651.3105s
	iters: 300, epoch: 8 | loss: 0.1923443
	speed: 0.1329s/iter; left time: 5758.0976s
	iters: 400, epoch: 8 | loss: 0.1263156
	speed: 0.1340s/iter; left time: 5791.5184s
Epoch: 8 cost time: 62.102416038513184
Epoch: 8, Steps: 469 | Train Loss: 0.213 Vali Loss: 0.455 Vali Acc: 0.873 Test Loss: 0.455 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5441366
	speed: 0.5624s/iter; left time: 24209.8403s
	iters: 200, epoch: 9 | loss: 0.2591159
	speed: 0.1245s/iter; left time: 5348.6510s
	iters: 300, epoch: 9 | loss: 0.4767896
	speed: 0.1374s/iter; left time: 5886.3489s
	iters: 400, epoch: 9 | loss: 0.3989568
	speed: 0.1280s/iter; left time: 5473.2319s
Epoch: 9 cost time: 62.31121039390564
Epoch: 9, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.767 Vali Acc: 0.742 Test Loss: 0.767 Test Acc: 0.742
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1979091
	speed: 0.5709s/iter; left time: 24308.5408s
	iters: 200, epoch: 10 | loss: 0.1070199
	speed: 0.1548s/iter; left time: 6574.5732s
	iters: 300, epoch: 10 | loss: 0.1257127
	speed: 0.1311s/iter; left time: 5554.4914s
	iters: 400, epoch: 10 | loss: 0.0893496
	speed: 0.1339s/iter; left time: 5662.3413s
Epoch: 10 cost time: 65.84019374847412
Epoch: 10, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.427 Vali Acc: 0.895 Test Loss: 0.427 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2060414
	speed: 0.5324s/iter; left time: 22419.9155s
	iters: 200, epoch: 11 | loss: 0.0689784
	speed: 0.1367s/iter; left time: 5743.1720s
	iters: 300, epoch: 11 | loss: 0.0251956
	speed: 0.1383s/iter; left time: 5795.5035s
	iters: 400, epoch: 11 | loss: 0.0322738
	speed: 0.1282s/iter; left time: 5360.0122s
Epoch: 11 cost time: 64.65873456001282
Epoch: 11, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.904514 --> -0.948254).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1569247
	speed: 0.5426s/iter; left time: 22594.2024s
	iters: 200, epoch: 12 | loss: 0.2777205
	speed: 0.1128s/iter; left time: 4686.9519s
	iters: 300, epoch: 12 | loss: 0.1297980
	speed: 0.1295s/iter; left time: 5365.8353s
	iters: 400, epoch: 12 | loss: 0.0226878
	speed: 0.1183s/iter; left time: 4892.6898s
Epoch: 12 cost time: 58.882206439971924
Epoch: 12, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0030900
	speed: 0.5318s/iter; left time: 21897.4800s
	iters: 200, epoch: 13 | loss: 0.0018477
	speed: 0.1118s/iter; left time: 4592.8772s
	iters: 300, epoch: 13 | loss: 0.0096816
	speed: 0.1113s/iter; left time: 4560.4371s
	iters: 400, epoch: 13 | loss: 0.4069372
	speed: 0.1346s/iter; left time: 5502.0055s
Epoch: 13 cost time: 57.74339199066162
Epoch: 13, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0655371
	speed: 0.5329s/iter; left time: 21689.4015s
	iters: 200, epoch: 14 | loss: 0.0668007
	speed: 0.1234s/iter; left time: 5012.5065s
	iters: 300, epoch: 14 | loss: 0.4014515
	speed: 0.1311s/iter; left time: 5309.6746s
	iters: 400, epoch: 14 | loss: 0.2036641
	speed: 0.1300s/iter; left time: 5250.7242s
Epoch: 14 cost time: 60.81199836730957
Epoch: 14, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0738416
	speed: 0.5106s/iter; left time: 20543.7972s
	iters: 200, epoch: 15 | loss: 0.6960622
	speed: 0.1517s/iter; left time: 6087.5739s
	iters: 300, epoch: 15 | loss: 0.1280751
	speed: 0.1308s/iter; left time: 5236.3770s
	iters: 400, epoch: 15 | loss: 0.6828305
	speed: 0.1370s/iter; left time: 5472.2695s
Epoch: 15 cost time: 64.79082202911377
Epoch: 15, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0925426
	speed: 0.5110s/iter; left time: 20320.4322s
	iters: 200, epoch: 16 | loss: 0.0462106
	speed: 0.1192s/iter; left time: 4728.0952s
	iters: 300, epoch: 16 | loss: 0.0857032
	speed: 0.1278s/iter; left time: 5057.1754s
	iters: 400, epoch: 16 | loss: 0.0102987
	speed: 0.1234s/iter; left time: 4870.1170s
Epoch: 16 cost time: 58.85764932632446
Epoch: 16, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.340 Vali Acc: 0.907 Test Loss: 0.340 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1099936
	speed: 0.5347s/iter; left time: 21012.1409s
	iters: 200, epoch: 17 | loss: 0.0138829
	speed: 0.1198s/iter; left time: 4696.8686s
	iters: 300, epoch: 17 | loss: 0.0049155
	speed: 0.1224s/iter; left time: 4786.5259s
	iters: 400, epoch: 17 | loss: 0.1264988
	speed: 0.1360s/iter; left time: 5301.8437s
Epoch: 17 cost time: 60.56843829154968
Epoch: 17, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
Validation loss decreased (-0.948254 --> -0.955115).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0167514
	speed: 0.5404s/iter; left time: 20983.3163s
	iters: 200, epoch: 18 | loss: 0.1600187
	speed: 0.1387s/iter; left time: 5371.8017s
	iters: 300, epoch: 18 | loss: 0.0154207
	speed: 0.1301s/iter; left time: 5023.9089s
	iters: 400, epoch: 18 | loss: 0.0425916
	speed: 0.1513s/iter; left time: 5829.8168s
Epoch: 18 cost time: 64.34166765213013
Epoch: 18, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2697027
	speed: 0.5122s/iter; left time: 19645.9383s
	iters: 200, epoch: 19 | loss: 0.6148540
	speed: 0.1276s/iter; left time: 4882.9130s
	iters: 300, epoch: 19 | loss: 0.0078483
	speed: 0.1299s/iter; left time: 4958.3635s
	iters: 400, epoch: 19 | loss: 0.0257991
	speed: 0.1166s/iter; left time: 4436.8576s
Epoch: 19 cost time: 58.57030153274536
Epoch: 19, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0156247
	speed: 0.5178s/iter; left time: 19619.1233s
	iters: 200, epoch: 20 | loss: 0.3253484
	speed: 0.1325s/iter; left time: 5005.4468s
	iters: 300, epoch: 20 | loss: 0.0061234
	speed: 0.1364s/iter; left time: 5140.6883s
	iters: 400, epoch: 20 | loss: 0.0874635
	speed: 0.1345s/iter; left time: 5055.5378s
Epoch: 20 cost time: 62.94657349586487
Epoch: 20, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0706094
	speed: 0.5481s/iter; left time: 20512.3176s
	iters: 200, epoch: 21 | loss: 0.0366821
	speed: 0.1353s/iter; left time: 5050.4740s
	iters: 300, epoch: 21 | loss: 0.2934277
	speed: 0.1324s/iter; left time: 4929.1477s
	iters: 400, epoch: 21 | loss: 0.4053917
	speed: 0.1377s/iter; left time: 5112.6349s
Epoch: 21 cost time: 63.42574334144592
Epoch: 21, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.394 Vali Acc: 0.921 Test Loss: 0.394 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2317785
	speed: 0.5209s/iter; left time: 19249.3451s
	iters: 200, epoch: 22 | loss: 0.0414479
	speed: 0.1461s/iter; left time: 5383.6427s
	iters: 300, epoch: 22 | loss: 0.0438597
	speed: 0.1322s/iter; left time: 4858.2146s
	iters: 400, epoch: 22 | loss: 0.0509359
	speed: 0.1218s/iter; left time: 4463.8906s
Epoch: 22 cost time: 62.16062140464783
Epoch: 22, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.685 Vali Acc: 0.802 Test Loss: 0.685 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3862254
	speed: 0.4996s/iter; left time: 18227.8724s
	iters: 200, epoch: 23 | loss: 0.0512088
	speed: 0.1388s/iter; left time: 5051.7178s
	iters: 300, epoch: 23 | loss: 0.0893163
	speed: 0.1270s/iter; left time: 4608.0958s
	iters: 400, epoch: 23 | loss: 0.1497752
	speed: 0.1375s/iter; left time: 4973.7800s
Epoch: 23 cost time: 61.472238302230835
Epoch: 23, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.238 Vali Acc: 0.945 Test Loss: 0.238 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.4419815
	speed: 0.5350s/iter; left time: 19269.0365s
	iters: 200, epoch: 24 | loss: 0.6962902
	speed: 0.1407s/iter; left time: 5053.3757s
	iters: 300, epoch: 24 | loss: 0.2645713
	speed: 0.1307s/iter; left time: 4680.7905s
	iters: 400, epoch: 24 | loss: 0.0083535
	speed: 0.1550s/iter; left time: 5533.9143s
Epoch: 24 cost time: 65.20751953125
Epoch: 24, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.212 Vali Acc: 0.954 Test Loss: 0.212 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.5375354
	speed: 0.5358s/iter; left time: 19046.3170s
	iters: 200, epoch: 25 | loss: 0.0386964
	speed: 0.1447s/iter; left time: 5128.4478s
	iters: 300, epoch: 25 | loss: 0.0062399
	speed: 0.1195s/iter; left time: 4222.4974s
	iters: 400, epoch: 25 | loss: 0.0108057
	speed: 0.1380s/iter; left time: 4863.3211s
Epoch: 25 cost time: 62.50205969810486
Epoch: 25, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1112746
	speed: 0.5032s/iter; left time: 17651.5967s
	iters: 200, epoch: 26 | loss: 0.0094189
	speed: 0.1166s/iter; left time: 4078.2994s
	iters: 300, epoch: 26 | loss: 0.1234760
	speed: 0.1235s/iter; left time: 4306.6738s
	iters: 400, epoch: 26 | loss: 0.2291352
	speed: 0.1132s/iter; left time: 3937.2503s
Epoch: 26 cost time: 56.49756979942322
Epoch: 26, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.940 Test Loss: 0.265 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1162903
	speed: 0.5126s/iter; left time: 17738.1250s
	iters: 200, epoch: 27 | loss: 0.0449244
	speed: 0.1182s/iter; left time: 4080.4230s
	iters: 300, epoch: 27 | loss: 0.0184779
	speed: 0.1373s/iter; left time: 4723.4413s
	iters: 400, epoch: 27 | loss: 0.0056500
	speed: 0.1219s/iter; left time: 4182.7200s
Epoch: 27 cost time: 61.15693116188049
Epoch: 27, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.242 Vali Acc: 0.936 Test Loss: 0.242 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.955117209834191
model parameter : 10712134
model size : 45.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4215006
	speed: 0.1812s/iter; left time: 8480.4021s
	iters: 200, epoch: 1 | loss: 0.1486726
	speed: 0.1397s/iter; left time: 6523.5462s
	iters: 300, epoch: 1 | loss: 0.3321844
	speed: 0.1333s/iter; left time: 6211.2881s
	iters: 400, epoch: 1 | loss: 0.4551205
	speed: 0.1293s/iter; left time: 6012.0077s
Epoch: 1 cost time: 67.6558632850647
Epoch: 1, Steps: 469 | Train Loss: 0.473 Vali Loss: 0.529 Vali Acc: 0.855 Test Loss: 0.529 Test Acc: 0.855
Validation loss decreased (inf --> -0.855341).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6219759
	speed: 0.5424s/iter; left time: 25129.8188s
	iters: 200, epoch: 2 | loss: 0.2922985
	speed: 0.1297s/iter; left time: 5997.8724s
	iters: 300, epoch: 2 | loss: 0.1311100
	speed: 0.1183s/iter; left time: 5458.0929s
	iters: 400, epoch: 2 | loss: 0.0971113
	speed: 0.1333s/iter; left time: 6136.1526s
Epoch: 2 cost time: 61.48517990112305
Epoch: 2, Steps: 469 | Train Loss: 0.275 Vali Loss: 0.403 Vali Acc: 0.871 Test Loss: 0.403 Test Acc: 0.871
Validation loss decreased (-0.855341 --> -0.870779).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2046872
	speed: 0.5274s/iter; left time: 24187.3842s
	iters: 200, epoch: 3 | loss: 0.1739739
	speed: 0.1347s/iter; left time: 6165.0601s
	iters: 300, epoch: 3 | loss: 0.0535823
	speed: 0.1169s/iter; left time: 5339.0050s
	iters: 400, epoch: 3 | loss: 0.1607891
	speed: 0.1365s/iter; left time: 6219.5570s
Epoch: 3 cost time: 60.60261797904968
Epoch: 3, Steps: 469 | Train Loss: 0.259 Vali Loss: 0.419 Vali Acc: 0.883 Test Loss: 0.419 Test Acc: 0.883
Validation loss decreased (-0.870779 --> -0.883358).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1472207
	speed: 0.5181s/iter; left time: 23519.0885s
	iters: 200, epoch: 4 | loss: 1.5477024
	speed: 0.1209s/iter; left time: 5474.0234s
	iters: 300, epoch: 4 | loss: 0.8201653
	speed: 0.1334s/iter; left time: 6027.6286s
	iters: 400, epoch: 4 | loss: 1.0891944
	speed: 0.1169s/iter; left time: 5273.3720s
Epoch: 4 cost time: 58.52140712738037
Epoch: 4, Steps: 469 | Train Loss: 0.425 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1252437
	speed: 0.5659s/iter; left time: 25422.2103s
	iters: 200, epoch: 5 | loss: 0.8920016
	speed: 0.1390s/iter; left time: 6230.6850s
	iters: 300, epoch: 5 | loss: 0.7300664
	speed: 0.1623s/iter; left time: 7256.6580s
	iters: 400, epoch: 5 | loss: 1.0488698
	speed: 0.1320s/iter; left time: 5891.9556s
Epoch: 5 cost time: 71.9416892528534
Epoch: 5, Steps: 469 | Train Loss: 1.162 Vali Loss: 3.819 Vali Acc: 0.076 Test Loss: 3.819 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2939334
	speed: 0.5764s/iter; left time: 25623.5301s
	iters: 200, epoch: 6 | loss: 2.1313903
	speed: 0.1451s/iter; left time: 6437.4598s
	iters: 300, epoch: 6 | loss: 1.7547606
	speed: 0.1464s/iter; left time: 6480.5520s
	iters: 400, epoch: 6 | loss: 2.2823546
	speed: 0.1616s/iter; left time: 7134.4134s
Epoch: 6 cost time: 69.9485878944397
Epoch: 6, Steps: 469 | Train Loss: 2.228 Vali Loss: 2.167 Vali Acc: 0.170 Test Loss: 2.167 Test Acc: 0.170
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3266449
	speed: 0.5932s/iter; left time: 26094.8068s
	iters: 200, epoch: 7 | loss: 2.0877159
	speed: 0.1369s/iter; left time: 6008.0119s
	iters: 300, epoch: 7 | loss: 1.9030446
	speed: 0.1533s/iter; left time: 6714.2528s
	iters: 400, epoch: 7 | loss: 2.0381882
	speed: 0.1453s/iter; left time: 6349.8391s
Epoch: 7 cost time: 68.86239671707153
Epoch: 7, Steps: 469 | Train Loss: 2.105 Vali Loss: 2.250 Vali Acc: 0.174 Test Loss: 2.250 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.3305886
	speed: 0.6131s/iter; left time: 26679.6449s
	iters: 200, epoch: 8 | loss: 1.8652847
	speed: 0.1586s/iter; left time: 6887.4372s
	iters: 300, epoch: 8 | loss: 2.3249047
	speed: 0.1541s/iter; left time: 6675.5922s
	iters: 400, epoch: 8 | loss: 2.2723136
	speed: 0.1736s/iter; left time: 7503.9699s
Epoch: 8 cost time: 75.95360088348389
Epoch: 8, Steps: 469 | Train Loss: 2.235 Vali Loss: 2.307 Vali Acc: 0.097 Test Loss: 2.307 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3460774
	speed: 0.6253s/iter; left time: 26917.5485s
	iters: 200, epoch: 9 | loss: 2.3351645
	speed: 0.1329s/iter; left time: 5708.3028s
	iters: 300, epoch: 9 | loss: 2.3205166
	speed: 0.1624s/iter; left time: 6960.1616s
	iters: 400, epoch: 9 | loss: 2.2727945
	speed: 0.1518s/iter; left time: 6488.0087s
Epoch: 9 cost time: 69.62663769721985
Epoch: 9, Steps: 469 | Train Loss: 2.312 Vali Loss: 2.307 Vali Acc: 0.105 Test Loss: 2.307 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.3024647
	speed: 0.5709s/iter; left time: 24307.9460s
	iters: 200, epoch: 10 | loss: 2.2882659
	speed: 0.1368s/iter; left time: 5812.8940s
	iters: 300, epoch: 10 | loss: 2.1654775
	speed: 0.1342s/iter; left time: 5686.0534s
	iters: 400, epoch: 10 | loss: 2.3410425
	speed: 0.1410s/iter; left time: 5959.6341s
Epoch: 10 cost time: 65.08691811561584
Epoch: 10, Steps: 469 | Train Loss: 2.312 Vali Loss: 2.315 Vali Acc: 0.105 Test Loss: 2.315 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.3120022
	speed: 0.5363s/iter; left time: 22582.6944s
	iters: 200, epoch: 11 | loss: 2.3379142
	speed: 0.1190s/iter; left time: 5000.8880s
	iters: 300, epoch: 11 | loss: 2.2849064
	speed: 0.1213s/iter; left time: 5085.8766s
	iters: 400, epoch: 11 | loss: 2.3158453
	speed: 0.1189s/iter; left time: 4970.4956s
Epoch: 11 cost time: 57.63917279243469
Epoch: 11, Steps: 469 | Train Loss: 2.306 Vali Loss: 2.307 Vali Acc: 0.097 Test Loss: 2.307 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.3198807
	speed: 0.4832s/iter; left time: 20122.5298s
	iters: 200, epoch: 12 | loss: 2.3539929
	speed: 0.1200s/iter; left time: 4985.5532s
	iters: 300, epoch: 12 | loss: 2.3069689
	speed: 0.1215s/iter; left time: 5036.3536s
	iters: 400, epoch: 12 | loss: 2.3524396
	speed: 0.1294s/iter; left time: 5351.3179s
Epoch: 12 cost time: 58.055537700653076
Epoch: 12, Steps: 469 | Train Loss: 2.305 Vali Loss: 2.305 Vali Acc: 0.105 Test Loss: 2.305 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.3008301
	speed: 0.5254s/iter; left time: 21630.2399s
	iters: 200, epoch: 13 | loss: 2.3428781
	speed: 0.1298s/iter; left time: 5331.6788s
	iters: 300, epoch: 13 | loss: 2.2906342
	speed: 0.1264s/iter; left time: 5180.5192s
	iters: 400, epoch: 13 | loss: 2.3101428
	speed: 0.1296s/iter; left time: 5295.8869s
Epoch: 13 cost time: 61.64367437362671
Epoch: 13, Steps: 469 | Train Loss: 2.305 Vali Loss: 2.301 Vali Acc: 0.104 Test Loss: 2.301 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8833619210977701
model parameter : 10124230
model size : 43.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5276335
	speed: 0.2090s/iter; left time: 9782.0461s
	iters: 200, epoch: 1 | loss: 0.4360305
	speed: 0.1644s/iter; left time: 7675.7623s
	iters: 300, epoch: 1 | loss: 0.5341576
	speed: 0.1493s/iter; left time: 6957.7084s
	iters: 400, epoch: 1 | loss: 0.2593509
	speed: 0.1367s/iter; left time: 6355.9558s
Epoch: 1 cost time: 75.87121558189392
Epoch: 1, Steps: 469 | Train Loss: 0.470 Vali Loss: 0.736 Vali Acc: 0.804 Test Loss: 0.736 Test Acc: 0.804
Validation loss decreased (inf --> -0.804166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1762067
	speed: 0.5948s/iter; left time: 27558.7506s
	iters: 200, epoch: 2 | loss: 0.3604447
	speed: 0.1465s/iter; left time: 6771.0806s
	iters: 300, epoch: 2 | loss: 0.2965594
	speed: 0.1501s/iter; left time: 6922.2484s
	iters: 400, epoch: 2 | loss: 0.3828853
	speed: 0.1413s/iter; left time: 6504.4909s
Epoch: 2 cost time: 70.44153833389282
Epoch: 2, Steps: 469 | Train Loss: 0.293 Vali Loss: 0.433 Vali Acc: 0.887 Test Loss: 0.433 Test Acc: 0.887
Validation loss decreased (-0.804166 --> -0.887074).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3440390
	speed: 0.6396s/iter; left time: 29336.0945s
	iters: 200, epoch: 3 | loss: 0.0265453
	speed: 0.1437s/iter; left time: 6578.3142s
	iters: 300, epoch: 3 | loss: 0.0585864
	speed: 0.1392s/iter; left time: 6355.1701s
	iters: 400, epoch: 3 | loss: 0.3006855
	speed: 0.1396s/iter; left time: 6359.8623s
Epoch: 3 cost time: 70.3299081325531
Epoch: 3, Steps: 469 | Train Loss: 0.281 Vali Loss: 0.405 Vali Acc: 0.865 Test Loss: 0.405 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1565465
	speed: 0.6170s/iter; left time: 28009.1250s
	iters: 200, epoch: 4 | loss: 0.0973876
	speed: 0.1627s/iter; left time: 7368.8937s
	iters: 300, epoch: 4 | loss: 0.1499719
	speed: 0.1555s/iter; left time: 7027.9013s
	iters: 400, epoch: 4 | loss: 0.3952580
	speed: 0.1583s/iter; left time: 7138.8647s
Epoch: 4 cost time: 74.43770670890808
Epoch: 4, Steps: 469 | Train Loss: 0.366 Vali Loss: 0.516 Vali Acc: 0.846 Test Loss: 0.516 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3158447
	speed: 0.6721s/iter; left time: 30195.4505s
	iters: 200, epoch: 5 | loss: 0.5067576
	speed: 0.1607s/iter; left time: 7202.3451s
	iters: 300, epoch: 5 | loss: 0.3411091
	speed: 0.1215s/iter; left time: 5433.3273s
	iters: 400, epoch: 5 | loss: 1.1106274
	speed: 0.1377s/iter; left time: 6147.0198s
Epoch: 5 cost time: 69.81671285629272
Epoch: 5, Steps: 469 | Train Loss: 0.706 Vali Loss: 0.655 Vali Acc: 0.788 Test Loss: 0.655 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6683838
	speed: 0.5806s/iter; left time: 25809.4084s
	iters: 200, epoch: 6 | loss: 0.7689960
	speed: 0.1299s/iter; left time: 5761.6345s
	iters: 300, epoch: 6 | loss: 0.3190684
	speed: 0.1406s/iter; left time: 6222.0026s
	iters: 400, epoch: 6 | loss: 1.3362077
	speed: 0.1452s/iter; left time: 6412.6168s
Epoch: 6 cost time: 66.20214200019836
Epoch: 6, Steps: 469 | Train Loss: 0.809 Vali Loss: 0.846 Vali Acc: 0.705 Test Loss: 0.846 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7417860
	speed: 0.5958s/iter; left time: 26209.5154s
	iters: 200, epoch: 7 | loss: 1.2799307
	speed: 0.1491s/iter; left time: 6543.5041s
	iters: 300, epoch: 7 | loss: 0.7042893
	speed: 0.1417s/iter; left time: 6203.1623s
	iters: 400, epoch: 7 | loss: 0.8091142
	speed: 0.1375s/iter; left time: 6008.5426s
Epoch: 7 cost time: 68.43161630630493
Epoch: 7, Steps: 469 | Train Loss: 1.095 Vali Loss: 0.984 Vali Acc: 0.645 Test Loss: 0.984 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7621655
	speed: 0.6194s/iter; left time: 26954.3707s
	iters: 200, epoch: 8 | loss: 0.4605992
	speed: 0.1532s/iter; left time: 6652.4839s
	iters: 300, epoch: 8 | loss: 0.2016476
	speed: 0.1571s/iter; left time: 6803.1619s
	iters: 400, epoch: 8 | loss: 0.7337862
	speed: 0.1652s/iter; left time: 7139.0986s
Epoch: 8 cost time: 73.1237940788269
Epoch: 8, Steps: 469 | Train Loss: 0.762 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.3330067
	speed: 0.5733s/iter; left time: 24680.1322s
	iters: 200, epoch: 9 | loss: 0.8976404
	speed: 0.1567s/iter; left time: 6729.9931s
	iters: 300, epoch: 9 | loss: 0.1270604
	speed: 0.1634s/iter; left time: 7003.3285s
	iters: 400, epoch: 9 | loss: 0.7900050
	speed: 0.1645s/iter; left time: 7031.8828s
Epoch: 9 cost time: 74.92890286445618
Epoch: 9, Steps: 469 | Train Loss: 0.504 Vali Loss: 1.015 Vali Acc: 0.727 Test Loss: 1.015 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3236696
	speed: 0.6361s/iter; left time: 27083.2149s
	iters: 200, epoch: 10 | loss: 0.3123842
	speed: 0.1830s/iter; left time: 7773.8474s
	iters: 300, epoch: 10 | loss: 0.3159633
	speed: 0.1834s/iter; left time: 7774.5928s
	iters: 400, epoch: 10 | loss: 0.6959240
	speed: 0.1808s/iter; left time: 7644.8699s
Epoch: 10 cost time: 81.92687749862671
Epoch: 10, Steps: 469 | Train Loss: 0.470 Vali Loss: 0.914 Vali Acc: 0.731 Test Loss: 0.914 Test Acc: 0.731
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1461045
	speed: 0.6333s/iter; left time: 26670.5487s
	iters: 200, epoch: 11 | loss: 0.4300636
	speed: 0.1612s/iter; left time: 6770.6095s
	iters: 300, epoch: 11 | loss: 0.4949712
	speed: 0.1530s/iter; left time: 6413.8201s
	iters: 400, epoch: 11 | loss: 0.5393456
	speed: 0.1529s/iter; left time: 6392.7938s
Epoch: 11 cost time: 74.31270813941956
Epoch: 11, Steps: 469 | Train Loss: 0.439 Vali Loss: 0.568 Vali Acc: 0.801 Test Loss: 0.568 Test Acc: 0.801
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.0301249
	speed: 0.6228s/iter; left time: 25934.8185s
	iters: 200, epoch: 12 | loss: 0.5001082
	speed: 0.1492s/iter; left time: 6199.4639s
	iters: 300, epoch: 12 | loss: 0.2535380
	speed: 0.1493s/iter; left time: 6186.0823s
	iters: 400, epoch: 12 | loss: 1.3958728
	speed: 0.1621s/iter; left time: 6699.9980s
Epoch: 12 cost time: 73.33085441589355
Epoch: 12, Steps: 469 | Train Loss: 0.534 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8870783304745569
model parameter : 10123206
model size : 43.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6361263
	speed: 0.1603s/iter; left time: 7500.7420s
	iters: 200, epoch: 1 | loss: 0.5520109
	speed: 0.1276s/iter; left time: 5959.8199s
	iters: 300, epoch: 1 | loss: 0.2032399
	speed: 0.1289s/iter; left time: 6008.5602s
	iters: 400, epoch: 1 | loss: 0.3841472
	speed: 0.1353s/iter; left time: 6293.6357s
Epoch: 1 cost time: 64.01644802093506
Epoch: 1, Steps: 469 | Train Loss: 0.460 Vali Loss: 0.354 Vali Acc: 0.885 Test Loss: 0.354 Test Acc: 0.885
Validation loss decreased (inf --> -0.884502).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2672791
	speed: 0.5356s/iter; left time: 24815.7593s
	iters: 200, epoch: 2 | loss: 0.0868772
	speed: 0.1294s/iter; left time: 5982.9449s
	iters: 300, epoch: 2 | loss: 0.4721263
	speed: 0.1150s/iter; left time: 5303.3874s
	iters: 400, epoch: 2 | loss: 0.4956112
	speed: 0.1317s/iter; left time: 6061.2770s
Epoch: 2 cost time: 60.5105254650116
Epoch: 2, Steps: 469 | Train Loss: 0.291 Vali Loss: 0.482 Vali Acc: 0.864 Test Loss: 0.482 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1042229
	speed: 0.5158s/iter; left time: 23655.9396s
	iters: 200, epoch: 3 | loss: 0.0394545
	speed: 0.1194s/iter; left time: 5465.7973s
	iters: 300, epoch: 3 | loss: 0.1551183
	speed: 0.1334s/iter; left time: 6092.9210s
	iters: 400, epoch: 3 | loss: 0.5428554
	speed: 0.1345s/iter; left time: 6126.5560s
Epoch: 3 cost time: 60.25656533241272
Epoch: 3, Steps: 469 | Train Loss: 0.261 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.884502 --> -0.889361).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1165851
	speed: 0.5279s/iter; left time: 23962.7995s
	iters: 200, epoch: 4 | loss: 0.3153297
	speed: 0.1341s/iter; left time: 6075.9686s
	iters: 300, epoch: 4 | loss: 0.4900095
	speed: 0.1347s/iter; left time: 6085.7388s
	iters: 400, epoch: 4 | loss: 0.1288852
	speed: 0.1411s/iter; left time: 6364.3050s
Epoch: 4 cost time: 63.62953996658325
Epoch: 4, Steps: 469 | Train Loss: 0.300 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.889361 --> -0.917378).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3139434
	speed: 0.5601s/iter; left time: 25162.1994s
	iters: 200, epoch: 5 | loss: 0.7845242
	speed: 0.1357s/iter; left time: 6081.2640s
	iters: 300, epoch: 5 | loss: 0.8063051
	speed: 0.1481s/iter; left time: 6622.6814s
	iters: 400, epoch: 5 | loss: 0.4310473
	speed: 0.1421s/iter; left time: 6342.4741s
Epoch: 5 cost time: 67.08756875991821
Epoch: 5, Steps: 469 | Train Loss: 0.395 Vali Loss: 0.424 Vali Acc: 0.882 Test Loss: 0.424 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4644970
	speed: 0.5340s/iter; left time: 23740.0612s
	iters: 200, epoch: 6 | loss: 0.7013992
	speed: 0.1246s/iter; left time: 5526.0594s
	iters: 300, epoch: 6 | loss: 0.4265253
	speed: 0.1344s/iter; left time: 5946.6098s
	iters: 400, epoch: 6 | loss: 0.2565328
	speed: 0.1295s/iter; left time: 5719.9324s
Epoch: 6 cost time: 61.06617331504822
Epoch: 6, Steps: 469 | Train Loss: 0.546 Vali Loss: 0.814 Vali Acc: 0.757 Test Loss: 0.814 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0519476
	speed: 0.5201s/iter; left time: 22879.6532s
	iters: 200, epoch: 7 | loss: 0.6049637
	speed: 0.1218s/iter; left time: 5345.4388s
	iters: 300, epoch: 7 | loss: 0.6094460
	speed: 0.1405s/iter; left time: 6152.7346s
	iters: 400, epoch: 7 | loss: 0.1730190
	speed: 0.1317s/iter; left time: 5754.5269s
Epoch: 7 cost time: 61.95014238357544
Epoch: 7, Steps: 469 | Train Loss: 0.586 Vali Loss: 0.537 Vali Acc: 0.820 Test Loss: 0.537 Test Acc: 0.820
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1169225
	speed: 0.5468s/iter; left time: 23797.3321s
	iters: 200, epoch: 8 | loss: 0.1893713
	speed: 0.1296s/iter; left time: 5628.8471s
	iters: 300, epoch: 8 | loss: 0.3284786
	speed: 0.1340s/iter; left time: 5804.7964s
	iters: 400, epoch: 8 | loss: 0.4520977
	speed: 0.1388s/iter; left time: 5997.3028s
Epoch: 8 cost time: 66.2708215713501
Epoch: 8, Steps: 469 | Train Loss: 0.405 Vali Loss: 0.910 Vali Acc: 0.764 Test Loss: 0.910 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6335176
	speed: 0.5909s/iter; left time: 25438.6911s
	iters: 200, epoch: 9 | loss: 0.4235599
	speed: 0.1524s/iter; left time: 6545.2686s
	iters: 300, epoch: 9 | loss: 0.5938431
	speed: 0.1458s/iter; left time: 6245.4122s
	iters: 400, epoch: 9 | loss: 0.3772294
	speed: 0.1374s/iter; left time: 5874.2270s
Epoch: 9 cost time: 68.71079111099243
Epoch: 9, Steps: 469 | Train Loss: 0.457 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2643983
	speed: 0.5018s/iter; left time: 21364.9126s
	iters: 200, epoch: 10 | loss: 0.4087511
	speed: 0.1293s/iter; left time: 5491.3186s
	iters: 300, epoch: 10 | loss: 0.5240200
	speed: 0.1419s/iter; left time: 6012.4885s
	iters: 400, epoch: 10 | loss: 0.8572646
	speed: 0.1357s/iter; left time: 5736.9461s
Epoch: 10 cost time: 64.46748971939087
Epoch: 10, Steps: 469 | Train Loss: 0.483 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3100472
	speed: 0.6034s/iter; left time: 25408.1545s
	iters: 200, epoch: 11 | loss: 0.3218481
	speed: 0.1371s/iter; left time: 5761.7147s
	iters: 300, epoch: 11 | loss: 0.2702814
	speed: 0.1483s/iter; left time: 6216.8244s
	iters: 400, epoch: 11 | loss: 1.0412827
	speed: 0.1390s/iter; left time: 5810.4031s
Epoch: 11 cost time: 66.74209666252136
Epoch: 11, Steps: 469 | Train Loss: 0.504 Vali Loss: 0.787 Vali Acc: 0.770 Test Loss: 0.787 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7363951
	speed: 0.5938s/iter; left time: 24727.5019s
	iters: 200, epoch: 12 | loss: 0.4835650
	speed: 0.1607s/iter; left time: 6674.2068s
	iters: 300, epoch: 12 | loss: 1.1407086
	speed: 0.1544s/iter; left time: 6396.7538s
	iters: 400, epoch: 12 | loss: 0.1312856
	speed: 0.1446s/iter; left time: 5976.5401s
Epoch: 12 cost time: 72.98118996620178
Epoch: 12, Steps: 469 | Train Loss: 0.402 Vali Loss: 0.657 Vali Acc: 0.815 Test Loss: 0.657 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9488654
	speed: 0.6659s/iter; left time: 27415.4377s
	iters: 200, epoch: 13 | loss: 0.5594781
	speed: 0.1837s/iter; left time: 7545.5185s
	iters: 300, epoch: 13 | loss: 0.3832235
	speed: 0.1860s/iter; left time: 7621.8316s
	iters: 400, epoch: 13 | loss: 0.1784199
	speed: 0.1679s/iter; left time: 6862.2308s
Epoch: 13 cost time: 82.1865713596344
Epoch: 13, Steps: 469 | Train Loss: 0.383 Vali Loss: 0.353 Vali Acc: 0.909 Test Loss: 0.353 Test Acc: 0.909
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6037501
	speed: 0.6397s/iter; left time: 26038.4464s
	iters: 200, epoch: 14 | loss: 0.7572173
	speed: 0.1672s/iter; left time: 6788.7028s
	iters: 300, epoch: 14 | loss: 0.5282929
	speed: 0.1364s/iter; left time: 5525.0526s
	iters: 400, epoch: 14 | loss: 0.2537706
	speed: 0.1616s/iter; left time: 6528.3568s
Epoch: 14 cost time: 74.93932485580444
Epoch: 14, Steps: 469 | Train Loss: 0.416 Vali Loss: 0.404 Vali Acc: 0.880 Test Loss: 0.404 Test Acc: 0.880
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9173813607775871
model parameter : 10122182
model size : 43.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2151746
	speed: 0.1673s/iter; left time: 7831.9001s
	iters: 200, epoch: 1 | loss: 0.3072914
	speed: 0.1317s/iter; left time: 6150.7158s
	iters: 300, epoch: 1 | loss: 0.1245217
	speed: 0.1300s/iter; left time: 6060.3032s
	iters: 400, epoch: 1 | loss: 0.1460021
	speed: 0.1294s/iter; left time: 6016.2568s
Epoch: 1 cost time: 66.55962586402893
Epoch: 1, Steps: 469 | Train Loss: 0.484 Vali Loss: 0.356 Vali Acc: 0.886 Test Loss: 0.356 Test Acc: 0.886
Validation loss decreased (inf --> -0.885931).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0989196
	speed: 0.6098s/iter; left time: 28252.9771s
	iters: 200, epoch: 2 | loss: 0.3118385
	speed: 0.1441s/iter; left time: 6664.1875s
	iters: 300, epoch: 2 | loss: 0.2468646
	speed: 0.1377s/iter; left time: 6352.5502s
	iters: 400, epoch: 2 | loss: 0.4606084
	speed: 0.1483s/iter; left time: 6825.4564s
Epoch: 2 cost time: 68.59315919876099
Epoch: 2, Steps: 469 | Train Loss: 0.298 Vali Loss: 0.514 Vali Acc: 0.831 Test Loss: 0.514 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1944798
	speed: 0.6436s/iter; left time: 29519.5751s
	iters: 200, epoch: 3 | loss: 0.1977867
	speed: 0.1659s/iter; left time: 7593.3974s
	iters: 300, epoch: 3 | loss: 0.1831909
	speed: 0.1695s/iter; left time: 7738.3575s
	iters: 400, epoch: 3 | loss: 0.7810724
	speed: 0.1528s/iter; left time: 6961.3411s
Epoch: 3 cost time: 76.5381429195404
Epoch: 3, Steps: 469 | Train Loss: 0.264 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
Validation loss decreased (-0.885931 --> -0.906229).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0709735
	speed: 0.6609s/iter; left time: 30000.3303s
	iters: 200, epoch: 4 | loss: 0.0869566
	speed: 0.1571s/iter; left time: 7115.8058s
	iters: 300, epoch: 4 | loss: 0.6338129
	speed: 0.1414s/iter; left time: 6389.3283s
	iters: 400, epoch: 4 | loss: 0.1468402
	speed: 0.1487s/iter; left time: 6705.7109s
Epoch: 4 cost time: 71.10095715522766
Epoch: 4, Steps: 469 | Train Loss: 0.261 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0554265
	speed: 0.5884s/iter; left time: 26435.9901s
	iters: 200, epoch: 5 | loss: 0.2244627
	speed: 0.1401s/iter; left time: 6281.5094s
	iters: 300, epoch: 5 | loss: 0.4903832
	speed: 0.1350s/iter; left time: 6035.8981s
	iters: 400, epoch: 5 | loss: 0.4280732
	speed: 0.1420s/iter; left time: 6335.9301s
Epoch: 5 cost time: 65.1542420387268
Epoch: 5, Steps: 469 | Train Loss: 0.258 Vali Loss: 0.319 Vali Acc: 0.901 Test Loss: 0.319 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2820514
	speed: 0.5784s/iter; left time: 25711.6260s
	iters: 200, epoch: 6 | loss: 0.3768405
	speed: 0.1347s/iter; left time: 5976.5473s
	iters: 300, epoch: 6 | loss: 0.7558864
	speed: 0.1311s/iter; left time: 5801.3048s
	iters: 400, epoch: 6 | loss: 0.0211415
	speed: 0.1419s/iter; left time: 6263.8528s
Epoch: 6 cost time: 62.53719091415405
Epoch: 6, Steps: 469 | Train Loss: 0.244 Vali Loss: 0.449 Vali Acc: 0.886 Test Loss: 0.449 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3517213
	speed: 0.5639s/iter; left time: 24803.2915s
	iters: 200, epoch: 7 | loss: 0.0658615
	speed: 0.1396s/iter; left time: 6124.8432s
	iters: 300, epoch: 7 | loss: 0.0291351
	speed: 0.1637s/iter; left time: 7169.6864s
	iters: 400, epoch: 7 | loss: 0.7068014
	speed: 0.1451s/iter; left time: 6336.9494s
Epoch: 7 cost time: 70.40141987800598
Epoch: 7, Steps: 469 | Train Loss: 0.238 Vali Loss: 0.273 Vali Acc: 0.929 Test Loss: 0.273 Test Acc: 0.929
Validation loss decreased (-0.906229 --> -0.929100).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1900549
	speed: 0.6330s/iter; left time: 27548.6517s
	iters: 200, epoch: 8 | loss: 0.7968379
	speed: 0.1432s/iter; left time: 6216.3805s
	iters: 300, epoch: 8 | loss: 0.0421298
	speed: 0.1475s/iter; left time: 6387.3563s
	iters: 400, epoch: 8 | loss: 0.0183969
	speed: 0.1305s/iter; left time: 5639.5075s
Epoch: 8 cost time: 66.24221420288086
Epoch: 8, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.342 Vali Acc: 0.924 Test Loss: 0.342 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0234537
	speed: 0.5841s/iter; left time: 25143.3270s
	iters: 200, epoch: 9 | loss: 0.0103882
	speed: 0.1304s/iter; left time: 5600.4358s
	iters: 300, epoch: 9 | loss: 0.3556210
	speed: 0.1432s/iter; left time: 6138.1146s
	iters: 400, epoch: 9 | loss: 0.1772133
	speed: 0.1235s/iter; left time: 5277.8595s
Epoch: 9 cost time: 64.8502504825592
Epoch: 9, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.432 Vali Acc: 0.888 Test Loss: 0.432 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0756066
	speed: 0.6432s/iter; left time: 27387.2587s
	iters: 200, epoch: 10 | loss: 0.0187670
	speed: 0.1348s/iter; left time: 5727.1910s
	iters: 300, epoch: 10 | loss: 0.0050176
	speed: 0.1347s/iter; left time: 5709.0541s
	iters: 400, epoch: 10 | loss: 0.0763673
	speed: 0.1321s/iter; left time: 5583.4062s
Epoch: 10 cost time: 64.81298470497131
Epoch: 10, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1133733
	speed: 0.5760s/iter; left time: 24257.9138s
	iters: 200, epoch: 11 | loss: 0.0050427
	speed: 0.1317s/iter; left time: 5534.5666s
	iters: 300, epoch: 11 | loss: 0.0415505
	speed: 0.1380s/iter; left time: 5785.6478s
	iters: 400, epoch: 11 | loss: 0.0471060
	speed: 0.1370s/iter; left time: 5727.3006s
Epoch: 11 cost time: 65.78416681289673
Epoch: 11, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.366 Vali Acc: 0.923 Test Loss: 0.366 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1670809
	speed: 0.5510s/iter; left time: 22946.6159s
	iters: 200, epoch: 12 | loss: 0.0071594
	speed: 0.1242s/iter; left time: 5157.5105s
	iters: 300, epoch: 12 | loss: 0.0609560
	speed: 0.1423s/iter; left time: 5896.3310s
	iters: 400, epoch: 12 | loss: 0.1792565
	speed: 0.1439s/iter; left time: 5948.6573s
Epoch: 12 cost time: 64.60689163208008
Epoch: 12, Steps: 469 | Train Loss: 0.186 Vali Loss: 0.277 Vali Acc: 0.914 Test Loss: 0.277 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0619196
	speed: 0.6011s/iter; left time: 24749.7023s
	iters: 200, epoch: 13 | loss: 0.1286376
	speed: 0.1659s/iter; left time: 6812.3905s
	iters: 300, epoch: 13 | loss: 0.1134781
	speed: 0.1515s/iter; left time: 6207.8227s
	iters: 400, epoch: 13 | loss: 0.0354040
	speed: 0.1417s/iter; left time: 5790.9175s
Epoch: 13 cost time: 71.42867732048035
Epoch: 13, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.476 Vali Acc: 0.876 Test Loss: 0.476 Test Acc: 0.876
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0769090
	speed: 0.5846s/iter; left time: 23795.4571s
	iters: 200, epoch: 14 | loss: 0.2537625
	speed: 0.1378s/iter; left time: 5594.7622s
	iters: 300, epoch: 14 | loss: 0.0215116
	speed: 0.1410s/iter; left time: 5710.3920s
	iters: 400, epoch: 14 | loss: 0.0112949
	speed: 0.1315s/iter; left time: 5313.0601s
Epoch: 14 cost time: 65.81456637382507
Epoch: 14, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1683742
	speed: 0.5679s/iter; left time: 22849.4085s
	iters: 200, epoch: 15 | loss: 0.0197778
	speed: 0.1494s/iter; left time: 5997.0368s
	iters: 300, epoch: 15 | loss: 0.0341656
	speed: 0.1346s/iter; left time: 5388.0530s
	iters: 400, epoch: 15 | loss: 0.0373443
	speed: 0.1308s/iter; left time: 5221.8414s
Epoch: 15 cost time: 64.53612446784973
Epoch: 15, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.929100 --> -0.953114).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1186773
	speed: 0.5667s/iter; left time: 22534.8002s
	iters: 200, epoch: 16 | loss: 0.5366880
	speed: 0.1356s/iter; left time: 5378.8255s
	iters: 300, epoch: 16 | loss: 0.3292722
	speed: 0.1281s/iter; left time: 5069.4162s
	iters: 400, epoch: 16 | loss: 0.1688697
	speed: 0.1512s/iter; left time: 5967.6176s
Epoch: 16 cost time: 63.50395679473877
Epoch: 16, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0331245
	speed: 0.5838s/iter; left time: 22940.4227s
	iters: 200, epoch: 17 | loss: 0.0130810
	speed: 0.1382s/iter; left time: 5416.5834s
	iters: 300, epoch: 17 | loss: 0.3939008
	speed: 0.1236s/iter; left time: 4833.3168s
	iters: 400, epoch: 17 | loss: 0.0198423
	speed: 0.1277s/iter; left time: 4980.8542s
Epoch: 17 cost time: 61.32601308822632
Epoch: 17, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0304506
	speed: 0.5615s/iter; left time: 21801.9016s
	iters: 200, epoch: 18 | loss: 0.0142681
	speed: 0.1376s/iter; left time: 5329.3928s
	iters: 300, epoch: 18 | loss: 0.5902426
	speed: 0.1345s/iter; left time: 5197.3867s
	iters: 400, epoch: 18 | loss: 0.7940197
	speed: 0.1355s/iter; left time: 5222.4093s
Epoch: 18 cost time: 64.60796666145325
Epoch: 18, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0659365
	speed: 0.5674s/iter; left time: 21765.2535s
	iters: 200, epoch: 19 | loss: 0.0233525
	speed: 0.1290s/iter; left time: 4934.6319s
	iters: 300, epoch: 19 | loss: 0.0193971
	speed: 0.1419s/iter; left time: 5415.1474s
	iters: 400, epoch: 19 | loss: 0.4343353
	speed: 0.1263s/iter; left time: 4806.6424s
Epoch: 19 cost time: 62.44017505645752
Epoch: 19, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2547334
	speed: 0.6016s/iter; left time: 22795.4698s
	iters: 200, epoch: 20 | loss: 0.1700741
	speed: 0.1414s/iter; left time: 5344.0718s
	iters: 300, epoch: 20 | loss: 0.1088817
	speed: 0.1387s/iter; left time: 5228.2603s
	iters: 400, epoch: 20 | loss: 0.2800080
	speed: 0.1433s/iter; left time: 5388.2226s
Epoch: 20 cost time: 66.42661118507385
Epoch: 20, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0155892
	speed: 0.5686s/iter; left time: 21278.4033s
	iters: 200, epoch: 21 | loss: 0.1031880
	speed: 0.1197s/iter; left time: 4467.9079s
	iters: 300, epoch: 21 | loss: 0.0925129
	speed: 0.1261s/iter; left time: 4691.8554s
	iters: 400, epoch: 21 | loss: 0.0252757
	speed: 0.1199s/iter; left time: 4449.2653s
Epoch: 21 cost time: 61.05358386039734
Epoch: 21, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1815891
	speed: 0.5766s/iter; left time: 21306.5130s
	iters: 200, epoch: 22 | loss: 0.0299066
	speed: 0.1273s/iter; left time: 4692.1593s
	iters: 300, epoch: 22 | loss: 0.0162218
	speed: 0.1290s/iter; left time: 4739.2335s
	iters: 400, epoch: 22 | loss: 0.0538803
	speed: 0.1243s/iter; left time: 4557.6472s
Epoch: 22 cost time: 60.593438386917114
Epoch: 22, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0393984
	speed: 0.5656s/iter; left time: 20634.7070s
	iters: 200, epoch: 23 | loss: 0.0196949
	speed: 0.1393s/iter; left time: 5067.5289s
	iters: 300, epoch: 23 | loss: 0.2734947
	speed: 0.1244s/iter; left time: 4513.1550s
	iters: 400, epoch: 23 | loss: 0.1776264
	speed: 0.1212s/iter; left time: 4385.3084s
Epoch: 23 cost time: 61.66387915611267
Epoch: 23, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.3313318
	speed: 0.5897s/iter; left time: 21235.7803s
	iters: 200, epoch: 24 | loss: 0.0747784
	speed: 0.1383s/iter; left time: 4967.6780s
	iters: 300, epoch: 24 | loss: 0.1109490
	speed: 0.1430s/iter; left time: 5120.9445s
	iters: 400, epoch: 24 | loss: 0.1363881
	speed: 0.1574s/iter; left time: 5622.9616s
Epoch: 24 cost time: 66.91481280326843
Epoch: 24, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.338 Vali Acc: 0.908 Test Loss: 0.338 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0238414
	speed: 0.6109s/iter; left time: 21715.4244s
	iters: 200, epoch: 25 | loss: 0.2131960
	speed: 0.1283s/iter; left time: 4547.1913s
	iters: 300, epoch: 25 | loss: 0.0258723
	speed: 0.1388s/iter; left time: 4907.2027s
	iters: 400, epoch: 25 | loss: 0.0186057
	speed: 0.1416s/iter; left time: 4989.6114s
Epoch: 25 cost time: 65.88580894470215
Epoch: 25, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9531160663236135
model parameter : 10121158
model size : 43.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3933075
	speed: 0.1645s/iter; left time: 7697.2855s
	iters: 200, epoch: 1 | loss: 0.5817830
	speed: 0.1346s/iter; left time: 6287.8470s
	iters: 300, epoch: 1 | loss: 0.2475545
	speed: 0.1261s/iter; left time: 5878.2540s
	iters: 400, epoch: 1 | loss: 0.2040536
	speed: 0.1343s/iter; left time: 6246.8570s
Epoch: 1 cost time: 65.24540090560913
Epoch: 1, Steps: 469 | Train Loss: 0.483 Vali Loss: 0.497 Vali Acc: 0.810 Test Loss: 0.497 Test Acc: 0.810
Validation loss decreased (inf --> -0.810458).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0401350
	speed: 0.5712s/iter; left time: 26463.3934s
	iters: 200, epoch: 2 | loss: 0.1287590
	speed: 0.1440s/iter; left time: 6656.6640s
	iters: 300, epoch: 2 | loss: 0.2036254
	speed: 0.1308s/iter; left time: 6031.8528s
	iters: 400, epoch: 2 | loss: 0.0859494
	speed: 0.1411s/iter; left time: 6495.9503s
Epoch: 2 cost time: 65.1088445186615
Epoch: 2, Steps: 469 | Train Loss: 0.256 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
Validation loss decreased (-0.810458 --> -0.871637).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4825506
	speed: 0.6264s/iter; left time: 28728.5401s
	iters: 200, epoch: 3 | loss: 0.1375633
	speed: 0.1360s/iter; left time: 6223.5453s
	iters: 300, epoch: 3 | loss: 0.0191155
	speed: 0.1445s/iter; left time: 6596.9695s
	iters: 400, epoch: 3 | loss: 0.0539061
	speed: 0.1407s/iter; left time: 6410.4700s
Epoch: 3 cost time: 68.46157598495483
Epoch: 3, Steps: 469 | Train Loss: 0.242 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
Validation loss decreased (-0.871637 --> -0.919094).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0391948
	speed: 0.6511s/iter; left time: 29556.5223s
	iters: 200, epoch: 4 | loss: 0.9170499
	speed: 0.1348s/iter; left time: 6103.7862s
	iters: 300, epoch: 4 | loss: 0.0451676
	speed: 0.1565s/iter; left time: 7072.8063s
	iters: 400, epoch: 4 | loss: 0.0901628
	speed: 0.1499s/iter; left time: 6761.4734s
Epoch: 4 cost time: 69.15309500694275
Epoch: 4, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0532953
	speed: 0.6173s/iter; left time: 27734.0341s
	iters: 200, epoch: 5 | loss: 0.4525087
	speed: 0.1239s/iter; left time: 5555.4233s
	iters: 300, epoch: 5 | loss: 0.0913663
	speed: 0.1258s/iter; left time: 5624.8291s
	iters: 400, epoch: 5 | loss: 0.1089839
	speed: 0.1532s/iter; left time: 6838.7763s
Epoch: 5 cost time: 64.2233247756958
Epoch: 5, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0953024
	speed: 0.5948s/iter; left time: 26442.0685s
	iters: 200, epoch: 6 | loss: 0.0501982
	speed: 0.1474s/iter; left time: 6536.1669s
	iters: 300, epoch: 6 | loss: 0.0923643
	speed: 0.1389s/iter; left time: 6147.5655s
	iters: 400, epoch: 6 | loss: 0.4527671
	speed: 0.1486s/iter; left time: 6562.9296s
Epoch: 6 cost time: 68.0629985332489
Epoch: 6, Steps: 469 | Train Loss: 0.211 Vali Loss: 0.315 Vali Acc: 0.913 Test Loss: 0.315 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7541171
	speed: 0.5959s/iter; left time: 26213.9377s
	iters: 200, epoch: 7 | loss: 0.0186294
	speed: 0.1495s/iter; left time: 6562.5649s
	iters: 300, epoch: 7 | loss: 0.0058674
	speed: 0.1610s/iter; left time: 7051.1485s
	iters: 400, epoch: 7 | loss: 0.3332713
	speed: 0.1467s/iter; left time: 6408.0258s
Epoch: 7 cost time: 70.16081690788269
Epoch: 7, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.381 Vali Acc: 0.898 Test Loss: 0.381 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4677970
	speed: 0.6310s/iter; left time: 27461.6661s
	iters: 200, epoch: 8 | loss: 0.1236841
	speed: 0.1603s/iter; left time: 6959.8250s
	iters: 300, epoch: 8 | loss: 0.0593482
	speed: 0.1323s/iter; left time: 5730.3960s
	iters: 400, epoch: 8 | loss: 0.4324332
	speed: 0.1415s/iter; left time: 6115.7389s
Epoch: 8 cost time: 67.74923825263977
Epoch: 8, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.266 Vali Acc: 0.938 Test Loss: 0.266 Test Acc: 0.938
Validation loss decreased (-0.919094 --> -0.937676).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0109007
	speed: 0.5879s/iter; left time: 25306.5111s
	iters: 200, epoch: 9 | loss: 0.0143998
	speed: 0.1392s/iter; left time: 5979.0248s
	iters: 300, epoch: 9 | loss: 0.0650290
	speed: 0.1582s/iter; left time: 6779.7289s
	iters: 400, epoch: 9 | loss: 0.0226824
	speed: 0.1723s/iter; left time: 7365.9769s
Epoch: 9 cost time: 71.22125220298767
Epoch: 9, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8250690
	speed: 0.6265s/iter; left time: 26675.2299s
	iters: 200, epoch: 10 | loss: 0.0287412
	speed: 0.1670s/iter; left time: 7092.3410s
	iters: 300, epoch: 10 | loss: 0.1532077
	speed: 0.1471s/iter; left time: 6235.6203s
	iters: 400, epoch: 10 | loss: 0.0060087
	speed: 0.1546s/iter; left time: 6536.1171s
Epoch: 10 cost time: 73.53802943229675
Epoch: 10, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0535975
	speed: 0.5702s/iter; left time: 24011.3789s
	iters: 200, epoch: 11 | loss: 0.3627699
	speed: 0.1389s/iter; left time: 5834.2706s
	iters: 300, epoch: 11 | loss: 0.0904090
	speed: 0.1516s/iter; left time: 6355.2557s
	iters: 400, epoch: 11 | loss: 0.4549805
	speed: 0.1444s/iter; left time: 6037.9545s
Epoch: 11 cost time: 66.30593729019165
Epoch: 11, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.301 Vali Acc: 0.930 Test Loss: 0.301 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2855778
	speed: 0.5861s/iter; left time: 24405.8757s
	iters: 200, epoch: 12 | loss: 0.0240817
	speed: 0.1479s/iter; left time: 6143.6152s
	iters: 300, epoch: 12 | loss: 0.0641463
	speed: 0.1320s/iter; left time: 5470.4426s
	iters: 400, epoch: 12 | loss: 0.0595591
	speed: 0.1438s/iter; left time: 5946.8937s
Epoch: 12 cost time: 66.69935154914856
Epoch: 12, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.314 Vali Acc: 0.940 Test Loss: 0.314 Test Acc: 0.940
Validation loss decreased (-0.937676 --> -0.939963).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0561035
	speed: 0.5904s/iter; left time: 24310.1558s
	iters: 200, epoch: 13 | loss: 0.0037435
	speed: 0.1471s/iter; left time: 6043.2915s
	iters: 300, epoch: 13 | loss: 0.0205692
	speed: 0.1364s/iter; left time: 5590.0115s
	iters: 400, epoch: 13 | loss: 0.0379476
	speed: 0.1364s/iter; left time: 5575.8072s
Epoch: 13 cost time: 65.80162000656128
Epoch: 13, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.262 Vali Acc: 0.923 Test Loss: 0.262 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0075692
	speed: 0.6041s/iter; left time: 24589.6309s
	iters: 200, epoch: 14 | loss: 0.1325885
	speed: 0.1752s/iter; left time: 7113.7534s
	iters: 300, epoch: 14 | loss: 0.3728032
	speed: 0.1523s/iter; left time: 6167.4801s
	iters: 400, epoch: 14 | loss: 0.0459059
	speed: 0.1498s/iter; left time: 6052.3634s
Epoch: 14 cost time: 73.71621131896973
Epoch: 14, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0428162
	speed: 0.6590s/iter; left time: 26516.0813s
	iters: 200, epoch: 15 | loss: 0.0722564
	speed: 0.1504s/iter; left time: 6037.4367s
	iters: 300, epoch: 15 | loss: 0.0731351
	speed: 0.1572s/iter; left time: 6292.6231s
	iters: 400, epoch: 15 | loss: 0.0520479
	speed: 0.1489s/iter; left time: 5945.0846s
Epoch: 15 cost time: 71.4310998916626
Epoch: 15, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.939963 --> -0.943680).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7850741
	speed: 0.6067s/iter; left time: 24125.1789s
	iters: 200, epoch: 16 | loss: 0.0167586
	speed: 0.1614s/iter; left time: 6400.7518s
	iters: 300, epoch: 16 | loss: 0.0028889
	speed: 0.1549s/iter; left time: 6126.9713s
	iters: 400, epoch: 16 | loss: 0.2204720
	speed: 0.1633s/iter; left time: 6445.2391s
Epoch: 16 cost time: 77.07582926750183
Epoch: 16, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.313 Vali Acc: 0.927 Test Loss: 0.313 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0270746
	speed: 0.6340s/iter; left time: 24912.8320s
	iters: 200, epoch: 17 | loss: 0.0456035
	speed: 0.1345s/iter; left time: 5273.0422s
	iters: 300, epoch: 17 | loss: 0.0300933
	speed: 0.1483s/iter; left time: 5798.8232s
	iters: 400, epoch: 17 | loss: 0.0763183
	speed: 0.1337s/iter; left time: 5215.7502s
Epoch: 17 cost time: 67.15156555175781
Epoch: 17, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0423219
	speed: 0.6498s/iter; left time: 25229.3286s
	iters: 200, epoch: 18 | loss: 0.0071728
	speed: 0.1448s/iter; left time: 5607.2255s
	iters: 300, epoch: 18 | loss: 0.0366305
	speed: 0.1592s/iter; left time: 6151.3568s
	iters: 400, epoch: 18 | loss: 0.3165808
	speed: 0.1271s/iter; left time: 4897.4955s
Epoch: 18 cost time: 70.65254068374634
Epoch: 18, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.220 Vali Acc: 0.945 Test Loss: 0.220 Test Acc: 0.945
Validation loss decreased (-0.943680 --> -0.945395).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0041630
	speed: 0.6718s/iter; left time: 25768.1730s
	iters: 200, epoch: 19 | loss: 0.0164188
	speed: 0.1299s/iter; left time: 4969.0413s
	iters: 300, epoch: 19 | loss: 0.1115565
	speed: 0.1315s/iter; left time: 5018.1396s
	iters: 400, epoch: 19 | loss: 0.4106672
	speed: 0.1593s/iter; left time: 6063.4671s
Epoch: 19 cost time: 69.33002734184265
Epoch: 19, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.945395 --> -0.953972).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0083365
	speed: 0.6796s/iter; left time: 25750.8760s
	iters: 200, epoch: 20 | loss: 0.0066966
	speed: 0.1448s/iter; left time: 5471.1872s
	iters: 300, epoch: 20 | loss: 0.0100920
	speed: 0.1507s/iter; left time: 5680.3923s
	iters: 400, epoch: 20 | loss: 0.1885538
	speed: 0.1374s/iter; left time: 5163.8699s
Epoch: 20 cost time: 70.81236743927002
Epoch: 20, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.364 Vali Acc: 0.920 Test Loss: 0.364 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4135222
	speed: 0.6135s/iter; left time: 22957.3305s
	iters: 200, epoch: 21 | loss: 0.0048820
	speed: 0.1367s/iter; left time: 5103.1086s
	iters: 300, epoch: 21 | loss: 0.0847007
	speed: 0.1400s/iter; left time: 5211.0466s
	iters: 400, epoch: 21 | loss: 0.0082091
	speed: 0.1499s/iter; left time: 5564.3331s
Epoch: 21 cost time: 65.69373750686646
Epoch: 21, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0032369
	speed: 0.5803s/iter; left time: 21442.2290s
	iters: 200, epoch: 22 | loss: 0.1009098
	speed: 0.1487s/iter; left time: 5480.6377s
	iters: 300, epoch: 22 | loss: 0.0905670
	speed: 0.1552s/iter; left time: 5702.8471s
	iters: 400, epoch: 22 | loss: 0.0148108
	speed: 0.1506s/iter; left time: 5519.7290s
Epoch: 22 cost time: 69.99166011810303
Epoch: 22, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1396609
	speed: 0.5692s/iter; left time: 20765.3664s
	iters: 200, epoch: 23 | loss: 0.0126512
	speed: 0.1364s/iter; left time: 4962.1835s
	iters: 300, epoch: 23 | loss: 0.0113750
	speed: 0.1540s/iter; left time: 5587.2676s
	iters: 400, epoch: 23 | loss: 0.0065691
	speed: 0.1493s/iter; left time: 5403.8996s
Epoch: 23 cost time: 70.34740042686462
Epoch: 23, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1274146
	speed: 0.6381s/iter; left time: 22981.2892s
	iters: 200, epoch: 24 | loss: 0.0018708
	speed: 0.1477s/iter; left time: 5304.3946s
	iters: 300, epoch: 24 | loss: 0.0305845
	speed: 0.1701s/iter; left time: 6091.3491s
	iters: 400, epoch: 24 | loss: 0.1245411
	speed: 0.1564s/iter; left time: 5585.2525s
Epoch: 24 cost time: 74.97211122512817
Epoch: 24, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.953972 --> -0.956831).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0868362
	speed: 0.5917s/iter; left time: 21032.1601s
	iters: 200, epoch: 25 | loss: 0.0701836
	speed: 0.1482s/iter; left time: 5251.7190s
	iters: 300, epoch: 25 | loss: 0.0091167
	speed: 0.1565s/iter; left time: 5532.2995s
	iters: 400, epoch: 25 | loss: 0.0177888
	speed: 0.1610s/iter; left time: 5673.5445s
Epoch: 25 cost time: 70.41346836090088
Epoch: 25, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.956831 --> -0.965407).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0022055
	speed: 0.6207s/iter; left time: 21771.0336s
	iters: 200, epoch: 26 | loss: 0.2310888
	speed: 0.1534s/iter; left time: 5364.8724s
	iters: 300, epoch: 26 | loss: 0.0211315
	speed: 0.1743s/iter; left time: 6078.0257s
	iters: 400, epoch: 26 | loss: 0.0201735
	speed: 0.1538s/iter; left time: 5347.4856s
Epoch: 26 cost time: 73.53075075149536
Epoch: 26, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
Validation loss decreased (-0.965407 --> -0.969124).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0175745
	speed: 0.6305s/iter; left time: 21820.7873s
	iters: 200, epoch: 27 | loss: 0.0056625
	speed: 0.1598s/iter; left time: 5514.3002s
	iters: 300, epoch: 27 | loss: 0.0180082
	speed: 0.1651s/iter; left time: 5678.9956s
	iters: 400, epoch: 27 | loss: 0.0014452
	speed: 0.1512s/iter; left time: 5187.1046s
Epoch: 27 cost time: 73.28063368797302
Epoch: 27, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0758005
	speed: 0.6137s/iter; left time: 20950.9926s
	iters: 200, epoch: 28 | loss: 0.0008908
	speed: 0.1374s/iter; left time: 4678.3092s
	iters: 300, epoch: 28 | loss: 0.0437060
	speed: 0.1820s/iter; left time: 6176.2088s
	iters: 400, epoch: 28 | loss: 0.0080835
	speed: 0.1432s/iter; left time: 4846.7690s
Epoch: 28 cost time: 72.87577700614929
Epoch: 28, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0279255
	speed: 0.5772s/iter; left time: 19435.3009s
	iters: 200, epoch: 29 | loss: 0.1019955
	speed: 0.1414s/iter; left time: 4747.9855s
	iters: 300, epoch: 29 | loss: 0.0076180
	speed: 0.1423s/iter; left time: 4762.1927s
	iters: 400, epoch: 29 | loss: 0.2589729
	speed: 0.1460s/iter; left time: 4871.5260s
Epoch: 29 cost time: 70.28529572486877
Epoch: 29, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0013512
	speed: 0.5998s/iter; left time: 19913.5816s
	iters: 200, epoch: 30 | loss: 0.2436285
	speed: 0.1571s/iter; left time: 5198.5140s
	iters: 300, epoch: 30 | loss: 0.0198432
	speed: 0.1632s/iter; left time: 5384.1060s
	iters: 400, epoch: 30 | loss: 0.0728530
	speed: 0.1524s/iter; left time: 5015.0722s
Epoch: 30 cost time: 71.29876852035522
Epoch: 30, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.4453972
	speed: 0.6346s/iter; left time: 20770.1219s
	iters: 200, epoch: 31 | loss: 0.1024999
	speed: 0.1393s/iter; left time: 4546.2410s
	iters: 300, epoch: 31 | loss: 0.3620420
	speed: 0.1352s/iter; left time: 4399.7387s
	iters: 400, epoch: 31 | loss: 0.0125292
	speed: 0.1339s/iter; left time: 4343.8470s
Epoch: 31 cost time: 69.58827066421509
Epoch: 31, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0281642
	speed: 0.6071s/iter; left time: 19587.1759s
	iters: 200, epoch: 32 | loss: 0.0294875
	speed: 0.1353s/iter; left time: 4350.2052s
	iters: 300, epoch: 32 | loss: 0.0243629
	speed: 0.1468s/iter; left time: 4707.5996s
	iters: 400, epoch: 32 | loss: 0.1388499
	speed: 0.1430s/iter; left time: 4570.6277s
Epoch: 32 cost time: 66.72451877593994
Epoch: 32, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.2627482
	speed: 0.6553s/iter; left time: 20832.8129s
	iters: 200, epoch: 33 | loss: 0.0156061
	speed: 0.1373s/iter; left time: 4351.7607s
	iters: 300, epoch: 33 | loss: 0.0048300
	speed: 0.1653s/iter; left time: 5221.5666s
	iters: 400, epoch: 33 | loss: 0.0021631
	speed: 0.1401s/iter; left time: 4411.3409s
Epoch: 33 cost time: 73.79987668991089
Epoch: 33, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0938980
	speed: 0.6407s/iter; left time: 20068.4161s
	iters: 200, epoch: 34 | loss: 0.0495861
	speed: 0.1439s/iter; left time: 4494.5004s
	iters: 300, epoch: 34 | loss: 0.1714559
	speed: 0.1515s/iter; left time: 4715.3148s
	iters: 400, epoch: 34 | loss: 0.0771343
	speed: 0.1513s/iter; left time: 4692.8340s
Epoch: 34 cost time: 70.73322010040283
Epoch: 34, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.284 Vali Acc: 0.946 Test Loss: 0.284 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0118737
	speed: 0.6420s/iter; left time: 19807.9290s
	iters: 200, epoch: 35 | loss: 0.0007939
	speed: 0.1299s/iter; left time: 3995.9095s
	iters: 300, epoch: 35 | loss: 0.0195054
	speed: 0.1475s/iter; left time: 4520.3412s
	iters: 400, epoch: 35 | loss: 0.0708145
	speed: 0.1378s/iter; left time: 4211.5790s
Epoch: 35 cost time: 66.61500906944275
Epoch: 35, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0053390
	speed: 0.5859s/iter; left time: 17802.5052s
	iters: 200, epoch: 36 | loss: 0.0082967
	speed: 0.1306s/iter; left time: 3956.0381s
	iters: 300, epoch: 36 | loss: 0.0610280
	speed: 0.1503s/iter; left time: 4537.9685s
	iters: 400, epoch: 36 | loss: 0.0074516
	speed: 0.1388s/iter; left time: 4175.9771s
Epoch: 36 cost time: 67.06956005096436
Epoch: 36, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9691252144082333
model parameter : 4775878
model size : 20.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3983122
	speed: 0.1530s/iter; left time: 7160.2821s
	iters: 200, epoch: 1 | loss: 0.4572535
	speed: 0.1390s/iter; left time: 6491.4090s
	iters: 300, epoch: 1 | loss: 0.0899879
	speed: 0.1421s/iter; left time: 6621.3026s
	iters: 400, epoch: 1 | loss: 0.0271829
	speed: 0.1423s/iter; left time: 6618.8576s
Epoch: 1 cost time: 68.1898729801178
Epoch: 1, Steps: 469 | Train Loss: 0.508 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
Validation loss decreased (inf --> -0.914520).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1652886
	speed: 0.5826s/iter; left time: 26991.3955s
	iters: 200, epoch: 2 | loss: 0.0373948
	speed: 0.1204s/iter; left time: 5564.1815s
	iters: 300, epoch: 2 | loss: 0.1653985
	speed: 0.1424s/iter; left time: 6567.4800s
	iters: 400, epoch: 2 | loss: 0.1974042
	speed: 0.1345s/iter; left time: 6189.3935s
Epoch: 2 cost time: 63.80393171310425
Epoch: 2, Steps: 469 | Train Loss: 0.238 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0398611
	speed: 0.5531s/iter; left time: 25365.7535s
	iters: 200, epoch: 3 | loss: 0.2140643
	speed: 0.1243s/iter; left time: 5687.2109s
	iters: 300, epoch: 3 | loss: 0.1669132
	speed: 0.1308s/iter; left time: 5973.3130s
	iters: 400, epoch: 3 | loss: 0.6865767
	speed: 0.1279s/iter; left time: 5826.1797s
Epoch: 3 cost time: 61.24359321594238
Epoch: 3, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
Validation loss decreased (-0.914520 --> -0.942537).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1048731
	speed: 0.5015s/iter; left time: 22764.5928s
	iters: 200, epoch: 4 | loss: 0.2925507
	speed: 0.1278s/iter; left time: 5787.8273s
	iters: 300, epoch: 4 | loss: 0.0312158
	speed: 0.1242s/iter; left time: 5611.8169s
	iters: 400, epoch: 4 | loss: 0.0681294
	speed: 0.1175s/iter; left time: 5296.8983s
Epoch: 4 cost time: 58.23263645172119
Epoch: 4, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2282921
	speed: 0.5435s/iter; left time: 24414.8083s
	iters: 200, epoch: 5 | loss: 0.8719028
	speed: 0.1272s/iter; left time: 5703.5537s
	iters: 300, epoch: 5 | loss: 0.5851158
	speed: 0.1263s/iter; left time: 5648.7986s
	iters: 400, epoch: 5 | loss: 0.0727682
	speed: 0.1159s/iter; left time: 5170.0065s
Epoch: 5 cost time: 60.610013484954834
Epoch: 5, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0171451
	speed: 0.5235s/iter; left time: 23271.4281s
	iters: 200, epoch: 6 | loss: 0.0204047
	speed: 0.1217s/iter; left time: 5397.8932s
	iters: 300, epoch: 6 | loss: 0.0422014
	speed: 0.1254s/iter; left time: 5548.6094s
	iters: 400, epoch: 6 | loss: 0.3596738
	speed: 0.1142s/iter; left time: 5041.6626s
Epoch: 6 cost time: 59.19212222099304
Epoch: 6, Steps: 469 | Train Loss: 0.236 Vali Loss: 0.352 Vali Acc: 0.904 Test Loss: 0.352 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0153448
	speed: 0.5238s/iter; left time: 23038.2183s
	iters: 200, epoch: 7 | loss: 0.0155186
	speed: 0.1352s/iter; left time: 5932.9575s
	iters: 300, epoch: 7 | loss: 0.3242782
	speed: 0.1226s/iter; left time: 5366.9863s
	iters: 400, epoch: 7 | loss: 0.2269943
	speed: 0.1304s/iter; left time: 5697.4073s
Epoch: 7 cost time: 61.92186093330383
Epoch: 7, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1091083
	speed: 0.5153s/iter; left time: 22425.7755s
	iters: 200, epoch: 8 | loss: 0.1117165
	speed: 0.1171s/iter; left time: 5085.6391s
	iters: 300, epoch: 8 | loss: 0.0622709
	speed: 0.1292s/iter; left time: 5598.0434s
	iters: 400, epoch: 8 | loss: 0.1264835
	speed: 0.1241s/iter; left time: 5363.3463s
Epoch: 8 cost time: 57.235957622528076
Epoch: 8, Steps: 469 | Train Loss: 0.191 Vali Loss: 0.220 Vali Acc: 0.945 Test Loss: 0.220 Test Acc: 0.945
Validation loss decreased (-0.942537 --> -0.945109).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0838734
	speed: 0.5014s/iter; left time: 21584.2941s
	iters: 200, epoch: 9 | loss: 0.6846665
	speed: 0.1318s/iter; left time: 5661.9122s
	iters: 300, epoch: 9 | loss: 0.0336427
	speed: 0.1169s/iter; left time: 5010.6808s
	iters: 400, epoch: 9 | loss: 0.2813217
	speed: 0.1233s/iter; left time: 5270.0988s
Epoch: 9 cost time: 58.825754165649414
Epoch: 9, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1973317
	speed: 0.4914s/iter; left time: 20923.6305s
	iters: 200, epoch: 10 | loss: 0.0168548
	speed: 0.1164s/iter; left time: 4944.8111s
	iters: 300, epoch: 10 | loss: 0.0135818
	speed: 0.1123s/iter; left time: 4757.5823s
	iters: 400, epoch: 10 | loss: 0.1915458
	speed: 0.1282s/iter; left time: 5419.1793s
Epoch: 10 cost time: 56.401833057403564
Epoch: 10, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.945109 --> -0.951113).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7950638
	speed: 0.5231s/iter; left time: 22026.8331s
	iters: 200, epoch: 11 | loss: 0.0204950
	speed: 0.1368s/iter; left time: 5746.4655s
	iters: 300, epoch: 11 | loss: 0.4147124
	speed: 0.1297s/iter; left time: 5437.6202s
	iters: 400, epoch: 11 | loss: 0.4081420
	speed: 0.1255s/iter; left time: 5248.0112s
Epoch: 11 cost time: 61.80567216873169
Epoch: 11, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.951113 --> -0.963978).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1196087
	speed: 0.5276s/iter; left time: 21971.2811s
	iters: 200, epoch: 12 | loss: 0.0851521
	speed: 0.1182s/iter; left time: 4911.9633s
	iters: 300, epoch: 12 | loss: 0.8577952
	speed: 0.1227s/iter; left time: 5083.0831s
	iters: 400, epoch: 12 | loss: 0.2350151
	speed: 0.1325s/iter; left time: 5479.3279s
Epoch: 12 cost time: 57.5448944568634
Epoch: 12, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.261 Vali Acc: 0.943 Test Loss: 0.261 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0142673
	speed: 0.5246s/iter; left time: 21599.5537s
	iters: 200, epoch: 13 | loss: 0.0906564
	speed: 0.1270s/iter; left time: 5215.2917s
	iters: 300, epoch: 13 | loss: 0.3877241
	speed: 0.1250s/iter; left time: 5122.5435s
	iters: 400, epoch: 13 | loss: 0.1279365
	speed: 0.1185s/iter; left time: 4842.9253s
Epoch: 13 cost time: 59.02705001831055
Epoch: 13, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0148628
	speed: 0.4975s/iter; left time: 20250.5015s
	iters: 200, epoch: 14 | loss: 0.1207447
	speed: 0.1148s/iter; left time: 4659.7817s
	iters: 300, epoch: 14 | loss: 0.0157881
	speed: 0.1256s/iter; left time: 5088.2420s
	iters: 400, epoch: 14 | loss: 0.0163998
	speed: 0.1306s/iter; left time: 5277.2593s
Epoch: 14 cost time: 57.07672667503357
Epoch: 14, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0453604
	speed: 0.4973s/iter; left time: 20009.5979s
	iters: 200, epoch: 15 | loss: 0.2027878
	speed: 0.1248s/iter; left time: 5009.5726s
	iters: 300, epoch: 15 | loss: 0.0046363
	speed: 0.1177s/iter; left time: 4711.3482s
	iters: 400, epoch: 15 | loss: 0.1573340
	speed: 0.1217s/iter; left time: 4861.4250s
Epoch: 15 cost time: 58.17613101005554
Epoch: 15, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.260 Vali Acc: 0.927 Test Loss: 0.260 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1568751
	speed: 0.4800s/iter; left time: 19086.5765s
	iters: 200, epoch: 16 | loss: 0.0112237
	speed: 0.1126s/iter; left time: 4464.8285s
	iters: 300, epoch: 16 | loss: 0.0060080
	speed: 0.1223s/iter; left time: 4839.9521s
	iters: 400, epoch: 16 | loss: 0.0236263
	speed: 0.1324s/iter; left time: 5225.5597s
Epoch: 16 cost time: 56.25886034965515
Epoch: 16, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3670746
	speed: 0.4984s/iter; left time: 19586.4905s
	iters: 200, epoch: 17 | loss: 0.0099560
	speed: 0.1216s/iter; left time: 4765.3829s
	iters: 300, epoch: 17 | loss: 0.0491147
	speed: 0.1147s/iter; left time: 4486.1586s
	iters: 400, epoch: 17 | loss: 0.9765947
	speed: 0.1112s/iter; left time: 4335.1215s
Epoch: 17 cost time: 55.31309390068054
Epoch: 17, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0062124
	speed: 0.4895s/iter; left time: 19004.9789s
	iters: 200, epoch: 18 | loss: 0.0166359
	speed: 0.1114s/iter; left time: 4314.7579s
	iters: 300, epoch: 18 | loss: 0.0626162
	speed: 0.1124s/iter; left time: 4342.3261s
	iters: 400, epoch: 18 | loss: 0.0137328
	speed: 0.1254s/iter; left time: 4829.8581s
Epoch: 18 cost time: 55.24196481704712
Epoch: 18, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0315995
	speed: 0.5069s/iter; left time: 19444.1272s
	iters: 200, epoch: 19 | loss: 0.0594660
	speed: 0.1408s/iter; left time: 5388.2624s
	iters: 300, epoch: 19 | loss: 0.0042438
	speed: 0.1263s/iter; left time: 4817.7488s
	iters: 400, epoch: 19 | loss: 0.1352329
	speed: 0.1291s/iter; left time: 4912.0913s
Epoch: 19 cost time: 62.53805756568909
Epoch: 19, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2274179
	speed: 0.4912s/iter; left time: 18611.2520s
	iters: 200, epoch: 20 | loss: 0.0133412
	speed: 0.1168s/iter; left time: 4414.8342s
	iters: 300, epoch: 20 | loss: 0.0154594
	speed: 0.1181s/iter; left time: 4451.4887s
	iters: 400, epoch: 20 | loss: 0.0883963
	speed: 0.1276s/iter; left time: 4798.0707s
Epoch: 20 cost time: 56.565211057662964
Epoch: 20, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.325 Vali Acc: 0.940 Test Loss: 0.325 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0859063
	speed: 0.5020s/iter; left time: 18783.8945s
	iters: 200, epoch: 21 | loss: 0.0059333
	speed: 0.1125s/iter; left time: 4199.4325s
	iters: 300, epoch: 21 | loss: 0.0185066
	speed: 0.1195s/iter; left time: 4449.4730s
	iters: 400, epoch: 21 | loss: 0.0185695
	speed: 0.1179s/iter; left time: 4376.4069s
Epoch: 21 cost time: 57.094316244125366
Epoch: 21, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9639794168096055
model parameter : 4775366
model size : 20.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8720699
	speed: 0.1287s/iter; left time: 6024.1913s
	iters: 200, epoch: 1 | loss: 0.2238794
	speed: 0.1096s/iter; left time: 5120.0205s
	iters: 300, epoch: 1 | loss: 0.1901369
	speed: 0.1151s/iter; left time: 5362.7324s
	iters: 400, epoch: 1 | loss: 0.2833954
	speed: 0.1198s/iter; left time: 5572.5247s
Epoch: 1 cost time: 55.63293433189392
Epoch: 1, Steps: 469 | Train Loss: 0.503 Vali Loss: 0.279 Vali Acc: 0.902 Test Loss: 0.279 Test Acc: 0.902
Validation loss decreased (inf --> -0.902227).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2816552
	speed: 0.5166s/iter; left time: 23936.8112s
	iters: 200, epoch: 2 | loss: 0.0802424
	speed: 0.1274s/iter; left time: 5890.5546s
	iters: 300, epoch: 2 | loss: 0.0651161
	speed: 0.1243s/iter; left time: 5735.6498s
	iters: 400, epoch: 2 | loss: 0.0560723
	speed: 0.1237s/iter; left time: 5692.9738s
Epoch: 2 cost time: 60.329805850982666
Epoch: 2, Steps: 469 | Train Loss: 0.231 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6999753
	speed: 0.5453s/iter; left time: 25009.7238s
	iters: 200, epoch: 3 | loss: 0.0123956
	speed: 0.1147s/iter; left time: 5251.1259s
	iters: 300, epoch: 3 | loss: 0.0536525
	speed: 0.1186s/iter; left time: 5417.8997s
	iters: 400, epoch: 3 | loss: 0.0227772
	speed: 0.1161s/iter; left time: 5291.5088s
Epoch: 3 cost time: 56.104379653930664
Epoch: 3, Steps: 469 | Train Loss: 0.251 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.902227 --> -0.932816).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2638608
	speed: 0.5126s/iter; left time: 23266.7583s
	iters: 200, epoch: 4 | loss: 0.0256545
	speed: 0.1310s/iter; left time: 5934.8941s
	iters: 300, epoch: 4 | loss: 0.0295611
	speed: 0.1271s/iter; left time: 5745.8405s
	iters: 400, epoch: 4 | loss: 0.0309708
	speed: 0.1225s/iter; left time: 5522.0745s
Epoch: 4 cost time: 59.76807880401611
Epoch: 4, Steps: 469 | Train Loss: 0.221 Vali Loss: 0.455 Vali Acc: 0.892 Test Loss: 0.455 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0297713
	speed: 0.4874s/iter; left time: 21896.8019s
	iters: 200, epoch: 5 | loss: 0.0755575
	speed: 0.1094s/iter; left time: 4904.5965s
	iters: 300, epoch: 5 | loss: 0.0218199
	speed: 0.1048s/iter; left time: 4686.2785s
	iters: 400, epoch: 5 | loss: 0.0184846
	speed: 0.1100s/iter; left time: 4906.8094s
Epoch: 5 cost time: 52.309879541397095
Epoch: 5, Steps: 469 | Train Loss: 0.199 Vali Loss: 0.315 Vali Acc: 0.918 Test Loss: 0.315 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0088006
	speed: 0.4966s/iter; left time: 22077.9326s
	iters: 200, epoch: 6 | loss: 0.0298168
	speed: 0.1346s/iter; left time: 5970.1853s
	iters: 300, epoch: 6 | loss: 0.0146034
	speed: 0.1243s/iter; left time: 5499.0312s
	iters: 400, epoch: 6 | loss: 0.0632640
	speed: 0.1178s/iter; left time: 5199.8435s
Epoch: 6 cost time: 59.01422905921936
Epoch: 6, Steps: 469 | Train Loss: 0.211 Vali Loss: 0.224 Vali Acc: 0.945 Test Loss: 0.224 Test Acc: 0.945
Validation loss decreased (-0.932816 --> -0.945109).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0607064
	speed: 0.5117s/iter; left time: 22508.1005s
	iters: 200, epoch: 7 | loss: 0.0548879
	speed: 0.1257s/iter; left time: 5517.4111s
	iters: 300, epoch: 7 | loss: 0.4998818
	speed: 0.1257s/iter; left time: 5501.9746s
	iters: 400, epoch: 7 | loss: 0.0740494
	speed: 0.1162s/iter; left time: 5075.4204s
Epoch: 7 cost time: 58.11224865913391
Epoch: 7, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3332045
	speed: 0.5034s/iter; left time: 21906.4319s
	iters: 200, epoch: 8 | loss: 0.0117611
	speed: 0.1239s/iter; left time: 5378.0348s
	iters: 300, epoch: 8 | loss: 0.0457880
	speed: 0.1205s/iter; left time: 5221.6216s
	iters: 400, epoch: 8 | loss: 0.0197467
	speed: 0.1333s/iter; left time: 5762.0826s
Epoch: 8 cost time: 60.484816789627075
Epoch: 8, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0981714
	speed: 0.5053s/iter; left time: 21753.5320s
	iters: 200, epoch: 9 | loss: 0.1302325
	speed: 0.1205s/iter; left time: 5173.5592s
	iters: 300, epoch: 9 | loss: 0.0083707
	speed: 0.1128s/iter; left time: 4834.3015s
	iters: 400, epoch: 9 | loss: 0.0255841
	speed: 0.1184s/iter; left time: 5060.2135s
Epoch: 9 cost time: 55.75773501396179
Epoch: 9, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.290 Vali Acc: 0.929 Test Loss: 0.290 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3629737
	speed: 0.5164s/iter; left time: 21987.6310s
	iters: 200, epoch: 10 | loss: 0.1764328
	speed: 0.1319s/iter; left time: 5603.3238s
	iters: 300, epoch: 10 | loss: 0.0345326
	speed: 0.1324s/iter; left time: 5609.8515s
	iters: 400, epoch: 10 | loss: 0.3847401
	speed: 0.1244s/iter; left time: 5261.2283s
Epoch: 10 cost time: 60.3836886882782
Epoch: 10, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.255 Vali Acc: 0.929 Test Loss: 0.255 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0341825
	speed: 0.4954s/iter; left time: 20861.5130s
	iters: 200, epoch: 11 | loss: 0.0195148
	speed: 0.1094s/iter; left time: 4597.4523s
	iters: 300, epoch: 11 | loss: 0.0343758
	speed: 0.1122s/iter; left time: 4702.8813s
	iters: 400, epoch: 11 | loss: 0.1878081
	speed: 0.1075s/iter; left time: 4495.1101s
Epoch: 11 cost time: 52.75831866264343
Epoch: 11, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
Validation loss decreased (-0.945109 --> -0.946253).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3988324
	speed: 0.4846s/iter; left time: 20178.5011s
	iters: 200, epoch: 12 | loss: 0.0513500
	speed: 0.1127s/iter; left time: 4682.9869s
	iters: 300, epoch: 12 | loss: 0.0086302
	speed: 0.1111s/iter; left time: 4603.6573s
	iters: 400, epoch: 12 | loss: 0.0036300
	speed: 0.1209s/iter; left time: 4999.4304s
Epoch: 12 cost time: 56.849125623703
Epoch: 12, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.946253 --> -0.962834).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0027587
	speed: 0.4880s/iter; left time: 20092.8382s
	iters: 200, epoch: 13 | loss: 0.2492034
	speed: 0.1205s/iter; left time: 4950.4478s
	iters: 300, epoch: 13 | loss: 0.0068369
	speed: 0.0986s/iter; left time: 4040.0515s
	iters: 400, epoch: 13 | loss: 0.1050436
	speed: 0.1133s/iter; left time: 4631.2301s
Epoch: 13 cost time: 53.485580921173096
Epoch: 13, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.252 Vali Acc: 0.947 Test Loss: 0.252 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0455509
	speed: 0.5142s/iter; left time: 20928.4035s
	iters: 200, epoch: 14 | loss: 0.0176134
	speed: 0.1230s/iter; left time: 4995.7981s
	iters: 300, epoch: 14 | loss: 0.1075578
	speed: 0.1277s/iter; left time: 5173.1874s
	iters: 400, epoch: 14 | loss: 0.2488091
	speed: 0.1249s/iter; left time: 5045.0326s
Epoch: 14 cost time: 59.662867307662964
Epoch: 14, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.920 Test Loss: 0.310 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1617539
	speed: 0.5075s/iter; left time: 20419.3780s
	iters: 200, epoch: 15 | loss: 0.0092580
	speed: 0.1188s/iter; left time: 4768.9890s
	iters: 300, epoch: 15 | loss: 0.0087884
	speed: 0.1300s/iter; left time: 5205.6747s
	iters: 400, epoch: 15 | loss: 0.0153196
	speed: 0.1253s/iter; left time: 5001.9337s
Epoch: 15 cost time: 58.97218680381775
Epoch: 15, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2473335
	speed: 0.5530s/iter; left time: 21990.2679s
	iters: 200, epoch: 16 | loss: 0.2442542
	speed: 0.1380s/iter; left time: 5474.3270s
	iters: 300, epoch: 16 | loss: 0.0116903
	speed: 0.1202s/iter; left time: 4753.9708s
	iters: 400, epoch: 16 | loss: 0.0047396
	speed: 0.1129s/iter; left time: 4457.0796s
Epoch: 16 cost time: 59.69978427886963
Epoch: 16, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.266 Vali Acc: 0.945 Test Loss: 0.266 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2364920
	speed: 0.4914s/iter; left time: 19309.8004s
	iters: 200, epoch: 17 | loss: 0.0209180
	speed: 0.1161s/iter; left time: 4550.9067s
	iters: 300, epoch: 17 | loss: 0.3988961
	speed: 0.1284s/iter; left time: 5021.6988s
	iters: 400, epoch: 17 | loss: 0.0861324
	speed: 0.1239s/iter; left time: 4832.8110s
Epoch: 17 cost time: 57.486231565475464
Epoch: 17, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3421663
	speed: 0.4980s/iter; left time: 19336.9087s
	iters: 200, epoch: 18 | loss: 0.0169385
	speed: 0.1223s/iter; left time: 4735.7887s
	iters: 300, epoch: 18 | loss: 0.0351309
	speed: 0.1096s/iter; left time: 4234.3439s
	iters: 400, epoch: 18 | loss: 0.0171653
	speed: 0.1070s/iter; left time: 4121.4141s
Epoch: 18 cost time: 55.19277238845825
Epoch: 18, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4505048
	speed: 0.4859s/iter; left time: 18639.7117s
	iters: 200, epoch: 19 | loss: 0.0035748
	speed: 0.1142s/iter; left time: 4370.1580s
	iters: 300, epoch: 19 | loss: 0.0777061
	speed: 0.1173s/iter; left time: 4474.7407s
	iters: 400, epoch: 19 | loss: 0.0068391
	speed: 0.1141s/iter; left time: 4343.2582s
Epoch: 19 cost time: 53.6035041809082
Epoch: 19, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.5597606
	speed: 0.4741s/iter; left time: 17965.2718s
	iters: 200, epoch: 20 | loss: 0.0061982
	speed: 0.1098s/iter; left time: 4148.9411s
	iters: 300, epoch: 20 | loss: 0.3621159
	speed: 0.1191s/iter; left time: 4490.5750s
	iters: 400, epoch: 20 | loss: 0.0114480
	speed: 0.1204s/iter; left time: 4524.9676s
Epoch: 20 cost time: 55.647913217544556
Epoch: 20, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.227 Vali Acc: 0.947 Test Loss: 0.227 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0478788
	speed: 0.4919s/iter; left time: 18405.9141s
	iters: 200, epoch: 21 | loss: 0.0027017
	speed: 0.1350s/iter; left time: 5037.3900s
	iters: 300, epoch: 21 | loss: 0.0731339
	speed: 0.1139s/iter; left time: 4240.8041s
	iters: 400, epoch: 21 | loss: 0.0061633
	speed: 0.1127s/iter; left time: 4184.5401s
Epoch: 21 cost time: 57.16753578186035
Epoch: 21, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.239 Vali Acc: 0.947 Test Loss: 0.239 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0331597
	speed: 0.5004s/iter; left time: 18489.5633s
	iters: 200, epoch: 22 | loss: 0.0049911
	speed: 0.1194s/iter; left time: 4401.5534s
	iters: 300, epoch: 22 | loss: 0.1263922
	speed: 0.1256s/iter; left time: 4616.3705s
	iters: 400, epoch: 22 | loss: 0.5190662
	speed: 0.1273s/iter; left time: 4665.1752s
Epoch: 22 cost time: 57.156229734420776
Epoch: 22, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9628359062321327
model parameter : 4774854
model size : 20.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3469035
	speed: 0.1435s/iter; left time: 6715.7207s
	iters: 200, epoch: 1 | loss: 0.1718080
	speed: 0.1250s/iter; left time: 5838.9065s
	iters: 300, epoch: 1 | loss: 0.1476305
	speed: 0.1232s/iter; left time: 5739.3443s
	iters: 400, epoch: 1 | loss: 0.2566667
	speed: 0.1229s/iter; left time: 5715.1755s
Epoch: 1 cost time: 60.94284725189209
Epoch: 1, Steps: 469 | Train Loss: 0.492 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (inf --> -0.925097).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1590190
	speed: 0.5099s/iter; left time: 23625.3045s
	iters: 200, epoch: 2 | loss: 0.1766761
	speed: 0.1263s/iter; left time: 5840.2035s
	iters: 300, epoch: 2 | loss: 0.6383097
	speed: 0.1442s/iter; left time: 6653.7803s
	iters: 400, epoch: 2 | loss: 0.1004916
	speed: 0.1329s/iter; left time: 6115.9605s
Epoch: 2 cost time: 62.857582330703735
Epoch: 2, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1548382
	speed: 0.5401s/iter; left time: 24770.3568s
	iters: 200, epoch: 3 | loss: 0.3746671
	speed: 0.1253s/iter; left time: 5735.4319s
	iters: 300, epoch: 3 | loss: 0.0673138
	speed: 0.1158s/iter; left time: 5287.4201s
	iters: 400, epoch: 3 | loss: 0.0277379
	speed: 0.1524s/iter; left time: 6942.5586s
Epoch: 3 cost time: 62.023956298828125
Epoch: 3, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0285025
	speed: 0.5963s/iter; left time: 27069.4474s
	iters: 200, epoch: 4 | loss: 0.0175933
	speed: 0.1478s/iter; left time: 6696.4549s
	iters: 300, epoch: 4 | loss: 0.0236802
	speed: 0.1489s/iter; left time: 6727.5258s
	iters: 400, epoch: 4 | loss: 0.0459059
	speed: 0.1432s/iter; left time: 6455.7701s
Epoch: 4 cost time: 69.29167795181274
Epoch: 4, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.925097 --> -0.936819).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0576010
	speed: 0.5503s/iter; left time: 24722.1403s
	iters: 200, epoch: 5 | loss: 0.0276379
	speed: 0.1444s/iter; left time: 6472.7603s
	iters: 300, epoch: 5 | loss: 0.3680762
	speed: 0.1352s/iter; left time: 6047.6137s
	iters: 400, epoch: 5 | loss: 0.5418376
	speed: 0.1375s/iter; left time: 6134.9762s
Epoch: 5 cost time: 63.72807455062866
Epoch: 5, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5833874
	speed: 0.5268s/iter; left time: 23419.7505s
	iters: 200, epoch: 6 | loss: 0.5725440
	speed: 0.1453s/iter; left time: 6445.0841s
	iters: 300, epoch: 6 | loss: 0.0280685
	speed: 0.1244s/iter; left time: 5503.9309s
	iters: 400, epoch: 6 | loss: 0.0781136
	speed: 0.1167s/iter; left time: 5154.9781s
Epoch: 6 cost time: 61.395102739334106
Epoch: 6, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2886071
	speed: 0.4969s/iter; left time: 21855.4815s
	iters: 200, epoch: 7 | loss: 0.1988854
	speed: 0.1476s/iter; left time: 6476.6323s
	iters: 300, epoch: 7 | loss: 0.0172532
	speed: 0.1418s/iter; left time: 6209.1191s
	iters: 400, epoch: 7 | loss: 0.3973433
	speed: 0.1464s/iter; left time: 6396.0347s
Epoch: 7 cost time: 63.629812479019165
Epoch: 7, Steps: 469 | Train Loss: 0.187 Vali Loss: 0.212 Vali Acc: 0.946 Test Loss: 0.212 Test Acc: 0.946
Validation loss decreased (-0.936819 --> -0.945681).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0313074
	speed: 0.5432s/iter; left time: 23639.6203s
	iters: 200, epoch: 8 | loss: 0.0177714
	speed: 0.1480s/iter; left time: 6423.8807s
	iters: 300, epoch: 8 | loss: 0.2805442
	speed: 0.1505s/iter; left time: 6517.2571s
	iters: 400, epoch: 8 | loss: 0.0071028
	speed: 0.1311s/iter; left time: 5667.9556s
Epoch: 8 cost time: 66.00832891464233
Epoch: 8, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0382997
	speed: 0.5542s/iter; left time: 23858.2751s
	iters: 200, epoch: 9 | loss: 0.0210767
	speed: 0.1644s/iter; left time: 7058.9220s
	iters: 300, epoch: 9 | loss: 0.1513089
	speed: 0.1388s/iter; left time: 5946.8444s
	iters: 400, epoch: 9 | loss: 0.3826911
	speed: 0.1512s/iter; left time: 6463.8984s
Epoch: 9 cost time: 68.39070177078247
Epoch: 9, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.229 Vali Acc: 0.945 Test Loss: 0.229 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5369142
	speed: 0.5793s/iter; left time: 24665.6150s
	iters: 200, epoch: 10 | loss: 0.0336936
	speed: 0.1332s/iter; left time: 5657.6090s
	iters: 300, epoch: 10 | loss: 0.0060845
	speed: 0.1232s/iter; left time: 5220.3865s
	iters: 400, epoch: 10 | loss: 0.3875269
	speed: 0.1125s/iter; left time: 4756.2588s
Epoch: 10 cost time: 59.75697565078735
Epoch: 10, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
Validation loss decreased (-0.945681 --> -0.948540).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1200317
	speed: 0.5074s/iter; left time: 21369.1391s
	iters: 200, epoch: 11 | loss: 0.9356328
	speed: 0.1378s/iter; left time: 5787.4046s
	iters: 300, epoch: 11 | loss: 0.1720139
	speed: 0.1271s/iter; left time: 5326.0586s
	iters: 400, epoch: 11 | loss: 0.0164211
	speed: 0.1396s/iter; left time: 5835.1288s
Epoch: 11 cost time: 61.92663526535034
Epoch: 11, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2252722
	speed: 0.5263s/iter; left time: 21916.1596s
	iters: 200, epoch: 12 | loss: 0.0724204
	speed: 0.1343s/iter; left time: 5579.3131s
	iters: 300, epoch: 12 | loss: 0.4302210
	speed: 0.1239s/iter; left time: 5132.9725s
	iters: 400, epoch: 12 | loss: 0.0482254
	speed: 0.1124s/iter; left time: 4645.5384s
Epoch: 12 cost time: 58.6837899684906
Epoch: 12, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.426 Vali Acc: 0.896 Test Loss: 0.426 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1211179
	speed: 0.5162s/iter; left time: 21252.1236s
	iters: 200, epoch: 13 | loss: 0.4755411
	speed: 0.1427s/iter; left time: 5860.1093s
	iters: 300, epoch: 13 | loss: 0.0721665
	speed: 0.1264s/iter; left time: 5179.7157s
	iters: 400, epoch: 13 | loss: 0.1441230
	speed: 0.1363s/iter; left time: 5569.0793s
Epoch: 13 cost time: 63.083669662475586
Epoch: 13, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.214 Vali Acc: 0.947 Test Loss: 0.214 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0052426
	speed: 0.5676s/iter; left time: 23104.2186s
	iters: 200, epoch: 14 | loss: 0.0103895
	speed: 0.1379s/iter; left time: 5601.1473s
	iters: 300, epoch: 14 | loss: 0.6389998
	speed: 0.1259s/iter; left time: 5101.2583s
	iters: 400, epoch: 14 | loss: 0.1062661
	speed: 0.1370s/iter; left time: 5537.2408s
Epoch: 14 cost time: 64.77581453323364
Epoch: 14, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.389 Vali Acc: 0.918 Test Loss: 0.389 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0172848
	speed: 0.5890s/iter; left time: 23699.5334s
	iters: 200, epoch: 15 | loss: 0.0985000
	speed: 0.1320s/iter; left time: 5299.3813s
	iters: 300, epoch: 15 | loss: 0.5407864
	speed: 0.1534s/iter; left time: 6142.5786s
	iters: 400, epoch: 15 | loss: 0.2045468
	speed: 0.1289s/iter; left time: 5147.3305s
Epoch: 15 cost time: 66.15785074234009
Epoch: 15, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0690136
	speed: 0.5193s/iter; left time: 20650.6792s
	iters: 200, epoch: 16 | loss: 0.0074761
	speed: 0.1324s/iter; left time: 5250.4763s
	iters: 300, epoch: 16 | loss: 0.0034883
	speed: 0.1224s/iter; left time: 4841.4105s
	iters: 400, epoch: 16 | loss: 0.0280664
	speed: 0.1373s/iter; left time: 5419.0212s
Epoch: 16 cost time: 61.06621599197388
Epoch: 16, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0263611
	speed: 0.5072s/iter; left time: 19933.0322s
	iters: 200, epoch: 17 | loss: 0.0056568
	speed: 0.1177s/iter; left time: 4611.6822s
	iters: 300, epoch: 17 | loss: 0.0387984
	speed: 0.1301s/iter; left time: 5084.7593s
	iters: 400, epoch: 17 | loss: 0.0055988
	speed: 0.1327s/iter; left time: 5174.1466s
Epoch: 17 cost time: 60.44189739227295
Epoch: 17, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0064492
	speed: 0.5065s/iter; left time: 19667.7817s
	iters: 200, epoch: 18 | loss: 0.3785180
	speed: 0.1153s/iter; left time: 4466.6085s
	iters: 300, epoch: 18 | loss: 0.0072369
	speed: 0.1205s/iter; left time: 4654.0178s
	iters: 400, epoch: 18 | loss: 0.0034811
	speed: 0.1310s/iter; left time: 5048.6427s
Epoch: 18 cost time: 59.9198055267334
Epoch: 18, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.943 Test Loss: 0.251 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0858401
	speed: 0.5934s/iter; left time: 22762.2217s
	iters: 200, epoch: 19 | loss: 0.2520980
	speed: 0.1408s/iter; left time: 5385.1806s
	iters: 300, epoch: 19 | loss: 0.4450076
	speed: 0.1369s/iter; left time: 5223.2198s
	iters: 400, epoch: 19 | loss: 0.0208299
	speed: 0.1402s/iter; left time: 5336.5455s
Epoch: 19 cost time: 67.28427219390869
Epoch: 19, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1069767
	speed: 0.5376s/iter; left time: 20370.7758s
	iters: 200, epoch: 20 | loss: 0.0088280
	speed: 0.1176s/iter; left time: 4445.0870s
	iters: 300, epoch: 20 | loss: 0.0493450
	speed: 0.1227s/iter; left time: 4623.1282s
	iters: 400, epoch: 20 | loss: 0.2632707
	speed: 0.1448s/iter; left time: 5444.8940s
Epoch: 20 cost time: 61.91003489494324
Epoch: 20, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.948540 --> -0.954544).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0069546
	speed: 0.5837s/iter; left time: 21841.6422s
	iters: 200, epoch: 21 | loss: 0.0843140
	speed: 0.1349s/iter; left time: 5033.6744s
	iters: 300, epoch: 21 | loss: 0.0067236
	speed: 0.1207s/iter; left time: 4490.7315s
	iters: 400, epoch: 21 | loss: 0.0278505
	speed: 0.1354s/iter; left time: 5025.0836s
Epoch: 21 cost time: 61.867664098739624
Epoch: 21, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1810137
	speed: 0.5184s/iter; left time: 19156.6960s
	iters: 200, epoch: 22 | loss: 0.0045892
	speed: 0.1205s/iter; left time: 4441.9714s
	iters: 300, epoch: 22 | loss: 0.1442777
	speed: 0.1577s/iter; left time: 5794.4978s
	iters: 400, epoch: 22 | loss: 0.2131575
	speed: 0.1257s/iter; left time: 4606.9789s
Epoch: 22 cost time: 64.15368008613586
Epoch: 22, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.954544 --> -0.972555).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0796811
	speed: 0.5905s/iter; left time: 21543.3110s
	iters: 200, epoch: 23 | loss: 0.0329075
	speed: 0.1506s/iter; left time: 5480.4134s
	iters: 300, epoch: 23 | loss: 0.0058550
	speed: 0.1401s/iter; left time: 5083.3440s
	iters: 400, epoch: 23 | loss: 0.2702281
	speed: 0.1269s/iter; left time: 4591.7117s
Epoch: 23 cost time: 66.25206995010376
Epoch: 23, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0192362
	speed: 0.5456s/iter; left time: 19648.3058s
	iters: 200, epoch: 24 | loss: 0.0489671
	speed: 0.1298s/iter; left time: 4662.4465s
	iters: 300, epoch: 24 | loss: 0.0011370
	speed: 0.1226s/iter; left time: 4390.8571s
	iters: 400, epoch: 24 | loss: 0.0028376
	speed: 0.1186s/iter; left time: 4234.4371s
Epoch: 24 cost time: 59.467071294784546
Epoch: 24, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0285604
	speed: 0.5423s/iter; left time: 19274.7966s
	iters: 200, epoch: 25 | loss: 0.0181856
	speed: 0.1293s/iter; left time: 4582.7299s
	iters: 300, epoch: 25 | loss: 0.0292917
	speed: 0.1231s/iter; left time: 4352.4894s
	iters: 400, epoch: 25 | loss: 0.0045585
	speed: 0.1453s/iter; left time: 5120.3683s
Epoch: 25 cost time: 63.747135400772095
Epoch: 25, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.209 Vali Acc: 0.955 Test Loss: 0.209 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0308671
	speed: 0.5859s/iter; left time: 20552.0333s
	iters: 200, epoch: 26 | loss: 0.0299589
	speed: 0.1307s/iter; left time: 4570.6508s
	iters: 300, epoch: 26 | loss: 0.2299184
	speed: 0.1281s/iter; left time: 4467.1272s
	iters: 400, epoch: 26 | loss: 0.6677977
	speed: 0.1236s/iter; left time: 4298.6040s
Epoch: 26 cost time: 62.97736716270447
Epoch: 26, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0166762
	speed: 0.5529s/iter; left time: 19135.1126s
	iters: 200, epoch: 27 | loss: 0.0058342
	speed: 0.1414s/iter; left time: 4878.8897s
	iters: 300, epoch: 27 | loss: 0.0015929
	speed: 0.1334s/iter; left time: 4590.8764s
	iters: 400, epoch: 27 | loss: 0.0055109
	speed: 0.1236s/iter; left time: 4241.0516s
Epoch: 27 cost time: 65.84537529945374
Epoch: 27, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0014363
	speed: 0.5782s/iter; left time: 19739.2798s
	iters: 200, epoch: 28 | loss: 0.0022579
	speed: 0.1397s/iter; left time: 4754.3743s
	iters: 300, epoch: 28 | loss: 0.0038919
	speed: 0.1345s/iter; left time: 4565.4008s
	iters: 400, epoch: 28 | loss: 0.0056583
	speed: 0.1375s/iter; left time: 4653.6067s
Epoch: 28 cost time: 65.66565299034119
Epoch: 28, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0052080
	speed: 0.5625s/iter; left time: 18939.7763s
	iters: 200, epoch: 29 | loss: 0.0037092
	speed: 0.1395s/iter; left time: 4682.1001s
	iters: 300, epoch: 29 | loss: 0.0783109
	speed: 0.1385s/iter; left time: 4637.0239s
	iters: 400, epoch: 29 | loss: 0.0455684
	speed: 0.1405s/iter; left time: 4687.6639s
Epoch: 29 cost time: 66.5256998538971
Epoch: 29, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0015658
	speed: 0.5460s/iter; left time: 18128.6361s
	iters: 200, epoch: 30 | loss: 0.0016632
	speed: 0.1189s/iter; left time: 3934.2514s
	iters: 300, epoch: 30 | loss: 0.1719593
	speed: 0.1309s/iter; left time: 4319.6959s
	iters: 400, epoch: 30 | loss: 0.0180914
	speed: 0.1610s/iter; left time: 5295.6471s
Epoch: 30 cost time: 64.83220338821411
Epoch: 30, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.347 Vali Acc: 0.927 Test Loss: 0.347 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0035772
	speed: 0.5581s/iter; left time: 18266.3263s
	iters: 200, epoch: 31 | loss: 0.0016285
	speed: 0.1394s/iter; left time: 4549.7355s
	iters: 300, epoch: 31 | loss: 0.0021032
	speed: 0.1428s/iter; left time: 4644.5770s
	iters: 400, epoch: 31 | loss: 0.0454938
	speed: 0.1280s/iter; left time: 4150.3955s
Epoch: 31 cost time: 64.02810835838318
Epoch: 31, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.2290340
	speed: 0.5350s/iter; left time: 17261.3064s
	iters: 200, epoch: 32 | loss: 0.0881187
	speed: 0.1320s/iter; left time: 4244.0565s
	iters: 300, epoch: 32 | loss: 0.0195224
	speed: 0.1305s/iter; left time: 4183.3373s
	iters: 400, epoch: 32 | loss: 0.0188427
	speed: 0.1514s/iter; left time: 4840.1285s
Epoch: 32 cost time: 63.885154724121094
Epoch: 32, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9725557461406518
model parameter : 4774342
model size : 20.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5002280
	speed: 0.1621s/iter; left time: 7584.7098s
	iters: 200, epoch: 1 | loss: 0.3309022
	speed: 0.1183s/iter; left time: 5525.2221s
	iters: 300, epoch: 1 | loss: 0.1892324
	speed: 0.1187s/iter; left time: 5533.1515s
	iters: 400, epoch: 1 | loss: 0.0809556
	speed: 0.1268s/iter; left time: 5898.2056s
Epoch: 1 cost time: 61.16541266441345
Epoch: 1, Steps: 469 | Train Loss: 0.509 Vali Loss: 0.346 Vali Acc: 0.888 Test Loss: 0.346 Test Acc: 0.888
Validation loss decreased (inf --> -0.887933).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1400938
	speed: 0.5450s/iter; left time: 25250.1275s
	iters: 200, epoch: 2 | loss: 0.2735640
	speed: 0.1364s/iter; left time: 6306.6382s
	iters: 300, epoch: 2 | loss: 0.0677465
	speed: 0.1324s/iter; left time: 6107.2906s
	iters: 400, epoch: 2 | loss: 0.1806218
	speed: 0.1307s/iter; left time: 6016.0697s
Epoch: 2 cost time: 62.31815958023071
Epoch: 2, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.887933 --> -0.941393).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2238295
	speed: 0.5226s/iter; left time: 23968.0636s
	iters: 200, epoch: 3 | loss: 0.1571160
	speed: 0.1221s/iter; left time: 5585.4899s
	iters: 300, epoch: 3 | loss: 0.3858341
	speed: 0.1275s/iter; left time: 5820.8751s
	iters: 400, epoch: 3 | loss: 0.4893296
	speed: 0.1230s/iter; left time: 5603.6842s
Epoch: 3 cost time: 59.760366439819336
Epoch: 3, Steps: 469 | Train Loss: 0.213 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0195916
	speed: 0.4965s/iter; left time: 22536.5171s
	iters: 200, epoch: 4 | loss: 0.0151462
	speed: 0.1337s/iter; left time: 6057.5897s
	iters: 300, epoch: 4 | loss: 0.3762612
	speed: 0.1258s/iter; left time: 5685.5418s
	iters: 400, epoch: 4 | loss: 0.2503361
	speed: 0.1288s/iter; left time: 5808.4854s
Epoch: 4 cost time: 60.53931975364685
Epoch: 4, Steps: 469 | Train Loss: 0.187 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.941393 --> -0.949684).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2240323
	speed: 0.5121s/iter; left time: 23007.6993s
	iters: 200, epoch: 5 | loss: 0.0888359
	speed: 0.1355s/iter; left time: 6071.5878s
	iters: 300, epoch: 5 | loss: 0.2972508
	speed: 0.1227s/iter; left time: 5486.4902s
	iters: 400, epoch: 5 | loss: 0.0410943
	speed: 0.1214s/iter; left time: 5418.9527s
Epoch: 5 cost time: 59.14752388000488
Epoch: 5, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.324 Vali Acc: 0.897 Test Loss: 0.324 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4609049
	speed: 0.4691s/iter; left time: 20856.1914s
	iters: 200, epoch: 6 | loss: 0.0406523
	speed: 0.1240s/iter; left time: 5500.6868s
	iters: 300, epoch: 6 | loss: 0.0042706
	speed: 0.1083s/iter; left time: 4794.2989s
	iters: 400, epoch: 6 | loss: 0.1200534
	speed: 0.1280s/iter; left time: 5653.6767s
Epoch: 6 cost time: 56.686808347702026
Epoch: 6, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.335 Vali Acc: 0.898 Test Loss: 0.335 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0741237
	speed: 0.4741s/iter; left time: 20855.0499s
	iters: 200, epoch: 7 | loss: 0.0107804
	speed: 0.1123s/iter; left time: 4928.1383s
	iters: 300, epoch: 7 | loss: 0.3485350
	speed: 0.1227s/iter; left time: 5372.9162s
	iters: 400, epoch: 7 | loss: 0.1869414
	speed: 0.1121s/iter; left time: 4898.0007s
Epoch: 7 cost time: 53.71978044509888
Epoch: 7, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
Validation loss decreased (-0.949684 --> -0.952256).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0325961
	speed: 0.4776s/iter; left time: 20784.0184s
	iters: 200, epoch: 8 | loss: 0.0257694
	speed: 0.1181s/iter; left time: 5128.2165s
	iters: 300, epoch: 8 | loss: 0.1097591
	speed: 0.1103s/iter; left time: 4777.5255s
	iters: 400, epoch: 8 | loss: 0.0190784
	speed: 0.1234s/iter; left time: 5332.7859s
Epoch: 8 cost time: 54.6130850315094
Epoch: 8, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.245 Vali Acc: 0.945 Test Loss: 0.245 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3921303
	speed: 0.4894s/iter; left time: 21067.8307s
	iters: 200, epoch: 9 | loss: 0.0826076
	speed: 0.1224s/iter; left time: 5254.8305s
	iters: 300, epoch: 9 | loss: 0.1537427
	speed: 0.1160s/iter; left time: 4969.7796s
	iters: 400, epoch: 9 | loss: 0.1586791
	speed: 0.1189s/iter; left time: 5084.1792s
Epoch: 9 cost time: 57.10801315307617
Epoch: 9, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0937940
	speed: 0.4395s/iter; left time: 18713.4084s
	iters: 200, epoch: 10 | loss: 0.0248794
	speed: 0.1096s/iter; left time: 4653.7136s
	iters: 300, epoch: 10 | loss: 0.0988773
	speed: 0.1131s/iter; left time: 4792.9580s
	iters: 400, epoch: 10 | loss: 0.0333463
	speed: 0.1187s/iter; left time: 5016.7992s
Epoch: 10 cost time: 53.48613667488098
Epoch: 10, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.273 Vali Acc: 0.947 Test Loss: 0.273 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0043219
	speed: 0.4622s/iter; left time: 19463.3477s
	iters: 200, epoch: 11 | loss: 0.0367127
	speed: 0.1163s/iter; left time: 4886.9747s
	iters: 300, epoch: 11 | loss: 0.2592952
	speed: 0.1122s/iter; left time: 4702.9648s
	iters: 400, epoch: 11 | loss: 0.1465646
	speed: 0.1109s/iter; left time: 4636.2341s
Epoch: 11 cost time: 55.083234786987305
Epoch: 11, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.952256 --> -0.969696).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0087095
	speed: 0.5175s/iter; left time: 21551.6516s
	iters: 200, epoch: 12 | loss: 0.2442746
	speed: 0.1199s/iter; left time: 4982.9404s
	iters: 300, epoch: 12 | loss: 0.2206025
	speed: 0.1162s/iter; left time: 4815.5883s
	iters: 400, epoch: 12 | loss: 0.0030676
	speed: 0.1246s/iter; left time: 5153.2005s
Epoch: 12 cost time: 58.06479024887085
Epoch: 12, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2849852
	speed: 0.5075s/iter; left time: 20896.0497s
	iters: 200, epoch: 13 | loss: 0.0125521
	speed: 0.1179s/iter; left time: 4841.6704s
	iters: 300, epoch: 13 | loss: 0.0481759
	speed: 0.1328s/iter; left time: 5442.3696s
	iters: 400, epoch: 13 | loss: 0.0516212
	speed: 0.1190s/iter; left time: 4862.8127s
Epoch: 13 cost time: 58.04046392440796
Epoch: 13, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.301 Vali Acc: 0.936 Test Loss: 0.301 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1650567
	speed: 0.5214s/iter; left time: 21224.5211s
	iters: 200, epoch: 14 | loss: 0.0641186
	speed: 0.1135s/iter; left time: 4607.8474s
	iters: 300, epoch: 14 | loss: 0.4650269
	speed: 0.1147s/iter; left time: 4645.9248s
	iters: 400, epoch: 14 | loss: 0.0738999
	speed: 0.1226s/iter; left time: 4951.7092s
Epoch: 14 cost time: 56.62638449668884
Epoch: 14, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0102400
	speed: 0.4894s/iter; left time: 19689.1262s
	iters: 200, epoch: 15 | loss: 0.1016551
	speed: 0.1111s/iter; left time: 4459.5505s
	iters: 300, epoch: 15 | loss: 0.0097812
	speed: 0.1161s/iter; left time: 4647.4246s
	iters: 400, epoch: 15 | loss: 0.0444450
	speed: 0.1081s/iter; left time: 4315.6874s
Epoch: 15 cost time: 53.62867498397827
Epoch: 15, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0089158
	speed: 0.4702s/iter; left time: 18698.1559s
	iters: 200, epoch: 16 | loss: 0.1787356
	speed: 0.1225s/iter; left time: 4858.3296s
	iters: 300, epoch: 16 | loss: 0.0126914
	speed: 0.1197s/iter; left time: 4734.1761s
	iters: 400, epoch: 16 | loss: 0.0047978
	speed: 0.1247s/iter; left time: 4920.1160s
Epoch: 16 cost time: 59.038609981536865
Epoch: 16, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0624420
	speed: 0.5067s/iter; left time: 19910.0773s
	iters: 200, epoch: 17 | loss: 0.0243239
	speed: 0.1162s/iter; left time: 4556.5728s
	iters: 300, epoch: 17 | loss: 0.0175720
	speed: 0.1134s/iter; left time: 4433.4173s
	iters: 400, epoch: 17 | loss: 0.2009401
	speed: 0.1126s/iter; left time: 4391.1945s
Epoch: 17 cost time: 54.60194253921509
Epoch: 17, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.248 Vali Acc: 0.945 Test Loss: 0.248 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2621244
	speed: 0.4744s/iter; left time: 18418.4213s
	iters: 200, epoch: 18 | loss: 0.0858960
	speed: 0.1171s/iter; left time: 4533.6864s
	iters: 300, epoch: 18 | loss: 0.5451245
	speed: 0.1207s/iter; left time: 4663.0181s
	iters: 400, epoch: 18 | loss: 0.0178832
	speed: 0.1200s/iter; left time: 4622.6350s
Epoch: 18 cost time: 56.44374895095825
Epoch: 18, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.317 Vali Acc: 0.916 Test Loss: 0.317 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2554666
	speed: 0.4554s/iter; left time: 17469.9733s
	iters: 200, epoch: 19 | loss: 0.2677113
	speed: 0.1161s/iter; left time: 4440.8342s
	iters: 300, epoch: 19 | loss: 0.0147125
	speed: 0.1231s/iter; left time: 4696.1394s
	iters: 400, epoch: 19 | loss: 0.0846252
	speed: 0.1093s/iter; left time: 4158.0705s
Epoch: 19 cost time: 52.93502736091614
Epoch: 19, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0063638
	speed: 0.4842s/iter; left time: 18345.9956s
	iters: 200, epoch: 20 | loss: 0.0154068
	speed: 0.1177s/iter; left time: 4448.0125s
	iters: 300, epoch: 20 | loss: 0.0213989
	speed: 0.1036s/iter; left time: 3905.3209s
	iters: 400, epoch: 20 | loss: 0.0107405
	speed: 0.1181s/iter; left time: 4440.3589s
Epoch: 20 cost time: 55.537682056427
Epoch: 20, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.272 Vali Acc: 0.923 Test Loss: 0.272 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0131792
	speed: 0.4780s/iter; left time: 17886.3800s
	iters: 200, epoch: 21 | loss: 0.0466023
	speed: 0.1099s/iter; left time: 4099.8539s
	iters: 300, epoch: 21 | loss: 0.1989373
	speed: 0.1161s/iter; left time: 4323.0456s
	iters: 400, epoch: 21 | loss: 0.3362658
	speed: 0.0998s/iter; left time: 3705.0122s
Epoch: 21 cost time: 52.23279142379761
Epoch: 21, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9696969696969697
model parameter : 3591622
model size : 16.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5518410
	speed: 0.1687s/iter; left time: 7893.3549s
	iters: 200, epoch: 1 | loss: 0.1376900
	speed: 0.1233s/iter; left time: 5756.7665s
	iters: 300, epoch: 1 | loss: 0.1637133
	speed: 0.1298s/iter; left time: 6050.1212s
	iters: 400, epoch: 1 | loss: 0.2570102
	speed: 0.1294s/iter; left time: 6015.5355s
Epoch: 1 cost time: 62.6179518699646
Epoch: 1, Steps: 469 | Train Loss: 0.480 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
Validation loss decreased (inf --> -0.910517).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0701421
	speed: 0.4633s/iter; left time: 21467.8521s
	iters: 200, epoch: 2 | loss: 0.3861254
	speed: 0.1310s/iter; left time: 6057.6144s
	iters: 300, epoch: 2 | loss: 0.8399763
	speed: 0.1303s/iter; left time: 6012.0233s
	iters: 400, epoch: 2 | loss: 0.1176635
	speed: 0.1189s/iter; left time: 5472.9544s
Epoch: 2 cost time: 60.554466247558594
Epoch: 2, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
Validation loss decreased (-0.910517 --> -0.915092).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0918137
	speed: 0.4753s/iter; left time: 21797.5498s
	iters: 200, epoch: 3 | loss: 0.3843574
	speed: 0.1181s/iter; left time: 5404.3689s
	iters: 300, epoch: 3 | loss: 0.4163268
	speed: 0.1336s/iter; left time: 6100.2967s
	iters: 400, epoch: 3 | loss: 0.0813911
	speed: 0.1302s/iter; left time: 5930.9473s
Epoch: 3 cost time: 58.21436262130737
Epoch: 3, Steps: 469 | Train Loss: 0.209 Vali Loss: 0.238 Vali Acc: 0.936 Test Loss: 0.238 Test Acc: 0.936
Validation loss decreased (-0.915092 --> -0.935675).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0305383
	speed: 0.4733s/iter; left time: 21484.6538s
	iters: 200, epoch: 4 | loss: 0.0501320
	speed: 0.1176s/iter; left time: 5328.2695s
	iters: 300, epoch: 4 | loss: 0.0745309
	speed: 0.1173s/iter; left time: 5302.7843s
	iters: 400, epoch: 4 | loss: 0.1122422
	speed: 0.1115s/iter; left time: 5028.2405s
Epoch: 4 cost time: 54.951592445373535
Epoch: 4, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
Validation loss decreased (-0.935675 --> -0.942822).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2754115
	speed: 0.4867s/iter; left time: 21864.9264s
	iters: 200, epoch: 5 | loss: 0.1269086
	speed: 0.1191s/iter; left time: 5336.8767s
	iters: 300, epoch: 5 | loss: 0.0908607
	speed: 0.1144s/iter; left time: 5114.9854s
	iters: 400, epoch: 5 | loss: 0.0290812
	speed: 0.1175s/iter; left time: 5245.4850s
Epoch: 5 cost time: 55.94239544868469
Epoch: 5, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3050373
	speed: 0.4802s/iter; left time: 21346.3350s
	iters: 200, epoch: 6 | loss: 0.3730329
	speed: 0.1116s/iter; left time: 4951.0175s
	iters: 300, epoch: 6 | loss: 0.0578614
	speed: 0.1149s/iter; left time: 5085.1644s
	iters: 400, epoch: 6 | loss: 0.0819703
	speed: 0.1435s/iter; left time: 6335.0718s
Epoch: 6 cost time: 59.26693153381348
Epoch: 6, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.942822 --> -0.943680).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2969728
	speed: 0.5104s/iter; left time: 22448.7788s
	iters: 200, epoch: 7 | loss: 0.2168828
	speed: 0.1214s/iter; left time: 5328.5483s
	iters: 300, epoch: 7 | loss: 0.0066529
	speed: 0.1321s/iter; left time: 5785.0339s
	iters: 400, epoch: 7 | loss: 0.0040860
	speed: 0.1177s/iter; left time: 5143.8781s
Epoch: 7 cost time: 59.2328667640686
Epoch: 7, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0327316
	speed: 0.4941s/iter; left time: 21502.7563s
	iters: 200, epoch: 8 | loss: 0.3758570
	speed: 0.1237s/iter; left time: 5368.9809s
	iters: 300, epoch: 8 | loss: 0.3028618
	speed: 0.1105s/iter; left time: 4787.5009s
	iters: 400, epoch: 8 | loss: 0.1155013
	speed: 0.1207s/iter; left time: 5217.2345s
Epoch: 8 cost time: 56.0543167591095
Epoch: 8, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.943680 --> -0.963692).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6582928
	speed: 0.4985s/iter; left time: 21459.5595s
	iters: 200, epoch: 9 | loss: 0.0424296
	speed: 0.1319s/iter; left time: 5664.6190s
	iters: 300, epoch: 9 | loss: 0.0780297
	speed: 0.1241s/iter; left time: 5318.5633s
	iters: 400, epoch: 9 | loss: 0.1241457
	speed: 0.1179s/iter; left time: 5040.8684s
Epoch: 9 cost time: 58.99695110321045
Epoch: 9, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.330 Vali Acc: 0.921 Test Loss: 0.330 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3617938
	speed: 0.5011s/iter; left time: 21336.0048s
	iters: 200, epoch: 10 | loss: 0.0136057
	speed: 0.1213s/iter; left time: 5151.8289s
	iters: 300, epoch: 10 | loss: 0.0289702
	speed: 0.1428s/iter; left time: 6050.4243s
	iters: 400, epoch: 10 | loss: 0.0191052
	speed: 0.1297s/iter; left time: 5484.7739s
Epoch: 10 cost time: 60.55541944503784
Epoch: 10, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1297519
	speed: 0.5063s/iter; left time: 21322.6549s
	iters: 200, epoch: 11 | loss: 0.3444007
	speed: 0.1155s/iter; left time: 4854.2865s
	iters: 300, epoch: 11 | loss: 0.0254978
	speed: 0.1083s/iter; left time: 4537.6460s
	iters: 400, epoch: 11 | loss: 0.3187207
	speed: 0.1137s/iter; left time: 4752.2145s
Epoch: 11 cost time: 54.55285859107971
Epoch: 11, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0185010
	speed: 0.5190s/iter; left time: 21612.6061s
	iters: 200, epoch: 12 | loss: 0.0892848
	speed: 0.1278s/iter; left time: 5309.1969s
	iters: 300, epoch: 12 | loss: 0.0865636
	speed: 0.1283s/iter; left time: 5318.5118s
	iters: 400, epoch: 12 | loss: 0.1206664
	speed: 0.1189s/iter; left time: 4913.5130s
Epoch: 12 cost time: 59.94743275642395
Epoch: 12, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0197726
	speed: 0.5292s/iter; left time: 21787.5447s
	iters: 200, epoch: 13 | loss: 0.3073387
	speed: 0.1380s/iter; left time: 5667.5492s
	iters: 300, epoch: 13 | loss: 0.0194521
	speed: 0.1167s/iter; left time: 4781.3109s
	iters: 400, epoch: 13 | loss: 0.0033315
	speed: 0.1458s/iter; left time: 5959.5310s
Epoch: 13 cost time: 63.235108852386475
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.242 Vali Acc: 0.939 Test Loss: 0.242 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1555476
	speed: 0.5107s/iter; left time: 20787.5979s
	iters: 200, epoch: 14 | loss: 0.0170542
	speed: 0.1132s/iter; left time: 4595.4277s
	iters: 300, epoch: 14 | loss: 0.0163507
	speed: 0.1365s/iter; left time: 5528.9284s
	iters: 400, epoch: 14 | loss: 0.0087165
	speed: 0.1171s/iter; left time: 4729.5700s
Epoch: 14 cost time: 58.01084756851196
Epoch: 14, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0119432
	speed: 0.5497s/iter; left time: 22117.6779s
	iters: 200, epoch: 15 | loss: 0.0070608
	speed: 0.1172s/iter; left time: 4701.8852s
	iters: 300, epoch: 15 | loss: 0.0121940
	speed: 0.1303s/iter; left time: 5217.6952s
	iters: 400, epoch: 15 | loss: 0.0285552
	speed: 0.1344s/iter; left time: 5368.5958s
Epoch: 15 cost time: 60.98988485336304
Epoch: 15, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0039651
	speed: 0.5049s/iter; left time: 20076.9284s
	iters: 200, epoch: 16 | loss: 0.0042959
	speed: 0.1339s/iter; left time: 5312.6348s
	iters: 300, epoch: 16 | loss: 0.0105477
	speed: 0.1288s/iter; left time: 5095.7712s
	iters: 400, epoch: 16 | loss: 0.0189601
	speed: 0.1287s/iter; left time: 5077.4918s
Epoch: 16 cost time: 58.35085964202881
Epoch: 16, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0057266
	speed: 0.4660s/iter; left time: 18312.5899s
	iters: 200, epoch: 17 | loss: 0.1079665
	speed: 0.1247s/iter; left time: 4889.3180s
	iters: 300, epoch: 17 | loss: 0.2984688
	speed: 0.1192s/iter; left time: 4661.3196s
	iters: 400, epoch: 17 | loss: 0.0838569
	speed: 0.1186s/iter; left time: 4625.1255s
Epoch: 17 cost time: 55.4668607711792
Epoch: 17, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0672353
	speed: 0.4759s/iter; left time: 18479.6070s
	iters: 200, epoch: 18 | loss: 0.3496394
	speed: 0.1094s/iter; left time: 4235.9178s
	iters: 300, epoch: 18 | loss: 0.1240296
	speed: 0.1201s/iter; left time: 4640.8312s
	iters: 400, epoch: 18 | loss: 0.1962800
	speed: 0.1396s/iter; left time: 5378.3292s
Epoch: 18 cost time: 58.8920636177063
Epoch: 18, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9636935391652373
model parameter : 3591110
model size : 16.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3728483
	speed: 0.1396s/iter; left time: 6531.9521s
	iters: 200, epoch: 1 | loss: 0.4420710
	speed: 0.1258s/iter; left time: 5873.3585s
	iters: 300, epoch: 1 | loss: 0.2204077
	speed: 0.1261s/iter; left time: 5875.3098s
	iters: 400, epoch: 1 | loss: 0.0599077
	speed: 0.1190s/iter; left time: 5535.7690s
Epoch: 1 cost time: 58.655606269836426
Epoch: 1, Steps: 469 | Train Loss: 0.496 Vali Loss: 0.290 Vali Acc: 0.912 Test Loss: 0.290 Test Acc: 0.912
Validation loss decreased (inf --> -0.912233).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2333562
	speed: 0.4875s/iter; left time: 22586.6367s
	iters: 200, epoch: 2 | loss: 0.3394898
	speed: 0.1228s/iter; left time: 5678.7332s
	iters: 300, epoch: 2 | loss: 0.1775988
	speed: 0.1074s/iter; left time: 4956.4228s
	iters: 400, epoch: 2 | loss: 0.3710182
	speed: 0.1162s/iter; left time: 5350.1940s
Epoch: 2 cost time: 56.819743394851685
Epoch: 2, Steps: 469 | Train Loss: 0.223 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
Validation loss decreased (-0.912233 --> -0.919666).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2743487
	speed: 0.4695s/iter; left time: 21531.9305s
	iters: 200, epoch: 3 | loss: 0.0701540
	speed: 0.1056s/iter; left time: 4830.4263s
	iters: 300, epoch: 3 | loss: 0.0241169
	speed: 0.1125s/iter; left time: 5138.9652s
	iters: 400, epoch: 3 | loss: 0.0708747
	speed: 0.1244s/iter; left time: 5669.5732s
Epoch: 3 cost time: 53.97861051559448
Epoch: 3, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.308 Vali Acc: 0.916 Test Loss: 0.308 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3968306
	speed: 0.4422s/iter; left time: 20072.8292s
	iters: 200, epoch: 4 | loss: 0.3314462
	speed: 0.1135s/iter; left time: 5142.1796s
	iters: 300, epoch: 4 | loss: 0.1481892
	speed: 0.1042s/iter; left time: 4708.3413s
	iters: 400, epoch: 4 | loss: 0.2931489
	speed: 0.1011s/iter; left time: 4557.2458s
Epoch: 4 cost time: 50.25426006317139
Epoch: 4, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
Validation loss decreased (-0.919666 --> -0.945395).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3287624
	speed: 0.4655s/iter; left time: 20911.7962s
	iters: 200, epoch: 5 | loss: 0.2000367
	speed: 0.1093s/iter; left time: 4899.9007s
	iters: 300, epoch: 5 | loss: 0.0628435
	speed: 0.0966s/iter; left time: 4318.3417s
	iters: 400, epoch: 5 | loss: 0.0286812
	speed: 0.1099s/iter; left time: 4904.8615s
Epoch: 5 cost time: 51.72696542739868
Epoch: 5, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.260 Vali Acc: 0.929 Test Loss: 0.260 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0610376
	speed: 0.4703s/iter; left time: 20908.9043s
	iters: 200, epoch: 6 | loss: 0.0155097
	speed: 0.1083s/iter; left time: 4805.0072s
	iters: 300, epoch: 6 | loss: 0.1801846
	speed: 0.1239s/iter; left time: 5482.6357s
	iters: 400, epoch: 6 | loss: 0.0772896
	speed: 0.1212s/iter; left time: 5353.7509s
Epoch: 6 cost time: 55.21007013320923
Epoch: 6, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0093640
	speed: 0.4687s/iter; left time: 20616.6469s
	iters: 200, epoch: 7 | loss: 0.0157099
	speed: 0.1265s/iter; left time: 5552.4358s
	iters: 300, epoch: 7 | loss: 0.0949304
	speed: 0.1135s/iter; left time: 4971.8443s
	iters: 400, epoch: 7 | loss: 0.1029947
	speed: 0.1063s/iter; left time: 4644.5170s
Epoch: 7 cost time: 54.587467670440674
Epoch: 7, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
Validation loss decreased (-0.945395 --> -0.960833).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2055563
	speed: 0.4649s/iter; left time: 20229.5885s
	iters: 200, epoch: 8 | loss: 0.0226908
	speed: 0.1129s/iter; left time: 4902.6904s
	iters: 300, epoch: 8 | loss: 0.3430284
	speed: 0.1189s/iter; left time: 5148.3974s
	iters: 400, epoch: 8 | loss: 0.0199133
	speed: 0.1168s/iter; left time: 5047.7391s
Epoch: 8 cost time: 54.874372720718384
Epoch: 8, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5072463
	speed: 0.4705s/iter; left time: 20253.5326s
	iters: 200, epoch: 9 | loss: 0.5921323
	speed: 0.1043s/iter; left time: 4479.4324s
	iters: 300, epoch: 9 | loss: 0.0547083
	speed: 0.1120s/iter; left time: 4798.9680s
	iters: 400, epoch: 9 | loss: 0.1370300
	speed: 0.1072s/iter; left time: 4583.6784s
Epoch: 9 cost time: 53.2451753616333
Epoch: 9, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2300571
	speed: 0.4597s/iter; left time: 19573.6866s
	iters: 200, epoch: 10 | loss: 0.0595012
	speed: 0.1113s/iter; left time: 4726.3967s
	iters: 300, epoch: 10 | loss: 0.4339845
	speed: 0.1096s/iter; left time: 4642.8289s
	iters: 400, epoch: 10 | loss: 0.1030917
	speed: 0.1151s/iter; left time: 4864.6299s
Epoch: 10 cost time: 52.57457613945007
Epoch: 10, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0229257
	speed: 0.4324s/iter; left time: 18208.9012s
	iters: 200, epoch: 11 | loss: 0.3334287
	speed: 0.1079s/iter; left time: 4533.2979s
	iters: 300, epoch: 11 | loss: 0.1788553
	speed: 0.1093s/iter; left time: 4580.4574s
	iters: 400, epoch: 11 | loss: 0.0022342
	speed: 0.1070s/iter; left time: 4472.5661s
Epoch: 11 cost time: 51.246580600738525
Epoch: 11, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0053204
	speed: 0.4624s/iter; left time: 19255.9805s
	iters: 200, epoch: 12 | loss: 0.0038144
	speed: 0.1373s/iter; left time: 5702.3010s
	iters: 300, epoch: 12 | loss: 0.0678161
	speed: 0.1231s/iter; left time: 5102.9521s
	iters: 400, epoch: 12 | loss: 0.0259266
	speed: 0.1202s/iter; left time: 4968.1008s
Epoch: 12 cost time: 60.989675521850586
Epoch: 12, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0077322
	speed: 0.4843s/iter; left time: 19938.0611s
	iters: 200, epoch: 13 | loss: 0.0556402
	speed: 0.1031s/iter; left time: 4234.4781s
	iters: 300, epoch: 13 | loss: 0.1119668
	speed: 0.1113s/iter; left time: 4558.8060s
	iters: 400, epoch: 13 | loss: 0.0460943
	speed: 0.1080s/iter; left time: 4414.7845s
Epoch: 13 cost time: 51.41987705230713
Epoch: 13, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.287 Vali Acc: 0.939 Test Loss: 0.287 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0549603
	speed: 0.4411s/iter; left time: 17954.4285s
	iters: 200, epoch: 14 | loss: 0.2596465
	speed: 0.1211s/iter; left time: 4918.1509s
	iters: 300, epoch: 14 | loss: 0.8359770
	speed: 0.1094s/iter; left time: 4431.5976s
	iters: 400, epoch: 14 | loss: 0.0161655
	speed: 0.1110s/iter; left time: 4484.1004s
Epoch: 14 cost time: 53.65900158882141
Epoch: 14, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1141520
	speed: 0.4364s/iter; left time: 17560.1651s
	iters: 200, epoch: 15 | loss: 0.0340375
	speed: 0.1143s/iter; left time: 4587.6271s
	iters: 300, epoch: 15 | loss: 0.0256513
	speed: 0.1217s/iter; left time: 4870.7528s
	iters: 400, epoch: 15 | loss: 0.3231146
	speed: 0.1119s/iter; left time: 4468.9471s
Epoch: 15 cost time: 53.03389096260071
Epoch: 15, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1554224
	speed: 0.4745s/iter; left time: 18870.6293s
	iters: 200, epoch: 16 | loss: 0.0161163
	speed: 0.1239s/iter; left time: 4916.3746s
	iters: 300, epoch: 16 | loss: 0.0107746
	speed: 0.1158s/iter; left time: 4580.5803s
	iters: 400, epoch: 16 | loss: 0.0486800
	speed: 0.1136s/iter; left time: 4482.5418s
Epoch: 16 cost time: 56.6675968170166
Epoch: 16, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5077924
	speed: 0.5054s/iter; left time: 19860.6647s
	iters: 200, epoch: 17 | loss: 0.0067505
	speed: 0.1192s/iter; left time: 4671.8571s
	iters: 300, epoch: 17 | loss: 0.2894978
	speed: 0.1255s/iter; left time: 4907.0949s
	iters: 400, epoch: 17 | loss: 0.0048949
	speed: 0.1171s/iter; left time: 4568.4798s
Epoch: 17 cost time: 57.166924238204956
Epoch: 17, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9608347627215552
model parameter : 3590598
model size : 16.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3648459
	speed: 0.1381s/iter; left time: 6462.0552s
	iters: 200, epoch: 1 | loss: 0.4061833
	speed: 0.1067s/iter; left time: 4983.5143s
	iters: 300, epoch: 1 | loss: 0.2123893
	speed: 0.0992s/iter; left time: 4623.1018s
	iters: 400, epoch: 1 | loss: 0.1064680
	speed: 0.0982s/iter; left time: 4567.2899s
Epoch: 1 cost time: 52.04820656776428
Epoch: 1, Steps: 469 | Train Loss: 0.470 Vali Loss: 0.286 Vali Acc: 0.912 Test Loss: 0.286 Test Acc: 0.912
Validation loss decreased (inf --> -0.911947).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1671433
	speed: 0.4448s/iter; left time: 20609.1774s
	iters: 200, epoch: 2 | loss: 0.0805964
	speed: 0.1057s/iter; left time: 4885.2345s
	iters: 300, epoch: 2 | loss: 0.1443456
	speed: 0.1047s/iter; left time: 4832.3084s
	iters: 400, epoch: 2 | loss: 0.3203184
	speed: 0.1085s/iter; left time: 4996.3439s
Epoch: 2 cost time: 50.95424151420593
Epoch: 2, Steps: 469 | Train Loss: 0.223 Vali Loss: 0.570 Vali Acc: 0.865 Test Loss: 0.570 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4596820
	speed: 0.4822s/iter; left time: 22116.7143s
	iters: 200, epoch: 3 | loss: 0.3943878
	speed: 0.1158s/iter; left time: 5298.6497s
	iters: 300, epoch: 3 | loss: 0.9172270
	speed: 0.1059s/iter; left time: 4834.8534s
	iters: 400, epoch: 3 | loss: 0.0438765
	speed: 0.1095s/iter; left time: 4990.0160s
Epoch: 3 cost time: 53.06033182144165
Epoch: 3, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.393 Vali Acc: 0.894 Test Loss: 0.393 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1586938
	speed: 0.4671s/iter; left time: 21202.8396s
	iters: 200, epoch: 4 | loss: 0.1222484
	speed: 0.1201s/iter; left time: 5441.8564s
	iters: 300, epoch: 4 | loss: 0.1453112
	speed: 0.1137s/iter; left time: 5137.9305s
	iters: 400, epoch: 4 | loss: 0.0629536
	speed: 0.1122s/iter; left time: 5057.4023s
Epoch: 4 cost time: 54.05224657058716
Epoch: 4, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.447 Vali Acc: 0.894 Test Loss: 0.447 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2874537
	speed: 0.4693s/iter; left time: 21082.5800s
	iters: 200, epoch: 5 | loss: 0.0289415
	speed: 0.1149s/iter; left time: 5152.0044s
	iters: 300, epoch: 5 | loss: 0.6553188
	speed: 0.1053s/iter; left time: 4709.8428s
	iters: 400, epoch: 5 | loss: 0.1271147
	speed: 0.1214s/iter; left time: 5415.6284s
Epoch: 5 cost time: 54.34973907470703
Epoch: 5, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.224 Vali Acc: 0.934 Test Loss: 0.224 Test Acc: 0.934
Validation loss decreased (-0.911947 --> -0.933674).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0128145
	speed: 0.4550s/iter; left time: 20228.0387s
	iters: 200, epoch: 6 | loss: 0.2602195
	speed: 0.1155s/iter; left time: 5125.0669s
	iters: 300, epoch: 6 | loss: 0.0519202
	speed: 0.1077s/iter; left time: 4765.6250s
	iters: 400, epoch: 6 | loss: 0.0187039
	speed: 0.1118s/iter; left time: 4935.0060s
Epoch: 6 cost time: 52.18987011909485
Epoch: 6, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.933674 --> -0.956259).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0243086
	speed: 0.4424s/iter; left time: 19458.9040s
	iters: 200, epoch: 7 | loss: 0.0946327
	speed: 0.1101s/iter; left time: 4830.3433s
	iters: 300, epoch: 7 | loss: 0.2394173
	speed: 0.1086s/iter; left time: 4757.3627s
	iters: 400, epoch: 7 | loss: 0.0161351
	speed: 0.1063s/iter; left time: 4645.8997s
Epoch: 7 cost time: 51.77228617668152
Epoch: 7, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.353 Vali Acc: 0.896 Test Loss: 0.353 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0145417
	speed: 0.4170s/iter; left time: 18146.4423s
	iters: 200, epoch: 8 | loss: 0.0113394
	speed: 0.1055s/iter; left time: 4580.6006s
	iters: 300, epoch: 8 | loss: 0.1449198
	speed: 0.1114s/iter; left time: 4826.5511s
	iters: 400, epoch: 8 | loss: 0.3041902
	speed: 0.1134s/iter; left time: 4900.0167s
Epoch: 8 cost time: 51.47240495681763
Epoch: 8, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0344075
	speed: 0.4571s/iter; left time: 19675.5963s
	iters: 200, epoch: 9 | loss: 0.0122693
	speed: 0.1162s/iter; left time: 4991.7950s
	iters: 300, epoch: 9 | loss: 0.0454718
	speed: 0.1262s/iter; left time: 5408.3602s
	iters: 400, epoch: 9 | loss: 0.0095209
	speed: 0.1231s/iter; left time: 5262.1394s
Epoch: 9 cost time: 55.63898205757141
Epoch: 9, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
Validation loss decreased (-0.956259 --> -0.956830).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0159724
	speed: 0.4494s/iter; left time: 19133.9584s
	iters: 200, epoch: 10 | loss: 0.0288214
	speed: 0.1110s/iter; left time: 4716.9388s
	iters: 300, epoch: 10 | loss: 0.0080953
	speed: 0.1068s/iter; left time: 4525.6024s
	iters: 400, epoch: 10 | loss: 0.1016348
	speed: 0.1186s/iter; left time: 5015.5305s
Epoch: 10 cost time: 52.400776624679565
Epoch: 10, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.313 Vali Acc: 0.927 Test Loss: 0.313 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2742382
	speed: 0.4460s/iter; left time: 18780.8167s
	iters: 200, epoch: 11 | loss: 0.0065060
	speed: 0.1133s/iter; left time: 4761.0082s
	iters: 300, epoch: 11 | loss: 0.1331545
	speed: 0.0954s/iter; left time: 3998.4468s
	iters: 400, epoch: 11 | loss: 0.0111596
	speed: 0.0979s/iter; left time: 4095.3254s
Epoch: 11 cost time: 49.26792764663696
Epoch: 11, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2969151
	speed: 0.4252s/iter; left time: 17704.6058s
	iters: 200, epoch: 12 | loss: 1.1295559
	speed: 0.1029s/iter; left time: 4273.8879s
	iters: 300, epoch: 12 | loss: 0.0358019
	speed: 0.0988s/iter; left time: 4095.3804s
	iters: 400, epoch: 12 | loss: 0.0297584
	speed: 0.1137s/iter; left time: 4699.6814s
Epoch: 12 cost time: 50.118600606918335
Epoch: 12, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.172 Vali Acc: 0.966 Test Loss: 0.172 Test Acc: 0.966
Validation loss decreased (-0.956830 --> -0.966265).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0050138
	speed: 0.4596s/iter; left time: 18922.1212s
	iters: 200, epoch: 13 | loss: 0.0177352
	speed: 0.1121s/iter; left time: 4604.5585s
	iters: 300, epoch: 13 | loss: 0.0068077
	speed: 0.1168s/iter; left time: 4784.3787s
	iters: 400, epoch: 13 | loss: 0.0323538
	speed: 0.1100s/iter; left time: 4493.9934s
Epoch: 13 cost time: 53.24553322792053
Epoch: 13, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0250135
	speed: 0.4485s/iter; left time: 18256.7485s
	iters: 200, epoch: 14 | loss: 0.0031232
	speed: 0.1097s/iter; left time: 4456.1490s
	iters: 300, epoch: 14 | loss: 0.0455588
	speed: 0.1129s/iter; left time: 4574.2504s
	iters: 400, epoch: 14 | loss: 0.0922920
	speed: 0.1163s/iter; left time: 4698.7743s
Epoch: 14 cost time: 53.05886769294739
Epoch: 14, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0032995
	speed: 0.4472s/iter; left time: 17992.9047s
	iters: 200, epoch: 15 | loss: 0.1401576
	speed: 0.1136s/iter; left time: 4561.2727s
	iters: 300, epoch: 15 | loss: 0.0351280
	speed: 0.1173s/iter; left time: 4695.7273s
	iters: 400, epoch: 15 | loss: 0.5887436
	speed: 0.1088s/iter; left time: 4344.3438s
Epoch: 15 cost time: 52.82905077934265
Epoch: 15, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0201911
	speed: 0.4602s/iter; left time: 18298.6191s
	iters: 200, epoch: 16 | loss: 0.1806984
	speed: 0.1116s/iter; left time: 4428.4265s
	iters: 300, epoch: 16 | loss: 0.1029043
	speed: 0.1150s/iter; left time: 4551.6616s
	iters: 400, epoch: 16 | loss: 0.0006929
	speed: 0.1115s/iter; left time: 4399.5607s
Epoch: 16 cost time: 53.86324191093445
Epoch: 16, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0991993
	speed: 0.4556s/iter; left time: 17902.8464s
	iters: 200, epoch: 17 | loss: 0.0118857
	speed: 0.1059s/iter; left time: 4152.8408s
	iters: 300, epoch: 17 | loss: 0.0064464
	speed: 0.1092s/iter; left time: 4268.9724s
	iters: 400, epoch: 17 | loss: 0.0027014
	speed: 0.1020s/iter; left time: 3978.8875s
Epoch: 17 cost time: 50.260244846343994
Epoch: 17, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0044203
	speed: 0.4211s/iter; left time: 16349.6112s
	iters: 200, epoch: 18 | loss: 0.1404346
	speed: 0.0962s/iter; left time: 3724.9175s
	iters: 300, epoch: 18 | loss: 0.0659022
	speed: 0.1040s/iter; left time: 4017.6757s
	iters: 400, epoch: 18 | loss: 0.0089600
	speed: 0.1035s/iter; left time: 3986.4072s
Epoch: 18 cost time: 47.68496251106262
Epoch: 18, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.212 Vali Acc: 0.946 Test Loss: 0.212 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0149724
	speed: 0.4330s/iter; left time: 16608.5481s
	iters: 200, epoch: 19 | loss: 0.0006612
	speed: 0.1130s/iter; left time: 4323.9392s
	iters: 300, epoch: 19 | loss: 0.3919773
	speed: 0.1258s/iter; left time: 4801.5750s
	iters: 400, epoch: 19 | loss: 0.0017458
	speed: 0.1081s/iter; left time: 4114.4235s
Epoch: 19 cost time: 52.94163393974304
Epoch: 19, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0073561
	speed: 0.4480s/iter; left time: 16974.3117s
	iters: 200, epoch: 20 | loss: 0.0306442
	speed: 0.1161s/iter; left time: 4386.1067s
	iters: 300, epoch: 20 | loss: 0.0360986
	speed: 0.1010s/iter; left time: 3807.2697s
	iters: 400, epoch: 20 | loss: 0.4850672
	speed: 0.1046s/iter; left time: 3930.4576s
Epoch: 20 cost time: 50.39093041419983
Epoch: 20, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0037168
	speed: 0.4510s/iter; left time: 16876.5229s
	iters: 200, epoch: 21 | loss: 0.0022863
	speed: 0.1069s/iter; left time: 3990.3093s
	iters: 300, epoch: 21 | loss: 0.0045027
	speed: 0.1040s/iter; left time: 3871.3541s
	iters: 400, epoch: 21 | loss: 0.0036122
	speed: 0.0969s/iter; left time: 3597.2025s
Epoch: 21 cost time: 49.56468677520752
Epoch: 21, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0016087
	speed: 0.4363s/iter; left time: 16122.0785s
	iters: 200, epoch: 22 | loss: 0.0161074
	speed: 0.0989s/iter; left time: 3646.0943s
	iters: 300, epoch: 22 | loss: 0.1712847
	speed: 0.1068s/iter; left time: 3924.3796s
	iters: 400, epoch: 22 | loss: 0.0221062
	speed: 0.1067s/iter; left time: 3911.8839s
Epoch: 22 cost time: 51.212682008743286
Epoch: 22, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9662664379645511
model parameter : 3590086
model size : 16.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5772905
	speed: 0.1378s/iter; left time: 6450.6841s
	iters: 200, epoch: 1 | loss: 0.3633503
	speed: 0.1131s/iter; left time: 5284.0379s
	iters: 300, epoch: 1 | loss: 0.4082208
	speed: 0.1077s/iter; left time: 5021.1370s
	iters: 400, epoch: 1 | loss: 0.1255650
	speed: 0.1024s/iter; left time: 4761.5300s
Epoch: 1 cost time: 53.45241618156433
Epoch: 1, Steps: 469 | Train Loss: 0.495 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
Validation loss decreased (inf --> -0.906515).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1942375
	speed: 0.4726s/iter; left time: 21896.5847s
	iters: 200, epoch: 2 | loss: 0.0885975
	speed: 0.1017s/iter; left time: 4703.2311s
	iters: 300, epoch: 2 | loss: 0.0695683
	speed: 0.1121s/iter; left time: 5169.6546s
	iters: 400, epoch: 2 | loss: 0.0600774
	speed: 0.1238s/iter; left time: 5697.1296s
Epoch: 2 cost time: 53.9560182094574
Epoch: 2, Steps: 469 | Train Loss: 0.201 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4849353
	speed: 0.4722s/iter; left time: 21657.4280s
	iters: 200, epoch: 3 | loss: 0.1533401
	speed: 0.1020s/iter; left time: 4669.1019s
	iters: 300, epoch: 3 | loss: 0.0982943
	speed: 0.1150s/iter; left time: 5249.6473s
	iters: 400, epoch: 3 | loss: 0.2209147
	speed: 0.1207s/iter; left time: 5499.8244s
Epoch: 3 cost time: 54.65015888214111
Epoch: 3, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
Validation loss decreased (-0.906515 --> -0.943394).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0926961
	speed: 0.4965s/iter; left time: 22537.6551s
	iters: 200, epoch: 4 | loss: 0.1333790
	speed: 0.1050s/iter; left time: 4755.2082s
	iters: 300, epoch: 4 | loss: 0.1175187
	speed: 0.1122s/iter; left time: 5072.2245s
	iters: 400, epoch: 4 | loss: 0.3790502
	speed: 0.1069s/iter; left time: 4822.5834s
Epoch: 4 cost time: 51.68743896484375
Epoch: 4, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0337899
	speed: 0.4515s/iter; left time: 20285.5851s
	iters: 200, epoch: 5 | loss: 0.1213797
	speed: 0.0982s/iter; left time: 4402.1897s
	iters: 300, epoch: 5 | loss: 0.5270491
	speed: 0.1084s/iter; left time: 4846.7244s
	iters: 400, epoch: 5 | loss: 0.0156182
	speed: 0.0967s/iter; left time: 4313.7845s
Epoch: 5 cost time: 50.928627014160156
Epoch: 5, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.221 Vali Acc: 0.947 Test Loss: 0.221 Test Acc: 0.947
Validation loss decreased (-0.943394 --> -0.946539).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0089640
	speed: 0.4317s/iter; left time: 19191.0927s
	iters: 200, epoch: 6 | loss: 0.0256802
	speed: 0.1096s/iter; left time: 4859.6886s
	iters: 300, epoch: 6 | loss: 0.3537444
	speed: 0.1109s/iter; left time: 4906.8104s
	iters: 400, epoch: 6 | loss: 0.0549963
	speed: 0.1069s/iter; left time: 4719.0422s
Epoch: 6 cost time: 51.89281868934631
Epoch: 6, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
Validation loss decreased (-0.946539 --> -0.955402).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0144379
	speed: 0.4801s/iter; left time: 21118.3185s
	iters: 200, epoch: 7 | loss: 0.3512850
	speed: 0.1165s/iter; left time: 5114.7152s
	iters: 300, epoch: 7 | loss: 0.3356149
	speed: 0.1244s/iter; left time: 5446.9807s
	iters: 400, epoch: 7 | loss: 0.0086443
	speed: 0.1250s/iter; left time: 5460.2779s
Epoch: 7 cost time: 55.48134136199951
Epoch: 7, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.282 Vali Acc: 0.929 Test Loss: 0.282 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0935455
	speed: 0.4683s/iter; left time: 20378.9638s
	iters: 200, epoch: 8 | loss: 0.5798606
	speed: 0.1155s/iter; left time: 5013.6914s
	iters: 300, epoch: 8 | loss: 0.1512044
	speed: 0.1103s/iter; left time: 4778.8580s
	iters: 400, epoch: 8 | loss: 0.0506999
	speed: 0.1156s/iter; left time: 4994.6799s
Epoch: 8 cost time: 55.34497094154358
Epoch: 8, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0314202
	speed: 0.4725s/iter; left time: 20338.6512s
	iters: 200, epoch: 9 | loss: 0.2405735
	speed: 0.1146s/iter; left time: 4923.0783s
	iters: 300, epoch: 9 | loss: 0.4952141
	speed: 0.1022s/iter; left time: 4377.5004s
	iters: 400, epoch: 9 | loss: 0.2007581
	speed: 0.1071s/iter; left time: 4578.3409s
Epoch: 9 cost time: 50.53393316268921
Epoch: 9, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.275 Vali Acc: 0.923 Test Loss: 0.275 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3874453
	speed: 0.4256s/iter; left time: 18121.7830s
	iters: 200, epoch: 10 | loss: 0.0266637
	speed: 0.1013s/iter; left time: 4304.4236s
	iters: 300, epoch: 10 | loss: 0.0677278
	speed: 0.1008s/iter; left time: 4272.7537s
	iters: 400, epoch: 10 | loss: 0.0049274
	speed: 0.1166s/iter; left time: 4931.3773s
Epoch: 10 cost time: 50.50366711616516
Epoch: 10, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0083677
	speed: 0.4361s/iter; left time: 18363.9971s
	iters: 200, epoch: 11 | loss: 0.4016662
	speed: 0.1086s/iter; left time: 4560.8381s
	iters: 300, epoch: 11 | loss: 0.1383319
	speed: 0.1083s/iter; left time: 4538.2089s
	iters: 400, epoch: 11 | loss: 0.1618393
	speed: 0.1020s/iter; left time: 4263.0836s
Epoch: 11 cost time: 50.614460706710815
Epoch: 11, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0188286
	speed: 0.4432s/iter; left time: 18457.1956s
	iters: 200, epoch: 12 | loss: 0.0676733
	speed: 0.1109s/iter; left time: 4608.3977s
	iters: 300, epoch: 12 | loss: 0.2638974
	speed: 0.1099s/iter; left time: 4556.0063s
	iters: 400, epoch: 12 | loss: 0.2379896
	speed: 0.1213s/iter; left time: 5016.6212s
Epoch: 12 cost time: 54.153024673461914
Epoch: 12, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3516691
	speed: 0.4264s/iter; left time: 17557.2270s
	iters: 200, epoch: 13 | loss: 0.0679866
	speed: 0.1035s/iter; left time: 4251.3938s
	iters: 300, epoch: 13 | loss: 0.0084921
	speed: 0.0957s/iter; left time: 3920.7405s
	iters: 400, epoch: 13 | loss: 0.1520231
	speed: 0.1145s/iter; left time: 4681.5039s
Epoch: 13 cost time: 49.76762843132019
Epoch: 13, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.178 Vali Acc: 0.945 Test Loss: 0.178 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0184815
	speed: 0.4239s/iter; left time: 17254.9667s
	iters: 200, epoch: 14 | loss: 0.0385706
	speed: 0.1174s/iter; left time: 4768.6136s
	iters: 300, epoch: 14 | loss: 0.1954648
	speed: 0.1175s/iter; left time: 4759.0024s
	iters: 400, epoch: 14 | loss: 0.0061626
	speed: 0.1134s/iter; left time: 4580.0015s
Epoch: 14 cost time: 52.636568784713745
Epoch: 14, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0306647
	speed: 0.4014s/iter; left time: 16149.3482s
	iters: 200, epoch: 15 | loss: 0.0029152
	speed: 0.1160s/iter; left time: 4657.5064s
	iters: 300, epoch: 15 | loss: 0.1888309
	speed: 0.1199s/iter; left time: 4800.9187s
	iters: 400, epoch: 15 | loss: 0.0255806
	speed: 0.1142s/iter; left time: 4562.5533s
Epoch: 15 cost time: 52.660714626312256
Epoch: 15, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0391960
	speed: 0.4387s/iter; left time: 17445.4115s
	iters: 200, epoch: 16 | loss: 0.2736777
	speed: 0.1161s/iter; left time: 4604.4742s
	iters: 300, epoch: 16 | loss: 0.0133361
	speed: 0.0982s/iter; left time: 3885.2000s
	iters: 400, epoch: 16 | loss: 0.0019338
	speed: 0.1010s/iter; left time: 3984.5569s
Epoch: 16 cost time: 52.21775794029236
Epoch: 16, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9554030874785592
model parameter : 2999494
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6290360
	speed: 0.1541s/iter; left time: 7211.5475s
	iters: 200, epoch: 1 | loss: 0.2773694
	speed: 0.1139s/iter; left time: 5320.5440s
	iters: 300, epoch: 1 | loss: 0.1186856
	speed: 0.1183s/iter; left time: 5512.8828s
	iters: 400, epoch: 1 | loss: 0.1348831
	speed: 0.1281s/iter; left time: 5957.4858s
Epoch: 1 cost time: 59.70389270782471
Epoch: 1, Steps: 469 | Train Loss: 0.488 Vali Loss: 0.308 Vali Acc: 0.929 Test Loss: 0.308 Test Acc: 0.929
Validation loss decreased (inf --> -0.929099).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0994649
	speed: 0.4526s/iter; left time: 20969.7848s
	iters: 200, epoch: 2 | loss: 0.3530183
	speed: 0.1200s/iter; left time: 5548.6024s
	iters: 300, epoch: 2 | loss: 0.1438998
	speed: 0.1156s/iter; left time: 5334.0643s
	iters: 400, epoch: 2 | loss: 0.0237439
	speed: 0.1151s/iter; left time: 5298.8688s
Epoch: 2 cost time: 55.714174032211304
Epoch: 2, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.247 Vali Acc: 0.927 Test Loss: 0.247 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0675712
	speed: 0.4426s/iter; left time: 20298.1565s
	iters: 200, epoch: 3 | loss: 0.2684007
	speed: 0.1111s/iter; left time: 5086.3673s
	iters: 300, epoch: 3 | loss: 0.0085529
	speed: 0.1156s/iter; left time: 5278.1716s
	iters: 400, epoch: 3 | loss: 0.0087344
	speed: 0.1013s/iter; left time: 4615.2206s
Epoch: 3 cost time: 51.08673572540283
Epoch: 3, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.929099 --> -0.941965).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1233758
	speed: 0.4399s/iter; left time: 19969.7603s
	iters: 200, epoch: 4 | loss: 0.1835860
	speed: 0.1090s/iter; left time: 4938.6387s
	iters: 300, epoch: 4 | loss: 0.4213491
	speed: 0.1176s/iter; left time: 5316.5050s
	iters: 400, epoch: 4 | loss: 0.1526875
	speed: 0.1178s/iter; left time: 5312.4881s
Epoch: 4 cost time: 55.15863347053528
Epoch: 4, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.280 Vali Acc: 0.905 Test Loss: 0.280 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0302184
	speed: 0.4697s/iter; left time: 21101.9755s
	iters: 200, epoch: 5 | loss: 0.1365549
	speed: 0.1121s/iter; left time: 5025.6864s
	iters: 300, epoch: 5 | loss: 0.0901960
	speed: 0.1038s/iter; left time: 4641.9654s
	iters: 400, epoch: 5 | loss: 0.8059388
	speed: 0.1095s/iter; left time: 4884.8312s
Epoch: 5 cost time: 52.60162854194641
Epoch: 5, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1868287
	speed: 0.4608s/iter; left time: 20485.7398s
	iters: 200, epoch: 6 | loss: 0.0562911
	speed: 0.1280s/iter; left time: 5678.2313s
	iters: 300, epoch: 6 | loss: 0.3110714
	speed: 0.1216s/iter; left time: 5381.4537s
	iters: 400, epoch: 6 | loss: 0.4245745
	speed: 0.1220s/iter; left time: 5385.4678s
Epoch: 6 cost time: 57.034822940826416
Epoch: 6, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0940607
	speed: 0.4791s/iter; left time: 21074.1307s
	iters: 200, epoch: 7 | loss: 0.2615696
	speed: 0.1190s/iter; left time: 5223.1135s
	iters: 300, epoch: 7 | loss: 0.0179952
	speed: 0.1082s/iter; left time: 4738.0929s
	iters: 400, epoch: 7 | loss: 0.0453542
	speed: 0.1131s/iter; left time: 4942.3307s
Epoch: 7 cost time: 55.442540407180786
Epoch: 7, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
Validation loss decreased (-0.941965 --> -0.951113).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0041749
	speed: 0.4835s/iter; left time: 21039.8551s
	iters: 200, epoch: 8 | loss: 0.1317689
	speed: 0.1205s/iter; left time: 5232.1490s
	iters: 300, epoch: 8 | loss: 0.2978263
	speed: 0.1140s/iter; left time: 4940.2257s
	iters: 400, epoch: 8 | loss: 0.1139021
	speed: 0.1228s/iter; left time: 5306.6529s
Epoch: 8 cost time: 55.616254568099976
Epoch: 8, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2102829
	speed: 0.4405s/iter; left time: 18964.1204s
	iters: 200, epoch: 9 | loss: 0.2515025
	speed: 0.1006s/iter; left time: 4319.0213s
	iters: 300, epoch: 9 | loss: 0.2149104
	speed: 0.1079s/iter; left time: 4623.5319s
	iters: 400, epoch: 9 | loss: 0.1014079
	speed: 0.1178s/iter; left time: 5036.9970s
Epoch: 9 cost time: 51.835957288742065
Epoch: 9, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0115730
	speed: 0.4675s/iter; left time: 19906.9894s
	iters: 200, epoch: 10 | loss: 0.0693805
	speed: 0.1075s/iter; left time: 4566.8462s
	iters: 300, epoch: 10 | loss: 0.5060856
	speed: 0.1167s/iter; left time: 4946.8907s
	iters: 400, epoch: 10 | loss: 0.0452513
	speed: 0.1048s/iter; left time: 4429.0049s
Epoch: 10 cost time: 52.32517743110657
Epoch: 10, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.951113 --> -0.967980).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0130488
	speed: 0.4310s/iter; left time: 18151.3753s
	iters: 200, epoch: 11 | loss: 0.0095334
	speed: 0.1053s/iter; left time: 4422.0707s
	iters: 300, epoch: 11 | loss: 0.0053900
	speed: 0.1079s/iter; left time: 4521.6194s
	iters: 400, epoch: 11 | loss: 0.0058326
	speed: 0.1178s/iter; left time: 4923.5678s
Epoch: 11 cost time: 53.425411224365234
Epoch: 11, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1600741
	speed: 0.4447s/iter; left time: 18517.6338s
	iters: 200, epoch: 12 | loss: 0.0157622
	speed: 0.1145s/iter; left time: 4755.0848s
	iters: 300, epoch: 12 | loss: 0.0096471
	speed: 0.1092s/iter; left time: 4525.4440s
	iters: 400, epoch: 12 | loss: 0.1648707
	speed: 0.0965s/iter; left time: 3987.7107s
Epoch: 12 cost time: 50.652482986450195
Epoch: 12, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1116548
	speed: 0.3958s/iter; left time: 16295.8066s
	iters: 200, epoch: 13 | loss: 0.1637892
	speed: 0.1090s/iter; left time: 4477.8098s
	iters: 300, epoch: 13 | loss: 0.0152264
	speed: 0.1171s/iter; left time: 4796.9418s
	iters: 400, epoch: 13 | loss: 0.0321428
	speed: 0.1173s/iter; left time: 4793.1155s
Epoch: 13 cost time: 53.940324783325195
Epoch: 13, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0715863
	speed: 0.3833s/iter; left time: 15601.6572s
	iters: 200, epoch: 14 | loss: 0.0172675
	speed: 0.0931s/iter; left time: 3780.8220s
	iters: 300, epoch: 14 | loss: 0.0853213
	speed: 0.0971s/iter; left time: 3934.5791s
	iters: 400, epoch: 14 | loss: 0.6956311
	speed: 0.1066s/iter; left time: 4305.2734s
Epoch: 14 cost time: 46.06211304664612
Epoch: 14, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0451160
	speed: 0.4340s/iter; left time: 17462.5104s
	iters: 200, epoch: 15 | loss: 0.0174343
	speed: 0.1178s/iter; left time: 4726.0824s
	iters: 300, epoch: 15 | loss: 0.0911977
	speed: 0.1011s/iter; left time: 4045.5787s
	iters: 400, epoch: 15 | loss: 0.0546892
	speed: 0.1026s/iter; left time: 4095.4054s
Epoch: 15 cost time: 50.63077116012573
Epoch: 15, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1078888
	speed: 0.4098s/iter; left time: 16297.2971s
	iters: 200, epoch: 16 | loss: 0.3773603
	speed: 0.1087s/iter; left time: 4313.6775s
	iters: 300, epoch: 16 | loss: 0.3790477
	speed: 0.1122s/iter; left time: 4437.8779s
	iters: 400, epoch: 16 | loss: 0.0044598
	speed: 0.1012s/iter; left time: 3995.4621s
Epoch: 16 cost time: 51.070252895355225
Epoch: 16, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0860306
	speed: 0.4443s/iter; left time: 17458.8313s
	iters: 200, epoch: 17 | loss: 0.0607027
	speed: 0.1136s/iter; left time: 4451.1127s
	iters: 300, epoch: 17 | loss: 0.0140532
	speed: 0.1068s/iter; left time: 4174.2763s
	iters: 400, epoch: 17 | loss: 0.0241336
	speed: 0.1052s/iter; left time: 4100.8929s
Epoch: 17 cost time: 51.817248582839966
Epoch: 17, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3513539
	speed: 0.4144s/iter; left time: 16091.7586s
	iters: 200, epoch: 18 | loss: 0.0029110
	speed: 0.1065s/iter; left time: 4126.0096s
	iters: 300, epoch: 18 | loss: 0.1137265
	speed: 0.1129s/iter; left time: 4360.5152s
	iters: 400, epoch: 18 | loss: 0.1122933
	speed: 0.1029s/iter; left time: 3965.2162s
Epoch: 18 cost time: 50.46328258514404
Epoch: 18, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0042080
	speed: 0.4415s/iter; left time: 16934.1005s
	iters: 200, epoch: 19 | loss: 0.0371042
	speed: 0.1131s/iter; left time: 4325.6060s
	iters: 300, epoch: 19 | loss: 0.1039237
	speed: 0.1091s/iter; left time: 4164.0690s
	iters: 400, epoch: 19 | loss: 0.0030062
	speed: 0.1001s/iter; left time: 3810.9932s
Epoch: 19 cost time: 49.92931413650513
Epoch: 19, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.247 Vali Acc: 0.949 Test Loss: 0.247 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0149637
	speed: 0.4202s/iter; left time: 15920.0507s
	iters: 200, epoch: 20 | loss: 0.0326669
	speed: 0.1066s/iter; left time: 4028.1140s
	iters: 300, epoch: 20 | loss: 0.0057355
	speed: 0.0942s/iter; left time: 3551.8563s
	iters: 400, epoch: 20 | loss: 0.3896591
	speed: 0.1048s/iter; left time: 3938.8018s
Epoch: 20 cost time: 49.13347005844116
Epoch: 20, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9679817038307604
model parameter : 2998982
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5713823
	speed: 0.1176s/iter; left time: 5504.7942s
	iters: 200, epoch: 1 | loss: 0.5966691
	speed: 0.1096s/iter; left time: 5118.4710s
	iters: 300, epoch: 1 | loss: 0.1034813
	speed: 0.1182s/iter; left time: 5508.0431s
	iters: 400, epoch: 1 | loss: 0.4231586
	speed: 0.1196s/iter; left time: 5560.1503s
Epoch: 1 cost time: 55.43136978149414
Epoch: 1, Steps: 469 | Train Loss: 0.510 Vali Loss: 0.361 Vali Acc: 0.899 Test Loss: 0.361 Test Acc: 0.899
Validation loss decreased (inf --> -0.898796).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3142727
	speed: 0.4881s/iter; left time: 22616.2678s
	iters: 200, epoch: 2 | loss: 0.2600023
	speed: 0.1173s/iter; left time: 5423.1685s
	iters: 300, epoch: 2 | loss: 0.1171290
	speed: 0.1153s/iter; left time: 5317.5623s
	iters: 400, epoch: 2 | loss: 0.3515828
	speed: 0.1095s/iter; left time: 5039.2521s
Epoch: 2 cost time: 53.765541791915894
Epoch: 2, Steps: 469 | Train Loss: 0.201 Vali Loss: 0.367 Vali Acc: 0.898 Test Loss: 0.367 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0334483
	speed: 0.4825s/iter; left time: 22127.8316s
	iters: 200, epoch: 3 | loss: 0.1540650
	speed: 0.1225s/iter; left time: 5604.2677s
	iters: 300, epoch: 3 | loss: 0.4194828
	speed: 0.1138s/iter; left time: 5195.0880s
	iters: 400, epoch: 3 | loss: 0.6449638
	speed: 0.1133s/iter; left time: 5164.1124s
Epoch: 3 cost time: 54.65890192985535
Epoch: 3, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.432 Vali Acc: 0.883 Test Loss: 0.432 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2646607
	speed: 0.4505s/iter; left time: 20452.2217s
	iters: 200, epoch: 4 | loss: 0.1734398
	speed: 0.1089s/iter; left time: 4931.3898s
	iters: 300, epoch: 4 | loss: 0.0440572
	speed: 0.1056s/iter; left time: 4770.7635s
	iters: 400, epoch: 4 | loss: 0.2516402
	speed: 0.1042s/iter; left time: 4699.1962s
Epoch: 4 cost time: 51.02568221092224
Epoch: 4, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.301 Vali Acc: 0.907 Test Loss: 0.301 Test Acc: 0.907
Validation loss decreased (-0.898796 --> -0.907373).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2227690
	speed: 0.4435s/iter; left time: 19922.4206s
	iters: 200, epoch: 5 | loss: 0.0524581
	speed: 0.1119s/iter; left time: 5016.4826s
	iters: 300, epoch: 5 | loss: 0.0725968
	speed: 0.1169s/iter; left time: 5228.3413s
	iters: 400, epoch: 5 | loss: 0.0204720
	speed: 0.1132s/iter; left time: 5051.1271s
Epoch: 5 cost time: 53.428983211517334
Epoch: 5, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.907373 --> -0.953972).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4092174
	speed: 0.4621s/iter; left time: 20540.9326s
	iters: 200, epoch: 6 | loss: 0.0886807
	speed: 0.1105s/iter; left time: 4899.1559s
	iters: 300, epoch: 6 | loss: 0.0154385
	speed: 0.1149s/iter; left time: 5083.2652s
	iters: 400, epoch: 6 | loss: 0.0225243
	speed: 0.1252s/iter; left time: 5529.7627s
Epoch: 6 cost time: 53.710691690444946
Epoch: 6, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4766386
	speed: 0.4583s/iter; left time: 20157.9648s
	iters: 200, epoch: 7 | loss: 0.3247173
	speed: 0.1085s/iter; left time: 4761.5636s
	iters: 300, epoch: 7 | loss: 0.0125645
	speed: 0.1074s/iter; left time: 4703.9876s
	iters: 400, epoch: 7 | loss: 0.0577033
	speed: 0.1051s/iter; left time: 4590.2810s
Epoch: 7 cost time: 52.5346782207489
Epoch: 7, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.953972 --> -0.957117).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0837263
	speed: 0.4712s/iter; left time: 20504.8603s
	iters: 200, epoch: 8 | loss: 0.4576939
	speed: 0.1230s/iter; left time: 5340.8764s
	iters: 300, epoch: 8 | loss: 0.1534358
	speed: 0.1336s/iter; left time: 5787.1284s
	iters: 400, epoch: 8 | loss: 0.1104345
	speed: 0.1178s/iter; left time: 5088.9384s
Epoch: 8 cost time: 57.48934626579285
Epoch: 8, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.306 Vali Acc: 0.908 Test Loss: 0.306 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0175052
	speed: 0.4776s/iter; left time: 20561.8944s
	iters: 200, epoch: 9 | loss: 0.1245018
	speed: 0.1119s/iter; left time: 4807.5903s
	iters: 300, epoch: 9 | loss: 0.2526669
	speed: 0.1210s/iter; left time: 5186.2364s
	iters: 400, epoch: 9 | loss: 0.0280702
	speed: 0.1174s/iter; left time: 5018.0704s
Epoch: 9 cost time: 55.413453817367554
Epoch: 9, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0488248
	speed: 0.4626s/iter; left time: 19697.6505s
	iters: 200, epoch: 10 | loss: 0.0734348
	speed: 0.1211s/iter; left time: 5144.4521s
	iters: 300, epoch: 10 | loss: 0.0716778
	speed: 0.1053s/iter; left time: 4461.7625s
	iters: 400, epoch: 10 | loss: 0.3939445
	speed: 0.0994s/iter; left time: 4202.0024s
Epoch: 10 cost time: 53.18417978286743
Epoch: 10, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3447964
	speed: 0.4551s/iter; left time: 19166.1934s
	iters: 200, epoch: 11 | loss: 0.1150973
	speed: 0.1269s/iter; left time: 5330.0228s
	iters: 300, epoch: 11 | loss: 0.4252047
	speed: 0.1211s/iter; left time: 5076.8272s
	iters: 400, epoch: 11 | loss: 0.0471672
	speed: 0.1203s/iter; left time: 5030.8731s
Epoch: 11 cost time: 56.71129393577576
Epoch: 11, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.296 Vali Acc: 0.935 Test Loss: 0.296 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0671397
	speed: 0.5030s/iter; left time: 20945.7471s
	iters: 200, epoch: 12 | loss: 0.3150652
	speed: 0.1162s/iter; left time: 4827.0455s
	iters: 300, epoch: 12 | loss: 0.0049272
	speed: 0.1021s/iter; left time: 4232.7672s
	iters: 400, epoch: 12 | loss: 0.0725382
	speed: 0.1218s/iter; left time: 5036.2381s
Epoch: 12 cost time: 56.376083850860596
Epoch: 12, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.398 Vali Acc: 0.906 Test Loss: 0.398 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3087573
	speed: 0.4897s/iter; left time: 20161.3722s
	iters: 200, epoch: 13 | loss: 0.1549864
	speed: 0.1268s/iter; left time: 5206.9524s
	iters: 300, epoch: 13 | loss: 0.2230968
	speed: 0.1337s/iter; left time: 5478.3789s
	iters: 400, epoch: 13 | loss: 0.0559506
	speed: 0.1096s/iter; left time: 4478.0385s
Epoch: 13 cost time: 56.97370767593384
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0026841
	speed: 0.4723s/iter; left time: 19223.5357s
	iters: 200, epoch: 14 | loss: 0.1710996
	speed: 0.1092s/iter; left time: 4435.0187s
	iters: 300, epoch: 14 | loss: 0.0275545
	speed: 0.1142s/iter; left time: 4623.5326s
	iters: 400, epoch: 14 | loss: 0.0807525
	speed: 0.1182s/iter; left time: 4774.4016s
Epoch: 14 cost time: 53.7368426322937
Epoch: 14, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0065864
	speed: 0.4505s/iter; left time: 18125.6460s
	iters: 200, epoch: 15 | loss: 0.0395446
	speed: 0.1139s/iter; left time: 4570.0292s
	iters: 300, epoch: 15 | loss: 0.6081013
	speed: 0.1097s/iter; left time: 4393.8089s
	iters: 400, epoch: 15 | loss: 0.0008809
	speed: 0.1232s/iter; left time: 4920.0753s
Epoch: 15 cost time: 55.62399196624756
Epoch: 15, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0058160
	speed: 0.4540s/iter; left time: 18052.7010s
	iters: 200, epoch: 16 | loss: 0.0145715
	speed: 0.1185s/iter; left time: 4701.0040s
	iters: 300, epoch: 16 | loss: 0.1231321
	speed: 0.1370s/iter; left time: 5422.4333s
	iters: 400, epoch: 16 | loss: 0.0357424
	speed: 0.1217s/iter; left time: 4802.1863s
Epoch: 16 cost time: 56.03886580467224
Epoch: 16, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0500433
	speed: 0.4483s/iter; left time: 17617.1466s
	iters: 200, epoch: 17 | loss: 0.1063508
	speed: 0.1170s/iter; left time: 4584.3920s
	iters: 300, epoch: 17 | loss: 0.0558918
	speed: 0.1213s/iter; left time: 4742.9891s
	iters: 400, epoch: 17 | loss: 0.0182222
	speed: 0.1224s/iter; left time: 4774.5784s
Epoch: 17 cost time: 56.16113781929016
Epoch: 17, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.294 Vali Acc: 0.938 Test Loss: 0.294 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9571183533447685
model parameter : 2998470
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7511808
	speed: 0.1199s/iter; left time: 5610.5610s
	iters: 200, epoch: 1 | loss: 0.4326535
	speed: 0.0922s/iter; left time: 4305.7196s
	iters: 300, epoch: 1 | loss: 0.0547615
	speed: 0.0896s/iter; left time: 4177.6616s
	iters: 400, epoch: 1 | loss: 0.1887901
	speed: 0.1043s/iter; left time: 4851.9526s
Epoch: 1 cost time: 48.01737833023071
Epoch: 1, Steps: 469 | Train Loss: 0.486 Vali Loss: 0.419 Vali Acc: 0.858 Test Loss: 0.419 Test Acc: 0.858
Validation loss decreased (inf --> -0.858200).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6321777
	speed: 0.3843s/iter; left time: 17805.0524s
	iters: 200, epoch: 2 | loss: 0.1713079
	speed: 0.1150s/iter; left time: 5317.1147s
	iters: 300, epoch: 2 | loss: 0.5369180
	speed: 0.1055s/iter; left time: 4864.6424s
	iters: 400, epoch: 2 | loss: 0.0718987
	speed: 0.0976s/iter; left time: 4493.2515s
Epoch: 2 cost time: 49.737069606781006
Epoch: 2, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.409 Vali Acc: 0.882 Test Loss: 0.409 Test Acc: 0.882
Validation loss decreased (-0.858200 --> -0.881643).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0465720
	speed: 0.3917s/iter; left time: 17966.2506s
	iters: 200, epoch: 3 | loss: 0.3374580
	speed: 0.1009s/iter; left time: 4616.5059s
	iters: 300, epoch: 3 | loss: 0.2865797
	speed: 0.1103s/iter; left time: 5038.7944s
	iters: 400, epoch: 3 | loss: 0.0274787
	speed: 0.0985s/iter; left time: 4486.9850s
Epoch: 3 cost time: 48.45189642906189
Epoch: 3, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.330 Vali Acc: 0.895 Test Loss: 0.330 Test Acc: 0.895
Validation loss decreased (-0.881643 --> -0.895365).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1181525
	speed: 0.4239s/iter; left time: 19242.3351s
	iters: 200, epoch: 4 | loss: 0.0685736
	speed: 0.0939s/iter; left time: 4252.5479s
	iters: 300, epoch: 4 | loss: 0.3048985
	speed: 0.0928s/iter; left time: 4194.3653s
	iters: 400, epoch: 4 | loss: 0.0304795
	speed: 0.0961s/iter; left time: 4331.9103s
Epoch: 4 cost time: 47.17474889755249
Epoch: 4, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
Validation loss decreased (-0.895365 --> -0.930243).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2763776
	speed: 0.3763s/iter; left time: 16906.2332s
	iters: 200, epoch: 5 | loss: 0.0508545
	speed: 0.1057s/iter; left time: 4739.7712s
	iters: 300, epoch: 5 | loss: 0.0101414
	speed: 0.0975s/iter; left time: 4360.7557s
	iters: 400, epoch: 5 | loss: 0.0199076
	speed: 0.1014s/iter; left time: 4524.0920s
Epoch: 5 cost time: 48.469672203063965
Epoch: 5, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.366 Vali Acc: 0.880 Test Loss: 0.366 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0461944
	speed: 0.4027s/iter; left time: 17901.5234s
	iters: 200, epoch: 6 | loss: 0.2005527
	speed: 0.0885s/iter; left time: 3925.5533s
	iters: 300, epoch: 6 | loss: 0.0398388
	speed: 0.0989s/iter; left time: 4376.5870s
	iters: 400, epoch: 6 | loss: 0.0209226
	speed: 0.0940s/iter; left time: 4151.2767s
Epoch: 6 cost time: 46.09831976890564
Epoch: 6, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
Validation loss decreased (-0.930243 --> -0.931672).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0153967
	speed: 0.3898s/iter; left time: 17145.6498s
	iters: 200, epoch: 7 | loss: 0.0142125
	speed: 0.0997s/iter; left time: 4376.4644s
	iters: 300, epoch: 7 | loss: 0.0149324
	speed: 0.1061s/iter; left time: 4644.1611s
	iters: 400, epoch: 7 | loss: 0.0072110
	speed: 0.1006s/iter; left time: 4395.5626s
Epoch: 7 cost time: 47.499499797821045
Epoch: 7, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
Validation loss decreased (-0.931672 --> -0.948540).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0686477
	speed: 0.3944s/iter; left time: 17165.2344s
	iters: 200, epoch: 8 | loss: 0.2963424
	speed: 0.0971s/iter; left time: 4215.6090s
	iters: 300, epoch: 8 | loss: 0.0783464
	speed: 0.0945s/iter; left time: 4092.3176s
	iters: 400, epoch: 8 | loss: 0.1165957
	speed: 0.0877s/iter; left time: 3791.9205s
Epoch: 8 cost time: 45.442893981933594
Epoch: 8, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.948540 --> -0.957974).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0196781
	speed: 0.3993s/iter; left time: 17188.0003s
	iters: 200, epoch: 9 | loss: 0.0223193
	speed: 0.0985s/iter; left time: 4229.6149s
	iters: 300, epoch: 9 | loss: 0.3201177
	speed: 0.1018s/iter; left time: 4362.2380s
	iters: 400, epoch: 9 | loss: 0.1410258
	speed: 0.0932s/iter; left time: 3985.2058s
Epoch: 9 cost time: 47.497040033340454
Epoch: 9, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.232 Vali Acc: 0.945 Test Loss: 0.232 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4149068
	speed: 0.3834s/iter; left time: 16326.6625s
	iters: 200, epoch: 10 | loss: 0.2362165
	speed: 0.0927s/iter; left time: 3939.3122s
	iters: 300, epoch: 10 | loss: 0.2111019
	speed: 0.0903s/iter; left time: 3827.3155s
	iters: 400, epoch: 10 | loss: 0.0170166
	speed: 0.1073s/iter; left time: 4535.9402s
Epoch: 10 cost time: 45.24867868423462
Epoch: 10, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0530142
	speed: 0.3806s/iter; left time: 16027.3561s
	iters: 200, epoch: 11 | loss: 0.5611143
	speed: 0.1099s/iter; left time: 4618.4022s
	iters: 300, epoch: 11 | loss: 0.0035308
	speed: 0.1033s/iter; left time: 4327.8756s
	iters: 400, epoch: 11 | loss: 0.0135209
	speed: 0.1004s/iter; left time: 4195.7700s
Epoch: 11 cost time: 47.55270767211914
Epoch: 11, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0052856
	speed: 0.3683s/iter; left time: 15334.7553s
	iters: 200, epoch: 12 | loss: 0.0539226
	speed: 0.0997s/iter; left time: 4141.4608s
	iters: 300, epoch: 12 | loss: 0.0155604
	speed: 0.1039s/iter; left time: 4307.7672s
	iters: 400, epoch: 12 | loss: 0.3477808
	speed: 0.1036s/iter; left time: 4284.6552s
Epoch: 12 cost time: 47.320889472961426
Epoch: 12, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.293 Vali Acc: 0.934 Test Loss: 0.293 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2264217
	speed: 0.3847s/iter; left time: 15838.6971s
	iters: 200, epoch: 13 | loss: 0.3790866
	speed: 0.0831s/iter; left time: 3414.4464s
	iters: 300, epoch: 13 | loss: 0.0331871
	speed: 0.0930s/iter; left time: 3809.2345s
	iters: 400, epoch: 13 | loss: 0.0028373
	speed: 0.0849s/iter; left time: 3468.4201s
Epoch: 13 cost time: 41.86357259750366
Epoch: 13, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0098531
	speed: 0.3425s/iter; left time: 13939.2484s
	iters: 200, epoch: 14 | loss: 0.0211552
	speed: 0.0921s/iter; left time: 3741.5939s
	iters: 300, epoch: 14 | loss: 0.6320105
	speed: 0.0902s/iter; left time: 3654.1535s
	iters: 400, epoch: 14 | loss: 0.0026564
	speed: 0.0910s/iter; left time: 3676.7279s
Epoch: 14 cost time: 43.995490074157715
Epoch: 14, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.210 Vali Acc: 0.940 Test Loss: 0.210 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0527455
	speed: 0.3643s/iter; left time: 14655.9351s
	iters: 200, epoch: 15 | loss: 0.0426243
	speed: 0.0933s/iter; left time: 3744.7496s
	iters: 300, epoch: 15 | loss: 0.0826925
	speed: 0.0908s/iter; left time: 3633.8690s
	iters: 400, epoch: 15 | loss: 0.0059953
	speed: 0.0786s/iter; left time: 3138.5073s
Epoch: 15 cost time: 42.278132915496826
Epoch: 15, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0102787
	speed: 0.3621s/iter; left time: 14397.3965s
	iters: 200, epoch: 16 | loss: 0.0383018
	speed: 0.0865s/iter; left time: 3429.3569s
	iters: 300, epoch: 16 | loss: 0.0038891
	speed: 0.0973s/iter; left time: 3847.8211s
	iters: 400, epoch: 16 | loss: 0.0085499
	speed: 0.0865s/iter; left time: 3412.9202s
Epoch: 16 cost time: 43.012152671813965
Epoch: 16, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1465854
	speed: 0.3590s/iter; left time: 14109.2608s
	iters: 200, epoch: 17 | loss: 0.0980458
	speed: 0.0861s/iter; left time: 3376.4193s
	iters: 300, epoch: 17 | loss: 0.0011774
	speed: 0.0974s/iter; left time: 3809.6732s
	iters: 400, epoch: 17 | loss: 0.5084705
	speed: 0.1012s/iter; left time: 3944.9820s
Epoch: 17 cost time: 44.137062788009644
Epoch: 17, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.957974 --> -0.963406).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0524739
	speed: 0.3829s/iter; left time: 14867.5240s
	iters: 200, epoch: 18 | loss: 0.0106127
	speed: 0.0898s/iter; left time: 3479.3517s
	iters: 300, epoch: 18 | loss: 0.0021272
	speed: 0.0881s/iter; left time: 3404.5670s
	iters: 400, epoch: 18 | loss: 0.0220244
	speed: 0.0987s/iter; left time: 3803.5343s
Epoch: 18 cost time: 44.30594992637634
Epoch: 18, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.318 Vali Acc: 0.924 Test Loss: 0.318 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0379252
	speed: 0.3534s/iter; left time: 13556.9172s
	iters: 200, epoch: 19 | loss: 0.0045858
	speed: 0.0950s/iter; left time: 3636.3953s
	iters: 300, epoch: 19 | loss: 0.0013786
	speed: 0.0916s/iter; left time: 3494.8121s
	iters: 400, epoch: 19 | loss: 0.1184391
	speed: 0.0942s/iter; left time: 3586.3256s
Epoch: 19 cost time: 43.0620756149292
Epoch: 19, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.343 Vali Acc: 0.933 Test Loss: 0.343 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0120364
	speed: 0.3470s/iter; left time: 13146.7862s
	iters: 200, epoch: 20 | loss: 0.0154515
	speed: 0.0975s/iter; left time: 3685.9339s
	iters: 300, epoch: 20 | loss: 0.0046199
	speed: 0.0779s/iter; left time: 2935.7533s
	iters: 400, epoch: 20 | loss: 0.0476362
	speed: 0.0822s/iter; left time: 3088.7049s
Epoch: 20 cost time: 40.79001569747925
Epoch: 20, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.204 Vali Acc: 0.961 Test Loss: 0.204 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0221750
	speed: 0.3484s/iter; left time: 13038.2406s
	iters: 200, epoch: 21 | loss: 0.0199364
	speed: 0.0905s/iter; left time: 3377.6510s
	iters: 300, epoch: 21 | loss: 0.0201357
	speed: 0.0892s/iter; left time: 3321.1914s
	iters: 400, epoch: 21 | loss: 0.0112923
	speed: 0.0927s/iter; left time: 3440.3202s
Epoch: 21 cost time: 43.051273584365845
Epoch: 21, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0031911
	speed: 0.3472s/iter; left time: 12828.4659s
	iters: 200, epoch: 22 | loss: 0.0025577
	speed: 0.0896s/iter; left time: 3300.4905s
	iters: 300, epoch: 22 | loss: 0.0205627
	speed: 0.0845s/iter; left time: 3104.9467s
	iters: 400, epoch: 22 | loss: 0.0296803
	speed: 0.0791s/iter; left time: 2900.2511s
Epoch: 22 cost time: 40.76563000679016
Epoch: 22, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2941309
	speed: 0.3766s/iter; left time: 13738.8928s
	iters: 200, epoch: 23 | loss: 0.0588991
	speed: 0.0996s/iter; left time: 3622.7224s
	iters: 300, epoch: 23 | loss: 0.0009966
	speed: 0.0890s/iter; left time: 3228.7947s
	iters: 400, epoch: 23 | loss: 0.0097584
	speed: 0.1022s/iter; left time: 3697.3002s
Epoch: 23 cost time: 45.446260929107666
Epoch: 23, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0484700
	speed: 0.3598s/iter; left time: 12959.4235s
	iters: 200, epoch: 24 | loss: 0.0459136
	speed: 0.0911s/iter; left time: 3272.0176s
	iters: 300, epoch: 24 | loss: 0.0022830
	speed: 0.0886s/iter; left time: 3171.7025s
	iters: 400, epoch: 24 | loss: 0.0314398
	speed: 0.0894s/iter; left time: 3193.1147s
Epoch: 24 cost time: 42.258896589279175
Epoch: 24, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0016985
	speed: 0.3650s/iter; left time: 12972.9939s
	iters: 200, epoch: 25 | loss: 0.0021878
	speed: 0.0986s/iter; left time: 3494.4594s
	iters: 300, epoch: 25 | loss: 0.0158742
	speed: 0.0934s/iter; left time: 3300.5765s
	iters: 400, epoch: 25 | loss: 0.0173528
	speed: 0.0974s/iter; left time: 3431.9677s
Epoch: 25 cost time: 44.815550804138184
Epoch: 25, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.3005959
	speed: 0.3395s/iter; left time: 11909.5076s
	iters: 200, epoch: 26 | loss: 0.2238609
	speed: 0.0888s/iter; left time: 3105.9589s
	iters: 300, epoch: 26 | loss: 0.0012048
	speed: 0.0996s/iter; left time: 3474.7944s
	iters: 400, epoch: 26 | loss: 0.0041429
	speed: 0.0807s/iter; left time: 2807.7746s
Epoch: 26 cost time: 42.42982840538025
Epoch: 26, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0835158
	speed: 0.3335s/iter; left time: 11540.3182s
	iters: 200, epoch: 27 | loss: 0.1513151
	speed: 0.0935s/iter; left time: 3226.0050s
	iters: 300, epoch: 27 | loss: 0.0083256
	speed: 0.0847s/iter; left time: 2915.7796s
	iters: 400, epoch: 27 | loss: 0.0114462
	speed: 0.0857s/iter; left time: 2940.1104s
Epoch: 27 cost time: 42.3144588470459
Epoch: 27, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.968838).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0268789
	speed: 0.3581s/iter; left time: 12224.3302s
	iters: 200, epoch: 28 | loss: 0.0123843
	speed: 0.0933s/iter; left time: 3176.6728s
	iters: 300, epoch: 28 | loss: 0.2862193
	speed: 0.0875s/iter; left time: 2970.6969s
	iters: 400, epoch: 28 | loss: 0.0059412
	speed: 0.0965s/iter; left time: 3265.9656s
Epoch: 28 cost time: 43.48434495925903
Epoch: 28, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0043066
	speed: 0.3755s/iter; left time: 12643.2647s
	iters: 200, epoch: 29 | loss: 0.0132486
	speed: 0.0932s/iter; left time: 3127.8816s
	iters: 300, epoch: 29 | loss: 0.0040551
	speed: 0.0931s/iter; left time: 3117.3183s
	iters: 400, epoch: 29 | loss: 0.0156128
	speed: 0.0826s/iter; left time: 2755.8166s
Epoch: 29 cost time: 42.60744786262512
Epoch: 29, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.214 Vali Acc: 0.955 Test Loss: 0.214 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.3417459
	speed: 0.3643s/iter; left time: 12094.0447s
	iters: 200, epoch: 30 | loss: 0.3388799
	speed: 0.0951s/iter; left time: 3147.0738s
	iters: 300, epoch: 30 | loss: 0.0046043
	speed: 0.0865s/iter; left time: 2854.2201s
	iters: 400, epoch: 30 | loss: 0.0205149
	speed: 0.0944s/iter; left time: 3105.4235s
Epoch: 30 cost time: 43.91601848602295
Epoch: 30, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0011714
	speed: 0.3595s/iter; left time: 11768.0419s
	iters: 200, epoch: 31 | loss: 0.0061661
	speed: 0.0842s/iter; left time: 2748.6911s
	iters: 300, epoch: 31 | loss: 0.0025943
	speed: 0.0852s/iter; left time: 2771.8540s
	iters: 400, epoch: 31 | loss: 0.0044563
	speed: 0.0909s/iter; left time: 2948.8758s
Epoch: 31 cost time: 41.36750602722168
Epoch: 31, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0005002
	speed: 0.3654s/iter; left time: 11788.0149s
	iters: 200, epoch: 32 | loss: 0.0024637
	speed: 0.0898s/iter; left time: 2888.9337s
	iters: 300, epoch: 32 | loss: 0.0010845
	speed: 0.0830s/iter; left time: 2660.8362s
	iters: 400, epoch: 32 | loss: 0.0070417
	speed: 0.0899s/iter; left time: 2872.8103s
Epoch: 32 cost time: 41.86649513244629
Epoch: 32, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.267 Vali Acc: 0.945 Test Loss: 0.267 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0007875
	speed: 0.3452s/iter; left time: 10973.8618s
	iters: 200, epoch: 33 | loss: 0.0017456
	speed: 0.0963s/iter; left time: 3051.4332s
	iters: 300, epoch: 33 | loss: 0.0032395
	speed: 0.0928s/iter; left time: 2932.6553s
	iters: 400, epoch: 33 | loss: 0.0016289
	speed: 0.0919s/iter; left time: 2893.3733s
Epoch: 33 cost time: 43.50735425949097
Epoch: 33, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0114936
	speed: 0.3600s/iter; left time: 11275.8334s
	iters: 200, epoch: 34 | loss: 0.0519008
	speed: 0.0894s/iter; left time: 2791.3858s
	iters: 300, epoch: 34 | loss: 0.0044576
	speed: 0.0871s/iter; left time: 2711.8752s
	iters: 400, epoch: 34 | loss: 0.0069710
	speed: 0.0843s/iter; left time: 2615.2146s
Epoch: 34 cost time: 41.32001447677612
Epoch: 34, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0180114
	speed: 0.3426s/iter; left time: 10569.7018s
	iters: 200, epoch: 35 | loss: 0.0051953
	speed: 0.0835s/iter; left time: 2566.9464s
	iters: 300, epoch: 35 | loss: 0.0350477
	speed: 0.0844s/iter; left time: 2588.7956s
	iters: 400, epoch: 35 | loss: 0.0254891
	speed: 0.0875s/iter; left time: 2673.7251s
Epoch: 35 cost time: 40.6817991733551
Epoch: 35, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0471592
	speed: 0.3403s/iter; left time: 10341.3300s
	iters: 200, epoch: 36 | loss: 0.0371754
	speed: 0.0803s/iter; left time: 2432.9308s
	iters: 300, epoch: 36 | loss: 0.0019284
	speed: 0.0865s/iter; left time: 2611.1530s
	iters: 400, epoch: 36 | loss: 0.0024272
	speed: 0.0817s/iter; left time: 2459.4863s
Epoch: 36 cost time: 39.360039472579956
Epoch: 36, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0032822
	speed: 0.3463s/iter; left time: 10361.5696s
	iters: 200, epoch: 37 | loss: 0.1359400
	speed: 0.0859s/iter; left time: 2559.9872s
	iters: 300, epoch: 37 | loss: 0.0013477
	speed: 0.0883s/iter; left time: 2623.3348s
	iters: 400, epoch: 37 | loss: 0.0054553
	speed: 0.0867s/iter; left time: 2568.1232s
Epoch: 37 cost time: 41.57109522819519
Epoch: 37, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.968839336763865
model parameter : 2997958
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3760008
	speed: 0.1065s/iter; left time: 4985.6386s
	iters: 200, epoch: 1 | loss: 0.3643615
	speed: 0.0884s/iter; left time: 4126.3376s
	iters: 300, epoch: 1 | loss: 0.1451084
	speed: 0.0896s/iter; left time: 4177.1024s
	iters: 400, epoch: 1 | loss: 0.2328132
	speed: 0.0933s/iter; left time: 4337.8544s
Epoch: 1 cost time: 43.870176792144775
Epoch: 1, Steps: 469 | Train Loss: 0.504 Vali Loss: 0.416 Vali Acc: 0.859 Test Loss: 0.416 Test Acc: 0.859
Validation loss decreased (inf --> -0.859058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3986574
	speed: 0.3568s/iter; left time: 16530.8408s
	iters: 200, epoch: 2 | loss: 0.0225500
	speed: 0.1062s/iter; left time: 4910.6751s
	iters: 300, epoch: 2 | loss: 0.4396436
	speed: 0.0946s/iter; left time: 4363.8367s
	iters: 400, epoch: 2 | loss: 0.3056874
	speed: 0.1024s/iter; left time: 4712.6965s
Epoch: 2 cost time: 46.308855295181274
Epoch: 2, Steps: 469 | Train Loss: 0.196 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.859058 --> -0.917378).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0128771
	speed: 0.3583s/iter; left time: 16432.8627s
	iters: 200, epoch: 3 | loss: 0.0466020
	speed: 0.0804s/iter; left time: 3680.9913s
	iters: 300, epoch: 3 | loss: 0.0506544
	speed: 0.0876s/iter; left time: 3998.2011s
	iters: 400, epoch: 3 | loss: 0.0289886
	speed: 0.0889s/iter; left time: 4051.0674s
Epoch: 3 cost time: 40.84014844894409
Epoch: 3, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1410620
	speed: 0.3644s/iter; left time: 16541.5227s
	iters: 200, epoch: 4 | loss: 0.0449958
	speed: 0.0893s/iter; left time: 4046.2520s
	iters: 300, epoch: 4 | loss: 0.1318669
	speed: 0.0876s/iter; left time: 3959.1963s
	iters: 400, epoch: 4 | loss: 0.0811653
	speed: 0.0981s/iter; left time: 4425.6274s
Epoch: 4 cost time: 44.08436059951782
Epoch: 4, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
Validation loss decreased (-0.917378 --> -0.919379).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0116498
	speed: 0.3489s/iter; left time: 15675.2253s
	iters: 200, epoch: 5 | loss: 0.0103545
	speed: 0.0953s/iter; left time: 4271.0762s
	iters: 300, epoch: 5 | loss: 0.0338944
	speed: 0.0873s/iter; left time: 3905.9793s
	iters: 400, epoch: 5 | loss: 0.1492902
	speed: 0.0905s/iter; left time: 4039.4868s
Epoch: 5 cost time: 41.98287892341614
Epoch: 5, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.919379 --> -0.941107).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0617979
	speed: 0.3584s/iter; left time: 15932.0333s
	iters: 200, epoch: 6 | loss: 0.0310091
	speed: 0.0962s/iter; left time: 4266.5273s
	iters: 300, epoch: 6 | loss: 0.1191528
	speed: 0.0947s/iter; left time: 4191.8707s
	iters: 400, epoch: 6 | loss: 0.0360746
	speed: 0.0885s/iter; left time: 3909.6863s
Epoch: 6 cost time: 44.71820068359375
Epoch: 6, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.274 Vali Acc: 0.928 Test Loss: 0.274 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2661079
	speed: 0.3561s/iter; left time: 15664.8942s
	iters: 200, epoch: 7 | loss: 0.1065412
	speed: 0.0949s/iter; left time: 4162.9815s
	iters: 300, epoch: 7 | loss: 0.0297854
	speed: 0.0905s/iter; left time: 3964.9050s
	iters: 400, epoch: 7 | loss: 0.1470584
	speed: 0.0889s/iter; left time: 3884.3275s
Epoch: 7 cost time: 42.63852000236511
Epoch: 7, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0930805
	speed: 0.3673s/iter; left time: 15982.8044s
	iters: 200, epoch: 8 | loss: 0.2142209
	speed: 0.0915s/iter; left time: 3974.2269s
	iters: 300, epoch: 8 | loss: 0.4667507
	speed: 0.0804s/iter; left time: 3482.3392s
	iters: 400, epoch: 8 | loss: 0.0466327
	speed: 0.0863s/iter; left time: 3728.0925s
Epoch: 8 cost time: 41.63844132423401
Epoch: 8, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.941107 --> -0.946253).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2791513
	speed: 0.3712s/iter; left time: 15981.6744s
	iters: 200, epoch: 9 | loss: 0.0195642
	speed: 0.0877s/iter; left time: 3767.4108s
	iters: 300, epoch: 9 | loss: 0.0912779
	speed: 0.0930s/iter; left time: 3985.4508s
	iters: 400, epoch: 9 | loss: 0.1754465
	speed: 0.0972s/iter; left time: 4154.3570s
Epoch: 9 cost time: 44.18528723716736
Epoch: 9, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
Validation loss decreased (-0.946253 --> -0.948826).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0142421
	speed: 0.3707s/iter; left time: 15784.4154s
	iters: 200, epoch: 10 | loss: 0.0081662
	speed: 0.0853s/iter; left time: 3622.8492s
	iters: 300, epoch: 10 | loss: 0.0570072
	speed: 0.0887s/iter; left time: 3760.4041s
	iters: 400, epoch: 10 | loss: 0.0198663
	speed: 0.0863s/iter; left time: 3648.9495s
Epoch: 10 cost time: 41.121904611587524
Epoch: 10, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2364622
	speed: 0.3556s/iter; left time: 14972.9673s
	iters: 200, epoch: 11 | loss: 0.0081130
	speed: 0.0904s/iter; left time: 3796.4833s
	iters: 300, epoch: 11 | loss: 0.0941148
	speed: 0.0877s/iter; left time: 3676.0873s
	iters: 400, epoch: 11 | loss: 0.0309960
	speed: 0.0937s/iter; left time: 3916.3614s
Epoch: 11 cost time: 43.62102222442627
Epoch: 11, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0064219
	speed: 0.3512s/iter; left time: 14625.0090s
	iters: 200, epoch: 12 | loss: 0.0667656
	speed: 0.0967s/iter; left time: 4018.4821s
	iters: 300, epoch: 12 | loss: 0.0021279
	speed: 0.0939s/iter; left time: 3892.1746s
	iters: 400, epoch: 12 | loss: 0.0374072
	speed: 0.0961s/iter; left time: 3971.9005s
Epoch: 12 cost time: 44.135011434555054
Epoch: 12, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
Validation loss decreased (-0.948826 --> -0.957402).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0245913
	speed: 0.3853s/iter; left time: 15862.7809s
	iters: 200, epoch: 13 | loss: 0.3426552
	speed: 0.0989s/iter; left time: 4063.7871s
	iters: 300, epoch: 13 | loss: 0.0782218
	speed: 0.0955s/iter; left time: 3914.7884s
	iters: 400, epoch: 13 | loss: 0.0768981
	speed: 0.0986s/iter; left time: 4031.2579s
Epoch: 13 cost time: 45.16795611381531
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1028297
	speed: 0.3545s/iter; left time: 14429.5967s
	iters: 200, epoch: 14 | loss: 0.0046319
	speed: 0.0854s/iter; left time: 3466.2934s
	iters: 300, epoch: 14 | loss: 0.2644110
	speed: 0.0945s/iter; left time: 3827.2857s
	iters: 400, epoch: 14 | loss: 0.3239475
	speed: 0.0850s/iter; left time: 3434.0812s
Epoch: 14 cost time: 42.494518995285034
Epoch: 14, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4839267
	speed: 0.3646s/iter; left time: 14670.3823s
	iters: 200, epoch: 15 | loss: 0.0729327
	speed: 0.0927s/iter; left time: 3718.6891s
	iters: 300, epoch: 15 | loss: 0.3709976
	speed: 0.0860s/iter; left time: 3443.3228s
	iters: 400, epoch: 15 | loss: 0.0300970
	speed: 0.0837s/iter; left time: 3342.3577s
Epoch: 15 cost time: 41.52759051322937
Epoch: 15, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0433904
	speed: 0.3555s/iter; left time: 14135.0377s
	iters: 200, epoch: 16 | loss: 0.0329474
	speed: 0.0879s/iter; left time: 3487.9814s
	iters: 300, epoch: 16 | loss: 0.0389236
	speed: 0.0846s/iter; left time: 3345.7983s
	iters: 400, epoch: 16 | loss: 0.0146618
	speed: 0.0883s/iter; left time: 3484.2825s
Epoch: 16 cost time: 42.65100955963135
Epoch: 16, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2378725
	speed: 0.3722s/iter; left time: 14626.1760s
	iters: 200, epoch: 17 | loss: 0.0365180
	speed: 0.0874s/iter; left time: 3427.0872s
	iters: 300, epoch: 17 | loss: 0.0068433
	speed: 0.0964s/iter; left time: 3769.0864s
	iters: 400, epoch: 17 | loss: 0.1998214
	speed: 0.0915s/iter; left time: 3569.7929s
Epoch: 17 cost time: 43.60574245452881
Epoch: 17, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.957402 --> -0.958832).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0724152
	speed: 0.3941s/iter; left time: 15300.8160s
	iters: 200, epoch: 18 | loss: 0.2642589
	speed: 0.0938s/iter; left time: 3631.4926s
	iters: 300, epoch: 18 | loss: 0.0168696
	speed: 0.0993s/iter; left time: 3836.9028s
	iters: 400, epoch: 18 | loss: 0.2419822
	speed: 0.0890s/iter; left time: 3428.3052s
Epoch: 18 cost time: 44.79046130180359
Epoch: 18, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4044058
	speed: 0.3363s/iter; left time: 12900.1879s
	iters: 200, epoch: 19 | loss: 0.0064681
	speed: 0.0804s/iter; left time: 3077.4262s
	iters: 300, epoch: 19 | loss: 0.0196533
	speed: 0.0855s/iter; left time: 3261.8955s
	iters: 400, epoch: 19 | loss: 0.3360334
	speed: 0.0814s/iter; left time: 3099.1905s
Epoch: 19 cost time: 39.60834074020386
Epoch: 19, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
Validation loss decreased (-0.958832 --> -0.961119).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0029061
	speed: 0.3367s/iter; left time: 12757.9769s
	iters: 200, epoch: 20 | loss: 0.0507249
	speed: 0.0808s/iter; left time: 3053.4227s
	iters: 300, epoch: 20 | loss: 0.0143692
	speed: 0.0932s/iter; left time: 3514.1686s
	iters: 400, epoch: 20 | loss: 0.0039976
	speed: 0.0871s/iter; left time: 3273.2569s
Epoch: 20 cost time: 40.62823414802551
Epoch: 20, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0224351
	speed: 0.3173s/iter; left time: 11873.9867s
	iters: 200, epoch: 21 | loss: 0.0374126
	speed: 0.0912s/iter; left time: 3404.9550s
	iters: 300, epoch: 21 | loss: 0.0035275
	speed: 0.0849s/iter; left time: 3160.0471s
	iters: 400, epoch: 21 | loss: 0.0847450
	speed: 0.0774s/iter; left time: 2872.5398s
Epoch: 21 cost time: 40.36074495315552
Epoch: 21, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0115618
	speed: 0.3582s/iter; left time: 13237.6755s
	iters: 200, epoch: 22 | loss: 0.3098190
	speed: 0.0908s/iter; left time: 3344.5351s
	iters: 300, epoch: 22 | loss: 0.0320221
	speed: 0.0809s/iter; left time: 2974.5558s
	iters: 400, epoch: 22 | loss: 0.0541830
	speed: 0.0836s/iter; left time: 3065.5865s
Epoch: 22 cost time: 41.74612355232239
Epoch: 22, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.304 Vali Acc: 0.916 Test Loss: 0.304 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0086954
	speed: 0.3607s/iter; left time: 13158.6564s
	iters: 200, epoch: 23 | loss: 0.0036323
	speed: 0.0981s/iter; left time: 3568.5673s
	iters: 300, epoch: 23 | loss: 0.0135645
	speed: 0.0953s/iter; left time: 3458.2496s
	iters: 400, epoch: 23 | loss: 0.0395668
	speed: 0.0960s/iter; left time: 3472.5570s
Epoch: 23 cost time: 44.6788547039032
Epoch: 23, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0310451
	speed: 0.3532s/iter; left time: 12719.4271s
	iters: 200, epoch: 24 | loss: 0.0044772
	speed: 0.0870s/iter; left time: 3123.0138s
	iters: 300, epoch: 24 | loss: 0.0188366
	speed: 0.0761s/iter; left time: 2724.4740s
	iters: 400, epoch: 24 | loss: 0.0450121
	speed: 0.0920s/iter; left time: 3284.3000s
Epoch: 24 cost time: 41.18209099769592
Epoch: 24, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0059836
	speed: 0.3403s/iter; left time: 12094.2286s
	iters: 200, epoch: 25 | loss: 0.0080040
	speed: 0.0898s/iter; left time: 3182.2406s
	iters: 300, epoch: 25 | loss: 0.1329160
	speed: 0.0843s/iter; left time: 2978.8416s
	iters: 400, epoch: 25 | loss: 0.0031710
	speed: 0.0829s/iter; left time: 2920.2283s
Epoch: 25 cost time: 40.14026999473572
Epoch: 25, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.273 Vali Acc: 0.942 Test Loss: 0.273 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4023049
	speed: 0.3325s/iter; left time: 11663.8608s
	iters: 200, epoch: 26 | loss: 0.0106439
	speed: 0.0810s/iter; left time: 2832.2945s
	iters: 300, epoch: 26 | loss: 0.0055956
	speed: 0.0826s/iter; left time: 2880.6206s
	iters: 400, epoch: 26 | loss: 0.0668298
	speed: 0.0848s/iter; left time: 2949.9353s
Epoch: 26 cost time: 39.13089466094971
Epoch: 26, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0121120
	speed: 0.3561s/iter; left time: 12325.2640s
	iters: 200, epoch: 27 | loss: 0.0254546
	speed: 0.0898s/iter; left time: 3097.6795s
	iters: 300, epoch: 27 | loss: 0.0033874
	speed: 0.0969s/iter; left time: 3333.1868s
	iters: 400, epoch: 27 | loss: 0.0182389
	speed: 0.0819s/iter; left time: 2808.6263s
Epoch: 27 cost time: 43.35880255699158
Epoch: 27, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0406670
	speed: 0.3562s/iter; left time: 12159.5682s
	iters: 200, epoch: 28 | loss: 0.5737889
	speed: 0.0910s/iter; left time: 3098.6404s
	iters: 300, epoch: 28 | loss: 0.0063032
	speed: 0.0935s/iter; left time: 3173.5549s
	iters: 400, epoch: 28 | loss: 0.0016514
	speed: 0.0890s/iter; left time: 3011.7020s
Epoch: 28 cost time: 43.20418667793274
Epoch: 28, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0032796
	speed: 0.3565s/iter; left time: 12003.4117s
	iters: 200, epoch: 29 | loss: 0.1758131
	speed: 0.0837s/iter; left time: 2809.0972s
	iters: 300, epoch: 29 | loss: 0.0063048
	speed: 0.0806s/iter; left time: 2698.8504s
	iters: 400, epoch: 29 | loss: 0.0035950
	speed: 0.0804s/iter; left time: 2681.6041s
Epoch: 29 cost time: 39.95327401161194
Epoch: 29, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9611206403659234
model parameter : 2703430
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3808818
	speed: 0.0984s/iter; left time: 4606.4259s
	iters: 200, epoch: 1 | loss: 0.4687358
	speed: 0.0879s/iter; left time: 4105.1294s
	iters: 300, epoch: 1 | loss: 0.1172352
	speed: 0.0872s/iter; left time: 4063.8316s
	iters: 400, epoch: 1 | loss: 0.1585762
	speed: 0.0918s/iter; left time: 4270.9333s
Epoch: 1 cost time: 42.17292237281799
Epoch: 1, Steps: 469 | Train Loss: 0.527 Vali Loss: 0.304 Vali Acc: 0.912 Test Loss: 0.304 Test Acc: 0.912
Validation loss decreased (inf --> -0.911661).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3332215
	speed: 0.3240s/iter; left time: 15009.8795s
	iters: 200, epoch: 2 | loss: 0.6140500
	speed: 0.0882s/iter; left time: 4078.1743s
	iters: 300, epoch: 2 | loss: 0.0542812
	speed: 0.0851s/iter; left time: 3926.3765s
	iters: 400, epoch: 2 | loss: 0.2818672
	speed: 0.0890s/iter; left time: 4097.7478s
Epoch: 2 cost time: 41.35428428649902
Epoch: 2, Steps: 469 | Train Loss: 0.186 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.911661 --> -0.915377).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1796905
	speed: 0.3518s/iter; left time: 16136.4111s
	iters: 200, epoch: 3 | loss: 0.2905956
	speed: 0.0919s/iter; left time: 4207.3672s
	iters: 300, epoch: 3 | loss: 0.6427986
	speed: 0.0941s/iter; left time: 4296.9182s
	iters: 400, epoch: 3 | loss: 0.0630643
	speed: 0.0802s/iter; left time: 3652.8606s
Epoch: 3 cost time: 42.47028112411499
Epoch: 3, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.261 Vali Acc: 0.918 Test Loss: 0.261 Test Acc: 0.918
Validation loss decreased (-0.915377 --> -0.917951).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7877333
	speed: 0.3750s/iter; left time: 17024.1099s
	iters: 200, epoch: 4 | loss: 0.0990264
	speed: 0.0880s/iter; left time: 3986.4490s
	iters: 300, epoch: 4 | loss: 0.4333298
	speed: 0.0931s/iter; left time: 4206.0336s
	iters: 400, epoch: 4 | loss: 0.0580364
	speed: 0.0906s/iter; left time: 4083.9703s
Epoch: 4 cost time: 44.15792202949524
Epoch: 4, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.250 Vali Acc: 0.923 Test Loss: 0.250 Test Acc: 0.923
Validation loss decreased (-0.917951 --> -0.922811).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8855815
	speed: 0.3524s/iter; left time: 15833.0484s
	iters: 200, epoch: 5 | loss: 0.2639273
	speed: 0.0854s/iter; left time: 3830.0230s
	iters: 300, epoch: 5 | loss: 0.2149518
	speed: 0.0782s/iter; left time: 3498.8383s
	iters: 400, epoch: 5 | loss: 0.5103177
	speed: 0.0861s/iter; left time: 3841.1489s
Epoch: 5 cost time: 40.68422198295593
Epoch: 5, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.307 Vali Acc: 0.888 Test Loss: 0.307 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1194050
	speed: 0.3655s/iter; left time: 16248.6413s
	iters: 200, epoch: 6 | loss: 0.0205966
	speed: 0.0976s/iter; left time: 4329.5248s
	iters: 300, epoch: 6 | loss: 0.1787793
	speed: 0.0894s/iter; left time: 3954.5761s
	iters: 400, epoch: 6 | loss: 0.3608313
	speed: 0.0897s/iter; left time: 3959.6782s
Epoch: 6 cost time: 43.036712646484375
Epoch: 6, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0466291
	speed: 0.3301s/iter; left time: 14519.2838s
	iters: 200, epoch: 7 | loss: 0.1693302
	speed: 0.0825s/iter; left time: 3620.0605s
	iters: 300, epoch: 7 | loss: 0.0825497
	speed: 0.0858s/iter; left time: 3756.5764s
	iters: 400, epoch: 7 | loss: 0.2538203
	speed: 0.0844s/iter; left time: 3685.2654s
Epoch: 7 cost time: 40.00264763832092
Epoch: 7, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0609951
	speed: 0.3613s/iter; left time: 15722.4058s
	iters: 200, epoch: 8 | loss: 0.1006073
	speed: 0.0964s/iter; left time: 4184.3191s
	iters: 300, epoch: 8 | loss: 0.3155596
	speed: 0.0919s/iter; left time: 3979.5535s
	iters: 400, epoch: 8 | loss: 0.0604893
	speed: 0.0875s/iter; left time: 3782.9777s
Epoch: 8 cost time: 44.386327266693115
Epoch: 8, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.922811 --> -0.940535).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0312524
	speed: 0.3415s/iter; left time: 14702.5979s
	iters: 200, epoch: 9 | loss: 0.0529036
	speed: 0.1093s/iter; left time: 4695.8446s
	iters: 300, epoch: 9 | loss: 0.0301978
	speed: 0.0877s/iter; left time: 3759.4462s
	iters: 400, epoch: 9 | loss: 0.0914091
	speed: 0.0942s/iter; left time: 4025.4224s
Epoch: 9 cost time: 45.88956022262573
Epoch: 9, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0295175
	speed: 0.3619s/iter; left time: 15407.8658s
	iters: 200, epoch: 10 | loss: 0.0028642
	speed: 0.0817s/iter; left time: 3472.1726s
	iters: 300, epoch: 10 | loss: 0.0618211
	speed: 0.0858s/iter; left time: 3637.2229s
	iters: 400, epoch: 10 | loss: 0.1590715
	speed: 0.0831s/iter; left time: 3511.5022s
Epoch: 10 cost time: 39.888757944107056
Epoch: 10, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.217 Vali Acc: 0.945 Test Loss: 0.217 Test Acc: 0.945
Validation loss decreased (-0.940535 --> -0.945395).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1534240
	speed: 0.3553s/iter; left time: 14961.7844s
	iters: 200, epoch: 11 | loss: 0.0104800
	speed: 0.0854s/iter; left time: 3586.5646s
	iters: 300, epoch: 11 | loss: 0.0158033
	speed: 0.0871s/iter; left time: 3650.4511s
	iters: 400, epoch: 11 | loss: 0.6039665
	speed: 0.0983s/iter; left time: 4109.6267s
Epoch: 11 cost time: 43.24646353721619
Epoch: 11, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.342 Vali Acc: 0.914 Test Loss: 0.342 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2600068
	speed: 0.3544s/iter; left time: 14758.5298s
	iters: 200, epoch: 12 | loss: 0.0272604
	speed: 0.0759s/iter; left time: 3152.7560s
	iters: 300, epoch: 12 | loss: 0.0573678
	speed: 0.0820s/iter; left time: 3399.2146s
	iters: 400, epoch: 12 | loss: 0.6215682
	speed: 0.0862s/iter; left time: 3561.7764s
Epoch: 12 cost time: 39.94278168678284
Epoch: 12, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.199 Vali Acc: 0.945 Test Loss: 0.199 Test Acc: 0.945
Validation loss decreased (-0.945395 --> -0.945395).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1914927
	speed: 0.3400s/iter; left time: 13998.7888s
	iters: 200, epoch: 13 | loss: 0.5290181
	speed: 0.0967s/iter; left time: 3973.4195s
	iters: 300, epoch: 13 | loss: 0.1478946
	speed: 0.0944s/iter; left time: 3868.3566s
	iters: 400, epoch: 13 | loss: 0.1783297
	speed: 0.0917s/iter; left time: 3747.7152s
Epoch: 13 cost time: 43.443692207336426
Epoch: 13, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.273 Vali Acc: 0.929 Test Loss: 0.273 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0207439
	speed: 0.3585s/iter; left time: 14593.0327s
	iters: 200, epoch: 14 | loss: 0.0337804
	speed: 0.0966s/iter; left time: 3922.9862s
	iters: 300, epoch: 14 | loss: 0.3315673
	speed: 0.0961s/iter; left time: 3892.6583s
	iters: 400, epoch: 14 | loss: 0.0171651
	speed: 0.0945s/iter; left time: 3816.2851s
Epoch: 14 cost time: 44.72758388519287
Epoch: 14, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0064093
	speed: 0.3699s/iter; left time: 14882.5154s
	iters: 200, epoch: 15 | loss: 0.0087652
	speed: 0.0906s/iter; left time: 3634.7590s
	iters: 300, epoch: 15 | loss: 0.0352282
	speed: 0.0911s/iter; left time: 3647.6300s
	iters: 400, epoch: 15 | loss: 0.2175350
	speed: 0.0907s/iter; left time: 3622.8455s
Epoch: 15 cost time: 42.57813620567322
Epoch: 15, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.281 Vali Acc: 0.923 Test Loss: 0.281 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1441099
	speed: 0.3475s/iter; left time: 13817.9725s
	iters: 200, epoch: 16 | loss: 0.0574837
	speed: 0.0943s/iter; left time: 3741.4157s
	iters: 300, epoch: 16 | loss: 0.0281187
	speed: 0.0930s/iter; left time: 3678.9093s
	iters: 400, epoch: 16 | loss: 0.2211196
	speed: 0.0882s/iter; left time: 3479.5801s
Epoch: 16 cost time: 43.122066020965576
Epoch: 16, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.945395 --> -0.963120).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0712380
	speed: 0.3678s/iter; left time: 14452.9504s
	iters: 200, epoch: 17 | loss: 0.0082960
	speed: 0.0905s/iter; left time: 3547.2729s
	iters: 300, epoch: 17 | loss: 0.0216576
	speed: 0.0834s/iter; left time: 3261.7175s
	iters: 400, epoch: 17 | loss: 0.0057390
	speed: 0.0767s/iter; left time: 2990.1550s
Epoch: 17 cost time: 40.284658908843994
Epoch: 17, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0337959
	speed: 0.3234s/iter; left time: 12555.6903s
	iters: 200, epoch: 18 | loss: 0.0072258
	speed: 0.0869s/iter; left time: 3366.2075s
	iters: 300, epoch: 18 | loss: 0.0132896
	speed: 0.0872s/iter; left time: 3367.4836s
	iters: 400, epoch: 18 | loss: 0.2166201
	speed: 0.0860s/iter; left time: 3313.9040s
Epoch: 18 cost time: 41.76376295089722
Epoch: 18, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0248972
	speed: 0.3646s/iter; left time: 13986.4655s
	iters: 200, epoch: 19 | loss: 0.1254479
	speed: 0.0913s/iter; left time: 3492.9138s
	iters: 300, epoch: 19 | loss: 0.0035875
	speed: 0.0938s/iter; left time: 3581.0639s
	iters: 400, epoch: 19 | loss: 0.3603613
	speed: 0.0876s/iter; left time: 3332.7377s
Epoch: 19 cost time: 43.21889925003052
Epoch: 19, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0043553
	speed: 0.3623s/iter; left time: 13726.9286s
	iters: 200, epoch: 20 | loss: 0.4055071
	speed: 0.0950s/iter; left time: 3589.9285s
	iters: 300, epoch: 20 | loss: 0.0025308
	speed: 0.0934s/iter; left time: 3520.5023s
	iters: 400, epoch: 20 | loss: 0.0422861
	speed: 0.0900s/iter; left time: 3384.0289s
Epoch: 20 cost time: 43.04598808288574
Epoch: 20, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.426 Vali Acc: 0.906 Test Loss: 0.426 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0049143
	speed: 0.3639s/iter; left time: 13617.6793s
	iters: 200, epoch: 21 | loss: 0.2998737
	speed: 0.0828s/iter; left time: 3091.6392s
	iters: 300, epoch: 21 | loss: 0.0122859
	speed: 0.0831s/iter; left time: 3093.8931s
	iters: 400, epoch: 21 | loss: 0.0255086
	speed: 0.0881s/iter; left time: 3269.4448s
Epoch: 21 cost time: 41.023162603378296
Epoch: 21, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0108574
	speed: 0.3440s/iter; left time: 12710.3199s
	iters: 200, epoch: 22 | loss: 0.0030383
	speed: 0.0808s/iter; left time: 2976.6522s
	iters: 300, epoch: 22 | loss: 0.0089717
	speed: 0.0958s/iter; left time: 3519.7210s
	iters: 400, epoch: 22 | loss: 0.0660388
	speed: 0.0871s/iter; left time: 3192.3668s
Epoch: 22 cost time: 41.564502477645874
Epoch: 22, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0055018
	speed: 0.3402s/iter; left time: 12412.8417s
	iters: 200, epoch: 23 | loss: 0.0066334
	speed: 0.0956s/iter; left time: 3477.5917s
	iters: 300, epoch: 23 | loss: 0.0252732
	speed: 0.0931s/iter; left time: 3379.7543s
	iters: 400, epoch: 23 | loss: 0.1115470
	speed: 0.0886s/iter; left time: 3206.2359s
Epoch: 23 cost time: 43.16893458366394
Epoch: 23, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
Validation loss decreased (-0.963120 --> -0.965693).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0028533
	speed: 0.3653s/iter; left time: 13155.4315s
	iters: 200, epoch: 24 | loss: 0.0049654
	speed: 0.0836s/iter; left time: 3003.3224s
	iters: 300, epoch: 24 | loss: 0.0279088
	speed: 0.0851s/iter; left time: 3046.7188s
	iters: 400, epoch: 24 | loss: 0.0066897
	speed: 0.0841s/iter; left time: 3002.5164s
Epoch: 24 cost time: 41.18969678878784
Epoch: 24, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0157144
	speed: 0.3255s/iter; left time: 11571.2206s
	iters: 200, epoch: 25 | loss: 0.3053300
	speed: 0.0962s/iter; left time: 3408.5755s
	iters: 300, epoch: 25 | loss: 0.0347840
	speed: 0.0905s/iter; left time: 3198.9337s
	iters: 400, epoch: 25 | loss: 0.0330968
	speed: 0.0807s/iter; left time: 2845.8776s
Epoch: 25 cost time: 41.530489444732666
Epoch: 25, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.236 Vali Acc: 0.945 Test Loss: 0.236 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0139246
	speed: 0.3251s/iter; left time: 11404.9437s
	iters: 200, epoch: 26 | loss: 0.3580779
	speed: 0.0809s/iter; left time: 2830.2480s
	iters: 300, epoch: 26 | loss: 0.5767595
	speed: 0.0826s/iter; left time: 2881.3298s
	iters: 400, epoch: 26 | loss: 0.0046907
	speed: 0.0862s/iter; left time: 2996.7028s
Epoch: 26 cost time: 39.132004261016846
Epoch: 26, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.248 Vali Acc: 0.921 Test Loss: 0.248 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0105507
	speed: 0.3430s/iter; left time: 11870.7851s
	iters: 200, epoch: 27 | loss: 0.0062778
	speed: 0.0908s/iter; left time: 3134.1453s
	iters: 300, epoch: 27 | loss: 0.0610765
	speed: 0.0882s/iter; left time: 3034.2834s
	iters: 400, epoch: 27 | loss: 0.2033650
	speed: 0.0938s/iter; left time: 3218.1448s
Epoch: 27 cost time: 42.94548773765564
Epoch: 27, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0709474
	speed: 0.3658s/iter; left time: 12486.8433s
	iters: 200, epoch: 28 | loss: 0.0165306
	speed: 0.0976s/iter; left time: 3321.0106s
	iters: 300, epoch: 28 | loss: 0.0036877
	speed: 0.0931s/iter; left time: 3160.5417s
	iters: 400, epoch: 28 | loss: 0.0050095
	speed: 0.0939s/iter; left time: 3176.2654s
Epoch: 28 cost time: 45.09841060638428
Epoch: 28, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0058730
	speed: 0.3753s/iter; left time: 12636.9871s
	iters: 200, epoch: 29 | loss: 0.1534744
	speed: 0.0984s/iter; left time: 3304.3066s
	iters: 300, epoch: 29 | loss: 0.0967605
	speed: 0.0970s/iter; left time: 3245.1226s
	iters: 400, epoch: 29 | loss: 0.0101189
	speed: 0.0883s/iter; left time: 2946.9071s
Epoch: 29 cost time: 44.08224153518677
Epoch: 29, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.290 Vali Acc: 0.942 Test Loss: 0.290 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0093648
	speed: 0.3418s/iter; left time: 11346.9188s
	iters: 200, epoch: 30 | loss: 0.0590758
	speed: 0.0817s/iter; left time: 2703.6293s
	iters: 300, epoch: 30 | loss: 0.0044600
	speed: 0.0838s/iter; left time: 2766.2099s
	iters: 400, epoch: 30 | loss: 0.0054464
	speed: 0.0953s/iter; left time: 3134.6491s
Epoch: 30 cost time: 42.09773254394531
Epoch: 30, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0025613
	speed: 0.3486s/iter; left time: 11410.0528s
	iters: 200, epoch: 31 | loss: 0.0090781
	speed: 0.0851s/iter; left time: 2777.9231s
	iters: 300, epoch: 31 | loss: 0.0046794
	speed: 0.0814s/iter; left time: 2646.7580s
	iters: 400, epoch: 31 | loss: 0.4841464
	speed: 0.0786s/iter; left time: 2550.4125s
Epoch: 31 cost time: 39.54962396621704
Epoch: 31, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.206 Vali Acc: 0.955 Test Loss: 0.206 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0086553
	speed: 0.3495s/iter; left time: 11275.1354s
	iters: 200, epoch: 32 | loss: 0.0045762
	speed: 0.0870s/iter; left time: 2798.0858s
	iters: 300, epoch: 32 | loss: 0.0037808
	speed: 0.0935s/iter; left time: 2998.0553s
	iters: 400, epoch: 32 | loss: 0.0140729
	speed: 0.0877s/iter; left time: 2803.8055s
Epoch: 32 cost time: 41.5429527759552
Epoch: 32, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.216 Vali Acc: 0.947 Test Loss: 0.216 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0457991
	speed: 0.3224s/iter; left time: 10249.9033s
	iters: 200, epoch: 33 | loss: 0.0065731
	speed: 0.0887s/iter; left time: 2811.1224s
	iters: 300, epoch: 33 | loss: 0.0024586
	speed: 0.0889s/iter; left time: 2809.6108s
	iters: 400, epoch: 33 | loss: 0.0269537
	speed: 0.0939s/iter; left time: 2957.9908s
Epoch: 33 cost time: 44.09370803833008
Epoch: 33, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9656946826758147
model parameter : 2702918
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6780036
	speed: 0.1191s/iter; left time: 5574.8190s
	iters: 200, epoch: 1 | loss: 0.3128689
	speed: 0.0927s/iter; left time: 4327.8732s
	iters: 300, epoch: 1 | loss: 0.1407833
	speed: 0.0941s/iter; left time: 4383.2173s
	iters: 400, epoch: 1 | loss: 0.0520547
	speed: 0.0842s/iter; left time: 3916.6149s
Epoch: 1 cost time: 44.47074317932129
Epoch: 1, Steps: 469 | Train Loss: 0.494 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (inf --> -0.929958).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1189498
	speed: 0.3395s/iter; left time: 15729.5963s
	iters: 200, epoch: 2 | loss: 0.0345052
	speed: 0.0944s/iter; left time: 4362.9198s
	iters: 300, epoch: 2 | loss: 0.2953374
	speed: 0.0816s/iter; left time: 3765.7949s
	iters: 400, epoch: 2 | loss: 0.1240015
	speed: 0.0889s/iter; left time: 4094.1831s
Epoch: 2 cost time: 41.333433866500854
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
Validation loss decreased (-0.929958 --> -0.942536).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1085787
	speed: 0.3210s/iter; left time: 14724.0877s
	iters: 200, epoch: 3 | loss: 0.0943708
	speed: 0.0876s/iter; left time: 4006.5791s
	iters: 300, epoch: 3 | loss: 0.0264926
	speed: 0.0826s/iter; left time: 3769.7032s
	iters: 400, epoch: 3 | loss: 0.3515003
	speed: 0.0865s/iter; left time: 3943.2955s
Epoch: 3 cost time: 39.60477876663208
Epoch: 3, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0630303
	speed: 0.3313s/iter; left time: 15040.7090s
	iters: 200, epoch: 4 | loss: 0.0202771
	speed: 0.0846s/iter; left time: 3829.7879s
	iters: 300, epoch: 4 | loss: 0.0221865
	speed: 0.0820s/iter; left time: 3704.6911s
	iters: 400, epoch: 4 | loss: 0.0071136
	speed: 0.0935s/iter; left time: 4216.8292s
Epoch: 4 cost time: 41.13742661476135
Epoch: 4, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.183 Vali Acc: 0.947 Test Loss: 0.183 Test Acc: 0.947
Validation loss decreased (-0.942536 --> -0.947397).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0639833
	speed: 0.3494s/iter; left time: 15695.4783s
	iters: 200, epoch: 5 | loss: 0.1310356
	speed: 0.0940s/iter; left time: 4213.7459s
	iters: 300, epoch: 5 | loss: 0.0553773
	speed: 0.0877s/iter; left time: 3923.6205s
	iters: 400, epoch: 5 | loss: 0.0427238
	speed: 0.0917s/iter; left time: 4093.5530s
Epoch: 5 cost time: 43.03977870941162
Epoch: 5, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1540752
	speed: 0.3640s/iter; left time: 16181.2194s
	iters: 200, epoch: 6 | loss: 0.6526647
	speed: 0.1005s/iter; left time: 4456.8445s
	iters: 300, epoch: 6 | loss: 0.0787254
	speed: 0.0925s/iter; left time: 4091.5685s
	iters: 400, epoch: 6 | loss: 0.1051280
	speed: 0.0855s/iter; left time: 3774.1547s
Epoch: 6 cost time: 43.76978659629822
Epoch: 6, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0949416
	speed: 0.3427s/iter; left time: 15075.1291s
	iters: 200, epoch: 7 | loss: 0.0894689
	speed: 0.0918s/iter; left time: 4028.9468s
	iters: 300, epoch: 7 | loss: 0.1686560
	speed: 0.0876s/iter; left time: 3837.3419s
	iters: 400, epoch: 7 | loss: 0.3115926
	speed: 0.0892s/iter; left time: 3899.0055s
Epoch: 7 cost time: 42.06959080696106
Epoch: 7, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3168944
	speed: 0.3541s/iter; left time: 15409.5507s
	iters: 200, epoch: 8 | loss: 0.3574668
	speed: 0.0808s/iter; left time: 3508.7630s
	iters: 300, epoch: 8 | loss: 0.3763585
	speed: 0.0852s/iter; left time: 3691.7894s
	iters: 400, epoch: 8 | loss: 0.0077063
	speed: 0.0787s/iter; left time: 3403.0128s
Epoch: 8 cost time: 39.75609993934631
Epoch: 8, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0240247
	speed: 0.3496s/iter; left time: 15049.2771s
	iters: 200, epoch: 9 | loss: 0.0496006
	speed: 0.0856s/iter; left time: 3677.5848s
	iters: 300, epoch: 9 | loss: 0.0093271
	speed: 0.0925s/iter; left time: 3965.4729s
	iters: 400, epoch: 9 | loss: 0.0586614
	speed: 0.0923s/iter; left time: 3945.1807s
Epoch: 9 cost time: 42.23604369163513
Epoch: 9, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0685577
	speed: 0.3491s/iter; left time: 14864.2156s
	iters: 200, epoch: 10 | loss: 0.0808892
	speed: 0.0869s/iter; left time: 3692.2048s
	iters: 300, epoch: 10 | loss: 0.3684715
	speed: 0.0894s/iter; left time: 3790.0741s
	iters: 400, epoch: 10 | loss: 0.0347830
	speed: 0.0982s/iter; left time: 4152.0637s
Epoch: 10 cost time: 43.04259371757507
Epoch: 10, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.947397 --> -0.948826).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0013745
	speed: 0.3562s/iter; left time: 14999.8862s
	iters: 200, epoch: 11 | loss: 0.0133236
	speed: 0.0987s/iter; left time: 4146.3389s
	iters: 300, epoch: 11 | loss: 0.3881553
	speed: 0.0964s/iter; left time: 4039.7577s
	iters: 400, epoch: 11 | loss: 0.0068582
	speed: 0.0863s/iter; left time: 3608.5149s
Epoch: 11 cost time: 42.516273975372314
Epoch: 11, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.259 Vali Acc: 0.940 Test Loss: 0.259 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1447536
	speed: 0.3178s/iter; left time: 13233.0899s
	iters: 200, epoch: 12 | loss: 0.4370460
	speed: 0.0856s/iter; left time: 3554.5191s
	iters: 300, epoch: 12 | loss: 0.0876000
	speed: 0.0927s/iter; left time: 3840.5768s
	iters: 400, epoch: 12 | loss: 0.0219138
	speed: 0.0856s/iter; left time: 3540.6028s
Epoch: 12 cost time: 41.511719703674316
Epoch: 12, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.239 Vali Acc: 0.940 Test Loss: 0.239 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1773770
	speed: 0.3505s/iter; left time: 14431.4096s
	iters: 200, epoch: 13 | loss: 0.0287038
	speed: 0.0817s/iter; left time: 3354.1309s
	iters: 300, epoch: 13 | loss: 0.0795199
	speed: 0.0856s/iter; left time: 3509.1588s
	iters: 400, epoch: 13 | loss: 0.0414778
	speed: 0.0813s/iter; left time: 3322.0250s
Epoch: 13 cost time: 40.438446283340454
Epoch: 13, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
Validation loss decreased (-0.948826 --> -0.950827).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0127544
	speed: 0.3463s/iter; left time: 14097.6755s
	iters: 200, epoch: 14 | loss: 0.0037114
	speed: 0.0858s/iter; left time: 3482.0942s
	iters: 300, epoch: 14 | loss: 0.0207834
	speed: 0.0872s/iter; left time: 3531.5493s
	iters: 400, epoch: 14 | loss: 0.0456975
	speed: 0.0958s/iter; left time: 3870.8312s
Epoch: 14 cost time: 42.274693965911865
Epoch: 14, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0822754
	speed: 0.3590s/iter; left time: 14443.8508s
	iters: 200, epoch: 15 | loss: 0.0546446
	speed: 0.0856s/iter; left time: 3435.0697s
	iters: 300, epoch: 15 | loss: 0.1172549
	speed: 0.0840s/iter; left time: 3361.3476s
	iters: 400, epoch: 15 | loss: 0.0292573
	speed: 0.0916s/iter; left time: 3658.4334s
Epoch: 15 cost time: 42.17872428894043
Epoch: 15, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.283 Vali Acc: 0.934 Test Loss: 0.283 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1822431
	speed: 0.3692s/iter; left time: 14681.9183s
	iters: 200, epoch: 16 | loss: 0.0193900
	speed: 0.0951s/iter; left time: 3772.7269s
	iters: 300, epoch: 16 | loss: 0.0490405
	speed: 0.0902s/iter; left time: 3567.7354s
	iters: 400, epoch: 16 | loss: 0.3978761
	speed: 0.0819s/iter; left time: 3230.6783s
Epoch: 16 cost time: 43.51175332069397
Epoch: 16, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.247 Vali Acc: 0.936 Test Loss: 0.247 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2281876
	speed: 0.3550s/iter; left time: 13951.8367s
	iters: 200, epoch: 17 | loss: 0.0332836
	speed: 0.0826s/iter; left time: 3237.1392s
	iters: 300, epoch: 17 | loss: 0.0036285
	speed: 0.0974s/iter; left time: 3806.8592s
	iters: 400, epoch: 17 | loss: 0.0496289
	speed: 0.0880s/iter; left time: 3432.7182s
Epoch: 17 cost time: 42.25030851364136
Epoch: 17, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0095432
	speed: 0.3712s/iter; left time: 14414.8583s
	iters: 200, epoch: 18 | loss: 0.0903248
	speed: 0.0816s/iter; left time: 3159.4546s
	iters: 300, epoch: 18 | loss: 0.0054082
	speed: 0.0877s/iter; left time: 3386.5551s
	iters: 400, epoch: 18 | loss: 0.0073348
	speed: 0.0909s/iter; left time: 3502.2989s
Epoch: 18 cost time: 42.169063568115234
Epoch: 18, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0142453
	speed: 0.3457s/iter; left time: 13260.4326s
	iters: 200, epoch: 19 | loss: 0.0107840
	speed: 0.0902s/iter; left time: 3449.1627s
	iters: 300, epoch: 19 | loss: 0.0019916
	speed: 0.0939s/iter; left time: 3581.5374s
	iters: 400, epoch: 19 | loss: 0.0631086
	speed: 0.0877s/iter; left time: 3337.3280s
Epoch: 19 cost time: 43.059895753860474
Epoch: 19, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1498908
	speed: 0.3704s/iter; left time: 14035.1422s
	iters: 200, epoch: 20 | loss: 0.5087513
	speed: 0.0896s/iter; left time: 3385.4121s
	iters: 300, epoch: 20 | loss: 0.4766913
	speed: 0.0874s/iter; left time: 3294.9772s
	iters: 400, epoch: 20 | loss: 0.4106430
	speed: 0.0935s/iter; left time: 3515.5811s
Epoch: 20 cost time: 42.46945381164551
Epoch: 20, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0471592
	speed: 0.3528s/iter; left time: 13200.6950s
	iters: 200, epoch: 21 | loss: 0.1029484
	speed: 0.0907s/iter; left time: 3385.6132s
	iters: 300, epoch: 21 | loss: 0.0167440
	speed: 0.0964s/iter; left time: 3588.0517s
	iters: 400, epoch: 21 | loss: 0.0073027
	speed: 0.0893s/iter; left time: 3313.0635s
Epoch: 21 cost time: 43.69731378555298
Epoch: 21, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0280915
	speed: 0.3588s/iter; left time: 13256.9184s
	iters: 200, epoch: 22 | loss: 0.0394920
	speed: 0.0858s/iter; left time: 3160.7510s
	iters: 300, epoch: 22 | loss: 0.0004953
	speed: 0.0805s/iter; left time: 2956.8623s
	iters: 400, epoch: 22 | loss: 0.0120591
	speed: 0.0896s/iter; left time: 3284.2862s
Epoch: 22 cost time: 40.64709210395813
Epoch: 22, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.272 Vali Acc: 0.914 Test Loss: 0.272 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2751223
	speed: 0.3724s/iter; left time: 13585.7638s
	iters: 200, epoch: 23 | loss: 0.0080144
	speed: 0.1017s/iter; left time: 3701.9589s
	iters: 300, epoch: 23 | loss: 0.1688249
	speed: 0.1003s/iter; left time: 3638.8016s
	iters: 400, epoch: 23 | loss: 0.0301565
	speed: 0.0916s/iter; left time: 3313.6009s
Epoch: 23 cost time: 46.04936456680298
Epoch: 23, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9508290451686678
model parameter : 2702406
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5672967
	speed: 0.1094s/iter; left time: 5120.2265s
	iters: 200, epoch: 1 | loss: 0.3220048
	speed: 0.0884s/iter; left time: 4126.5759s
	iters: 300, epoch: 1 | loss: 0.3233353
	speed: 0.0934s/iter; left time: 4353.9490s
	iters: 400, epoch: 1 | loss: 0.0358653
	speed: 0.0918s/iter; left time: 4267.3747s
Epoch: 1 cost time: 44.67661476135254
Epoch: 1, Steps: 469 | Train Loss: 0.507 Vali Loss: 0.280 Vali Acc: 0.915 Test Loss: 0.280 Test Acc: 0.915
Validation loss decreased (inf --> -0.914520).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2852870
	speed: 0.3606s/iter; left time: 16706.9235s
	iters: 200, epoch: 2 | loss: 0.0202446
	speed: 0.0822s/iter; left time: 3801.7002s
	iters: 300, epoch: 2 | loss: 0.5507814
	speed: 0.0881s/iter; left time: 4063.1870s
	iters: 400, epoch: 2 | loss: 0.0802703
	speed: 0.0911s/iter; left time: 4193.4456s
Epoch: 2 cost time: 42.84108829498291
Epoch: 2, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.527 Vali Acc: 0.837 Test Loss: 0.527 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4051660
	speed: 0.3616s/iter; left time: 16585.0457s
	iters: 200, epoch: 3 | loss: 0.1063706
	speed: 0.0935s/iter; left time: 4277.9992s
	iters: 300, epoch: 3 | loss: 0.2919300
	speed: 0.0830s/iter; left time: 3789.6824s
	iters: 400, epoch: 3 | loss: 0.2117452
	speed: 0.0896s/iter; left time: 4080.9718s
Epoch: 3 cost time: 42.42049479484558
Epoch: 3, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.338 Vali Acc: 0.901 Test Loss: 0.338 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4011688
	speed: 0.3348s/iter; left time: 15195.7678s
	iters: 200, epoch: 4 | loss: 0.0891602
	speed: 0.0789s/iter; left time: 3573.7974s
	iters: 300, epoch: 4 | loss: 0.4960237
	speed: 0.0808s/iter; left time: 3653.5543s
	iters: 400, epoch: 4 | loss: 0.0352318
	speed: 0.0919s/iter; left time: 4142.4140s
Epoch: 4 cost time: 39.28283715248108
Epoch: 4, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.914520 --> -0.937105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0774656
	speed: 0.3620s/iter; left time: 16263.4985s
	iters: 200, epoch: 5 | loss: 0.1239289
	speed: 0.0931s/iter; left time: 4174.2323s
	iters: 300, epoch: 5 | loss: 0.2193648
	speed: 0.0875s/iter; left time: 3915.0294s
	iters: 400, epoch: 5 | loss: 0.4444274
	speed: 0.0863s/iter; left time: 3849.9756s
Epoch: 5 cost time: 42.8124361038208
Epoch: 5, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.287 Vali Acc: 0.929 Test Loss: 0.287 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0778619
	speed: 0.3395s/iter; left time: 15090.9999s
	iters: 200, epoch: 6 | loss: 0.2124146
	speed: 0.0944s/iter; left time: 4189.0352s
	iters: 300, epoch: 6 | loss: 0.0234550
	speed: 0.0859s/iter; left time: 3802.6617s
	iters: 400, epoch: 6 | loss: 0.0072279
	speed: 0.0989s/iter; left time: 4368.3158s
Epoch: 6 cost time: 43.625659465789795
Epoch: 6, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0141139
	speed: 0.3549s/iter; left time: 15609.8955s
	iters: 200, epoch: 7 | loss: 0.0996468
	speed: 0.0909s/iter; left time: 3991.5164s
	iters: 300, epoch: 7 | loss: 0.2323199
	speed: 0.0920s/iter; left time: 4026.5528s
	iters: 400, epoch: 7 | loss: 0.0297899
	speed: 0.0876s/iter; left time: 3827.6095s
Epoch: 7 cost time: 42.550195932388306
Epoch: 7, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.937105 --> -0.948540).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0702620
	speed: 0.3443s/iter; left time: 14984.0176s
	iters: 200, epoch: 8 | loss: 0.4897651
	speed: 0.0805s/iter; left time: 3497.1639s
	iters: 300, epoch: 8 | loss: 0.2419606
	speed: 0.0864s/iter; left time: 3743.7706s
	iters: 400, epoch: 8 | loss: 0.1894363
	speed: 0.0811s/iter; left time: 3503.1604s
Epoch: 8 cost time: 40.11120939254761
Epoch: 8, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2245047
	speed: 0.3451s/iter; left time: 14855.2535s
	iters: 200, epoch: 9 | loss: 0.0390450
	speed: 0.0882s/iter; left time: 3789.7553s
	iters: 300, epoch: 9 | loss: 0.5742649
	speed: 0.0812s/iter; left time: 3479.9509s
	iters: 400, epoch: 9 | loss: 0.0052923
	speed: 0.0817s/iter; left time: 3490.7175s
Epoch: 9 cost time: 40.00146770477295
Epoch: 9, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1225436
	speed: 0.3242s/iter; left time: 13805.6064s
	iters: 200, epoch: 10 | loss: 0.0097038
	speed: 0.0817s/iter; left time: 3471.6490s
	iters: 300, epoch: 10 | loss: 0.0011309
	speed: 0.0792s/iter; left time: 3357.0708s
	iters: 400, epoch: 10 | loss: 0.0126812
	speed: 0.0837s/iter; left time: 3537.3432s
Epoch: 10 cost time: 38.53078842163086
Epoch: 10, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0071312
	speed: 0.3478s/iter; left time: 14644.5526s
	iters: 200, epoch: 11 | loss: 0.0332648
	speed: 0.1015s/iter; left time: 4263.2668s
	iters: 300, epoch: 11 | loss: 0.0219178
	speed: 0.0852s/iter; left time: 3571.8450s
	iters: 400, epoch: 11 | loss: 0.0501534
	speed: 0.0973s/iter; left time: 4068.4696s
Epoch: 11 cost time: 44.62457275390625
Epoch: 11, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0415784
	speed: 0.3711s/iter; left time: 15454.0103s
	iters: 200, epoch: 12 | loss: 0.0127436
	speed: 0.0912s/iter; left time: 3788.9068s
	iters: 300, epoch: 12 | loss: 0.0484359
	speed: 0.0944s/iter; left time: 3911.3751s
	iters: 400, epoch: 12 | loss: 0.2018967
	speed: 0.0950s/iter; left time: 3925.7337s
Epoch: 12 cost time: 43.31939935684204
Epoch: 12, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.233 Vali Acc: 0.939 Test Loss: 0.233 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0153961
	speed: 0.3687s/iter; left time: 15180.5656s
	iters: 200, epoch: 13 | loss: 0.1940164
	speed: 0.0798s/iter; left time: 3278.8738s
	iters: 300, epoch: 13 | loss: 0.0132194
	speed: 0.0933s/iter; left time: 3823.7877s
	iters: 400, epoch: 13 | loss: 0.0699862
	speed: 0.0908s/iter; left time: 3709.2531s
Epoch: 13 cost time: 41.99013113975525
Epoch: 13, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.388 Vali Acc: 0.912 Test Loss: 0.388 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0242535
	speed: 0.3296s/iter; left time: 13415.4314s
	iters: 200, epoch: 14 | loss: 0.0047155
	speed: 0.0814s/iter; left time: 3303.3010s
	iters: 300, epoch: 14 | loss: 0.1549182
	speed: 0.0886s/iter; left time: 3589.6675s
	iters: 400, epoch: 14 | loss: 0.2077198
	speed: 0.0880s/iter; left time: 3554.1040s
Epoch: 14 cost time: 40.9100615978241
Epoch: 14, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1809343
	speed: 0.3363s/iter; left time: 13532.5346s
	iters: 200, epoch: 15 | loss: 0.1113895
	speed: 0.0944s/iter; left time: 3789.1430s
	iters: 300, epoch: 15 | loss: 0.0829592
	speed: 0.0953s/iter; left time: 3815.1124s
	iters: 400, epoch: 15 | loss: 0.0293411
	speed: 0.0886s/iter; left time: 3536.9831s
Epoch: 15 cost time: 42.07646203041077
Epoch: 15, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.237 Vali Acc: 0.943 Test Loss: 0.237 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1074283
	speed: 0.3298s/iter; left time: 13116.6826s
	iters: 200, epoch: 16 | loss: 0.0361266
	speed: 0.0972s/iter; left time: 3857.4089s
	iters: 300, epoch: 16 | loss: 0.0679637
	speed: 0.0912s/iter; left time: 3607.8169s
	iters: 400, epoch: 16 | loss: 0.0021930
	speed: 0.0940s/iter; left time: 3708.5056s
Epoch: 16 cost time: 43.99179744720459
Epoch: 16, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.948540 --> -0.967123).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0045827
	speed: 0.3802s/iter; left time: 14941.9719s
	iters: 200, epoch: 17 | loss: 0.1404254
	speed: 0.1004s/iter; left time: 3934.5698s
	iters: 300, epoch: 17 | loss: 0.0008125
	speed: 0.0858s/iter; left time: 3353.7853s
	iters: 400, epoch: 17 | loss: 0.0314845
	speed: 0.0902s/iter; left time: 3518.9295s
Epoch: 17 cost time: 44.386061906814575
Epoch: 17, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1131571
	speed: 0.3665s/iter; left time: 14231.1126s
	iters: 200, epoch: 18 | loss: 0.1899656
	speed: 0.0932s/iter; left time: 3607.7668s
	iters: 300, epoch: 18 | loss: 0.4808535
	speed: 0.0888s/iter; left time: 3431.1071s
	iters: 400, epoch: 18 | loss: 0.0194484
	speed: 0.0999s/iter; left time: 3849.2614s
Epoch: 18 cost time: 43.679094552993774
Epoch: 18, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.296 Vali Acc: 0.921 Test Loss: 0.296 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0162994
	speed: 0.3667s/iter; left time: 14067.2636s
	iters: 200, epoch: 19 | loss: 0.0994246
	speed: 0.0792s/iter; left time: 3030.7739s
	iters: 300, epoch: 19 | loss: 0.0021578
	speed: 0.0811s/iter; left time: 3093.9433s
	iters: 400, epoch: 19 | loss: 0.1044783
	speed: 0.0819s/iter; left time: 3118.6443s
Epoch: 19 cost time: 39.988502502441406
Epoch: 19, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0153539
	speed: 0.3339s/iter; left time: 12651.7678s
	iters: 200, epoch: 20 | loss: 0.0024708
	speed: 0.0847s/iter; left time: 3199.1077s
	iters: 300, epoch: 20 | loss: 0.0012475
	speed: 0.0995s/iter; left time: 3748.5845s
	iters: 400, epoch: 20 | loss: 0.0621559
	speed: 0.0908s/iter; left time: 3411.8390s
Epoch: 20 cost time: 42.92518877983093
Epoch: 20, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0041865
	speed: 0.3435s/iter; left time: 12855.0470s
	iters: 200, epoch: 21 | loss: 0.0041849
	speed: 0.0825s/iter; left time: 3077.2775s
	iters: 300, epoch: 21 | loss: 0.0035750
	speed: 0.0841s/iter; left time: 3130.4159s
	iters: 400, epoch: 21 | loss: 0.0288231
	speed: 0.0870s/iter; left time: 3229.3948s
Epoch: 21 cost time: 40.593440771102905
Epoch: 21, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0776270
	speed: 0.3359s/iter; left time: 12412.6604s
	iters: 200, epoch: 22 | loss: 0.0007908
	speed: 0.0890s/iter; left time: 3280.4685s
	iters: 300, epoch: 22 | loss: 0.0080448
	speed: 0.0877s/iter; left time: 3224.8380s
	iters: 400, epoch: 22 | loss: 0.1800621
	speed: 0.0933s/iter; left time: 3420.7205s
Epoch: 22 cost time: 41.588449478149414
Epoch: 22, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0447398
	speed: 0.3261s/iter; left time: 11897.8340s
	iters: 200, epoch: 23 | loss: 0.0233163
	speed: 0.0853s/iter; left time: 3102.4160s
	iters: 300, epoch: 23 | loss: 0.0013757
	speed: 0.0801s/iter; left time: 2905.6436s
	iters: 400, epoch: 23 | loss: 0.0138790
	speed: 0.0919s/iter; left time: 3326.5794s
Epoch: 23 cost time: 40.677382707595825
Epoch: 23, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0173252
	speed: 0.3394s/iter; left time: 12222.4657s
	iters: 200, epoch: 24 | loss: 0.0006496
	speed: 0.0900s/iter; left time: 3231.7965s
	iters: 300, epoch: 24 | loss: 0.0036633
	speed: 0.0877s/iter; left time: 3139.5468s
	iters: 400, epoch: 24 | loss: 0.0034683
	speed: 0.0825s/iter; left time: 2946.8227s
Epoch: 24 cost time: 40.543527603149414
Epoch: 24, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1110311
	speed: 0.3199s/iter; left time: 11371.8875s
	iters: 200, epoch: 25 | loss: 0.0062289
	speed: 0.0859s/iter; left time: 3046.1765s
	iters: 300, epoch: 25 | loss: 0.1412788
	speed: 0.0873s/iter; left time: 3087.3242s
	iters: 400, epoch: 25 | loss: 0.4613608
	speed: 0.0877s/iter; left time: 3090.7237s
Epoch: 25 cost time: 39.73805356025696
Epoch: 25, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0047513
	speed: 0.3131s/iter; left time: 10981.8288s
	iters: 200, epoch: 26 | loss: 0.0158431
	speed: 0.0828s/iter; left time: 2897.6127s
	iters: 300, epoch: 26 | loss: 0.0353692
	speed: 0.0805s/iter; left time: 2808.6735s
	iters: 400, epoch: 26 | loss: 0.7098239
	speed: 0.0840s/iter; left time: 2919.6783s
Epoch: 26 cost time: 38.878578186035156
Epoch: 26, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.967123 --> -0.970267).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0020349
	speed: 0.3176s/iter; left time: 10991.1239s
	iters: 200, epoch: 27 | loss: 0.0508189
	speed: 0.0934s/iter; left time: 3224.6664s
	iters: 300, epoch: 27 | loss: 0.0015069
	speed: 0.0869s/iter; left time: 2989.5450s
	iters: 400, epoch: 27 | loss: 0.0002451
	speed: 0.0864s/iter; left time: 2965.5343s
Epoch: 27 cost time: 41.08720254898071
Epoch: 27, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0006670
	speed: 0.3520s/iter; left time: 12016.1960s
	iters: 200, epoch: 28 | loss: 0.0096060
	speed: 0.0882s/iter; left time: 3003.2428s
	iters: 300, epoch: 28 | loss: 0.0879405
	speed: 0.0868s/iter; left time: 2946.3279s
	iters: 400, epoch: 28 | loss: 0.0023848
	speed: 0.0819s/iter; left time: 2771.1929s
Epoch: 28 cost time: 41.339314699172974
Epoch: 28, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0009980
	speed: 0.3602s/iter; left time: 12126.0348s
	iters: 200, epoch: 29 | loss: 0.0167877
	speed: 0.0872s/iter; left time: 2926.0429s
	iters: 300, epoch: 29 | loss: 0.0088496
	speed: 0.0866s/iter; left time: 2898.3771s
	iters: 400, epoch: 29 | loss: 0.0358989
	speed: 0.0861s/iter; left time: 2873.7266s
Epoch: 29 cost time: 42.09959936141968
Epoch: 29, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0011079
	speed: 0.3270s/iter; left time: 10854.8290s
	iters: 200, epoch: 30 | loss: 0.0081463
	speed: 0.0878s/iter; left time: 2907.1848s
	iters: 300, epoch: 30 | loss: 0.0128458
	speed: 0.0757s/iter; left time: 2499.4587s
	iters: 400, epoch: 30 | loss: 0.0015341
	speed: 0.0818s/iter; left time: 2690.3048s
Epoch: 30 cost time: 38.61037635803223
Epoch: 30, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.264 Vali Acc: 0.949 Test Loss: 0.264 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0145006
	speed: 0.3239s/iter; left time: 10602.9374s
	iters: 200, epoch: 31 | loss: 0.3736427
	speed: 0.0810s/iter; left time: 2643.1074s
	iters: 300, epoch: 31 | loss: 0.4254566
	speed: 0.0880s/iter; left time: 2861.9606s
	iters: 400, epoch: 31 | loss: 0.0006768
	speed: 0.0874s/iter; left time: 2835.1539s
Epoch: 31 cost time: 40.597875118255615
Epoch: 31, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0125158
	speed: 0.3225s/iter; left time: 10404.4422s
	iters: 200, epoch: 32 | loss: 0.0225854
	speed: 0.0861s/iter; left time: 2767.6942s
	iters: 300, epoch: 32 | loss: 0.0006362
	speed: 0.0885s/iter; left time: 2838.7041s
	iters: 400, epoch: 32 | loss: 0.1411927
	speed: 0.0803s/iter; left time: 2567.7451s
Epoch: 32 cost time: 40.67186665534973
Epoch: 32, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0132701
	speed: 0.3411s/iter; left time: 10843.6320s
	iters: 200, epoch: 33 | loss: 0.0037833
	speed: 0.0990s/iter; left time: 3136.8100s
	iters: 300, epoch: 33 | loss: 0.1747006
	speed: 0.0960s/iter; left time: 3031.7934s
	iters: 400, epoch: 33 | loss: 0.0096918
	speed: 0.0800s/iter; left time: 2520.7219s
Epoch: 33 cost time: 42.25446677207947
Epoch: 33, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.352 Vali Acc: 0.930 Test Loss: 0.352 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.1676527
	speed: 0.3115s/iter; left time: 9755.9300s
	iters: 200, epoch: 34 | loss: 0.0014954
	speed: 0.0872s/iter; left time: 2721.4249s
	iters: 300, epoch: 34 | loss: 0.1295419
	speed: 0.0867s/iter; left time: 2698.1001s
	iters: 400, epoch: 34 | loss: 0.0029199
	speed: 0.0861s/iter; left time: 2669.9192s
Epoch: 34 cost time: 42.08105444908142
Epoch: 34, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.970267 --> -0.973412).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0018793
	speed: 0.3410s/iter; left time: 10522.3726s
	iters: 200, epoch: 35 | loss: 0.0026987
	speed: 0.0778s/iter; left time: 2392.5250s
	iters: 300, epoch: 35 | loss: 0.0046125
	speed: 0.0818s/iter; left time: 2507.7190s
	iters: 400, epoch: 35 | loss: 0.0016424
	speed: 0.0779s/iter; left time: 2380.8522s
Epoch: 35 cost time: 38.5126838684082
Epoch: 35, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.1620302
	speed: 0.3445s/iter; left time: 10468.2009s
	iters: 200, epoch: 36 | loss: 0.0248119
	speed: 0.0873s/iter; left time: 2642.7397s
	iters: 300, epoch: 36 | loss: 0.0031747
	speed: 0.0996s/iter; left time: 3006.5632s
	iters: 400, epoch: 36 | loss: 0.0105787
	speed: 0.0868s/iter; left time: 2610.8058s
Epoch: 36 cost time: 42.699177742004395
Epoch: 36, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0960092
	speed: 0.3304s/iter; left time: 9884.6948s
	iters: 200, epoch: 37 | loss: 0.0007581
	speed: 0.0759s/iter; left time: 2262.9955s
	iters: 300, epoch: 37 | loss: 0.0014349
	speed: 0.0858s/iter; left time: 2549.8891s
	iters: 400, epoch: 37 | loss: 0.2064869
	speed: 0.0890s/iter; left time: 2637.0023s
Epoch: 37 cost time: 39.491862058639526
Epoch: 37, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.251 Vali Acc: 0.946 Test Loss: 0.251 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0037138
	speed: 0.3369s/iter; left time: 9921.6830s
	iters: 200, epoch: 38 | loss: 0.0026703
	speed: 0.0875s/iter; left time: 2568.8186s
	iters: 300, epoch: 38 | loss: 0.0874806
	speed: 0.0969s/iter; left time: 2834.3601s
	iters: 400, epoch: 38 | loss: 0.0228029
	speed: 0.0814s/iter; left time: 2371.2177s
Epoch: 38 cost time: 42.32940649986267
Epoch: 38, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0034039
	speed: 0.3248s/iter; left time: 9412.9926s
	iters: 200, epoch: 39 | loss: 0.1335170
	speed: 0.0913s/iter; left time: 2637.8532s
	iters: 300, epoch: 39 | loss: 0.0020870
	speed: 0.0910s/iter; left time: 2618.3694s
	iters: 400, epoch: 39 | loss: 0.0184683
	speed: 0.0850s/iter; left time: 2438.8638s
Epoch: 39 cost time: 40.712533950805664
Epoch: 39, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.203 Vali Acc: 0.954 Test Loss: 0.203 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.2841607
	speed: 0.3330s/iter; left time: 9493.4708s
	iters: 200, epoch: 40 | loss: 0.0008608
	speed: 0.0870s/iter; left time: 2472.6756s
	iters: 300, epoch: 40 | loss: 0.0043428
	speed: 0.0829s/iter; left time: 2346.9379s
	iters: 400, epoch: 40 | loss: 0.3572443
	speed: 0.0848s/iter; left time: 2390.8616s
Epoch: 40 cost time: 40.18164801597595
Epoch: 40, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0061541
	speed: 0.3280s/iter; left time: 9196.2198s
	iters: 200, epoch: 41 | loss: 0.0106866
	speed: 0.0885s/iter; left time: 2472.9108s
	iters: 300, epoch: 41 | loss: 0.0593937
	speed: 0.0871s/iter; left time: 2424.5704s
	iters: 400, epoch: 41 | loss: 0.0093590
	speed: 0.0855s/iter; left time: 2372.1843s
Epoch: 41 cost time: 41.897810220718384
Epoch: 41, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.2191195
	speed: 0.3527s/iter; left time: 9725.1468s
	iters: 200, epoch: 42 | loss: 0.0204664
	speed: 0.0824s/iter; left time: 2264.1045s
	iters: 300, epoch: 42 | loss: 0.0061112
	speed: 0.0843s/iter; left time: 2307.2624s
	iters: 400, epoch: 42 | loss: 0.0032213
	speed: 0.0746s/iter; left time: 2033.4857s
Epoch: 42 cost time: 39.3808376789093
Epoch: 42, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.209 Vali Acc: 0.947 Test Loss: 0.209 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0012769
	speed: 0.3338s/iter; left time: 9047.8881s
	iters: 200, epoch: 43 | loss: 0.0011038
	speed: 0.0817s/iter; left time: 2205.0234s
	iters: 300, epoch: 43 | loss: 0.0030292
	speed: 0.0858s/iter; left time: 2307.1976s
	iters: 400, epoch: 43 | loss: 0.0009250
	speed: 0.0827s/iter; left time: 2216.5323s
Epoch: 43 cost time: 40.858726501464844
Epoch: 43, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0099745
	speed: 0.3602s/iter; left time: 9594.0368s
	iters: 200, epoch: 44 | loss: 0.0976472
	speed: 0.0809s/iter; left time: 2147.7209s
	iters: 300, epoch: 44 | loss: 0.0016136
	speed: 0.0850s/iter; left time: 2246.1342s
	iters: 400, epoch: 44 | loss: 0.2849828
	speed: 0.0847s/iter; left time: 2230.7060s
Epoch: 44 cost time: 40.266576051712036
Epoch: 44, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9734133790737565
model parameter : 2701894
model size : 12.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5220801
	speed: 0.1026s/iter; left time: 4803.5118s
	iters: 200, epoch: 1 | loss: 0.3226224
	speed: 0.1017s/iter; left time: 4751.6293s
	iters: 300, epoch: 1 | loss: 0.3159757
	speed: 0.0999s/iter; left time: 4653.6516s
	iters: 400, epoch: 1 | loss: 0.2419001
	speed: 0.0972s/iter; left time: 4517.7125s
Epoch: 1 cost time: 45.881397008895874
Epoch: 1, Steps: 469 | Train Loss: 0.610 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (inf --> -0.922239).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2033843
	speed: 0.3321s/iter; left time: 15384.9009s
	iters: 200, epoch: 2 | loss: 0.0382246
	speed: 0.0922s/iter; left time: 4264.8321s
	iters: 300, epoch: 2 | loss: 0.0243517
	speed: 0.0901s/iter; left time: 4155.9153s
	iters: 400, epoch: 2 | loss: 0.0959479
	speed: 0.0945s/iter; left time: 4351.8712s
Epoch: 2 cost time: 43.89066433906555
Epoch: 2, Steps: 469 | Train Loss: 0.215 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.922239 --> -0.940821).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4235799
	speed: 0.3364s/iter; left time: 15428.8273s
	iters: 200, epoch: 3 | loss: 0.2035160
	speed: 0.0919s/iter; left time: 4206.4211s
	iters: 300, epoch: 3 | loss: 0.2364257
	speed: 0.0746s/iter; left time: 3408.3298s
	iters: 400, epoch: 3 | loss: 0.0699144
	speed: 0.0759s/iter; left time: 3459.6386s
Epoch: 3 cost time: 38.806966066360474
Epoch: 3, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0232249
	speed: 0.3171s/iter; left time: 14394.4412s
	iters: 200, epoch: 4 | loss: 0.0105676
	speed: 0.0874s/iter; left time: 3958.2956s
	iters: 300, epoch: 4 | loss: 0.1241303
	speed: 0.0894s/iter; left time: 4040.3097s
	iters: 400, epoch: 4 | loss: 0.0218023
	speed: 0.0965s/iter; left time: 4350.5687s
Epoch: 4 cost time: 41.96470069885254
Epoch: 4, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.342 Vali Acc: 0.895 Test Loss: 0.342 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0138967
	speed: 0.3502s/iter; left time: 15733.9427s
	iters: 200, epoch: 5 | loss: 0.9350609
	speed: 0.0862s/iter; left time: 3861.9126s
	iters: 300, epoch: 5 | loss: 0.0116036
	speed: 0.0865s/iter; left time: 3867.9620s
	iters: 400, epoch: 5 | loss: 0.6094820
	speed: 0.0848s/iter; left time: 3786.1930s
Epoch: 5 cost time: 41.16824388504028
Epoch: 5, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.320 Vali Acc: 0.895 Test Loss: 0.320 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0103780
	speed: 0.3388s/iter; left time: 15061.3722s
	iters: 200, epoch: 6 | loss: 0.2980444
	speed: 0.0997s/iter; left time: 4422.3804s
	iters: 300, epoch: 6 | loss: 0.2303944
	speed: 0.0885s/iter; left time: 3917.4759s
	iters: 400, epoch: 6 | loss: 0.0204929
	speed: 0.0815s/iter; left time: 3597.4035s
Epoch: 6 cost time: 42.61708879470825
Epoch: 6, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
Validation loss decreased (-0.940821 --> -0.966265).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0226261
	speed: 0.3379s/iter; left time: 14864.0659s
	iters: 200, epoch: 7 | loss: 0.0209951
	speed: 0.0849s/iter; left time: 3726.4563s
	iters: 300, epoch: 7 | loss: 0.0055205
	speed: 0.0817s/iter; left time: 3579.3826s
	iters: 400, epoch: 7 | loss: 0.1256115
	speed: 0.0870s/iter; left time: 3800.6012s
Epoch: 7 cost time: 39.17448425292969
Epoch: 7, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.346 Vali Acc: 0.928 Test Loss: 0.346 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6208867
	speed: 0.3467s/iter; left time: 15088.7368s
	iters: 200, epoch: 8 | loss: 0.3689482
	speed: 0.0832s/iter; left time: 3613.8854s
	iters: 300, epoch: 8 | loss: 0.1248485
	speed: 0.0854s/iter; left time: 3700.8384s
	iters: 400, epoch: 8 | loss: 0.0156545
	speed: 0.0863s/iter; left time: 3728.7117s
Epoch: 8 cost time: 41.78668785095215
Epoch: 8, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.344 Vali Acc: 0.916 Test Loss: 0.344 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0201229
	speed: 0.3429s/iter; left time: 14761.5724s
	iters: 200, epoch: 9 | loss: 0.0322690
	speed: 0.0885s/iter; left time: 3802.9014s
	iters: 300, epoch: 9 | loss: 0.1625708
	speed: 0.0880s/iter; left time: 3772.5732s
	iters: 400, epoch: 9 | loss: 0.0429294
	speed: 0.0863s/iter; left time: 3687.1900s
Epoch: 9 cost time: 42.08663296699524
Epoch: 9, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0141380
	speed: 0.3624s/iter; left time: 15432.6060s
	iters: 200, epoch: 10 | loss: 0.0185837
	speed: 0.0894s/iter; left time: 3799.3821s
	iters: 300, epoch: 10 | loss: 0.0178384
	speed: 0.0973s/iter; left time: 4125.3323s
	iters: 400, epoch: 10 | loss: 0.1105909
	speed: 0.0897s/iter; left time: 3791.0343s
Epoch: 10 cost time: 42.88396167755127
Epoch: 10, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0035664
	speed: 0.3278s/iter; left time: 13802.1094s
	iters: 200, epoch: 11 | loss: 0.0106462
	speed: 0.0836s/iter; left time: 3512.1404s
	iters: 300, epoch: 11 | loss: 0.0139765
	speed: 0.0819s/iter; left time: 3432.8274s
	iters: 400, epoch: 11 | loss: 0.1768819
	speed: 0.0876s/iter; left time: 3664.0479s
Epoch: 11 cost time: 39.94276547431946
Epoch: 11, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0075320
	speed: 0.3293s/iter; left time: 13712.5850s
	iters: 200, epoch: 12 | loss: 0.0120421
	speed: 0.0914s/iter; left time: 3796.3037s
	iters: 300, epoch: 12 | loss: 0.0512013
	speed: 0.0889s/iter; left time: 3684.9609s
	iters: 400, epoch: 12 | loss: 0.2212061
	speed: 0.0857s/iter; left time: 3544.0212s
Epoch: 12 cost time: 40.94714975357056
Epoch: 12, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0134661
	speed: 0.3220s/iter; left time: 13257.1341s
	iters: 200, epoch: 13 | loss: 0.0204360
	speed: 0.0826s/iter; left time: 3392.3242s
	iters: 300, epoch: 13 | loss: 0.0133667
	speed: 0.1004s/iter; left time: 4111.8686s
	iters: 400, epoch: 13 | loss: 0.0041463
	speed: 0.0824s/iter; left time: 3366.4553s
Epoch: 13 cost time: 41.36744570732117
Epoch: 13, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0969142
	speed: 0.3340s/iter; left time: 13594.1571s
	iters: 200, epoch: 14 | loss: 0.5360792
	speed: 0.0939s/iter; left time: 3814.4456s
	iters: 300, epoch: 14 | loss: 0.0545430
	speed: 0.0844s/iter; left time: 3416.8570s
	iters: 400, epoch: 14 | loss: 0.0056845
	speed: 0.0833s/iter; left time: 3367.4227s
Epoch: 14 cost time: 42.28211236000061
Epoch: 14, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0047425
	speed: 0.3341s/iter; left time: 13441.6623s
	iters: 200, epoch: 15 | loss: 0.0133425
	speed: 0.0917s/iter; left time: 3682.3069s
	iters: 300, epoch: 15 | loss: 0.0771897
	speed: 0.0924s/iter; left time: 3700.0744s
	iters: 400, epoch: 15 | loss: 0.0197141
	speed: 0.0842s/iter; left time: 3363.8864s
Epoch: 15 cost time: 41.19075393676758
Epoch: 15, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.203 Vali Acc: 0.954 Test Loss: 0.203 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0251140
	speed: 0.3451s/iter; left time: 13723.1433s
	iters: 200, epoch: 16 | loss: 0.0053730
	speed: 0.0874s/iter; left time: 3468.5261s
	iters: 300, epoch: 16 | loss: 0.0048703
	speed: 0.0904s/iter; left time: 3575.1125s
	iters: 400, epoch: 16 | loss: 0.0800453
	speed: 0.0863s/iter; left time: 3405.3078s
Epoch: 16 cost time: 41.386399030685425
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.304 Vali Acc: 0.934 Test Loss: 0.304 Test Acc: 0.934
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9662664379645511
model parameter : 1802758
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4719830
	speed: 0.1107s/iter; left time: 5180.6544s
	iters: 200, epoch: 1 | loss: 0.3553141
	speed: 0.0953s/iter; left time: 4450.8057s
	iters: 300, epoch: 1 | loss: 0.4007886
	speed: 0.0957s/iter; left time: 4461.0065s
	iters: 400, epoch: 1 | loss: 0.2437132
	speed: 0.0861s/iter; left time: 4001.4575s
Epoch: 1 cost time: 45.26334261894226
Epoch: 1, Steps: 469 | Train Loss: 0.595 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (inf --> -0.906229).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1133088
	speed: 0.3365s/iter; left time: 15591.3518s
	iters: 200, epoch: 2 | loss: 0.1856302
	speed: 0.0947s/iter; left time: 4377.2062s
	iters: 300, epoch: 2 | loss: 1.1284070
	speed: 0.0929s/iter; left time: 4285.7150s
	iters: 400, epoch: 2 | loss: 0.0875775
	speed: 0.0947s/iter; left time: 4358.3996s
Epoch: 2 cost time: 42.79501152038574
Epoch: 2, Steps: 469 | Train Loss: 0.232 Vali Loss: 0.287 Vali Acc: 0.904 Test Loss: 0.287 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2457796
	speed: 0.3369s/iter; left time: 15451.6880s
	iters: 200, epoch: 3 | loss: 0.0993737
	speed: 0.0925s/iter; left time: 4233.7045s
	iters: 300, epoch: 3 | loss: 0.1335485
	speed: 0.0971s/iter; left time: 4434.6892s
	iters: 400, epoch: 3 | loss: 0.2225160
	speed: 0.0865s/iter; left time: 3941.6651s
Epoch: 3 cost time: 43.69881558418274
Epoch: 3, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.364 Vali Acc: 0.898 Test Loss: 0.364 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0130120
	speed: 0.3653s/iter; left time: 16583.5441s
	iters: 200, epoch: 4 | loss: 0.0627474
	speed: 0.0970s/iter; left time: 4394.2559s
	iters: 300, epoch: 4 | loss: 0.0761067
	speed: 0.0947s/iter; left time: 4281.1852s
	iters: 400, epoch: 4 | loss: 0.1352964
	speed: 0.0996s/iter; left time: 4490.3542s
Epoch: 4 cost time: 45.10246729850769
Epoch: 4, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.382 Vali Acc: 0.915 Test Loss: 0.382 Test Acc: 0.915
Validation loss decreased (-0.906229 --> -0.914805).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3818084
	speed: 0.3598s/iter; left time: 16164.9218s
	iters: 200, epoch: 5 | loss: 0.1183755
	speed: 0.0874s/iter; left time: 3919.8607s
	iters: 300, epoch: 5 | loss: 0.0099490
	speed: 0.0908s/iter; left time: 4060.2092s
	iters: 400, epoch: 5 | loss: 0.0452188
	speed: 0.0845s/iter; left time: 3770.6526s
Epoch: 5 cost time: 42.114882469177246
Epoch: 5, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
Validation loss decreased (-0.914805 --> -0.950827).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1116284
	speed: 0.3387s/iter; left time: 15057.2867s
	iters: 200, epoch: 6 | loss: 0.3238830
	speed: 0.0948s/iter; left time: 4206.0306s
	iters: 300, epoch: 6 | loss: 0.2289112
	speed: 0.0956s/iter; left time: 4230.3682s
	iters: 400, epoch: 6 | loss: 0.1503026
	speed: 0.0854s/iter; left time: 3771.1119s
Epoch: 6 cost time: 41.974475145339966
Epoch: 6, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.240 Vali Acc: 0.938 Test Loss: 0.240 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0598320
	speed: 0.3284s/iter; left time: 14445.4739s
	iters: 200, epoch: 7 | loss: 0.0216555
	speed: 0.0860s/iter; left time: 3774.5258s
	iters: 300, epoch: 7 | loss: 0.2778682
	speed: 0.0866s/iter; left time: 3790.6307s
	iters: 400, epoch: 7 | loss: 0.3511296
	speed: 0.0897s/iter; left time: 3916.9845s
Epoch: 7 cost time: 41.49675369262695
Epoch: 7, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.418 Vali Acc: 0.905 Test Loss: 0.418 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0201295
	speed: 0.3698s/iter; left time: 16091.3381s
	iters: 200, epoch: 8 | loss: 0.0100205
	speed: 0.0957s/iter; left time: 4156.6864s
	iters: 300, epoch: 8 | loss: 0.0058957
	speed: 0.0983s/iter; left time: 4260.0876s
	iters: 400, epoch: 8 | loss: 0.0106843
	speed: 0.0895s/iter; left time: 3868.5252s
Epoch: 8 cost time: 45.835307121276855
Epoch: 8, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1463864
	speed: 0.3553s/iter; left time: 15293.6382s
	iters: 200, epoch: 9 | loss: 0.1440376
	speed: 0.0890s/iter; left time: 3823.6621s
	iters: 300, epoch: 9 | loss: 0.0516681
	speed: 0.0924s/iter; left time: 3960.6194s
	iters: 400, epoch: 9 | loss: 0.1696055
	speed: 0.0805s/iter; left time: 3439.4797s
Epoch: 9 cost time: 41.843286991119385
Epoch: 9, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0046169
	speed: 0.3533s/iter; left time: 15043.4482s
	iters: 200, epoch: 10 | loss: 0.2481356
	speed: 0.0817s/iter; left time: 3469.5035s
	iters: 300, epoch: 10 | loss: 0.3008557
	speed: 0.0844s/iter; left time: 3575.2243s
	iters: 400, epoch: 10 | loss: 0.2996469
	speed: 0.0812s/iter; left time: 3433.4504s
Epoch: 10 cost time: 39.12037372589111
Epoch: 10, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.266 Vali Acc: 0.945 Test Loss: 0.266 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0266072
	speed: 0.3296s/iter; left time: 13881.5476s
	iters: 200, epoch: 11 | loss: 0.0578072
	speed: 0.0832s/iter; left time: 3496.6838s
	iters: 300, epoch: 11 | loss: 0.0136656
	speed: 0.0787s/iter; left time: 3300.3851s
	iters: 400, epoch: 11 | loss: 0.0174699
	speed: 0.0915s/iter; left time: 3825.5675s
Epoch: 11 cost time: 40.202152967453
Epoch: 11, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0175326
	speed: 0.3290s/iter; left time: 13700.5034s
	iters: 200, epoch: 12 | loss: 0.0419587
	speed: 0.0836s/iter; left time: 3472.5914s
	iters: 300, epoch: 12 | loss: 0.0134565
	speed: 0.0794s/iter; left time: 3289.1876s
	iters: 400, epoch: 12 | loss: 0.0183626
	speed: 0.0825s/iter; left time: 3410.5588s
Epoch: 12 cost time: 39.098910093307495
Epoch: 12, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0180712
	speed: 0.3543s/iter; left time: 14588.8553s
	iters: 200, epoch: 13 | loss: 0.0143832
	speed: 0.0978s/iter; left time: 4017.9601s
	iters: 300, epoch: 13 | loss: 0.1846678
	speed: 0.0900s/iter; left time: 3686.6895s
	iters: 400, epoch: 13 | loss: 0.7548742
	speed: 0.0884s/iter; left time: 3611.7970s
Epoch: 13 cost time: 43.54585361480713
Epoch: 13, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.338 Vali Acc: 0.927 Test Loss: 0.338 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2277629
	speed: 0.3454s/iter; left time: 14058.0141s
	iters: 200, epoch: 14 | loss: 0.0341506
	speed: 0.0819s/iter; left time: 3325.2055s
	iters: 300, epoch: 14 | loss: 0.0226858
	speed: 0.0878s/iter; left time: 3556.8958s
	iters: 400, epoch: 14 | loss: 0.0268632
	speed: 0.0851s/iter; left time: 3439.3465s
Epoch: 14 cost time: 41.60608434677124
Epoch: 14, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0505262
	speed: 0.3540s/iter; left time: 14242.2345s
	iters: 200, epoch: 15 | loss: 0.0067956
	speed: 0.0838s/iter; left time: 3363.0991s
	iters: 300, epoch: 15 | loss: 0.0052908
	speed: 0.0918s/iter; left time: 3673.3714s
	iters: 400, epoch: 15 | loss: 0.0078527
	speed: 0.0793s/iter; left time: 3168.4598s
Epoch: 15 cost time: 41.14312982559204
Epoch: 15, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9508290451686678
model parameter : 1802502
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5334797
	speed: 0.1128s/iter; left time: 5278.2880s
	iters: 200, epoch: 1 | loss: 0.5611989
	speed: 0.0850s/iter; left time: 3970.3799s
	iters: 300, epoch: 1 | loss: 0.2306607
	speed: 0.0850s/iter; left time: 3961.2699s
	iters: 400, epoch: 1 | loss: 0.4110452
	speed: 0.0801s/iter; left time: 3722.8935s
Epoch: 1 cost time: 41.848443031311035
Epoch: 1, Steps: 469 | Train Loss: 0.583 Vali Loss: 0.347 Vali Acc: 0.905 Test Loss: 0.347 Test Acc: 0.905
Validation loss decreased (inf --> -0.904513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3103606
	speed: 0.3077s/iter; left time: 14255.9550s
	iters: 200, epoch: 2 | loss: 0.1079669
	speed: 0.0826s/iter; left time: 3820.5490s
	iters: 300, epoch: 2 | loss: 0.0665553
	speed: 0.0889s/iter; left time: 4099.6238s
	iters: 400, epoch: 2 | loss: 0.1734542
	speed: 0.0902s/iter; left time: 4151.3633s
Epoch: 2 cost time: 42.685996770858765
Epoch: 2, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.369 Vali Acc: 0.883 Test Loss: 0.369 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0201553
	speed: 0.3813s/iter; left time: 17487.0760s
	iters: 200, epoch: 3 | loss: 0.2096617
	speed: 0.0851s/iter; left time: 3892.6503s
	iters: 300, epoch: 3 | loss: 0.2032702
	speed: 0.0878s/iter; left time: 4007.9571s
	iters: 400, epoch: 3 | loss: 0.2375391
	speed: 0.0877s/iter; left time: 3998.0882s
Epoch: 3 cost time: 42.870240449905396
Epoch: 3, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.904513 --> -0.932816).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0867212
	speed: 0.3853s/iter; left time: 17491.2774s
	iters: 200, epoch: 4 | loss: 0.1675432
	speed: 0.0836s/iter; left time: 3785.8141s
	iters: 300, epoch: 4 | loss: 0.0151526
	speed: 0.0967s/iter; left time: 4372.0843s
	iters: 400, epoch: 4 | loss: 0.1535789
	speed: 0.0985s/iter; left time: 4441.7937s
Epoch: 4 cost time: 42.856597900390625
Epoch: 4, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.932816 --> -0.944252).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0734878
	speed: 0.3273s/iter; left time: 14702.1661s
	iters: 200, epoch: 5 | loss: 0.0097785
	speed: 0.0834s/iter; left time: 3738.8560s
	iters: 300, epoch: 5 | loss: 0.0741237
	speed: 0.0903s/iter; left time: 4037.9471s
	iters: 400, epoch: 5 | loss: 0.1882172
	speed: 0.0881s/iter; left time: 3932.6293s
Epoch: 5 cost time: 41.132025718688965
Epoch: 5, Steps: 469 | Train Loss: 0.172 Vali Loss: 0.363 Vali Acc: 0.907 Test Loss: 0.363 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0438122
	speed: 0.3438s/iter; left time: 15285.4573s
	iters: 200, epoch: 6 | loss: 0.0213602
	speed: 0.0941s/iter; left time: 4175.6625s
	iters: 300, epoch: 6 | loss: 0.0265663
	speed: 0.0851s/iter; left time: 3767.8707s
	iters: 400, epoch: 6 | loss: 0.0201593
	speed: 0.0868s/iter; left time: 3833.2432s
Epoch: 6 cost time: 41.428415060043335
Epoch: 6, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.296 Vali Acc: 0.935 Test Loss: 0.296 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0076844
	speed: 0.3356s/iter; left time: 14761.0335s
	iters: 200, epoch: 7 | loss: 0.2891217
	speed: 0.0964s/iter; left time: 4231.3633s
	iters: 300, epoch: 7 | loss: 0.0283322
	speed: 0.0990s/iter; left time: 4337.0267s
	iters: 400, epoch: 7 | loss: 0.0062265
	speed: 0.0944s/iter; left time: 4124.6210s
Epoch: 7 cost time: 44.81391930580139
Epoch: 7, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0222037
	speed: 0.3726s/iter; left time: 16214.3691s
	iters: 200, epoch: 8 | loss: 0.0175046
	speed: 0.0891s/iter; left time: 3867.1000s
	iters: 300, epoch: 8 | loss: 0.3426134
	speed: 0.0940s/iter; left time: 4074.0475s
	iters: 400, epoch: 8 | loss: 0.0756534
	speed: 0.0921s/iter; left time: 3978.7438s
Epoch: 8 cost time: 45.21536707878113
Epoch: 8, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.259 Vali Acc: 0.947 Test Loss: 0.259 Test Acc: 0.947
Validation loss decreased (-0.944252 --> -0.947396).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0941466
	speed: 0.3747s/iter; left time: 16129.3220s
	iters: 200, epoch: 9 | loss: 0.1822165
	speed: 0.0869s/iter; left time: 3733.4565s
	iters: 300, epoch: 9 | loss: 0.6301304
	speed: 0.0860s/iter; left time: 3686.2390s
	iters: 400, epoch: 9 | loss: 0.0117332
	speed: 0.0818s/iter; left time: 3495.7496s
Epoch: 9 cost time: 40.70826005935669
Epoch: 9, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0151179
	speed: 0.3474s/iter; left time: 14790.6505s
	iters: 200, epoch: 10 | loss: 0.2904834
	speed: 0.0804s/iter; left time: 3415.4736s
	iters: 300, epoch: 10 | loss: 0.0139392
	speed: 0.0947s/iter; left time: 4013.3724s
	iters: 400, epoch: 10 | loss: 0.0095783
	speed: 0.0946s/iter; left time: 3997.8292s
Epoch: 10 cost time: 42.70292401313782
Epoch: 10, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.947396 --> -0.947682).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0631657
	speed: 0.3575s/iter; left time: 15055.1667s
	iters: 200, epoch: 11 | loss: 0.0156741
	speed: 0.0805s/iter; left time: 3383.6863s
	iters: 300, epoch: 11 | loss: 0.2917447
	speed: 0.0828s/iter; left time: 3470.5155s
	iters: 400, epoch: 11 | loss: 0.7309280
	speed: 0.0809s/iter; left time: 3383.9064s
Epoch: 11 cost time: 39.74912190437317
Epoch: 11, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.278 Vali Acc: 0.938 Test Loss: 0.278 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3607644
	speed: 0.3675s/iter; left time: 15302.8935s
	iters: 200, epoch: 12 | loss: 0.0244384
	speed: 0.0857s/iter; left time: 3559.3375s
	iters: 300, epoch: 12 | loss: 0.4301954
	speed: 0.0967s/iter; left time: 4009.0683s
	iters: 400, epoch: 12 | loss: 0.0316344
	speed: 0.0970s/iter; left time: 4009.6140s
Epoch: 12 cost time: 43.57785987854004
Epoch: 12, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.213 Vali Acc: 0.961 Test Loss: 0.213 Test Acc: 0.961
Validation loss decreased (-0.947682 --> -0.961404).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0078535
	speed: 0.3678s/iter; left time: 15145.1745s
	iters: 200, epoch: 13 | loss: 0.0551895
	speed: 0.0808s/iter; left time: 3319.7264s
	iters: 300, epoch: 13 | loss: 0.2600237
	speed: 0.0976s/iter; left time: 3998.3792s
	iters: 400, epoch: 13 | loss: 0.3295396
	speed: 0.0961s/iter; left time: 3927.5640s
Epoch: 13 cost time: 44.53804922103882
Epoch: 13, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0821355
	speed: 0.3596s/iter; left time: 14636.2598s
	iters: 200, epoch: 14 | loss: 0.0180082
	speed: 0.0859s/iter; left time: 3486.5235s
	iters: 300, epoch: 14 | loss: 0.0681122
	speed: 0.1049s/iter; left time: 4250.5158s
	iters: 400, epoch: 14 | loss: 0.0119696
	speed: 0.0831s/iter; left time: 3355.6808s
Epoch: 14 cost time: 42.142226457595825
Epoch: 14, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0207790
	speed: 0.3301s/iter; left time: 13280.5334s
	iters: 200, epoch: 15 | loss: 0.0575452
	speed: 0.0836s/iter; left time: 3354.7387s
	iters: 300, epoch: 15 | loss: 0.1457897
	speed: 0.1013s/iter; left time: 4055.3912s
	iters: 400, epoch: 15 | loss: 0.0388836
	speed: 0.0958s/iter; left time: 3824.3898s
Epoch: 15 cost time: 43.610270261764526
Epoch: 15, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0095411
	speed: 0.3453s/iter; left time: 13731.8402s
	iters: 200, epoch: 16 | loss: 0.0893206
	speed: 0.0898s/iter; left time: 3560.4285s
	iters: 300, epoch: 16 | loss: 0.0043189
	speed: 0.0919s/iter; left time: 3636.6181s
	iters: 400, epoch: 16 | loss: 0.0398704
	speed: 0.0799s/iter; left time: 3152.7513s
Epoch: 16 cost time: 40.556067943573
Epoch: 16, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.494 Vali Acc: 0.927 Test Loss: 0.494 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0158178
	speed: 0.3536s/iter; left time: 13893.7857s
	iters: 200, epoch: 17 | loss: 0.0089836
	speed: 0.0915s/iter; left time: 3584.7710s
	iters: 300, epoch: 17 | loss: 0.0300293
	speed: 0.1019s/iter; left time: 3985.5249s
	iters: 400, epoch: 17 | loss: 0.0071257
	speed: 0.0904s/iter; left time: 3524.9585s
Epoch: 17 cost time: 45.2773859500885
Epoch: 17, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.320 Vali Acc: 0.952 Test Loss: 0.320 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3042593
	speed: 0.3859s/iter; left time: 14984.1986s
	iters: 200, epoch: 18 | loss: 0.3244947
	speed: 0.0831s/iter; left time: 3216.6392s
	iters: 300, epoch: 18 | loss: 0.3652866
	speed: 0.0852s/iter; left time: 3290.1710s
	iters: 400, epoch: 18 | loss: 0.0022727
	speed: 0.0873s/iter; left time: 3365.3908s
Epoch: 18 cost time: 43.67391109466553
Epoch: 18, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.339 Vali Acc: 0.935 Test Loss: 0.339 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0126324
	speed: 0.3448s/iter; left time: 13227.8582s
	iters: 200, epoch: 19 | loss: 0.0055267
	speed: 0.0909s/iter; left time: 3479.1365s
	iters: 300, epoch: 19 | loss: 0.0046627
	speed: 0.0896s/iter; left time: 3419.0989s
	iters: 400, epoch: 19 | loss: 0.0357426
	speed: 0.0859s/iter; left time: 3270.0384s
Epoch: 19 cost time: 42.18933367729187
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
Validation loss decreased (-0.961404 --> -0.962548).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0021918
	speed: 0.3520s/iter; left time: 13337.3302s
	iters: 200, epoch: 20 | loss: 0.2633116
	speed: 0.0770s/iter; left time: 2909.5157s
	iters: 300, epoch: 20 | loss: 0.0039913
	speed: 0.0828s/iter; left time: 3120.0315s
	iters: 400, epoch: 20 | loss: 0.4484469
	speed: 0.0925s/iter; left time: 3477.9543s
Epoch: 20 cost time: 40.40848898887634
Epoch: 20, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0051062
	speed: 0.3393s/iter; left time: 12698.4134s
	iters: 200, epoch: 21 | loss: 0.2825788
	speed: 0.0836s/iter; left time: 3121.2113s
	iters: 300, epoch: 21 | loss: 0.0058051
	speed: 0.0948s/iter; left time: 3529.5384s
	iters: 400, epoch: 21 | loss: 0.1263460
	speed: 0.0837s/iter; left time: 3105.9459s
Epoch: 21 cost time: 40.988303422927856
Epoch: 21, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
Validation loss decreased (-0.962548 --> -0.967408).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3063152
	speed: 0.3191s/iter; left time: 11791.6344s
	iters: 200, epoch: 22 | loss: 0.0057312
	speed: 0.0910s/iter; left time: 3352.4303s
	iters: 300, epoch: 22 | loss: 0.1246564
	speed: 0.0963s/iter; left time: 3540.2647s
	iters: 400, epoch: 22 | loss: 0.0642243
	speed: 0.0850s/iter; left time: 3114.9839s
Epoch: 22 cost time: 41.45327138900757
Epoch: 22, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
Validation loss decreased (-0.967408 --> -0.967980).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0017228
	speed: 0.3535s/iter; left time: 12895.2162s
	iters: 200, epoch: 23 | loss: 0.2535616
	speed: 0.0946s/iter; left time: 3442.6773s
	iters: 300, epoch: 23 | loss: 0.0247435
	speed: 0.0860s/iter; left time: 3120.7088s
	iters: 400, epoch: 23 | loss: 0.0035679
	speed: 0.0883s/iter; left time: 3195.5476s
Epoch: 23 cost time: 42.557414531707764
Epoch: 23, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.231 Vali Acc: 0.955 Test Loss: 0.231 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0030090
	speed: 0.3618s/iter; left time: 13031.2140s
	iters: 200, epoch: 24 | loss: 0.0019466
	speed: 0.1025s/iter; left time: 3679.6335s
	iters: 300, epoch: 24 | loss: 0.0052541
	speed: 0.0911s/iter; left time: 3262.4316s
	iters: 400, epoch: 24 | loss: 0.0029735
	speed: 0.0925s/iter; left time: 3301.9544s
Epoch: 24 cost time: 44.74908447265625
Epoch: 24, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.216 Vali Acc: 0.961 Test Loss: 0.216 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.3614586
	speed: 0.3502s/iter; left time: 12449.1637s
	iters: 200, epoch: 25 | loss: 0.0752028
	speed: 0.0875s/iter; left time: 3102.1109s
	iters: 300, epoch: 25 | loss: 0.0037180
	speed: 0.0749s/iter; left time: 2648.6767s
	iters: 400, epoch: 25 | loss: 0.0040900
	speed: 0.0807s/iter; left time: 2844.6363s
Epoch: 25 cost time: 38.52847385406494
Epoch: 25, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0185968
	speed: 0.3415s/iter; left time: 11980.1427s
	iters: 200, epoch: 26 | loss: 0.0063796
	speed: 0.0853s/iter; left time: 2982.1553s
	iters: 300, epoch: 26 | loss: 0.0024571
	speed: 0.0834s/iter; left time: 2908.9445s
	iters: 400, epoch: 26 | loss: 0.0021521
	speed: 0.0797s/iter; left time: 2769.9386s
Epoch: 26 cost time: 40.1485538482666
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2428392
	speed: 0.3307s/iter; left time: 11446.0087s
	iters: 200, epoch: 27 | loss: 0.0120067
	speed: 0.0882s/iter; left time: 3042.7899s
	iters: 300, epoch: 27 | loss: 0.1041518
	speed: 0.0854s/iter; left time: 2938.3334s
	iters: 400, epoch: 27 | loss: 0.0053011
	speed: 0.0843s/iter; left time: 2893.0985s
Epoch: 27 cost time: 40.48776936531067
Epoch: 27, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0064163
	speed: 0.3653s/iter; left time: 12469.6563s
	iters: 200, epoch: 28 | loss: 0.0035092
	speed: 0.0889s/iter; left time: 3026.3343s
	iters: 300, epoch: 28 | loss: 0.0055003
	speed: 0.0894s/iter; left time: 3033.4393s
	iters: 400, epoch: 28 | loss: 0.0032212
	speed: 0.0826s/iter; left time: 2795.2348s
Epoch: 28 cost time: 42.27117729187012
Epoch: 28, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.205 Vali Acc: 0.964 Test Loss: 0.205 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0636932
	speed: 0.3428s/iter; left time: 11541.3158s
	iters: 200, epoch: 29 | loss: 0.0219175
	speed: 0.0962s/iter; left time: 3230.4223s
	iters: 300, epoch: 29 | loss: 0.0658689
	speed: 0.0881s/iter; left time: 2949.4180s
	iters: 400, epoch: 29 | loss: 0.0037837
	speed: 0.0945s/iter; left time: 3153.3840s
Epoch: 29 cost time: 43.6116988658905
Epoch: 29, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.960 Test Loss: 0.229 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0021155
	speed: 0.3466s/iter; left time: 11507.2129s
	iters: 200, epoch: 30 | loss: 0.2935083
	speed: 0.0864s/iter; left time: 2860.9977s
	iters: 300, epoch: 30 | loss: 0.0014837
	speed: 0.0835s/iter; left time: 2755.2194s
	iters: 400, epoch: 30 | loss: 0.0039512
	speed: 0.0812s/iter; left time: 2672.0549s
Epoch: 30 cost time: 39.60092329978943
Epoch: 30, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.960 Test Loss: 0.235 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0204305
	speed: 0.3423s/iter; left time: 11203.2800s
	iters: 200, epoch: 31 | loss: 0.0316485
	speed: 0.0900s/iter; left time: 2935.5497s
	iters: 300, epoch: 31 | loss: 0.1034492
	speed: 0.0874s/iter; left time: 2844.0384s
	iters: 400, epoch: 31 | loss: 0.0023532
	speed: 0.0932s/iter; left time: 3021.0147s
Epoch: 31 cost time: 41.85908889770508
Epoch: 31, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
Validation loss decreased (-0.967980 --> -0.967980).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.2376462
	speed: 0.3147s/iter; left time: 10153.2771s
	iters: 200, epoch: 32 | loss: 0.0233245
	speed: 0.0877s/iter; left time: 2821.9107s
	iters: 300, epoch: 32 | loss: 0.0056471
	speed: 0.0867s/iter; left time: 2779.7312s
	iters: 400, epoch: 32 | loss: 0.3747908
	speed: 0.0908s/iter; left time: 2903.5131s
Epoch: 32 cost time: 42.080923318862915
Epoch: 32, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.961 Test Loss: 0.253 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0035818
	speed: 0.3663s/iter; left time: 11646.4743s
	iters: 200, epoch: 33 | loss: 0.0063319
	speed: 0.0987s/iter; left time: 3127.6721s
	iters: 300, epoch: 33 | loss: 0.0013400
	speed: 0.0886s/iter; left time: 2798.0988s
	iters: 400, epoch: 33 | loss: 0.0022123
	speed: 0.0859s/iter; left time: 2706.7660s
Epoch: 33 cost time: 42.798431158065796
Epoch: 33, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0032444
	speed: 0.3563s/iter; left time: 11159.5618s
	iters: 200, epoch: 34 | loss: 0.0058114
	speed: 0.0872s/iter; left time: 2722.2891s
	iters: 300, epoch: 34 | loss: 0.4543145
	speed: 0.0958s/iter; left time: 2980.1875s
	iters: 400, epoch: 34 | loss: 0.0029238
	speed: 0.0963s/iter; left time: 2987.3830s
Epoch: 34 cost time: 43.916008710861206
Epoch: 34, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0020175
	speed: 0.3481s/iter; left time: 10739.0919s
	iters: 200, epoch: 35 | loss: 0.0011573
	speed: 0.0857s/iter; left time: 2636.9505s
	iters: 300, epoch: 35 | loss: 0.0009969
	speed: 0.0776s/iter; left time: 2377.9520s
	iters: 400, epoch: 35 | loss: 0.8287507
	speed: 0.0951s/iter; left time: 2906.2596s
Epoch: 35 cost time: 40.21894907951355
Epoch: 35, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0217381
	speed: 0.3265s/iter; left time: 9920.2000s
	iters: 200, epoch: 36 | loss: 0.0022391
	speed: 0.1018s/iter; left time: 3084.1190s
	iters: 300, epoch: 36 | loss: 0.0276179
	speed: 0.0938s/iter; left time: 2832.2536s
	iters: 400, epoch: 36 | loss: 0.0176028
	speed: 0.0818s/iter; left time: 2461.7714s
Epoch: 36 cost time: 42.341055154800415
Epoch: 36, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0513599
	speed: 0.3371s/iter; left time: 10084.1278s
	iters: 200, epoch: 37 | loss: 0.0021202
	speed: 0.0939s/iter; left time: 2800.0301s
	iters: 300, epoch: 37 | loss: 0.0269701
	speed: 0.0911s/iter; left time: 2707.7272s
	iters: 400, epoch: 37 | loss: 0.0061915
	speed: 0.0931s/iter; left time: 2757.5429s
Epoch: 37 cost time: 43.92432999610901
Epoch: 37, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0028003
	speed: 0.3615s/iter; left time: 10644.2692s
	iters: 200, epoch: 38 | loss: 0.0018379
	speed: 0.0931s/iter; left time: 2731.0612s
	iters: 300, epoch: 38 | loss: 0.0011577
	speed: 0.0866s/iter; left time: 2532.8535s
	iters: 400, epoch: 38 | loss: 0.0019215
	speed: 0.0888s/iter; left time: 2589.6413s
Epoch: 38 cost time: 43.22455167770386
Epoch: 38, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0488362
	speed: 0.3833s/iter; left time: 11107.7348s
	iters: 200, epoch: 39 | loss: 0.0039555
	speed: 0.0934s/iter; left time: 2696.1841s
	iters: 300, epoch: 39 | loss: 0.0022207
	speed: 0.0965s/iter; left time: 2777.1246s
	iters: 400, epoch: 39 | loss: 0.0273721
	speed: 0.0802s/iter; left time: 2300.4507s
Epoch: 39 cost time: 43.15230917930603
Epoch: 39, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.967980 --> -0.971982).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0074737
	speed: 0.3419s/iter; left time: 9748.4037s
	iters: 200, epoch: 40 | loss: 0.0027763
	speed: 0.0906s/iter; left time: 2575.3110s
	iters: 300, epoch: 40 | loss: 0.0017030
	speed: 0.0905s/iter; left time: 2562.8315s
	iters: 400, epoch: 40 | loss: 0.0022934
	speed: 0.0899s/iter; left time: 2537.4841s
Epoch: 40 cost time: 43.71857714653015
Epoch: 40, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.342 Vali Acc: 0.953 Test Loss: 0.342 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0590733
	speed: 0.3453s/iter; left time: 9683.9161s
	iters: 200, epoch: 41 | loss: 0.1596921
	speed: 0.0832s/iter; left time: 2326.0562s
	iters: 300, epoch: 41 | loss: 0.0029631
	speed: 0.0832s/iter; left time: 2316.4404s
	iters: 400, epoch: 41 | loss: 0.0554424
	speed: 0.0863s/iter; left time: 2393.2519s
Epoch: 41 cost time: 40.628316164016724
Epoch: 41, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.963 Test Loss: 0.218 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.0008782
	speed: 0.3515s/iter; left time: 9691.9053s
	iters: 200, epoch: 42 | loss: 0.0069727
	speed: 0.0936s/iter; left time: 2571.2011s
	iters: 300, epoch: 42 | loss: 0.0026155
	speed: 0.1061s/iter; left time: 2904.5643s
	iters: 400, epoch: 42 | loss: 0.2010516
	speed: 0.0949s/iter; left time: 2587.5207s
Epoch: 42 cost time: 44.7514533996582
Epoch: 42, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0159855
	speed: 0.3571s/iter; left time: 9677.4875s
	iters: 200, epoch: 43 | loss: 0.0056358
	speed: 0.0916s/iter; left time: 2474.0439s
	iters: 300, epoch: 43 | loss: 0.0010406
	speed: 0.0936s/iter; left time: 2518.4358s
	iters: 400, epoch: 43 | loss: 0.0012964
	speed: 0.0987s/iter; left time: 2645.1664s
Epoch: 43 cost time: 44.75019288063049
Epoch: 43, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.261 Vali Acc: 0.953 Test Loss: 0.261 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.0330747
	speed: 0.3665s/iter; left time: 9762.3613s
	iters: 200, epoch: 44 | loss: 0.0047759
	speed: 0.0843s/iter; left time: 2236.6832s
	iters: 300, epoch: 44 | loss: 0.0005877
	speed: 0.0791s/iter; left time: 2091.0948s
	iters: 400, epoch: 44 | loss: 0.0012283
	speed: 0.0823s/iter; left time: 2166.2422s
Epoch: 44 cost time: 40.36355757713318
Epoch: 44, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.0154506
	speed: 0.3512s/iter; left time: 9188.4624s
	iters: 200, epoch: 45 | loss: 0.0674664
	speed: 0.0864s/iter; left time: 2252.1655s
	iters: 300, epoch: 45 | loss: 0.0012286
	speed: 0.0868s/iter; left time: 2253.8417s
	iters: 400, epoch: 45 | loss: 0.0009515
	speed: 0.0920s/iter; left time: 2379.8213s
Epoch: 45 cost time: 41.776166915893555
Epoch: 45, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.0022419
	speed: 0.3305s/iter; left time: 8492.9366s
	iters: 200, epoch: 46 | loss: 0.0039149
	speed: 0.0847s/iter; left time: 2168.9184s
	iters: 300, epoch: 46 | loss: 0.0021077
	speed: 0.0901s/iter; left time: 2298.1975s
	iters: 400, epoch: 46 | loss: 0.0022103
	speed: 0.0814s/iter; left time: 2067.6066s
Epoch: 46 cost time: 39.85110020637512
Epoch: 46, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.0011577
	speed: 0.3428s/iter; left time: 8648.0094s
	iters: 200, epoch: 47 | loss: 0.0133742
	speed: 0.0811s/iter; left time: 2038.1446s
	iters: 300, epoch: 47 | loss: 0.0079228
	speed: 0.0935s/iter; left time: 2340.0747s
	iters: 400, epoch: 47 | loss: 0.0003540
	speed: 0.0889s/iter; left time: 2215.6587s
Epoch: 47 cost time: 42.32785701751709
Epoch: 47, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.0004142
	speed: 0.3565s/iter; left time: 8825.4932s
	iters: 200, epoch: 48 | loss: 0.2135797
	speed: 0.0934s/iter; left time: 2303.7267s
	iters: 300, epoch: 48 | loss: 0.0018851
	speed: 0.0908s/iter; left time: 2230.8756s
	iters: 400, epoch: 48 | loss: 0.0009727
	speed: 0.0931s/iter; left time: 2276.0958s
Epoch: 48 cost time: 44.18202066421509
Epoch: 48, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.0039020
	speed: 0.3693s/iter; left time: 8970.8045s
	iters: 200, epoch: 49 | loss: 0.0540813
	speed: 0.0855s/iter; left time: 2067.1809s
	iters: 300, epoch: 49 | loss: 0.0031931
	speed: 0.0897s/iter; left time: 2161.5953s
	iters: 400, epoch: 49 | loss: 0.0013327
	speed: 0.0973s/iter; left time: 2334.4397s
Epoch: 49 cost time: 42.020379066467285
Epoch: 49, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.285 Vali Acc: 0.959 Test Loss: 0.285 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 1802246
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4447405
	speed: 0.1031s/iter; left time: 4825.7651s
	iters: 200, epoch: 1 | loss: 0.3788485
	speed: 0.0829s/iter; left time: 3873.1110s
	iters: 300, epoch: 1 | loss: 0.2746053
	speed: 0.0895s/iter; left time: 4172.4298s
	iters: 400, epoch: 1 | loss: 0.2158088
	speed: 0.0769s/iter; left time: 3577.6089s
Epoch: 1 cost time: 41.178911209106445
Epoch: 1, Steps: 469 | Train Loss: 0.564 Vali Loss: 0.431 Vali Acc: 0.842 Test Loss: 0.431 Test Acc: 0.842
Validation loss decreased (inf --> -0.841619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0282305
	speed: 0.3401s/iter; left time: 15755.4549s
	iters: 200, epoch: 2 | loss: 0.1280256
	speed: 0.0860s/iter; left time: 3973.9021s
	iters: 300, epoch: 2 | loss: 0.0519994
	speed: 0.0836s/iter; left time: 3857.4386s
	iters: 400, epoch: 2 | loss: 0.4664657
	speed: 0.0897s/iter; left time: 4130.4253s
Epoch: 2 cost time: 41.3108172416687
Epoch: 2, Steps: 469 | Train Loss: 0.220 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.841619 --> -0.911089).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4762589
	speed: 0.3567s/iter; left time: 16358.9857s
	iters: 200, epoch: 3 | loss: 0.0189057
	speed: 0.0868s/iter; left time: 3972.2727s
	iters: 300, epoch: 3 | loss: 0.6412985
	speed: 0.0952s/iter; left time: 4348.5959s
	iters: 400, epoch: 3 | loss: 0.2989931
	speed: 0.0874s/iter; left time: 3982.5880s
Epoch: 3 cost time: 42.65491485595703
Epoch: 3, Steps: 469 | Train Loss: 0.221 Vali Loss: 0.440 Vali Acc: 0.874 Test Loss: 0.440 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4043967
	speed: 0.3746s/iter; left time: 17003.2140s
	iters: 200, epoch: 4 | loss: 0.0879095
	speed: 0.0930s/iter; left time: 4210.2472s
	iters: 300, epoch: 4 | loss: 0.1662732
	speed: 0.0956s/iter; left time: 4319.1083s
	iters: 400, epoch: 4 | loss: 0.1813545
	speed: 0.0878s/iter; left time: 3958.0366s
Epoch: 4 cost time: 44.11249041557312
Epoch: 4, Steps: 469 | Train Loss: 0.193 Vali Loss: 0.236 Vali Acc: 0.940 Test Loss: 0.236 Test Acc: 0.940
Validation loss decreased (-0.911089 --> -0.939963).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0255594
	speed: 0.3644s/iter; left time: 16368.6055s
	iters: 200, epoch: 5 | loss: 0.2858786
	speed: 0.0928s/iter; left time: 4161.0516s
	iters: 300, epoch: 5 | loss: 0.0239772
	speed: 0.0837s/iter; left time: 3744.5084s
	iters: 400, epoch: 5 | loss: 0.0927615
	speed: 0.0946s/iter; left time: 4223.6077s
Epoch: 5 cost time: 43.18712878227234
Epoch: 5, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.939963 --> -0.951113).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0103091
	speed: 0.3377s/iter; left time: 15013.3763s
	iters: 200, epoch: 6 | loss: 0.0496073
	speed: 0.0809s/iter; left time: 3589.8648s
	iters: 300, epoch: 6 | loss: 0.0429849
	speed: 0.0841s/iter; left time: 3720.4718s
	iters: 400, epoch: 6 | loss: 0.0515630
	speed: 0.0925s/iter; left time: 4085.3794s
Epoch: 6 cost time: 40.49532341957092
Epoch: 6, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.241 Vali Acc: 0.947 Test Loss: 0.241 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1024066
	speed: 0.3190s/iter; left time: 14029.8145s
	iters: 200, epoch: 7 | loss: 0.1318333
	speed: 0.0904s/iter; left time: 3968.1259s
	iters: 300, epoch: 7 | loss: 0.1834105
	speed: 0.0835s/iter; left time: 3655.8722s
	iters: 400, epoch: 7 | loss: 0.0136763
	speed: 0.0945s/iter; left time: 4129.0391s
Epoch: 7 cost time: 41.45552372932434
Epoch: 7, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2397735
	speed: 0.3599s/iter; left time: 15660.0659s
	iters: 200, epoch: 8 | loss: 0.0201071
	speed: 0.1103s/iter; left time: 4788.6539s
	iters: 300, epoch: 8 | loss: 0.8931506
	speed: 0.0950s/iter; left time: 4116.6331s
	iters: 400, epoch: 8 | loss: 0.1491386
	speed: 0.0895s/iter; left time: 3869.1211s
Epoch: 8 cost time: 44.82151937484741
Epoch: 8, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.951113 --> -0.968552).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3343568
	speed: 0.3681s/iter; left time: 15848.4274s
	iters: 200, epoch: 9 | loss: 0.2491527
	speed: 0.0986s/iter; left time: 4234.3468s
	iters: 300, epoch: 9 | loss: 0.2182023
	speed: 0.0911s/iter; left time: 3902.2867s
	iters: 400, epoch: 9 | loss: 0.0218817
	speed: 0.0905s/iter; left time: 3869.0590s
Epoch: 9 cost time: 45.573031187057495
Epoch: 9, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.226 Vali Acc: 0.940 Test Loss: 0.226 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1127979
	speed: 0.3565s/iter; left time: 15180.0904s
	iters: 200, epoch: 10 | loss: 0.2950477
	speed: 0.0855s/iter; left time: 3630.3217s
	iters: 300, epoch: 10 | loss: 0.0149912
	speed: 0.0829s/iter; left time: 3512.4989s
	iters: 400, epoch: 10 | loss: 0.0421821
	speed: 0.0834s/iter; left time: 3525.8896s
Epoch: 10 cost time: 40.78174352645874
Epoch: 10, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0062015
	speed: 0.3542s/iter; left time: 14916.1857s
	iters: 200, epoch: 11 | loss: 0.2045669
	speed: 0.0851s/iter; left time: 3574.2774s
	iters: 300, epoch: 11 | loss: 0.2311065
	speed: 0.0916s/iter; left time: 3839.6625s
	iters: 400, epoch: 11 | loss: 0.0084066
	speed: 0.0818s/iter; left time: 3418.8710s
Epoch: 11 cost time: 41.45111012458801
Epoch: 11, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.241 Vali Acc: 0.936 Test Loss: 0.241 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0053677
	speed: 0.3421s/iter; left time: 14245.0459s
	iters: 200, epoch: 12 | loss: 0.0924126
	speed: 0.0860s/iter; left time: 3572.9267s
	iters: 300, epoch: 12 | loss: 0.0124350
	speed: 0.0823s/iter; left time: 3410.8785s
	iters: 400, epoch: 12 | loss: 0.0552866
	speed: 0.0820s/iter; left time: 3391.7912s
Epoch: 12 cost time: 41.571457624435425
Epoch: 12, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2885387
	speed: 0.3744s/iter; left time: 15414.1471s
	iters: 200, epoch: 13 | loss: 0.0073020
	speed: 0.0806s/iter; left time: 3310.2651s
	iters: 300, epoch: 13 | loss: 0.0038285
	speed: 0.0879s/iter; left time: 3602.9383s
	iters: 400, epoch: 13 | loss: 0.0194593
	speed: 0.0996s/iter; left time: 4072.4437s
Epoch: 13 cost time: 42.09821009635925
Epoch: 13, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.215 Vali Acc: 0.955 Test Loss: 0.215 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0122326
	speed: 0.3583s/iter; left time: 14585.5526s
	iters: 200, epoch: 14 | loss: 0.1224204
	speed: 0.0940s/iter; left time: 3816.8882s
	iters: 300, epoch: 14 | loss: 0.0249700
	speed: 0.1036s/iter; left time: 4196.4250s
	iters: 400, epoch: 14 | loss: 0.0137490
	speed: 0.0980s/iter; left time: 3958.4474s
Epoch: 14 cost time: 44.62873816490173
Epoch: 14, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.301 Vali Acc: 0.937 Test Loss: 0.301 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0182568
	speed: 0.3181s/iter; left time: 12800.4499s
	iters: 200, epoch: 15 | loss: 0.2955277
	speed: 0.0875s/iter; left time: 3509.8666s
	iters: 300, epoch: 15 | loss: 0.0234523
	speed: 0.0982s/iter; left time: 3930.3315s
	iters: 400, epoch: 15 | loss: 0.0058317
	speed: 0.0843s/iter; left time: 3367.1520s
Epoch: 15 cost time: 41.22457814216614
Epoch: 15, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3858868
	speed: 0.3578s/iter; left time: 14228.4850s
	iters: 200, epoch: 16 | loss: 0.0598901
	speed: 0.0879s/iter; left time: 3484.7728s
	iters: 300, epoch: 16 | loss: 0.0125360
	speed: 0.0848s/iter; left time: 3355.9419s
	iters: 400, epoch: 16 | loss: 0.5845480
	speed: 0.0816s/iter; left time: 3218.8192s
Epoch: 16 cost time: 41.50135636329651
Epoch: 16, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0152421
	speed: 0.3078s/iter; left time: 12095.4760s
	iters: 200, epoch: 17 | loss: 0.1933205
	speed: 0.0839s/iter; left time: 3290.4627s
	iters: 300, epoch: 17 | loss: 0.0108046
	speed: 0.0872s/iter; left time: 3409.0198s
	iters: 400, epoch: 17 | loss: 0.0024092
	speed: 0.0820s/iter; left time: 3197.2059s
Epoch: 17 cost time: 40.43571066856384
Epoch: 17, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2918605
	speed: 0.3509s/iter; left time: 13623.1787s
	iters: 200, epoch: 18 | loss: 0.0215660
	speed: 0.0856s/iter; left time: 3314.3703s
	iters: 300, epoch: 18 | loss: 0.0281780
	speed: 0.0866s/iter; left time: 3344.1040s
	iters: 400, epoch: 18 | loss: 0.1132507
	speed: 0.0963s/iter; left time: 3708.4195s
Epoch: 18 cost time: 41.44531321525574
Epoch: 18, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9685534591194969
model parameter : 1801990
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9107742
	speed: 0.1212s/iter; left time: 5670.6498s
	iters: 200, epoch: 1 | loss: 0.3934561
	speed: 0.0915s/iter; left time: 4271.6797s
	iters: 300, epoch: 1 | loss: 0.1452548
	speed: 0.0770s/iter; left time: 3587.1501s
	iters: 400, epoch: 1 | loss: 0.3435043
	speed: 0.0774s/iter; left time: 3598.8737s
Epoch: 1 cost time: 42.41668128967285
Epoch: 1, Steps: 469 | Train Loss: 0.611 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
Validation loss decreased (inf --> -0.883930).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3664604
	speed: 0.3418s/iter; left time: 15837.2812s
	iters: 200, epoch: 2 | loss: 0.1142441
	speed: 0.0923s/iter; left time: 4266.7003s
	iters: 300, epoch: 2 | loss: 0.1641996
	speed: 0.0907s/iter; left time: 4185.2443s
	iters: 400, epoch: 2 | loss: 0.0300918
	speed: 0.0863s/iter; left time: 3974.3767s
Epoch: 2 cost time: 41.94660806655884
Epoch: 2, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2613252
	speed: 0.3326s/iter; left time: 15254.5297s
	iters: 200, epoch: 3 | loss: 0.2247733
	speed: 0.0816s/iter; left time: 3734.2663s
	iters: 300, epoch: 3 | loss: 0.5087650
	speed: 0.0823s/iter; left time: 3759.5305s
	iters: 400, epoch: 3 | loss: 0.0154019
	speed: 0.0899s/iter; left time: 4094.3179s
Epoch: 3 cost time: 40.70273017883301
Epoch: 3, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.277 Vali Acc: 0.921 Test Loss: 0.277 Test Acc: 0.921
Validation loss decreased (-0.883930 --> -0.921095).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0234047
	speed: 0.3369s/iter; left time: 15292.2389s
	iters: 200, epoch: 4 | loss: 0.4373837
	speed: 0.0953s/iter; left time: 4314.4605s
	iters: 300, epoch: 4 | loss: 0.0313569
	speed: 0.0851s/iter; left time: 3847.7994s
	iters: 400, epoch: 4 | loss: 0.0232689
	speed: 0.0887s/iter; left time: 3998.4870s
Epoch: 4 cost time: 41.92297005653381
Epoch: 4, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.488 Vali Acc: 0.879 Test Loss: 0.488 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4883769
	speed: 0.3405s/iter; left time: 15298.2922s
	iters: 200, epoch: 5 | loss: 0.0283637
	speed: 0.0908s/iter; left time: 4068.3364s
	iters: 300, epoch: 5 | loss: 0.0205750
	speed: 0.0949s/iter; left time: 4244.7203s
	iters: 400, epoch: 5 | loss: 0.0530245
	speed: 0.0898s/iter; left time: 4009.3649s
Epoch: 5 cost time: 43.16323208808899
Epoch: 5, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.921095 --> -0.936533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1152523
	speed: 0.3514s/iter; left time: 15621.3191s
	iters: 200, epoch: 6 | loss: 0.0436542
	speed: 0.0878s/iter; left time: 3893.9266s
	iters: 300, epoch: 6 | loss: 0.0339418
	speed: 0.0781s/iter; left time: 3456.1267s
	iters: 400, epoch: 6 | loss: 0.0058387
	speed: 0.0882s/iter; left time: 3895.0789s
Epoch: 6 cost time: 41.327216386795044
Epoch: 6, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
Validation loss decreased (-0.936533 --> -0.942822).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1128139
	speed: 0.3496s/iter; left time: 15377.9078s
	iters: 200, epoch: 7 | loss: 0.0127978
	speed: 0.0939s/iter; left time: 4120.9742s
	iters: 300, epoch: 7 | loss: 0.0575234
	speed: 0.0891s/iter; left time: 3902.6099s
	iters: 400, epoch: 7 | loss: 0.2782482
	speed: 0.0948s/iter; left time: 4140.9662s
Epoch: 7 cost time: 43.19580268859863
Epoch: 7, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.246 Vali Acc: 0.932 Test Loss: 0.246 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3320154
	speed: 0.3409s/iter; left time: 14837.2949s
	iters: 200, epoch: 8 | loss: 0.2299462
	speed: 0.0793s/iter; left time: 3442.9595s
	iters: 300, epoch: 8 | loss: 0.1434033
	speed: 0.0892s/iter; left time: 3861.8129s
	iters: 400, epoch: 8 | loss: 0.0831807
	speed: 0.0821s/iter; left time: 3546.5749s
Epoch: 8 cost time: 39.473886251449585
Epoch: 8, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.942822 --> -0.947968).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4509115
	speed: 0.3354s/iter; left time: 14439.9090s
	iters: 200, epoch: 9 | loss: 0.0132837
	speed: 0.0862s/iter; left time: 3700.5448s
	iters: 300, epoch: 9 | loss: 0.0617364
	speed: 0.0819s/iter; left time: 3511.0129s
	iters: 400, epoch: 9 | loss: 0.0079604
	speed: 0.0897s/iter; left time: 3836.1272s
Epoch: 9 cost time: 40.6116361618042
Epoch: 9, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0108364
	speed: 0.3261s/iter; left time: 13884.5519s
	iters: 200, epoch: 10 | loss: 0.2494940
	speed: 0.0987s/iter; left time: 4194.1743s
	iters: 300, epoch: 10 | loss: 0.0045673
	speed: 0.0955s/iter; left time: 4047.3023s
	iters: 400, epoch: 10 | loss: 0.2792765
	speed: 0.0927s/iter; left time: 3918.5858s
Epoch: 10 cost time: 43.88574957847595
Epoch: 10, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.233 Vali Acc: 0.927 Test Loss: 0.233 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0338203
	speed: 0.3475s/iter; left time: 14634.2731s
	iters: 200, epoch: 11 | loss: 0.0082048
	speed: 0.0820s/iter; left time: 3446.5940s
	iters: 300, epoch: 11 | loss: 0.0038122
	speed: 0.0874s/iter; left time: 3664.3243s
	iters: 400, epoch: 11 | loss: 0.0828260
	speed: 0.0831s/iter; left time: 3473.0785s
Epoch: 11 cost time: 40.30406451225281
Epoch: 11, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
Validation loss decreased (-0.947968 --> -0.966551).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1831033
	speed: 0.3506s/iter; left time: 14601.4287s
	iters: 200, epoch: 12 | loss: 0.3575932
	speed: 0.0821s/iter; left time: 3412.5892s
	iters: 300, epoch: 12 | loss: 0.0589151
	speed: 0.0809s/iter; left time: 3354.1246s
	iters: 400, epoch: 12 | loss: 0.0074648
	speed: 0.0803s/iter; left time: 3319.3505s
Epoch: 12 cost time: 40.053046464920044
Epoch: 12, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3342875
	speed: 0.3184s/iter; left time: 13111.2476s
	iters: 200, epoch: 13 | loss: 0.0044503
	speed: 0.0850s/iter; left time: 3491.5807s
	iters: 300, epoch: 13 | loss: 0.0702011
	speed: 0.0842s/iter; left time: 3451.8188s
	iters: 400, epoch: 13 | loss: 0.0061073
	speed: 0.0843s/iter; left time: 3443.9615s
Epoch: 13 cost time: 39.77862000465393
Epoch: 13, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0337411
	speed: 0.3381s/iter; left time: 13763.4702s
	iters: 200, epoch: 14 | loss: 0.0733971
	speed: 0.0905s/iter; left time: 3674.9770s
	iters: 300, epoch: 14 | loss: 0.3107574
	speed: 0.0922s/iter; left time: 3733.1560s
	iters: 400, epoch: 14 | loss: 0.0045426
	speed: 0.0910s/iter; left time: 3676.5904s
Epoch: 14 cost time: 42.60489797592163
Epoch: 14, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0279475
	speed: 0.3276s/iter; left time: 13180.7636s
	iters: 200, epoch: 15 | loss: 0.0045214
	speed: 0.0910s/iter; left time: 3653.6550s
	iters: 300, epoch: 15 | loss: 0.0009995
	speed: 0.0919s/iter; left time: 3679.2561s
	iters: 400, epoch: 15 | loss: 0.0123379
	speed: 0.0943s/iter; left time: 3765.9146s
Epoch: 15 cost time: 42.56356120109558
Epoch: 15, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.240 Vali Acc: 0.946 Test Loss: 0.240 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0038083
	speed: 0.3389s/iter; left time: 13477.1799s
	iters: 200, epoch: 16 | loss: 0.0016792
	speed: 0.0895s/iter; left time: 3550.8132s
	iters: 300, epoch: 16 | loss: 0.0057327
	speed: 0.0859s/iter; left time: 3399.4386s
	iters: 400, epoch: 16 | loss: 0.0031670
	speed: 0.0834s/iter; left time: 3290.1887s
Epoch: 16 cost time: 40.68164420127869
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.245 Vali Acc: 0.947 Test Loss: 0.245 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0152771
	speed: 0.3509s/iter; left time: 13790.3088s
	iters: 200, epoch: 17 | loss: 0.0027904
	speed: 0.0792s/iter; left time: 3103.5116s
	iters: 300, epoch: 17 | loss: 0.1495399
	speed: 0.0880s/iter; left time: 3441.6392s
	iters: 400, epoch: 17 | loss: 0.0127308
	speed: 0.0845s/iter; left time: 3295.3265s
Epoch: 17 cost time: 41.659913063049316
Epoch: 17, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0022904
	speed: 0.3289s/iter; left time: 12770.4052s
	iters: 200, epoch: 18 | loss: 0.0038053
	speed: 0.0837s/iter; left time: 3242.4130s
	iters: 300, epoch: 18 | loss: 0.0067551
	speed: 0.0838s/iter; left time: 3235.2523s
	iters: 400, epoch: 18 | loss: 0.0060997
	speed: 0.0839s/iter; left time: 3234.2637s
Epoch: 18 cost time: 39.202576875686646
Epoch: 18, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.966551 --> -0.967123).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1426454
	speed: 0.3357s/iter; left time: 12876.5698s
	iters: 200, epoch: 19 | loss: 0.0027645
	speed: 0.0832s/iter; left time: 3183.6112s
	iters: 300, epoch: 19 | loss: 0.0011522
	speed: 0.0787s/iter; left time: 3004.6612s
	iters: 400, epoch: 19 | loss: 0.0894270
	speed: 0.0794s/iter; left time: 3022.3230s
Epoch: 19 cost time: 38.54601430892944
Epoch: 19, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0067578
	speed: 0.3314s/iter; left time: 12556.3868s
	iters: 200, epoch: 20 | loss: 0.0903085
	speed: 0.0813s/iter; left time: 3074.1367s
	iters: 300, epoch: 20 | loss: 0.0390171
	speed: 0.0868s/iter; left time: 3272.0509s
	iters: 400, epoch: 20 | loss: 0.0028524
	speed: 0.0837s/iter; left time: 3147.5176s
Epoch: 20 cost time: 40.29006290435791
Epoch: 20, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.267 Vali Acc: 0.947 Test Loss: 0.267 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0044178
	speed: 0.3373s/iter; left time: 12621.1164s
	iters: 200, epoch: 21 | loss: 0.0054400
	speed: 0.0835s/iter; left time: 3115.5906s
	iters: 300, epoch: 21 | loss: 0.0036091
	speed: 0.0836s/iter; left time: 3109.8237s
	iters: 400, epoch: 21 | loss: 0.0080747
	speed: 0.0838s/iter; left time: 3109.4933s
Epoch: 21 cost time: 40.55166697502136
Epoch: 21, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0975867
	speed: 0.3394s/iter; left time: 12540.4157s
	iters: 200, epoch: 22 | loss: 0.3564664
	speed: 0.0867s/iter; left time: 3194.0660s
	iters: 300, epoch: 22 | loss: 0.0165170
	speed: 0.0866s/iter; left time: 3181.9261s
	iters: 400, epoch: 22 | loss: 0.0078638
	speed: 0.0881s/iter; left time: 3229.7701s
Epoch: 22 cost time: 40.854127407073975
Epoch: 22, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0058294
	speed: 0.3206s/iter; left time: 11697.5448s
	iters: 200, epoch: 23 | loss: 0.0073435
	speed: 0.0828s/iter; left time: 3012.4163s
	iters: 300, epoch: 23 | loss: 0.0040069
	speed: 0.0818s/iter; left time: 2968.8800s
	iters: 400, epoch: 23 | loss: 0.0030835
	speed: 0.0859s/iter; left time: 3107.7974s
Epoch: 23 cost time: 39.85520696640015
Epoch: 23, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
Validation loss decreased (-0.967123 --> -0.974270).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0034737
	speed: 0.3261s/iter; left time: 11744.3724s
	iters: 200, epoch: 24 | loss: 0.0067236
	speed: 0.0815s/iter; left time: 2928.1358s
	iters: 300, epoch: 24 | loss: 0.0156327
	speed: 0.0895s/iter; left time: 3204.9543s
	iters: 400, epoch: 24 | loss: 0.0162348
	speed: 0.0786s/iter; left time: 2806.7472s
Epoch: 24 cost time: 39.272629499435425
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0022422
	speed: 0.3194s/iter; left time: 11353.4390s
	iters: 200, epoch: 25 | loss: 0.0081075
	speed: 0.0849s/iter; left time: 3008.0651s
	iters: 300, epoch: 25 | loss: 0.0285745
	speed: 0.0926s/iter; left time: 3274.3628s
	iters: 400, epoch: 25 | loss: 0.0037221
	speed: 0.0954s/iter; left time: 3363.9975s
Epoch: 25 cost time: 42.01729345321655
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0238891
	speed: 0.3296s/iter; left time: 11559.6541s
	iters: 200, epoch: 26 | loss: 0.0149266
	speed: 0.0879s/iter; left time: 3076.1041s
	iters: 300, epoch: 26 | loss: 0.0928871
	speed: 0.0815s/iter; left time: 2843.2399s
	iters: 400, epoch: 26 | loss: 0.0105470
	speed: 0.0785s/iter; left time: 2730.2675s
Epoch: 26 cost time: 39.550666093826294
Epoch: 26, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0067167
	speed: 0.3368s/iter; left time: 11656.2300s
	iters: 200, epoch: 27 | loss: 0.1108936
	speed: 0.0871s/iter; left time: 3004.1166s
	iters: 300, epoch: 27 | loss: 0.0013323
	speed: 0.0882s/iter; left time: 3035.8704s
	iters: 400, epoch: 27 | loss: 0.0024800
	speed: 0.0848s/iter; left time: 2910.8782s
Epoch: 27 cost time: 40.71891188621521
Epoch: 27, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.310 Vali Acc: 0.946 Test Loss: 0.310 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0056272
	speed: 0.3175s/iter; left time: 10838.7034s
	iters: 200, epoch: 28 | loss: 0.0040821
	speed: 0.0787s/iter; left time: 2677.5426s
	iters: 300, epoch: 28 | loss: 0.1038218
	speed: 0.0742s/iter; left time: 2518.7077s
	iters: 400, epoch: 28 | loss: 0.0019647
	speed: 0.0815s/iter; left time: 2757.5175s
Epoch: 28 cost time: 38.06408381462097
Epoch: 28, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0177232
	speed: 0.3270s/iter; left time: 11008.9026s
	iters: 200, epoch: 29 | loss: 0.0017028
	speed: 0.0888s/iter; left time: 2979.3533s
	iters: 300, epoch: 29 | loss: 0.0019359
	speed: 0.0768s/iter; left time: 2570.3096s
	iters: 400, epoch: 29 | loss: 0.0008187
	speed: 0.0821s/iter; left time: 2740.1391s
Epoch: 29 cost time: 39.202348709106445
Epoch: 29, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1461623
	speed: 0.3201s/iter; left time: 10627.7471s
	iters: 200, epoch: 30 | loss: 0.0003484
	speed: 0.0768s/iter; left time: 2540.7794s
	iters: 300, epoch: 30 | loss: 0.0021966
	speed: 0.0880s/iter; left time: 2903.2231s
	iters: 400, epoch: 30 | loss: 0.0013103
	speed: 0.0810s/iter; left time: 2663.6695s
Epoch: 30 cost time: 38.9380156993866
Epoch: 30, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1620099
	speed: 0.3499s/iter; left time: 11451.5448s
	iters: 200, epoch: 31 | loss: 0.0100225
	speed: 0.0852s/iter; left time: 2781.2765s
	iters: 300, epoch: 31 | loss: 0.0188159
	speed: 0.0901s/iter; left time: 2931.4248s
	iters: 400, epoch: 31 | loss: 0.0058837
	speed: 0.0850s/iter; left time: 2755.0616s
Epoch: 31 cost time: 41.940489768981934
Epoch: 31, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.1000896
	speed: 0.3270s/iter; left time: 10548.6228s
	iters: 200, epoch: 32 | loss: 0.0075082
	speed: 0.0869s/iter; left time: 2796.0819s
	iters: 300, epoch: 32 | loss: 0.0021723
	speed: 0.0910s/iter; left time: 2918.3026s
	iters: 400, epoch: 32 | loss: 0.0006540
	speed: 0.0923s/iter; left time: 2949.2960s
Epoch: 32 cost time: 41.361079931259155
Epoch: 32, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0162669
	speed: 0.3291s/iter; left time: 10462.7348s
	iters: 200, epoch: 33 | loss: 0.0040773
	speed: 0.0874s/iter; left time: 2769.2742s
	iters: 300, epoch: 33 | loss: 0.0041183
	speed: 0.0791s/iter; left time: 2500.1344s
	iters: 400, epoch: 33 | loss: 0.0126127
	speed: 0.0787s/iter; left time: 2477.0758s
Epoch: 33 cost time: 38.92264795303345
Epoch: 33, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 1208326
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6809013
	speed: 0.1032s/iter; left time: 4830.3021s
	iters: 200, epoch: 1 | loss: 0.3048708
	speed: 0.0937s/iter; left time: 4378.0973s
	iters: 300, epoch: 1 | loss: 0.2599283
	speed: 0.0936s/iter; left time: 4359.7987s
	iters: 400, epoch: 1 | loss: 0.3463927
	speed: 0.0871s/iter; left time: 4050.8992s
Epoch: 1 cost time: 44.31109404563904
Epoch: 1, Steps: 469 | Train Loss: 0.628 Vali Loss: 0.250 Vali Acc: 0.916 Test Loss: 0.250 Test Acc: 0.916
Validation loss decreased (inf --> -0.915949).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0605787
	speed: 0.3209s/iter; left time: 14867.9062s
	iters: 200, epoch: 2 | loss: 0.1331167
	speed: 0.0853s/iter; left time: 3941.8689s
	iters: 300, epoch: 2 | loss: 0.1464219
	speed: 0.0861s/iter; left time: 3972.5526s
	iters: 400, epoch: 2 | loss: 0.1433813
	speed: 0.0826s/iter; left time: 3803.6380s
Epoch: 2 cost time: 39.951966762542725
Epoch: 2, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.368 Vali Acc: 0.878 Test Loss: 0.368 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0205347
	speed: 0.3362s/iter; left time: 15417.8508s
	iters: 200, epoch: 3 | loss: 0.3945593
	speed: 0.0907s/iter; left time: 4148.8922s
	iters: 300, epoch: 3 | loss: 0.1123548
	speed: 0.0854s/iter; left time: 3901.5535s
	iters: 400, epoch: 3 | loss: 0.0154387
	speed: 0.0827s/iter; left time: 3769.0856s
Epoch: 3 cost time: 41.18779897689819
Epoch: 3, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.221 Vali Acc: 0.936 Test Loss: 0.221 Test Acc: 0.936
Validation loss decreased (-0.915949 --> -0.936247).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2903758
	speed: 0.3375s/iter; left time: 15319.1323s
	iters: 200, epoch: 4 | loss: 0.2255068
	speed: 0.0861s/iter; left time: 3900.7706s
	iters: 300, epoch: 4 | loss: 0.0220110
	speed: 0.0842s/iter; left time: 3805.1456s
	iters: 400, epoch: 4 | loss: 0.0131707
	speed: 0.0818s/iter; left time: 3687.6191s
Epoch: 4 cost time: 39.441816568374634
Epoch: 4, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.241 Vali Acc: 0.929 Test Loss: 0.241 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1222331
	speed: 0.3162s/iter; left time: 14203.8907s
	iters: 200, epoch: 5 | loss: 0.0189083
	speed: 0.0750s/iter; left time: 3363.8150s
	iters: 300, epoch: 5 | loss: 0.4610777
	speed: 0.0817s/iter; left time: 3654.2310s
	iters: 400, epoch: 5 | loss: 0.0097112
	speed: 0.0884s/iter; left time: 3942.9608s
Epoch: 5 cost time: 38.371952056884766
Epoch: 5, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.255 Vali Acc: 0.927 Test Loss: 0.255 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1510454
	speed: 0.3421s/iter; left time: 15206.3341s
	iters: 200, epoch: 6 | loss: 0.0366057
	speed: 0.0813s/iter; left time: 3604.0603s
	iters: 300, epoch: 6 | loss: 0.7133533
	speed: 0.0799s/iter; left time: 3536.6797s
	iters: 400, epoch: 6 | loss: 0.3094422
	speed: 0.0843s/iter; left time: 3723.9129s
Epoch: 6 cost time: 40.21184492111206
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.308 Vali Acc: 0.923 Test Loss: 0.308 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0559314
	speed: 0.3258s/iter; left time: 14333.0111s
	iters: 200, epoch: 7 | loss: 0.1672026
	speed: 0.0981s/iter; left time: 4303.5429s
	iters: 300, epoch: 7 | loss: 0.0071490
	speed: 0.0852s/iter; left time: 3731.9075s
	iters: 400, epoch: 7 | loss: 0.0250638
	speed: 0.0875s/iter; left time: 3823.0172s
Epoch: 7 cost time: 42.69563913345337
Epoch: 7, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.936247 --> -0.953972).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0045842
	speed: 0.3376s/iter; left time: 14693.7982s
	iters: 200, epoch: 8 | loss: 0.1782523
	speed: 0.0748s/iter; left time: 3247.5278s
	iters: 300, epoch: 8 | loss: 0.0056574
	speed: 0.0834s/iter; left time: 3614.4796s
	iters: 400, epoch: 8 | loss: 0.1921331
	speed: 0.0879s/iter; left time: 3797.0393s
Epoch: 8 cost time: 40.17625141143799
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0131651
	speed: 0.3312s/iter; left time: 14256.0559s
	iters: 200, epoch: 9 | loss: 0.0417988
	speed: 0.0824s/iter; left time: 3538.7747s
	iters: 300, epoch: 9 | loss: 0.3188013
	speed: 0.0839s/iter; left time: 3597.0291s
	iters: 400, epoch: 9 | loss: 0.0134338
	speed: 0.0830s/iter; left time: 3547.1685s
Epoch: 9 cost time: 39.6641366481781
Epoch: 9, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.953972 --> -0.967123).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4151253
	speed: 0.3165s/iter; left time: 13477.7145s
	iters: 200, epoch: 10 | loss: 0.0460697
	speed: 0.0828s/iter; left time: 3518.9509s
	iters: 300, epoch: 10 | loss: 0.5467016
	speed: 0.0868s/iter; left time: 3676.8314s
	iters: 400, epoch: 10 | loss: 0.0070845
	speed: 0.0834s/iter; left time: 3527.0633s
Epoch: 10 cost time: 39.24545335769653
Epoch: 10, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1589657
	speed: 0.3315s/iter; left time: 13958.5217s
	iters: 200, epoch: 11 | loss: 0.0068967
	speed: 0.0794s/iter; left time: 3336.2402s
	iters: 300, epoch: 11 | loss: 0.0141804
	speed: 0.0819s/iter; left time: 3432.7877s
	iters: 400, epoch: 11 | loss: 0.3122372
	speed: 0.0818s/iter; left time: 3421.0660s
Epoch: 11 cost time: 39.2697639465332
Epoch: 11, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0051814
	speed: 0.3269s/iter; left time: 13614.1784s
	iters: 200, epoch: 12 | loss: 0.0120144
	speed: 0.0873s/iter; left time: 3625.1075s
	iters: 300, epoch: 12 | loss: 0.1128732
	speed: 0.0834s/iter; left time: 3455.6994s
	iters: 400, epoch: 12 | loss: 0.0198160
	speed: 0.0817s/iter; left time: 3376.1356s
Epoch: 12 cost time: 40.53310465812683
Epoch: 12, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0505687
	speed: 0.3243s/iter; left time: 13352.2116s
	iters: 200, epoch: 13 | loss: 0.0065453
	speed: 0.0805s/iter; left time: 3308.3497s
	iters: 300, epoch: 13 | loss: 0.0172441
	speed: 0.0848s/iter; left time: 3472.8388s
	iters: 400, epoch: 13 | loss: 0.4700499
	speed: 0.0830s/iter; left time: 3394.0822s
Epoch: 13 cost time: 39.504154443740845
Epoch: 13, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0194335
	speed: 0.3398s/iter; left time: 13829.1919s
	iters: 200, epoch: 14 | loss: 0.0019049
	speed: 0.0818s/iter; left time: 3322.4492s
	iters: 300, epoch: 14 | loss: 0.2383537
	speed: 0.0894s/iter; left time: 3621.5881s
	iters: 400, epoch: 14 | loss: 0.0026727
	speed: 0.0860s/iter; left time: 3476.7230s
Epoch: 14 cost time: 41.25051736831665
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.942 Test Loss: 0.274 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0037113
	speed: 0.3238s/iter; left time: 13026.8501s
	iters: 200, epoch: 15 | loss: 0.0019351
	speed: 0.0865s/iter; left time: 3472.5429s
	iters: 300, epoch: 15 | loss: 0.0094574
	speed: 0.0828s/iter; left time: 3315.8721s
	iters: 400, epoch: 15 | loss: 0.0027911
	speed: 0.0801s/iter; left time: 3198.8903s
Epoch: 15 cost time: 39.68346357345581
Epoch: 15, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.967123 --> -0.971697).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0198254
	speed: 0.3240s/iter; left time: 12882.9291s
	iters: 200, epoch: 16 | loss: 0.0017697
	speed: 0.0812s/iter; left time: 3221.7698s
	iters: 300, epoch: 16 | loss: 0.0028597
	speed: 0.0872s/iter; left time: 3452.1128s
	iters: 400, epoch: 16 | loss: 0.0047466
	speed: 0.0792s/iter; left time: 3125.9503s
Epoch: 16 cost time: 38.99948263168335
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0947496
	speed: 0.3163s/iter; left time: 12429.5652s
	iters: 200, epoch: 17 | loss: 0.0026568
	speed: 0.0809s/iter; left time: 3170.0454s
	iters: 300, epoch: 17 | loss: 0.0008450
	speed: 0.0853s/iter; left time: 3334.3426s
	iters: 400, epoch: 17 | loss: 0.0034658
	speed: 0.0883s/iter; left time: 3443.9112s
Epoch: 17 cost time: 41.41293263435364
Epoch: 17, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0013886
	speed: 0.3304s/iter; left time: 12828.7799s
	iters: 200, epoch: 18 | loss: 0.0039254
	speed: 0.0846s/iter; left time: 3276.9181s
	iters: 300, epoch: 18 | loss: 0.0055396
	speed: 0.0826s/iter; left time: 3189.7162s
	iters: 400, epoch: 18 | loss: 0.0919751
	speed: 0.0791s/iter; left time: 3046.1676s
Epoch: 18 cost time: 39.169553995132446
Epoch: 18, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0322893
	speed: 0.3367s/iter; left time: 12916.1350s
	iters: 200, epoch: 19 | loss: 0.3231561
	speed: 0.0811s/iter; left time: 3103.3393s
	iters: 300, epoch: 19 | loss: 0.0472165
	speed: 0.0779s/iter; left time: 2971.3251s
	iters: 400, epoch: 19 | loss: 0.2204768
	speed: 0.0822s/iter; left time: 3128.1566s
Epoch: 19 cost time: 38.83442783355713
Epoch: 19, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0009658
	speed: 0.3210s/iter; left time: 12163.2770s
	iters: 200, epoch: 20 | loss: 0.0261420
	speed: 0.0796s/iter; left time: 3006.9271s
	iters: 300, epoch: 20 | loss: 0.0069368
	speed: 0.0795s/iter; left time: 2997.9572s
	iters: 400, epoch: 20 | loss: 0.0036817
	speed: 0.0871s/iter; left time: 3273.8722s
Epoch: 20 cost time: 38.58594012260437
Epoch: 20, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0031515
	speed: 0.3125s/iter; left time: 11693.4656s
	iters: 200, epoch: 21 | loss: 0.0064378
	speed: 0.0808s/iter; left time: 3013.8719s
	iters: 300, epoch: 21 | loss: 0.0012841
	speed: 0.0792s/iter; left time: 2949.2240s
	iters: 400, epoch: 21 | loss: 0.0302521
	speed: 0.0800s/iter; left time: 2968.5458s
Epoch: 21 cost time: 38.25656771659851
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5044664
	speed: 0.3513s/iter; left time: 12981.8144s
	iters: 200, epoch: 22 | loss: 0.0319497
	speed: 0.0988s/iter; left time: 3642.5887s
	iters: 300, epoch: 22 | loss: 0.0019059
	speed: 0.0989s/iter; left time: 3633.9387s
	iters: 400, epoch: 22 | loss: 0.0034695
	speed: 0.0941s/iter; left time: 3449.0535s
Epoch: 22 cost time: 47.00103282928467
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1415406
	speed: 0.3579s/iter; left time: 13057.7247s
	iters: 200, epoch: 23 | loss: 0.0033949
	speed: 0.0877s/iter; left time: 3191.1492s
	iters: 300, epoch: 23 | loss: 0.0480385
	speed: 0.0843s/iter; left time: 3058.7036s
	iters: 400, epoch: 23 | loss: 0.0030482
	speed: 0.0856s/iter; left time: 3098.4175s
Epoch: 23 cost time: 41.16355562210083
Epoch: 23, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.305 Vali Acc: 0.936 Test Loss: 0.305 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.3092524
	speed: 0.3550s/iter; left time: 12786.2761s
	iters: 200, epoch: 24 | loss: 0.0127667
	speed: 0.0800s/iter; left time: 2873.5511s
	iters: 300, epoch: 24 | loss: 0.0113585
	speed: 0.0914s/iter; left time: 3274.1370s
	iters: 400, epoch: 24 | loss: 0.0629798
	speed: 0.0875s/iter; left time: 3123.2268s
Epoch: 24 cost time: 40.710548877716064
Epoch: 24, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0093800
	speed: 0.3214s/iter; left time: 11424.3948s
	iters: 200, epoch: 25 | loss: 0.0017713
	speed: 0.0869s/iter; left time: 3079.5615s
	iters: 300, epoch: 25 | loss: 0.3637450
	speed: 0.0959s/iter; left time: 3390.9838s
	iters: 400, epoch: 25 | loss: 0.0084004
	speed: 0.0886s/iter; left time: 3124.0847s
Epoch: 25 cost time: 41.4369330406189
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.195 Vali Acc: 0.961 Test Loss: 0.195 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9716981132075472
model parameter : 1208070
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0541943
	speed: 0.0998s/iter; left time: 4670.4018s
	iters: 200, epoch: 1 | loss: 0.5144426
	speed: 0.0803s/iter; left time: 3748.8406s
	iters: 300, epoch: 1 | loss: 0.4072003
	speed: 0.0891s/iter; left time: 4150.1300s
	iters: 400, epoch: 1 | loss: 0.2588409
	speed: 0.0903s/iter; left time: 4197.2314s
Epoch: 1 cost time: 42.06084227561951
Epoch: 1, Steps: 469 | Train Loss: 0.620 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (inf --> -0.902513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0889076
	speed: 0.3477s/iter; left time: 16109.0948s
	iters: 200, epoch: 2 | loss: 0.6159636
	speed: 0.0862s/iter; left time: 3984.6606s
	iters: 300, epoch: 2 | loss: 0.0235116
	speed: 0.0803s/iter; left time: 3704.4131s
	iters: 400, epoch: 2 | loss: 0.0722716
	speed: 0.0944s/iter; left time: 4343.2583s
Epoch: 2 cost time: 41.57344198226929
Epoch: 2, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.281 Vali Acc: 0.901 Test Loss: 0.281 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0196427
	speed: 0.3351s/iter; left time: 15368.8037s
	iters: 200, epoch: 3 | loss: 0.0131413
	speed: 0.0951s/iter; left time: 4352.1967s
	iters: 300, epoch: 3 | loss: 0.4313941
	speed: 0.0876s/iter; left time: 3998.3775s
	iters: 400, epoch: 3 | loss: 0.0801147
	speed: 0.0838s/iter; left time: 3819.2307s
Epoch: 3 cost time: 41.72205591201782
Epoch: 3, Steps: 469 | Train Loss: 0.172 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
Validation loss decreased (-0.902513 --> -0.937962).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2464112
	speed: 0.3054s/iter; left time: 13862.3792s
	iters: 200, epoch: 4 | loss: 0.2140989
	speed: 0.0788s/iter; left time: 3569.2759s
	iters: 300, epoch: 4 | loss: 0.1298684
	speed: 0.0798s/iter; left time: 3604.7003s
	iters: 400, epoch: 4 | loss: 0.1687647
	speed: 0.0748s/iter; left time: 3371.7506s
Epoch: 4 cost time: 37.33450365066528
Epoch: 4, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.937962 --> -0.966551).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0627410
	speed: 0.3361s/iter; left time: 15099.9571s
	iters: 200, epoch: 5 | loss: 0.3158310
	speed: 0.0756s/iter; left time: 3387.7076s
	iters: 300, epoch: 5 | loss: 0.5051766
	speed: 0.0900s/iter; left time: 4023.2292s
	iters: 400, epoch: 5 | loss: 0.1008292
	speed: 0.0851s/iter; left time: 3796.3953s
Epoch: 5 cost time: 40.003288984298706
Epoch: 5, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0910780
	speed: 0.3210s/iter; left time: 14268.8905s
	iters: 200, epoch: 6 | loss: 0.0260256
	speed: 0.0886s/iter; left time: 3929.2382s
	iters: 300, epoch: 6 | loss: 0.3663369
	speed: 0.0869s/iter; left time: 3846.0797s
	iters: 400, epoch: 6 | loss: 0.0412109
	speed: 0.0843s/iter; left time: 3721.5282s
Epoch: 6 cost time: 40.968804359436035
Epoch: 6, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0351843
	speed: 0.3530s/iter; left time: 15527.8680s
	iters: 200, epoch: 7 | loss: 0.2117236
	speed: 0.0905s/iter; left time: 3972.4213s
	iters: 300, epoch: 7 | loss: 0.1101261
	speed: 0.0904s/iter; left time: 3957.2382s
	iters: 400, epoch: 7 | loss: 0.0657085
	speed: 0.0967s/iter; left time: 4224.3334s
Epoch: 7 cost time: 44.06004786491394
Epoch: 7, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0361708
	speed: 0.3491s/iter; left time: 15191.6463s
	iters: 200, epoch: 8 | loss: 0.0262127
	speed: 0.0813s/iter; left time: 3529.3352s
	iters: 300, epoch: 8 | loss: 0.5284364
	speed: 0.0801s/iter; left time: 3468.4187s
	iters: 400, epoch: 8 | loss: 0.2125485
	speed: 0.0888s/iter; left time: 3838.3316s
Epoch: 8 cost time: 40.52494788169861
Epoch: 8, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0754279
	speed: 0.3395s/iter; left time: 14615.3790s
	iters: 200, epoch: 9 | loss: 0.0073999
	speed: 0.0936s/iter; left time: 4020.4541s
	iters: 300, epoch: 9 | loss: 0.1921426
	speed: 0.0949s/iter; left time: 4067.9693s
	iters: 400, epoch: 9 | loss: 0.0148874
	speed: 0.0894s/iter; left time: 3820.4164s
Epoch: 9 cost time: 43.134186029434204
Epoch: 9, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.242 Vali Acc: 0.947 Test Loss: 0.242 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1123623
	speed: 0.3236s/iter; left time: 13778.1685s
	iters: 200, epoch: 10 | loss: 0.1347640
	speed: 0.1075s/iter; left time: 4566.4902s
	iters: 300, epoch: 10 | loss: 0.0672765
	speed: 0.0857s/iter; left time: 3629.9144s
	iters: 400, epoch: 10 | loss: 0.0021821
	speed: 0.0941s/iter; left time: 3976.6905s
Epoch: 10 cost time: 43.74782347679138
Epoch: 10, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1278590
	speed: 0.3673s/iter; left time: 15468.5282s
	iters: 200, epoch: 11 | loss: 0.3753622
	speed: 0.0943s/iter; left time: 3961.5486s
	iters: 300, epoch: 11 | loss: 0.0064935
	speed: 0.0961s/iter; left time: 4025.8049s
	iters: 400, epoch: 11 | loss: 0.1795964
	speed: 0.0864s/iter; left time: 3612.1908s
Epoch: 11 cost time: 44.03361916542053
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.932 Test Loss: 0.266 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0058685
	speed: 0.3602s/iter; left time: 14997.9454s
	iters: 200, epoch: 12 | loss: 0.0040755
	speed: 0.0883s/iter; left time: 3668.9846s
	iters: 300, epoch: 12 | loss: 0.5331171
	speed: 0.0902s/iter; left time: 3739.7804s
	iters: 400, epoch: 12 | loss: 0.0194308
	speed: 0.0972s/iter; left time: 4016.7609s
Epoch: 12 cost time: 43.56931281089783
Epoch: 12, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0316377
	speed: 0.3373s/iter; left time: 13886.5211s
	iters: 200, epoch: 13 | loss: 0.0008738
	speed: 0.0845s/iter; left time: 3469.5979s
	iters: 300, epoch: 13 | loss: 0.0895181
	speed: 0.0944s/iter; left time: 3866.5320s
	iters: 400, epoch: 13 | loss: 0.0016394
	speed: 0.0914s/iter; left time: 3735.4107s
Epoch: 13 cost time: 42.175543546676636
Epoch: 13, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0966888
	speed: 0.3423s/iter; left time: 13933.5392s
	iters: 200, epoch: 14 | loss: 0.0050660
	speed: 0.0949s/iter; left time: 3852.2488s
	iters: 300, epoch: 14 | loss: 0.0018116
	speed: 0.0890s/iter; left time: 3604.9768s
	iters: 400, epoch: 14 | loss: 0.0068126
	speed: 0.0831s/iter; left time: 3356.0684s
Epoch: 14 cost time: 41.423179626464844
Epoch: 14, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9665523156089194
model parameter : 1207814
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8698888
	speed: 0.1034s/iter; left time: 4837.4529s
	iters: 200, epoch: 1 | loss: 0.8727509
	speed: 0.0876s/iter; left time: 4091.2963s
	iters: 300, epoch: 1 | loss: 0.1336243
	speed: 0.0922s/iter; left time: 4298.3319s
	iters: 400, epoch: 1 | loss: 0.0702500
	speed: 0.0935s/iter; left time: 4346.2943s
Epoch: 1 cost time: 43.51399779319763
Epoch: 1, Steps: 469 | Train Loss: 0.585 Vali Loss: 0.299 Vali Acc: 0.898 Test Loss: 0.299 Test Acc: 0.898
Validation loss decreased (inf --> -0.897939).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0758504
	speed: 0.3232s/iter; left time: 14975.8318s
	iters: 200, epoch: 2 | loss: 0.2719262
	speed: 0.0874s/iter; left time: 4039.9058s
	iters: 300, epoch: 2 | loss: 0.0617382
	speed: 0.0907s/iter; left time: 4186.4367s
	iters: 400, epoch: 2 | loss: 0.1883475
	speed: 0.0879s/iter; left time: 4048.1038s
Epoch: 2 cost time: 41.73517203330994
Epoch: 2, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
Validation loss decreased (-0.897939 --> -0.918808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2171425
	speed: 0.3559s/iter; left time: 16322.6012s
	iters: 200, epoch: 3 | loss: 0.0925488
	speed: 0.0922s/iter; left time: 4221.3491s
	iters: 300, epoch: 3 | loss: 0.0481100
	speed: 0.0798s/iter; left time: 3644.3303s
	iters: 400, epoch: 3 | loss: 0.0357943
	speed: 0.0813s/iter; left time: 3703.2569s
Epoch: 3 cost time: 40.124645709991455
Epoch: 3, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.268 Vali Acc: 0.929 Test Loss: 0.268 Test Acc: 0.929
Validation loss decreased (-0.918808 --> -0.929386).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0848985
	speed: 0.3449s/iter; left time: 15658.5267s
	iters: 200, epoch: 4 | loss: 0.0353782
	speed: 0.0817s/iter; left time: 3700.6281s
	iters: 300, epoch: 4 | loss: 0.0593999
	speed: 0.0875s/iter; left time: 3954.7941s
	iters: 400, epoch: 4 | loss: 0.0743513
	speed: 0.0936s/iter; left time: 4219.4076s
Epoch: 4 cost time: 41.91214990615845
Epoch: 4, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.248 Vali Acc: 0.934 Test Loss: 0.248 Test Acc: 0.934
Validation loss decreased (-0.929386 --> -0.933960).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0477346
	speed: 0.3315s/iter; left time: 14893.9179s
	iters: 200, epoch: 5 | loss: 0.0110354
	speed: 0.0807s/iter; left time: 3618.4383s
	iters: 300, epoch: 5 | loss: 0.7648719
	speed: 0.0830s/iter; left time: 3712.9107s
	iters: 400, epoch: 5 | loss: 0.0535571
	speed: 0.0888s/iter; left time: 3962.8677s
Epoch: 5 cost time: 39.258610010147095
Epoch: 5, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.933960 --> -0.955973).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0199669
	speed: 0.3612s/iter; left time: 16059.6670s
	iters: 200, epoch: 6 | loss: 0.1639392
	speed: 0.0926s/iter; left time: 4108.3210s
	iters: 300, epoch: 6 | loss: 0.2292483
	speed: 0.1018s/iter; left time: 4506.6238s
	iters: 400, epoch: 6 | loss: 0.1013449
	speed: 0.0944s/iter; left time: 4167.3782s
Epoch: 6 cost time: 45.2241051197052
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0108456
	speed: 0.3376s/iter; left time: 14851.6695s
	iters: 200, epoch: 7 | loss: 0.0573246
	speed: 0.0895s/iter; left time: 3928.5030s
	iters: 300, epoch: 7 | loss: 0.0982589
	speed: 0.0933s/iter; left time: 4083.7714s
	iters: 400, epoch: 7 | loss: 0.1402559
	speed: 0.0891s/iter; left time: 3890.4341s
Epoch: 7 cost time: 42.58635592460632
Epoch: 7, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8726373
	speed: 0.3654s/iter; left time: 15899.7994s
	iters: 200, epoch: 8 | loss: 0.3392157
	speed: 0.0844s/iter; left time: 3666.6240s
	iters: 300, epoch: 8 | loss: 0.1238306
	speed: 0.0807s/iter; left time: 3493.9744s
	iters: 400, epoch: 8 | loss: 0.0747363
	speed: 0.0828s/iter; left time: 3578.9710s
Epoch: 8 cost time: 41.04072451591492
Epoch: 8, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0088455
	speed: 0.3411s/iter; left time: 14682.1194s
	iters: 200, epoch: 9 | loss: 0.1422835
	speed: 0.0971s/iter; left time: 4169.7180s
	iters: 300, epoch: 9 | loss: 0.0210624
	speed: 0.0897s/iter; left time: 3844.6186s
	iters: 400, epoch: 9 | loss: 0.0059068
	speed: 0.0858s/iter; left time: 3669.4903s
Epoch: 9 cost time: 41.70787477493286
Epoch: 9, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0099493
	speed: 0.3403s/iter; left time: 14490.2712s
	iters: 200, epoch: 10 | loss: 0.0104778
	speed: 0.0830s/iter; left time: 3524.4712s
	iters: 300, epoch: 10 | loss: 0.0956008
	speed: 0.0873s/iter; left time: 3699.2913s
	iters: 400, epoch: 10 | loss: 0.0024046
	speed: 0.0954s/iter; left time: 4034.4534s
Epoch: 10 cost time: 42.03783702850342
Epoch: 10, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.283 Vali Acc: 0.945 Test Loss: 0.283 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0343197
	speed: 0.3632s/iter; left time: 15295.8487s
	iters: 200, epoch: 11 | loss: 0.0039225
	speed: 0.1011s/iter; left time: 4248.0603s
	iters: 300, epoch: 11 | loss: 0.0543765
	speed: 0.0899s/iter; left time: 3766.7821s
	iters: 400, epoch: 11 | loss: 0.0923361
	speed: 0.0881s/iter; left time: 3683.9154s
Epoch: 11 cost time: 44.20812225341797
Epoch: 11, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0149040
	speed: 0.3629s/iter; left time: 15111.4518s
	iters: 200, epoch: 12 | loss: 0.0720676
	speed: 0.0925s/iter; left time: 3843.9573s
	iters: 300, epoch: 12 | loss: 0.0046350
	speed: 0.1059s/iter; left time: 4388.3868s
	iters: 400, epoch: 12 | loss: 0.1642932
	speed: 0.0941s/iter; left time: 3891.6103s
Epoch: 12 cost time: 45.4661078453064
Epoch: 12, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0032426
	speed: 0.3362s/iter; left time: 13841.9600s
	iters: 200, epoch: 13 | loss: 0.4539912
	speed: 0.0814s/iter; left time: 3342.1145s
	iters: 300, epoch: 13 | loss: 0.0080819
	speed: 0.0882s/iter; left time: 3611.8279s
	iters: 400, epoch: 13 | loss: 0.0309667
	speed: 0.0771s/iter; left time: 3153.2979s
Epoch: 13 cost time: 38.846845626831055
Epoch: 13, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.226 Vali Acc: 0.934 Test Loss: 0.226 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0050983
	speed: 0.3340s/iter; left time: 13595.2507s
	iters: 200, epoch: 14 | loss: 0.0121838
	speed: 0.0906s/iter; left time: 3679.5260s
	iters: 300, epoch: 14 | loss: 0.0039036
	speed: 0.0868s/iter; left time: 3515.5788s
	iters: 400, epoch: 14 | loss: 0.0077554
	speed: 0.0840s/iter; left time: 3392.5648s
Epoch: 14 cost time: 41.385714292526245
Epoch: 14, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2556801
	speed: 0.3098s/iter; left time: 12463.8570s
	iters: 200, epoch: 15 | loss: 0.0021044
	speed: 0.0832s/iter; left time: 3337.3116s
	iters: 300, epoch: 15 | loss: 0.1004619
	speed: 0.0823s/iter; left time: 3293.9416s
	iters: 400, epoch: 15 | loss: 0.1782378
	speed: 0.0869s/iter; left time: 3469.7959s
Epoch: 15 cost time: 40.733513832092285
Epoch: 15, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
Validation loss decreased (-0.955973 --> -0.967694).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1087669
	speed: 0.3666s/iter; left time: 14580.0593s
	iters: 200, epoch: 16 | loss: 0.0102535
	speed: 0.0893s/iter; left time: 3543.3685s
	iters: 300, epoch: 16 | loss: 0.0984150
	speed: 0.0840s/iter; left time: 3321.9473s
	iters: 400, epoch: 16 | loss: 0.0879925
	speed: 0.0884s/iter; left time: 3487.0106s
Epoch: 16 cost time: 41.401891469955444
Epoch: 16, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0323510
	speed: 0.3657s/iter; left time: 14372.1467s
	iters: 200, epoch: 17 | loss: 0.0022509
	speed: 0.0932s/iter; left time: 3652.2637s
	iters: 300, epoch: 17 | loss: 0.0008703
	speed: 0.0877s/iter; left time: 3428.6797s
	iters: 400, epoch: 17 | loss: 0.0935348
	speed: 0.0972s/iter; left time: 3791.7002s
Epoch: 17 cost time: 44.378490686416626
Epoch: 17, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.967694 --> -0.973126).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0168170
	speed: 0.3369s/iter; left time: 13082.4542s
	iters: 200, epoch: 18 | loss: 0.0154224
	speed: 0.0801s/iter; left time: 3101.1800s
	iters: 300, epoch: 18 | loss: 0.2017223
	speed: 0.0860s/iter; left time: 3322.1840s
	iters: 400, epoch: 18 | loss: 0.0040045
	speed: 0.0840s/iter; left time: 3234.7645s
Epoch: 18 cost time: 39.3294837474823
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1295213
	speed: 0.3494s/iter; left time: 13402.2118s
	iters: 200, epoch: 19 | loss: 0.0115102
	speed: 0.0992s/iter; left time: 3795.4048s
	iters: 300, epoch: 19 | loss: 0.0491597
	speed: 0.0868s/iter; left time: 3313.1819s
	iters: 400, epoch: 19 | loss: 0.0033117
	speed: 0.0837s/iter; left time: 3183.9008s
Epoch: 19 cost time: 42.42755746841431
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0139910
	speed: 0.3149s/iter; left time: 11931.3771s
	iters: 200, epoch: 20 | loss: 0.0053206
	speed: 0.0854s/iter; left time: 3226.3185s
	iters: 300, epoch: 20 | loss: 0.0040273
	speed: 0.0887s/iter; left time: 3344.4975s
	iters: 400, epoch: 20 | loss: 0.0027579
	speed: 0.0937s/iter; left time: 3521.7050s
Epoch: 20 cost time: 41.37389135360718
Epoch: 20, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.206 Vali Acc: 0.955 Test Loss: 0.206 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0173963
	speed: 0.3378s/iter; left time: 12639.9983s
	iters: 200, epoch: 21 | loss: 0.0092583
	speed: 0.0923s/iter; left time: 3445.8412s
	iters: 300, epoch: 21 | loss: 0.1259086
	speed: 0.0847s/iter; left time: 3150.9070s
	iters: 400, epoch: 21 | loss: 0.0042627
	speed: 0.0831s/iter; left time: 3082.9863s
Epoch: 21 cost time: 40.46535396575928
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.5932710
	speed: 0.3345s/iter; left time: 12362.2488s
	iters: 200, epoch: 22 | loss: 0.0400084
	speed: 0.0918s/iter; left time: 3383.4856s
	iters: 300, epoch: 22 | loss: 0.0043445
	speed: 0.0873s/iter; left time: 3208.7792s
	iters: 400, epoch: 22 | loss: 0.4495066
	speed: 0.0847s/iter; left time: 3102.9494s
Epoch: 22 cost time: 41.632850646972656
Epoch: 22, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0169302
	speed: 0.3217s/iter; left time: 11735.9776s
	iters: 200, epoch: 23 | loss: 0.0018142
	speed: 0.0773s/iter; left time: 2812.7017s
	iters: 300, epoch: 23 | loss: 0.0026285
	speed: 0.0786s/iter; left time: 2850.0951s
	iters: 400, epoch: 23 | loss: 0.3755795
	speed: 0.0811s/iter; left time: 2935.3103s
Epoch: 23 cost time: 38.40080809593201
Epoch: 23, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.4309933
	speed: 0.3445s/iter; left time: 12406.1840s
	iters: 200, epoch: 24 | loss: 0.0012297
	speed: 0.0800s/iter; left time: 2871.9571s
	iters: 300, epoch: 24 | loss: 0.0134419
	speed: 0.0890s/iter; left time: 3186.6641s
	iters: 400, epoch: 24 | loss: 0.0012243
	speed: 0.0829s/iter; left time: 2962.2472s
Epoch: 24 cost time: 39.95956230163574
Epoch: 24, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1045353
	speed: 0.3290s/iter; left time: 11694.1979s
	iters: 200, epoch: 25 | loss: 0.0077956
	speed: 0.0804s/iter; left time: 2848.1397s
	iters: 300, epoch: 25 | loss: 0.3690339
	speed: 0.0946s/iter; left time: 3342.1958s
	iters: 400, epoch: 25 | loss: 0.0064109
	speed: 0.0870s/iter; left time: 3067.3657s
Epoch: 25 cost time: 42.13709616661072
Epoch: 25, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0552903
	speed: 0.3521s/iter; left time: 12349.4864s
	iters: 200, epoch: 26 | loss: 0.0029508
	speed: 0.0847s/iter; left time: 2961.4932s
	iters: 300, epoch: 26 | loss: 0.2253304
	speed: 0.0912s/iter; left time: 3181.9790s
	iters: 400, epoch: 26 | loss: 0.1293254
	speed: 0.0828s/iter; left time: 2879.0471s
Epoch: 26 cost time: 41.18832445144653
Epoch: 26, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0104439
	speed: 0.3456s/iter; left time: 11960.8082s
	iters: 200, epoch: 27 | loss: 0.0033214
	speed: 0.0873s/iter; left time: 3011.7971s
	iters: 300, epoch: 27 | loss: 0.1535388
	speed: 0.0874s/iter; left time: 3007.8312s
	iters: 400, epoch: 27 | loss: 0.0259844
	speed: 0.0872s/iter; left time: 2992.2447s
Epoch: 27 cost time: 41.621695041656494
Epoch: 27, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.247 Vali Acc: 0.947 Test Loss: 0.247 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 1207558
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9210429
	speed: 0.0956s/iter; left time: 4472.2569s
	iters: 200, epoch: 1 | loss: 0.3618347
	speed: 0.0790s/iter; left time: 3690.1198s
	iters: 300, epoch: 1 | loss: 0.2717090
	speed: 0.0877s/iter; left time: 4087.6813s
	iters: 400, epoch: 1 | loss: 0.2400265
	speed: 0.0866s/iter; left time: 4028.0640s
Epoch: 1 cost time: 41.06184434890747
Epoch: 1, Steps: 469 | Train Loss: 0.660 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (inf --> -0.900226).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4104811
	speed: 0.3203s/iter; left time: 14839.6678s
	iters: 200, epoch: 2 | loss: 0.0496730
	speed: 0.0904s/iter; left time: 4180.1629s
	iters: 300, epoch: 2 | loss: 0.1324531
	speed: 0.0890s/iter; left time: 4104.3339s
	iters: 400, epoch: 2 | loss: 0.0240875
	speed: 0.0848s/iter; left time: 3901.9834s
Epoch: 2 cost time: 41.15217185020447
Epoch: 2, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.390 Vali Acc: 0.887 Test Loss: 0.390 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2064867
	speed: 0.3320s/iter; left time: 15228.6548s
	iters: 200, epoch: 3 | loss: 0.1950916
	speed: 0.0897s/iter; left time: 4107.1182s
	iters: 300, epoch: 3 | loss: 0.0825469
	speed: 0.0990s/iter; left time: 4521.1581s
	iters: 400, epoch: 3 | loss: 0.0749428
	speed: 0.0900s/iter; left time: 4098.5428s
Epoch: 3 cost time: 43.09423494338989
Epoch: 3, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.225 Vali Acc: 0.934 Test Loss: 0.225 Test Acc: 0.934
Validation loss decreased (-0.900226 --> -0.933674).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0220014
	speed: 0.3568s/iter; left time: 16198.2182s
	iters: 200, epoch: 4 | loss: 0.1179819
	speed: 0.0871s/iter; left time: 3946.2636s
	iters: 300, epoch: 4 | loss: 0.2309201
	speed: 0.0874s/iter; left time: 3950.4854s
	iters: 400, epoch: 4 | loss: 0.2604578
	speed: 0.0869s/iter; left time: 3917.9406s
Epoch: 4 cost time: 42.65285873413086
Epoch: 4, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0540543
	speed: 0.3263s/iter; left time: 14659.9403s
	iters: 200, epoch: 5 | loss: 0.1506814
	speed: 0.0936s/iter; left time: 4195.4759s
	iters: 300, epoch: 5 | loss: 0.3095558
	speed: 0.0820s/iter; left time: 3666.3696s
	iters: 400, epoch: 5 | loss: 0.0143507
	speed: 0.0897s/iter; left time: 4001.7635s
Epoch: 5 cost time: 40.64832901954651
Epoch: 5, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
Validation loss decreased (-0.933674 --> -0.941964).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0387036
	speed: 0.3358s/iter; left time: 14927.5354s
	iters: 200, epoch: 6 | loss: 0.0692517
	speed: 0.0847s/iter; left time: 3756.3902s
	iters: 300, epoch: 6 | loss: 0.0106954
	speed: 0.0841s/iter; left time: 3721.4198s
	iters: 400, epoch: 6 | loss: 0.0123929
	speed: 0.0845s/iter; left time: 3730.5814s
Epoch: 6 cost time: 39.77621674537659
Epoch: 6, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0313537
	speed: 0.3435s/iter; left time: 15111.2239s
	iters: 200, epoch: 7 | loss: 0.1837350
	speed: 0.1055s/iter; left time: 4632.1467s
	iters: 300, epoch: 7 | loss: 0.2421445
	speed: 0.0980s/iter; left time: 4291.9957s
	iters: 400, epoch: 7 | loss: 0.0071314
	speed: 0.0982s/iter; left time: 4288.8280s
Epoch: 7 cost time: 46.706881284713745
Epoch: 7, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0090875
	speed: 0.3684s/iter; left time: 16033.1165s
	iters: 200, epoch: 8 | loss: 0.0510591
	speed: 0.0888s/iter; left time: 3854.7195s
	iters: 300, epoch: 8 | loss: 0.2655428
	speed: 0.1060s/iter; left time: 4590.2954s
	iters: 400, epoch: 8 | loss: 0.3827947
	speed: 0.0861s/iter; left time: 3719.1728s
Epoch: 8 cost time: 44.96749567985535
Epoch: 8, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.941964 --> -0.951970).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0401767
	speed: 0.3772s/iter; left time: 16236.1132s
	iters: 200, epoch: 9 | loss: 0.1784004
	speed: 0.1002s/iter; left time: 4303.7196s
	iters: 300, epoch: 9 | loss: 0.0335846
	speed: 0.0861s/iter; left time: 3687.2355s
	iters: 400, epoch: 9 | loss: 0.0639880
	speed: 0.0921s/iter; left time: 3936.9481s
Epoch: 9 cost time: 43.94512987136841
Epoch: 9, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.242 Vali Acc: 0.921 Test Loss: 0.242 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1326171
	speed: 0.3549s/iter; left time: 15109.8481s
	iters: 200, epoch: 10 | loss: 0.0446571
	speed: 0.0914s/iter; left time: 3881.9064s
	iters: 300, epoch: 10 | loss: 0.0083134
	speed: 0.0858s/iter; left time: 3634.7751s
	iters: 400, epoch: 10 | loss: 0.0066392
	speed: 0.0971s/iter; left time: 4104.9075s
Epoch: 10 cost time: 43.965670108795166
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0015088
	speed: 0.3578s/iter; left time: 15066.8748s
	iters: 200, epoch: 11 | loss: 0.0567560
	speed: 0.0820s/iter; left time: 3446.5568s
	iters: 300, epoch: 11 | loss: 0.0049349
	speed: 0.0877s/iter; left time: 3674.5303s
	iters: 400, epoch: 11 | loss: 0.0478794
	speed: 0.0966s/iter; left time: 4036.9738s
Epoch: 11 cost time: 42.34834933280945
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.951970 --> -0.961691).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0020961
	speed: 0.3644s/iter; left time: 15174.8730s
	iters: 200, epoch: 12 | loss: 0.0096941
	speed: 0.0981s/iter; left time: 4076.3143s
	iters: 300, epoch: 12 | loss: 0.0201481
	speed: 0.1090s/iter; left time: 4516.1204s
	iters: 400, epoch: 12 | loss: 0.0117986
	speed: 0.0946s/iter; left time: 3912.4455s
Epoch: 12 cost time: 46.6410493850708
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0011578
	speed: 0.3410s/iter; left time: 14038.1159s
	iters: 200, epoch: 13 | loss: 0.0151818
	speed: 0.1055s/iter; left time: 4331.6820s
	iters: 300, epoch: 13 | loss: 0.0122554
	speed: 0.0936s/iter; left time: 3835.3906s
	iters: 400, epoch: 13 | loss: 0.0252949
	speed: 0.0847s/iter; left time: 3462.1340s
Epoch: 13 cost time: 44.5537588596344
Epoch: 13, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0049138
	speed: 0.3780s/iter; left time: 15384.9126s
	iters: 200, epoch: 14 | loss: 0.0107642
	speed: 0.0842s/iter; left time: 3417.6890s
	iters: 300, epoch: 14 | loss: 0.4697765
	speed: 0.0809s/iter; left time: 3277.7683s
	iters: 400, epoch: 14 | loss: 0.0064319
	speed: 0.0853s/iter; left time: 3447.4581s
Epoch: 14 cost time: 40.78826951980591
Epoch: 14, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0030323
	speed: 0.3729s/iter; left time: 15002.1807s
	iters: 200, epoch: 15 | loss: 0.0094537
	speed: 0.0909s/iter; left time: 3647.5936s
	iters: 300, epoch: 15 | loss: 0.0067169
	speed: 0.0879s/iter; left time: 3520.2001s
	iters: 400, epoch: 15 | loss: 0.0018315
	speed: 0.1027s/iter; left time: 4099.8795s
Epoch: 15 cost time: 44.25324010848999
Epoch: 15, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.961691 --> -0.976557).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0293127
	speed: 0.3317s/iter; left time: 13188.5207s
	iters: 200, epoch: 16 | loss: 0.1919300
	speed: 0.0868s/iter; left time: 3444.7616s
	iters: 300, epoch: 16 | loss: 0.0040117
	speed: 0.0898s/iter; left time: 3551.6726s
	iters: 400, epoch: 16 | loss: 0.4230616
	speed: 0.0915s/iter; left time: 3610.0136s
Epoch: 16 cost time: 42.44109654426575
Epoch: 16, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1090907
	speed: 0.3864s/iter; left time: 15183.8751s
	iters: 200, epoch: 17 | loss: 0.0041880
	speed: 0.1019s/iter; left time: 3995.0237s
	iters: 300, epoch: 17 | loss: 0.0153760
	speed: 0.0860s/iter; left time: 3362.5341s
	iters: 400, epoch: 17 | loss: 0.0222537
	speed: 0.0879s/iter; left time: 3428.7973s
Epoch: 17 cost time: 44.444395542144775
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0043231
	speed: 0.3631s/iter; left time: 14100.0666s
	iters: 200, epoch: 18 | loss: 0.0272709
	speed: 0.0969s/iter; left time: 3752.2058s
	iters: 300, epoch: 18 | loss: 0.0199492
	speed: 0.0919s/iter; left time: 3549.5447s
	iters: 400, epoch: 18 | loss: 0.1656055
	speed: 0.0884s/iter; left time: 3405.4654s
Epoch: 18 cost time: 42.856237173080444
Epoch: 18, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0048924
	speed: 0.3248s/iter; left time: 12458.7628s
	iters: 200, epoch: 19 | loss: 0.0019168
	speed: 0.0823s/iter; left time: 3148.6845s
	iters: 300, epoch: 19 | loss: 0.0027568
	speed: 0.0920s/iter; left time: 3510.2114s
	iters: 400, epoch: 19 | loss: 0.0013381
	speed: 0.1002s/iter; left time: 3812.9763s
Epoch: 19 cost time: 41.40068030357361
Epoch: 19, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0448272
	speed: 0.3467s/iter; left time: 13138.2652s
	iters: 200, epoch: 20 | loss: 0.0118892
	speed: 0.0905s/iter; left time: 3419.0874s
	iters: 300, epoch: 20 | loss: 0.0275404
	speed: 0.0911s/iter; left time: 3432.0827s
	iters: 400, epoch: 20 | loss: 0.0036402
	speed: 0.0852s/iter; left time: 3201.3517s
Epoch: 20 cost time: 41.892496824264526
Epoch: 20, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0055866
	speed: 0.3501s/iter; left time: 13102.0239s
	iters: 200, epoch: 21 | loss: 0.0825904
	speed: 0.0945s/iter; left time: 3525.7534s
	iters: 300, epoch: 21 | loss: 0.2399914
	speed: 0.0894s/iter; left time: 3327.8128s
	iters: 400, epoch: 21 | loss: 0.3841819
	speed: 0.0946s/iter; left time: 3510.1455s
Epoch: 21 cost time: 44.55499243736267
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0010600
	speed: 0.3594s/iter; left time: 13280.6064s
	iters: 200, epoch: 22 | loss: 0.0534473
	speed: 0.0927s/iter; left time: 3414.4796s
	iters: 300, epoch: 22 | loss: 0.0131471
	speed: 0.0910s/iter; left time: 3343.8076s
	iters: 400, epoch: 22 | loss: 0.0226208
	speed: 0.0875s/iter; left time: 3207.2159s
Epoch: 22 cost time: 43.17387866973877
Epoch: 22, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0023577
	speed: 0.3635s/iter; left time: 13260.6192s
	iters: 200, epoch: 23 | loss: 0.0468059
	speed: 0.0931s/iter; left time: 3388.6467s
	iters: 300, epoch: 23 | loss: 0.0201595
	speed: 0.0890s/iter; left time: 3227.6117s
	iters: 400, epoch: 23 | loss: 0.1934163
	speed: 0.0875s/iter; left time: 3165.4015s
Epoch: 23 cost time: 42.681227922439575
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0010817
	speed: 0.3330s/iter; left time: 11991.1619s
	iters: 200, epoch: 24 | loss: 0.0017417
	speed: 0.0877s/iter; left time: 3149.4001s
	iters: 300, epoch: 24 | loss: 0.1610183
	speed: 0.0950s/iter; left time: 3403.5359s
	iters: 400, epoch: 24 | loss: 0.2381492
	speed: 0.0913s/iter; left time: 3260.6463s
Epoch: 24 cost time: 42.185882806777954
Epoch: 24, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0019282
	speed: 0.3678s/iter; left time: 13071.7674s
	iters: 200, epoch: 25 | loss: 0.0038102
	speed: 0.0892s/iter; left time: 3162.3603s
	iters: 300, epoch: 25 | loss: 0.0563341
	speed: 0.0789s/iter; left time: 2787.0866s
	iters: 400, epoch: 25 | loss: 0.0045462
	speed: 0.0860s/iter; left time: 3029.4104s
Epoch: 25 cost time: 41.66319227218628
Epoch: 25, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 911110
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8230059
	speed: 0.1178s/iter; left time: 5515.4726s
	iters: 200, epoch: 1 | loss: 0.4239949
	speed: 0.0902s/iter; left time: 4211.8097s
	iters: 300, epoch: 1 | loss: 0.4358135
	speed: 0.0943s/iter; left time: 4392.2870s
	iters: 400, epoch: 1 | loss: 0.6341238
	speed: 0.0857s/iter; left time: 3987.1944s
Epoch: 1 cost time: 44.65866470336914
Epoch: 1, Steps: 469 | Train Loss: 0.663 Vali Loss: 0.294 Vali Acc: 0.918 Test Loss: 0.294 Test Acc: 0.918
Validation loss decreased (inf --> -0.917664).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4388036
	speed: 0.3448s/iter; left time: 15976.2694s
	iters: 200, epoch: 2 | loss: 0.0349567
	speed: 0.0935s/iter; left time: 4324.1531s
	iters: 300, epoch: 2 | loss: 0.3869106
	speed: 0.0920s/iter; left time: 4244.0484s
	iters: 400, epoch: 2 | loss: 0.4366108
	speed: 0.0871s/iter; left time: 4010.4557s
Epoch: 2 cost time: 42.00954270362854
Epoch: 2, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
Validation loss decreased (-0.917664 --> -0.925098).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1001423
	speed: 0.3570s/iter; left time: 16371.6337s
	iters: 200, epoch: 3 | loss: 0.0919658
	speed: 0.0989s/iter; left time: 4524.2888s
	iters: 300, epoch: 3 | loss: 0.0124792
	speed: 0.0873s/iter; left time: 3988.5133s
	iters: 400, epoch: 3 | loss: 0.4054843
	speed: 0.0831s/iter; left time: 3788.2755s
Epoch: 3 cost time: 42.859107971191406
Epoch: 3, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.219 Vali Acc: 0.934 Test Loss: 0.219 Test Acc: 0.934
Validation loss decreased (-0.925098 --> -0.933960).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2992649
	speed: 0.3535s/iter; left time: 16048.5786s
	iters: 200, epoch: 4 | loss: 0.0479361
	speed: 0.0903s/iter; left time: 4090.9336s
	iters: 300, epoch: 4 | loss: 0.1771460
	speed: 0.0938s/iter; left time: 4240.4847s
	iters: 400, epoch: 4 | loss: 0.0956975
	speed: 0.0861s/iter; left time: 3884.1182s
Epoch: 4 cost time: 41.92523431777954
Epoch: 4, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.176 Vali Acc: 0.947 Test Loss: 0.176 Test Acc: 0.947
Validation loss decreased (-0.933960 --> -0.946825).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3470162
	speed: 0.3380s/iter; left time: 15185.1340s
	iters: 200, epoch: 5 | loss: 0.0509350
	speed: 0.0849s/iter; left time: 3807.0510s
	iters: 300, epoch: 5 | loss: 0.2662255
	speed: 0.0971s/iter; left time: 4341.2727s
	iters: 400, epoch: 5 | loss: 0.0181379
	speed: 0.1028s/iter; left time: 4589.4070s
Epoch: 5 cost time: 44.51198673248291
Epoch: 5, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4272972
	speed: 0.3968s/iter; left time: 17640.8769s
	iters: 200, epoch: 6 | loss: 0.0476316
	speed: 0.0934s/iter; left time: 4144.1579s
	iters: 300, epoch: 6 | loss: 0.2087265
	speed: 0.0980s/iter; left time: 4337.3007s
	iters: 400, epoch: 6 | loss: 0.0107199
	speed: 0.1010s/iter; left time: 4458.4459s
Epoch: 6 cost time: 46.490665912628174
Epoch: 6, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.946825 --> -0.964550).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1034592
	speed: 0.3926s/iter; left time: 17269.6579s
	iters: 200, epoch: 7 | loss: 0.0063078
	speed: 0.1049s/iter; left time: 4605.5505s
	iters: 300, epoch: 7 | loss: 0.0216181
	speed: 0.0949s/iter; left time: 4154.6307s
	iters: 400, epoch: 7 | loss: 0.0745469
	speed: 0.0897s/iter; left time: 3917.7942s
Epoch: 7 cost time: 47.657443046569824
Epoch: 7, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0162815
	speed: 0.3420s/iter; left time: 14883.2258s
	iters: 200, epoch: 8 | loss: 0.0104978
	speed: 0.0758s/iter; left time: 3292.9431s
	iters: 300, epoch: 8 | loss: 0.0077160
	speed: 0.0769s/iter; left time: 3331.6543s
	iters: 400, epoch: 8 | loss: 0.0060590
	speed: 0.0805s/iter; left time: 3479.5058s
Epoch: 8 cost time: 38.27334022521973
Epoch: 8, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.964550 --> -0.965122).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0094757
	speed: 0.3538s/iter; left time: 15230.7531s
	iters: 200, epoch: 9 | loss: 0.4753376
	speed: 0.0826s/iter; left time: 3546.4301s
	iters: 300, epoch: 9 | loss: 0.0022165
	speed: 0.0894s/iter; left time: 3829.2773s
	iters: 400, epoch: 9 | loss: 0.0029500
	speed: 0.0834s/iter; left time: 3566.7272s
Epoch: 9 cost time: 41.636380434036255
Epoch: 9, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0074757
	speed: 0.3490s/iter; left time: 14858.4150s
	iters: 200, epoch: 10 | loss: 0.1069674
	speed: 0.0763s/iter; left time: 3239.1635s
	iters: 300, epoch: 10 | loss: 0.0378481
	speed: 0.0843s/iter; left time: 3573.1914s
	iters: 400, epoch: 10 | loss: 0.0070241
	speed: 0.0905s/iter; left time: 3824.4471s
Epoch: 10 cost time: 40.054439306259155
Epoch: 10, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0031100
	speed: 0.3439s/iter; left time: 14481.6349s
	iters: 200, epoch: 11 | loss: 0.0044342
	speed: 0.0875s/iter; left time: 3674.2418s
	iters: 300, epoch: 11 | loss: 0.0055011
	speed: 0.0899s/iter; left time: 3769.5526s
	iters: 400, epoch: 11 | loss: 0.0044527
	speed: 0.0873s/iter; left time: 3649.9792s
Epoch: 11 cost time: 41.75563335418701
Epoch: 11, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.965122 --> -0.968266).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0357736
	speed: 0.3467s/iter; left time: 14435.3052s
	iters: 200, epoch: 12 | loss: 0.0479328
	speed: 0.0914s/iter; left time: 3796.4314s
	iters: 300, epoch: 12 | loss: 0.0030119
	speed: 0.0931s/iter; left time: 3858.6519s
	iters: 400, epoch: 12 | loss: 0.0133843
	speed: 0.0921s/iter; left time: 3806.8434s
Epoch: 12 cost time: 42.84544563293457
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0053490
	speed: 0.3466s/iter; left time: 14270.8964s
	iters: 200, epoch: 13 | loss: 0.0168489
	speed: 0.0804s/iter; left time: 3301.5488s
	iters: 300, epoch: 13 | loss: 0.0075796
	speed: 0.0901s/iter; left time: 3692.0831s
	iters: 400, epoch: 13 | loss: 0.0564605
	speed: 0.0845s/iter; left time: 3452.5126s
Epoch: 13 cost time: 40.01862573623657
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0926924
	speed: 0.3210s/iter; left time: 13065.1363s
	iters: 200, epoch: 14 | loss: 0.0941765
	speed: 0.0851s/iter; left time: 3455.1956s
	iters: 300, epoch: 14 | loss: 0.0083762
	speed: 0.0829s/iter; left time: 3355.8509s
	iters: 400, epoch: 14 | loss: 0.2356060
	speed: 0.0911s/iter; left time: 3679.7649s
Epoch: 14 cost time: 40.37356925010681
Epoch: 14, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2001384
	speed: 0.3289s/iter; left time: 13231.5927s
	iters: 200, epoch: 15 | loss: 0.0101947
	speed: 0.0842s/iter; left time: 3378.5418s
	iters: 300, epoch: 15 | loss: 0.0359281
	speed: 0.0795s/iter; left time: 3180.8418s
	iters: 400, epoch: 15 | loss: 0.1601701
	speed: 0.0890s/iter; left time: 3553.1231s
Epoch: 15 cost time: 38.81812405586243
Epoch: 15, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0843041
	speed: 0.3250s/iter; left time: 12924.8178s
	iters: 200, epoch: 16 | loss: 0.0130012
	speed: 0.0898s/iter; left time: 3561.3131s
	iters: 300, epoch: 16 | loss: 0.3713368
	speed: 0.0900s/iter; left time: 3560.6004s
	iters: 400, epoch: 16 | loss: 0.0010425
	speed: 0.0887s/iter; left time: 3499.3373s
Epoch: 16 cost time: 41.18374848365784
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1715765
	speed: 0.3365s/iter; left time: 13222.7742s
	iters: 200, epoch: 17 | loss: 0.0061021
	speed: 0.0889s/iter; left time: 3484.7074s
	iters: 300, epoch: 17 | loss: 0.0042837
	speed: 0.0884s/iter; left time: 3455.8401s
	iters: 400, epoch: 17 | loss: 0.4997782
	speed: 0.0869s/iter; left time: 3387.2396s
Epoch: 17 cost time: 40.89419627189636
Epoch: 17, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0043150
	speed: 0.3354s/iter; left time: 13021.0854s
	iters: 200, epoch: 18 | loss: 0.0251222
	speed: 0.0874s/iter; left time: 3384.2645s
	iters: 300, epoch: 18 | loss: 0.8355641
	speed: 0.0923s/iter; left time: 3563.8474s
	iters: 400, epoch: 18 | loss: 0.0032498
	speed: 0.0832s/iter; left time: 3204.8598s
Epoch: 18 cost time: 40.43431830406189
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1175021
	speed: 0.3265s/iter; left time: 12522.8520s
	iters: 200, epoch: 19 | loss: 0.0019043
	speed: 0.0852s/iter; left time: 3259.3328s
	iters: 300, epoch: 19 | loss: 0.2232151
	speed: 0.0866s/iter; left time: 3304.8966s
	iters: 400, epoch: 19 | loss: 0.0931714
	speed: 0.0830s/iter; left time: 3160.3477s
Epoch: 19 cost time: 41.03078269958496
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0025884
	speed: 0.3432s/iter; left time: 13002.6564s
	iters: 200, epoch: 20 | loss: 0.0090836
	speed: 0.0815s/iter; left time: 3079.6850s
	iters: 300, epoch: 20 | loss: 0.0474239
	speed: 0.0825s/iter; left time: 3109.0269s
	iters: 400, epoch: 20 | loss: 0.0009847
	speed: 0.0840s/iter; left time: 3158.0521s
Epoch: 20 cost time: 40.65508580207825
Epoch: 20, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.970267).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0030351
	speed: 0.3542s/iter; left time: 13253.9673s
	iters: 200, epoch: 21 | loss: 0.0026497
	speed: 0.0884s/iter; left time: 3299.3695s
	iters: 300, epoch: 21 | loss: 0.0040941
	speed: 0.0919s/iter; left time: 3419.5510s
	iters: 400, epoch: 21 | loss: 0.0059466
	speed: 0.0885s/iter; left time: 3285.0256s
Epoch: 21 cost time: 42.31341910362244
Epoch: 21, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0007507
	speed: 0.3457s/iter; left time: 12773.8105s
	iters: 200, epoch: 22 | loss: 0.2283500
	speed: 0.0852s/iter; left time: 3139.1950s
	iters: 300, epoch: 22 | loss: 0.0075347
	speed: 0.0829s/iter; left time: 3046.7630s
	iters: 400, epoch: 22 | loss: 0.0105107
	speed: 0.0863s/iter; left time: 3162.3384s
Epoch: 22 cost time: 40.48052644729614
Epoch: 22, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0027289
	speed: 0.3406s/iter; left time: 12426.5628s
	iters: 200, epoch: 23 | loss: 0.0019685
	speed: 0.0878s/iter; left time: 3193.9301s
	iters: 300, epoch: 23 | loss: 0.0077557
	speed: 0.0824s/iter; left time: 2989.5211s
	iters: 400, epoch: 23 | loss: 0.0051920
	speed: 0.0887s/iter; left time: 3210.2663s
Epoch: 23 cost time: 40.129478931427
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0030568
	speed: 0.3349s/iter; left time: 12061.0124s
	iters: 200, epoch: 24 | loss: 0.0124360
	speed: 0.0853s/iter; left time: 3063.0332s
	iters: 300, epoch: 24 | loss: 0.0041077
	speed: 0.0880s/iter; left time: 3151.6283s
	iters: 400, epoch: 24 | loss: 0.0014960
	speed: 0.0885s/iter; left time: 3159.7690s
Epoch: 24 cost time: 40.87878608703613
Epoch: 24, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0028066
	speed: 0.3363s/iter; left time: 11953.8193s
	iters: 200, epoch: 25 | loss: 0.0027411
	speed: 0.0861s/iter; left time: 3052.1734s
	iters: 300, epoch: 25 | loss: 0.0014210
	speed: 0.0847s/iter; left time: 2993.7012s
	iters: 400, epoch: 25 | loss: 0.6693323
	speed: 0.0837s/iter; left time: 2949.7306s
Epoch: 25 cost time: 40.06216239929199
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.955 Test Loss: 0.226 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1311152
	speed: 0.3268s/iter; left time: 11463.2693s
	iters: 200, epoch: 26 | loss: 0.0021869
	speed: 0.0928s/iter; left time: 3246.2900s
	iters: 300, epoch: 26 | loss: 0.0010387
	speed: 0.0827s/iter; left time: 2882.8595s
	iters: 400, epoch: 26 | loss: 0.0096396
	speed: 0.0938s/iter; left time: 3261.2140s
Epoch: 26 cost time: 41.329710721969604
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0699926
	speed: 0.3404s/iter; left time: 11780.5339s
	iters: 200, epoch: 27 | loss: 0.0515292
	speed: 0.0959s/iter; left time: 3309.7565s
	iters: 300, epoch: 27 | loss: 0.3267685
	speed: 0.0896s/iter; left time: 3083.7911s
	iters: 400, epoch: 27 | loss: 0.0233982
	speed: 0.0983s/iter; left time: 3371.6762s
Epoch: 27 cost time: 43.160672187805176
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.959 Test Loss: 0.237 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0009748
	speed: 0.3621s/iter; left time: 12362.4839s
	iters: 200, epoch: 28 | loss: 0.0010690
	speed: 0.0939s/iter; left time: 3196.9573s
	iters: 300, epoch: 28 | loss: 0.1066092
	speed: 0.0917s/iter; left time: 3111.7855s
	iters: 400, epoch: 28 | loss: 0.2884766
	speed: 0.0851s/iter; left time: 2880.6197s
Epoch: 28 cost time: 43.11811184883118
Epoch: 28, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0449563
	speed: 0.3637s/iter; left time: 12246.5772s
	iters: 200, epoch: 29 | loss: 0.0715948
	speed: 0.0870s/iter; left time: 2919.4757s
	iters: 300, epoch: 29 | loss: 0.0084028
	speed: 0.0969s/iter; left time: 3243.7757s
	iters: 400, epoch: 29 | loss: 0.0044818
	speed: 0.0894s/iter; left time: 2982.1604s
Epoch: 29 cost time: 43.795008182525635
Epoch: 29, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0007797
	speed: 0.3521s/iter; left time: 11688.2067s
	iters: 200, epoch: 30 | loss: 0.0065418
	speed: 0.0837s/iter; left time: 2771.2731s
	iters: 300, epoch: 30 | loss: 0.0774315
	speed: 0.0885s/iter; left time: 2921.2777s
	iters: 400, epoch: 30 | loss: 0.0924183
	speed: 0.0806s/iter; left time: 2652.3016s
Epoch: 30 cost time: 40.074808835983276
Epoch: 30, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 910854
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8304046
	speed: 0.1273s/iter; left time: 5956.2967s
	iters: 200, epoch: 1 | loss: 0.3550894
	speed: 0.0945s/iter; left time: 4413.6526s
	iters: 300, epoch: 1 | loss: 0.3963911
	speed: 0.0927s/iter; left time: 4321.9433s
	iters: 400, epoch: 1 | loss: 0.3663321
	speed: 0.0855s/iter; left time: 3973.6462s
Epoch: 1 cost time: 46.605674743652344
Epoch: 1, Steps: 469 | Train Loss: 0.644 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
Validation loss decreased (inf --> -0.925383).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3047466
	speed: 0.3650s/iter; left time: 16910.1031s
	iters: 200, epoch: 2 | loss: 0.0817916
	speed: 0.1026s/iter; left time: 4742.9714s
	iters: 300, epoch: 2 | loss: 0.1234477
	speed: 0.0859s/iter; left time: 3961.3917s
	iters: 400, epoch: 2 | loss: 0.0578273
	speed: 0.0862s/iter; left time: 3966.1107s
Epoch: 2 cost time: 44.57483649253845
Epoch: 2, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.485 Vali Acc: 0.871 Test Loss: 0.485 Test Acc: 0.871
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0651813
	speed: 0.3660s/iter; left time: 16783.7137s
	iters: 200, epoch: 3 | loss: 0.0416384
	speed: 0.0861s/iter; left time: 3939.6700s
	iters: 300, epoch: 3 | loss: 0.0890173
	speed: 0.0912s/iter; left time: 4165.0219s
	iters: 400, epoch: 3 | loss: 0.0166897
	speed: 0.0889s/iter; left time: 4050.2584s
Epoch: 3 cost time: 41.360817670822144
Epoch: 3, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.413 Vali Acc: 0.890 Test Loss: 0.413 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0464971
	speed: 0.3488s/iter; left time: 15835.1328s
	iters: 200, epoch: 4 | loss: 0.0219868
	speed: 0.0894s/iter; left time: 4047.1863s
	iters: 300, epoch: 4 | loss: 0.0155688
	speed: 0.0962s/iter; left time: 4346.1902s
	iters: 400, epoch: 4 | loss: 0.2113237
	speed: 0.0880s/iter; left time: 3969.9858s
Epoch: 4 cost time: 43.4596107006073
Epoch: 4, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
Validation loss decreased (-0.925383 --> -0.937962).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1065651
	speed: 0.3701s/iter; left time: 16627.9383s
	iters: 200, epoch: 5 | loss: 0.0323262
	speed: 0.0766s/iter; left time: 3435.1766s
	iters: 300, epoch: 5 | loss: 0.0275212
	speed: 0.0839s/iter; left time: 3752.4827s
	iters: 400, epoch: 5 | loss: 0.0221408
	speed: 0.0868s/iter; left time: 3875.5007s
Epoch: 5 cost time: 40.90642023086548
Epoch: 5, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.214 Vali Acc: 0.938 Test Loss: 0.214 Test Acc: 0.938
Validation loss decreased (-0.937962 --> -0.938248).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0074246
	speed: 0.3563s/iter; left time: 15840.1360s
	iters: 200, epoch: 6 | loss: 0.0333731
	speed: 0.0922s/iter; left time: 4089.4426s
	iters: 300, epoch: 6 | loss: 0.0182038
	speed: 0.0817s/iter; left time: 3617.8816s
	iters: 400, epoch: 6 | loss: 0.0936601
	speed: 0.0881s/iter; left time: 3889.3442s
Epoch: 6 cost time: 41.41404604911804
Epoch: 6, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (-0.938248 --> -0.960833).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0072680
	speed: 0.3542s/iter; left time: 15579.6564s
	iters: 200, epoch: 7 | loss: 0.1029706
	speed: 0.0924s/iter; left time: 4056.6994s
	iters: 300, epoch: 7 | loss: 0.0230685
	speed: 0.0948s/iter; left time: 4150.0805s
	iters: 400, epoch: 7 | loss: 0.0747221
	speed: 0.0868s/iter; left time: 3793.5752s
Epoch: 7 cost time: 42.60959434509277
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0846721
	speed: 0.3576s/iter; left time: 15560.2498s
	iters: 200, epoch: 8 | loss: 0.1233434
	speed: 0.0858s/iter; left time: 3727.3851s
	iters: 300, epoch: 8 | loss: 0.0337690
	speed: 0.0893s/iter; left time: 3870.0346s
	iters: 400, epoch: 8 | loss: 0.0243997
	speed: 0.0994s/iter; left time: 4297.7279s
Epoch: 8 cost time: 42.388343334198
Epoch: 8, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0664136
	speed: 0.3624s/iter; left time: 15600.7037s
	iters: 200, epoch: 9 | loss: 0.1952304
	speed: 0.0866s/iter; left time: 3718.3268s
	iters: 300, epoch: 9 | loss: 0.0047361
	speed: 0.0961s/iter; left time: 4118.9480s
	iters: 400, epoch: 9 | loss: 0.0051732
	speed: 0.0948s/iter; left time: 4052.1388s
Epoch: 9 cost time: 44.337268352508545
Epoch: 9, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.241 Vali Acc: 0.945 Test Loss: 0.241 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0901094
	speed: 0.3765s/iter; left time: 16030.6160s
	iters: 200, epoch: 10 | loss: 0.0033078
	speed: 0.0877s/iter; left time: 3724.2226s
	iters: 300, epoch: 10 | loss: 0.0035728
	speed: 0.0851s/iter; left time: 3608.0481s
	iters: 400, epoch: 10 | loss: 0.0952315
	speed: 0.0909s/iter; left time: 3845.2511s
Epoch: 10 cost time: 41.8032865524292
Epoch: 10, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0181729
	speed: 0.3607s/iter; left time: 15190.7267s
	iters: 200, epoch: 11 | loss: 0.0038741
	speed: 0.0941s/iter; left time: 3951.7326s
	iters: 300, epoch: 11 | loss: 0.0044653
	speed: 0.0971s/iter; left time: 4068.3206s
	iters: 400, epoch: 11 | loss: 0.0958602
	speed: 0.0882s/iter; left time: 3689.3992s
Epoch: 11 cost time: 43.39907383918762
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0020946
	speed: 0.3425s/iter; left time: 14263.1351s
	iters: 200, epoch: 12 | loss: 0.0031067
	speed: 0.0897s/iter; left time: 3726.9297s
	iters: 300, epoch: 12 | loss: 0.1564816
	speed: 0.0920s/iter; left time: 3814.6343s
	iters: 400, epoch: 12 | loss: 0.0119712
	speed: 0.0834s/iter; left time: 3448.5784s
Epoch: 12 cost time: 41.998759269714355
Epoch: 12, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0088014
	speed: 0.3563s/iter; left time: 14670.8290s
	iters: 200, epoch: 13 | loss: 0.0087040
	speed: 0.0881s/iter; left time: 3617.4200s
	iters: 300, epoch: 13 | loss: 0.0616383
	speed: 0.0906s/iter; left time: 3711.5359s
	iters: 400, epoch: 13 | loss: 0.0135421
	speed: 0.0865s/iter; left time: 3533.9425s
Epoch: 13 cost time: 41.261332988739014
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
Validation loss decreased (-0.960833 --> -0.965979).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0224076
	speed: 0.3674s/iter; left time: 14954.6316s
	iters: 200, epoch: 14 | loss: 0.0022656
	speed: 0.0892s/iter; left time: 3622.2381s
	iters: 300, epoch: 14 | loss: 0.0049478
	speed: 0.0905s/iter; left time: 3667.6197s
	iters: 400, epoch: 14 | loss: 0.0180829
	speed: 0.0906s/iter; left time: 3660.9873s
Epoch: 14 cost time: 42.851632595062256
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.211 Vali Acc: 0.960 Test Loss: 0.211 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0242423
	speed: 0.3709s/iter; left time: 14923.6094s
	iters: 200, epoch: 15 | loss: 0.0021942
	speed: 0.0837s/iter; left time: 3357.4634s
	iters: 300, epoch: 15 | loss: 0.0030991
	speed: 0.0825s/iter; left time: 3304.0024s
	iters: 400, epoch: 15 | loss: 0.0169487
	speed: 0.0828s/iter; left time: 3307.6851s
Epoch: 15 cost time: 40.975332736968994
Epoch: 15, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1782288
	speed: 0.3514s/iter; left time: 13975.6927s
	iters: 200, epoch: 16 | loss: 0.0013736
	speed: 0.0919s/iter; left time: 3643.4323s
	iters: 300, epoch: 16 | loss: 0.0014978
	speed: 0.0889s/iter; left time: 3516.8398s
	iters: 400, epoch: 16 | loss: 0.0039743
	speed: 0.0878s/iter; left time: 3465.1187s
Epoch: 16 cost time: 41.23326349258423
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.965979 --> -0.968838).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0457952
	speed: 0.3424s/iter; left time: 13453.9170s
	iters: 200, epoch: 17 | loss: 0.0036263
	speed: 0.0816s/iter; left time: 3198.7188s
	iters: 300, epoch: 17 | loss: 0.0123004
	speed: 0.0875s/iter; left time: 3419.2603s
	iters: 400, epoch: 17 | loss: 0.0017822
	speed: 0.0836s/iter; left time: 3260.5143s
Epoch: 17 cost time: 40.94752335548401
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969410).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0263679
	speed: 0.3719s/iter; left time: 14441.6483s
	iters: 200, epoch: 18 | loss: 0.0519610
	speed: 0.0814s/iter; left time: 3154.3236s
	iters: 300, epoch: 18 | loss: 0.0015941
	speed: 0.0840s/iter; left time: 3245.4952s
	iters: 400, epoch: 18 | loss: 0.0223710
	speed: 0.0917s/iter; left time: 3532.0093s
Epoch: 18 cost time: 41.45313024520874
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.969982).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3093391
	speed: 0.3821s/iter; left time: 14658.4988s
	iters: 200, epoch: 19 | loss: 0.1539358
	speed: 0.0955s/iter; left time: 3655.1065s
	iters: 300, epoch: 19 | loss: 0.0055911
	speed: 0.0918s/iter; left time: 3504.5909s
	iters: 400, epoch: 19 | loss: 0.0123406
	speed: 0.0942s/iter; left time: 3583.6657s
Epoch: 19 cost time: 43.79535675048828
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.969982 --> -0.970553).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0066712
	speed: 0.3439s/iter; left time: 13029.7055s
	iters: 200, epoch: 20 | loss: 0.0177620
	speed: 0.0826s/iter; left time: 3120.0897s
	iters: 300, epoch: 20 | loss: 0.0058652
	speed: 0.0914s/iter; left time: 3445.7441s
	iters: 400, epoch: 20 | loss: 0.1081150
	speed: 0.0884s/iter; left time: 3323.6539s
Epoch: 20 cost time: 41.37701773643494
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0422362
	speed: 0.3174s/iter; left time: 11878.4154s
	iters: 200, epoch: 21 | loss: 0.0036908
	speed: 0.0810s/iter; left time: 3024.7788s
	iters: 300, epoch: 21 | loss: 0.0917104
	speed: 0.0812s/iter; left time: 3022.7619s
	iters: 400, epoch: 21 | loss: 0.0012989
	speed: 0.0760s/iter; left time: 2820.8510s
Epoch: 21 cost time: 37.94187593460083
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
Validation loss decreased (-0.970553 --> -0.978272).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0007832
	speed: 0.3203s/iter; left time: 11834.7651s
	iters: 200, epoch: 22 | loss: 0.0010012
	speed: 0.0953s/iter; left time: 3513.4721s
	iters: 300, epoch: 22 | loss: 0.0109769
	speed: 0.0924s/iter; left time: 3395.2130s
	iters: 400, epoch: 22 | loss: 0.0016045
	speed: 0.0788s/iter; left time: 2887.4471s
Epoch: 22 cost time: 41.409884214401245
Epoch: 22, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0090767
	speed: 0.3180s/iter; left time: 11601.4195s
	iters: 200, epoch: 23 | loss: 0.1195749
	speed: 0.0825s/iter; left time: 3000.5592s
	iters: 300, epoch: 23 | loss: 0.0017297
	speed: 0.0841s/iter; left time: 3051.4164s
	iters: 400, epoch: 23 | loss: 0.0127219
	speed: 0.0854s/iter; left time: 3091.6002s
Epoch: 23 cost time: 38.17877960205078
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0093980
	speed: 0.3285s/iter; left time: 11831.1945s
	iters: 200, epoch: 24 | loss: 0.0151532
	speed: 0.0849s/iter; left time: 3049.0430s
	iters: 300, epoch: 24 | loss: 0.0010672
	speed: 0.0890s/iter; left time: 3185.6696s
	iters: 400, epoch: 24 | loss: 0.0094536
	speed: 0.0810s/iter; left time: 2893.4817s
Epoch: 24 cost time: 40.40140104293823
Epoch: 24, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0131837
	speed: 0.3113s/iter; left time: 11066.7147s
	iters: 200, epoch: 25 | loss: 0.0009297
	speed: 0.0819s/iter; left time: 2902.4981s
	iters: 300, epoch: 25 | loss: 0.0039662
	speed: 0.0825s/iter; left time: 2914.7128s
	iters: 400, epoch: 25 | loss: 0.3450706
	speed: 0.0840s/iter; left time: 2962.0342s
Epoch: 25 cost time: 40.22096633911133
Epoch: 25, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0042469
	speed: 0.3399s/iter; left time: 11924.0566s
	iters: 200, epoch: 26 | loss: 0.0370615
	speed: 0.0831s/iter; left time: 2907.1274s
	iters: 300, epoch: 26 | loss: 0.0083847
	speed: 0.0769s/iter; left time: 2683.1373s
	iters: 400, epoch: 26 | loss: 0.0048472
	speed: 0.0766s/iter; left time: 2663.4485s
Epoch: 26 cost time: 38.113253116607666
Epoch: 26, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0027369
	speed: 0.3323s/iter; left time: 11499.7245s
	iters: 200, epoch: 27 | loss: 0.0008788
	speed: 0.0815s/iter; left time: 2812.7634s
	iters: 300, epoch: 27 | loss: 0.0009856
	speed: 0.0811s/iter; left time: 2791.2392s
	iters: 400, epoch: 27 | loss: 0.0015421
	speed: 0.0789s/iter; left time: 2707.2718s
Epoch: 27 cost time: 38.18990230560303
Epoch: 27, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.979130).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0013100
	speed: 0.3147s/iter; left time: 10744.6355s
	iters: 200, epoch: 28 | loss: 0.0132518
	speed: 0.0739s/iter; left time: 2514.8516s
	iters: 300, epoch: 28 | loss: 0.0023041
	speed: 0.0829s/iter; left time: 2811.7943s
	iters: 400, epoch: 28 | loss: 0.0025461
	speed: 0.0841s/iter; left time: 2846.1836s
Epoch: 28 cost time: 37.60917329788208
Epoch: 28, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0031187
	speed: 0.3365s/iter; left time: 11328.6162s
	iters: 200, epoch: 29 | loss: 0.0008235
	speed: 0.0770s/iter; left time: 2585.8295s
	iters: 300, epoch: 29 | loss: 0.0584183
	speed: 0.0870s/iter; left time: 2912.7955s
	iters: 400, epoch: 29 | loss: 0.0642348
	speed: 0.0810s/iter; left time: 2701.2766s
Epoch: 29 cost time: 39.24384593963623
Epoch: 29, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0013906
	speed: 0.3104s/iter; left time: 10304.5992s
	iters: 200, epoch: 30 | loss: 0.0010395
	speed: 0.0850s/iter; left time: 2813.5381s
	iters: 300, epoch: 30 | loss: 0.1017943
	speed: 0.0775s/iter; left time: 2557.5609s
	iters: 400, epoch: 30 | loss: 0.0084869
	speed: 0.0835s/iter; left time: 2747.1693s
Epoch: 30 cost time: 38.95377993583679
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0651961
	speed: 0.3488s/iter; left time: 11418.1787s
	iters: 200, epoch: 31 | loss: 0.0014102
	speed: 0.0877s/iter; left time: 2862.9243s
	iters: 300, epoch: 31 | loss: 0.0174331
	speed: 0.0817s/iter; left time: 2657.5513s
	iters: 400, epoch: 31 | loss: 0.0014064
	speed: 0.0840s/iter; left time: 2724.5662s
Epoch: 31 cost time: 41.85881519317627
Epoch: 31, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0006104
	speed: 0.3235s/iter; left time: 10437.9641s
	iters: 200, epoch: 32 | loss: 0.0023319
	speed: 0.0781s/iter; left time: 2510.6663s
	iters: 300, epoch: 32 | loss: 0.0020943
	speed: 0.0784s/iter; left time: 2513.8859s
	iters: 400, epoch: 32 | loss: 0.0017532
	speed: 0.0821s/iter; left time: 2623.5549s
Epoch: 32 cost time: 37.556835889816284
Epoch: 32, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0342471
	speed: 0.3278s/iter; left time: 10423.2525s
	iters: 200, epoch: 33 | loss: 0.0033835
	speed: 0.0857s/iter; left time: 2715.6687s
	iters: 300, epoch: 33 | loss: 0.0006829
	speed: 0.0810s/iter; left time: 2558.8279s
	iters: 400, epoch: 33 | loss: 0.0028320
	speed: 0.0837s/iter; left time: 2634.4919s
Epoch: 33 cost time: 39.135769844055176
Epoch: 33, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0067272
	speed: 0.3087s/iter; left time: 9668.8545s
	iters: 200, epoch: 34 | loss: 0.0006268
	speed: 0.0825s/iter; left time: 2575.1255s
	iters: 300, epoch: 34 | loss: 0.0483064
	speed: 0.0863s/iter; left time: 2685.6869s
	iters: 400, epoch: 34 | loss: 0.0021357
	speed: 0.0927s/iter; left time: 2874.9509s
Epoch: 34 cost time: 39.75124263763428
Epoch: 34, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0210517
	speed: 0.3394s/iter; left time: 10470.8439s
	iters: 200, epoch: 35 | loss: 0.1089487
	speed: 0.0853s/iter; left time: 2623.9664s
	iters: 300, epoch: 35 | loss: 0.0029470
	speed: 0.0795s/iter; left time: 2437.0062s
	iters: 400, epoch: 35 | loss: 0.0028853
	speed: 0.0865s/iter; left time: 2641.9521s
Epoch: 35 cost time: 40.063499212265015
Epoch: 35, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0117290
	speed: 0.3376s/iter; left time: 10258.0390s
	iters: 200, epoch: 36 | loss: 0.1488953
	speed: 0.0868s/iter; left time: 2628.8915s
	iters: 300, epoch: 36 | loss: 0.0038657
	speed: 0.0859s/iter; left time: 2593.4419s
	iters: 400, epoch: 36 | loss: 0.0015352
	speed: 0.0877s/iter; left time: 2637.3818s
Epoch: 36 cost time: 41.999852418899536
Epoch: 36, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0012778
	speed: 0.3325s/iter; left time: 9948.1989s
	iters: 200, epoch: 37 | loss: 0.0007862
	speed: 0.0780s/iter; left time: 2325.9092s
	iters: 300, epoch: 37 | loss: 0.0035783
	speed: 0.0850s/iter; left time: 2526.8896s
	iters: 400, epoch: 37 | loss: 0.0006366
	speed: 0.0857s/iter; left time: 2537.3259s
Epoch: 37 cost time: 39.838783740997314
Epoch: 37, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0002996
	speed: 0.3337s/iter; left time: 9825.5237s
	iters: 200, epoch: 38 | loss: 0.0012177
	speed: 0.0921s/iter; left time: 2702.2801s
	iters: 300, epoch: 38 | loss: 0.0787461
	speed: 0.0885s/iter; left time: 2589.2104s
	iters: 400, epoch: 38 | loss: 0.2603601
	speed: 0.0835s/iter; left time: 2433.3978s
Epoch: 38 cost time: 40.401772022247314
Epoch: 38, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.955 Test Loss: 0.241 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0066133
	speed: 0.3075s/iter; left time: 8911.2315s
	iters: 200, epoch: 39 | loss: 0.0208007
	speed: 0.0851s/iter; left time: 2457.3824s
	iters: 300, epoch: 39 | loss: 0.0014697
	speed: 0.0883s/iter; left time: 2542.3058s
	iters: 400, epoch: 39 | loss: 0.0975921
	speed: 0.0837s/iter; left time: 2401.0416s
Epoch: 39 cost time: 39.58487391471863
Epoch: 39, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0009288
	speed: 0.3149s/iter; left time: 8976.8289s
	iters: 200, epoch: 40 | loss: 0.0008793
	speed: 0.0837s/iter; left time: 2377.9427s
	iters: 300, epoch: 40 | loss: 0.0034235
	speed: 0.0854s/iter; left time: 2417.8145s
	iters: 400, epoch: 40 | loss: 0.0023977
	speed: 0.0772s/iter; left time: 2177.1128s
Epoch: 40 cost time: 38.556315660476685
Epoch: 40, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.0026974
	speed: 0.3264s/iter; left time: 9151.7085s
	iters: 200, epoch: 41 | loss: 0.0033823
	speed: 0.0822s/iter; left time: 2298.1041s
	iters: 300, epoch: 41 | loss: 0.0076222
	speed: 0.0859s/iter; left time: 2390.8154s
	iters: 400, epoch: 41 | loss: 0.0011729
	speed: 0.0850s/iter; left time: 2358.9480s
Epoch: 41 cost time: 40.419612884521484
Epoch: 41, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.1152465
	speed: 0.3394s/iter; left time: 9356.6331s
	iters: 200, epoch: 42 | loss: 0.0027908
	speed: 0.0874s/iter; left time: 2400.7495s
	iters: 300, epoch: 42 | loss: 0.0104446
	speed: 0.0908s/iter; left time: 2485.4055s
	iters: 400, epoch: 42 | loss: 0.0009511
	speed: 0.0824s/iter; left time: 2247.6311s
Epoch: 42 cost time: 39.95957112312317
Epoch: 42, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.0175379
	speed: 0.3255s/iter; left time: 8821.9225s
	iters: 200, epoch: 43 | loss: 0.1074430
	speed: 0.0843s/iter; left time: 2277.3927s
	iters: 300, epoch: 43 | loss: 0.0037868
	speed: 0.0887s/iter; left time: 2386.2342s
	iters: 400, epoch: 43 | loss: 0.0011920
	speed: 0.0857s/iter; left time: 2296.1401s
Epoch: 43 cost time: 41.634292125701904
Epoch: 43, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 0.0044505
	speed: 0.3323s/iter; left time: 8849.6821s
	iters: 200, epoch: 44 | loss: 0.0047745
	speed: 0.0890s/iter; left time: 2360.7983s
	iters: 300, epoch: 44 | loss: 0.2119824
	speed: 0.0822s/iter; left time: 2171.9514s
	iters: 400, epoch: 44 | loss: 0.0392092
	speed: 0.0950s/iter; left time: 2502.8600s
Epoch: 44 cost time: 42.31807017326355
Epoch: 44, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.0010989
	speed: 0.3423s/iter; left time: 8955.6733s
	iters: 200, epoch: 45 | loss: 0.0008232
	speed: 0.0838s/iter; left time: 2182.9747s
	iters: 300, epoch: 45 | loss: 0.0003657
	speed: 0.0890s/iter; left time: 2310.0752s
	iters: 400, epoch: 45 | loss: 0.0001902
	speed: 0.0895s/iter; left time: 2314.6913s
Epoch: 45 cost time: 41.23443627357483
Epoch: 45, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 46 | loss: 0.0004618
	speed: 0.3511s/iter; left time: 9021.0576s
	iters: 200, epoch: 46 | loss: 0.0031793
	speed: 0.0983s/iter; left time: 2515.4492s
	iters: 300, epoch: 46 | loss: 0.0012738
	speed: 0.0993s/iter; left time: 2530.6307s
	iters: 400, epoch: 46 | loss: 0.0722379
	speed: 0.0872s/iter; left time: 2214.0937s
Epoch: 46 cost time: 44.72038984298706
Epoch: 46, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.963 Test Loss: 0.211 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 47 | loss: 0.0088404
	speed: 0.3484s/iter; left time: 8788.5938s
	iters: 200, epoch: 47 | loss: 0.0003968
	speed: 0.0906s/iter; left time: 2276.2550s
	iters: 300, epoch: 47 | loss: 0.0524226
	speed: 0.0796s/iter; left time: 1991.7442s
	iters: 400, epoch: 47 | loss: 0.0717989
	speed: 0.0859s/iter; left time: 2141.9117s
Epoch: 47 cost time: 40.05306315422058
Epoch: 47, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 910598
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8384563
	speed: 0.0990s/iter; left time: 4631.5353s
	iters: 200, epoch: 1 | loss: 0.8550346
	speed: 0.0756s/iter; left time: 3529.0834s
	iters: 300, epoch: 1 | loss: 0.1484372
	speed: 0.0727s/iter; left time: 3390.1781s
	iters: 400, epoch: 1 | loss: 0.2137792
	speed: 0.0807s/iter; left time: 3752.4761s
Epoch: 1 cost time: 38.154839754104614
Epoch: 1, Steps: 469 | Train Loss: 0.642 Vali Loss: 0.273 Vali Acc: 0.902 Test Loss: 0.273 Test Acc: 0.902
Validation loss decreased (inf --> -0.901941).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4778673
	speed: 0.3141s/iter; left time: 14555.0858s
	iters: 200, epoch: 2 | loss: 0.2853935
	speed: 0.0848s/iter; left time: 3920.9044s
	iters: 300, epoch: 2 | loss: 0.1407367
	speed: 0.0772s/iter; left time: 3563.2460s
	iters: 400, epoch: 2 | loss: 0.0926728
	speed: 0.0846s/iter; left time: 3892.1508s
Epoch: 2 cost time: 38.56889271736145
Epoch: 2, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (-0.901941 --> -0.946253).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0385867
	speed: 0.3002s/iter; left time: 13766.7815s
	iters: 200, epoch: 3 | loss: 0.0174375
	speed: 0.0829s/iter; left time: 3795.3018s
	iters: 300, epoch: 3 | loss: 0.2306815
	speed: 0.0840s/iter; left time: 3836.6575s
	iters: 400, epoch: 3 | loss: 0.0263349
	speed: 0.0821s/iter; left time: 3740.1932s
Epoch: 3 cost time: 38.21277976036072
Epoch: 3, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.244 Vali Acc: 0.936 Test Loss: 0.244 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0787457
	speed: 0.3356s/iter; left time: 15236.1116s
	iters: 200, epoch: 4 | loss: 0.2825551
	speed: 0.0815s/iter; left time: 3689.4084s
	iters: 300, epoch: 4 | loss: 0.4064703
	speed: 0.0910s/iter; left time: 4113.3691s
	iters: 400, epoch: 4 | loss: 0.1708013
	speed: 0.0888s/iter; left time: 4006.2127s
Epoch: 4 cost time: 40.457932233810425
Epoch: 4, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.248 Vali Acc: 0.924 Test Loss: 0.248 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4747150
	speed: 0.3155s/iter; left time: 14171.8148s
	iters: 200, epoch: 5 | loss: 0.0505254
	speed: 0.0797s/iter; left time: 3573.7286s
	iters: 300, epoch: 5 | loss: 0.0268738
	speed: 0.0874s/iter; left time: 3907.8752s
	iters: 400, epoch: 5 | loss: 0.0138367
	speed: 0.0861s/iter; left time: 3842.4816s
Epoch: 5 cost time: 40.666093587875366
Epoch: 5, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.946253 --> -0.950541).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2068262
	speed: 0.3269s/iter; left time: 14533.2113s
	iters: 200, epoch: 6 | loss: 0.2030832
	speed: 0.0836s/iter; left time: 3710.2631s
	iters: 300, epoch: 6 | loss: 0.1292489
	speed: 0.0902s/iter; left time: 3991.8921s
	iters: 400, epoch: 6 | loss: 0.2784839
	speed: 0.0741s/iter; left time: 3273.7439s
Epoch: 6 cost time: 38.406067848205566
Epoch: 6, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1682897
	speed: 0.3129s/iter; left time: 13762.7039s
	iters: 200, epoch: 7 | loss: 0.3269200
	speed: 0.0817s/iter; left time: 3587.0841s
	iters: 300, epoch: 7 | loss: 0.2838339
	speed: 0.0861s/iter; left time: 3771.6256s
	iters: 400, epoch: 7 | loss: 0.0247726
	speed: 0.0778s/iter; left time: 3398.8513s
Epoch: 7 cost time: 38.69166111946106
Epoch: 7, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0150707
	speed: 0.3092s/iter; left time: 13455.9166s
	iters: 200, epoch: 8 | loss: 0.0554726
	speed: 0.0751s/iter; left time: 3260.6087s
	iters: 300, epoch: 8 | loss: 0.1005379
	speed: 0.0761s/iter; left time: 3296.0084s
	iters: 400, epoch: 8 | loss: 0.0190795
	speed: 0.0754s/iter; left time: 3258.0991s
Epoch: 8 cost time: 36.14452767372131
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.266 Vali Acc: 0.923 Test Loss: 0.266 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1201438
	speed: 0.3205s/iter; left time: 13796.8402s
	iters: 200, epoch: 9 | loss: 0.1600231
	speed: 0.0889s/iter; left time: 3817.9284s
	iters: 300, epoch: 9 | loss: 0.0023195
	speed: 0.0812s/iter; left time: 3479.0590s
	iters: 400, epoch: 9 | loss: 0.0501057
	speed: 0.0860s/iter; left time: 3675.2960s
Epoch: 9 cost time: 39.45565629005432
Epoch: 9, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.282 Vali Acc: 0.929 Test Loss: 0.282 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3965071
	speed: 0.2794s/iter; left time: 11898.7520s
	iters: 200, epoch: 10 | loss: 0.3407013
	speed: 0.0777s/iter; left time: 3298.8354s
	iters: 300, epoch: 10 | loss: 0.0031105
	speed: 0.0831s/iter; left time: 3523.5454s
	iters: 400, epoch: 10 | loss: 0.0112412
	speed: 0.0811s/iter; left time: 3426.9614s
Epoch: 10 cost time: 38.17854285240173
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.228 Vali Acc: 0.949 Test Loss: 0.228 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0538029
	speed: 0.3293s/iter; left time: 13868.3717s
	iters: 200, epoch: 11 | loss: 0.0289673
	speed: 0.0775s/iter; left time: 3257.2361s
	iters: 300, epoch: 11 | loss: 0.3101692
	speed: 0.0841s/iter; left time: 3524.9469s
	iters: 400, epoch: 11 | loss: 0.0909030
	speed: 0.0778s/iter; left time: 3253.3566s
Epoch: 11 cost time: 37.75286865234375
Epoch: 11, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.221 Vali Acc: 0.955 Test Loss: 0.221 Test Acc: 0.955
Validation loss decreased (-0.950541 --> -0.955115).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2750542
	speed: 0.3014s/iter; left time: 12552.5413s
	iters: 200, epoch: 12 | loss: 0.0138402
	speed: 0.0789s/iter; left time: 3276.4254s
	iters: 300, epoch: 12 | loss: 0.0868265
	speed: 0.0744s/iter; left time: 3084.0926s
	iters: 400, epoch: 12 | loss: 0.1588397
	speed: 0.0794s/iter; left time: 3283.8836s
Epoch: 12 cost time: 37.24743723869324
Epoch: 12, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0178634
	speed: 0.2990s/iter; left time: 12311.5518s
	iters: 200, epoch: 13 | loss: 0.0011100
	speed: 0.0741s/iter; left time: 3041.6330s
	iters: 300, epoch: 13 | loss: 0.0930791
	speed: 0.0740s/iter; left time: 3033.1924s
	iters: 400, epoch: 13 | loss: 0.0234723
	speed: 0.0770s/iter; left time: 3147.0195s
Epoch: 13 cost time: 35.929078817367554
Epoch: 13, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0013082
	speed: 0.3109s/iter; left time: 12653.4382s
	iters: 200, epoch: 14 | loss: 0.0016740
	speed: 0.0838s/iter; left time: 3404.3444s
	iters: 300, epoch: 14 | loss: 0.4863923
	speed: 0.0824s/iter; left time: 3336.3704s
	iters: 400, epoch: 14 | loss: 0.0011217
	speed: 0.0860s/iter; left time: 3473.7792s
Epoch: 14 cost time: 39.99076795578003
Epoch: 14, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955115 --> -0.955973).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0317996
	speed: 0.3391s/iter; left time: 13644.6342s
	iters: 200, epoch: 15 | loss: 0.0327976
	speed: 0.0787s/iter; left time: 3160.1392s
	iters: 300, epoch: 15 | loss: 0.2253560
	speed: 0.0808s/iter; left time: 3233.1280s
	iters: 400, epoch: 15 | loss: 0.0093153
	speed: 0.0855s/iter; left time: 3413.3729s
Epoch: 15 cost time: 38.84068965911865
Epoch: 15, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.251 Vali Acc: 0.949 Test Loss: 0.251 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0171829
	speed: 0.3223s/iter; left time: 12816.3618s
	iters: 200, epoch: 16 | loss: 0.0064810
	speed: 0.0787s/iter; left time: 3122.3623s
	iters: 300, epoch: 16 | loss: 0.2514801
	speed: 0.0782s/iter; left time: 3094.7420s
	iters: 400, epoch: 16 | loss: 0.0328747
	speed: 0.0815s/iter; left time: 3216.0534s
Epoch: 16 cost time: 38.11103129386902
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0026173
	speed: 0.3093s/iter; left time: 12153.9450s
	iters: 200, epoch: 17 | loss: 0.0010311
	speed: 0.0794s/iter; left time: 3113.2252s
	iters: 300, epoch: 17 | loss: 0.0049016
	speed: 0.0759s/iter; left time: 2967.0998s
	iters: 400, epoch: 17 | loss: 0.0245353
	speed: 0.0736s/iter; left time: 2871.1050s
Epoch: 17 cost time: 36.60466718673706
Epoch: 17, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
Validation loss decreased (-0.955973 --> -0.960261).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0141343
	speed: 0.3144s/iter; left time: 12208.0974s
	iters: 200, epoch: 18 | loss: 0.0231804
	speed: 0.0743s/iter; left time: 2878.8561s
	iters: 300, epoch: 18 | loss: 0.4926487
	speed: 0.0800s/iter; left time: 3090.2730s
	iters: 400, epoch: 18 | loss: 0.0310845
	speed: 0.0783s/iter; left time: 3015.7714s
Epoch: 18 cost time: 36.75994348526001
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0104914
	speed: 0.2986s/iter; left time: 11453.2410s
	iters: 200, epoch: 19 | loss: 0.1933650
	speed: 0.0789s/iter; left time: 3019.7988s
	iters: 300, epoch: 19 | loss: 0.0652852
	speed: 0.0757s/iter; left time: 2889.5491s
	iters: 400, epoch: 19 | loss: 0.0027074
	speed: 0.0706s/iter; left time: 2688.5526s
Epoch: 19 cost time: 36.35069131851196
Epoch: 19, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
Validation loss decreased (-0.960261 --> -0.967980).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1191548
	speed: 0.2980s/iter; left time: 11289.7221s
	iters: 200, epoch: 20 | loss: 0.0637315
	speed: 0.0739s/iter; left time: 2794.4012s
	iters: 300, epoch: 20 | loss: 0.4783170
	speed: 0.0775s/iter; left time: 2922.3910s
	iters: 400, epoch: 20 | loss: 0.0692542
	speed: 0.0706s/iter; left time: 2652.0589s
Epoch: 20 cost time: 36.06949758529663
Epoch: 20, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0750538
	speed: 0.3138s/iter; left time: 11742.7320s
	iters: 200, epoch: 21 | loss: 0.0054189
	speed: 0.0776s/iter; left time: 2896.0904s
	iters: 300, epoch: 21 | loss: 0.0003494
	speed: 0.0798s/iter; left time: 2969.3707s
	iters: 400, epoch: 21 | loss: 0.0064886
	speed: 0.0770s/iter; left time: 2858.9614s
Epoch: 21 cost time: 37.620280027389526
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0236331
	speed: 0.3146s/iter; left time: 11626.7090s
	iters: 200, epoch: 22 | loss: 0.2191159
	speed: 0.0812s/iter; left time: 2990.5951s
	iters: 300, epoch: 22 | loss: 0.0012978
	speed: 0.0861s/iter; left time: 3165.6545s
	iters: 400, epoch: 22 | loss: 0.0070203
	speed: 0.0916s/iter; left time: 3355.5650s
Epoch: 22 cost time: 40.032063007354736
Epoch: 22, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1191192
	speed: 0.3134s/iter; left time: 11435.2136s
	iters: 200, epoch: 23 | loss: 0.0187753
	speed: 0.0747s/iter; left time: 2717.4174s
	iters: 300, epoch: 23 | loss: 0.0553556
	speed: 0.0677s/iter; left time: 2457.5360s
	iters: 400, epoch: 23 | loss: 0.0045901
	speed: 0.0735s/iter; left time: 2659.5819s
Epoch: 23 cost time: 35.60401225090027
Epoch: 23, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0281504
	speed: 0.3083s/iter; left time: 11102.0499s
	iters: 200, epoch: 24 | loss: 0.0062314
	speed: 0.0786s/iter; left time: 2823.8680s
	iters: 300, epoch: 24 | loss: 0.0017984
	speed: 0.0827s/iter; left time: 2960.1714s
	iters: 400, epoch: 24 | loss: 0.0101465
	speed: 0.0821s/iter; left time: 2932.4858s
Epoch: 24 cost time: 37.782156467437744
Epoch: 24, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.954 Test Loss: 0.237 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0108992
	speed: 0.3078s/iter; left time: 10939.5586s
	iters: 200, epoch: 25 | loss: 0.0400068
	speed: 0.0727s/iter; left time: 2576.1478s
	iters: 300, epoch: 25 | loss: 0.0719714
	speed: 0.0731s/iter; left time: 2581.9543s
	iters: 400, epoch: 25 | loss: 0.4217268
	speed: 0.0740s/iter; left time: 2607.0539s
Epoch: 25 cost time: 34.823026180267334
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0458081
	speed: 0.2996s/iter; left time: 10510.3552s
	iters: 200, epoch: 26 | loss: 0.0065183
	speed: 0.0818s/iter; left time: 2861.7230s
	iters: 300, epoch: 26 | loss: 0.0029834
	speed: 0.0789s/iter; left time: 2752.9297s
	iters: 400, epoch: 26 | loss: 0.0018536
	speed: 0.0827s/iter; left time: 2877.6572s
Epoch: 26 cost time: 38.31134533882141
Epoch: 26, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1290301
	speed: 0.3246s/iter; left time: 11233.0748s
	iters: 200, epoch: 27 | loss: 0.0424106
	speed: 0.0799s/iter; left time: 2758.4693s
	iters: 300, epoch: 27 | loss: 0.0020218
	speed: 0.0746s/iter; left time: 2565.1632s
	iters: 400, epoch: 27 | loss: 0.0505852
	speed: 0.0764s/iter; left time: 2622.4231s
Epoch: 27 cost time: 36.68847441673279
Epoch: 27, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.192 Vali Acc: 0.961 Test Loss: 0.192 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0012148
	speed: 0.3110s/iter; left time: 10617.7447s
	iters: 200, epoch: 28 | loss: 0.4164480
	speed: 0.0798s/iter; left time: 2715.4261s
	iters: 300, epoch: 28 | loss: 0.0014791
	speed: 0.0808s/iter; left time: 2742.8068s
	iters: 400, epoch: 28 | loss: 0.0080614
	speed: 0.0746s/iter; left time: 2525.0478s
Epoch: 28 cost time: 37.882691860198975
Epoch: 28, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0005895
	speed: 0.3052s/iter; left time: 10274.6791s
	iters: 200, epoch: 29 | loss: 0.2706219
	speed: 0.0734s/iter; left time: 2463.7831s
	iters: 300, epoch: 29 | loss: 0.2436728
	speed: 0.0775s/iter; left time: 2595.2948s
	iters: 400, epoch: 29 | loss: 0.0009382
	speed: 0.0737s/iter; left time: 2460.3749s
Epoch: 29 cost time: 35.54505443572998
Epoch: 29, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9679817038307604
model parameter : 910342
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0021447
	speed: 0.1030s/iter; left time: 4822.4270s
	iters: 200, epoch: 1 | loss: 0.8275102
	speed: 0.0831s/iter; left time: 3882.7723s
	iters: 300, epoch: 1 | loss: 0.4293674
	speed: 0.0760s/iter; left time: 3541.8222s
	iters: 400, epoch: 1 | loss: 0.1811279
	speed: 0.0757s/iter; left time: 3520.9565s
Epoch: 1 cost time: 39.17202615737915
Epoch: 1, Steps: 469 | Train Loss: 0.669 Vali Loss: 0.329 Vali Acc: 0.905 Test Loss: 0.329 Test Acc: 0.905
Validation loss decreased (inf --> -0.904799).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2414425
	speed: 0.3103s/iter; left time: 14375.3558s
	iters: 200, epoch: 2 | loss: 0.3492860
	speed: 0.0805s/iter; left time: 3719.8567s
	iters: 300, epoch: 2 | loss: 0.1514726
	speed: 0.0822s/iter; left time: 3792.5954s
	iters: 400, epoch: 2 | loss: 0.2409062
	speed: 0.0896s/iter; left time: 4124.7755s
Epoch: 2 cost time: 38.78607940673828
Epoch: 2, Steps: 469 | Train Loss: 0.186 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
Validation loss decreased (-0.904799 --> -0.934818).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0546234
	speed: 0.3276s/iter; left time: 15026.4937s
	iters: 200, epoch: 3 | loss: 0.0583313
	speed: 0.0804s/iter; left time: 3677.4887s
	iters: 300, epoch: 3 | loss: 0.1540253
	speed: 0.0781s/iter; left time: 3567.9854s
	iters: 400, epoch: 3 | loss: 0.2625650
	speed: 0.0815s/iter; left time: 3712.5996s
Epoch: 3 cost time: 37.96183109283447
Epoch: 3, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0116661
	speed: 0.3250s/iter; left time: 14754.4250s
	iters: 200, epoch: 4 | loss: 0.1295766
	speed: 0.0772s/iter; left time: 3495.9555s
	iters: 300, epoch: 4 | loss: 0.1427209
	speed: 0.0800s/iter; left time: 3613.6823s
	iters: 400, epoch: 4 | loss: 0.2885942
	speed: 0.0796s/iter; left time: 3587.6641s
Epoch: 4 cost time: 38.74741816520691
Epoch: 4, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.934818 --> -0.950541).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1767531
	speed: 0.3098s/iter; left time: 13916.3949s
	iters: 200, epoch: 5 | loss: 0.0888881
	speed: 0.0809s/iter; left time: 3624.5689s
	iters: 300, epoch: 5 | loss: 0.0356769
	speed: 0.0802s/iter; left time: 3584.7227s
	iters: 400, epoch: 5 | loss: 0.1052201
	speed: 0.0755s/iter; left time: 3367.9647s
Epoch: 5 cost time: 37.42963647842407
Epoch: 5, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
Validation loss decreased (-0.950541 --> -0.957975).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0042801
	speed: 0.3078s/iter; left time: 13685.6573s
	iters: 200, epoch: 6 | loss: 0.0317765
	speed: 0.0779s/iter; left time: 3453.4794s
	iters: 300, epoch: 6 | loss: 0.0114889
	speed: 0.0850s/iter; left time: 3760.2062s
	iters: 400, epoch: 6 | loss: 0.1072146
	speed: 0.0756s/iter; left time: 3339.5795s
Epoch: 6 cost time: 37.07129788398743
Epoch: 6, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.199 Vali Acc: 0.945 Test Loss: 0.199 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0242391
	speed: 0.3032s/iter; left time: 13337.0809s
	iters: 200, epoch: 7 | loss: 0.0388361
	speed: 0.0808s/iter; left time: 3547.3419s
	iters: 300, epoch: 7 | loss: 0.1620397
	speed: 0.0778s/iter; left time: 3408.5213s
	iters: 400, epoch: 7 | loss: 0.1330214
	speed: 0.0881s/iter; left time: 3847.7568s
Epoch: 7 cost time: 39.43596696853638
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.324 Vali Acc: 0.921 Test Loss: 0.324 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0046693
	speed: 0.3110s/iter; left time: 13533.2387s
	iters: 200, epoch: 8 | loss: 0.1884205
	speed: 0.0785s/iter; left time: 3407.9103s
	iters: 300, epoch: 8 | loss: 0.0436258
	speed: 0.0820s/iter; left time: 3552.6421s
	iters: 400, epoch: 8 | loss: 0.0021565
	speed: 0.0869s/iter; left time: 3754.2326s
Epoch: 8 cost time: 38.81418466567993
Epoch: 8, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0058057
	speed: 0.3522s/iter; left time: 15160.4212s
	iters: 200, epoch: 9 | loss: 0.2900068
	speed: 0.0882s/iter; left time: 3789.6795s
	iters: 300, epoch: 9 | loss: 0.0795526
	speed: 0.0872s/iter; left time: 3737.5918s
	iters: 400, epoch: 9 | loss: 0.7125452
	speed: 0.0934s/iter; left time: 3991.9465s
Epoch: 9 cost time: 43.484986782073975
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0253164
	speed: 0.3117s/iter; left time: 13271.4017s
	iters: 200, epoch: 10 | loss: 0.0621822
	speed: 0.0870s/iter; left time: 3695.4608s
	iters: 300, epoch: 10 | loss: 0.1441423
	speed: 0.0915s/iter; left time: 3877.8155s
	iters: 400, epoch: 10 | loss: 0.1182412
	speed: 0.0873s/iter; left time: 3691.8004s
Epoch: 10 cost time: 40.55220127105713
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0556246
	speed: 0.3271s/iter; left time: 13773.6886s
	iters: 200, epoch: 11 | loss: 0.0375805
	speed: 0.0859s/iter; left time: 3608.4362s
	iters: 300, epoch: 11 | loss: 0.0038988
	speed: 0.0860s/iter; left time: 3605.7608s
	iters: 400, epoch: 11 | loss: 0.0240519
	speed: 0.0803s/iter; left time: 3357.5087s
Epoch: 11 cost time: 39.616026878356934
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0367892
	speed: 0.2841s/iter; left time: 11829.0879s
	iters: 200, epoch: 12 | loss: 0.2540960
	speed: 0.0799s/iter; left time: 3319.3538s
	iters: 300, epoch: 12 | loss: 0.1669424
	speed: 0.0838s/iter; left time: 3474.3946s
	iters: 400, epoch: 12 | loss: 0.1940915
	speed: 0.0759s/iter; left time: 3139.0255s
Epoch: 12 cost time: 37.65177297592163
Epoch: 12, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.957975 --> -0.968838).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0119749
	speed: 0.3214s/iter; left time: 13231.4617s
	iters: 200, epoch: 13 | loss: 0.0743255
	speed: 0.0774s/iter; left time: 3178.3417s
	iters: 300, epoch: 13 | loss: 0.1488059
	speed: 0.0800s/iter; left time: 3278.1962s
	iters: 400, epoch: 13 | loss: 0.0068138
	speed: 0.0855s/iter; left time: 3496.5035s
Epoch: 13 cost time: 39.08118176460266
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0058242
	speed: 0.3352s/iter; left time: 13645.8363s
	iters: 200, epoch: 14 | loss: 0.0042306
	speed: 0.0863s/iter; left time: 3502.4440s
	iters: 300, epoch: 14 | loss: 0.0079654
	speed: 0.0829s/iter; left time: 3356.3628s
	iters: 400, epoch: 14 | loss: 0.0042640
	speed: 0.0810s/iter; left time: 3273.3091s
Epoch: 14 cost time: 40.58227872848511
Epoch: 14, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0170665
	speed: 0.3075s/iter; left time: 12373.4038s
	iters: 200, epoch: 15 | loss: 0.0049123
	speed: 0.0863s/iter; left time: 3463.8428s
	iters: 300, epoch: 15 | loss: 0.0012289
	speed: 0.0810s/iter; left time: 3244.2501s
	iters: 400, epoch: 15 | loss: 0.4788137
	speed: 0.0837s/iter; left time: 3342.7520s
Epoch: 15 cost time: 38.66823410987854
Epoch: 15, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3338509
	speed: 0.3168s/iter; left time: 12595.9014s
	iters: 200, epoch: 16 | loss: 0.0267072
	speed: 0.0754s/iter; left time: 2988.9888s
	iters: 300, epoch: 16 | loss: 0.0102325
	speed: 0.0775s/iter; left time: 3064.8604s
	iters: 400, epoch: 16 | loss: 0.0025598
	speed: 0.0821s/iter; left time: 3241.4303s
Epoch: 16 cost time: 37.20850872993469
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969410).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0133812
	speed: 0.3137s/iter; left time: 12327.7595s
	iters: 200, epoch: 17 | loss: 0.0208882
	speed: 0.0781s/iter; left time: 3061.0235s
	iters: 300, epoch: 17 | loss: 0.0483287
	speed: 0.0919s/iter; left time: 3592.0171s
	iters: 400, epoch: 17 | loss: 0.0138731
	speed: 0.0840s/iter; left time: 3275.1735s
Epoch: 17 cost time: 40.02898073196411
Epoch: 17, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0009431
	speed: 0.3080s/iter; left time: 11959.4544s
	iters: 200, epoch: 18 | loss: 0.0115724
	speed: 0.0751s/iter; left time: 2906.6272s
	iters: 300, epoch: 18 | loss: 0.0151481
	speed: 0.0874s/iter; left time: 3375.1617s
	iters: 400, epoch: 18 | loss: 0.0043911
	speed: 0.0860s/iter; left time: 3311.7434s
Epoch: 18 cost time: 39.509968519210815
Epoch: 18, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.969410 --> -0.976843).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1152347
	speed: 0.3226s/iter; left time: 12375.5115s
	iters: 200, epoch: 19 | loss: 0.0029716
	speed: 0.0857s/iter; left time: 3280.6770s
	iters: 300, epoch: 19 | loss: 0.0306510
	speed: 0.0852s/iter; left time: 3250.1033s
	iters: 400, epoch: 19 | loss: 0.0035964
	speed: 0.0789s/iter; left time: 3003.9310s
Epoch: 19 cost time: 38.72117209434509
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0093718
	speed: 0.3000s/iter; left time: 11366.1132s
	iters: 200, epoch: 20 | loss: 0.1231720
	speed: 0.0789s/iter; left time: 2980.8666s
	iters: 300, epoch: 20 | loss: 0.4198303
	speed: 0.0801s/iter; left time: 3017.8181s
	iters: 400, epoch: 20 | loss: 0.1049272
	speed: 0.0777s/iter; left time: 2921.9483s
Epoch: 20 cost time: 37.31167459487915
Epoch: 20, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0014253
	speed: 0.3033s/iter; left time: 11349.8606s
	iters: 200, epoch: 21 | loss: 0.0218120
	speed: 0.0768s/iter; left time: 2866.4469s
	iters: 300, epoch: 21 | loss: 0.1375814
	speed: 0.0741s/iter; left time: 2759.0759s
	iters: 400, epoch: 21 | loss: 0.2051806
	speed: 0.0746s/iter; left time: 2770.2124s
Epoch: 21 cost time: 36.18729114532471
Epoch: 21, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.244 Vali Acc: 0.934 Test Loss: 0.244 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0112264
	speed: 0.2960s/iter; left time: 10938.0800s
	iters: 200, epoch: 22 | loss: 0.0024374
	speed: 0.0815s/iter; left time: 3004.0446s
	iters: 300, epoch: 22 | loss: 0.0158656
	speed: 0.0743s/iter; left time: 2732.2997s
	iters: 400, epoch: 22 | loss: 0.0007850
	speed: 0.0732s/iter; left time: 2681.8514s
Epoch: 22 cost time: 36.95068955421448
Epoch: 22, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0090632
	speed: 0.2913s/iter; left time: 10627.5351s
	iters: 200, epoch: 23 | loss: 0.0238774
	speed: 0.0788s/iter; left time: 2865.6957s
	iters: 300, epoch: 23 | loss: 0.0057201
	speed: 0.0826s/iter; left time: 2996.5699s
	iters: 400, epoch: 23 | loss: 0.0092015
	speed: 0.0815s/iter; left time: 2950.6075s
Epoch: 23 cost time: 37.837995529174805
Epoch: 23, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0216339
	speed: 0.3143s/iter; left time: 11318.4607s
	iters: 200, epoch: 24 | loss: 0.0370260
	speed: 0.0804s/iter; left time: 2887.2874s
	iters: 300, epoch: 24 | loss: 0.0016259
	speed: 0.0787s/iter; left time: 2819.8059s
	iters: 400, epoch: 24 | loss: 0.0014290
	speed: 0.0779s/iter; left time: 2782.9798s
Epoch: 24 cost time: 37.93517231941223
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0095670
	speed: 0.3077s/iter; left time: 10938.2657s
	iters: 200, epoch: 25 | loss: 0.0039700
	speed: 0.0826s/iter; left time: 2929.1649s
	iters: 300, epoch: 25 | loss: 0.0986924
	speed: 0.0797s/iter; left time: 2816.6266s
	iters: 400, epoch: 25 | loss: 0.1815432
	speed: 0.0695s/iter; left time: 2448.6039s
Epoch: 25 cost time: 36.57719349861145
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0034743
	speed: 0.2843s/iter; left time: 9973.2161s
	iters: 200, epoch: 26 | loss: 0.0033099
	speed: 0.0735s/iter; left time: 2571.6912s
	iters: 300, epoch: 26 | loss: 0.2779391
	speed: 0.0686s/iter; left time: 2392.4175s
	iters: 400, epoch: 26 | loss: 0.0030998
	speed: 0.0727s/iter; left time: 2527.9860s
Epoch: 26 cost time: 35.127277135849
Epoch: 26, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0580878
	speed: 0.2982s/iter; left time: 10321.2278s
	iters: 200, epoch: 27 | loss: 0.0006739
	speed: 0.0783s/iter; left time: 2701.5441s
	iters: 300, epoch: 27 | loss: 0.0054872
	speed: 0.0797s/iter; left time: 2742.4872s
	iters: 400, epoch: 27 | loss: 0.0023862
	speed: 0.0796s/iter; left time: 2732.5137s
Epoch: 27 cost time: 36.78784799575806
Epoch: 27, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0003656
	speed: 0.2861s/iter; left time: 9767.0046s
	iters: 200, epoch: 28 | loss: 0.0012865
	speed: 0.0757s/iter; left time: 2576.5395s
	iters: 300, epoch: 28 | loss: 0.0253986
	speed: 0.0746s/iter; left time: 2533.2477s
	iters: 400, epoch: 28 | loss: 0.0006532
	speed: 0.0771s/iter; left time: 2608.9556s
Epoch: 28 cost time: 35.72527265548706
Epoch: 28, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 762502
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4801289
	speed: 0.1044s/iter; left time: 4886.7168s
	iters: 200, epoch: 1 | loss: 0.3612285
	speed: 0.0862s/iter; left time: 4026.2561s
	iters: 300, epoch: 1 | loss: 0.3025797
	speed: 0.0782s/iter; left time: 3643.9674s
	iters: 400, epoch: 1 | loss: 0.3373186
	speed: 0.0765s/iter; left time: 3555.0060s
Epoch: 1 cost time: 40.087833881378174
Epoch: 1, Steps: 469 | Train Loss: 0.690 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (inf --> -0.930244).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1871868
	speed: 0.3294s/iter; left time: 15260.2109s
	iters: 200, epoch: 2 | loss: 0.1711984
	speed: 0.0762s/iter; left time: 3524.9521s
	iters: 300, epoch: 2 | loss: 0.1242975
	speed: 0.0813s/iter; left time: 3750.8342s
	iters: 400, epoch: 2 | loss: 0.0582645
	speed: 0.0786s/iter; left time: 3618.2064s
Epoch: 2 cost time: 37.845744609832764
Epoch: 2, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.235 Vali Acc: 0.934 Test Loss: 0.235 Test Acc: 0.934
Validation loss decreased (-0.930244 --> -0.933960).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0248258
	speed: 0.2920s/iter; left time: 13394.0961s
	iters: 200, epoch: 3 | loss: 0.0180192
	speed: 0.0721s/iter; left time: 3300.3788s
	iters: 300, epoch: 3 | loss: 0.0655953
	speed: 0.0752s/iter; left time: 3432.5337s
	iters: 400, epoch: 3 | loss: 0.0431441
	speed: 0.0781s/iter; left time: 3558.1080s
Epoch: 3 cost time: 36.190168142318726
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.933960 --> -0.950827).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0250674
	speed: 0.3124s/iter; left time: 14179.3899s
	iters: 200, epoch: 4 | loss: 0.1115370
	speed: 0.0769s/iter; left time: 3481.0978s
	iters: 300, epoch: 4 | loss: 0.0733139
	speed: 0.0705s/iter; left time: 3185.5160s
	iters: 400, epoch: 4 | loss: 0.6105551
	speed: 0.0720s/iter; left time: 3245.8236s
Epoch: 4 cost time: 35.489951610565186
Epoch: 4, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0092983
	speed: 0.3027s/iter; left time: 13597.4148s
	iters: 200, epoch: 5 | loss: 0.0536997
	speed: 0.0778s/iter; left time: 3485.9867s
	iters: 300, epoch: 5 | loss: 0.0962818
	speed: 0.0748s/iter; left time: 3343.4529s
	iters: 400, epoch: 5 | loss: 0.0368152
	speed: 0.0770s/iter; left time: 3435.2764s
Epoch: 5 cost time: 36.68954658508301
Epoch: 5, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0099843
	speed: 0.3224s/iter; left time: 14333.0551s
	iters: 200, epoch: 6 | loss: 0.0031593
	speed: 0.0826s/iter; left time: 3665.8670s
	iters: 300, epoch: 6 | loss: 0.0766347
	speed: 0.0776s/iter; left time: 3434.5721s
	iters: 400, epoch: 6 | loss: 0.0075829
	speed: 0.0819s/iter; left time: 3614.6375s
Epoch: 6 cost time: 38.17880463600159
Epoch: 6, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
Validation loss decreased (-0.950827 --> -0.954830).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0349520
	speed: 0.3236s/iter; left time: 14234.6612s
	iters: 200, epoch: 7 | loss: 0.0166359
	speed: 0.0845s/iter; left time: 3710.1326s
	iters: 300, epoch: 7 | loss: 0.3070050
	speed: 0.0845s/iter; left time: 3699.8451s
	iters: 400, epoch: 7 | loss: 0.0510960
	speed: 0.0797s/iter; left time: 3483.0983s
Epoch: 7 cost time: 39.088425159454346
Epoch: 7, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.954830 --> -0.959976).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3663799
	speed: 0.2885s/iter; left time: 12554.0679s
	iters: 200, epoch: 8 | loss: 0.0091227
	speed: 0.0744s/iter; left time: 3230.2990s
	iters: 300, epoch: 8 | loss: 0.0312890
	speed: 0.0809s/iter; left time: 3506.3645s
	iters: 400, epoch: 8 | loss: 0.0029941
	speed: 0.0819s/iter; left time: 3540.0367s
Epoch: 8 cost time: 36.395519971847534
Epoch: 8, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0043369
	speed: 0.2930s/iter; left time: 12612.9841s
	iters: 200, epoch: 9 | loss: 0.0229244
	speed: 0.0725s/iter; left time: 3113.8651s
	iters: 300, epoch: 9 | loss: 0.1762293
	speed: 0.0717s/iter; left time: 3071.9029s
	iters: 400, epoch: 9 | loss: 0.3478673
	speed: 0.0757s/iter; left time: 3238.2058s
Epoch: 9 cost time: 35.533620834350586
Epoch: 9, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0150902
	speed: 0.2715s/iter; left time: 11560.7664s
	iters: 200, epoch: 10 | loss: 0.0018570
	speed: 0.0772s/iter; left time: 3278.2518s
	iters: 300, epoch: 10 | loss: 0.1177054
	speed: 0.0722s/iter; left time: 3059.9473s
	iters: 400, epoch: 10 | loss: 0.1000822
	speed: 0.0728s/iter; left time: 3075.9646s
Epoch: 10 cost time: 34.905784368515015
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.959976 --> -0.961977).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1086755
	speed: 0.2989s/iter; left time: 12588.0630s
	iters: 200, epoch: 11 | loss: 0.0138201
	speed: 0.0833s/iter; left time: 3498.9037s
	iters: 300, epoch: 11 | loss: 0.0634288
	speed: 0.0815s/iter; left time: 3415.8220s
	iters: 400, epoch: 11 | loss: 0.0963048
	speed: 0.0775s/iter; left time: 3241.9674s
Epoch: 11 cost time: 37.97754740715027
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.233 Vali Acc: 0.940 Test Loss: 0.233 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0706883
	speed: 0.2966s/iter; left time: 12351.9910s
	iters: 200, epoch: 12 | loss: 0.0295446
	speed: 0.0824s/iter; left time: 3424.2235s
	iters: 300, epoch: 12 | loss: 0.0280611
	speed: 0.0866s/iter; left time: 3588.5531s
	iters: 400, epoch: 12 | loss: 0.0028712
	speed: 0.0846s/iter; left time: 3496.5928s
Epoch: 12 cost time: 39.87677311897278
Epoch: 12, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0009998
	speed: 0.3058s/iter; left time: 12590.9291s
	iters: 200, epoch: 13 | loss: 0.0912132
	speed: 0.0751s/iter; left time: 3083.0099s
	iters: 300, epoch: 13 | loss: 0.5530369
	speed: 0.0766s/iter; left time: 3138.9212s
	iters: 400, epoch: 13 | loss: 0.5081462
	speed: 0.0802s/iter; left time: 3279.0441s
Epoch: 13 cost time: 35.97971200942993
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.961977 --> -0.963120).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0411008
	speed: 0.2839s/iter; left time: 11556.9443s
	iters: 200, epoch: 14 | loss: 0.0014219
	speed: 0.0815s/iter; left time: 3310.1322s
	iters: 300, epoch: 14 | loss: 0.1789445
	speed: 0.0801s/iter; left time: 3243.6023s
	iters: 400, epoch: 14 | loss: 0.0116610
	speed: 0.0768s/iter; left time: 3104.4846s
Epoch: 14 cost time: 37.70425271987915
Epoch: 14, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0089071
	speed: 0.2915s/iter; left time: 11730.2083s
	iters: 200, epoch: 15 | loss: 0.0068654
	speed: 0.0814s/iter; left time: 3266.2486s
	iters: 300, epoch: 15 | loss: 0.0019553
	speed: 0.0752s/iter; left time: 3010.1519s
	iters: 400, epoch: 15 | loss: 0.0106307
	speed: 0.0718s/iter; left time: 2867.5507s
Epoch: 15 cost time: 36.5960636138916
Epoch: 15, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.963120 --> -0.963692).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6365062
	speed: 0.3058s/iter; left time: 12161.0744s
	iters: 200, epoch: 16 | loss: 0.0297202
	speed: 0.0854s/iter; left time: 3385.8786s
	iters: 300, epoch: 16 | loss: 0.0493740
	speed: 0.0810s/iter; left time: 3204.6610s
	iters: 400, epoch: 16 | loss: 0.0018566
	speed: 0.0793s/iter; left time: 3127.9122s
Epoch: 16 cost time: 38.952045917510986
Epoch: 16, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
Validation loss decreased (-0.963692 --> -0.970839).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0014909
	speed: 0.3149s/iter; left time: 12374.0650s
	iters: 200, epoch: 17 | loss: 0.0375882
	speed: 0.0760s/iter; left time: 2979.8860s
	iters: 300, epoch: 17 | loss: 0.0042756
	speed: 0.0855s/iter; left time: 3342.0952s
	iters: 400, epoch: 17 | loss: 0.0116290
	speed: 0.0827s/iter; left time: 3223.1736s
Epoch: 17 cost time: 38.573429107666016
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3957116
	speed: 0.3070s/iter; left time: 11920.9612s
	iters: 200, epoch: 18 | loss: 0.0879782
	speed: 0.0751s/iter; left time: 2910.2248s
	iters: 300, epoch: 18 | loss: 0.0098392
	speed: 0.0784s/iter; left time: 3029.0744s
	iters: 400, epoch: 18 | loss: 0.0012543
	speed: 0.0768s/iter; left time: 2960.4355s
Epoch: 18 cost time: 37.0518901348114
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.973126).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0162877
	speed: 0.2807s/iter; left time: 10766.4639s
	iters: 200, epoch: 19 | loss: 0.0104577
	speed: 0.0741s/iter; left time: 2836.1931s
	iters: 300, epoch: 19 | loss: 0.3065912
	speed: 0.0823s/iter; left time: 3139.7925s
	iters: 400, epoch: 19 | loss: 0.2571714
	speed: 0.0834s/iter; left time: 3173.1089s
Epoch: 19 cost time: 37.57271599769592
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0009556
	speed: 0.2898s/iter; left time: 10979.7200s
	iters: 200, epoch: 20 | loss: 0.0034443
	speed: 0.0770s/iter; left time: 2910.6013s
	iters: 300, epoch: 20 | loss: 0.0005400
	speed: 0.0774s/iter; left time: 2917.9291s
	iters: 400, epoch: 20 | loss: 0.0059495
	speed: 0.0730s/iter; left time: 2744.3291s
Epoch: 20 cost time: 36.53080129623413
Epoch: 20, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.214 Vali Acc: 0.954 Test Loss: 0.214 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0012586
	speed: 0.3094s/iter; left time: 11578.2227s
	iters: 200, epoch: 21 | loss: 0.0043626
	speed: 0.0840s/iter; left time: 3133.1712s
	iters: 300, epoch: 21 | loss: 0.0041155
	speed: 0.0786s/iter; left time: 2925.8301s
	iters: 400, epoch: 21 | loss: 0.0020784
	speed: 0.0794s/iter; left time: 2948.0913s
Epoch: 21 cost time: 38.15498471260071
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0013336
	speed: 0.3042s/iter; left time: 11242.1157s
	iters: 200, epoch: 22 | loss: 0.0045290
	speed: 0.0752s/iter; left time: 2770.6509s
	iters: 300, epoch: 22 | loss: 0.0126512
	speed: 0.0784s/iter; left time: 2881.7913s
	iters: 400, epoch: 22 | loss: 0.3590610
	speed: 0.0787s/iter; left time: 2885.4617s
Epoch: 22 cost time: 37.36918258666992
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0060330
	speed: 0.3070s/iter; left time: 11198.4831s
	iters: 200, epoch: 23 | loss: 0.0178779
	speed: 0.0769s/iter; left time: 2799.3904s
	iters: 300, epoch: 23 | loss: 0.0023297
	speed: 0.0781s/iter; left time: 2832.7275s
	iters: 400, epoch: 23 | loss: 0.1465094
	speed: 0.0804s/iter; left time: 2908.1855s
Epoch: 23 cost time: 36.63292360305786
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1063646
	speed: 0.2724s/iter; left time: 9811.9698s
	iters: 200, epoch: 24 | loss: 0.5363816
	speed: 0.0795s/iter; left time: 2854.6426s
	iters: 300, epoch: 24 | loss: 0.0622201
	speed: 0.0778s/iter; left time: 2787.5021s
	iters: 400, epoch: 24 | loss: 0.0010463
	speed: 0.0816s/iter; left time: 2914.8288s
Epoch: 24 cost time: 37.77502155303955
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0008173
	speed: 0.2993s/iter; left time: 10638.3198s
	iters: 200, epoch: 25 | loss: 0.0027165
	speed: 0.0790s/iter; left time: 2799.9119s
	iters: 300, epoch: 25 | loss: 0.0013977
	speed: 0.0737s/iter; left time: 2603.9446s
	iters: 400, epoch: 25 | loss: 0.0038243
	speed: 0.0800s/iter; left time: 2817.9113s
Epoch: 25 cost time: 36.68567228317261
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.959 Test Loss: 0.260 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0009467
	speed: 0.2894s/iter; left time: 10151.3484s
	iters: 200, epoch: 26 | loss: 0.0312320
	speed: 0.0879s/iter; left time: 3074.9769s
	iters: 300, epoch: 26 | loss: 0.0034715
	speed: 0.0822s/iter; left time: 2867.8328s
	iters: 400, epoch: 26 | loss: 0.0045462
	speed: 0.0743s/iter; left time: 2583.3861s
Epoch: 26 cost time: 38.18566346168518
Epoch: 26, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0014641
	speed: 0.3172s/iter; left time: 10978.6526s
	iters: 200, epoch: 27 | loss: 0.0052361
	speed: 0.0757s/iter; left time: 2611.0960s
	iters: 300, epoch: 27 | loss: 0.0083085
	speed: 0.0802s/iter; left time: 2761.0483s
	iters: 400, epoch: 27 | loss: 0.1105599
	speed: 0.0816s/iter; left time: 2798.9563s
Epoch: 27 cost time: 38.39280104637146
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.276 Vali Acc: 0.952 Test Loss: 0.276 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0676991
	speed: 0.3199s/iter; left time: 10920.6922s
	iters: 200, epoch: 28 | loss: 0.0004495
	speed: 0.0809s/iter; left time: 2753.3138s
	iters: 300, epoch: 28 | loss: 0.0103273
	speed: 0.0800s/iter; left time: 2713.5375s
	iters: 400, epoch: 28 | loss: 0.0185245
	speed: 0.0838s/iter; left time: 2834.7410s
Epoch: 28 cost time: 38.912224531173706
Epoch: 28, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 762246
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7333218
	speed: 0.1067s/iter; left time: 4992.5086s
	iters: 200, epoch: 1 | loss: 0.6414881
	speed: 0.0812s/iter; left time: 3791.7493s
	iters: 300, epoch: 1 | loss: 0.1875096
	speed: 0.0779s/iter; left time: 3631.5761s
	iters: 400, epoch: 1 | loss: 0.4194884
	speed: 0.0774s/iter; left time: 3599.9326s
Epoch: 1 cost time: 40.04773759841919
Epoch: 1, Steps: 469 | Train Loss: 0.677 Vali Loss: 0.300 Vali Acc: 0.897 Test Loss: 0.300 Test Acc: 0.897
Validation loss decreased (inf --> -0.897081).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2457647
	speed: 0.2871s/iter; left time: 13302.0993s
	iters: 200, epoch: 2 | loss: 0.0968110
	speed: 0.0799s/iter; left time: 3692.7928s
	iters: 300, epoch: 2 | loss: 0.7220870
	speed: 0.0777s/iter; left time: 3585.4942s
	iters: 400, epoch: 2 | loss: 0.2136861
	speed: 0.0755s/iter; left time: 3476.3329s
Epoch: 2 cost time: 36.75820231437683
Epoch: 2, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.264 Vali Acc: 0.921 Test Loss: 0.264 Test Acc: 0.921
Validation loss decreased (-0.897081 --> -0.920523).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0527550
	speed: 0.2959s/iter; left time: 13571.8377s
	iters: 200, epoch: 3 | loss: 0.1249390
	speed: 0.0818s/iter; left time: 3745.6305s
	iters: 300, epoch: 3 | loss: 0.1838982
	speed: 0.0795s/iter; left time: 3629.4427s
	iters: 400, epoch: 3 | loss: 0.0848924
	speed: 0.0774s/iter; left time: 3527.1526s
Epoch: 3 cost time: 37.72272872924805
Epoch: 3, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
Validation loss decreased (-0.920523 --> -0.927385).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0767535
	speed: 0.3001s/iter; left time: 13623.5913s
	iters: 200, epoch: 4 | loss: 0.1541365
	speed: 0.0817s/iter; left time: 3701.2301s
	iters: 300, epoch: 4 | loss: 0.0221009
	speed: 0.0841s/iter; left time: 3801.6172s
	iters: 400, epoch: 4 | loss: 0.3554297
	speed: 0.0813s/iter; left time: 3666.1382s
Epoch: 4 cost time: 38.40286111831665
Epoch: 4, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.212 Vali Acc: 0.940 Test Loss: 0.212 Test Acc: 0.940
Validation loss decreased (-0.927385 --> -0.940249).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1334036
	speed: 0.3108s/iter; left time: 13964.0514s
	iters: 200, epoch: 5 | loss: 0.3901608
	speed: 0.0727s/iter; left time: 3259.6272s
	iters: 300, epoch: 5 | loss: 0.0118330
	speed: 0.0742s/iter; left time: 3319.3081s
	iters: 400, epoch: 5 | loss: 0.3163049
	speed: 0.0793s/iter; left time: 3537.6575s
Epoch: 5 cost time: 36.522602796554565
Epoch: 5, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.205 Vali Acc: 0.940 Test Loss: 0.205 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3571559
	speed: 0.2963s/iter; left time: 13173.6530s
	iters: 200, epoch: 6 | loss: 0.2495040
	speed: 0.0755s/iter; left time: 3351.0327s
	iters: 300, epoch: 6 | loss: 0.0115478
	speed: 0.0814s/iter; left time: 3604.5322s
	iters: 400, epoch: 6 | loss: 0.5203086
	speed: 0.0810s/iter; left time: 3574.7107s
Epoch: 6 cost time: 37.480196952819824
Epoch: 6, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.356 Vali Acc: 0.909 Test Loss: 0.356 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1301717
	speed: 0.2929s/iter; left time: 12883.1277s
	iters: 200, epoch: 7 | loss: 0.4793830
	speed: 0.0754s/iter; left time: 3307.1181s
	iters: 300, epoch: 7 | loss: 0.0088716
	speed: 0.0783s/iter; left time: 3428.3640s
	iters: 400, epoch: 7 | loss: 0.0932698
	speed: 0.0809s/iter; left time: 3534.4978s
Epoch: 7 cost time: 37.75357508659363
Epoch: 7, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.306 Vali Acc: 0.934 Test Loss: 0.306 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0069295
	speed: 0.3013s/iter; left time: 13110.6373s
	iters: 200, epoch: 8 | loss: 0.0363337
	speed: 0.0869s/iter; left time: 3772.1997s
	iters: 300, epoch: 8 | loss: 0.0404536
	speed: 0.0901s/iter; left time: 3904.0194s
	iters: 400, epoch: 8 | loss: 0.0198577
	speed: 0.0800s/iter; left time: 3455.3912s
Epoch: 8 cost time: 40.131654262542725
Epoch: 8, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
Validation loss decreased (-0.940249 --> -0.965693).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0099633
	speed: 0.3221s/iter; left time: 13867.5279s
	iters: 200, epoch: 9 | loss: 0.0061003
	speed: 0.0997s/iter; left time: 4280.3135s
	iters: 300, epoch: 9 | loss: 0.1467985
	speed: 0.0877s/iter; left time: 3758.5732s
	iters: 400, epoch: 9 | loss: 0.4136714
	speed: 0.0817s/iter; left time: 3493.8746s
Epoch: 9 cost time: 42.99325394630432
Epoch: 9, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.220 Vali Acc: 0.947 Test Loss: 0.220 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0034788
	speed: 0.3412s/iter; left time: 14527.0489s
	iters: 200, epoch: 10 | loss: 0.1060678
	speed: 0.0796s/iter; left time: 3381.1867s
	iters: 300, epoch: 10 | loss: 0.0044831
	speed: 0.0755s/iter; left time: 3200.8405s
	iters: 400, epoch: 10 | loss: 0.0839696
	speed: 0.0736s/iter; left time: 3110.8215s
Epoch: 10 cost time: 37.14198327064514
Epoch: 10, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.203 Vali Acc: 0.945 Test Loss: 0.203 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0159573
	speed: 0.3064s/iter; left time: 12900.9708s
	iters: 200, epoch: 11 | loss: 0.2691869
	speed: 0.0784s/iter; left time: 3294.8548s
	iters: 300, epoch: 11 | loss: 0.0317932
	speed: 0.0715s/iter; left time: 2997.2040s
	iters: 400, epoch: 11 | loss: 0.0172011
	speed: 0.0803s/iter; left time: 3357.3392s
Epoch: 11 cost time: 36.84434151649475
Epoch: 11, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0225124
	speed: 0.2845s/iter; left time: 11849.1921s
	iters: 200, epoch: 12 | loss: 0.0025415
	speed: 0.0813s/iter; left time: 3376.1550s
	iters: 300, epoch: 12 | loss: 0.0151703
	speed: 0.0876s/iter; left time: 3628.5349s
	iters: 400, epoch: 12 | loss: 0.0065700
	speed: 0.0829s/iter; left time: 3428.2200s
Epoch: 12 cost time: 38.75355792045593
Epoch: 12, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0033935
	speed: 0.3187s/iter; left time: 13122.7228s
	iters: 200, epoch: 13 | loss: 0.1176585
	speed: 0.0886s/iter; left time: 3640.4549s
	iters: 300, epoch: 13 | loss: 0.0478842
	speed: 0.0776s/iter; left time: 3180.0687s
	iters: 400, epoch: 13 | loss: 0.0432012
	speed: 0.0788s/iter; left time: 3219.5092s
Epoch: 13 cost time: 39.525665283203125
Epoch: 13, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0250476
	speed: 0.3255s/iter; left time: 13249.9021s
	iters: 200, epoch: 14 | loss: 0.1770775
	speed: 0.0923s/iter; left time: 3748.9173s
	iters: 300, epoch: 14 | loss: 0.0703508
	speed: 0.0832s/iter; left time: 3369.6606s
	iters: 400, epoch: 14 | loss: 0.0206130
	speed: 0.0853s/iter; left time: 3448.1714s
Epoch: 14 cost time: 40.74068641662598
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.965693 --> -0.965693).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0157194
	speed: 0.3038s/iter; left time: 12225.2075s
	iters: 200, epoch: 15 | loss: 0.0188337
	speed: 0.0763s/iter; left time: 3064.0911s
	iters: 300, epoch: 15 | loss: 0.1244397
	speed: 0.0710s/iter; left time: 2841.6956s
	iters: 400, epoch: 15 | loss: 0.0110028
	speed: 0.0728s/iter; left time: 2908.0523s
Epoch: 15 cost time: 34.91461801528931
Epoch: 15, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0076004
	speed: 0.2903s/iter; left time: 11542.4944s
	iters: 200, epoch: 16 | loss: 0.0026203
	speed: 0.0761s/iter; left time: 3017.1916s
	iters: 300, epoch: 16 | loss: 0.0197372
	speed: 0.0844s/iter; left time: 3337.8790s
	iters: 400, epoch: 16 | loss: 0.0318284
	speed: 0.0769s/iter; left time: 3035.4189s
Epoch: 16 cost time: 36.493815898895264
Epoch: 16, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.965693 --> -0.969982).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0545377
	speed: 0.2852s/iter; left time: 11209.1760s
	iters: 200, epoch: 17 | loss: 0.0036116
	speed: 0.0713s/iter; left time: 2795.2040s
	iters: 300, epoch: 17 | loss: 0.5388864
	speed: 0.0745s/iter; left time: 2913.7873s
	iters: 400, epoch: 17 | loss: 0.0108601
	speed: 0.0784s/iter; left time: 3058.6263s
Epoch: 17 cost time: 35.70342302322388
Epoch: 17, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0922333
	speed: 0.3014s/iter; left time: 11704.6170s
	iters: 200, epoch: 18 | loss: 0.0121163
	speed: 0.0711s/iter; left time: 2755.2685s
	iters: 300, epoch: 18 | loss: 0.0041700
	speed: 0.0716s/iter; left time: 2767.0513s
	iters: 400, epoch: 18 | loss: 0.0008607
	speed: 0.0770s/iter; left time: 2965.9208s
Epoch: 18 cost time: 36.434154987335205
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0170964
	speed: 0.2978s/iter; left time: 11422.4469s
	iters: 200, epoch: 19 | loss: 0.4490313
	speed: 0.0780s/iter; left time: 2983.5206s
	iters: 300, epoch: 19 | loss: 0.2929326
	speed: 0.0842s/iter; left time: 3213.3499s
	iters: 400, epoch: 19 | loss: 0.0105280
	speed: 0.0874s/iter; left time: 3327.6069s
Epoch: 19 cost time: 38.84482407569885
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0924556
	speed: 0.2855s/iter; left time: 10815.8646s
	iters: 200, epoch: 20 | loss: 0.4774628
	speed: 0.0746s/iter; left time: 2818.0596s
	iters: 300, epoch: 20 | loss: 0.0043111
	speed: 0.0685s/iter; left time: 2583.1830s
	iters: 400, epoch: 20 | loss: 0.0028511
	speed: 0.0714s/iter; left time: 2683.9380s
Epoch: 20 cost time: 34.68932056427002
Epoch: 20, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0182917
	speed: 0.2957s/iter; left time: 11064.1022s
	iters: 200, epoch: 21 | loss: 0.0049238
	speed: 0.0774s/iter; left time: 2890.2884s
	iters: 300, epoch: 21 | loss: 0.0243808
	speed: 0.0740s/iter; left time: 2753.0589s
	iters: 400, epoch: 21 | loss: 0.0545149
	speed: 0.0756s/iter; left time: 2806.2747s
Epoch: 21 cost time: 36.047526836395264
Epoch: 21, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0136404
	speed: 0.2680s/iter; left time: 9904.5592s
	iters: 200, epoch: 22 | loss: 0.0022370
	speed: 0.0733s/iter; left time: 2702.2304s
	iters: 300, epoch: 22 | loss: 0.0704407
	speed: 0.0777s/iter; left time: 2853.9266s
	iters: 400, epoch: 22 | loss: 0.0011344
	speed: 0.0722s/iter; left time: 2646.0131s
Epoch: 22 cost time: 35.07625722885132
Epoch: 22, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.7801796
	speed: 0.3055s/iter; left time: 11144.5244s
	iters: 200, epoch: 23 | loss: 0.0766440
	speed: 0.0762s/iter; left time: 2771.0425s
	iters: 300, epoch: 23 | loss: 0.0018520
	speed: 0.0730s/iter; left time: 2647.4162s
	iters: 400, epoch: 23 | loss: 0.4977106
	speed: 0.0773s/iter; left time: 2795.2086s
Epoch: 23 cost time: 36.13897943496704
Epoch: 23, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.218 Vali Acc: 0.938 Test Loss: 0.218 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0042438
	speed: 0.2929s/iter; left time: 10546.9640s
	iters: 200, epoch: 24 | loss: 0.0047721
	speed: 0.0798s/iter; left time: 2864.7113s
	iters: 300, epoch: 24 | loss: 0.0009674
	speed: 0.0800s/iter; left time: 2863.8459s
	iters: 400, epoch: 24 | loss: 0.0031813
	speed: 0.0841s/iter; left time: 3003.0189s
Epoch: 24 cost time: 38.95673751831055
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0704079
	speed: 0.2959s/iter; left time: 10518.5935s
	iters: 200, epoch: 25 | loss: 0.0044186
	speed: 0.0717s/iter; left time: 2542.7341s
	iters: 300, epoch: 25 | loss: 0.0097089
	speed: 0.0681s/iter; left time: 2407.2002s
	iters: 400, epoch: 25 | loss: 0.0051127
	speed: 0.0701s/iter; left time: 2470.7943s
Epoch: 25 cost time: 33.92382550239563
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0003869
	speed: 0.2821s/iter; left time: 9895.0019s
	iters: 200, epoch: 26 | loss: 0.0947249
	speed: 0.0768s/iter; left time: 2686.7844s
	iters: 300, epoch: 26 | loss: 0.0014471
	speed: 0.0844s/iter; left time: 2942.2479s
	iters: 400, epoch: 26 | loss: 0.0092583
	speed: 0.0742s/iter; left time: 2579.6396s
Epoch: 26 cost time: 36.34614610671997
Epoch: 26, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.969982 --> -0.971697).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0040173
	speed: 0.2809s/iter; left time: 9722.7494s
	iters: 200, epoch: 27 | loss: 0.0038204
	speed: 0.0786s/iter; left time: 2711.0975s
	iters: 300, epoch: 27 | loss: 0.0005403
	speed: 0.0758s/iter; left time: 2607.7680s
	iters: 400, epoch: 27 | loss: 0.0017106
	speed: 0.0726s/iter; left time: 2489.9864s
Epoch: 27 cost time: 35.71710133552551
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0218113
	speed: 0.2857s/iter; left time: 9753.3398s
	iters: 200, epoch: 28 | loss: 0.0027286
	speed: 0.0764s/iter; left time: 2599.1619s
	iters: 300, epoch: 28 | loss: 0.0009639
	speed: 0.0802s/iter; left time: 2723.1795s
	iters: 400, epoch: 28 | loss: 0.0018625
	speed: 0.0852s/iter; left time: 2883.9746s
Epoch: 28 cost time: 38.31739854812622
Epoch: 28, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0076568
	speed: 0.3003s/iter; left time: 10112.1323s
	iters: 200, epoch: 29 | loss: 0.0074629
	speed: 0.0784s/iter; left time: 2632.9058s
	iters: 300, epoch: 29 | loss: 0.0092732
	speed: 0.0764s/iter; left time: 2557.4734s
	iters: 400, epoch: 29 | loss: 0.0708083
	speed: 0.0776s/iter; left time: 2588.1553s
Epoch: 29 cost time: 36.6011757850647
Epoch: 29, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0059882
	speed: 0.2839s/iter; left time: 9424.9837s
	iters: 200, epoch: 30 | loss: 0.0010469
	speed: 0.0820s/iter; left time: 2714.1025s
	iters: 300, epoch: 30 | loss: 0.0020460
	speed: 0.0752s/iter; left time: 2481.5298s
	iters: 400, epoch: 30 | loss: 0.0168069
	speed: 0.0739s/iter; left time: 2429.7987s
Epoch: 30 cost time: 37.03474998474121
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0969170
	speed: 0.2924s/iter; left time: 9568.9379s
	iters: 200, epoch: 31 | loss: 0.0202961
	speed: 0.0744s/iter; left time: 2428.5260s
	iters: 300, epoch: 31 | loss: 0.0011785
	speed: 0.0770s/iter; left time: 2504.8854s
	iters: 400, epoch: 31 | loss: 0.0185746
	speed: 0.0767s/iter; left time: 2487.5865s
Epoch: 31 cost time: 35.80383229255676
Epoch: 31, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0120338
	speed: 0.2850s/iter; left time: 9194.8034s
	iters: 200, epoch: 32 | loss: 0.0221641
	speed: 0.0772s/iter; left time: 2484.3798s
	iters: 300, epoch: 32 | loss: 0.0129617
	speed: 0.0759s/iter; left time: 2435.0667s
	iters: 400, epoch: 32 | loss: 0.0037328
	speed: 0.0727s/iter; left time: 2325.1803s
Epoch: 32 cost time: 35.23255276679993
Epoch: 32, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0090730
	speed: 0.2906s/iter; left time: 9238.6085s
	iters: 200, epoch: 33 | loss: 0.0008665
	speed: 0.0745s/iter; left time: 2360.3025s
	iters: 300, epoch: 33 | loss: 0.0003423
	speed: 0.0768s/iter; left time: 2425.2704s
	iters: 400, epoch: 33 | loss: 0.0210928
	speed: 0.0790s/iter; left time: 2489.1784s
Epoch: 33 cost time: 37.05123162269592
Epoch: 33, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0021924
	speed: 0.3049s/iter; left time: 9549.1873s
	iters: 200, epoch: 34 | loss: 0.0091056
	speed: 0.0781s/iter; left time: 2439.0929s
	iters: 300, epoch: 34 | loss: 0.0041763
	speed: 0.0775s/iter; left time: 2413.0175s
	iters: 400, epoch: 34 | loss: 0.0052110
	speed: 0.0789s/iter; left time: 2446.7608s
Epoch: 34 cost time: 36.894917488098145
Epoch: 34, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0179135
	speed: 0.2827s/iter; left time: 8724.1527s
	iters: 200, epoch: 35 | loss: 0.0017501
	speed: 0.0800s/iter; left time: 2461.1663s
	iters: 300, epoch: 35 | loss: 0.0020692
	speed: 0.0717s/iter; left time: 2197.3481s
	iters: 400, epoch: 35 | loss: 0.0037169
	speed: 0.0778s/iter; left time: 2378.5926s
Epoch: 35 cost time: 36.959118366241455
Epoch: 35, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0056398
	speed: 0.2847s/iter; left time: 8651.7515s
	iters: 200, epoch: 36 | loss: 0.0044981
	speed: 0.0765s/iter; left time: 2318.0148s
	iters: 300, epoch: 36 | loss: 0.0015368
	speed: 0.0744s/iter; left time: 2245.8409s
	iters: 400, epoch: 36 | loss: 0.0085147
	speed: 0.0751s/iter; left time: 2258.5741s
Epoch: 36 cost time: 35.37503671646118
Epoch: 36, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.964 Test Loss: 0.221 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9716981132075472
model parameter : 761990
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7302213
	speed: 0.0902s/iter; left time: 4219.9645s
	iters: 200, epoch: 1 | loss: 0.5015697
	speed: 0.0678s/iter; left time: 3168.1222s
	iters: 300, epoch: 1 | loss: 0.3453872
	speed: 0.0737s/iter; left time: 3432.4159s
	iters: 400, epoch: 1 | loss: 0.0917471
	speed: 0.0787s/iter; left time: 3658.4250s
Epoch: 1 cost time: 36.55646276473999
Epoch: 1, Steps: 469 | Train Loss: 0.664 Vali Loss: 0.369 Vali Acc: 0.885 Test Loss: 0.369 Test Acc: 0.885
Validation loss decreased (inf --> -0.884788).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4288860
	speed: 0.2949s/iter; left time: 13665.4784s
	iters: 200, epoch: 2 | loss: 0.0721242
	speed: 0.0725s/iter; left time: 3350.7606s
	iters: 300, epoch: 2 | loss: 0.3134565
	speed: 0.0815s/iter; left time: 3759.6456s
	iters: 400, epoch: 2 | loss: 0.0462923
	speed: 0.0757s/iter; left time: 3484.8050s
Epoch: 2 cost time: 36.47151231765747
Epoch: 2, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.884788 --> -0.955401).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2927206
	speed: 0.3004s/iter; left time: 13775.7848s
	iters: 200, epoch: 3 | loss: 0.3827037
	speed: 0.0755s/iter; left time: 3456.7723s
	iters: 300, epoch: 3 | loss: 0.0380445
	speed: 0.0673s/iter; left time: 3071.5741s
	iters: 400, epoch: 3 | loss: 0.2783336
	speed: 0.0691s/iter; left time: 3146.6968s
Epoch: 3 cost time: 35.05566048622131
Epoch: 3, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1627309
	speed: 0.2898s/iter; left time: 13156.1252s
	iters: 200, epoch: 4 | loss: 0.0879644
	speed: 0.0761s/iter; left time: 3448.1653s
	iters: 300, epoch: 4 | loss: 0.0223263
	speed: 0.0741s/iter; left time: 3350.2664s
	iters: 400, epoch: 4 | loss: 0.0041929
	speed: 0.0783s/iter; left time: 3529.5730s
Epoch: 4 cost time: 35.716381549835205
Epoch: 4, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955401 --> -0.955973).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0111508
	speed: 0.2733s/iter; left time: 12279.6695s
	iters: 200, epoch: 5 | loss: 0.0416816
	speed: 0.0788s/iter; left time: 3530.8007s
	iters: 300, epoch: 5 | loss: 0.1338606
	speed: 0.0764s/iter; left time: 3414.9948s
	iters: 400, epoch: 5 | loss: 0.1502182
	speed: 0.0765s/iter; left time: 3413.1482s
Epoch: 5 cost time: 36.10920262336731
Epoch: 5, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.202 Vali Acc: 0.945 Test Loss: 0.202 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0754810
	speed: 0.2927s/iter; left time: 13013.1594s
	iters: 200, epoch: 6 | loss: 0.0652885
	speed: 0.0724s/iter; left time: 3210.3677s
	iters: 300, epoch: 6 | loss: 0.0217270
	speed: 0.0792s/iter; left time: 3505.1946s
	iters: 400, epoch: 6 | loss: 0.0442176
	speed: 0.0772s/iter; left time: 3410.8960s
Epoch: 6 cost time: 35.27395534515381
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.414 Vali Acc: 0.902 Test Loss: 0.414 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0053438
	speed: 0.2957s/iter; left time: 13006.4288s
	iters: 200, epoch: 7 | loss: 0.0174384
	speed: 0.0845s/iter; left time: 3707.4597s
	iters: 300, epoch: 7 | loss: 0.0161717
	speed: 0.0820s/iter; left time: 3588.4035s
	iters: 400, epoch: 7 | loss: 0.0635837
	speed: 0.0829s/iter; left time: 3622.0089s
Epoch: 7 cost time: 39.40036201477051
Epoch: 7, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.247 Vali Acc: 0.936 Test Loss: 0.247 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1132105
	speed: 0.3103s/iter; left time: 13502.4282s
	iters: 200, epoch: 8 | loss: 0.0952078
	speed: 0.0724s/iter; left time: 3144.7903s
	iters: 300, epoch: 8 | loss: 0.2850703
	speed: 0.0684s/iter; left time: 2964.1999s
	iters: 400, epoch: 8 | loss: 0.0122855
	speed: 0.0806s/iter; left time: 3485.1329s
Epoch: 8 cost time: 36.0088746547699
Epoch: 8, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.955973 --> -0.962834).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6528921
	speed: 0.2955s/iter; left time: 12722.5211s
	iters: 200, epoch: 9 | loss: 0.0049165
	speed: 0.0768s/iter; left time: 3299.2253s
	iters: 300, epoch: 9 | loss: 0.0340843
	speed: 0.0716s/iter; left time: 3069.3006s
	iters: 400, epoch: 9 | loss: 0.0468137
	speed: 0.0732s/iter; left time: 3128.7240s
Epoch: 9 cost time: 35.55092406272888
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1665525
	speed: 0.2912s/iter; left time: 12401.1823s
	iters: 200, epoch: 10 | loss: 0.2260249
	speed: 0.0763s/iter; left time: 3241.3821s
	iters: 300, epoch: 10 | loss: 0.0185784
	speed: 0.0787s/iter; left time: 3336.2350s
	iters: 400, epoch: 10 | loss: 0.0257168
	speed: 0.0773s/iter; left time: 3266.4364s
Epoch: 10 cost time: 36.309816122055054
Epoch: 10, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0175055
	speed: 0.2948s/iter; left time: 12415.3042s
	iters: 200, epoch: 11 | loss: 0.1203680
	speed: 0.0745s/iter; left time: 3129.3900s
	iters: 300, epoch: 11 | loss: 0.1431625
	speed: 0.0779s/iter; left time: 3266.1205s
	iters: 400, epoch: 11 | loss: 0.0053162
	speed: 0.0759s/iter; left time: 3172.1970s
Epoch: 11 cost time: 36.523186922073364
Epoch: 11, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.962834 --> -0.962834).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0058032
	speed: 0.3075s/iter; left time: 12804.3415s
	iters: 200, epoch: 12 | loss: 0.0629592
	speed: 0.0799s/iter; left time: 3320.8482s
	iters: 300, epoch: 12 | loss: 0.0070732
	speed: 0.0914s/iter; left time: 3787.1908s
	iters: 400, epoch: 12 | loss: 0.0097999
	speed: 0.0828s/iter; left time: 3423.9278s
Epoch: 12 cost time: 39.54056715965271
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0047218
	speed: 0.2982s/iter; left time: 12276.5094s
	iters: 200, epoch: 13 | loss: 0.0998529
	speed: 0.0757s/iter; left time: 3110.2670s
	iters: 300, epoch: 13 | loss: 0.0526099
	speed: 0.0684s/iter; left time: 2802.3832s
	iters: 400, epoch: 13 | loss: 0.0115598
	speed: 0.0673s/iter; left time: 2750.1027s
Epoch: 13 cost time: 34.66915988922119
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.945 Test Loss: 0.236 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0031232
	speed: 0.2986s/iter; left time: 12152.8427s
	iters: 200, epoch: 14 | loss: 0.0151434
	speed: 0.0757s/iter; left time: 3075.0117s
	iters: 300, epoch: 14 | loss: 0.0245984
	speed: 0.0785s/iter; left time: 3178.8473s
	iters: 400, epoch: 14 | loss: 0.0056880
	speed: 0.0745s/iter; left time: 3011.0531s
Epoch: 14 cost time: 36.288017988204956
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.962834 --> -0.967695).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0713625
	speed: 0.2812s/iter; left time: 11314.6134s
	iters: 200, epoch: 15 | loss: 0.0098365
	speed: 0.0754s/iter; left time: 3027.0276s
	iters: 300, epoch: 15 | loss: 0.2619020
	speed: 0.0733s/iter; left time: 2933.6562s
	iters: 400, epoch: 15 | loss: 0.1494007
	speed: 0.0781s/iter; left time: 3119.3691s
Epoch: 15 cost time: 35.36159348487854
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2138899
	speed: 0.3017s/iter; left time: 11995.5567s
	iters: 200, epoch: 16 | loss: 0.3412995
	speed: 0.0770s/iter; left time: 3055.4745s
	iters: 300, epoch: 16 | loss: 0.0025482
	speed: 0.0763s/iter; left time: 3016.9501s
	iters: 400, epoch: 16 | loss: 0.3435306
	speed: 0.0823s/iter; left time: 3248.9380s
Epoch: 16 cost time: 37.365503549575806
Epoch: 16, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0152026
	speed: 0.3030s/iter; left time: 11906.9418s
	iters: 200, epoch: 17 | loss: 0.0069719
	speed: 0.0778s/iter; left time: 3047.8740s
	iters: 300, epoch: 17 | loss: 0.0697864
	speed: 0.0761s/iter; left time: 2975.2987s
	iters: 400, epoch: 17 | loss: 0.0055049
	speed: 0.0761s/iter; left time: 2967.2440s
Epoch: 17 cost time: 37.11987018585205
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0031632
	speed: 0.2974s/iter; left time: 11546.7045s
	iters: 200, epoch: 18 | loss: 0.0044840
	speed: 0.0719s/iter; left time: 2785.9595s
	iters: 300, epoch: 18 | loss: 0.0102149
	speed: 0.0674s/iter; left time: 2605.4571s
	iters: 400, epoch: 18 | loss: 0.0016915
	speed: 0.0717s/iter; left time: 2762.6918s
Epoch: 18 cost time: 34.22495245933533
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0275654
	speed: 0.2898s/iter; left time: 11116.8655s
	iters: 200, epoch: 19 | loss: 0.0012946
	speed: 0.0764s/iter; left time: 2924.8772s
	iters: 300, epoch: 19 | loss: 0.0804818
	speed: 0.0818s/iter; left time: 3119.7024s
	iters: 400, epoch: 19 | loss: 0.0010487
	speed: 0.0754s/iter; left time: 2869.6360s
Epoch: 19 cost time: 36.18129634857178
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.967695 --> -0.968838).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3960613
	speed: 0.2765s/iter; left time: 10476.7049s
	iters: 200, epoch: 20 | loss: 0.0042022
	speed: 0.0729s/iter; left time: 2754.9650s
	iters: 300, epoch: 20 | loss: 0.0536708
	speed: 0.0791s/iter; left time: 2979.7249s
	iters: 400, epoch: 20 | loss: 0.0037138
	speed: 0.0784s/iter; left time: 2948.7328s
Epoch: 20 cost time: 35.3315646648407
Epoch: 20, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0039214
	speed: 0.2971s/iter; left time: 11117.9848s
	iters: 200, epoch: 21 | loss: 0.0009952
	speed: 0.0837s/iter; left time: 3124.8431s
	iters: 300, epoch: 21 | loss: 0.1232927
	speed: 0.0819s/iter; left time: 3047.6007s
	iters: 400, epoch: 21 | loss: 0.0079182
	speed: 0.0778s/iter; left time: 2888.3365s
Epoch: 21 cost time: 37.983147859573364
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
Validation loss decreased (-0.968838 --> -0.974270).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0057717
	speed: 0.2879s/iter; left time: 10638.5905s
	iters: 200, epoch: 22 | loss: 0.0027076
	speed: 0.0768s/iter; left time: 2831.5487s
	iters: 300, epoch: 22 | loss: 0.0009763
	speed: 0.0796s/iter; left time: 2925.5267s
	iters: 400, epoch: 22 | loss: 0.0168824
	speed: 0.0829s/iter; left time: 3038.5375s
Epoch: 22 cost time: 37.87706446647644
Epoch: 22, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0010563
	speed: 0.3171s/iter; left time: 11568.5971s
	iters: 200, epoch: 23 | loss: 0.0712412
	speed: 0.0725s/iter; left time: 2637.4676s
	iters: 300, epoch: 23 | loss: 0.0079004
	speed: 0.0695s/iter; left time: 2519.8573s
	iters: 400, epoch: 23 | loss: 0.0446402
	speed: 0.0732s/iter; left time: 2646.9963s
Epoch: 23 cost time: 35.823519468307495
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0255325
	speed: 0.2999s/iter; left time: 10799.9909s
	iters: 200, epoch: 24 | loss: 0.0025990
	speed: 0.0750s/iter; left time: 2693.4276s
	iters: 300, epoch: 24 | loss: 0.0622868
	speed: 0.0759s/iter; left time: 2717.0314s
	iters: 400, epoch: 24 | loss: 0.0161924
	speed: 0.0787s/iter; left time: 2810.4292s
Epoch: 24 cost time: 36.36155390739441
Epoch: 24, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0053092
	speed: 0.2802s/iter; left time: 9958.2116s
	iters: 200, epoch: 25 | loss: 0.0717390
	speed: 0.0866s/iter; left time: 3068.5065s
	iters: 300, epoch: 25 | loss: 0.0283481
	speed: 0.0781s/iter; left time: 2760.1644s
	iters: 400, epoch: 25 | loss: 0.0083029
	speed: 0.0726s/iter; left time: 2559.1780s
Epoch: 25 cost time: 37.195409059524536
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0009435
	speed: 0.3045s/iter; left time: 10681.1214s
	iters: 200, epoch: 26 | loss: 0.0599746
	speed: 0.0803s/iter; left time: 2809.3804s
	iters: 300, epoch: 26 | loss: 0.0005831
	speed: 0.0742s/iter; left time: 2586.5084s
	iters: 400, epoch: 26 | loss: 0.2482409
	speed: 0.0742s/iter; left time: 2581.9206s
Epoch: 26 cost time: 36.41969418525696
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0033201
	speed: 0.2983s/iter; left time: 10323.2045s
	iters: 200, epoch: 27 | loss: 0.0008127
	speed: 0.0772s/iter; left time: 2664.0474s
	iters: 300, epoch: 27 | loss: 0.0048665
	speed: 0.0826s/iter; left time: 2843.1105s
	iters: 400, epoch: 27 | loss: 0.0024941
	speed: 0.0794s/iter; left time: 2725.5163s
Epoch: 27 cost time: 38.65170478820801
Epoch: 27, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.953 Test Loss: 0.229 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0008289
	speed: 0.2944s/iter; left time: 10049.3511s
	iters: 200, epoch: 28 | loss: 0.0021830
	speed: 0.0675s/iter; left time: 2298.1406s
	iters: 300, epoch: 28 | loss: 0.0007918
	speed: 0.0731s/iter; left time: 2481.5149s
	iters: 400, epoch: 28 | loss: 0.0045173
	speed: 0.0753s/iter; left time: 2548.0931s
Epoch: 28 cost time: 33.88384413719177
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.237 Vali Acc: 0.947 Test Loss: 0.237 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0134702
	speed: 0.2919s/iter; left time: 9828.1902s
	iters: 200, epoch: 29 | loss: 0.0092495
	speed: 0.0758s/iter; left time: 2545.3308s
	iters: 300, epoch: 29 | loss: 0.0023886
	speed: 0.0770s/iter; left time: 2577.9274s
	iters: 400, epoch: 29 | loss: 0.0024382
	speed: 0.0855s/iter; left time: 2854.5620s
Epoch: 29 cost time: 38.43613386154175
Epoch: 29, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0038466
	speed: 0.2942s/iter; left time: 9767.4693s
	iters: 200, epoch: 30 | loss: 0.0024729
	speed: 0.0750s/iter; left time: 2481.4313s
	iters: 300, epoch: 30 | loss: 0.0276048
	speed: 0.0793s/iter; left time: 2615.2520s
	iters: 400, epoch: 30 | loss: 0.4710210
	speed: 0.0862s/iter; left time: 2835.6885s
Epoch: 30 cost time: 37.78006863594055
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0185726
	speed: 0.3161s/iter; left time: 10344.7859s
	iters: 200, epoch: 31 | loss: 0.0013845
	speed: 0.0950s/iter; left time: 3098.4359s
	iters: 300, epoch: 31 | loss: 0.1505406
	speed: 0.0801s/iter; left time: 2606.7706s
	iters: 400, epoch: 31 | loss: 0.0015722
	speed: 0.0720s/iter; left time: 2335.4134s
Epoch: 31 cost time: 39.1804883480072
Epoch: 31, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 761734
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8497356
	speed: 0.0973s/iter; left time: 4552.0607s
	iters: 200, epoch: 1 | loss: 0.9673972
	speed: 0.0776s/iter; left time: 3622.7234s
	iters: 300, epoch: 1 | loss: 0.3965952
	speed: 0.0833s/iter; left time: 3883.9818s
	iters: 400, epoch: 1 | loss: 0.1746038
	speed: 0.0825s/iter; left time: 3837.3305s
Epoch: 1 cost time: 39.03999900817871
Epoch: 1, Steps: 469 | Train Loss: 0.792 Vali Loss: 0.332 Vali Acc: 0.896 Test Loss: 0.332 Test Acc: 0.896
Validation loss decreased (inf --> -0.895651).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2915502
	speed: 0.2854s/iter; left time: 13222.7505s
	iters: 200, epoch: 2 | loss: 0.1011395
	speed: 0.0802s/iter; left time: 3708.9288s
	iters: 300, epoch: 2 | loss: 0.2416536
	speed: 0.0851s/iter; left time: 3926.0307s
	iters: 400, epoch: 2 | loss: 0.4338122
	speed: 0.0895s/iter; left time: 4121.1226s
Epoch: 2 cost time: 38.790523529052734
Epoch: 2, Steps: 469 | Train Loss: 0.227 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0941096
	speed: 0.3043s/iter; left time: 13954.3658s
	iters: 200, epoch: 3 | loss: 0.0900752
	speed: 0.0800s/iter; left time: 3659.5066s
	iters: 300, epoch: 3 | loss: 0.0852270
	speed: 0.0754s/iter; left time: 3442.5402s
	iters: 400, epoch: 3 | loss: 0.0096738
	speed: 0.0778s/iter; left time: 3542.7365s
Epoch: 3 cost time: 38.20421600341797
Epoch: 3, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.213 Vali Acc: 0.934 Test Loss: 0.213 Test Acc: 0.934
Validation loss decreased (-0.895651 --> -0.933960).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1647380
	speed: 0.3001s/iter; left time: 13621.1126s
	iters: 200, epoch: 4 | loss: 0.0925737
	speed: 0.0755s/iter; left time: 3421.4645s
	iters: 300, epoch: 4 | loss: 0.0438551
	speed: 0.0816s/iter; left time: 3689.3206s
	iters: 400, epoch: 4 | loss: 0.7839192
	speed: 0.0893s/iter; left time: 4025.2105s
Epoch: 4 cost time: 38.812411069869995
Epoch: 4, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.933960 --> -0.944252).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0433136
	speed: 0.3370s/iter; left time: 15137.8169s
	iters: 200, epoch: 5 | loss: 0.0144418
	speed: 0.0820s/iter; left time: 3676.5822s
	iters: 300, epoch: 5 | loss: 0.1283875
	speed: 0.0817s/iter; left time: 3654.5097s
	iters: 400, epoch: 5 | loss: 0.3409937
	speed: 0.0894s/iter; left time: 3990.9510s
Epoch: 5 cost time: 40.14136075973511
Epoch: 5, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0486834
	speed: 0.3059s/iter; left time: 13599.6450s
	iters: 200, epoch: 6 | loss: 0.3578124
	speed: 0.0797s/iter; left time: 3537.1931s
	iters: 300, epoch: 6 | loss: 0.0425871
	speed: 0.0747s/iter; left time: 3303.8579s
	iters: 400, epoch: 6 | loss: 0.2438834
	speed: 0.0727s/iter; left time: 3211.2794s
Epoch: 6 cost time: 36.82989287376404
Epoch: 6, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.318 Vali Acc: 0.919 Test Loss: 0.318 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0184724
	speed: 0.2891s/iter; left time: 12714.5721s
	iters: 200, epoch: 7 | loss: 0.0741972
	speed: 0.0720s/iter; left time: 3159.5261s
	iters: 300, epoch: 7 | loss: 0.5848603
	speed: 0.0716s/iter; left time: 3134.4805s
	iters: 400, epoch: 7 | loss: 0.0252386
	speed: 0.0722s/iter; left time: 3153.7592s
Epoch: 7 cost time: 34.644981145858765
Epoch: 7, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.196 Vali Acc: 0.947 Test Loss: 0.196 Test Acc: 0.947
Validation loss decreased (-0.944252 --> -0.947397).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0956992
	speed: 0.3043s/iter; left time: 13241.9508s
	iters: 200, epoch: 8 | loss: 0.1393724
	speed: 0.0790s/iter; left time: 3428.4068s
	iters: 300, epoch: 8 | loss: 0.0128794
	speed: 0.0783s/iter; left time: 3389.7515s
	iters: 400, epoch: 8 | loss: 0.0608291
	speed: 0.0822s/iter; left time: 3550.6109s
Epoch: 8 cost time: 37.61274600028992
Epoch: 8, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.947397 --> -0.962834).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1212374
	speed: 0.3014s/iter; left time: 12972.9444s
	iters: 200, epoch: 9 | loss: 0.0310511
	speed: 0.0787s/iter; left time: 3378.8859s
	iters: 300, epoch: 9 | loss: 0.0818980
	speed: 0.0784s/iter; left time: 3359.7699s
	iters: 400, epoch: 9 | loss: 0.2941440
	speed: 0.0938s/iter; left time: 4008.8850s
Epoch: 9 cost time: 39.34797024726868
Epoch: 9, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2949875
	speed: 0.3227s/iter; left time: 13741.8411s
	iters: 200, epoch: 10 | loss: 0.1875249
	speed: 0.0845s/iter; left time: 3589.1495s
	iters: 300, epoch: 10 | loss: 0.0752677
	speed: 0.0725s/iter; left time: 3073.7142s
	iters: 400, epoch: 10 | loss: 0.2859399
	speed: 0.0699s/iter; left time: 2955.4239s
Epoch: 10 cost time: 36.96815586090088
Epoch: 10, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0082439
	speed: 0.2829s/iter; left time: 11912.7579s
	iters: 200, epoch: 11 | loss: 0.4470669
	speed: 0.0831s/iter; left time: 3489.2720s
	iters: 300, epoch: 11 | loss: 0.0177906
	speed: 0.0819s/iter; left time: 3433.1911s
	iters: 400, epoch: 11 | loss: 0.2544201
	speed: 0.0805s/iter; left time: 3364.9470s
Epoch: 11 cost time: 37.39680290222168
Epoch: 11, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1054432
	speed: 0.2824s/iter; left time: 11759.2346s
	iters: 200, epoch: 12 | loss: 0.0255982
	speed: 0.0802s/iter; left time: 3331.2049s
	iters: 300, epoch: 12 | loss: 0.0169964
	speed: 0.0788s/iter; left time: 3265.3396s
	iters: 400, epoch: 12 | loss: 0.0158474
	speed: 0.0722s/iter; left time: 2986.0338s
Epoch: 12 cost time: 35.99701404571533
Epoch: 12, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0438421
	speed: 0.2947s/iter; left time: 12132.0830s
	iters: 200, epoch: 13 | loss: 0.0101904
	speed: 0.0805s/iter; left time: 3305.6111s
	iters: 300, epoch: 13 | loss: 0.0169118
	speed: 0.0781s/iter; left time: 3201.9248s
	iters: 400, epoch: 13 | loss: 0.0149784
	speed: 0.0803s/iter; left time: 3282.0399s
Epoch: 13 cost time: 37.5450165271759
Epoch: 13, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.227 Vali Acc: 0.945 Test Loss: 0.227 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0023338
	speed: 0.3102s/iter; left time: 12626.3626s
	iters: 200, epoch: 14 | loss: 0.1861481
	speed: 0.0820s/iter; left time: 3329.0384s
	iters: 300, epoch: 14 | loss: 0.0065675
	speed: 0.0828s/iter; left time: 3355.7373s
	iters: 400, epoch: 14 | loss: 0.0043518
	speed: 0.0847s/iter; left time: 3422.2559s
Epoch: 14 cost time: 39.912718534469604
Epoch: 14, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4109606
	speed: 0.3078s/iter; left time: 12384.3982s
	iters: 200, epoch: 15 | loss: 0.0168063
	speed: 0.0706s/iter; left time: 2833.1056s
	iters: 300, epoch: 15 | loss: 0.0811421
	speed: 0.0799s/iter; left time: 3199.0080s
	iters: 400, epoch: 15 | loss: 0.0081541
	speed: 0.0866s/iter; left time: 3458.0845s
Epoch: 15 cost time: 37.82695269584656
Epoch: 15, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.251 Vali Acc: 0.943 Test Loss: 0.251 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0117489
	speed: 0.2955s/iter; left time: 11751.5894s
	iters: 200, epoch: 16 | loss: 0.0101318
	speed: 0.0822s/iter; left time: 3260.6736s
	iters: 300, epoch: 16 | loss: 0.0107305
	speed: 0.0848s/iter; left time: 3357.0361s
	iters: 400, epoch: 16 | loss: 0.0089808
	speed: 0.0769s/iter; left time: 3034.4446s
Epoch: 16 cost time: 37.624141216278076
Epoch: 16, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.288 Vali Acc: 0.940 Test Loss: 0.288 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0036818
	speed: 0.2832s/iter; left time: 11127.8140s
	iters: 200, epoch: 17 | loss: 0.0061671
	speed: 0.0841s/iter; left time: 3295.1402s
	iters: 300, epoch: 17 | loss: 0.0028377
	speed: 0.0777s/iter; left time: 3038.3456s
	iters: 400, epoch: 17 | loss: 0.0041800
	speed: 0.0724s/iter; left time: 2823.5609s
Epoch: 17 cost time: 37.53633189201355
Epoch: 17, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.962834 --> -0.969124).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0089273
	speed: 0.3178s/iter; left time: 12340.5984s
	iters: 200, epoch: 18 | loss: 0.0021148
	speed: 0.0787s/iter; left time: 3048.1619s
	iters: 300, epoch: 18 | loss: 0.0031389
	speed: 0.0747s/iter; left time: 2885.8430s
	iters: 400, epoch: 18 | loss: 0.0200854
	speed: 0.0755s/iter; left time: 2909.1388s
Epoch: 18 cost time: 36.98556590080261
Epoch: 18, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0020787
	speed: 0.3225s/iter; left time: 12372.4415s
	iters: 200, epoch: 19 | loss: 0.0071015
	speed: 0.0864s/iter; left time: 3304.1367s
	iters: 300, epoch: 19 | loss: 0.0205611
	speed: 0.0857s/iter; left time: 3271.0689s
	iters: 400, epoch: 19 | loss: 0.0069563
	speed: 0.0813s/iter; left time: 3095.5023s
Epoch: 19 cost time: 39.25229525566101
Epoch: 19, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.282 Vali Acc: 0.943 Test Loss: 0.282 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0127060
	speed: 0.2890s/iter; left time: 10950.2438s
	iters: 200, epoch: 20 | loss: 0.0071855
	speed: 0.0732s/iter; left time: 2765.9953s
	iters: 300, epoch: 20 | loss: 0.0060775
	speed: 0.0859s/iter; left time: 3237.0609s
	iters: 400, epoch: 20 | loss: 0.0041217
	speed: 0.0764s/iter; left time: 2873.6866s
Epoch: 20 cost time: 36.142741203308105
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.456 Vali Acc: 0.934 Test Loss: 0.456 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0030470
	speed: 0.3023s/iter; left time: 11310.6731s
	iters: 200, epoch: 21 | loss: 0.0154508
	speed: 0.0749s/iter; left time: 2793.9080s
	iters: 300, epoch: 21 | loss: 0.0104844
	speed: 0.0732s/iter; left time: 2724.2795s
	iters: 400, epoch: 21 | loss: 0.0085234
	speed: 0.0735s/iter; left time: 2729.0995s
Epoch: 21 cost time: 36.74382209777832
Epoch: 21, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.240 Vali Acc: 0.955 Test Loss: 0.240 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1075799
	speed: 0.3193s/iter; left time: 11797.4824s
	iters: 200, epoch: 22 | loss: 0.0053617
	speed: 0.0822s/iter; left time: 3029.3732s
	iters: 300, epoch: 22 | loss: 0.0248988
	speed: 0.0847s/iter; left time: 3114.3933s
	iters: 400, epoch: 22 | loss: 0.0059305
	speed: 0.0839s/iter; left time: 3075.4203s
Epoch: 22 cost time: 41.172213315963745
Epoch: 22, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.955 Test Loss: 0.285 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0409663
	speed: 0.3157s/iter; left time: 11515.9179s
	iters: 200, epoch: 23 | loss: 0.4507747
	speed: 0.0824s/iter; left time: 2996.3758s
	iters: 300, epoch: 23 | loss: 0.0148459
	speed: 0.0821s/iter; left time: 2977.3618s
	iters: 400, epoch: 23 | loss: 0.0041509
	speed: 0.0889s/iter; left time: 3215.2727s
Epoch: 23 cost time: 39.982895374298096
Epoch: 23, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.241 Vali Acc: 0.960 Test Loss: 0.241 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0171819
	speed: 0.3117s/iter; left time: 11224.3299s
	iters: 200, epoch: 24 | loss: 0.0021881
	speed: 0.0844s/iter; left time: 3029.4903s
	iters: 300, epoch: 24 | loss: 0.0074808
	speed: 0.0772s/iter; left time: 2764.9228s
	iters: 400, epoch: 24 | loss: 0.0124158
	speed: 0.0729s/iter; left time: 2604.5200s
Epoch: 24 cost time: 37.09123253822327
Epoch: 24, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1664004
	speed: 0.2949s/iter; left time: 10483.1218s
	iters: 200, epoch: 25 | loss: 0.0047005
	speed: 0.0885s/iter; left time: 3136.3863s
	iters: 300, epoch: 25 | loss: 0.0254339
	speed: 0.0821s/iter; left time: 2903.2888s
	iters: 400, epoch: 25 | loss: 0.0031270
	speed: 0.0769s/iter; left time: 2709.4873s
Epoch: 25 cost time: 38.38318419456482
Epoch: 25, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.281 Vali Acc: 0.945 Test Loss: 0.281 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0051939
	speed: 0.3014s/iter; left time: 10571.2763s
	iters: 200, epoch: 26 | loss: 0.0301117
	speed: 0.0769s/iter; left time: 2688.2544s
	iters: 300, epoch: 26 | loss: 0.0018602
	speed: 0.0843s/iter; left time: 2941.6833s
	iters: 400, epoch: 26 | loss: 0.0010891
	speed: 0.0798s/iter; left time: 2773.9902s
Epoch: 26 cost time: 37.87597179412842
Epoch: 26, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.3446137
	speed: 0.3152s/iter; left time: 10906.9342s
	iters: 200, epoch: 27 | loss: 0.0132185
	speed: 0.0804s/iter; left time: 2774.6573s
	iters: 300, epoch: 27 | loss: 0.0040196
	speed: 0.0816s/iter; left time: 2805.9109s
	iters: 400, epoch: 27 | loss: 0.5706626
	speed: 0.0811s/iter; left time: 2782.5740s
Epoch: 27 cost time: 38.084168434143066
Epoch: 27, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.361 Vali Acc: 0.940 Test Loss: 0.361 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9691252144082333
model parameter : 758566
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2759559
	speed: 0.1047s/iter; left time: 4897.9037s
	iters: 200, epoch: 1 | loss: 0.5923836
	speed: 0.0777s/iter; left time: 3630.0305s
	iters: 300, epoch: 1 | loss: 0.3773431
	speed: 0.0742s/iter; left time: 3456.4056s
	iters: 400, epoch: 1 | loss: 0.2194885
	speed: 0.0745s/iter; left time: 3463.1274s
Epoch: 1 cost time: 38.76750922203064
Epoch: 1, Steps: 469 | Train Loss: 0.809 Vali Loss: 0.338 Vali Acc: 0.912 Test Loss: 0.338 Test Acc: 0.912
Validation loss decreased (inf --> -0.912232).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4463540
	speed: 0.2920s/iter; left time: 13530.5653s
	iters: 200, epoch: 2 | loss: 0.2272573
	speed: 0.0770s/iter; left time: 3560.1761s
	iters: 300, epoch: 2 | loss: 0.4746439
	speed: 0.0764s/iter; left time: 3525.1937s
	iters: 400, epoch: 2 | loss: 0.1761827
	speed: 0.0778s/iter; left time: 3580.7597s
Epoch: 2 cost time: 36.714558601379395
Epoch: 2, Steps: 469 | Train Loss: 0.251 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.912232 --> -0.921953).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0178689
	speed: 0.2860s/iter; left time: 13116.2086s
	iters: 200, epoch: 3 | loss: 0.0364999
	speed: 0.0745s/iter; left time: 3410.8469s
	iters: 300, epoch: 3 | loss: 0.7640071
	speed: 0.0751s/iter; left time: 3429.2782s
	iters: 400, epoch: 3 | loss: 0.1112385
	speed: 0.0755s/iter; left time: 3440.2068s
Epoch: 3 cost time: 35.69711399078369
Epoch: 3, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.257 Vali Acc: 0.927 Test Loss: 0.257 Test Acc: 0.927
Validation loss decreased (-0.921953 --> -0.927385).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0617213
	speed: 0.3021s/iter; left time: 13713.7127s
	iters: 200, epoch: 4 | loss: 0.0305644
	speed: 0.0787s/iter; left time: 3564.6221s
	iters: 300, epoch: 4 | loss: 0.0164837
	speed: 0.0830s/iter; left time: 3750.2681s
	iters: 400, epoch: 4 | loss: 0.7993391
	speed: 0.0823s/iter; left time: 3710.9250s
Epoch: 4 cost time: 38.471505880355835
Epoch: 4, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.285 Vali Acc: 0.909 Test Loss: 0.285 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5531861
	speed: 0.3205s/iter; left time: 14400.4810s
	iters: 200, epoch: 5 | loss: 0.2618476
	speed: 0.0827s/iter; left time: 3705.0373s
	iters: 300, epoch: 5 | loss: 0.0937580
	speed: 0.0891s/iter; left time: 3984.7191s
	iters: 400, epoch: 5 | loss: 0.0144652
	speed: 0.0848s/iter; left time: 3786.3656s
Epoch: 5 cost time: 39.66966009140015
Epoch: 5, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.278 Vali Acc: 0.932 Test Loss: 0.278 Test Acc: 0.932
Validation loss decreased (-0.927385 --> -0.931672).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0517105
	speed: 0.3382s/iter; left time: 15036.2071s
	iters: 200, epoch: 6 | loss: 0.1353250
	speed: 0.0815s/iter; left time: 3615.9081s
	iters: 300, epoch: 6 | loss: 0.0885670
	speed: 0.0779s/iter; left time: 3446.0241s
	iters: 400, epoch: 6 | loss: 0.2309928
	speed: 0.0749s/iter; left time: 3306.9794s
Epoch: 6 cost time: 38.02876400947571
Epoch: 6, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
Validation loss decreased (-0.931672 --> -0.939106).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0710379
	speed: 0.3124s/iter; left time: 13741.1043s
	iters: 200, epoch: 7 | loss: 0.1062771
	speed: 0.0831s/iter; left time: 3646.3786s
	iters: 300, epoch: 7 | loss: 0.0159946
	speed: 0.0843s/iter; left time: 3691.3237s
	iters: 400, epoch: 7 | loss: 0.0056044
	speed: 0.0802s/iter; left time: 3501.5768s
Epoch: 7 cost time: 38.858622312545776
Epoch: 7, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
Validation loss decreased (-0.939106 --> -0.943394).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4108543
	speed: 0.3313s/iter; left time: 14419.1339s
	iters: 200, epoch: 8 | loss: 0.1552808
	speed: 0.0758s/iter; left time: 3290.3413s
	iters: 300, epoch: 8 | loss: 0.2633558
	speed: 0.0763s/iter; left time: 3305.5650s
	iters: 400, epoch: 8 | loss: 0.0944584
	speed: 0.0811s/iter; left time: 3507.0611s
Epoch: 8 cost time: 37.546711444854736
Epoch: 8, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.943394 --> -0.956259).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0100934
	speed: 0.3162s/iter; left time: 13613.3290s
	iters: 200, epoch: 9 | loss: 0.0095305
	speed: 0.0867s/iter; left time: 3725.4287s
	iters: 300, epoch: 9 | loss: 0.1161683
	speed: 0.0808s/iter; left time: 3462.1269s
	iters: 400, epoch: 9 | loss: 0.0188341
	speed: 0.0814s/iter; left time: 3479.4202s
Epoch: 9 cost time: 39.070478677749634
Epoch: 9, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0135637
	speed: 0.3213s/iter; left time: 13682.7914s
	iters: 200, epoch: 10 | loss: 0.0069846
	speed: 0.0798s/iter; left time: 3390.2766s
	iters: 300, epoch: 10 | loss: 0.0055603
	speed: 0.0870s/iter; left time: 3688.9066s
	iters: 400, epoch: 10 | loss: 0.0515717
	speed: 0.0873s/iter; left time: 3692.7584s
Epoch: 10 cost time: 39.91112208366394
Epoch: 10, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0070377
	speed: 0.3372s/iter; left time: 14198.7512s
	iters: 200, epoch: 11 | loss: 0.0061355
	speed: 0.0836s/iter; left time: 3511.4241s
	iters: 300, epoch: 11 | loss: 0.0319256
	speed: 0.0837s/iter; left time: 3508.6912s
	iters: 400, epoch: 11 | loss: 0.5562238
	speed: 0.0899s/iter; left time: 3757.7510s
Epoch: 11 cost time: 41.06283235549927
Epoch: 11, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
Validation loss decreased (-0.956259 --> -0.961119).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0562406
	speed: 0.3231s/iter; left time: 13454.1330s
	iters: 200, epoch: 12 | loss: 0.0065223
	speed: 0.0858s/iter; left time: 3566.0514s
	iters: 300, epoch: 12 | loss: 0.6978958
	speed: 0.0779s/iter; left time: 3227.7267s
	iters: 400, epoch: 12 | loss: 0.0052640
	speed: 0.0792s/iter; left time: 3274.6184s
Epoch: 12 cost time: 38.08564209938049
Epoch: 12, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
Validation loss decreased (-0.961119 --> -0.963120).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0039813
	speed: 0.3365s/iter; left time: 13854.1039s
	iters: 200, epoch: 13 | loss: 0.0112287
	speed: 0.0878s/iter; left time: 3605.1329s
	iters: 300, epoch: 13 | loss: 0.0283038
	speed: 0.0841s/iter; left time: 3447.7865s
	iters: 400, epoch: 13 | loss: 0.0050348
	speed: 0.0864s/iter; left time: 3533.1011s
Epoch: 13 cost time: 40.32763195037842
Epoch: 13, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5295210
	speed: 0.3049s/iter; left time: 12411.2379s
	iters: 200, epoch: 14 | loss: 0.0112361
	speed: 0.0869s/iter; left time: 3529.7768s
	iters: 300, epoch: 14 | loss: 0.0047611
	speed: 0.0829s/iter; left time: 3358.2718s
	iters: 400, epoch: 14 | loss: 0.0432689
	speed: 0.0811s/iter; left time: 3278.5159s
Epoch: 14 cost time: 39.66201066970825
Epoch: 14, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0122285
	speed: 0.3159s/iter; left time: 12710.0936s
	iters: 200, epoch: 15 | loss: 0.0019451
	speed: 0.0795s/iter; left time: 3191.0400s
	iters: 300, epoch: 15 | loss: 0.0052895
	speed: 0.0799s/iter; left time: 3198.9182s
	iters: 400, epoch: 15 | loss: 0.0060120
	speed: 0.0784s/iter; left time: 3132.7141s
Epoch: 15 cost time: 37.25765800476074
Epoch: 15, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.266 Vali Acc: 0.943 Test Loss: 0.266 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0130553
	speed: 0.3070s/iter; left time: 12207.9546s
	iters: 200, epoch: 16 | loss: 0.0188886
	speed: 0.0796s/iter; left time: 3157.7050s
	iters: 300, epoch: 16 | loss: 0.0019135
	speed: 0.0833s/iter; left time: 3294.3892s
	iters: 400, epoch: 16 | loss: 0.0232458
	speed: 0.0833s/iter; left time: 3289.4418s
Epoch: 16 cost time: 38.80780005455017
Epoch: 16, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0039349
	speed: 0.3099s/iter; left time: 12177.6862s
	iters: 200, epoch: 17 | loss: 0.0387188
	speed: 0.0744s/iter; left time: 2916.3189s
	iters: 300, epoch: 17 | loss: 0.0180038
	speed: 0.0769s/iter; left time: 3007.7085s
	iters: 400, epoch: 17 | loss: 0.0691621
	speed: 0.0859s/iter; left time: 3349.5460s
Epoch: 17 cost time: 37.467124700546265
Epoch: 17, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1449822
	speed: 0.3314s/iter; left time: 12866.4025s
	iters: 200, epoch: 18 | loss: 0.0046799
	speed: 0.0887s/iter; left time: 3434.5182s
	iters: 300, epoch: 18 | loss: 0.0741246
	speed: 0.0858s/iter; left time: 3315.3490s
	iters: 400, epoch: 18 | loss: 0.5606920
	speed: 0.0909s/iter; left time: 3502.6250s
Epoch: 18 cost time: 41.05395174026489
Epoch: 18, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0112865
	speed: 0.3082s/iter; left time: 11820.6456s
	iters: 200, epoch: 19 | loss: 0.0044839
	speed: 0.0827s/iter; left time: 3162.9592s
	iters: 300, epoch: 19 | loss: 0.0057740
	speed: 0.0801s/iter; left time: 3055.4624s
	iters: 400, epoch: 19 | loss: 0.0098547
	speed: 0.0833s/iter; left time: 3169.2167s
Epoch: 19 cost time: 39.02478766441345
Epoch: 19, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0034492
	speed: 0.3285s/iter; left time: 12445.1552s
	iters: 200, epoch: 20 | loss: 0.0318369
	speed: 0.0833s/iter; left time: 3149.1914s
	iters: 300, epoch: 20 | loss: 0.0078203
	speed: 0.0831s/iter; left time: 3132.1682s
	iters: 400, epoch: 20 | loss: 0.3673452
	speed: 0.0834s/iter; left time: 3133.3214s
Epoch: 20 cost time: 39.516252279281616
Epoch: 20, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
Validation loss decreased (-0.963120 --> -0.970553).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0194324
	speed: 0.3175s/iter; left time: 11881.3442s
	iters: 200, epoch: 21 | loss: 0.0063960
	speed: 0.0766s/iter; left time: 2858.6344s
	iters: 300, epoch: 21 | loss: 0.0097009
	speed: 0.0816s/iter; left time: 3035.8632s
	iters: 400, epoch: 21 | loss: 0.0169756
	speed: 0.0834s/iter; left time: 3097.0635s
Epoch: 21 cost time: 38.369956970214844
Epoch: 21, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0027296
	speed: 0.3326s/iter; left time: 12291.0381s
	iters: 200, epoch: 22 | loss: 0.0074295
	speed: 0.0769s/iter; left time: 2834.9854s
	iters: 300, epoch: 22 | loss: 0.0080724
	speed: 0.0769s/iter; left time: 2826.7079s
	iters: 400, epoch: 22 | loss: 0.0731230
	speed: 0.0778s/iter; left time: 2853.1538s
Epoch: 22 cost time: 37.99699068069458
Epoch: 22, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.389 Vali Acc: 0.924 Test Loss: 0.389 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0142411
	speed: 0.3316s/iter; left time: 12098.3297s
	iters: 200, epoch: 23 | loss: 0.0189956
	speed: 0.0893s/iter; left time: 3247.6399s
	iters: 300, epoch: 23 | loss: 0.0535628
	speed: 0.0906s/iter; left time: 3285.4420s
	iters: 400, epoch: 23 | loss: 0.0040306
	speed: 0.0889s/iter; left time: 3217.3383s
Epoch: 23 cost time: 41.55644202232361
Epoch: 23, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.257 Vali Acc: 0.954 Test Loss: 0.257 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0030639
	speed: 0.3596s/iter; left time: 12950.3117s
	iters: 200, epoch: 24 | loss: 0.0142512
	speed: 0.0884s/iter; left time: 3174.4409s
	iters: 300, epoch: 24 | loss: 0.0515287
	speed: 0.0918s/iter; left time: 3287.8453s
	iters: 400, epoch: 24 | loss: 0.0048766
	speed: 0.0825s/iter; left time: 2944.7700s
Epoch: 24 cost time: 40.706111431121826
Epoch: 24, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.300 Vali Acc: 0.939 Test Loss: 0.300 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.3123001
	speed: 0.3259s/iter; left time: 11582.5145s
	iters: 200, epoch: 25 | loss: 0.0041241
	speed: 0.0787s/iter; left time: 2789.4892s
	iters: 300, epoch: 25 | loss: 0.0021559
	speed: 0.0807s/iter; left time: 2853.3026s
	iters: 400, epoch: 25 | loss: 0.0952373
	speed: 0.0845s/iter; left time: 2977.8238s
Epoch: 25 cost time: 38.84402918815613
Epoch: 25, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0134451
	speed: 0.3331s/iter; left time: 11683.4459s
	iters: 200, epoch: 26 | loss: 0.0842882
	speed: 0.0903s/iter; left time: 3158.0868s
	iters: 300, epoch: 26 | loss: 0.0076687
	speed: 0.0801s/iter; left time: 2794.8983s
	iters: 400, epoch: 26 | loss: 0.0275902
	speed: 0.0782s/iter; left time: 2720.0362s
Epoch: 26 cost time: 38.962589740753174
Epoch: 26, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.247 Vali Acc: 0.945 Test Loss: 0.247 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0049988
	speed: 0.3173s/iter; left time: 10979.1701s
	iters: 200, epoch: 27 | loss: 0.0031997
	speed: 0.0811s/iter; left time: 2799.8199s
	iters: 300, epoch: 27 | loss: 0.0104860
	speed: 0.0831s/iter; left time: 2858.6673s
	iters: 400, epoch: 27 | loss: 0.0089197
	speed: 0.0850s/iter; left time: 2916.6755s
Epoch: 27 cost time: 39.18848252296448
Epoch: 27, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.215 Vali Acc: 0.961 Test Loss: 0.215 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1903171
	speed: 0.3280s/iter; left time: 11196.7611s
	iters: 200, epoch: 28 | loss: 0.0648272
	speed: 0.0866s/iter; left time: 2948.0060s
	iters: 300, epoch: 28 | loss: 0.0099898
	speed: 0.0806s/iter; left time: 2735.8996s
	iters: 400, epoch: 28 | loss: 0.5341601
	speed: 0.0791s/iter; left time: 2678.2248s
Epoch: 28 cost time: 39.32803797721863
Epoch: 28, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.227 Vali Acc: 0.955 Test Loss: 0.227 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0185742
	speed: 0.3327s/iter; left time: 11200.9565s
	iters: 200, epoch: 29 | loss: 0.0082236
	speed: 0.0866s/iter; left time: 2908.5905s
	iters: 300, epoch: 29 | loss: 0.0107511
	speed: 0.0828s/iter; left time: 2771.1461s
	iters: 400, epoch: 29 | loss: 0.2255485
	speed: 0.0851s/iter; left time: 2838.5373s
Epoch: 29 cost time: 40.657774686813354
Epoch: 29, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2666374
	speed: 0.3278s/iter; left time: 10881.4291s
	iters: 200, epoch: 30 | loss: 0.0026465
	speed: 0.0750s/iter; left time: 2481.3656s
	iters: 300, epoch: 30 | loss: 0.0077849
	speed: 0.0827s/iter; left time: 2730.6005s
	iters: 400, epoch: 30 | loss: 0.0041003
	speed: 0.0790s/iter; left time: 2597.6247s
Epoch: 30 cost time: 37.453528881073
Epoch: 30, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9705546026300743
model parameter : 758438
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1801369
	speed: 0.0949s/iter; left time: 4440.9713s
	iters: 200, epoch: 1 | loss: 0.8470708
	speed: 0.0760s/iter; left time: 3548.3892s
	iters: 300, epoch: 1 | loss: 0.3186559
	speed: 0.0771s/iter; left time: 3592.0979s
	iters: 400, epoch: 1 | loss: 0.2776624
	speed: 0.0792s/iter; left time: 3684.9592s
Epoch: 1 cost time: 38.47023320198059
Epoch: 1, Steps: 469 | Train Loss: 0.769 Vali Loss: 0.410 Vali Acc: 0.886 Test Loss: 0.410 Test Acc: 0.886
Validation loss decreased (inf --> -0.885645).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1123740
	speed: 0.3183s/iter; left time: 14747.0042s
	iters: 200, epoch: 2 | loss: 0.3403809
	speed: 0.0860s/iter; left time: 3975.6415s
	iters: 300, epoch: 2 | loss: 0.2678421
	speed: 0.0749s/iter; left time: 3455.4088s
	iters: 400, epoch: 2 | loss: 0.4032462
	speed: 0.0767s/iter; left time: 3531.7262s
Epoch: 2 cost time: 37.68603301048279
Epoch: 2, Steps: 469 | Train Loss: 0.232 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
Validation loss decreased (-0.885645 --> -0.928242).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2996984
	speed: 0.3256s/iter; left time: 14935.2023s
	iters: 200, epoch: 3 | loss: 0.0326230
	speed: 0.0822s/iter; left time: 3762.3094s
	iters: 300, epoch: 3 | loss: 0.0240714
	speed: 0.0911s/iter; left time: 4159.8169s
	iters: 400, epoch: 3 | loss: 0.0873669
	speed: 0.0879s/iter; left time: 4006.0264s
Epoch: 3 cost time: 40.513800382614136
Epoch: 3, Steps: 469 | Train Loss: 0.186 Vali Loss: 0.205 Vali Acc: 0.940 Test Loss: 0.205 Test Acc: 0.940
Validation loss decreased (-0.928242 --> -0.939964).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4501452
	speed: 0.3467s/iter; left time: 15739.6673s
	iters: 200, epoch: 4 | loss: 0.0275228
	speed: 0.0829s/iter; left time: 3756.8137s
	iters: 300, epoch: 4 | loss: 0.3390000
	speed: 0.0848s/iter; left time: 3833.5415s
	iters: 400, epoch: 4 | loss: 0.3894900
	speed: 0.0898s/iter; left time: 4049.4133s
Epoch: 4 cost time: 40.85825824737549
Epoch: 4, Steps: 469 | Train Loss: 0.196 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
Validation loss decreased (-0.939964 --> -0.943394).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1019986
	speed: 0.3533s/iter; left time: 15871.4219s
	iters: 200, epoch: 5 | loss: 0.0892385
	speed: 0.0777s/iter; left time: 3481.3744s
	iters: 300, epoch: 5 | loss: 0.1049547
	speed: 0.0785s/iter; left time: 3512.8633s
	iters: 400, epoch: 5 | loss: 0.3778449
	speed: 0.0766s/iter; left time: 3416.0807s
Epoch: 5 cost time: 38.05312728881836
Epoch: 5, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.943394 --> -0.943966).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4725039
	speed: 0.3266s/iter; left time: 14517.5531s
	iters: 200, epoch: 6 | loss: 0.0249634
	speed: 0.0803s/iter; left time: 3559.8506s
	iters: 300, epoch: 6 | loss: 0.2393215
	speed: 0.0832s/iter; left time: 3683.9008s
	iters: 400, epoch: 6 | loss: 0.0107190
	speed: 0.0785s/iter; left time: 3464.4170s
Epoch: 6 cost time: 38.049800872802734
Epoch: 6, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.338 Vali Acc: 0.923 Test Loss: 0.338 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1275343
	speed: 0.3117s/iter; left time: 13711.7961s
	iters: 200, epoch: 7 | loss: 0.6168540
	speed: 0.0852s/iter; left time: 3740.8628s
	iters: 300, epoch: 7 | loss: 0.0157967
	speed: 0.0789s/iter; left time: 3454.7101s
	iters: 400, epoch: 7 | loss: 0.2255589
	speed: 0.0837s/iter; left time: 3657.0626s
Epoch: 7 cost time: 39.3828387260437
Epoch: 7, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.233 Vali Acc: 0.929 Test Loss: 0.233 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0481309
	speed: 0.3371s/iter; left time: 14670.6354s
	iters: 200, epoch: 8 | loss: 0.1069921
	speed: 0.0873s/iter; left time: 3788.4093s
	iters: 300, epoch: 8 | loss: 0.0471501
	speed: 0.0835s/iter; left time: 3617.6227s
	iters: 400, epoch: 8 | loss: 0.0713477
	speed: 0.0784s/iter; left time: 3387.6640s
Epoch: 8 cost time: 39.373056411743164
Epoch: 8, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.943966 --> -0.966551).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0041292
	speed: 0.3411s/iter; left time: 14683.0239s
	iters: 200, epoch: 9 | loss: 0.0115742
	speed: 0.0837s/iter; left time: 3595.4510s
	iters: 300, epoch: 9 | loss: 0.0606591
	speed: 0.0879s/iter; left time: 3766.5428s
	iters: 400, epoch: 9 | loss: 0.2297202
	speed: 0.0921s/iter; left time: 3938.8894s
Epoch: 9 cost time: 41.474408864974976
Epoch: 9, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0095686
	speed: 0.3451s/iter; left time: 14693.8850s
	iters: 200, epoch: 10 | loss: 0.0941430
	speed: 0.0822s/iter; left time: 3489.9978s
	iters: 300, epoch: 10 | loss: 0.0492706
	speed: 0.0838s/iter; left time: 3552.8998s
	iters: 400, epoch: 10 | loss: 0.0348100
	speed: 0.0840s/iter; left time: 3551.2350s
Epoch: 10 cost time: 40.367111682891846
Epoch: 10, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.182 Vali Acc: 0.961 Test Loss: 0.182 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0082072
	speed: 0.3193s/iter; left time: 13446.7761s
	iters: 200, epoch: 11 | loss: 0.0484339
	speed: 0.0848s/iter; left time: 3563.3805s
	iters: 300, epoch: 11 | loss: 0.0685616
	speed: 0.0852s/iter; left time: 3572.8759s
	iters: 400, epoch: 11 | loss: 0.4277287
	speed: 0.0812s/iter; left time: 3396.6293s
Epoch: 11 cost time: 39.50999140739441
Epoch: 11, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0087544
	speed: 0.3297s/iter; left time: 13731.1106s
	iters: 200, epoch: 12 | loss: 0.0063619
	speed: 0.0771s/iter; left time: 3201.6798s
	iters: 300, epoch: 12 | loss: 0.1991937
	speed: 0.0837s/iter; left time: 3469.1854s
	iters: 400, epoch: 12 | loss: 0.0289311
	speed: 0.0874s/iter; left time: 3611.7953s
Epoch: 12 cost time: 38.312896490097046
Epoch: 12, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4026060
	speed: 0.3125s/iter; left time: 12865.5483s
	iters: 200, epoch: 13 | loss: 0.0065236
	speed: 0.0787s/iter; left time: 3231.0313s
	iters: 300, epoch: 13 | loss: 0.0218483
	speed: 0.0770s/iter; left time: 3155.3458s
	iters: 400, epoch: 13 | loss: 0.0736174
	speed: 0.0795s/iter; left time: 3249.8606s
Epoch: 13 cost time: 38.78995943069458
Epoch: 13, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0062826
	speed: 0.3248s/iter; left time: 13222.2830s
	iters: 200, epoch: 14 | loss: 0.0178487
	speed: 0.0928s/iter; left time: 3767.7223s
	iters: 300, epoch: 14 | loss: 0.1583461
	speed: 0.0900s/iter; left time: 3644.6778s
	iters: 400, epoch: 14 | loss: 0.0442442
	speed: 0.0863s/iter; left time: 3486.9803s
Epoch: 14 cost time: 41.927618741989136
Epoch: 14, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.966551 --> -0.967980).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0036173
	speed: 0.3553s/iter; left time: 14293.9617s
	iters: 200, epoch: 15 | loss: 0.1301001
	speed: 0.0891s/iter; left time: 3576.9117s
	iters: 300, epoch: 15 | loss: 0.1252860
	speed: 0.0859s/iter; left time: 3440.6327s
	iters: 400, epoch: 15 | loss: 0.0386071
	speed: 0.0897s/iter; left time: 3584.0720s
Epoch: 15 cost time: 42.49631953239441
Epoch: 15, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.277 Vali Acc: 0.948 Test Loss: 0.277 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0043819
	speed: 0.3578s/iter; left time: 14226.5251s
	iters: 200, epoch: 16 | loss: 0.0052590
	speed: 0.0885s/iter; left time: 3511.3088s
	iters: 300, epoch: 16 | loss: 0.0243442
	speed: 0.0844s/iter; left time: 3340.2332s
	iters: 400, epoch: 16 | loss: 0.0070979
	speed: 0.0801s/iter; left time: 3160.5802s
Epoch: 16 cost time: 40.54262137413025
Epoch: 16, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.967980 --> -0.975127).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0058420
	speed: 0.3346s/iter; left time: 13149.3705s
	iters: 200, epoch: 17 | loss: 0.0297278
	speed: 0.0808s/iter; left time: 3165.4083s
	iters: 300, epoch: 17 | loss: 0.1728587
	speed: 0.0858s/iter; left time: 3354.3964s
	iters: 400, epoch: 17 | loss: 0.0173960
	speed: 0.0860s/iter; left time: 3352.3793s
Epoch: 17 cost time: 39.77761483192444
Epoch: 17, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1935564
	speed: 0.3460s/iter; left time: 13436.2042s
	iters: 200, epoch: 18 | loss: 0.0042234
	speed: 0.0841s/iter; left time: 3255.7634s
	iters: 300, epoch: 18 | loss: 0.1607702
	speed: 0.0811s/iter; left time: 3131.8504s
	iters: 400, epoch: 18 | loss: 0.0448161
	speed: 0.0821s/iter; left time: 3163.2812s
Epoch: 18 cost time: 41.06132173538208
Epoch: 18, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0171604
	speed: 0.3168s/iter; left time: 12153.6587s
	iters: 200, epoch: 19 | loss: 0.0023062
	speed: 0.0818s/iter; left time: 3128.6469s
	iters: 300, epoch: 19 | loss: 0.0029373
	speed: 0.0872s/iter; left time: 3326.4047s
	iters: 400, epoch: 19 | loss: 0.0073410
	speed: 0.0876s/iter; left time: 3335.8094s
Epoch: 19 cost time: 39.83056092262268
Epoch: 19, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.355 Vali Acc: 0.928 Test Loss: 0.355 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0593537
	speed: 0.3537s/iter; left time: 13402.4503s
	iters: 200, epoch: 20 | loss: 0.0117734
	speed: 0.0871s/iter; left time: 3290.3593s
	iters: 300, epoch: 20 | loss: 0.0116206
	speed: 0.0919s/iter; left time: 3462.1473s
	iters: 400, epoch: 20 | loss: 0.4960066
	speed: 0.0829s/iter; left time: 3117.9382s
Epoch: 20 cost time: 41.85122227668762
Epoch: 20, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2825924
	speed: 0.3214s/iter; left time: 12025.3546s
	iters: 200, epoch: 21 | loss: 0.0644374
	speed: 0.0880s/iter; left time: 3285.8495s
	iters: 300, epoch: 21 | loss: 0.0224636
	speed: 0.0855s/iter; left time: 3180.8246s
	iters: 400, epoch: 21 | loss: 0.0045053
	speed: 0.0852s/iter; left time: 3163.4709s
Epoch: 21 cost time: 40.41395854949951
Epoch: 21, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0060273
	speed: 0.3454s/iter; left time: 12762.0456s
	iters: 200, epoch: 22 | loss: 0.0066593
	speed: 0.0871s/iter; left time: 3208.2714s
	iters: 300, epoch: 22 | loss: 0.0066303
	speed: 0.0815s/iter; left time: 2996.5859s
	iters: 400, epoch: 22 | loss: 0.0039357
	speed: 0.0758s/iter; left time: 2779.8780s
Epoch: 22 cost time: 39.838746070861816
Epoch: 22, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2154419
	speed: 0.3121s/iter; left time: 11385.2651s
	iters: 200, epoch: 23 | loss: 0.0032807
	speed: 0.0842s/iter; left time: 3062.3443s
	iters: 300, epoch: 23 | loss: 0.0048834
	speed: 0.0851s/iter; left time: 3086.9611s
	iters: 400, epoch: 23 | loss: 0.0030592
	speed: 0.0851s/iter; left time: 3078.3287s
Epoch: 23 cost time: 39.457133769989014
Epoch: 23, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.3121747
	speed: 0.3260s/iter; left time: 11739.1804s
	iters: 200, epoch: 24 | loss: 0.0040725
	speed: 0.0718s/iter; left time: 2579.4644s
	iters: 300, epoch: 24 | loss: 0.0431541
	speed: 0.0797s/iter; left time: 2854.1506s
	iters: 400, epoch: 24 | loss: 0.0058139
	speed: 0.0809s/iter; left time: 2887.8682s
Epoch: 24 cost time: 36.912893533706665
Epoch: 24, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.313 Vali Acc: 0.951 Test Loss: 0.313 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2001088
	speed: 0.3350s/iter; left time: 11909.0421s
	iters: 200, epoch: 25 | loss: 0.0085880
	speed: 0.0887s/iter; left time: 3144.2902s
	iters: 300, epoch: 25 | loss: 0.0024666
	speed: 0.0902s/iter; left time: 3186.7818s
	iters: 400, epoch: 25 | loss: 0.0179863
	speed: 0.0929s/iter; left time: 3273.2356s
Epoch: 25 cost time: 42.75050139427185
Epoch: 25, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0341841
	speed: 0.3827s/iter; left time: 13424.5787s
	iters: 200, epoch: 26 | loss: 0.0170490
	speed: 0.0890s/iter; left time: 3114.4516s
	iters: 300, epoch: 26 | loss: 0.0910710
	speed: 0.0881s/iter; left time: 3072.4884s
	iters: 400, epoch: 26 | loss: 0.0088340
	speed: 0.0906s/iter; left time: 3150.7080s
Epoch: 26 cost time: 42.77802586555481
Epoch: 26, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 758310
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8986032
	speed: 0.1118s/iter; left time: 5232.5545s
	iters: 200, epoch: 1 | loss: 0.8590257
	speed: 0.0953s/iter; left time: 4450.7405s
	iters: 300, epoch: 1 | loss: 0.3996676
	speed: 0.0835s/iter; left time: 3891.3696s
	iters: 400, epoch: 1 | loss: 0.3654399
	speed: 0.0809s/iter; left time: 3760.8927s
Epoch: 1 cost time: 43.5758912563324
Epoch: 1, Steps: 469 | Train Loss: 0.801 Vali Loss: 0.306 Vali Acc: 0.915 Test Loss: 0.306 Test Acc: 0.915
Validation loss decreased (inf --> -0.914805).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1181044
	speed: 0.3586s/iter; left time: 16613.8812s
	iters: 200, epoch: 2 | loss: 0.3985265
	speed: 0.0914s/iter; left time: 4224.0535s
	iters: 300, epoch: 2 | loss: 0.1670663
	speed: 0.0904s/iter; left time: 4170.9298s
	iters: 400, epoch: 2 | loss: 0.2863174
	speed: 0.0879s/iter; left time: 4043.9206s
Epoch: 2 cost time: 41.942344427108765
Epoch: 2, Steps: 469 | Train Loss: 0.234 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
Validation loss decreased (-0.914805 --> -0.945681).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1076669
	speed: 0.3704s/iter; left time: 16989.1973s
	iters: 200, epoch: 3 | loss: 0.0778478
	speed: 0.0896s/iter; left time: 4098.1348s
	iters: 300, epoch: 3 | loss: 0.0758993
	speed: 0.0929s/iter; left time: 4240.3312s
	iters: 400, epoch: 3 | loss: 0.0162933
	speed: 0.0863s/iter; left time: 3930.4254s
Epoch: 3 cost time: 41.64665198326111
Epoch: 3, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.356 Vali Acc: 0.896 Test Loss: 0.356 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3770610
	speed: 0.3587s/iter; left time: 16284.4027s
	iters: 200, epoch: 4 | loss: 0.0725986
	speed: 0.0852s/iter; left time: 3857.4635s
	iters: 300, epoch: 4 | loss: 0.4998096
	speed: 0.0829s/iter; left time: 3746.1991s
	iters: 400, epoch: 4 | loss: 0.1837946
	speed: 0.0835s/iter; left time: 3763.9021s
Epoch: 4 cost time: 39.79858422279358
Epoch: 4, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
Validation loss decreased (-0.945681 --> -0.953400).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0496068
	speed: 0.3698s/iter; left time: 16614.4768s
	iters: 200, epoch: 5 | loss: 0.1012320
	speed: 0.0820s/iter; left time: 3673.8915s
	iters: 300, epoch: 5 | loss: 0.4599911
	speed: 0.0861s/iter; left time: 3850.9957s
	iters: 400, epoch: 5 | loss: 0.0140063
	speed: 0.0874s/iter; left time: 3902.3355s
Epoch: 5 cost time: 40.584766149520874
Epoch: 5, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.325 Vali Acc: 0.912 Test Loss: 0.325 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1411320
	speed: 0.3716s/iter; left time: 16519.9996s
	iters: 200, epoch: 6 | loss: 0.0194048
	speed: 0.0860s/iter; left time: 3814.9086s
	iters: 300, epoch: 6 | loss: 0.2163922
	speed: 0.0901s/iter; left time: 3988.7889s
	iters: 400, epoch: 6 | loss: 0.0889864
	speed: 0.0885s/iter; left time: 3906.5810s
Epoch: 6 cost time: 41.55930519104004
Epoch: 6, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.246 Vali Acc: 0.936 Test Loss: 0.246 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3221054
	speed: 0.3868s/iter; left time: 17014.7677s
	iters: 200, epoch: 7 | loss: 0.1271435
	speed: 0.0929s/iter; left time: 4077.0074s
	iters: 300, epoch: 7 | loss: 0.0191165
	speed: 0.0857s/iter; left time: 3753.7559s
	iters: 400, epoch: 7 | loss: 0.0262379
	speed: 0.0869s/iter; left time: 3797.3080s
Epoch: 7 cost time: 41.52992486953735
Epoch: 7, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (-0.953400 --> -0.959404).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0344871
	speed: 0.3765s/iter; left time: 16386.3378s
	iters: 200, epoch: 8 | loss: 0.0505654
	speed: 0.0833s/iter; left time: 3615.6336s
	iters: 300, epoch: 8 | loss: 0.2205233
	speed: 0.0849s/iter; left time: 3678.4050s
	iters: 400, epoch: 8 | loss: 0.1465227
	speed: 0.0824s/iter; left time: 3562.4274s
Epoch: 8 cost time: 39.922749280929565
Epoch: 8, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5168364
	speed: 0.3761s/iter; left time: 16191.9787s
	iters: 200, epoch: 9 | loss: 0.0213985
	speed: 0.0857s/iter; left time: 3679.8579s
	iters: 300, epoch: 9 | loss: 0.0494097
	speed: 0.0894s/iter; left time: 3832.5189s
	iters: 400, epoch: 9 | loss: 0.1777766
	speed: 0.0868s/iter; left time: 3711.9377s
Epoch: 9 cost time: 41.12649607658386
Epoch: 9, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0419312
	speed: 0.3574s/iter; left time: 15216.7422s
	iters: 200, epoch: 10 | loss: 0.4320664
	speed: 0.0805s/iter; left time: 3421.4848s
	iters: 300, epoch: 10 | loss: 0.1562564
	speed: 0.0805s/iter; left time: 3412.5754s
	iters: 400, epoch: 10 | loss: 0.0255315
	speed: 0.0818s/iter; left time: 3458.2998s
Epoch: 10 cost time: 37.80976724624634
Epoch: 10, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.264 Vali Acc: 0.942 Test Loss: 0.264 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3191407
	speed: 0.3405s/iter; left time: 14337.9227s
	iters: 200, epoch: 11 | loss: 0.0051125
	speed: 0.0889s/iter; left time: 3734.6346s
	iters: 300, epoch: 11 | loss: 0.0091496
	speed: 0.0880s/iter; left time: 3688.7395s
	iters: 400, epoch: 11 | loss: 0.2824104
	speed: 0.0820s/iter; left time: 3429.1479s
Epoch: 11 cost time: 40.90713691711426
Epoch: 11, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.271 Vali Acc: 0.947 Test Loss: 0.271 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0098812
	speed: 0.3615s/iter; left time: 15054.3265s
	iters: 200, epoch: 12 | loss: 0.0351516
	speed: 0.0799s/iter; left time: 3318.6162s
	iters: 300, epoch: 12 | loss: 0.0060373
	speed: 0.0787s/iter; left time: 3261.8005s
	iters: 400, epoch: 12 | loss: 0.2446689
	speed: 0.0787s/iter; left time: 3255.4047s
Epoch: 12 cost time: 38.26602530479431
Epoch: 12, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.959404 --> -0.966265).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0724804
	speed: 0.3618s/iter; left time: 14896.9809s
	iters: 200, epoch: 13 | loss: 0.1031100
	speed: 0.0846s/iter; left time: 3475.6493s
	iters: 300, epoch: 13 | loss: 0.0044777
	speed: 0.0821s/iter; left time: 3364.0551s
	iters: 400, epoch: 13 | loss: 0.0727526
	speed: 0.0837s/iter; left time: 3422.6306s
Epoch: 13 cost time: 40.12407374382019
Epoch: 13, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.328 Vali Acc: 0.923 Test Loss: 0.328 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1484782
	speed: 0.3501s/iter; left time: 14250.2368s
	iters: 200, epoch: 14 | loss: 0.0027564
	speed: 0.0853s/iter; left time: 3463.5348s
	iters: 300, epoch: 14 | loss: 0.0081933
	speed: 0.0871s/iter; left time: 3529.8033s
	iters: 400, epoch: 14 | loss: 0.0207411
	speed: 0.0845s/iter; left time: 3413.2699s
Epoch: 14 cost time: 39.800493240356445
Epoch: 14, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.255 Vali Acc: 0.947 Test Loss: 0.255 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0093098
	speed: 0.3487s/iter; left time: 14030.3932s
	iters: 200, epoch: 15 | loss: 0.2524955
	speed: 0.0797s/iter; left time: 3196.9643s
	iters: 300, epoch: 15 | loss: 0.0055991
	speed: 0.0819s/iter; left time: 3277.8297s
	iters: 400, epoch: 15 | loss: 0.0088089
	speed: 0.0775s/iter; left time: 3093.3227s
Epoch: 15 cost time: 38.176719188690186
Epoch: 15, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1152402
	speed: 0.3668s/iter; left time: 14585.2347s
	iters: 200, epoch: 16 | loss: 0.0092725
	speed: 0.0868s/iter; left time: 3444.2766s
	iters: 300, epoch: 16 | loss: 0.0155751
	speed: 0.0850s/iter; left time: 3361.2112s
	iters: 400, epoch: 16 | loss: 0.0107932
	speed: 0.0852s/iter; left time: 3363.5043s
Epoch: 16 cost time: 40.80605387687683
Epoch: 16, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.966265 --> -0.976271).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1286633
	speed: 0.3706s/iter; left time: 14563.0711s
	iters: 200, epoch: 17 | loss: 0.0284303
	speed: 0.0828s/iter; left time: 3243.9227s
	iters: 300, epoch: 17 | loss: 0.0239692
	speed: 0.0792s/iter; left time: 3095.4536s
	iters: 400, epoch: 17 | loss: 0.4865491
	speed: 0.0819s/iter; left time: 3194.1313s
Epoch: 17 cost time: 38.92525672912598
Epoch: 17, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.273 Vali Acc: 0.954 Test Loss: 0.273 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0192766
	speed: 0.3682s/iter; left time: 14296.9811s
	iters: 200, epoch: 18 | loss: 0.0711485
	speed: 0.0878s/iter; left time: 3400.3156s
	iters: 300, epoch: 18 | loss: 0.1315337
	speed: 0.0836s/iter; left time: 3228.5010s
	iters: 400, epoch: 18 | loss: 0.0212558
	speed: 0.0824s/iter; left time: 3175.5642s
Epoch: 18 cost time: 40.86816453933716
Epoch: 18, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0111066
	speed: 0.3327s/iter; left time: 12763.6756s
	iters: 200, epoch: 19 | loss: 0.0027512
	speed: 0.0779s/iter; left time: 2981.0269s
	iters: 300, epoch: 19 | loss: 0.0091546
	speed: 0.0790s/iter; left time: 3013.4332s
	iters: 400, epoch: 19 | loss: 0.0063490
	speed: 0.0747s/iter; left time: 2844.5705s
Epoch: 19 cost time: 36.330822706222534
Epoch: 19, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0185170
	speed: 0.3043s/iter; left time: 11531.5220s
	iters: 200, epoch: 20 | loss: 0.0069781
	speed: 0.0793s/iter; left time: 2996.0808s
	iters: 300, epoch: 20 | loss: 0.0049126
	speed: 0.0788s/iter; left time: 2969.5363s
	iters: 400, epoch: 20 | loss: 0.0116712
	speed: 0.0852s/iter; left time: 3201.5846s
Epoch: 20 cost time: 38.33130502700806
Epoch: 20, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.272 Vali Acc: 0.953 Test Loss: 0.272 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0030174
	speed: 0.2870s/iter; left time: 10741.6827s
	iters: 200, epoch: 21 | loss: 0.0292731
	speed: 0.0830s/iter; left time: 3098.7589s
	iters: 300, epoch: 21 | loss: 0.1600656
	speed: 0.0749s/iter; left time: 2788.7041s
	iters: 400, epoch: 21 | loss: 0.0356609
	speed: 0.0768s/iter; left time: 2849.9138s
Epoch: 21 cost time: 37.52182602882385
Epoch: 21, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1883216
	speed: 0.3308s/iter; left time: 12224.7942s
	iters: 200, epoch: 22 | loss: 0.0058221
	speed: 0.0832s/iter; left time: 3066.8704s
	iters: 300, epoch: 22 | loss: 0.0774425
	speed: 0.0855s/iter; left time: 3143.9020s
	iters: 400, epoch: 22 | loss: 0.0046210
	speed: 0.0902s/iter; left time: 3307.4448s
Epoch: 22 cost time: 40.014562368392944
Epoch: 22, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0262406
	speed: 0.3274s/iter; left time: 11945.0625s
	iters: 200, epoch: 23 | loss: 0.0051251
	speed: 0.0812s/iter; left time: 2954.6733s
	iters: 300, epoch: 23 | loss: 0.4004360
	speed: 0.0789s/iter; left time: 2860.9278s
	iters: 400, epoch: 23 | loss: 0.0038039
	speed: 0.0850s/iter; left time: 3075.1067s
Epoch: 23 cost time: 39.634982109069824
Epoch: 23, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0172228
	speed: 0.3526s/iter; left time: 12697.0568s
	iters: 200, epoch: 24 | loss: 0.0023385
	speed: 0.0814s/iter; left time: 2923.6760s
	iters: 300, epoch: 24 | loss: 0.1094288
	speed: 0.0799s/iter; left time: 2862.8025s
	iters: 400, epoch: 24 | loss: 0.0158363
	speed: 0.0831s/iter; left time: 2968.0855s
Epoch: 24 cost time: 39.69410681724548
Epoch: 24, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.180 Vali Acc: 0.966 Test Loss: 0.180 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0068152
	speed: 0.3613s/iter; left time: 12842.6212s
	iters: 200, epoch: 25 | loss: 0.0091266
	speed: 0.0868s/iter; left time: 3077.2258s
	iters: 300, epoch: 25 | loss: 0.0078226
	speed: 0.0836s/iter; left time: 2956.5941s
	iters: 400, epoch: 25 | loss: 0.0160793
	speed: 0.0880s/iter; left time: 3101.2415s
Epoch: 25 cost time: 41.008997678756714
Epoch: 25, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0025989
	speed: 0.3653s/iter; left time: 12812.4992s
	iters: 200, epoch: 26 | loss: 0.4962909
	speed: 0.0885s/iter; left time: 3095.1414s
	iters: 300, epoch: 26 | loss: 0.0059605
	speed: 0.0896s/iter; left time: 3124.2298s
	iters: 400, epoch: 26 | loss: 0.0046609
	speed: 0.0876s/iter; left time: 3048.0670s
Epoch: 26 cost time: 41.567436933517456
Epoch: 26, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 758182
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5145264
	speed: 0.1007s/iter; left time: 4711.4953s
	iters: 200, epoch: 1 | loss: 0.7709567
	speed: 0.0850s/iter; left time: 3968.6983s
	iters: 300, epoch: 1 | loss: 0.3138476
	speed: 0.0906s/iter; left time: 4221.7199s
	iters: 400, epoch: 1 | loss: 0.2997771
	speed: 0.0887s/iter; left time: 4126.3402s
Epoch: 1 cost time: 42.528069496154785
Epoch: 1, Steps: 469 | Train Loss: 0.857 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
Validation loss decreased (inf --> -0.875068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0639728
	speed: 0.3774s/iter; left time: 17486.8380s
	iters: 200, epoch: 2 | loss: 0.0770477
	speed: 0.0886s/iter; left time: 4097.1510s
	iters: 300, epoch: 2 | loss: 0.1088084
	speed: 0.0847s/iter; left time: 3905.4076s
	iters: 400, epoch: 2 | loss: 0.0433065
	speed: 0.0877s/iter; left time: 4037.5540s
Epoch: 2 cost time: 41.34809970855713
Epoch: 2, Steps: 469 | Train Loss: 0.219 Vali Loss: 0.251 Vali Acc: 0.923 Test Loss: 0.251 Test Acc: 0.923
Validation loss decreased (-0.875068 --> -0.922525).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1370811
	speed: 0.3811s/iter; left time: 17479.1770s
	iters: 200, epoch: 3 | loss: 0.2246594
	speed: 0.0929s/iter; left time: 4250.8457s
	iters: 300, epoch: 3 | loss: 0.0126756
	speed: 0.0892s/iter; left time: 4072.9988s
	iters: 400, epoch: 3 | loss: 0.1149797
	speed: 0.0932s/iter; left time: 4248.5306s
Epoch: 3 cost time: 43.32220768928528
Epoch: 3, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.277 Vali Acc: 0.924 Test Loss: 0.277 Test Acc: 0.924
Validation loss decreased (-0.922525 --> -0.923668).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2168931
	speed: 0.3713s/iter; left time: 16856.4463s
	iters: 200, epoch: 4 | loss: 0.2456561
	speed: 0.0871s/iter; left time: 3943.6303s
	iters: 300, epoch: 4 | loss: 0.0157310
	speed: 0.0875s/iter; left time: 3952.9517s
	iters: 400, epoch: 4 | loss: 0.2657133
	speed: 0.0897s/iter; left time: 4046.9006s
Epoch: 4 cost time: 41.45181608200073
Epoch: 4, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
Validation loss decreased (-0.923668 --> -0.939678).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0094867
	speed: 0.3896s/iter; left time: 17503.6546s
	iters: 200, epoch: 5 | loss: 0.5188347
	speed: 0.0856s/iter; left time: 3836.8573s
	iters: 300, epoch: 5 | loss: 0.0514518
	speed: 0.0864s/iter; left time: 3865.6126s
	iters: 400, epoch: 5 | loss: 0.0067326
	speed: 0.0875s/iter; left time: 3906.7425s
Epoch: 5 cost time: 41.832704067230225
Epoch: 5, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.939678 --> -0.940821).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0171752
	speed: 0.4045s/iter; left time: 17982.9832s
	iters: 200, epoch: 6 | loss: 0.0347577
	speed: 0.0884s/iter; left time: 3919.0687s
	iters: 300, epoch: 6 | loss: 0.0558688
	speed: 0.0902s/iter; left time: 3989.9453s
	iters: 400, epoch: 6 | loss: 0.0316867
	speed: 0.0867s/iter; left time: 3827.1705s
Epoch: 6 cost time: 43.31002354621887
Epoch: 6, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0080891
	speed: 0.3773s/iter; left time: 16596.4210s
	iters: 200, epoch: 7 | loss: 0.0059673
	speed: 0.0817s/iter; left time: 3584.8559s
	iters: 300, epoch: 7 | loss: 0.0218403
	speed: 0.0814s/iter; left time: 3564.8593s
	iters: 400, epoch: 7 | loss: 0.0073592
	speed: 0.0848s/iter; left time: 3702.7098s
Epoch: 7 cost time: 39.106507778167725
Epoch: 7, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
Validation loss decreased (-0.940821 --> -0.955401).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0255331
	speed: 0.3811s/iter; left time: 16583.4196s
	iters: 200, epoch: 8 | loss: 0.1388634
	speed: 0.0826s/iter; left time: 3587.4645s
	iters: 300, epoch: 8 | loss: 0.0183414
	speed: 0.0828s/iter; left time: 3588.7104s
	iters: 400, epoch: 8 | loss: 0.3624418
	speed: 0.0864s/iter; left time: 3735.4972s
Epoch: 8 cost time: 41.315073013305664
Epoch: 8, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0051352
	speed: 0.3612s/iter; left time: 15549.7026s
	iters: 200, epoch: 9 | loss: 0.0139413
	speed: 0.0865s/iter; left time: 3714.4708s
	iters: 300, epoch: 9 | loss: 0.0288182
	speed: 0.0870s/iter; left time: 3728.5458s
	iters: 400, epoch: 9 | loss: 0.0066309
	speed: 0.0846s/iter; left time: 3614.6633s
Epoch: 9 cost time: 40.29330539703369
Epoch: 9, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.955401 --> -0.967694).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0029296
	speed: 0.3635s/iter; left time: 15477.1196s
	iters: 200, epoch: 10 | loss: 0.0134687
	speed: 0.0825s/iter; left time: 3505.2709s
	iters: 300, epoch: 10 | loss: 0.0742020
	speed: 0.0834s/iter; left time: 3536.1590s
	iters: 400, epoch: 10 | loss: 0.0038029
	speed: 0.0829s/iter; left time: 3506.3414s
Epoch: 10 cost time: 40.02268743515015
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0320908
	speed: 0.3667s/iter; left time: 15443.1887s
	iters: 200, epoch: 11 | loss: 0.0053701
	speed: 0.0957s/iter; left time: 4018.5136s
	iters: 300, epoch: 11 | loss: 0.1743150
	speed: 0.0968s/iter; left time: 4058.7486s
	iters: 400, epoch: 11 | loss: 0.2235229
	speed: 0.0872s/iter; left time: 3644.3549s
Epoch: 11 cost time: 42.679421186447144
Epoch: 11, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0076680
	speed: 0.3423s/iter; left time: 14254.1762s
	iters: 200, epoch: 12 | loss: 0.0763747
	speed: 0.0832s/iter; left time: 3457.6314s
	iters: 300, epoch: 12 | loss: 0.0297001
	speed: 0.0896s/iter; left time: 3714.4059s
	iters: 400, epoch: 12 | loss: 0.0131821
	speed: 0.0907s/iter; left time: 3749.2742s
Epoch: 12 cost time: 41.37110710144043
Epoch: 12, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0121595
	speed: 0.3739s/iter; left time: 15393.9397s
	iters: 200, epoch: 13 | loss: 0.0072317
	speed: 0.0924s/iter; left time: 3795.7793s
	iters: 300, epoch: 13 | loss: 0.0044679
	speed: 0.0924s/iter; left time: 3787.0232s
	iters: 400, epoch: 13 | loss: 0.0136915
	speed: 0.0871s/iter; left time: 3558.5463s
Epoch: 13 cost time: 43.330174922943115
Epoch: 13, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.189 Vali Acc: 0.955 Test Loss: 0.189 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0028954
	speed: 0.4100s/iter; left time: 16688.1889s
	iters: 200, epoch: 14 | loss: 0.0048326
	speed: 0.0892s/iter; left time: 3621.8836s
	iters: 300, epoch: 14 | loss: 0.0120347
	speed: 0.0908s/iter; left time: 3678.4861s
	iters: 400, epoch: 14 | loss: 0.0035485
	speed: 0.0894s/iter; left time: 3613.2180s
Epoch: 14 cost time: 43.73205065727234
Epoch: 14, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
Validation loss decreased (-0.967694 --> -0.968552).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0154970
	speed: 0.3974s/iter; left time: 15989.8783s
	iters: 200, epoch: 15 | loss: 0.0106851
	speed: 0.0923s/iter; left time: 3703.4576s
	iters: 300, epoch: 15 | loss: 0.1170144
	speed: 0.0892s/iter; left time: 3571.7849s
	iters: 400, epoch: 15 | loss: 0.0081553
	speed: 0.0875s/iter; left time: 3496.0916s
Epoch: 15 cost time: 42.20431709289551
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0026197
	speed: 0.3734s/iter; left time: 14847.9327s
	iters: 200, epoch: 16 | loss: 0.0088475
	speed: 0.0798s/iter; left time: 3165.3412s
	iters: 300, epoch: 16 | loss: 0.0038466
	speed: 0.0862s/iter; left time: 3409.4341s
	iters: 400, epoch: 16 | loss: 0.0061708
	speed: 0.0870s/iter; left time: 3432.4060s
Epoch: 16 cost time: 39.907771587371826
Epoch: 16, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8088793
	speed: 0.3748s/iter; left time: 14726.8731s
	iters: 200, epoch: 17 | loss: 0.0109608
	speed: 0.0889s/iter; left time: 3485.5901s
	iters: 300, epoch: 17 | loss: 0.0207299
	speed: 0.0887s/iter; left time: 3468.3622s
	iters: 400, epoch: 17 | loss: 0.0210117
	speed: 0.0832s/iter; left time: 3244.9723s
Epoch: 17 cost time: 40.55514979362488
Epoch: 17, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0054180
	speed: 0.3282s/iter; left time: 12741.8130s
	iters: 200, epoch: 18 | loss: 0.0451593
	speed: 0.0804s/iter; left time: 3113.6882s
	iters: 300, epoch: 18 | loss: 0.0010554
	speed: 0.0835s/iter; left time: 3224.6314s
	iters: 400, epoch: 18 | loss: 0.0566354
	speed: 0.0891s/iter; left time: 3432.3763s
Epoch: 18 cost time: 40.18664860725403
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0026602
	speed: 0.3702s/iter; left time: 14199.4405s
	iters: 200, epoch: 19 | loss: 0.1646834
	speed: 0.0901s/iter; left time: 3445.5417s
	iters: 300, epoch: 19 | loss: 0.0177774
	speed: 0.0828s/iter; left time: 3160.3977s
	iters: 400, epoch: 19 | loss: 0.1926747
	speed: 0.0839s/iter; left time: 3192.2000s
Epoch: 19 cost time: 40.666569232940674
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2951488
	speed: 0.3655s/iter; left time: 13848.4190s
	iters: 200, epoch: 20 | loss: 0.0021640
	speed: 0.0835s/iter; left time: 3155.6618s
	iters: 300, epoch: 20 | loss: 0.0058554
	speed: 0.0827s/iter; left time: 3115.3543s
	iters: 400, epoch: 20 | loss: 0.0012142
	speed: 0.0876s/iter; left time: 3292.7389s
Epoch: 20 cost time: 40.238582611083984
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1011142
	speed: 0.3680s/iter; left time: 13771.6731s
	iters: 200, epoch: 21 | loss: 0.0206371
	speed: 0.0878s/iter; left time: 3277.0185s
	iters: 300, epoch: 21 | loss: 0.0010692
	speed: 0.0853s/iter; left time: 3176.6477s
	iters: 400, epoch: 21 | loss: 0.0069090
	speed: 0.0873s/iter; left time: 3239.0277s
Epoch: 21 cost time: 41.32314372062683
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.973984).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0008419
	speed: 0.3687s/iter; left time: 13625.5445s
	iters: 200, epoch: 22 | loss: 0.0081749
	speed: 0.0827s/iter; left time: 3047.1553s
	iters: 300, epoch: 22 | loss: 0.0052459
	speed: 0.0904s/iter; left time: 3324.1052s
	iters: 400, epoch: 22 | loss: 0.0069879
	speed: 0.0889s/iter; left time: 3258.0579s
Epoch: 22 cost time: 41.005279779434204
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0360999
	speed: 0.3941s/iter; left time: 14377.4138s
	iters: 200, epoch: 23 | loss: 0.0079367
	speed: 0.0956s/iter; left time: 3478.0413s
	iters: 300, epoch: 23 | loss: 0.0185297
	speed: 0.0897s/iter; left time: 3254.5618s
	iters: 400, epoch: 23 | loss: 0.0029569
	speed: 0.0904s/iter; left time: 3271.2797s
Epoch: 23 cost time: 43.382771492004395
Epoch: 23, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0066607
	speed: 0.3965s/iter; left time: 14278.7166s
	iters: 200, epoch: 24 | loss: 0.0046538
	speed: 0.0935s/iter; left time: 3359.7251s
	iters: 300, epoch: 24 | loss: 0.0019578
	speed: 0.0885s/iter; left time: 3168.2323s
	iters: 400, epoch: 24 | loss: 0.0182171
	speed: 0.0888s/iter; left time: 3170.5807s
Epoch: 24 cost time: 42.86975026130676
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0013631
	speed: 0.3857s/iter; left time: 13708.1982s
	iters: 200, epoch: 25 | loss: 0.0035893
	speed: 0.0902s/iter; left time: 3197.0596s
	iters: 300, epoch: 25 | loss: 0.0046087
	speed: 0.0888s/iter; left time: 3140.2377s
	iters: 400, epoch: 25 | loss: 0.0015976
	speed: 0.0843s/iter; left time: 2970.4109s
Epoch: 25 cost time: 41.94447588920593
Epoch: 25, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0031527
	speed: 0.3624s/iter; left time: 12710.6004s
	iters: 200, epoch: 26 | loss: 0.0020893
	speed: 0.0831s/iter; left time: 2906.3371s
	iters: 300, epoch: 26 | loss: 0.0033307
	speed: 0.0871s/iter; left time: 3036.5227s
	iters: 400, epoch: 26 | loss: 0.0037241
	speed: 0.0895s/iter; left time: 3113.0498s
Epoch: 26 cost time: 41.01310658454895
Epoch: 26, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0079682
	speed: 0.3638s/iter; left time: 12589.4643s
	iters: 200, epoch: 27 | loss: 0.0135765
	speed: 0.0877s/iter; left time: 3027.7672s
	iters: 300, epoch: 27 | loss: 0.2231067
	speed: 0.0879s/iter; left time: 3024.9593s
	iters: 400, epoch: 27 | loss: 0.0009432
	speed: 0.0837s/iter; left time: 2871.6428s
Epoch: 27 cost time: 40.96947526931763
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0062495
	speed: 0.3800s/iter; left time: 12974.0281s
	iters: 200, epoch: 28 | loss: 0.0032399
	speed: 0.0845s/iter; left time: 2876.5311s
	iters: 300, epoch: 28 | loss: 0.0093477
	speed: 0.0881s/iter; left time: 2991.6274s
	iters: 400, epoch: 28 | loss: 0.0112453
	speed: 0.0836s/iter; left time: 2829.2959s
Epoch: 28 cost time: 40.69751715660095
Epoch: 28, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0050006
	speed: 0.3529s/iter; left time: 11881.7712s
	iters: 200, epoch: 29 | loss: 0.0020033
	speed: 0.0810s/iter; left time: 2719.2603s
	iters: 300, epoch: 29 | loss: 0.0041386
	speed: 0.0849s/iter; left time: 2842.6772s
	iters: 400, epoch: 29 | loss: 0.0022177
	speed: 0.0831s/iter; left time: 2772.9291s
Epoch: 29 cost time: 39.07331728935242
Epoch: 29, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0023898
	speed: 0.3586s/iter; left time: 11905.9198s
	iters: 200, epoch: 30 | loss: 0.0019153
	speed: 0.0804s/iter; left time: 2661.5027s
	iters: 300, epoch: 30 | loss: 0.2040661
	speed: 0.0835s/iter; left time: 2754.8990s
	iters: 400, epoch: 30 | loss: 0.0018176
	speed: 0.0825s/iter; left time: 2713.9352s
Epoch: 30 cost time: 39.45166826248169
Epoch: 30, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0029354
	speed: 0.3656s/iter; left time: 11966.9027s
	iters: 200, epoch: 31 | loss: 0.0023526
	speed: 0.0826s/iter; left time: 2696.8515s
	iters: 300, epoch: 31 | loss: 0.0873661
	speed: 0.0801s/iter; left time: 2606.0126s
	iters: 400, epoch: 31 | loss: 0.0015144
	speed: 0.0840s/iter; left time: 2725.5094s
Epoch: 31 cost time: 39.19103479385376
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.255 Vali Acc: 0.960 Test Loss: 0.255 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9739851343624929
model parameter : 459046
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6139328
	speed: 0.1005s/iter; left time: 4704.1916s
	iters: 200, epoch: 1 | loss: 0.6929341
	speed: 0.0879s/iter; left time: 4104.2518s
	iters: 300, epoch: 1 | loss: 0.3622752
	speed: 0.0822s/iter; left time: 3828.9624s
	iters: 400, epoch: 1 | loss: 0.4461639
	speed: 0.0791s/iter; left time: 3679.5102s
Epoch: 1 cost time: 40.62572646141052
Epoch: 1, Steps: 469 | Train Loss: 0.855 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
Validation loss decreased (inf --> -0.872494).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2046270
	speed: 0.3693s/iter; left time: 17109.6032s
	iters: 200, epoch: 2 | loss: 0.1697761
	speed: 0.0893s/iter; left time: 4129.8388s
	iters: 300, epoch: 2 | loss: 0.2496095
	speed: 0.0914s/iter; left time: 4214.4878s
	iters: 400, epoch: 2 | loss: 0.1403984
	speed: 0.0905s/iter; left time: 4167.3058s
Epoch: 2 cost time: 43.14695715904236
Epoch: 2, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.285 Vali Acc: 0.912 Test Loss: 0.285 Test Acc: 0.912
Validation loss decreased (-0.872494 --> -0.912233).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3952219
	speed: 0.3940s/iter; left time: 18071.8607s
	iters: 200, epoch: 3 | loss: 0.2287042
	speed: 0.0958s/iter; left time: 4383.6446s
	iters: 300, epoch: 3 | loss: 0.0172038
	speed: 0.0942s/iter; left time: 4301.6688s
	iters: 400, epoch: 3 | loss: 0.1971264
	speed: 0.0875s/iter; left time: 3988.6682s
Epoch: 3 cost time: 43.1729519367218
Epoch: 3, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
Validation loss decreased (-0.912233 --> -0.955402).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5777556
	speed: 0.3218s/iter; left time: 14607.8265s
	iters: 200, epoch: 4 | loss: 0.1926110
	speed: 0.0854s/iter; left time: 3870.1439s
	iters: 300, epoch: 4 | loss: 0.3269196
	speed: 0.0824s/iter; left time: 3724.4702s
	iters: 400, epoch: 4 | loss: 0.0516513
	speed: 0.0859s/iter; left time: 3872.8502s
Epoch: 4 cost time: 39.57481241226196
Epoch: 4, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0321532
	speed: 0.3554s/iter; left time: 15965.9365s
	iters: 200, epoch: 5 | loss: 0.0056348
	speed: 0.0852s/iter; left time: 3820.2834s
	iters: 300, epoch: 5 | loss: 0.0432674
	speed: 0.0835s/iter; left time: 3732.6655s
	iters: 400, epoch: 5 | loss: 0.0626105
	speed: 0.0851s/iter; left time: 3797.9302s
Epoch: 5 cost time: 40.197829484939575
Epoch: 5, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0321119
	speed: 0.3503s/iter; left time: 15574.0533s
	iters: 200, epoch: 6 | loss: 0.0107498
	speed: 0.0773s/iter; left time: 3429.7222s
	iters: 300, epoch: 6 | loss: 0.0434311
	speed: 0.0845s/iter; left time: 3739.9283s
	iters: 400, epoch: 6 | loss: 0.1182524
	speed: 0.0841s/iter; left time: 3712.0649s
Epoch: 6 cost time: 38.27408528327942
Epoch: 6, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.233 Vali Acc: 0.939 Test Loss: 0.233 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0990869
	speed: 0.3470s/iter; left time: 15265.2104s
	iters: 200, epoch: 7 | loss: 0.0174405
	speed: 0.0831s/iter; left time: 3646.4884s
	iters: 300, epoch: 7 | loss: 0.0146694
	speed: 0.0813s/iter; left time: 3560.5358s
	iters: 400, epoch: 7 | loss: 0.0211716
	speed: 0.0823s/iter; left time: 3594.0877s
Epoch: 7 cost time: 39.05451965332031
Epoch: 7, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0216167
	speed: 0.3520s/iter; left time: 15316.3418s
	iters: 200, epoch: 8 | loss: 0.1011907
	speed: 0.0799s/iter; left time: 3468.8799s
	iters: 300, epoch: 8 | loss: 0.0299571
	speed: 0.0777s/iter; left time: 3367.7200s
	iters: 400, epoch: 8 | loss: 0.0494971
	speed: 0.0806s/iter; left time: 3483.9313s
Epoch: 8 cost time: 37.8101282119751
Epoch: 8, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4141909
	speed: 0.3512s/iter; left time: 15120.8408s
	iters: 200, epoch: 9 | loss: 0.0142155
	speed: 0.0876s/iter; left time: 3763.3715s
	iters: 300, epoch: 9 | loss: 0.0196906
	speed: 0.0868s/iter; left time: 3717.5456s
	iters: 400, epoch: 9 | loss: 0.0061305
	speed: 0.0858s/iter; left time: 3665.7674s
Epoch: 9 cost time: 40.61577916145325
Epoch: 9, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.955402 --> -0.958546).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0102678
	speed: 0.3494s/iter; left time: 14877.4259s
	iters: 200, epoch: 10 | loss: 0.1008843
	speed: 0.0775s/iter; left time: 3293.5063s
	iters: 300, epoch: 10 | loss: 0.0424578
	speed: 0.0812s/iter; left time: 3440.2525s
	iters: 400, epoch: 10 | loss: 0.1728591
	speed: 0.0838s/iter; left time: 3545.0869s
Epoch: 10 cost time: 38.04907751083374
Epoch: 10, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0089528
	speed: 0.3456s/iter; left time: 14553.5539s
	iters: 200, epoch: 11 | loss: 0.0318319
	speed: 0.0792s/iter; left time: 3328.5881s
	iters: 300, epoch: 11 | loss: 0.0527359
	speed: 0.0780s/iter; left time: 3268.1436s
	iters: 400, epoch: 11 | loss: 0.0797113
	speed: 0.0834s/iter; left time: 3485.0336s
Epoch: 11 cost time: 38.07957124710083
Epoch: 11, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
Validation loss decreased (-0.958546 --> -0.965407).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0059826
	speed: 0.3594s/iter; left time: 14968.1786s
	iters: 200, epoch: 12 | loss: 0.3173621
	speed: 0.0836s/iter; left time: 3471.1030s
	iters: 300, epoch: 12 | loss: 0.0078907
	speed: 0.0891s/iter; left time: 3691.5886s
	iters: 400, epoch: 12 | loss: 0.3615537
	speed: 0.0899s/iter; left time: 3715.4374s
Epoch: 12 cost time: 40.60683536529541
Epoch: 12, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0019404
	speed: 0.3644s/iter; left time: 15005.1067s
	iters: 200, epoch: 13 | loss: 0.0015071
	speed: 0.0816s/iter; left time: 3350.1164s
	iters: 300, epoch: 13 | loss: 0.3691494
	speed: 0.0792s/iter; left time: 3245.8894s
	iters: 400, epoch: 13 | loss: 0.0571615
	speed: 0.0826s/iter; left time: 3376.3076s
Epoch: 13 cost time: 38.718908071517944
Epoch: 13, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0014698
	speed: 0.3582s/iter; left time: 14581.9991s
	iters: 200, epoch: 14 | loss: 0.0439743
	speed: 0.0810s/iter; left time: 3290.2045s
	iters: 300, epoch: 14 | loss: 0.1593495
	speed: 0.0850s/iter; left time: 3442.4626s
	iters: 400, epoch: 14 | loss: 0.1551919
	speed: 0.0791s/iter; left time: 3196.8784s
Epoch: 14 cost time: 38.695472717285156
Epoch: 14, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0068115
	speed: 0.3441s/iter; left time: 13843.0608s
	iters: 200, epoch: 15 | loss: 0.0199918
	speed: 0.0808s/iter; left time: 3241.3960s
	iters: 300, epoch: 15 | loss: 0.0140659
	speed: 0.0809s/iter; left time: 3239.4059s
	iters: 400, epoch: 15 | loss: 0.0833341
	speed: 0.0816s/iter; left time: 3258.3058s
Epoch: 15 cost time: 38.23201370239258
Epoch: 15, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0291993
	speed: 0.3514s/iter; left time: 13972.7044s
	iters: 200, epoch: 16 | loss: 0.0116559
	speed: 0.0813s/iter; left time: 3224.9207s
	iters: 300, epoch: 16 | loss: 0.5160203
	speed: 0.0844s/iter; left time: 3338.2614s
	iters: 400, epoch: 16 | loss: 0.0026838
	speed: 0.0840s/iter; left time: 3316.1160s
Epoch: 16 cost time: 39.20259642601013
Epoch: 16, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.965407 --> -0.968266).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0110558
	speed: 0.3528s/iter; left time: 13863.8599s
	iters: 200, epoch: 17 | loss: 0.0207122
	speed: 0.0798s/iter; left time: 3126.4459s
	iters: 300, epoch: 17 | loss: 0.0058122
	speed: 0.0805s/iter; left time: 3148.6143s
	iters: 400, epoch: 17 | loss: 0.0245281
	speed: 0.0819s/iter; left time: 3194.5981s
Epoch: 17 cost time: 39.211222887039185
Epoch: 17, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0901446
	speed: 0.3485s/iter; left time: 13531.2347s
	iters: 200, epoch: 18 | loss: 0.0403546
	speed: 0.0825s/iter; left time: 3193.3490s
	iters: 300, epoch: 18 | loss: 0.0170277
	speed: 0.0900s/iter; left time: 3474.6820s
	iters: 400, epoch: 18 | loss: 0.0030058
	speed: 0.0811s/iter; left time: 3124.0704s
Epoch: 18 cost time: 39.30303955078125
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2373993
	speed: 0.3533s/iter; left time: 13551.9811s
	iters: 200, epoch: 19 | loss: 0.0067450
	speed: 0.0825s/iter; left time: 3157.2948s
	iters: 300, epoch: 19 | loss: 0.0031975
	speed: 0.0808s/iter; left time: 3084.7504s
	iters: 400, epoch: 19 | loss: 0.0119260
	speed: 0.0791s/iter; left time: 3010.6535s
Epoch: 19 cost time: 39.0551323890686
Epoch: 19, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0061940
	speed: 0.3266s/iter; left time: 12373.6419s
	iters: 200, epoch: 20 | loss: 0.0896245
	speed: 0.0829s/iter; left time: 3131.1907s
	iters: 300, epoch: 20 | loss: 0.0021509
	speed: 0.0857s/iter; left time: 3228.3296s
	iters: 400, epoch: 20 | loss: 0.0043046
	speed: 0.0800s/iter; left time: 3006.2445s
Epoch: 20 cost time: 38.29774737358093
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.193 Vali Acc: 0.961 Test Loss: 0.193 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0100478
	speed: 0.3414s/iter; left time: 12775.5034s
	iters: 200, epoch: 21 | loss: 0.0073784
	speed: 0.0812s/iter; left time: 3031.2071s
	iters: 300, epoch: 21 | loss: 0.0035036
	speed: 0.0847s/iter; left time: 3154.2627s
	iters: 400, epoch: 21 | loss: 0.1126549
	speed: 0.0830s/iter; left time: 3079.4204s
Epoch: 21 cost time: 39.36139488220215
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0028559
	speed: 0.3313s/iter; left time: 12240.5385s
	iters: 200, epoch: 22 | loss: 0.0084236
	speed: 0.0827s/iter; left time: 3048.0780s
	iters: 300, epoch: 22 | loss: 0.0019338
	speed: 0.0863s/iter; left time: 3171.0132s
	iters: 400, epoch: 22 | loss: 0.0063121
	speed: 0.0875s/iter; left time: 3206.4251s
Epoch: 22 cost time: 39.41329383850098
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2566034
	speed: 0.3814s/iter; left time: 13914.2246s
	iters: 200, epoch: 23 | loss: 0.0163813
	speed: 0.0884s/iter; left time: 3216.2481s
	iters: 300, epoch: 23 | loss: 0.0802277
	speed: 0.0926s/iter; left time: 3361.3823s
	iters: 400, epoch: 23 | loss: 0.0013957
	speed: 0.0898s/iter; left time: 3250.1543s
Epoch: 23 cost time: 43.117586612701416
Epoch: 23, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.968266 --> -0.973126).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0012468
	speed: 0.3506s/iter; left time: 12625.9458s
	iters: 200, epoch: 24 | loss: 0.0199298
	speed: 0.0821s/iter; left time: 2949.9649s
	iters: 300, epoch: 24 | loss: 0.3517638
	speed: 0.0826s/iter; left time: 2956.5929s
	iters: 400, epoch: 24 | loss: 0.6659135
	speed: 0.0830s/iter; left time: 2962.5380s
Epoch: 24 cost time: 39.05509090423584
Epoch: 24, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0013534
	speed: 0.3565s/iter; left time: 12670.3447s
	iters: 200, epoch: 25 | loss: 0.0023053
	speed: 0.0854s/iter; left time: 3028.7574s
	iters: 300, epoch: 25 | loss: 0.0014243
	speed: 0.0822s/iter; left time: 2906.4093s
	iters: 400, epoch: 25 | loss: 0.0064874
	speed: 0.0813s/iter; left time: 2866.2321s
Epoch: 25 cost time: 39.49380660057068
Epoch: 25, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.249 Vali Acc: 0.956 Test Loss: 0.249 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0025925
	speed: 0.3538s/iter; left time: 12409.3836s
	iters: 200, epoch: 26 | loss: 0.0134909
	speed: 0.0823s/iter; left time: 2879.4468s
	iters: 300, epoch: 26 | loss: 0.0051544
	speed: 0.0839s/iter; left time: 2924.5363s
	iters: 400, epoch: 26 | loss: 0.0023487
	speed: 0.0842s/iter; left time: 2928.0919s
Epoch: 26 cost time: 39.28710722923279
Epoch: 26, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.951 Test Loss: 0.244 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0064646
	speed: 0.3595s/iter; left time: 12442.7293s
	iters: 200, epoch: 27 | loss: 0.0046810
	speed: 0.0806s/iter; left time: 2780.7384s
	iters: 300, epoch: 27 | loss: 0.0209644
	speed: 0.0852s/iter; left time: 2932.5938s
	iters: 400, epoch: 27 | loss: 0.1664002
	speed: 0.0824s/iter; left time: 2827.3563s
Epoch: 27 cost time: 39.40746569633484
Epoch: 27, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0014934
	speed: 0.3570s/iter; left time: 12188.7450s
	iters: 200, epoch: 28 | loss: 0.0973777
	speed: 0.0863s/iter; left time: 2937.4786s
	iters: 300, epoch: 28 | loss: 0.1528389
	speed: 0.0851s/iter; left time: 2889.3157s
	iters: 400, epoch: 28 | loss: 0.0092085
	speed: 0.0804s/iter; left time: 2719.3383s
Epoch: 28 cost time: 40.24908924102783
Epoch: 28, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0017390
	speed: 0.3698s/iter; left time: 12452.4680s
	iters: 200, epoch: 29 | loss: 0.0121822
	speed: 0.0834s/iter; left time: 2800.9466s
	iters: 300, epoch: 29 | loss: 0.0115288
	speed: 0.0879s/iter; left time: 2943.5868s
	iters: 400, epoch: 29 | loss: 0.0580911
	speed: 0.0890s/iter; left time: 2969.6425s
Epoch: 29 cost time: 40.85090661048889
Epoch: 29, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0049552
	speed: 0.3548s/iter; left time: 11780.0134s
	iters: 200, epoch: 30 | loss: 0.0016416
	speed: 0.0847s/iter; left time: 2802.4380s
	iters: 300, epoch: 30 | loss: 0.0065899
	speed: 0.0850s/iter; left time: 2806.5168s
	iters: 400, epoch: 30 | loss: 0.0018845
	speed: 0.0844s/iter; left time: 2776.5728s
Epoch: 30 cost time: 40.13612365722656
Epoch: 30, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0036168
	speed: 0.3744s/iter; left time: 12255.0210s
	iters: 200, epoch: 31 | loss: 0.0013987
	speed: 0.0899s/iter; left time: 2934.9075s
	iters: 300, epoch: 31 | loss: 0.0043097
	speed: 0.0917s/iter; left time: 2982.0158s
	iters: 400, epoch: 31 | loss: 0.0034954
	speed: 0.0910s/iter; left time: 2951.0662s
Epoch: 31 cost time: 42.39992618560791
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0006415
	speed: 0.3821s/iter; left time: 12327.3507s
	iters: 200, epoch: 32 | loss: 0.0016053
	speed: 0.0838s/iter; left time: 2694.6919s
	iters: 300, epoch: 32 | loss: 0.0008449
	speed: 0.0842s/iter; left time: 2699.8924s
	iters: 400, epoch: 32 | loss: 0.0149450
	speed: 0.0833s/iter; left time: 2663.7031s
Epoch: 32 cost time: 40.563215494155884
Epoch: 32, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.949 Test Loss: 0.270 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.2289223
	speed: 0.3740s/iter; left time: 11891.2916s
	iters: 200, epoch: 33 | loss: 0.0220116
	speed: 0.0881s/iter; left time: 2791.7918s
	iters: 300, epoch: 33 | loss: 0.0008857
	speed: 0.0830s/iter; left time: 2622.8952s
	iters: 400, epoch: 33 | loss: 0.0008798
	speed: 0.0802s/iter; left time: 2525.6181s
Epoch: 33 cost time: 40.13253736495972
Epoch: 33, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 458918
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0017846
	speed: 0.1022s/iter; left time: 4782.5556s
	iters: 200, epoch: 1 | loss: 0.4265010
	speed: 0.0818s/iter; left time: 3819.7446s
	iters: 300, epoch: 1 | loss: 0.6398216
	speed: 0.0790s/iter; left time: 3681.4809s
	iters: 400, epoch: 1 | loss: 0.3578649
	speed: 0.0782s/iter; left time: 3637.9977s
Epoch: 1 cost time: 39.72982120513916
Epoch: 1, Steps: 469 | Train Loss: 0.859 Vali Loss: 0.326 Vali Acc: 0.898 Test Loss: 0.326 Test Acc: 0.898
Validation loss decreased (inf --> -0.897653).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2382330
	speed: 0.3466s/iter; left time: 16059.3616s
	iters: 200, epoch: 2 | loss: 0.1535096
	speed: 0.0804s/iter; left time: 3716.1309s
	iters: 300, epoch: 2 | loss: 0.1182628
	speed: 0.0885s/iter; left time: 4081.2188s
	iters: 400, epoch: 2 | loss: 0.1881559
	speed: 0.0845s/iter; left time: 3887.7682s
Epoch: 2 cost time: 39.33220028877258
Epoch: 2, Steps: 469 | Train Loss: 0.232 Vali Loss: 0.211 Vali Acc: 0.932 Test Loss: 0.211 Test Acc: 0.932
Validation loss decreased (-0.897653 --> -0.931959).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0190517
	speed: 0.3672s/iter; left time: 16842.6500s
	iters: 200, epoch: 3 | loss: 0.2399404
	speed: 0.0835s/iter; left time: 3821.8641s
	iters: 300, epoch: 3 | loss: 0.0940940
	speed: 0.0809s/iter; left time: 3694.4059s
	iters: 400, epoch: 3 | loss: 0.4332927
	speed: 0.0800s/iter; left time: 3646.5455s
Epoch: 3 cost time: 40.01792573928833
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5497104
	speed: 0.3518s/iter; left time: 15968.4070s
	iters: 200, epoch: 4 | loss: 0.1941130
	speed: 0.0871s/iter; left time: 3945.4824s
	iters: 300, epoch: 4 | loss: 0.0056575
	speed: 0.0903s/iter; left time: 4080.4776s
	iters: 400, epoch: 4 | loss: 0.4502856
	speed: 0.0890s/iter; left time: 4011.7774s
Epoch: 4 cost time: 41.32117962837219
Epoch: 4, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.931959 --> -0.949684).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0361135
	speed: 0.3596s/iter; left time: 16153.4325s
	iters: 200, epoch: 5 | loss: 0.0295829
	speed: 0.0791s/iter; left time: 3546.2732s
	iters: 300, epoch: 5 | loss: 0.0105700
	speed: 0.0835s/iter; left time: 3736.0237s
	iters: 400, epoch: 5 | loss: 0.2098760
	speed: 0.0810s/iter; left time: 3613.7021s
Epoch: 5 cost time: 39.041677713394165
Epoch: 5, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.949684 --> -0.955973).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0413564
	speed: 0.3560s/iter; left time: 15828.2863s
	iters: 200, epoch: 6 | loss: 0.0057264
	speed: 0.0888s/iter; left time: 3940.3174s
	iters: 300, epoch: 6 | loss: 0.0653124
	speed: 0.0911s/iter; left time: 4030.1045s
	iters: 400, epoch: 6 | loss: 0.0228101
	speed: 0.0872s/iter; left time: 3850.4467s
Epoch: 6 cost time: 41.621885538101196
Epoch: 6, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.955973 --> -0.963120).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0654688
	speed: 0.3749s/iter; left time: 16492.0186s
	iters: 200, epoch: 7 | loss: 0.0648630
	speed: 0.0849s/iter; left time: 3724.0575s
	iters: 300, epoch: 7 | loss: 0.8793420
	speed: 0.0868s/iter; left time: 3799.5516s
	iters: 400, epoch: 7 | loss: 0.0140713
	speed: 0.0878s/iter; left time: 3837.5157s
Epoch: 7 cost time: 41.607760190963745
Epoch: 7, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0309637
	speed: 0.3850s/iter; left time: 16752.9630s
	iters: 200, epoch: 8 | loss: 0.0225671
	speed: 0.0927s/iter; left time: 4025.9275s
	iters: 300, epoch: 8 | loss: 0.1662300
	speed: 0.0887s/iter; left time: 3843.3465s
	iters: 400, epoch: 8 | loss: 0.1588160
	speed: 0.0844s/iter; left time: 3645.7873s
Epoch: 8 cost time: 42.773823976516724
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.942 Test Loss: 0.235 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4782504
	speed: 0.3478s/iter; left time: 14972.6529s
	iters: 200, epoch: 9 | loss: 0.0111390
	speed: 0.0798s/iter; left time: 3429.4222s
	iters: 300, epoch: 9 | loss: 0.3743125
	speed: 0.0792s/iter; left time: 3394.8208s
	iters: 400, epoch: 9 | loss: 0.0127994
	speed: 0.0782s/iter; left time: 3344.4591s
Epoch: 9 cost time: 37.79955816268921
Epoch: 9, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.193 Vali Acc: 0.945 Test Loss: 0.193 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0154676
	speed: 0.3231s/iter; left time: 13757.1346s
	iters: 200, epoch: 10 | loss: 0.0096053
	speed: 0.0788s/iter; left time: 3347.0180s
	iters: 300, epoch: 10 | loss: 0.0520149
	speed: 0.0771s/iter; left time: 3266.3070s
	iters: 400, epoch: 10 | loss: 0.0363290
	speed: 0.0840s/iter; left time: 3550.5665s
Epoch: 10 cost time: 37.22260761260986
Epoch: 10, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0130474
	speed: 0.3440s/iter; left time: 14487.8682s
	iters: 200, epoch: 11 | loss: 0.0422944
	speed: 0.0781s/iter; left time: 3280.5880s
	iters: 300, epoch: 11 | loss: 0.0022379
	speed: 0.0817s/iter; left time: 3423.1108s
	iters: 400, epoch: 11 | loss: 0.0058658
	speed: 0.0795s/iter; left time: 3325.1213s
Epoch: 11 cost time: 38.2053759098053
Epoch: 11, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0139286
	speed: 0.3350s/iter; left time: 13950.7507s
	iters: 200, epoch: 12 | loss: 0.5418018
	speed: 0.0845s/iter; left time: 3511.3267s
	iters: 300, epoch: 12 | loss: 0.0148480
	speed: 0.0848s/iter; left time: 3513.3444s
	iters: 400, epoch: 12 | loss: 0.0052715
	speed: 0.0875s/iter; left time: 3617.1686s
Epoch: 12 cost time: 39.96555948257446
Epoch: 12, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0022630
	speed: 0.3652s/iter; left time: 15037.0719s
	iters: 200, epoch: 13 | loss: 0.0037963
	speed: 0.0774s/iter; left time: 3180.8314s
	iters: 300, epoch: 13 | loss: 0.0095697
	speed: 0.0788s/iter; left time: 3230.3565s
	iters: 400, epoch: 13 | loss: 0.0045907
	speed: 0.0797s/iter; left time: 3258.1904s
Epoch: 13 cost time: 38.60898685455322
Epoch: 13, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2871921
	speed: 0.3409s/iter; left time: 13874.2261s
	iters: 200, epoch: 14 | loss: 0.1114470
	speed: 0.0810s/iter; left time: 3289.5527s
	iters: 300, epoch: 14 | loss: 0.1148131
	speed: 0.0833s/iter; left time: 3375.5937s
	iters: 400, epoch: 14 | loss: 0.0100024
	speed: 0.0777s/iter; left time: 3138.1616s
Epoch: 14 cost time: 37.90115666389465
Epoch: 14, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0154939
	speed: 0.3427s/iter; left time: 13787.8620s
	iters: 200, epoch: 15 | loss: 0.0014398
	speed: 0.0806s/iter; left time: 3233.6855s
	iters: 300, epoch: 15 | loss: 0.0899329
	speed: 0.0859s/iter; left time: 3440.6943s
	iters: 400, epoch: 15 | loss: 0.0356155
	speed: 0.0899s/iter; left time: 3590.9501s
Epoch: 15 cost time: 40.257434606552124
Epoch: 15, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.963120 --> -0.964835).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1663452
	speed: 0.3637s/iter; left time: 14463.8280s
	iters: 200, epoch: 16 | loss: 0.0093471
	speed: 0.0851s/iter; left time: 3377.0554s
	iters: 300, epoch: 16 | loss: 0.2044112
	speed: 0.0831s/iter; left time: 3288.5591s
	iters: 400, epoch: 16 | loss: 0.1666640
	speed: 0.0800s/iter; left time: 3156.4313s
Epoch: 16 cost time: 39.46620583534241
Epoch: 16, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0176478
	speed: 0.3623s/iter; left time: 14237.2612s
	iters: 200, epoch: 17 | loss: 0.0099425
	speed: 0.0840s/iter; left time: 3291.2239s
	iters: 300, epoch: 17 | loss: 0.0056188
	speed: 0.0865s/iter; left time: 3380.9374s
	iters: 400, epoch: 17 | loss: 0.0021056
	speed: 0.0884s/iter; left time: 3448.1119s
Epoch: 17 cost time: 40.804967164993286
Epoch: 17, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1898165
	speed: 0.3547s/iter; left time: 13773.3014s
	iters: 200, epoch: 18 | loss: 0.0149182
	speed: 0.0804s/iter; left time: 3112.0285s
	iters: 300, epoch: 18 | loss: 0.0063450
	speed: 0.0810s/iter; left time: 3130.2734s
	iters: 400, epoch: 18 | loss: 0.0023544
	speed: 0.0788s/iter; left time: 3035.9853s
Epoch: 18 cost time: 37.92460894584656
Epoch: 18, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.960 Test Loss: 0.208 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1768598
	speed: 0.3489s/iter; left time: 13382.5379s
	iters: 200, epoch: 19 | loss: 0.0035711
	speed: 0.0835s/iter; left time: 3195.7094s
	iters: 300, epoch: 19 | loss: 0.0166757
	speed: 0.0834s/iter; left time: 3182.9919s
	iters: 400, epoch: 19 | loss: 0.1967374
	speed: 0.0844s/iter; left time: 3213.0344s
Epoch: 19 cost time: 39.04591703414917
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.214 Vali Acc: 0.963 Test Loss: 0.214 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.1013695
	speed: 0.3444s/iter; left time: 13051.0011s
	iters: 200, epoch: 20 | loss: 0.0332994
	speed: 0.0788s/iter; left time: 2978.6445s
	iters: 300, epoch: 20 | loss: 0.2015247
	speed: 0.0780s/iter; left time: 2939.5507s
	iters: 400, epoch: 20 | loss: 0.0044411
	speed: 0.0788s/iter; left time: 2961.7491s
Epoch: 20 cost time: 37.90475344657898
Epoch: 20, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
Validation loss decreased (-0.964835 --> -0.970839).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0027229
	speed: 0.3567s/iter; left time: 13349.3348s
	iters: 200, epoch: 21 | loss: 0.0115603
	speed: 0.0860s/iter; left time: 3208.1704s
	iters: 300, epoch: 21 | loss: 0.1416660
	speed: 0.0875s/iter; left time: 3255.6555s
	iters: 400, epoch: 21 | loss: 0.0122686
	speed: 0.0861s/iter; left time: 3197.3865s
Epoch: 21 cost time: 40.71354913711548
Epoch: 21, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.254 Vali Acc: 0.949 Test Loss: 0.254 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0126134
	speed: 0.3588s/iter; left time: 13258.1502s
	iters: 200, epoch: 22 | loss: 0.0067046
	speed: 0.0822s/iter; left time: 3028.3953s
	iters: 300, epoch: 22 | loss: 0.0867012
	speed: 0.0805s/iter; left time: 2959.4435s
	iters: 400, epoch: 22 | loss: 0.0042671
	speed: 0.0794s/iter; left time: 2909.4911s
Epoch: 22 cost time: 39.08893537521362
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0188254
	speed: 0.3593s/iter; left time: 13108.1935s
	iters: 200, epoch: 23 | loss: 0.0038008
	speed: 0.0782s/iter; left time: 2843.8582s
	iters: 300, epoch: 23 | loss: 0.0051154
	speed: 0.0861s/iter; left time: 3123.6881s
	iters: 400, epoch: 23 | loss: 0.4629587
	speed: 0.0818s/iter; left time: 2961.4088s
Epoch: 23 cost time: 38.582621812820435
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0078063
	speed: 0.3472s/iter; left time: 12503.6162s
	iters: 200, epoch: 24 | loss: 0.0013945
	speed: 0.0840s/iter; left time: 3018.4039s
	iters: 300, epoch: 24 | loss: 0.0007320
	speed: 0.0823s/iter; left time: 2946.5317s
	iters: 400, epoch: 24 | loss: 0.0023536
	speed: 0.0807s/iter; left time: 2880.8580s
Epoch: 24 cost time: 39.26250410079956
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0099834
	speed: 0.3555s/iter; left time: 12636.7378s
	iters: 200, epoch: 25 | loss: 0.0020489
	speed: 0.0876s/iter; left time: 3103.2741s
	iters: 300, epoch: 25 | loss: 0.0867176
	speed: 0.0923s/iter; left time: 3263.2837s
	iters: 400, epoch: 25 | loss: 0.0157725
	speed: 0.0858s/iter; left time: 3023.9869s
Epoch: 25 cost time: 41.386255741119385
Epoch: 25, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0068119
	speed: 0.3719s/iter; left time: 13044.7091s
	iters: 200, epoch: 26 | loss: 0.0013192
	speed: 0.0844s/iter; left time: 2952.7112s
	iters: 300, epoch: 26 | loss: 0.0019296
	speed: 0.0848s/iter; left time: 2958.6741s
	iters: 400, epoch: 26 | loss: 0.1035574
	speed: 0.0848s/iter; left time: 2948.8416s
Epoch: 26 cost time: 40.048994302749634
Epoch: 26, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0084901
	speed: 0.3470s/iter; left time: 12009.9200s
	iters: 200, epoch: 27 | loss: 0.0025563
	speed: 0.0837s/iter; left time: 2888.7181s
	iters: 300, epoch: 27 | loss: 0.0042078
	speed: 0.0819s/iter; left time: 2818.4123s
	iters: 400, epoch: 27 | loss: 0.0188289
	speed: 0.0803s/iter; left time: 2753.9948s
Epoch: 27 cost time: 38.56751275062561
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
Validation loss decreased (-0.970839 --> -0.971411).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0019463
	speed: 0.3461s/iter; left time: 11815.1150s
	iters: 200, epoch: 28 | loss: 0.0067273
	speed: 0.0813s/iter; left time: 2766.7672s
	iters: 300, epoch: 28 | loss: 0.0024842
	speed: 0.0822s/iter; left time: 2789.7195s
	iters: 400, epoch: 28 | loss: 0.1368026
	speed: 0.0846s/iter; left time: 2861.8141s
Epoch: 28 cost time: 39.135087966918945
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.251 Vali Acc: 0.943 Test Loss: 0.251 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0029742
	speed: 0.3455s/iter; left time: 11632.7540s
	iters: 200, epoch: 29 | loss: 0.0014000
	speed: 0.0787s/iter; left time: 2642.1551s
	iters: 300, epoch: 29 | loss: 0.0712147
	speed: 0.0815s/iter; left time: 2726.1085s
	iters: 400, epoch: 29 | loss: 0.0011470
	speed: 0.0832s/iter; left time: 2774.9747s
Epoch: 29 cost time: 38.09528660774231
Epoch: 29, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0036533
	speed: 0.3620s/iter; left time: 12018.8933s
	iters: 200, epoch: 30 | loss: 0.0054405
	speed: 0.0817s/iter; left time: 2702.6964s
	iters: 300, epoch: 30 | loss: 0.0017024
	speed: 0.0825s/iter; left time: 2723.9814s
	iters: 400, epoch: 30 | loss: 0.0022438
	speed: 0.0844s/iter; left time: 2777.7213s
Epoch: 30 cost time: 39.9557671546936
Epoch: 30, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0032647
	speed: 0.3081s/iter; left time: 10085.1922s
	iters: 200, epoch: 31 | loss: 0.0054400
	speed: 0.0821s/iter; left time: 2679.3464s
	iters: 300, epoch: 31 | loss: 0.0013178
	speed: 0.0855s/iter; left time: 2781.7446s
	iters: 400, epoch: 31 | loss: 0.0013181
	speed: 0.0794s/iter; left time: 2575.7703s
Epoch: 31 cost time: 38.367260217666626
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.185 Vali Acc: 0.966 Test Loss: 0.185 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.3208473
	speed: 0.3376s/iter; left time: 10891.5057s
	iters: 200, epoch: 32 | loss: 0.0031942
	speed: 0.0818s/iter; left time: 2631.1682s
	iters: 300, epoch: 32 | loss: 0.0140646
	speed: 0.0787s/iter; left time: 2524.8272s
	iters: 400, epoch: 32 | loss: 0.0011962
	speed: 0.0821s/iter; left time: 2624.4514s
Epoch: 32 cost time: 38.83014440536499
Epoch: 32, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.230 Vali Acc: 0.962 Test Loss: 0.230 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0284419
	speed: 0.3551s/iter; left time: 11289.3168s
	iters: 200, epoch: 33 | loss: 0.0848158
	speed: 0.0866s/iter; left time: 2744.0729s
	iters: 300, epoch: 33 | loss: 0.0020895
	speed: 0.0853s/iter; left time: 2696.3577s
	iters: 400, epoch: 33 | loss: 0.0008416
	speed: 0.0823s/iter; left time: 2590.6051s
Epoch: 33 cost time: 39.644423723220825
Epoch: 33, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.196 Vali Acc: 0.969 Test Loss: 0.196 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0035335
	speed: 0.3448s/iter; left time: 10799.5753s
	iters: 200, epoch: 34 | loss: 0.0024218
	speed: 0.0838s/iter; left time: 2617.5469s
	iters: 300, epoch: 34 | loss: 0.0149643
	speed: 0.0881s/iter; left time: 2742.0273s
	iters: 400, epoch: 34 | loss: 0.0016617
	speed: 0.0885s/iter; left time: 2745.5602s
Epoch: 34 cost time: 41.02011036872864
Epoch: 34, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0385748
	speed: 0.3747s/iter; left time: 11560.6129s
	iters: 200, epoch: 35 | loss: 0.0037940
	speed: 0.0864s/iter; left time: 2657.8228s
	iters: 300, epoch: 35 | loss: 0.0089130
	speed: 0.0880s/iter; left time: 2696.1999s
	iters: 400, epoch: 35 | loss: 0.7207756
	speed: 0.0856s/iter; left time: 2616.3392s
Epoch: 35 cost time: 40.72433829307556
Epoch: 35, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.964 Test Loss: 0.210 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0045466
	speed: 0.3751s/iter; left time: 11396.7605s
	iters: 200, epoch: 36 | loss: 0.0010563
	speed: 0.0834s/iter; left time: 2527.0105s
	iters: 300, epoch: 36 | loss: 0.0033585
	speed: 0.0881s/iter; left time: 2660.8795s
	iters: 400, epoch: 36 | loss: 0.0008107
	speed: 0.0782s/iter; left time: 2351.3863s
Epoch: 36 cost time: 40.13902282714844
Epoch: 36, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0006205
	speed: 0.3512s/iter; left time: 10507.4116s
	iters: 200, epoch: 37 | loss: 0.0031964
	speed: 0.0810s/iter; left time: 2415.6542s
	iters: 300, epoch: 37 | loss: 0.0003045
	speed: 0.0813s/iter; left time: 2414.6011s
	iters: 400, epoch: 37 | loss: 0.0007796
	speed: 0.0818s/iter; left time: 2422.6189s
Epoch: 37 cost time: 39.08108973503113
Epoch: 37, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.239 Vali Acc: 0.959 Test Loss: 0.239 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9714122355631789
model parameter : 458790
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8933718
	speed: 0.0931s/iter; left time: 4357.4423s
	iters: 200, epoch: 1 | loss: 0.5684541
	speed: 0.0799s/iter; left time: 3729.8614s
	iters: 300, epoch: 1 | loss: 0.2499381
	speed: 0.0792s/iter; left time: 3691.9834s
	iters: 400, epoch: 1 | loss: 0.2496243
	speed: 0.0824s/iter; left time: 3830.4415s
Epoch: 1 cost time: 39.229100942611694
Epoch: 1, Steps: 469 | Train Loss: 0.797 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
Validation loss decreased (inf --> -0.890791).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4874827
	speed: 0.3565s/iter; left time: 16518.6868s
	iters: 200, epoch: 2 | loss: 0.2400674
	speed: 0.0836s/iter; left time: 3864.6920s
	iters: 300, epoch: 2 | loss: 0.3151845
	speed: 0.0796s/iter; left time: 3673.8789s
	iters: 400, epoch: 2 | loss: 0.2117472
	speed: 0.0757s/iter; left time: 3483.8883s
Epoch: 2 cost time: 37.98011350631714
Epoch: 2, Steps: 469 | Train Loss: 0.227 Vali Loss: 0.308 Vali Acc: 0.905 Test Loss: 0.308 Test Acc: 0.905
Validation loss decreased (-0.890791 --> -0.905086).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0463618
	speed: 0.3378s/iter; left time: 15491.0836s
	iters: 200, epoch: 3 | loss: 0.4077854
	speed: 0.0751s/iter; left time: 3437.9025s
	iters: 300, epoch: 3 | loss: 0.1306594
	speed: 0.0802s/iter; left time: 3663.6115s
	iters: 400, epoch: 3 | loss: 0.1290300
	speed: 0.0883s/iter; left time: 4023.5685s
Epoch: 3 cost time: 37.97489857673645
Epoch: 3, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.348 Vali Acc: 0.898 Test Loss: 0.348 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2652236
	speed: 0.3482s/iter; left time: 15808.1185s
	iters: 200, epoch: 4 | loss: 0.5371642
	speed: 0.0841s/iter; left time: 3809.1393s
	iters: 300, epoch: 4 | loss: 0.0084080
	speed: 0.0850s/iter; left time: 3843.0940s
	iters: 400, epoch: 4 | loss: 0.1882479
	speed: 0.0793s/iter; left time: 3574.9114s
Epoch: 4 cost time: 39.03710341453552
Epoch: 4, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.905086 --> -0.949112).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0741013
	speed: 0.3413s/iter; left time: 15332.5472s
	iters: 200, epoch: 5 | loss: 0.0340789
	speed: 0.0775s/iter; left time: 3473.4792s
	iters: 300, epoch: 5 | loss: 0.0991512
	speed: 0.0748s/iter; left time: 3343.2418s
	iters: 400, epoch: 5 | loss: 0.0184310
	speed: 0.0784s/iter; left time: 3499.7818s
Epoch: 5 cost time: 37.05981183052063
Epoch: 5, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.285 Vali Acc: 0.923 Test Loss: 0.285 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1640346
	speed: 0.3415s/iter; left time: 15179.8701s
	iters: 200, epoch: 6 | loss: 0.1231390
	speed: 0.0860s/iter; left time: 3813.7367s
	iters: 300, epoch: 6 | loss: 0.5657696
	speed: 0.0868s/iter; left time: 3842.0675s
	iters: 400, epoch: 6 | loss: 0.0476148
	speed: 0.0819s/iter; left time: 3615.3399s
Epoch: 6 cost time: 39.47284913063049
Epoch: 6, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.949112 --> -0.959118).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0451042
	speed: 0.3727s/iter; left time: 16395.3079s
	iters: 200, epoch: 7 | loss: 0.1016580
	speed: 0.0797s/iter; left time: 3496.0299s
	iters: 300, epoch: 7 | loss: 0.0188938
	speed: 0.0785s/iter; left time: 3436.3782s
	iters: 400, epoch: 7 | loss: 0.0013916
	speed: 0.0826s/iter; left time: 3608.8880s
Epoch: 7 cost time: 38.88973331451416
Epoch: 7, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0056801
	speed: 0.3696s/iter; left time: 16083.1719s
	iters: 200, epoch: 8 | loss: 0.0225387
	speed: 0.0853s/iter; left time: 3705.0021s
	iters: 300, epoch: 8 | loss: 0.0210002
	speed: 0.0901s/iter; left time: 3904.2636s
	iters: 400, epoch: 8 | loss: 0.0081323
	speed: 0.0852s/iter; left time: 3682.9941s
Epoch: 8 cost time: 40.71242809295654
Epoch: 8, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
Validation loss decreased (-0.959118 --> -0.963978).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2897226
	speed: 0.3545s/iter; left time: 15258.8283s
	iters: 200, epoch: 9 | loss: 0.0058796
	speed: 0.0743s/iter; left time: 3189.0096s
	iters: 300, epoch: 9 | loss: 0.0100448
	speed: 0.0731s/iter; left time: 3133.6377s
	iters: 400, epoch: 9 | loss: 0.1547923
	speed: 0.0745s/iter; left time: 3183.5969s
Epoch: 9 cost time: 35.9283561706543
Epoch: 9, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2537505
	speed: 0.3382s/iter; left time: 14401.7024s
	iters: 200, epoch: 10 | loss: 0.3087801
	speed: 0.0816s/iter; left time: 3467.2239s
	iters: 300, epoch: 10 | loss: 0.0111323
	speed: 0.0828s/iter; left time: 3508.1753s
	iters: 400, epoch: 10 | loss: 0.0038461
	speed: 0.0737s/iter; left time: 3115.9240s
Epoch: 10 cost time: 37.44924306869507
Epoch: 10, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.963978 --> -0.964835).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0413271
	speed: 0.3117s/iter; left time: 13127.7395s
	iters: 200, epoch: 11 | loss: 0.2220956
	speed: 0.0762s/iter; left time: 3202.5697s
	iters: 300, epoch: 11 | loss: 0.0097915
	speed: 0.0770s/iter; left time: 3227.7062s
	iters: 400, epoch: 11 | loss: 0.0063378
	speed: 0.0753s/iter; left time: 3147.0850s
Epoch: 11 cost time: 36.252716064453125
Epoch: 11, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6516815
	speed: 0.3328s/iter; left time: 13857.4143s
	iters: 200, epoch: 12 | loss: 0.0194045
	speed: 0.0828s/iter; left time: 3438.7068s
	iters: 300, epoch: 12 | loss: 0.0022875
	speed: 0.0798s/iter; left time: 3305.7783s
	iters: 400, epoch: 12 | loss: 0.0290619
	speed: 0.0811s/iter; left time: 3351.4842s
Epoch: 12 cost time: 38.09173059463501
Epoch: 12, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.964835 --> -0.972269).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0037125
	speed: 0.3360s/iter; left time: 13835.5732s
	iters: 200, epoch: 13 | loss: 0.6956457
	speed: 0.0824s/iter; left time: 3386.1516s
	iters: 300, epoch: 13 | loss: 0.0726609
	speed: 0.0804s/iter; left time: 3294.3034s
	iters: 400, epoch: 13 | loss: 0.0023048
	speed: 0.0832s/iter; left time: 3399.2365s
Epoch: 13 cost time: 38.41083884239197
Epoch: 13, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0279238
	speed: 0.3372s/iter; left time: 13726.5916s
	iters: 200, epoch: 14 | loss: 0.0020345
	speed: 0.0813s/iter; left time: 3299.4396s
	iters: 300, epoch: 14 | loss: 0.0021311
	speed: 0.0774s/iter; left time: 3133.0028s
	iters: 400, epoch: 14 | loss: 0.1147338
	speed: 0.0793s/iter; left time: 3203.1373s
Epoch: 14 cost time: 37.2431218624115
Epoch: 14, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0907409
	speed: 0.3531s/iter; left time: 14207.9806s
	iters: 200, epoch: 15 | loss: 0.1878253
	speed: 0.0859s/iter; left time: 3446.0214s
	iters: 300, epoch: 15 | loss: 0.0046921
	speed: 0.0854s/iter; left time: 3419.3044s
	iters: 400, epoch: 15 | loss: 0.0122695
	speed: 0.0841s/iter; left time: 3359.7624s
Epoch: 15 cost time: 40.44923710823059
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3558869
	speed: 0.3612s/iter; left time: 14362.0997s
	iters: 200, epoch: 16 | loss: 0.0371094
	speed: 0.0813s/iter; left time: 3223.9961s
	iters: 300, epoch: 16 | loss: 0.0125974
	speed: 0.0852s/iter; left time: 3369.2802s
	iters: 400, epoch: 16 | loss: 0.0132315
	speed: 0.0857s/iter; left time: 3383.2801s
Epoch: 16 cost time: 39.73817706108093
Epoch: 16, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0032424
	speed: 0.3661s/iter; left time: 14385.5691s
	iters: 200, epoch: 17 | loss: 0.0226789
	speed: 0.0804s/iter; left time: 3151.1065s
	iters: 300, epoch: 17 | loss: 0.0130195
	speed: 0.0811s/iter; left time: 3172.4948s
	iters: 400, epoch: 17 | loss: 0.0033814
	speed: 0.0783s/iter; left time: 3055.0415s
Epoch: 17 cost time: 38.468931674957275
Epoch: 17, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.220 Vali Acc: 0.955 Test Loss: 0.220 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2342014
	speed: 0.3465s/iter; left time: 13455.5969s
	iters: 200, epoch: 18 | loss: 0.0362660
	speed: 0.0775s/iter; left time: 2999.5681s
	iters: 300, epoch: 18 | loss: 0.0025859
	speed: 0.0761s/iter; left time: 2941.2266s
	iters: 400, epoch: 18 | loss: 0.0147984
	speed: 0.0808s/iter; left time: 3112.4316s
Epoch: 18 cost time: 37.68635106086731
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0017053
	speed: 0.3549s/iter; left time: 13612.3305s
	iters: 200, epoch: 19 | loss: 0.2342148
	speed: 0.0812s/iter; left time: 3108.4654s
	iters: 300, epoch: 19 | loss: 0.0495263
	speed: 0.0798s/iter; left time: 3045.6088s
	iters: 400, epoch: 19 | loss: 0.2376291
	speed: 0.0804s/iter; left time: 3061.6718s
Epoch: 19 cost time: 38.476606607437134
Epoch: 19, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0011720
	speed: 0.3671s/iter; left time: 13909.0040s
	iters: 200, epoch: 20 | loss: 0.0066143
	speed: 0.0833s/iter; left time: 3147.2210s
	iters: 300, epoch: 20 | loss: 0.0033215
	speed: 0.0791s/iter; left time: 2982.6889s
	iters: 400, epoch: 20 | loss: 0.6011443
	speed: 0.0842s/iter; left time: 3166.8520s
Epoch: 20 cost time: 39.5570182800293
Epoch: 20, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0728945
	speed: 0.3655s/iter; left time: 13679.0018s
	iters: 200, epoch: 21 | loss: 0.0038924
	speed: 0.0826s/iter; left time: 3084.3507s
	iters: 300, epoch: 21 | loss: 0.0066581
	speed: 0.0836s/iter; left time: 3112.0193s
	iters: 400, epoch: 21 | loss: 0.0772559
	speed: 0.0802s/iter; left time: 2977.9494s
Epoch: 21 cost time: 38.55161428451538
Epoch: 21, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.228 Vali Acc: 0.960 Test Loss: 0.228 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0168991
	speed: 0.3617s/iter; left time: 13364.7508s
	iters: 200, epoch: 22 | loss: 0.0036976
	speed: 0.0781s/iter; left time: 2877.1113s
	iters: 300, epoch: 22 | loss: 0.0114963
	speed: 0.0763s/iter; left time: 2803.8700s
	iters: 400, epoch: 22 | loss: 0.0119527
	speed: 0.0774s/iter; left time: 2837.9852s
Epoch: 22 cost time: 37.73864245414734
Epoch: 22, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.972269 --> -0.976271).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0112588
	speed: 0.3456s/iter; left time: 12609.5485s
	iters: 200, epoch: 23 | loss: 0.0036926
	speed: 0.0822s/iter; left time: 2989.0799s
	iters: 300, epoch: 23 | loss: 0.0040604
	speed: 0.0915s/iter; left time: 3319.5004s
	iters: 400, epoch: 23 | loss: 0.0181082
	speed: 0.0832s/iter; left time: 3009.8873s
Epoch: 23 cost time: 39.92241954803467
Epoch: 23, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0954230
	speed: 0.3879s/iter; left time: 13970.3145s
	iters: 200, epoch: 24 | loss: 0.0014725
	speed: 0.0893s/iter; left time: 3206.4617s
	iters: 300, epoch: 24 | loss: 0.0642586
	speed: 0.0874s/iter; left time: 3131.2506s
	iters: 400, epoch: 24 | loss: 0.0055235
	speed: 0.0877s/iter; left time: 3132.2218s
Epoch: 24 cost time: 42.75347924232483
Epoch: 24, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0441737
	speed: 0.3940s/iter; left time: 14005.8232s
	iters: 200, epoch: 25 | loss: 0.0036815
	speed: 0.0931s/iter; left time: 3298.3066s
	iters: 300, epoch: 25 | loss: 0.0165735
	speed: 0.0941s/iter; left time: 3324.8007s
	iters: 400, epoch: 25 | loss: 0.0029625
	speed: 0.0910s/iter; left time: 3209.0262s
Epoch: 25 cost time: 43.761075496673584
Epoch: 25, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0022501
	speed: 0.4042s/iter; left time: 14179.4642s
	iters: 200, epoch: 26 | loss: 0.0062290
	speed: 0.0863s/iter; left time: 3019.8431s
	iters: 300, epoch: 26 | loss: 0.0018243
	speed: 0.0875s/iter; left time: 3050.6284s
	iters: 400, epoch: 26 | loss: 0.1308213
	speed: 0.0823s/iter; left time: 2863.7917s
Epoch: 26 cost time: 41.61850571632385
Epoch: 26, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0024042
	speed: 0.3758s/iter; left time: 13004.5190s
	iters: 200, epoch: 27 | loss: 0.0038418
	speed: 0.0863s/iter; left time: 2976.4703s
	iters: 300, epoch: 27 | loss: 0.0023290
	speed: 0.0871s/iter; left time: 2995.5830s
	iters: 400, epoch: 27 | loss: 0.0053117
	speed: 0.0847s/iter; left time: 2904.0976s
Epoch: 27 cost time: 40.31197810173035
Epoch: 27, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0055128
	speed: 0.3660s/iter; left time: 12495.9956s
	iters: 200, epoch: 28 | loss: 0.4344405
	speed: 0.0839s/iter; left time: 2856.7615s
	iters: 300, epoch: 28 | loss: 0.2468868
	speed: 0.0863s/iter; left time: 2927.3179s
	iters: 400, epoch: 28 | loss: 0.0033857
	speed: 0.0869s/iter; left time: 2939.9859s
Epoch: 28 cost time: 40.82664752006531
Epoch: 28, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.964 Test Loss: 0.199 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0013064
	speed: 0.3647s/iter; left time: 12278.1390s
	iters: 200, epoch: 29 | loss: 0.0019501
	speed: 0.0830s/iter; left time: 2785.4815s
	iters: 300, epoch: 29 | loss: 0.1006460
	speed: 0.0846s/iter; left time: 2832.2175s
	iters: 400, epoch: 29 | loss: 0.0046923
	speed: 0.0874s/iter; left time: 2916.1166s
Epoch: 29 cost time: 39.917566537857056
Epoch: 29, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0012137
	speed: 0.3762s/iter; left time: 12488.9511s
	iters: 200, epoch: 30 | loss: 0.0481686
	speed: 0.0841s/iter; left time: 2782.8942s
	iters: 300, epoch: 30 | loss: 0.0968214
	speed: 0.0802s/iter; left time: 2647.4417s
	iters: 400, epoch: 30 | loss: 0.0058565
	speed: 0.0823s/iter; left time: 2708.8936s
Epoch: 30 cost time: 39.90086603164673
Epoch: 30, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0034846
	speed: 0.3456s/iter; left time: 11311.6043s
	iters: 200, epoch: 31 | loss: 0.0019653
	speed: 0.0834s/iter; left time: 2720.0735s
	iters: 300, epoch: 31 | loss: 0.0046733
	speed: 0.0824s/iter; left time: 2680.6819s
	iters: 400, epoch: 31 | loss: 0.0061246
	speed: 0.0840s/iter; left time: 2724.0795s
Epoch: 31 cost time: 39.06003427505493
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1239660
	speed: 0.3539s/iter; left time: 11417.8601s
	iters: 200, epoch: 32 | loss: 0.3214019
	speed: 0.0867s/iter; left time: 2788.3663s
	iters: 300, epoch: 32 | loss: 0.0033945
	speed: 0.0793s/iter; left time: 2542.4997s
	iters: 400, epoch: 32 | loss: 0.0200920
	speed: 0.0803s/iter; left time: 2566.8696s
Epoch: 32 cost time: 39.071433305740356
Epoch: 32, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 458662
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5485008
	speed: 0.1051s/iter; left time: 4917.2585s
	iters: 200, epoch: 1 | loss: 0.8239331
	speed: 0.0855s/iter; left time: 3993.6302s
	iters: 300, epoch: 1 | loss: 0.3314484
	speed: 0.0845s/iter; left time: 3937.4683s
	iters: 400, epoch: 1 | loss: 0.2104391
	speed: 0.0889s/iter; left time: 4136.1591s
Epoch: 1 cost time: 43.02114415168762
Epoch: 1, Steps: 469 | Train Loss: 0.931 Vali Loss: 0.363 Vali Acc: 0.893 Test Loss: 0.363 Test Acc: 0.893
Validation loss decreased (inf --> -0.892792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5204440
	speed: 0.3909s/iter; left time: 18111.6238s
	iters: 200, epoch: 2 | loss: 0.2376150
	speed: 0.0913s/iter; left time: 4220.4863s
	iters: 300, epoch: 2 | loss: 0.1652663
	speed: 0.1003s/iter; left time: 4627.0474s
	iters: 400, epoch: 2 | loss: 0.0436757
	speed: 0.0894s/iter; left time: 4116.5383s
Epoch: 2 cost time: 43.17740321159363
Epoch: 2, Steps: 469 | Train Loss: 0.226 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
Validation loss decreased (-0.892792 --> -0.920238).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0650653
	speed: 0.3940s/iter; left time: 18071.2671s
	iters: 200, epoch: 3 | loss: 0.1512387
	speed: 0.0892s/iter; left time: 4080.8540s
	iters: 300, epoch: 3 | loss: 0.0400930
	speed: 0.0925s/iter; left time: 4222.9187s
	iters: 400, epoch: 3 | loss: 0.0805431
	speed: 0.0837s/iter; left time: 3814.4079s
Epoch: 3 cost time: 41.91034173965454
Epoch: 3, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.920238 --> -0.941107).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0534274
	speed: 0.3939s/iter; left time: 17881.0171s
	iters: 200, epoch: 4 | loss: 0.0387618
	speed: 0.0914s/iter; left time: 4140.8392s
	iters: 300, epoch: 4 | loss: 0.2616290
	speed: 0.0869s/iter; left time: 3926.0412s
	iters: 400, epoch: 4 | loss: 0.0153739
	speed: 0.0849s/iter; left time: 3829.4021s
Epoch: 4 cost time: 41.42057418823242
Epoch: 4, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
Validation loss decreased (-0.941107 --> -0.946253).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3595853
	speed: 0.3630s/iter; left time: 16306.7643s
	iters: 200, epoch: 5 | loss: 0.0164787
	speed: 0.0822s/iter; left time: 3685.8261s
	iters: 300, epoch: 5 | loss: 0.0219231
	speed: 0.0838s/iter; left time: 3748.3865s
	iters: 400, epoch: 5 | loss: 0.2439948
	speed: 0.0846s/iter; left time: 3774.6756s
Epoch: 5 cost time: 39.400442123413086
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.946253 --> -0.954258).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0331051
	speed: 0.3664s/iter; left time: 16290.3564s
	iters: 200, epoch: 6 | loss: 0.0562060
	speed: 0.0928s/iter; left time: 4116.3619s
	iters: 300, epoch: 6 | loss: 0.0118246
	speed: 0.0845s/iter; left time: 3739.0507s
	iters: 400, epoch: 6 | loss: 0.0746749
	speed: 0.0843s/iter; left time: 3721.0281s
Epoch: 6 cost time: 41.24317932128906
Epoch: 6, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.244 Vali Acc: 0.929 Test Loss: 0.244 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0096365
	speed: 0.3790s/iter; left time: 16669.3230s
	iters: 200, epoch: 7 | loss: 0.0179535
	speed: 0.0858s/iter; left time: 3766.4285s
	iters: 300, epoch: 7 | loss: 0.0192513
	speed: 0.0877s/iter; left time: 3839.7667s
	iters: 400, epoch: 7 | loss: 0.0174643
	speed: 0.0833s/iter; left time: 3638.9609s
Epoch: 7 cost time: 40.50969648361206
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.954258 --> -0.966265).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0026780
	speed: 0.3863s/iter; left time: 16809.6840s
	iters: 200, epoch: 8 | loss: 0.1690882
	speed: 0.0869s/iter; left time: 3772.1623s
	iters: 300, epoch: 8 | loss: 0.4661500
	speed: 0.0848s/iter; left time: 3674.1967s
	iters: 400, epoch: 8 | loss: 0.3955076
	speed: 0.0880s/iter; left time: 3804.8373s
Epoch: 8 cost time: 41.32895255088806
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1502123
	speed: 0.3693s/iter; left time: 15897.9220s
	iters: 200, epoch: 9 | loss: 0.0342472
	speed: 0.0853s/iter; left time: 3661.8197s
	iters: 300, epoch: 9 | loss: 0.0030344
	speed: 0.0881s/iter; left time: 3775.3730s
	iters: 400, epoch: 9 | loss: 0.0087335
	speed: 0.0891s/iter; left time: 3806.8668s
Epoch: 9 cost time: 41.14827275276184
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.187 Vali Acc: 0.945 Test Loss: 0.187 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0264163
	speed: 0.3649s/iter; left time: 15536.8233s
	iters: 200, epoch: 10 | loss: 0.0130538
	speed: 0.0923s/iter; left time: 3919.3524s
	iters: 300, epoch: 10 | loss: 0.2784708
	speed: 0.0875s/iter; left time: 3708.9512s
	iters: 400, epoch: 10 | loss: 0.0431762
	speed: 0.0842s/iter; left time: 3558.5959s
Epoch: 10 cost time: 41.530498027801514
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0133475
	speed: 0.3759s/iter; left time: 15830.8295s
	iters: 200, epoch: 11 | loss: 0.0023103
	speed: 0.0910s/iter; left time: 3821.8212s
	iters: 300, epoch: 11 | loss: 0.1718690
	speed: 0.0871s/iter; left time: 3649.3901s
	iters: 400, epoch: 11 | loss: 0.2082120
	speed: 0.0900s/iter; left time: 3762.2563s
Epoch: 11 cost time: 41.349416732788086
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0510899
	speed: 0.3684s/iter; left time: 15341.5436s
	iters: 200, epoch: 12 | loss: 0.1108191
	speed: 0.0830s/iter; left time: 3446.4059s
	iters: 300, epoch: 12 | loss: 0.0189234
	speed: 0.0840s/iter; left time: 3480.1158s
	iters: 400, epoch: 12 | loss: 0.0207374
	speed: 0.0946s/iter; left time: 3910.5525s
Epoch: 12 cost time: 41.68311285972595
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0036832
	speed: 0.4063s/iter; left time: 16729.6022s
	iters: 200, epoch: 13 | loss: 0.0062940
	speed: 0.0925s/iter; left time: 3798.6413s
	iters: 300, epoch: 13 | loss: 0.0139230
	speed: 0.0918s/iter; left time: 3762.5111s
	iters: 400, epoch: 13 | loss: 0.0184015
	speed: 0.0931s/iter; left time: 3806.4926s
Epoch: 13 cost time: 44.47088980674744
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0019839
	speed: 0.4019s/iter; left time: 16359.8188s
	iters: 200, epoch: 14 | loss: 0.1128013
	speed: 0.0917s/iter; left time: 3723.6488s
	iters: 300, epoch: 14 | loss: 0.0065009
	speed: 0.0874s/iter; left time: 3538.1624s
	iters: 400, epoch: 14 | loss: 0.0944989
	speed: 0.0864s/iter; left time: 3489.5713s
Epoch: 14 cost time: 42.33892369270325
Epoch: 14, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5420488
	speed: 0.3755s/iter; left time: 15109.8692s
	iters: 200, epoch: 15 | loss: 0.0091487
	speed: 0.0901s/iter; left time: 3616.8530s
	iters: 300, epoch: 15 | loss: 0.0013628
	speed: 0.0907s/iter; left time: 3630.7073s
	iters: 400, epoch: 15 | loss: 0.0113790
	speed: 0.0911s/iter; left time: 3639.8873s
Epoch: 15 cost time: 42.027127265930176
Epoch: 15, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.966265 --> -0.968838).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0016201
	speed: 0.3745s/iter; left time: 14892.3782s
	iters: 200, epoch: 16 | loss: 0.0247504
	speed: 0.0867s/iter; left time: 3439.5666s
	iters: 300, epoch: 16 | loss: 0.0098524
	speed: 0.0828s/iter; left time: 3274.8282s
	iters: 400, epoch: 16 | loss: 0.0788866
	speed: 0.0841s/iter; left time: 3321.0247s
Epoch: 16 cost time: 40.85565900802612
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969410).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0030738
	speed: 0.3654s/iter; left time: 14357.4507s
	iters: 200, epoch: 17 | loss: 0.0237431
	speed: 0.0874s/iter; left time: 3425.3039s
	iters: 300, epoch: 17 | loss: 0.0025254
	speed: 0.0876s/iter; left time: 3424.1374s
	iters: 400, epoch: 17 | loss: 0.0176891
	speed: 0.0929s/iter; left time: 3621.1737s
Epoch: 17 cost time: 42.111963748931885
Epoch: 17, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1810305
	speed: 0.4015s/iter; left time: 15590.9955s
	iters: 200, epoch: 18 | loss: 0.0032108
	speed: 0.0848s/iter; left time: 3284.1975s
	iters: 300, epoch: 18 | loss: 0.0022787
	speed: 0.0835s/iter; left time: 3225.2998s
	iters: 400, epoch: 18 | loss: 0.5141026
	speed: 0.0840s/iter; left time: 3236.9228s
Epoch: 18 cost time: 41.56529641151428
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.969410 --> -0.976557).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0057328
	speed: 0.3648s/iter; left time: 13992.5175s
	iters: 200, epoch: 19 | loss: 0.0029461
	speed: 0.0873s/iter; left time: 3340.8809s
	iters: 300, epoch: 19 | loss: 0.0314111
	speed: 0.0880s/iter; left time: 3359.6116s
	iters: 400, epoch: 19 | loss: 0.0536832
	speed: 0.0823s/iter; left time: 3134.0232s
Epoch: 19 cost time: 40.22804021835327
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0331603
	speed: 0.3687s/iter; left time: 13971.6311s
	iters: 200, epoch: 20 | loss: 0.0029991
	speed: 0.0796s/iter; left time: 3007.0585s
	iters: 300, epoch: 20 | loss: 0.0023054
	speed: 0.0801s/iter; left time: 3020.8416s
	iters: 400, epoch: 20 | loss: 0.3218676
	speed: 0.0840s/iter; left time: 3158.8436s
Epoch: 20 cost time: 38.67017650604248
Epoch: 20, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0064357
	speed: 0.3867s/iter; left time: 14471.8210s
	iters: 200, epoch: 21 | loss: 0.0010085
	speed: 0.0940s/iter; left time: 3509.4430s
	iters: 300, epoch: 21 | loss: 0.0360678
	speed: 0.0906s/iter; left time: 3371.7257s
	iters: 400, epoch: 21 | loss: 0.0019071
	speed: 0.0947s/iter; left time: 3515.5478s
Epoch: 21 cost time: 43.76428747177124
Epoch: 21, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0841161
	speed: 0.3908s/iter; left time: 14440.5476s
	iters: 200, epoch: 22 | loss: 0.0015875
	speed: 0.0877s/iter; left time: 3233.6335s
	iters: 300, epoch: 22 | loss: 0.0015121
	speed: 0.0908s/iter; left time: 3337.3120s
	iters: 400, epoch: 22 | loss: 0.3453628
	speed: 0.0902s/iter; left time: 3307.4901s
Epoch: 22 cost time: 42.26201009750366
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0237436
	speed: 0.3873s/iter; left time: 14131.2617s
	iters: 200, epoch: 23 | loss: 0.0054473
	speed: 0.0858s/iter; left time: 3122.8811s
	iters: 300, epoch: 23 | loss: 0.0106188
	speed: 0.0811s/iter; left time: 2941.6877s
	iters: 400, epoch: 23 | loss: 0.0006414
	speed: 0.0833s/iter; left time: 3013.3665s
Epoch: 23 cost time: 40.103139877319336
Epoch: 23, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0019428
	speed: 0.3654s/iter; left time: 13158.0699s
	iters: 200, epoch: 24 | loss: 0.0029848
	speed: 0.0880s/iter; left time: 3159.3326s
	iters: 300, epoch: 24 | loss: 0.4015106
	speed: 0.0911s/iter; left time: 3263.6295s
	iters: 400, epoch: 24 | loss: 0.0016684
	speed: 0.0831s/iter; left time: 2968.5580s
Epoch: 24 cost time: 40.63365817070007
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0260229
	speed: 0.3597s/iter; left time: 12784.6812s
	iters: 200, epoch: 25 | loss: 0.0028219
	speed: 0.0823s/iter; left time: 2916.4255s
	iters: 300, epoch: 25 | loss: 0.0383088
	speed: 0.0825s/iter; left time: 2915.1159s
	iters: 400, epoch: 25 | loss: 0.0056770
	speed: 0.0909s/iter; left time: 3202.0212s
Epoch: 25 cost time: 40.976590633392334
Epoch: 25, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0014518
	speed: 0.3673s/iter; left time: 12882.3165s
	iters: 200, epoch: 26 | loss: 0.3858556
	speed: 0.0841s/iter; left time: 2942.5696s
	iters: 300, epoch: 26 | loss: 0.0028390
	speed: 0.0857s/iter; left time: 2987.2887s
	iters: 400, epoch: 26 | loss: 0.2885995
	speed: 0.0870s/iter; left time: 3024.9844s
Epoch: 26 cost time: 39.84723687171936
Epoch: 26, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0019614
	speed: 0.3666s/iter; left time: 12687.3913s
	iters: 200, epoch: 27 | loss: 0.0006353
	speed: 0.0883s/iter; left time: 3045.9500s
	iters: 300, epoch: 27 | loss: 0.0012984
	speed: 0.0897s/iter; left time: 3087.7717s
	iters: 400, epoch: 27 | loss: 0.0568997
	speed: 0.0870s/iter; left time: 2985.1271s
Epoch: 27 cost time: 41.71344232559204
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0442937
	speed: 0.3708s/iter; left time: 12657.2983s
	iters: 200, epoch: 28 | loss: 0.0012062
	speed: 0.0853s/iter; left time: 2904.6821s
	iters: 300, epoch: 28 | loss: 0.0022721
	speed: 0.0868s/iter; left time: 2945.6072s
	iters: 400, epoch: 28 | loss: 0.0574385
	speed: 0.0895s/iter; left time: 3026.9906s
Epoch: 28 cost time: 40.647748947143555
Epoch: 28, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 309286
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4120435
	speed: 0.1044s/iter; left time: 4885.8834s
	iters: 200, epoch: 1 | loss: 0.6196444
	speed: 0.0866s/iter; left time: 4046.2506s
	iters: 300, epoch: 1 | loss: 0.4366615
	speed: 0.0888s/iter; left time: 4138.2221s
	iters: 400, epoch: 1 | loss: 0.2159846
	speed: 0.0849s/iter; left time: 3946.5580s
Epoch: 1 cost time: 42.72263836860657
Epoch: 1, Steps: 469 | Train Loss: 0.874 Vali Loss: 0.388 Vali Acc: 0.879 Test Loss: 0.388 Test Acc: 0.879
Validation loss decreased (inf --> -0.878784).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1391763
	speed: 0.4001s/iter; left time: 18539.3063s
	iters: 200, epoch: 2 | loss: 0.2637055
	speed: 0.0940s/iter; left time: 4344.8320s
	iters: 300, epoch: 2 | loss: 0.1225899
	speed: 0.0996s/iter; left time: 4595.9393s
	iters: 400, epoch: 2 | loss: 0.0716030
	speed: 0.0955s/iter; left time: 4394.8670s
Epoch: 2 cost time: 45.45424032211304
Epoch: 2, Steps: 469 | Train Loss: 0.221 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.878784 --> -0.937105).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1149773
	speed: 0.4096s/iter; left time: 18785.4462s
	iters: 200, epoch: 3 | loss: 0.1204449
	speed: 0.0973s/iter; left time: 4454.8998s
	iters: 300, epoch: 3 | loss: 0.0257158
	speed: 0.0996s/iter; left time: 4549.0308s
	iters: 400, epoch: 3 | loss: 0.1714673
	speed: 0.0918s/iter; left time: 4183.7947s
Epoch: 3 cost time: 45.774266958236694
Epoch: 3, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.937105 --> -0.943966).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0134738
	speed: 0.3791s/iter; left time: 17208.8188s
	iters: 200, epoch: 4 | loss: 0.5038737
	speed: 0.0844s/iter; left time: 3822.7184s
	iters: 300, epoch: 4 | loss: 0.0265945
	speed: 0.0879s/iter; left time: 3974.7311s
	iters: 400, epoch: 4 | loss: 0.3560143
	speed: 0.0900s/iter; left time: 4058.0353s
Epoch: 4 cost time: 41.149853229522705
Epoch: 4, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0132108
	speed: 0.3765s/iter; left time: 16915.0751s
	iters: 200, epoch: 5 | loss: 0.0244594
	speed: 0.0959s/iter; left time: 4299.7426s
	iters: 300, epoch: 5 | loss: 0.0359760
	speed: 0.0894s/iter; left time: 3997.2505s
	iters: 400, epoch: 5 | loss: 0.0477975
	speed: 0.0931s/iter; left time: 4156.5624s
Epoch: 5 cost time: 43.73810839653015
Epoch: 5, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
Validation loss decreased (-0.943966 --> -0.945967).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0388610
	speed: 0.3489s/iter; left time: 15510.0676s
	iters: 200, epoch: 6 | loss: 0.0055571
	speed: 0.0891s/iter; left time: 3950.6925s
	iters: 300, epoch: 6 | loss: 0.1379506
	speed: 0.0889s/iter; left time: 3933.9878s
	iters: 400, epoch: 6 | loss: 0.0084604
	speed: 0.0889s/iter; left time: 3925.6100s
Epoch: 6 cost time: 42.078590869903564
Epoch: 6, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.945967 --> -0.966551).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0029075
	speed: 0.3905s/iter; left time: 17176.9222s
	iters: 200, epoch: 7 | loss: 0.0056178
	speed: 0.1009s/iter; left time: 4426.0950s
	iters: 300, epoch: 7 | loss: 0.0577337
	speed: 0.0922s/iter; left time: 4036.1199s
	iters: 400, epoch: 7 | loss: 0.4117038
	speed: 0.0866s/iter; left time: 3784.6433s
Epoch: 7 cost time: 44.877225399017334
Epoch: 7, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1863372
	speed: 0.3832s/iter; left time: 16677.5854s
	iters: 200, epoch: 8 | loss: 0.0056879
	speed: 0.0803s/iter; left time: 3487.6780s
	iters: 300, epoch: 8 | loss: 0.0136680
	speed: 0.0863s/iter; left time: 3738.7088s
	iters: 400, epoch: 8 | loss: 0.0093948
	speed: 0.0936s/iter; left time: 4043.7187s
Epoch: 8 cost time: 41.75987267494202
Epoch: 8, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0293498
	speed: 0.3757s/iter; left time: 16173.0445s
	iters: 200, epoch: 9 | loss: 0.0043583
	speed: 0.0912s/iter; left time: 3916.0281s
	iters: 300, epoch: 9 | loss: 0.0097014
	speed: 0.0832s/iter; left time: 3565.1185s
	iters: 400, epoch: 9 | loss: 0.0202197
	speed: 0.0837s/iter; left time: 3577.4988s
Epoch: 9 cost time: 41.29519176483154
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0035884
	speed: 0.3753s/iter; left time: 15980.1524s
	iters: 200, epoch: 10 | loss: 0.0296941
	speed: 0.0883s/iter; left time: 3750.8184s
	iters: 300, epoch: 10 | loss: 0.0055097
	speed: 0.0887s/iter; left time: 3760.7181s
	iters: 400, epoch: 10 | loss: 0.0106159
	speed: 0.0884s/iter; left time: 3735.8255s
Epoch: 10 cost time: 42.181965827941895
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.966551 --> -0.970553).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0253999
	speed: 0.3957s/iter; left time: 16662.0360s
	iters: 200, epoch: 11 | loss: 0.0131710
	speed: 0.0925s/iter; left time: 3884.2520s
	iters: 300, epoch: 11 | loss: 0.0564661
	speed: 0.0865s/iter; left time: 3625.1806s
	iters: 400, epoch: 11 | loss: 0.1245424
	speed: 0.0906s/iter; left time: 3787.2233s
Epoch: 11 cost time: 43.216495990753174
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.970553 --> -0.978272).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0062291
	speed: 0.4041s/iter; left time: 16826.2180s
	iters: 200, epoch: 12 | loss: 0.1097913
	speed: 0.0902s/iter; left time: 3745.3046s
	iters: 300, epoch: 12 | loss: 0.0611130
	speed: 0.0881s/iter; left time: 3649.8003s
	iters: 400, epoch: 12 | loss: 0.0033924
	speed: 0.0864s/iter; left time: 3572.9297s
Epoch: 12 cost time: 41.60647130012512
Epoch: 12, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2619326
	speed: 0.3607s/iter; left time: 14851.6450s
	iters: 200, epoch: 13 | loss: 0.0028717
	speed: 0.0879s/iter; left time: 3611.7160s
	iters: 300, epoch: 13 | loss: 0.0173951
	speed: 0.0861s/iter; left time: 3529.0009s
	iters: 400, epoch: 13 | loss: 0.0502550
	speed: 0.0867s/iter; left time: 3543.7733s
Epoch: 13 cost time: 41.19558501243591
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0058457
	speed: 0.3719s/iter; left time: 15139.0272s
	iters: 200, epoch: 14 | loss: 0.0027836
	speed: 0.0873s/iter; left time: 3545.3834s
	iters: 300, epoch: 14 | loss: 0.0098539
	speed: 0.0830s/iter; left time: 3361.0547s
	iters: 400, epoch: 14 | loss: 0.0316182
	speed: 0.0810s/iter; left time: 3274.6247s
Epoch: 14 cost time: 40.00815749168396
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4037204
	speed: 0.3795s/iter; left time: 15270.8340s
	iters: 200, epoch: 15 | loss: 0.2121129
	speed: 0.0907s/iter; left time: 3640.5484s
	iters: 300, epoch: 15 | loss: 0.0025464
	speed: 0.0833s/iter; left time: 3333.3120s
	iters: 400, epoch: 15 | loss: 0.0092180
	speed: 0.0858s/iter; left time: 3427.3158s
Epoch: 15 cost time: 41.86522102355957
Epoch: 15, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.306 Vali Acc: 0.934 Test Loss: 0.306 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0029360
	speed: 0.3668s/iter; left time: 14585.6736s
	iters: 200, epoch: 16 | loss: 0.0381316
	speed: 0.0885s/iter; left time: 3511.4900s
	iters: 300, epoch: 16 | loss: 0.0619815
	speed: 0.0906s/iter; left time: 3583.5541s
	iters: 400, epoch: 16 | loss: 0.0050817
	speed: 0.0857s/iter; left time: 3381.3615s
Epoch: 16 cost time: 40.81268286705017
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0247905
	speed: 0.3685s/iter; left time: 14482.5899s
	iters: 200, epoch: 17 | loss: 0.0142163
	speed: 0.0922s/iter; left time: 3612.4354s
	iters: 300, epoch: 17 | loss: 0.0011899
	speed: 0.0890s/iter; left time: 3480.3023s
	iters: 400, epoch: 17 | loss: 0.4700437
	speed: 0.0925s/iter; left time: 3605.6718s
Epoch: 17 cost time: 42.85830760002136
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0069874
	speed: 0.3749s/iter; left time: 14558.2312s
	iters: 200, epoch: 18 | loss: 0.0061872
	speed: 0.0877s/iter; left time: 3396.1771s
	iters: 300, epoch: 18 | loss: 0.0037225
	speed: 0.0836s/iter; left time: 3228.6683s
	iters: 400, epoch: 18 | loss: 0.0005104
	speed: 0.0813s/iter; left time: 3131.3878s
Epoch: 18 cost time: 40.21695113182068
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0034968
	speed: 0.3620s/iter; left time: 13884.9291s
	iters: 200, epoch: 19 | loss: 0.0009778
	speed: 0.0860s/iter; left time: 3290.1201s
	iters: 300, epoch: 19 | loss: 0.0062719
	speed: 0.0887s/iter; left time: 3385.2886s
	iters: 400, epoch: 19 | loss: 0.0123253
	speed: 0.0905s/iter; left time: 3444.6612s
Epoch: 19 cost time: 41.54031443595886
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0030417
	speed: 0.3927s/iter; left time: 14877.5533s
	iters: 200, epoch: 20 | loss: 0.0012872
	speed: 0.0978s/iter; left time: 3694.7667s
	iters: 300, epoch: 20 | loss: 0.0029679
	speed: 0.0894s/iter; left time: 3369.8744s
	iters: 400, epoch: 20 | loss: 0.0052973
	speed: 0.0877s/iter; left time: 3298.2158s
Epoch: 20 cost time: 43.394092321395874
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6171435
	speed: 0.3899s/iter; left time: 14590.4823s
	iters: 200, epoch: 21 | loss: 0.1068614
	speed: 0.0878s/iter; left time: 3277.8615s
	iters: 300, epoch: 21 | loss: 0.0051158
	speed: 0.0902s/iter; left time: 3358.0014s
	iters: 400, epoch: 21 | loss: 0.1336877
	speed: 0.0918s/iter; left time: 3406.8889s
Epoch: 21 cost time: 42.836735248565674
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 309158
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6224037
	speed: 0.1064s/iter; left time: 4979.6646s
	iters: 200, epoch: 1 | loss: 0.6667613
	speed: 0.0831s/iter; left time: 3881.2427s
	iters: 300, epoch: 1 | loss: 0.3970951
	speed: 0.0887s/iter; left time: 4131.3475s
	iters: 400, epoch: 1 | loss: 0.5147004
	speed: 0.0858s/iter; left time: 3991.0950s
Epoch: 1 cost time: 42.54015755653381
Epoch: 1, Steps: 469 | Train Loss: 0.954 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (inf --> -0.899653).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3179465
	speed: 0.3661s/iter; left time: 16960.5581s
	iters: 200, epoch: 2 | loss: 0.0815824
	speed: 0.0962s/iter; left time: 4445.5038s
	iters: 300, epoch: 2 | loss: 0.1503155
	speed: 0.0879s/iter; left time: 4052.7073s
	iters: 400, epoch: 2 | loss: 0.1998723
	speed: 0.0885s/iter; left time: 4073.6137s
Epoch: 2 cost time: 42.638538122177124
Epoch: 2, Steps: 469 | Train Loss: 0.225 Vali Loss: 0.247 Vali Acc: 0.910 Test Loss: 0.247 Test Acc: 0.910
Validation loss decreased (-0.899653 --> -0.910232).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1012088
	speed: 0.3943s/iter; left time: 18085.7632s
	iters: 200, epoch: 3 | loss: 0.0711126
	speed: 0.0814s/iter; left time: 3726.5704s
	iters: 300, epoch: 3 | loss: 0.0148245
	speed: 0.0872s/iter; left time: 3980.4266s
	iters: 400, epoch: 3 | loss: 0.0530852
	speed: 0.0853s/iter; left time: 3885.6141s
Epoch: 3 cost time: 41.047544956207275
Epoch: 3, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.260 Vali Acc: 0.923 Test Loss: 0.260 Test Acc: 0.923
Validation loss decreased (-0.910232 --> -0.922525).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0211012
	speed: 0.3738s/iter; left time: 16968.1740s
	iters: 200, epoch: 4 | loss: 0.0495804
	speed: 0.0905s/iter; left time: 4100.4287s
	iters: 300, epoch: 4 | loss: 0.0120314
	speed: 0.0910s/iter; left time: 4110.4432s
	iters: 400, epoch: 4 | loss: 0.0202949
	speed: 0.0892s/iter; left time: 4021.1705s
Epoch: 4 cost time: 42.65054678916931
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.922525 --> -0.929958).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0132286
	speed: 0.3949s/iter; left time: 17741.7531s
	iters: 200, epoch: 5 | loss: 0.1055511
	speed: 0.0873s/iter; left time: 3914.8013s
	iters: 300, epoch: 5 | loss: 0.1516986
	speed: 0.0899s/iter; left time: 4021.3411s
	iters: 400, epoch: 5 | loss: 0.0146283
	speed: 0.0895s/iter; left time: 3996.1036s
Epoch: 5 cost time: 42.18972730636597
Epoch: 5, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.929958 --> -0.955115).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2849469
	speed: 0.3558s/iter; left time: 15817.3143s
	iters: 200, epoch: 6 | loss: 0.0517910
	speed: 0.0896s/iter; left time: 3976.3372s
	iters: 300, epoch: 6 | loss: 0.2755907
	speed: 0.0922s/iter; left time: 4078.8234s
	iters: 400, epoch: 6 | loss: 0.0029355
	speed: 0.0918s/iter; left time: 4055.0439s
Epoch: 6 cost time: 41.7239875793457
Epoch: 6, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
Validation loss decreased (-0.955115 --> -0.959976).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1830758
	speed: 0.3896s/iter; left time: 17136.1393s
	iters: 200, epoch: 7 | loss: 0.1141897
	speed: 0.0929s/iter; left time: 4077.3643s
	iters: 300, epoch: 7 | loss: 0.0539814
	speed: 0.0927s/iter; left time: 4059.3517s
	iters: 400, epoch: 7 | loss: 0.1146703
	speed: 0.0919s/iter; left time: 4016.2324s
Epoch: 7 cost time: 43.60524249076843
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0069289
	speed: 0.4033s/iter; left time: 17551.8063s
	iters: 200, epoch: 8 | loss: 0.0310073
	speed: 0.0918s/iter; left time: 3986.2632s
	iters: 300, epoch: 8 | loss: 0.0643989
	speed: 0.0942s/iter; left time: 4080.9176s
	iters: 400, epoch: 8 | loss: 0.0050041
	speed: 0.0944s/iter; left time: 4078.5939s
Epoch: 8 cost time: 44.40371608734131
Epoch: 8, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0110962
	speed: 0.3995s/iter; left time: 17198.4577s
	iters: 200, epoch: 9 | loss: 0.0044388
	speed: 0.0958s/iter; left time: 4116.4193s
	iters: 300, epoch: 9 | loss: 0.0034040
	speed: 0.0958s/iter; left time: 4104.0065s
	iters: 400, epoch: 9 | loss: 0.0165424
	speed: 0.0891s/iter; left time: 3810.8184s
Epoch: 9 cost time: 44.30771517753601
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0065380
	speed: 0.3741s/iter; left time: 15931.0860s
	iters: 200, epoch: 10 | loss: 0.0033168
	speed: 0.0861s/iter; left time: 3659.1931s
	iters: 300, epoch: 10 | loss: 0.0091047
	speed: 0.0879s/iter; left time: 3724.1270s
	iters: 400, epoch: 10 | loss: 0.0052921
	speed: 0.0930s/iter; left time: 3930.6849s
Epoch: 10 cost time: 42.06511092185974
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0803868
	speed: 0.3915s/iter; left time: 16484.3656s
	iters: 200, epoch: 11 | loss: 0.0106884
	speed: 0.0875s/iter; left time: 3675.5162s
	iters: 300, epoch: 11 | loss: 0.0403056
	speed: 0.0923s/iter; left time: 3869.8549s
	iters: 400, epoch: 11 | loss: 0.0083871
	speed: 0.0907s/iter; left time: 3790.6728s
Epoch: 11 cost time: 42.57308077812195
Epoch: 11, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
Validation loss decreased (-0.959976 --> -0.963978).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0117488
	speed: 0.3883s/iter; left time: 16167.9449s
	iters: 200, epoch: 12 | loss: 0.0039950
	speed: 0.0911s/iter; left time: 3785.3671s
	iters: 300, epoch: 12 | loss: 0.0016636
	speed: 0.0893s/iter; left time: 3699.0904s
	iters: 400, epoch: 12 | loss: 0.0215882
	speed: 0.0937s/iter; left time: 3872.8748s
Epoch: 12 cost time: 44.00678372383118
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.963978 --> -0.965121).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0857681
	speed: 0.3840s/iter; left time: 15811.1473s
	iters: 200, epoch: 13 | loss: 0.0029693
	speed: 0.0860s/iter; left time: 3532.6886s
	iters: 300, epoch: 13 | loss: 0.0026505
	speed: 0.0914s/iter; left time: 3746.6057s
	iters: 400, epoch: 13 | loss: 0.0154705
	speed: 0.0906s/iter; left time: 3702.1777s
Epoch: 13 cost time: 42.49938678741455
Epoch: 13, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.965121 --> -0.969410).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0019297
	speed: 0.3829s/iter; left time: 15586.9380s
	iters: 200, epoch: 14 | loss: 0.0043330
	speed: 0.0873s/iter; left time: 3546.6258s
	iters: 300, epoch: 14 | loss: 0.0569899
	speed: 0.0843s/iter; left time: 3415.0117s
	iters: 400, epoch: 14 | loss: 0.0033507
	speed: 0.0889s/iter; left time: 3590.5599s
Epoch: 14 cost time: 41.72188639640808
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0010545
	speed: 0.3966s/iter; left time: 15956.7154s
	iters: 200, epoch: 15 | loss: 0.0026921
	speed: 0.0983s/iter; left time: 3944.6062s
	iters: 300, epoch: 15 | loss: 0.0020105
	speed: 0.1037s/iter; left time: 4150.3227s
	iters: 400, epoch: 15 | loss: 0.0116102
	speed: 0.0978s/iter; left time: 3906.7256s
Epoch: 15 cost time: 46.740169286727905
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0038989
	speed: 0.4078s/iter; left time: 16218.0920s
	iters: 200, epoch: 16 | loss: 0.0008779
	speed: 0.0940s/iter; left time: 3729.1315s
	iters: 300, epoch: 16 | loss: 0.1953179
	speed: 0.0898s/iter; left time: 3554.0742s
	iters: 400, epoch: 16 | loss: 0.0048214
	speed: 0.0966s/iter; left time: 3813.0745s
Epoch: 16 cost time: 44.22013592720032
Epoch: 16, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0222758
	speed: 0.4032s/iter; left time: 15843.1004s
	iters: 200, epoch: 17 | loss: 0.0070195
	speed: 0.0953s/iter; left time: 3734.4179s
	iters: 300, epoch: 17 | loss: 0.2686006
	speed: 0.0887s/iter; left time: 3466.2163s
	iters: 400, epoch: 17 | loss: 0.0147077
	speed: 0.0893s/iter; left time: 3481.9805s
Epoch: 17 cost time: 43.236042737960815
Epoch: 17, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0269664
	speed: 0.3642s/iter; left time: 14142.3914s
	iters: 200, epoch: 18 | loss: 0.0013063
	speed: 0.0861s/iter; left time: 3335.7194s
	iters: 300, epoch: 18 | loss: 0.0016702
	speed: 0.0869s/iter; left time: 3356.9049s
	iters: 400, epoch: 18 | loss: 0.1323975
	speed: 0.0843s/iter; left time: 3247.6977s
Epoch: 18 cost time: 40.93445014953613
Epoch: 18, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0133604
	speed: 0.3812s/iter; left time: 14622.6714s
	iters: 200, epoch: 19 | loss: 0.0177749
	speed: 0.0955s/iter; left time: 3652.1235s
	iters: 300, epoch: 19 | loss: 0.0074267
	speed: 0.0924s/iter; left time: 3527.3341s
	iters: 400, epoch: 19 | loss: 0.0040440
	speed: 0.0979s/iter; left time: 3727.5011s
Epoch: 19 cost time: 44.29521417617798
Epoch: 19, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0010485
	speed: 0.3742s/iter; left time: 14177.9477s
	iters: 200, epoch: 20 | loss: 0.0494039
	speed: 0.0881s/iter; left time: 3328.6277s
	iters: 300, epoch: 20 | loss: 0.0017447
	speed: 0.0854s/iter; left time: 3220.3403s
	iters: 400, epoch: 20 | loss: 0.0238250
	speed: 0.0852s/iter; left time: 3202.5883s
Epoch: 20 cost time: 41.50955152511597
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0007605
	speed: 0.3817s/iter; left time: 14282.8380s
	iters: 200, epoch: 21 | loss: 0.0002471
	speed: 0.0943s/iter; left time: 3518.4997s
	iters: 300, epoch: 21 | loss: 0.0012854
	speed: 0.0892s/iter; left time: 3321.2607s
	iters: 400, epoch: 21 | loss: 0.0002807
	speed: 0.0868s/iter; left time: 3221.0457s
Epoch: 21 cost time: 42.87777614593506
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0050340
	speed: 0.3896s/iter; left time: 14396.3968s
	iters: 200, epoch: 22 | loss: 0.0049108
	speed: 0.0867s/iter; left time: 3195.4789s
	iters: 300, epoch: 22 | loss: 0.0019484
	speed: 0.0875s/iter; left time: 3215.1872s
	iters: 400, epoch: 22 | loss: 0.0029379
	speed: 0.0919s/iter; left time: 3368.5883s
Epoch: 22 cost time: 42.79985952377319
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0051934
	speed: 0.3807s/iter; left time: 13889.8557s
	iters: 200, epoch: 23 | loss: 0.0018545
	speed: 0.0975s/iter; left time: 3547.6665s
	iters: 300, epoch: 23 | loss: 0.2408057
	speed: 0.0915s/iter; left time: 3319.9682s
	iters: 400, epoch: 23 | loss: 0.0620877
	speed: 0.0933s/iter; left time: 3376.7509s
Epoch: 23 cost time: 44.94810104370117
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9694110920526015
model parameter : 309030
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3655559
	speed: 0.1100s/iter; left time: 5147.9637s
	iters: 200, epoch: 1 | loss: 0.6386766
	speed: 0.0908s/iter; left time: 4241.1953s
	iters: 300, epoch: 1 | loss: 0.5340532
	speed: 0.0857s/iter; left time: 3994.3703s
	iters: 400, epoch: 1 | loss: 0.5051797
	speed: 0.0949s/iter; left time: 4410.8207s
Epoch: 1 cost time: 44.60016345977783
Epoch: 1, Steps: 469 | Train Loss: 0.903 Vali Loss: 0.398 Vali Acc: 0.872 Test Loss: 0.398 Test Acc: 0.872
Validation loss decreased (inf --> -0.872209).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2709593
	speed: 0.3860s/iter; left time: 17881.9313s
	iters: 200, epoch: 2 | loss: 0.3209382
	speed: 0.0895s/iter; left time: 4139.2344s
	iters: 300, epoch: 2 | loss: 0.2685327
	speed: 0.0855s/iter; left time: 3944.5091s
	iters: 400, epoch: 2 | loss: 0.0468731
	speed: 0.0927s/iter; left time: 4269.1433s
Epoch: 2 cost time: 42.929205656051636
Epoch: 2, Steps: 469 | Train Loss: 0.230 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
Validation loss decreased (-0.872209 --> -0.934532).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1044757
	speed: 0.3679s/iter; left time: 16874.7613s
	iters: 200, epoch: 3 | loss: 0.2593996
	speed: 0.0828s/iter; left time: 3788.1318s
	iters: 300, epoch: 3 | loss: 0.0319072
	speed: 0.0856s/iter; left time: 3910.0823s
	iters: 400, epoch: 3 | loss: 0.3533738
	speed: 0.0892s/iter; left time: 4062.9766s
Epoch: 3 cost time: 39.95992159843445
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
Validation loss decreased (-0.934532 --> -0.941965).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0600800
	speed: 0.3484s/iter; left time: 15815.1828s
	iters: 200, epoch: 4 | loss: 0.0193956
	speed: 0.0818s/iter; left time: 3702.8542s
	iters: 300, epoch: 4 | loss: 0.1322648
	speed: 0.0812s/iter; left time: 3668.6342s
	iters: 400, epoch: 4 | loss: 0.1129645
	speed: 0.0847s/iter; left time: 3819.5305s
Epoch: 4 cost time: 39.82190442085266
Epoch: 4, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.281 Vali Acc: 0.929 Test Loss: 0.281 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2206481
	speed: 0.3584s/iter; left time: 16103.1980s
	iters: 200, epoch: 5 | loss: 0.1385091
	speed: 0.0875s/iter; left time: 3924.4073s
	iters: 300, epoch: 5 | loss: 0.0531012
	speed: 0.0906s/iter; left time: 4051.3151s
	iters: 400, epoch: 5 | loss: 0.2568447
	speed: 0.0852s/iter; left time: 3803.6158s
Epoch: 5 cost time: 40.597647190093994
Epoch: 5, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
Validation loss decreased (-0.941965 --> -0.946253).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2026198
	speed: 0.3610s/iter; left time: 16047.5974s
	iters: 200, epoch: 6 | loss: 0.0263177
	speed: 0.0864s/iter; left time: 3830.9699s
	iters: 300, epoch: 6 | loss: 0.0564182
	speed: 0.0841s/iter; left time: 3721.4525s
	iters: 400, epoch: 6 | loss: 0.0091758
	speed: 0.0863s/iter; left time: 3810.9199s
Epoch: 6 cost time: 41.27705979347229
Epoch: 6, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.946253 --> -0.961977).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3686107
	speed: 0.3589s/iter; left time: 15784.9562s
	iters: 200, epoch: 7 | loss: 0.0439934
	speed: 0.0876s/iter; left time: 3845.8848s
	iters: 300, epoch: 7 | loss: 0.4925527
	speed: 0.0865s/iter; left time: 3786.9386s
	iters: 400, epoch: 7 | loss: 0.3177145
	speed: 0.0824s/iter; left time: 3601.7034s
Epoch: 7 cost time: 40.69228911399841
Epoch: 7, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0071447
	speed: 0.3524s/iter; left time: 15336.8116s
	iters: 200, epoch: 8 | loss: 0.0107804
	speed: 0.0826s/iter; left time: 3584.5823s
	iters: 300, epoch: 8 | loss: 0.2768493
	speed: 0.0855s/iter; left time: 3701.8228s
	iters: 400, epoch: 8 | loss: 0.1501932
	speed: 0.0859s/iter; left time: 3714.3021s
Epoch: 8 cost time: 39.69353103637695
Epoch: 8, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0205385
	speed: 0.3807s/iter; left time: 16387.3504s
	iters: 200, epoch: 9 | loss: 0.0713736
	speed: 0.0931s/iter; left time: 3999.3474s
	iters: 300, epoch: 9 | loss: 0.0122044
	speed: 0.0919s/iter; left time: 3936.5505s
	iters: 400, epoch: 9 | loss: 0.0467504
	speed: 0.0935s/iter; left time: 3995.8836s
Epoch: 9 cost time: 43.22787690162659
Epoch: 9, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4903035
	speed: 0.3912s/iter; left time: 16656.0810s
	iters: 200, epoch: 10 | loss: 0.0034617
	speed: 0.0942s/iter; left time: 4002.6397s
	iters: 300, epoch: 10 | loss: 0.0206483
	speed: 0.0946s/iter; left time: 4009.7396s
	iters: 400, epoch: 10 | loss: 0.0041509
	speed: 0.0910s/iter; left time: 3848.8319s
Epoch: 10 cost time: 42.867438554763794
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0292582
	speed: 0.3551s/iter; left time: 14955.7042s
	iters: 200, epoch: 11 | loss: 0.0047112
	speed: 0.0819s/iter; left time: 3442.0087s
	iters: 300, epoch: 11 | loss: 0.0059469
	speed: 0.0846s/iter; left time: 3545.8233s
	iters: 400, epoch: 11 | loss: 0.3865825
	speed: 0.0826s/iter; left time: 3455.0991s
Epoch: 11 cost time: 40.01218390464783
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.239 Vali Acc: 0.949 Test Loss: 0.239 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0271682
	speed: 0.3320s/iter; left time: 13825.2452s
	iters: 200, epoch: 12 | loss: 0.2671683
	speed: 0.0776s/iter; left time: 3224.7038s
	iters: 300, epoch: 12 | loss: 0.0148843
	speed: 0.0766s/iter; left time: 3174.8077s
	iters: 400, epoch: 12 | loss: 0.0038418
	speed: 0.0804s/iter; left time: 3324.5898s
Epoch: 12 cost time: 37.66589117050171
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0230799
	speed: 0.3726s/iter; left time: 15341.9066s
	iters: 200, epoch: 13 | loss: 0.0015268
	speed: 0.0887s/iter; left time: 3642.6022s
	iters: 300, epoch: 13 | loss: 0.0323951
	speed: 0.0857s/iter; left time: 3512.0663s
	iters: 400, epoch: 13 | loss: 0.0052733
	speed: 0.0829s/iter; left time: 3388.4351s
Epoch: 13 cost time: 40.63096475601196
Epoch: 13, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0022721
	speed: 0.3621s/iter; left time: 14737.7954s
	iters: 200, epoch: 14 | loss: 0.0018753
	speed: 0.0813s/iter; left time: 3301.1102s
	iters: 300, epoch: 14 | loss: 0.0024038
	speed: 0.0792s/iter; left time: 3209.6462s
	iters: 400, epoch: 14 | loss: 0.0180642
	speed: 0.0801s/iter; left time: 3236.3184s
Epoch: 14 cost time: 38.616238832473755
Epoch: 14, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.961977 --> -0.971411).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0515163
	speed: 0.3209s/iter; left time: 12910.2432s
	iters: 200, epoch: 15 | loss: 0.0056823
	speed: 0.0819s/iter; left time: 3286.4747s
	iters: 300, epoch: 15 | loss: 0.0067764
	speed: 0.0810s/iter; left time: 3244.0035s
	iters: 400, epoch: 15 | loss: 0.0116127
	speed: 0.0822s/iter; left time: 3283.6764s
Epoch: 15 cost time: 38.71109676361084
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0070191
	speed: 0.3617s/iter; left time: 14383.5014s
	iters: 200, epoch: 16 | loss: 0.0153918
	speed: 0.0875s/iter; left time: 3470.4205s
	iters: 300, epoch: 16 | loss: 0.0105693
	speed: 0.0856s/iter; left time: 3385.0317s
	iters: 400, epoch: 16 | loss: 0.0081038
	speed: 0.0861s/iter; left time: 3398.5280s
Epoch: 16 cost time: 41.09064221382141
Epoch: 16, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0026404
	speed: 0.3675s/iter; left time: 14440.6838s
	iters: 200, epoch: 17 | loss: 0.0901074
	speed: 0.0910s/iter; left time: 3568.6277s
	iters: 300, epoch: 17 | loss: 0.0321417
	speed: 0.0859s/iter; left time: 3356.6312s
	iters: 400, epoch: 17 | loss: 0.1627858
	speed: 0.0906s/iter; left time: 3532.4865s
Epoch: 17 cost time: 41.91853880882263
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972840).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0062053
	speed: 0.3886s/iter; left time: 15086.7006s
	iters: 200, epoch: 18 | loss: 0.0091178
	speed: 0.0859s/iter; left time: 3328.4275s
	iters: 300, epoch: 18 | loss: 0.0050424
	speed: 0.0881s/iter; left time: 3401.4144s
	iters: 400, epoch: 18 | loss: 0.1482183
	speed: 0.0860s/iter; left time: 3314.2278s
Epoch: 18 cost time: 40.51448655128479
Epoch: 18, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0485620
	speed: 0.3516s/iter; left time: 13485.1251s
	iters: 200, epoch: 19 | loss: 0.0013770
	speed: 0.0855s/iter; left time: 3271.8902s
	iters: 300, epoch: 19 | loss: 0.0082742
	speed: 0.0818s/iter; left time: 3122.8711s
	iters: 400, epoch: 19 | loss: 0.0052674
	speed: 0.0790s/iter; left time: 3007.3288s
Epoch: 19 cost time: 39.47206234931946
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0051462
	speed: 0.3487s/iter; left time: 13210.9942s
	iters: 200, epoch: 20 | loss: 0.0022307
	speed: 0.0801s/iter; left time: 3028.3456s
	iters: 300, epoch: 20 | loss: 0.0077871
	speed: 0.0888s/iter; left time: 3347.5068s
	iters: 400, epoch: 20 | loss: 0.0066998
	speed: 0.0817s/iter; left time: 3071.1695s
Epoch: 20 cost time: 39.42917513847351
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0279875
	speed: 0.3385s/iter; left time: 12668.2749s
	iters: 200, epoch: 21 | loss: 0.0016790
	speed: 0.0832s/iter; left time: 3106.5221s
	iters: 300, epoch: 21 | loss: 0.1271050
	speed: 0.0779s/iter; left time: 2897.9163s
	iters: 400, epoch: 21 | loss: 0.0038754
	speed: 0.0824s/iter; left time: 3057.1708s
Epoch: 21 cost time: 38.812323331832886
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0046230
	speed: 0.3643s/iter; left time: 13460.2908s
	iters: 200, epoch: 22 | loss: 0.0033231
	speed: 0.0832s/iter; left time: 3064.5990s
	iters: 300, epoch: 22 | loss: 0.4500394
	speed: 0.0886s/iter; left time: 3254.3967s
	iters: 400, epoch: 22 | loss: 0.0011535
	speed: 0.0874s/iter; left time: 3203.7111s
Epoch: 22 cost time: 40.51089072227478
Epoch: 22, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0031354
	speed: 0.3540s/iter; left time: 12913.9133s
	iters: 200, epoch: 23 | loss: 0.0164604
	speed: 0.0811s/iter; left time: 2949.2375s
	iters: 300, epoch: 23 | loss: 0.0062107
	speed: 0.0857s/iter; left time: 3108.1838s
	iters: 400, epoch: 23 | loss: 0.0116458
	speed: 0.0818s/iter; left time: 2959.5812s
Epoch: 23 cost time: 39.215399742126465
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0088107
	speed: 0.3449s/iter; left time: 12421.4107s
	iters: 200, epoch: 24 | loss: 0.0046341
	speed: 0.0828s/iter; left time: 2974.8392s
	iters: 300, epoch: 24 | loss: 0.0918146
	speed: 0.0866s/iter; left time: 3100.8819s
	iters: 400, epoch: 24 | loss: 0.0098534
	speed: 0.0870s/iter; left time: 3105.6976s
Epoch: 24 cost time: 40.58739495277405
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1707920
	speed: 0.3789s/iter; left time: 13466.8397s
	iters: 200, epoch: 25 | loss: 0.0010141
	speed: 0.0848s/iter; left time: 3006.2371s
	iters: 300, epoch: 25 | loss: 0.0006075
	speed: 0.0893s/iter; left time: 3156.0958s
	iters: 400, epoch: 25 | loss: 0.0078694
	speed: 0.0893s/iter; left time: 3148.7823s
Epoch: 25 cost time: 41.28245735168457
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0013447
	speed: 0.3810s/iter; left time: 13363.5684s
	iters: 200, epoch: 26 | loss: 0.0050486
	speed: 0.0906s/iter; left time: 3167.0928s
	iters: 300, epoch: 26 | loss: 0.0010154
	speed: 0.0863s/iter; left time: 3009.3689s
	iters: 400, epoch: 26 | loss: 0.0018075
	speed: 0.0880s/iter; left time: 3058.7978s
Epoch: 26 cost time: 42.3965585231781
Epoch: 26, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0237854
	speed: 0.3833s/iter; left time: 13265.1061s
	iters: 200, epoch: 27 | loss: 0.0009942
	speed: 0.0818s/iter; left time: 2821.7628s
	iters: 300, epoch: 27 | loss: 0.0010951
	speed: 0.0841s/iter; left time: 2893.8102s
	iters: 400, epoch: 27 | loss: 0.6324621
	speed: 0.0871s/iter; left time: 2987.8253s
Epoch: 27 cost time: 40.148722887039185
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 308902
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5164540
	speed: 0.1045s/iter; left time: 4890.4422s
	iters: 200, epoch: 1 | loss: 0.6935024
	speed: 0.0938s/iter; left time: 4379.4586s
	iters: 300, epoch: 1 | loss: 0.4008080
	speed: 0.0825s/iter; left time: 3843.2282s
	iters: 400, epoch: 1 | loss: 0.7252070
	speed: 0.0881s/iter; left time: 4096.1116s
Epoch: 1 cost time: 43.86017203330994
Epoch: 1, Steps: 469 | Train Loss: 0.933 Vali Loss: 0.429 Vali Acc: 0.866 Test Loss: 0.429 Test Acc: 0.866
Validation loss decreased (inf --> -0.866205).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2360639
	speed: 0.3628s/iter; left time: 16810.9091s
	iters: 200, epoch: 2 | loss: 0.0893472
	speed: 0.0811s/iter; left time: 3748.9022s
	iters: 300, epoch: 2 | loss: 0.0791740
	speed: 0.0865s/iter; left time: 3992.3855s
	iters: 400, epoch: 2 | loss: 0.3321972
	speed: 0.0909s/iter; left time: 4186.3746s
Epoch: 2 cost time: 39.72354006767273
Epoch: 2, Steps: 469 | Train Loss: 0.231 Vali Loss: 0.241 Vali Acc: 0.934 Test Loss: 0.241 Test Acc: 0.934
Validation loss decreased (-0.866205 --> -0.934246).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0246557
	speed: 0.3519s/iter; left time: 16138.4793s
	iters: 200, epoch: 3 | loss: 0.2550525
	speed: 0.0848s/iter; left time: 3881.6716s
	iters: 300, epoch: 3 | loss: 0.1781053
	speed: 0.0806s/iter; left time: 3682.5355s
	iters: 400, epoch: 3 | loss: 0.0256818
	speed: 0.0814s/iter; left time: 3708.1086s
Epoch: 3 cost time: 39.42428755760193
Epoch: 3, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.934246 --> -0.951685).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0208839
	speed: 0.3514s/iter; left time: 15949.7150s
	iters: 200, epoch: 4 | loss: 0.6309645
	speed: 0.0857s/iter; left time: 3879.6346s
	iters: 300, epoch: 4 | loss: 0.0805578
	speed: 0.0913s/iter; left time: 4126.2213s
	iters: 400, epoch: 4 | loss: 0.0125227
	speed: 0.0842s/iter; left time: 3797.5741s
Epoch: 4 cost time: 40.306069135665894
Epoch: 4, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0041521
	speed: 0.3566s/iter; left time: 16022.0638s
	iters: 200, epoch: 5 | loss: 0.1761496
	speed: 0.0802s/iter; left time: 3593.3788s
	iters: 300, epoch: 5 | loss: 0.5794462
	speed: 0.0906s/iter; left time: 4053.0066s
	iters: 400, epoch: 5 | loss: 0.0113770
	speed: 0.0826s/iter; left time: 3685.9500s
Epoch: 5 cost time: 40.47818446159363
Epoch: 5, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6839176
	speed: 0.3821s/iter; left time: 16985.7435s
	iters: 200, epoch: 6 | loss: 0.0072023
	speed: 0.0896s/iter; left time: 3975.4889s
	iters: 300, epoch: 6 | loss: 0.0288857
	speed: 0.0897s/iter; left time: 3968.6601s
	iters: 400, epoch: 6 | loss: 0.0087615
	speed: 0.0902s/iter; left time: 3983.4960s
Epoch: 6 cost time: 42.75571656227112
Epoch: 6, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
Validation loss decreased (-0.951685 --> -0.952543).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0133894
	speed: 0.3924s/iter; left time: 17259.8137s
	iters: 200, epoch: 7 | loss: 0.0041081
	speed: 0.0909s/iter; left time: 3990.1993s
	iters: 300, epoch: 7 | loss: 0.0222474
	speed: 0.0919s/iter; left time: 4023.8673s
	iters: 400, epoch: 7 | loss: 0.0756996
	speed: 0.0903s/iter; left time: 3944.3945s
Epoch: 7 cost time: 43.189701795578
Epoch: 7, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0053936
	speed: 0.3771s/iter; left time: 16411.1594s
	iters: 200, epoch: 8 | loss: 0.0705270
	speed: 0.0814s/iter; left time: 3532.1737s
	iters: 300, epoch: 8 | loss: 0.5366721
	speed: 0.0820s/iter; left time: 3553.4117s
	iters: 400, epoch: 8 | loss: 0.1708945
	speed: 0.0833s/iter; left time: 3602.1884s
Epoch: 8 cost time: 39.67471957206726
Epoch: 8, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0019482
	speed: 0.3669s/iter; left time: 15793.7144s
	iters: 200, epoch: 9 | loss: 0.0382239
	speed: 0.0874s/iter; left time: 3754.1036s
	iters: 300, epoch: 9 | loss: 0.0063871
	speed: 0.0826s/iter; left time: 3540.7356s
	iters: 400, epoch: 9 | loss: 0.1130994
	speed: 0.0812s/iter; left time: 3470.4522s
Epoch: 9 cost time: 40.24718642234802
Epoch: 9, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1460456
	speed: 0.3582s/iter; left time: 15251.4629s
	iters: 200, epoch: 10 | loss: 0.0354328
	speed: 0.0800s/iter; left time: 3397.9289s
	iters: 300, epoch: 10 | loss: 0.0034564
	speed: 0.0830s/iter; left time: 3519.5265s
	iters: 400, epoch: 10 | loss: 0.1913700
	speed: 0.0808s/iter; left time: 3417.6575s
Epoch: 10 cost time: 38.48360991477966
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.952543 --> -0.960547).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0278993
	speed: 0.3740s/iter; left time: 15750.1237s
	iters: 200, epoch: 11 | loss: 0.1004546
	speed: 0.0856s/iter; left time: 3595.9285s
	iters: 300, epoch: 11 | loss: 0.0038790
	speed: 0.0855s/iter; left time: 3583.6353s
	iters: 400, epoch: 11 | loss: 0.0442677
	speed: 0.0859s/iter; left time: 3591.9462s
Epoch: 11 cost time: 41.054229974746704
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.960547 --> -0.963692).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0033246
	speed: 0.3563s/iter; left time: 14837.8082s
	iters: 200, epoch: 12 | loss: 0.0320954
	speed: 0.0858s/iter; left time: 3565.4932s
	iters: 300, epoch: 12 | loss: 0.0021527
	speed: 0.0866s/iter; left time: 3589.2210s
	iters: 400, epoch: 12 | loss: 0.0025749
	speed: 0.0844s/iter; left time: 3490.7051s
Epoch: 12 cost time: 40.50479006767273
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.963692 --> -0.964264).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1055121
	speed: 0.3733s/iter; left time: 15371.1508s
	iters: 200, epoch: 13 | loss: 0.0043191
	speed: 0.0872s/iter; left time: 3580.4264s
	iters: 300, epoch: 13 | loss: 0.1793606
	speed: 0.0877s/iter; left time: 3593.1403s
	iters: 400, epoch: 13 | loss: 0.4494685
	speed: 0.0899s/iter; left time: 3673.0136s
Epoch: 13 cost time: 41.8242449760437
Epoch: 13, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1498932
	speed: 0.3739s/iter; left time: 15219.4496s
	iters: 200, epoch: 14 | loss: 0.1273080
	speed: 0.0873s/iter; left time: 3545.6668s
	iters: 300, epoch: 14 | loss: 0.0319245
	speed: 0.0852s/iter; left time: 3452.8007s
	iters: 400, epoch: 14 | loss: 0.0072811
	speed: 0.0844s/iter; left time: 3409.1642s
Epoch: 14 cost time: 40.7982439994812
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.236 Vali Acc: 0.947 Test Loss: 0.236 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0134836
	speed: 0.3936s/iter; left time: 15836.4047s
	iters: 200, epoch: 15 | loss: 0.0011254
	speed: 0.0874s/iter; left time: 3508.7325s
	iters: 300, epoch: 15 | loss: 0.0023655
	speed: 0.0964s/iter; left time: 3858.3077s
	iters: 400, epoch: 15 | loss: 0.1360885
	speed: 0.0959s/iter; left time: 3831.4014s
Epoch: 15 cost time: 43.75829339027405
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3495135
	speed: 0.3998s/iter; left time: 15897.6971s
	iters: 200, epoch: 16 | loss: 0.4153131
	speed: 0.0971s/iter; left time: 3851.7617s
	iters: 300, epoch: 16 | loss: 0.0052164
	speed: 0.0891s/iter; left time: 3525.7329s
	iters: 400, epoch: 16 | loss: 0.0011997
	speed: 0.0830s/iter; left time: 3276.6867s
Epoch: 16 cost time: 43.136149168014526
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0020979
	speed: 0.3538s/iter; left time: 13902.4864s
	iters: 200, epoch: 17 | loss: 0.1731090
	speed: 0.0860s/iter; left time: 3369.1703s
	iters: 300, epoch: 17 | loss: 0.0032387
	speed: 0.0873s/iter; left time: 3414.2711s
	iters: 400, epoch: 17 | loss: 0.0187958
	speed: 0.0845s/iter; left time: 3296.6559s
Epoch: 17 cost time: 39.850380420684814
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.197 Vali Acc: 0.965 Test Loss: 0.197 Test Acc: 0.965
Validation loss decreased (-0.964264 --> -0.964549).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0015848
	speed: 0.3651s/iter; left time: 14177.8814s
	iters: 200, epoch: 18 | loss: 0.0121177
	speed: 0.0844s/iter; left time: 3270.4555s
	iters: 300, epoch: 18 | loss: 0.0053145
	speed: 0.0810s/iter; left time: 3130.3119s
	iters: 400, epoch: 18 | loss: 0.2367781
	speed: 0.0824s/iter; left time: 3175.9191s
Epoch: 18 cost time: 39.30258917808533
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1507360
	speed: 0.3550s/iter; left time: 13615.9563s
	iters: 200, epoch: 19 | loss: 0.0022090
	speed: 0.0883s/iter; left time: 3378.5902s
	iters: 300, epoch: 19 | loss: 0.0041215
	speed: 0.0888s/iter; left time: 3387.8856s
	iters: 400, epoch: 19 | loss: 0.3193985
	speed: 0.0895s/iter; left time: 3407.1980s
Epoch: 19 cost time: 41.165390491485596
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0008918
	speed: 0.3554s/iter; left time: 13465.1333s
	iters: 200, epoch: 20 | loss: 0.0006688
	speed: 0.0939s/iter; left time: 3549.1547s
	iters: 300, epoch: 20 | loss: 0.0052168
	speed: 0.0865s/iter; left time: 3260.3452s
	iters: 400, epoch: 20 | loss: 0.0053665
	speed: 0.0842s/iter; left time: 3163.8110s
Epoch: 20 cost time: 41.11991858482361
Epoch: 20, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0006171
	speed: 0.3656s/iter; left time: 13681.1808s
	iters: 200, epoch: 21 | loss: 0.0031215
	speed: 0.0892s/iter; left time: 3328.4371s
	iters: 300, epoch: 21 | loss: 0.0048309
	speed: 0.0876s/iter; left time: 3259.1887s
	iters: 400, epoch: 21 | loss: 0.0026032
	speed: 0.0858s/iter; left time: 3183.6534s
Epoch: 21 cost time: 41.74726366996765
Epoch: 21, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.246 Vali Acc: 0.951 Test Loss: 0.246 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0013106
	speed: 0.3901s/iter; left time: 14413.8085s
	iters: 200, epoch: 22 | loss: 0.3481688
	speed: 0.0919s/iter; left time: 3386.9199s
	iters: 300, epoch: 22 | loss: 0.0041127
	speed: 0.0867s/iter; left time: 3185.6641s
	iters: 400, epoch: 22 | loss: 0.0130644
	speed: 0.0827s/iter; left time: 3030.7487s
Epoch: 22 cost time: 41.198540449142456
Epoch: 22, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
Validation loss decreased (-0.964549 --> -0.970553).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0035221
	speed: 0.3543s/iter; left time: 12926.3132s
	iters: 200, epoch: 23 | loss: 0.0021405
	speed: 0.0861s/iter; left time: 3132.6215s
	iters: 300, epoch: 23 | loss: 0.0193860
	speed: 0.0890s/iter; left time: 3228.1958s
	iters: 400, epoch: 23 | loss: 0.0009669
	speed: 0.0874s/iter; left time: 3161.8012s
Epoch: 23 cost time: 41.45870661735535
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0057587
	speed: 0.3776s/iter; left time: 13597.9820s
	iters: 200, epoch: 24 | loss: 0.0104769
	speed: 0.0902s/iter; left time: 3241.1195s
	iters: 300, epoch: 24 | loss: 0.0074096
	speed: 0.0917s/iter; left time: 3284.8667s
	iters: 400, epoch: 24 | loss: 0.0020992
	speed: 0.0933s/iter; left time: 3331.3795s
Epoch: 24 cost time: 43.714942932128906
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.970553 --> -0.971411).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0220695
	speed: 0.4044s/iter; left time: 14373.0214s
	iters: 200, epoch: 25 | loss: 0.0060529
	speed: 0.0959s/iter; left time: 3398.7768s
	iters: 300, epoch: 25 | loss: 0.0055964
	speed: 0.0941s/iter; left time: 3324.3548s
	iters: 400, epoch: 25 | loss: 0.0116047
	speed: 0.0927s/iter; left time: 3268.5404s
Epoch: 25 cost time: 43.788846015930176
Epoch: 25, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.954 Test Loss: 0.247 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0022638
	speed: 0.4020s/iter; left time: 14099.5692s
	iters: 200, epoch: 26 | loss: 0.0007140
	speed: 0.0948s/iter; left time: 3315.3666s
	iters: 300, epoch: 26 | loss: 0.0839882
	speed: 0.0941s/iter; left time: 3281.7751s
	iters: 400, epoch: 26 | loss: 0.0092010
	speed: 0.0975s/iter; left time: 3389.4895s
Epoch: 26 cost time: 44.32064867019653
Epoch: 26, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0034445
	speed: 0.3680s/iter; left time: 12736.6093s
	iters: 200, epoch: 27 | loss: 0.0011183
	speed: 0.0866s/iter; left time: 2987.6436s
	iters: 300, epoch: 27 | loss: 0.0774626
	speed: 0.0909s/iter; left time: 3127.3101s
	iters: 400, epoch: 27 | loss: 0.0012352
	speed: 0.0934s/iter; left time: 3205.2017s
Epoch: 27 cost time: 42.17038345336914
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0010430
	speed: 0.3749s/iter; left time: 12798.4995s
	iters: 200, epoch: 28 | loss: 0.0021085
	speed: 0.0892s/iter; left time: 3034.6448s
	iters: 300, epoch: 28 | loss: 0.0084748
	speed: 0.0857s/iter; left time: 2907.0641s
	iters: 400, epoch: 28 | loss: 0.0016561
	speed: 0.0870s/iter; left time: 2944.9991s
Epoch: 28 cost time: 41.82707762718201
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0019247
	speed: 0.3753s/iter; left time: 12634.7360s
	iters: 200, epoch: 29 | loss: 0.0071691
	speed: 0.0959s/iter; left time: 3220.6189s
	iters: 300, epoch: 29 | loss: 0.0154866
	speed: 0.0894s/iter; left time: 2992.1610s
	iters: 400, epoch: 29 | loss: 0.0043759
	speed: 0.0859s/iter; left time: 2867.6912s
Epoch: 29 cost time: 41.6513237953186
Epoch: 29, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0010045
	speed: 0.3678s/iter; left time: 12210.9819s
	iters: 200, epoch: 30 | loss: 0.0028908
	speed: 0.0880s/iter; left time: 2911.4200s
	iters: 300, epoch: 30 | loss: 0.0011353
	speed: 0.0866s/iter; left time: 2856.5082s
	iters: 400, epoch: 30 | loss: 0.2644380
	speed: 0.0908s/iter; left time: 2988.9172s
Epoch: 30 cost time: 41.792794704437256
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.3053266
	speed: 0.3703s/iter; left time: 12120.5192s
	iters: 200, epoch: 31 | loss: 0.0007169
	speed: 0.0923s/iter; left time: 3010.7114s
	iters: 300, epoch: 31 | loss: 0.0006863
	speed: 0.0891s/iter; left time: 2899.8030s
	iters: 400, epoch: 31 | loss: 0.0314901
	speed: 0.0886s/iter; left time: 2874.4959s
Epoch: 31 cost time: 42.06317925453186
Epoch: 31, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0005471
	speed: 0.3725s/iter; left time: 12018.6826s
	iters: 200, epoch: 32 | loss: 0.0184274
	speed: 0.0819s/iter; left time: 2635.1206s
	iters: 300, epoch: 32 | loss: 0.0058980
	speed: 0.0871s/iter; left time: 2791.2008s
	iters: 400, epoch: 32 | loss: 0.0006289
	speed: 0.0892s/iter; left time: 2852.4550s
Epoch: 32 cost time: 40.83688712120056
Epoch: 32, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0036631
	speed: 0.3872s/iter; left time: 12308.9914s
	iters: 200, epoch: 33 | loss: 0.0026636
	speed: 0.0921s/iter; left time: 2917.6746s
	iters: 300, epoch: 33 | loss: 0.0069535
	speed: 0.0957s/iter; left time: 3024.7620s
	iters: 400, epoch: 33 | loss: 0.0049084
	speed: 0.0993s/iter; left time: 3128.2167s
Epoch: 33 cost time: 45.29602575302124
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0056893
	speed: 0.3668s/iter; left time: 11489.8323s
	iters: 200, epoch: 34 | loss: 0.0198924
	speed: 0.0931s/iter; left time: 2907.2514s
	iters: 300, epoch: 34 | loss: 0.0059929
	speed: 0.0916s/iter; left time: 2850.8173s
	iters: 400, epoch: 34 | loss: 0.0008013
	speed: 0.0941s/iter; left time: 2919.3635s
Epoch: 34 cost time: 43.70872664451599
Epoch: 34, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9714122355631789
model parameter : 234406
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3115205
	speed: 0.1054s/iter; left time: 4931.2260s
	iters: 200, epoch: 1 | loss: 1.2079045
	speed: 0.0810s/iter; left time: 3783.6124s
	iters: 300, epoch: 1 | loss: 0.6570107
	speed: 0.0850s/iter; left time: 3963.3789s
	iters: 400, epoch: 1 | loss: 0.5675829
	speed: 0.0822s/iter; left time: 3823.1583s
Epoch: 1 cost time: 41.11884927749634
Epoch: 1, Steps: 469 | Train Loss: 1.010 Vali Loss: 0.426 Vali Acc: 0.878 Test Loss: 0.426 Test Acc: 0.878
Validation loss decreased (inf --> -0.877640).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4479939
	speed: 0.3589s/iter; left time: 16629.5664s
	iters: 200, epoch: 2 | loss: 0.0728285
	speed: 0.0882s/iter; left time: 4078.6473s
	iters: 300, epoch: 2 | loss: 0.1230018
	speed: 0.0870s/iter; left time: 4014.1751s
	iters: 400, epoch: 2 | loss: 0.1177745
	speed: 0.0868s/iter; left time: 3994.0815s
Epoch: 2 cost time: 42.333422899246216
Epoch: 2, Steps: 469 | Train Loss: 0.241 Vali Loss: 0.323 Vali Acc: 0.907 Test Loss: 0.323 Test Acc: 0.907
Validation loss decreased (-0.877640 --> -0.907087).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0542163
	speed: 0.3714s/iter; left time: 17032.9062s
	iters: 200, epoch: 3 | loss: 0.0281524
	speed: 0.0835s/iter; left time: 3819.0652s
	iters: 300, epoch: 3 | loss: 0.1750434
	speed: 0.0861s/iter; left time: 3930.0878s
	iters: 400, epoch: 3 | loss: 0.4641136
	speed: 0.0917s/iter; left time: 4178.8075s
Epoch: 3 cost time: 40.79251575469971
Epoch: 3, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.301 Vali Acc: 0.916 Test Loss: 0.301 Test Acc: 0.916
Validation loss decreased (-0.907087 --> -0.916235).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0479314
	speed: 0.3654s/iter; left time: 16587.4526s
	iters: 200, epoch: 4 | loss: 0.1059202
	speed: 0.0816s/iter; left time: 3696.9426s
	iters: 300, epoch: 4 | loss: 0.6516852
	speed: 0.0789s/iter; left time: 3567.4078s
	iters: 400, epoch: 4 | loss: 0.0475464
	speed: 0.0814s/iter; left time: 3672.4634s
Epoch: 4 cost time: 39.32486867904663
Epoch: 4, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.202 Vali Acc: 0.938 Test Loss: 0.202 Test Acc: 0.938
Validation loss decreased (-0.916235 --> -0.938248).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1389461
	speed: 0.3578s/iter; left time: 16075.4987s
	iters: 200, epoch: 5 | loss: 0.0412125
	speed: 0.0914s/iter; left time: 4098.1719s
	iters: 300, epoch: 5 | loss: 0.1742210
	speed: 0.0844s/iter; left time: 3776.0619s
	iters: 400, epoch: 5 | loss: 0.3315482
	speed: 0.0797s/iter; left time: 3558.6887s
Epoch: 5 cost time: 40.2360942363739
Epoch: 5, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2766591
	speed: 0.3577s/iter; left time: 15903.1398s
	iters: 200, epoch: 6 | loss: 0.0158084
	speed: 0.0854s/iter; left time: 3788.0099s
	iters: 300, epoch: 6 | loss: 0.0487865
	speed: 0.0880s/iter; left time: 3895.3852s
	iters: 400, epoch: 6 | loss: 0.0163884
	speed: 0.0875s/iter; left time: 3861.9589s
Epoch: 6 cost time: 40.726059675216675
Epoch: 6, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.283 Vali Acc: 0.923 Test Loss: 0.283 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0121362
	speed: 0.3624s/iter; left time: 15942.7106s
	iters: 200, epoch: 7 | loss: 0.0100400
	speed: 0.0946s/iter; left time: 4151.3088s
	iters: 300, epoch: 7 | loss: 0.1734150
	speed: 0.0864s/iter; left time: 3782.7756s
	iters: 400, epoch: 7 | loss: 0.0717367
	speed: 0.0874s/iter; left time: 3819.9814s
Epoch: 7 cost time: 42.273836851119995
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.938248 --> -0.961691).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0082925
	speed: 0.3860s/iter; left time: 16796.2826s
	iters: 200, epoch: 8 | loss: 0.0120429
	speed: 0.0915s/iter; left time: 3973.1853s
	iters: 300, epoch: 8 | loss: 0.0897379
	speed: 0.0912s/iter; left time: 3951.7027s
	iters: 400, epoch: 8 | loss: 0.0156506
	speed: 0.0886s/iter; left time: 3829.4569s
Epoch: 8 cost time: 42.65746355056763
Epoch: 8, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0042993
	speed: 0.3940s/iter; left time: 16963.0835s
	iters: 200, epoch: 9 | loss: 0.0071661
	speed: 0.0881s/iter; left time: 3781.8741s
	iters: 300, epoch: 9 | loss: 0.0065933
	speed: 0.0856s/iter; left time: 3669.0253s
	iters: 400, epoch: 9 | loss: 0.0232168
	speed: 0.0846s/iter; left time: 3618.6013s
Epoch: 9 cost time: 41.41541862487793
Epoch: 9, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0655942
	speed: 0.3500s/iter; left time: 14900.9819s
	iters: 200, epoch: 10 | loss: 0.0078005
	speed: 0.0852s/iter; left time: 3620.4487s
	iters: 300, epoch: 10 | loss: 0.0726586
	speed: 0.0849s/iter; left time: 3599.3894s
	iters: 400, epoch: 10 | loss: 0.0337496
	speed: 0.0893s/iter; left time: 3777.2651s
Epoch: 10 cost time: 40.19001221656799
Epoch: 10, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0019767
	speed: 0.3607s/iter; left time: 15189.4558s
	iters: 200, epoch: 11 | loss: 0.0427571
	speed: 0.0859s/iter; left time: 3608.5235s
	iters: 300, epoch: 11 | loss: 0.0028367
	speed: 0.0843s/iter; left time: 3533.4463s
	iters: 400, epoch: 11 | loss: 0.0171634
	speed: 0.0925s/iter; left time: 3866.2047s
Epoch: 11 cost time: 40.90957069396973
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1319796
	speed: 0.3560s/iter; left time: 14826.6161s
	iters: 200, epoch: 12 | loss: 0.0023437
	speed: 0.0829s/iter; left time: 3444.6035s
	iters: 300, epoch: 12 | loss: 0.2618432
	speed: 0.0863s/iter; left time: 3574.9573s
	iters: 400, epoch: 12 | loss: 0.0076370
	speed: 0.0851s/iter; left time: 3518.4853s
Epoch: 12 cost time: 40.592039823532104
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.961691 --> -0.962263).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0116110
	speed: 0.3722s/iter; left time: 15323.0456s
	iters: 200, epoch: 13 | loss: 0.0502477
	speed: 0.0885s/iter; left time: 3635.5931s
	iters: 300, epoch: 13 | loss: 0.0301702
	speed: 0.0880s/iter; left time: 3607.1406s
	iters: 400, epoch: 13 | loss: 0.7088774
	speed: 0.0832s/iter; left time: 3401.1470s
Epoch: 13 cost time: 41.1896812915802
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0045883
	speed: 0.3460s/iter; left time: 14083.4186s
	iters: 200, epoch: 14 | loss: 0.0052854
	speed: 0.0825s/iter; left time: 3350.6859s
	iters: 300, epoch: 14 | loss: 0.0311394
	speed: 0.0847s/iter; left time: 3429.4570s
	iters: 400, epoch: 14 | loss: 0.1662698
	speed: 0.0889s/iter; left time: 3593.9069s
Epoch: 14 cost time: 39.83332085609436
Epoch: 14, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0064858
	speed: 0.3755s/iter; left time: 15108.2125s
	iters: 200, epoch: 15 | loss: 0.1396271
	speed: 0.0896s/iter; left time: 3595.1223s
	iters: 300, epoch: 15 | loss: 0.0535853
	speed: 0.0849s/iter; left time: 3399.1683s
	iters: 400, epoch: 15 | loss: 0.0077331
	speed: 0.0911s/iter; left time: 3636.1450s
Epoch: 15 cost time: 42.1474232673645
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0020749
	speed: 0.3768s/iter; left time: 14985.4554s
	iters: 200, epoch: 16 | loss: 0.0024514
	speed: 0.0909s/iter; left time: 3606.5567s
	iters: 300, epoch: 16 | loss: 0.0430605
	speed: 0.0915s/iter; left time: 3619.5508s
	iters: 400, epoch: 16 | loss: 0.0075572
	speed: 0.0941s/iter; left time: 3715.4271s
Epoch: 16 cost time: 43.36412978172302
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.962263 --> -0.966837).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0065426
	speed: 0.3945s/iter; left time: 15503.4508s
	iters: 200, epoch: 17 | loss: 0.0133033
	speed: 0.0949s/iter; left time: 3719.7643s
	iters: 300, epoch: 17 | loss: 0.0025523
	speed: 0.0950s/iter; left time: 3712.8996s
	iters: 400, epoch: 17 | loss: 0.2596221
	speed: 0.0974s/iter; left time: 3796.6864s
Epoch: 17 cost time: 45.219398498535156
Epoch: 17, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0029827
	speed: 0.3981s/iter; left time: 15457.1656s
	iters: 200, epoch: 18 | loss: 0.0035856
	speed: 0.0901s/iter; left time: 3488.2885s
	iters: 300, epoch: 18 | loss: 0.0071253
	speed: 0.0840s/iter; left time: 3243.8738s
	iters: 400, epoch: 18 | loss: 0.0032563
	speed: 0.0870s/iter; left time: 3352.6693s
Epoch: 18 cost time: 41.71458148956299
Epoch: 18, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0040097
	speed: 0.3714s/iter; left time: 14244.9740s
	iters: 200, epoch: 19 | loss: 0.0284867
	speed: 0.0879s/iter; left time: 3364.6170s
	iters: 300, epoch: 19 | loss: 0.0006526
	speed: 0.0882s/iter; left time: 3366.8144s
	iters: 400, epoch: 19 | loss: 0.0016249
	speed: 0.0913s/iter; left time: 3473.6616s
Epoch: 19 cost time: 41.82620930671692
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0140374
	speed: 0.3717s/iter; left time: 14085.3086s
	iters: 200, epoch: 20 | loss: 0.2726160
	speed: 0.0841s/iter; left time: 3179.2657s
	iters: 300, epoch: 20 | loss: 0.0052510
	speed: 0.0855s/iter; left time: 3221.8120s
	iters: 400, epoch: 20 | loss: 0.1068130
	speed: 0.0784s/iter; left time: 2947.6270s
Epoch: 20 cost time: 39.41851782798767
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0011575
	speed: 0.3372s/iter; left time: 12619.1113s
	iters: 200, epoch: 21 | loss: 0.3442524
	speed: 0.0871s/iter; left time: 3251.9924s
	iters: 300, epoch: 21 | loss: 0.1432323
	speed: 0.0897s/iter; left time: 3339.8060s
	iters: 400, epoch: 21 | loss: 0.1501850
	speed: 0.0846s/iter; left time: 3141.3374s
Epoch: 21 cost time: 41.54512548446655
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.955 Test Loss: 0.225 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1249660
	speed: 0.3709s/iter; left time: 13705.7368s
	iters: 200, epoch: 22 | loss: 0.0002921
	speed: 0.0831s/iter; left time: 3062.5563s
	iters: 300, epoch: 22 | loss: 0.0017468
	speed: 0.0883s/iter; left time: 3243.6777s
	iters: 400, epoch: 22 | loss: 0.0682908
	speed: 0.0865s/iter; left time: 3169.5816s
Epoch: 22 cost time: 41.385639905929565
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.966837 --> -0.977415).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0091208
	speed: 0.3710s/iter; left time: 13535.6489s
	iters: 200, epoch: 23 | loss: 0.0031639
	speed: 0.0914s/iter; left time: 3324.1500s
	iters: 300, epoch: 23 | loss: 0.0050567
	speed: 0.0903s/iter; left time: 3277.7686s
	iters: 400, epoch: 23 | loss: 0.0292287
	speed: 0.0883s/iter; left time: 3196.7164s
Epoch: 23 cost time: 42.180429458618164
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1301600
	speed: 0.3681s/iter; left time: 13258.2622s
	iters: 200, epoch: 24 | loss: 0.0005420
	speed: 0.0850s/iter; left time: 3053.7764s
	iters: 300, epoch: 24 | loss: 0.0070292
	speed: 0.0895s/iter; left time: 3207.0969s
	iters: 400, epoch: 24 | loss: 0.0022477
	speed: 0.0885s/iter; left time: 3161.6362s
Epoch: 24 cost time: 41.77101421356201
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0090962
	speed: 0.3813s/iter; left time: 13553.6979s
	iters: 200, epoch: 25 | loss: 0.0043882
	speed: 0.0864s/iter; left time: 3060.7856s
	iters: 300, epoch: 25 | loss: 0.0008779
	speed: 0.0912s/iter; left time: 3223.8792s
	iters: 400, epoch: 25 | loss: 0.1619309
	speed: 0.0938s/iter; left time: 3304.8886s
Epoch: 25 cost time: 42.968597412109375
Epoch: 25, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0009506
	speed: 0.3712s/iter; left time: 13020.8850s
	iters: 200, epoch: 26 | loss: 0.0055994
	speed: 0.0864s/iter; left time: 3022.9420s
	iters: 300, epoch: 26 | loss: 0.0010377
	speed: 0.0858s/iter; left time: 2991.7705s
	iters: 400, epoch: 26 | loss: 0.0371021
	speed: 0.0873s/iter; left time: 3034.2200s
Epoch: 26 cost time: 41.32457447052002
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.960 Test Loss: 0.199 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0002388
	speed: 0.3834s/iter; left time: 13267.1217s
	iters: 200, epoch: 27 | loss: 0.0649277
	speed: 0.0856s/iter; left time: 2954.5367s
	iters: 300, epoch: 27 | loss: 0.0703222
	speed: 0.0884s/iter; left time: 3040.3381s
	iters: 400, epoch: 27 | loss: 0.0165799
	speed: 0.0911s/iter; left time: 3126.5812s
Epoch: 27 cost time: 41.98660707473755
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.3878508
	speed: 0.3742s/iter; left time: 12774.7009s
	iters: 200, epoch: 28 | loss: 0.0287065
	speed: 0.0839s/iter; left time: 2855.7985s
	iters: 300, epoch: 28 | loss: 0.0017883
	speed: 0.0854s/iter; left time: 2897.6793s
	iters: 400, epoch: 28 | loss: 0.0097464
	speed: 0.0896s/iter; left time: 3031.9419s
Epoch: 28 cost time: 41.08079123497009
Epoch: 28, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0028681
	speed: 0.3669s/iter; left time: 12352.5214s
	iters: 200, epoch: 29 | loss: 0.0009857
	speed: 0.0867s/iter; left time: 2909.8349s
	iters: 300, epoch: 29 | loss: 0.0034261
	speed: 0.0869s/iter; left time: 2907.5652s
	iters: 400, epoch: 29 | loss: 0.0689243
	speed: 0.0857s/iter; left time: 2861.2018s
Epoch: 29 cost time: 41.44937205314636
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0187365
	speed: 0.3572s/iter; left time: 11859.4064s
	iters: 200, epoch: 30 | loss: 0.0021645
	speed: 0.0823s/iter; left time: 2725.5833s
	iters: 300, epoch: 30 | loss: 0.0018746
	speed: 0.0870s/iter; left time: 2871.5003s
	iters: 400, epoch: 30 | loss: 0.0059773
	speed: 0.0923s/iter; left time: 3035.8920s
Epoch: 30 cost time: 41.14470148086548
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0011422
	speed: 0.3693s/iter; left time: 12087.5528s
	iters: 200, epoch: 31 | loss: 0.0071092
	speed: 0.0862s/iter; left time: 2813.3851s
	iters: 300, epoch: 31 | loss: 0.0151280
	speed: 0.0844s/iter; left time: 2747.2263s
	iters: 400, epoch: 31 | loss: 0.0024284
	speed: 0.0869s/iter; left time: 2817.6916s
Epoch: 31 cost time: 41.06810665130615
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0268603
	speed: 0.3718s/iter; left time: 11996.5375s
	iters: 200, epoch: 32 | loss: 0.0450206
	speed: 0.0871s/iter; left time: 2802.0174s
	iters: 300, epoch: 32 | loss: 0.0032483
	speed: 0.0874s/iter; left time: 2801.9682s
	iters: 400, epoch: 32 | loss: 0.0008074
	speed: 0.0860s/iter; left time: 2749.4164s
Epoch: 32 cost time: 41.59934329986572
Epoch: 32, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 234278
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6480957
	speed: 0.1095s/iter; left time: 5123.2499s
	iters: 200, epoch: 1 | loss: 0.8596396
	speed: 0.0964s/iter; left time: 4502.5770s
	iters: 300, epoch: 1 | loss: 0.3282855
	speed: 0.0915s/iter; left time: 4265.6509s
	iters: 400, epoch: 1 | loss: 0.4428367
	speed: 0.0905s/iter; left time: 4206.0493s
Epoch: 1 cost time: 44.9758243560791
Epoch: 1, Steps: 469 | Train Loss: 0.971 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
Validation loss decreased (inf --> -0.888504).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3453903
	speed: 0.3719s/iter; left time: 17232.8414s
	iters: 200, epoch: 2 | loss: 0.1703152
	speed: 0.0853s/iter; left time: 3942.5807s
	iters: 300, epoch: 2 | loss: 0.1066238
	speed: 0.0837s/iter; left time: 3861.8273s
	iters: 400, epoch: 2 | loss: 0.1312070
	speed: 0.0912s/iter; left time: 4198.6038s
Epoch: 2 cost time: 41.1416449546814
Epoch: 2, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (-0.888504 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0625954
	speed: 0.3823s/iter; left time: 17534.0027s
	iters: 200, epoch: 3 | loss: 0.0500918
	speed: 0.0950s/iter; left time: 4349.3528s
	iters: 300, epoch: 3 | loss: 0.0409626
	speed: 0.0892s/iter; left time: 4073.6291s
	iters: 400, epoch: 3 | loss: 0.0308417
	speed: 0.0858s/iter; left time: 3910.5466s
Epoch: 3 cost time: 42.17487835884094
Epoch: 3, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0657892
	speed: 0.3531s/iter; left time: 16028.6512s
	iters: 200, epoch: 4 | loss: 0.0187586
	speed: 0.0909s/iter; left time: 4117.8946s
	iters: 300, epoch: 4 | loss: 0.1446828
	speed: 0.0931s/iter; left time: 4206.2573s
	iters: 400, epoch: 4 | loss: 0.2563566
	speed: 0.0873s/iter; left time: 3935.8929s
Epoch: 4 cost time: 41.756590366363525
Epoch: 4, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0334523
	speed: 0.3610s/iter; left time: 16218.1937s
	iters: 200, epoch: 5 | loss: 0.0250984
	speed: 0.0875s/iter; left time: 3923.1348s
	iters: 300, epoch: 5 | loss: 0.4123654
	speed: 0.0932s/iter; left time: 4167.1082s
	iters: 400, epoch: 5 | loss: 0.1177053
	speed: 0.0892s/iter; left time: 3978.4466s
Epoch: 5 cost time: 41.872511863708496
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
Validation loss decreased (-0.948826 --> -0.960547).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0265948
	speed: 0.3565s/iter; left time: 15847.0330s
	iters: 200, epoch: 6 | loss: 0.0274452
	speed: 0.0845s/iter; left time: 3748.7732s
	iters: 300, epoch: 6 | loss: 0.0076998
	speed: 0.0896s/iter; left time: 3963.4529s
	iters: 400, epoch: 6 | loss: 0.0274538
	speed: 0.0850s/iter; left time: 3751.6362s
Epoch: 6 cost time: 40.81129288673401
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (-0.960547 --> -0.961405).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0207901
	speed: 0.3736s/iter; left time: 16433.1486s
	iters: 200, epoch: 7 | loss: 0.0636942
	speed: 0.0973s/iter; left time: 4269.1590s
	iters: 300, epoch: 7 | loss: 0.0026014
	speed: 0.0896s/iter; left time: 3923.2724s
	iters: 400, epoch: 7 | loss: 0.5393093
	speed: 0.0841s/iter; left time: 3671.9477s
Epoch: 7 cost time: 42.579763889312744
Epoch: 7, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0055413
	speed: 0.3843s/iter; left time: 16724.8227s
	iters: 200, epoch: 8 | loss: 0.0400175
	speed: 0.0926s/iter; left time: 4022.6017s
	iters: 300, epoch: 8 | loss: 0.0083609
	speed: 0.1000s/iter; left time: 4330.1555s
	iters: 400, epoch: 8 | loss: 0.3623300
	speed: 0.0939s/iter; left time: 4056.9663s
Epoch: 8 cost time: 44.88040542602539
Epoch: 8, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1969125
	speed: 0.3942s/iter; left time: 16968.7016s
	iters: 200, epoch: 9 | loss: 0.1767383
	speed: 0.0958s/iter; left time: 4113.3489s
	iters: 300, epoch: 9 | loss: 0.0097641
	speed: 0.0892s/iter; left time: 3821.8721s
	iters: 400, epoch: 9 | loss: 0.0156400
	speed: 0.0911s/iter; left time: 3892.7087s
Epoch: 9 cost time: 43.35355544090271
Epoch: 9, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0087373
	speed: 0.3761s/iter; left time: 16012.6308s
	iters: 200, epoch: 10 | loss: 0.0258127
	speed: 0.0847s/iter; left time: 3597.0100s
	iters: 300, epoch: 10 | loss: 0.0252002
	speed: 0.0903s/iter; left time: 3828.6877s
	iters: 400, epoch: 10 | loss: 0.3464056
	speed: 0.0903s/iter; left time: 3817.0826s
Epoch: 10 cost time: 41.468512773513794
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.961405 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0150115
	speed: 0.3719s/iter; left time: 15660.8785s
	iters: 200, epoch: 11 | loss: 0.0327745
	speed: 0.0857s/iter; left time: 3599.5849s
	iters: 300, epoch: 11 | loss: 0.1225555
	speed: 0.0878s/iter; left time: 3680.2536s
	iters: 400, epoch: 11 | loss: 0.0064426
	speed: 0.0839s/iter; left time: 3507.2183s
Epoch: 11 cost time: 40.87376117706299
Epoch: 11, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.975985).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0384059
	speed: 0.3682s/iter; left time: 15331.9443s
	iters: 200, epoch: 12 | loss: 0.1314669
	speed: 0.0912s/iter; left time: 3790.0057s
	iters: 300, epoch: 12 | loss: 0.0957921
	speed: 0.0876s/iter; left time: 3631.0058s
	iters: 400, epoch: 12 | loss: 0.0290513
	speed: 0.0826s/iter; left time: 3413.1909s
Epoch: 12 cost time: 41.18383431434631
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.291 Vali Acc: 0.940 Test Loss: 0.291 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0083177
	speed: 0.3529s/iter; left time: 14529.5140s
	iters: 200, epoch: 13 | loss: 0.0149666
	speed: 0.0960s/iter; left time: 3944.1698s
	iters: 300, epoch: 13 | loss: 0.0041642
	speed: 0.0921s/iter; left time: 3771.7472s
	iters: 400, epoch: 13 | loss: 0.0067093
	speed: 0.0966s/iter; left time: 3947.0603s
Epoch: 13 cost time: 43.35034465789795
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0052036
	speed: 0.3539s/iter; left time: 14403.8304s
	iters: 200, epoch: 14 | loss: 0.0543629
	speed: 0.0948s/iter; left time: 3848.3974s
	iters: 300, epoch: 14 | loss: 0.0033581
	speed: 0.0917s/iter; left time: 3714.3889s
	iters: 400, epoch: 14 | loss: 0.0040986
	speed: 0.0913s/iter; left time: 3690.5518s
Epoch: 14 cost time: 43.14693903923035
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0047883
	speed: 0.3669s/iter; left time: 14763.5172s
	iters: 200, epoch: 15 | loss: 0.0030426
	speed: 0.0887s/iter; left time: 3560.2763s
	iters: 300, epoch: 15 | loss: 0.0077730
	speed: 0.0942s/iter; left time: 3770.3857s
	iters: 400, epoch: 15 | loss: 0.0094111
	speed: 0.0973s/iter; left time: 3886.1864s
Epoch: 15 cost time: 42.928786277770996
Epoch: 15, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0070625
	speed: 0.3794s/iter; left time: 15088.9710s
	iters: 200, epoch: 16 | loss: 0.0025423
	speed: 0.0922s/iter; left time: 3657.4833s
	iters: 300, epoch: 16 | loss: 0.0057646
	speed: 0.0962s/iter; left time: 3808.2069s
	iters: 400, epoch: 16 | loss: 0.0987975
	speed: 0.0978s/iter; left time: 3860.2588s
Epoch: 16 cost time: 44.381333351135254
Epoch: 16, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0044785
	speed: 0.3899s/iter; left time: 15321.0538s
	iters: 200, epoch: 17 | loss: 0.0084542
	speed: 0.0893s/iter; left time: 3499.1509s
	iters: 300, epoch: 17 | loss: 0.0114324
	speed: 0.0896s/iter; left time: 3503.9340s
	iters: 400, epoch: 17 | loss: 0.0006768
	speed: 0.0975s/iter; left time: 3800.8565s
Epoch: 17 cost time: 43.997772455215454
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0058408
	speed: 0.4042s/iter; left time: 15695.1795s
	iters: 200, epoch: 18 | loss: 0.0019561
	speed: 0.0874s/iter; left time: 3385.3764s
	iters: 300, epoch: 18 | loss: 0.0082484
	speed: 0.0837s/iter; left time: 3231.3593s
	iters: 400, epoch: 18 | loss: 0.3137437
	speed: 0.0816s/iter; left time: 3143.0128s
Epoch: 18 cost time: 40.58761501312256
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0039184
	speed: 0.3461s/iter; left time: 13277.0831s
	iters: 200, epoch: 19 | loss: 0.0066651
	speed: 0.0860s/iter; left time: 3290.4012s
	iters: 300, epoch: 19 | loss: 0.0177821
	speed: 0.0912s/iter; left time: 3481.2027s
	iters: 400, epoch: 19 | loss: 0.1417771
	speed: 0.0893s/iter; left time: 3399.3841s
Epoch: 19 cost time: 41.75732755661011
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0304735
	speed: 0.3726s/iter; left time: 14117.4108s
	iters: 200, epoch: 20 | loss: 0.0013298
	speed: 0.0921s/iter; left time: 3480.3697s
	iters: 300, epoch: 20 | loss: 0.6601047
	speed: 0.0911s/iter; left time: 3432.8844s
	iters: 400, epoch: 20 | loss: 0.0133293
	speed: 0.0873s/iter; left time: 3280.8616s
Epoch: 20 cost time: 42.69681358337402
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4596005
	speed: 0.3612s/iter; left time: 13518.1536s
	iters: 200, epoch: 21 | loss: 0.0011623
	speed: 0.0892s/iter; left time: 3327.5195s
	iters: 300, epoch: 21 | loss: 0.0019100
	speed: 0.0958s/iter; left time: 3567.5070s
	iters: 400, epoch: 21 | loss: 0.0025059
	speed: 0.0878s/iter; left time: 3259.2838s
Epoch: 21 cost time: 42.392613887786865
Epoch: 21, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 234150
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7878278
	speed: 0.1052s/iter; left time: 4923.0367s
	iters: 200, epoch: 1 | loss: 0.9172390
	speed: 0.0867s/iter; left time: 4047.1389s
	iters: 300, epoch: 1 | loss: 0.2787186
	speed: 0.0857s/iter; left time: 3992.9382s
	iters: 400, epoch: 1 | loss: 0.2197395
	speed: 0.0819s/iter; left time: 3809.8997s
Epoch: 1 cost time: 41.44926428794861
Epoch: 1, Steps: 469 | Train Loss: 0.988 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
Validation loss decreased (inf --> -0.863346).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3134812
	speed: 0.3432s/iter; left time: 15903.0507s
	iters: 200, epoch: 2 | loss: 0.2777347
	speed: 0.0860s/iter; left time: 3975.2100s
	iters: 300, epoch: 2 | loss: 0.0876964
	speed: 0.0846s/iter; left time: 3903.7427s
	iters: 400, epoch: 2 | loss: 0.5976431
	speed: 0.0923s/iter; left time: 4249.9047s
Epoch: 2 cost time: 41.33764839172363
Epoch: 2, Steps: 469 | Train Loss: 0.256 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
Validation loss decreased (-0.863346 --> -0.915378).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1200167
	speed: 0.3749s/iter; left time: 17193.7816s
	iters: 200, epoch: 3 | loss: 0.0785179
	speed: 0.0883s/iter; left time: 4042.8322s
	iters: 300, epoch: 3 | loss: 0.1177840
	speed: 0.0836s/iter; left time: 3816.0636s
	iters: 400, epoch: 3 | loss: 0.0533267
	speed: 0.0867s/iter; left time: 3950.4512s
Epoch: 3 cost time: 41.33554530143738
Epoch: 3, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
Validation loss decreased (-0.915378 --> -0.943394).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1867862
	speed: 0.3772s/iter; left time: 17123.7924s
	iters: 200, epoch: 4 | loss: 0.0131451
	speed: 0.0884s/iter; left time: 4005.7946s
	iters: 300, epoch: 4 | loss: 0.0956021
	speed: 0.0837s/iter; left time: 3784.2918s
	iters: 400, epoch: 4 | loss: 0.1608861
	speed: 0.0809s/iter; left time: 3646.4700s
Epoch: 4 cost time: 40.34055423736572
Epoch: 4, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.943394 --> -0.972269).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1393983
	speed: 0.3539s/iter; left time: 15899.8396s
	iters: 200, epoch: 5 | loss: 0.1499834
	speed: 0.0862s/iter; left time: 3864.1220s
	iters: 300, epoch: 5 | loss: 0.3987668
	speed: 0.0804s/iter; left time: 3596.8377s
	iters: 400, epoch: 5 | loss: 0.0118171
	speed: 0.0775s/iter; left time: 3457.7283s
Epoch: 5 cost time: 38.88667058944702
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0308284
	speed: 0.3383s/iter; left time: 15038.7407s
	iters: 200, epoch: 6 | loss: 0.3487368
	speed: 0.0821s/iter; left time: 3641.0039s
	iters: 300, epoch: 6 | loss: 0.3261727
	speed: 0.0819s/iter; left time: 3623.8747s
	iters: 400, epoch: 6 | loss: 0.0108743
	speed: 0.0816s/iter; left time: 3603.0442s
Epoch: 6 cost time: 38.71404838562012
Epoch: 6, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0951082
	speed: 0.3385s/iter; left time: 14888.0740s
	iters: 200, epoch: 7 | loss: 0.0045547
	speed: 0.0811s/iter; left time: 3559.2992s
	iters: 300, epoch: 7 | loss: 0.0622634
	speed: 0.0803s/iter; left time: 3514.4066s
	iters: 400, epoch: 7 | loss: 0.0117684
	speed: 0.0781s/iter; left time: 3413.1205s
Epoch: 7 cost time: 37.74497604370117
Epoch: 7, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2949682
	speed: 0.3390s/iter; left time: 14754.1028s
	iters: 200, epoch: 8 | loss: 0.0511619
	speed: 0.0783s/iter; left time: 3401.5731s
	iters: 300, epoch: 8 | loss: 0.2383354
	speed: 0.0858s/iter; left time: 3715.6610s
	iters: 400, epoch: 8 | loss: 0.0288702
	speed: 0.0826s/iter; left time: 3570.7131s
Epoch: 8 cost time: 38.77683472633362
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0401200
	speed: 0.3512s/iter; left time: 15118.2980s
	iters: 200, epoch: 9 | loss: 0.0046530
	speed: 0.0772s/iter; left time: 3316.5842s
	iters: 300, epoch: 9 | loss: 0.0157953
	speed: 0.0797s/iter; left time: 3417.2038s
	iters: 400, epoch: 9 | loss: 0.0948983
	speed: 0.0812s/iter; left time: 3471.7535s
Epoch: 9 cost time: 38.48524212837219
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.203 Vali Acc: 0.954 Test Loss: 0.203 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0282090
	speed: 0.3449s/iter; left time: 14684.4754s
	iters: 200, epoch: 10 | loss: 0.1096574
	speed: 0.0775s/iter; left time: 3292.4465s
	iters: 300, epoch: 10 | loss: 0.5256100
	speed: 0.0761s/iter; left time: 3225.3550s
	iters: 400, epoch: 10 | loss: 0.0411717
	speed: 0.0818s/iter; left time: 3458.7711s
Epoch: 10 cost time: 38.27251410484314
Epoch: 10, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2220101
	speed: 0.3729s/iter; left time: 15701.2245s
	iters: 200, epoch: 11 | loss: 0.0899453
	speed: 0.0837s/iter; left time: 3518.2389s
	iters: 300, epoch: 11 | loss: 0.0024081
	speed: 0.0926s/iter; left time: 3880.9929s
	iters: 400, epoch: 11 | loss: 0.0052999
	speed: 0.0862s/iter; left time: 3605.3312s
Epoch: 11 cost time: 41.074787855148315
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3889159
	speed: 0.3728s/iter; left time: 15522.0973s
	iters: 200, epoch: 12 | loss: 0.0052347
	speed: 0.0864s/iter; left time: 3587.1852s
	iters: 300, epoch: 12 | loss: 0.1801898
	speed: 0.0796s/iter; left time: 3297.8045s
	iters: 400, epoch: 12 | loss: 0.0051197
	speed: 0.0831s/iter; left time: 3435.5711s
Epoch: 12 cost time: 40.572983264923096
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0396643
	speed: 0.3651s/iter; left time: 15033.1365s
	iters: 200, epoch: 13 | loss: 0.0230702
	speed: 0.0866s/iter; left time: 3557.6963s
	iters: 300, epoch: 13 | loss: 0.0059448
	speed: 0.0859s/iter; left time: 3519.7813s
	iters: 400, epoch: 13 | loss: 0.2854073
	speed: 0.0809s/iter; left time: 3306.8246s
Epoch: 13 cost time: 39.65644407272339
Epoch: 13, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0020167
	speed: 0.3441s/iter; left time: 14005.1712s
	iters: 200, epoch: 14 | loss: 0.2447556
	speed: 0.0795s/iter; left time: 3228.2370s
	iters: 300, epoch: 14 | loss: 0.0036697
	speed: 0.0809s/iter; left time: 3276.3743s
	iters: 400, epoch: 14 | loss: 0.0219196
	speed: 0.0766s/iter; left time: 3093.8054s
Epoch: 14 cost time: 37.79320788383484
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9722698684962836
model parameter : 234022
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4496648
	speed: 0.0795s/iter; left time: 3721.1204s
	iters: 200, epoch: 1 | loss: 0.1531209
	speed: 0.0670s/iter; left time: 3130.4343s
	iters: 300, epoch: 1 | loss: 0.4385635
	speed: 0.0648s/iter; left time: 3020.3516s
	iters: 400, epoch: 1 | loss: 0.3099393
	speed: 0.0682s/iter; left time: 3171.1121s
Epoch: 1 cost time: 32.70047998428345
Epoch: 1, Steps: 469 | Train Loss: 0.447 Vali Loss: 0.372 Vali Acc: 0.886 Test Loss: 0.372 Test Acc: 0.886
Validation loss decreased (inf --> -0.885931).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0792754
	speed: 0.3083s/iter; left time: 14284.1289s
	iters: 200, epoch: 2 | loss: 0.0434690
	speed: 0.0622s/iter; left time: 2875.6290s
	iters: 300, epoch: 2 | loss: 0.0660864
	speed: 0.0643s/iter; left time: 2965.3064s
	iters: 400, epoch: 2 | loss: 0.2979949
	speed: 0.0631s/iter; left time: 2903.9042s
Epoch: 2 cost time: 30.492785453796387
Epoch: 2, Steps: 469 | Train Loss: 0.263 Vali Loss: 0.345 Vali Acc: 0.905 Test Loss: 0.345 Test Acc: 0.905
Validation loss decreased (-0.885931 --> -0.904799).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2040871
	speed: 0.3230s/iter; left time: 14814.6814s
	iters: 200, epoch: 3 | loss: 0.4566800
	speed: 0.0713s/iter; left time: 3263.3169s
	iters: 300, epoch: 3 | loss: 0.5397820
	speed: 0.0722s/iter; left time: 3295.9207s
	iters: 400, epoch: 3 | loss: 0.2437937
	speed: 0.0663s/iter; left time: 3021.5735s
Epoch: 3 cost time: 33.10724711418152
Epoch: 3, Steps: 469 | Train Loss: 0.302 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1036822
	speed: 0.3166s/iter; left time: 14371.0627s
	iters: 200, epoch: 4 | loss: 0.4129471
	speed: 0.0652s/iter; left time: 2953.7592s
	iters: 300, epoch: 4 | loss: 1.2442559
	speed: 0.0644s/iter; left time: 2909.4140s
	iters: 400, epoch: 4 | loss: 0.1210337
	speed: 0.0651s/iter; left time: 2934.6535s
Epoch: 4 cost time: 31.83840298652649
Epoch: 4, Steps: 469 | Train Loss: 0.414 Vali Loss: 0.853 Vali Acc: 0.747 Test Loss: 0.853 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4776313
	speed: 0.3304s/iter; left time: 14844.9631s
	iters: 200, epoch: 5 | loss: 0.3297264
	speed: 0.0713s/iter; left time: 3194.1378s
	iters: 300, epoch: 5 | loss: 0.4146516
	speed: 0.0738s/iter; left time: 3299.7975s
	iters: 400, epoch: 5 | loss: 0.1570954
	speed: 0.0716s/iter; left time: 3196.0661s
Epoch: 5 cost time: 34.73940348625183
Epoch: 5, Steps: 469 | Train Loss: 0.496 Vali Loss: 1.794 Vali Acc: 0.600 Test Loss: 1.794 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6584046
	speed: 0.3486s/iter; left time: 15495.6090s
	iters: 200, epoch: 6 | loss: 1.1250224
	speed: 0.0706s/iter; left time: 3133.2100s
	iters: 300, epoch: 6 | loss: 1.3839726
	speed: 0.0731s/iter; left time: 3233.0115s
	iters: 400, epoch: 6 | loss: 0.5556067
	speed: 0.0785s/iter; left time: 3466.3271s
Epoch: 6 cost time: 35.07034087181091
Epoch: 6, Steps: 469 | Train Loss: 0.623 Vali Loss: 0.757 Vali Acc: 0.788 Test Loss: 0.757 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4018685
	speed: 0.3418s/iter; left time: 15035.9368s
	iters: 200, epoch: 7 | loss: 0.5705253
	speed: 0.0725s/iter; left time: 3183.5637s
	iters: 300, epoch: 7 | loss: 0.5193520
	speed: 0.0708s/iter; left time: 3098.9489s
	iters: 400, epoch: 7 | loss: 0.9915696
	speed: 0.0648s/iter; left time: 2829.7335s
Epoch: 7 cost time: 33.884639501571655
Epoch: 7, Steps: 469 | Train Loss: 0.599 Vali Loss: 1.475 Vali Acc: 0.665 Test Loss: 1.475 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.6861653
	speed: 0.3202s/iter; left time: 13935.3866s
	iters: 200, epoch: 8 | loss: 2.4004674
	speed: 0.0682s/iter; left time: 2959.0637s
	iters: 300, epoch: 8 | loss: 2.1147294
	speed: 0.0679s/iter; left time: 2940.9550s
	iters: 400, epoch: 8 | loss: 2.2729554
	speed: 0.0712s/iter; left time: 3079.0820s
Epoch: 8 cost time: 33.23674511909485
Epoch: 8, Steps: 469 | Train Loss: 2.035 Vali Loss: 2.348 Vali Acc: 0.142 Test Loss: 2.348 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.5680203
	speed: 0.3243s/iter; left time: 13961.1938s
	iters: 200, epoch: 9 | loss: 2.1126139
	speed: 0.0653s/iter; left time: 2804.7621s
	iters: 300, epoch: 9 | loss: 2.3916712
	speed: 0.0676s/iter; left time: 2898.4265s
	iters: 400, epoch: 9 | loss: 2.3166699
	speed: 0.0676s/iter; left time: 2889.8644s
Epoch: 9 cost time: 31.96767282485962
Epoch: 9, Steps: 469 | Train Loss: 2.281 Vali Loss: 2.263 Vali Acc: 0.133 Test Loss: 2.263 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2741895
	speed: 0.3076s/iter; left time: 13098.1259s
	iters: 200, epoch: 10 | loss: 2.2964957
	speed: 0.0697s/iter; left time: 2959.9111s
	iters: 300, epoch: 10 | loss: 2.3597519
	speed: 0.0703s/iter; left time: 2977.9533s
	iters: 400, epoch: 10 | loss: 2.2418816
	speed: 0.0675s/iter; left time: 2855.4724s
Epoch: 10 cost time: 32.824702978134155
Epoch: 10, Steps: 469 | Train Loss: 2.286 Vali Loss: 2.312 Vali Acc: 0.102 Test Loss: 2.312 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3159647
	speed: 0.3174s/iter; left time: 13367.1959s
	iters: 200, epoch: 11 | loss: 2.2920191
	speed: 0.0675s/iter; left time: 2836.9001s
	iters: 300, epoch: 11 | loss: 2.3016686
	speed: 0.0713s/iter; left time: 2989.0386s
	iters: 400, epoch: 11 | loss: 2.3041804
	speed: 0.0702s/iter; left time: 2934.8649s
Epoch: 11 cost time: 33.33983063697815
Epoch: 11, Steps: 469 | Train Loss: 2.298 Vali Loss: 2.301 Vali Acc: 0.102 Test Loss: 2.301 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3115301
	speed: 0.3142s/iter; left time: 13085.6914s
	iters: 200, epoch: 12 | loss: 2.1923833
	speed: 0.0733s/iter; left time: 3044.5678s
	iters: 300, epoch: 12 | loss: 2.2118807
	speed: 0.0735s/iter; left time: 3046.8096s
	iters: 400, epoch: 12 | loss: 2.1721101
	speed: 0.0831s/iter; left time: 3436.0301s
Epoch: 12 cost time: 36.27717137336731
Epoch: 12, Steps: 469 | Train Loss: 2.289 Vali Loss: 2.307 Vali Acc: 0.115 Test Loss: 2.307 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9048027444253859
model parameter : 11094074
model size : 47.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2878865
	speed: 0.0942s/iter; left time: 4410.8456s
	iters: 200, epoch: 1 | loss: 0.2258625
	speed: 0.0741s/iter; left time: 3462.4449s
	iters: 300, epoch: 1 | loss: 0.3918958
	speed: 0.0751s/iter; left time: 3500.8357s
	iters: 400, epoch: 1 | loss: 0.1351759
	speed: 0.0731s/iter; left time: 3400.0612s
Epoch: 1 cost time: 37.20792889595032
Epoch: 1, Steps: 469 | Train Loss: 0.445 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
Validation loss decreased (inf --> -0.826467).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0378195
	speed: 0.3616s/iter; left time: 16754.3878s
	iters: 200, epoch: 2 | loss: 1.2027880
	speed: 0.0755s/iter; left time: 3488.8575s
	iters: 300, epoch: 2 | loss: 0.1579563
	speed: 0.0771s/iter; left time: 3556.6824s
	iters: 400, epoch: 2 | loss: 0.0625456
	speed: 0.0833s/iter; left time: 3832.3408s
Epoch: 2 cost time: 37.89178276062012
Epoch: 2, Steps: 469 | Train Loss: 0.282 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.826467 --> -0.921953).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2277409
	speed: 0.3683s/iter; left time: 16893.4942s
	iters: 200, epoch: 3 | loss: 0.3020828
	speed: 0.0877s/iter; left time: 4011.8422s
	iters: 300, epoch: 3 | loss: 0.1574766
	speed: 0.0787s/iter; left time: 3593.5608s
	iters: 400, epoch: 3 | loss: 0.1813108
	speed: 0.0776s/iter; left time: 3535.2416s
Epoch: 3 cost time: 37.849263191223145
Epoch: 3, Steps: 469 | Train Loss: 0.291 Vali Loss: 0.434 Vali Acc: 0.873 Test Loss: 0.434 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1229906
	speed: 0.3750s/iter; left time: 17024.9400s
	iters: 200, epoch: 4 | loss: 0.4878916
	speed: 0.0832s/iter; left time: 3769.6990s
	iters: 300, epoch: 4 | loss: 0.3713232
	speed: 0.0815s/iter; left time: 3685.2063s
	iters: 400, epoch: 4 | loss: 0.0715768
	speed: 0.0829s/iter; left time: 3737.5348s
Epoch: 4 cost time: 39.41014504432678
Epoch: 4, Steps: 469 | Train Loss: 0.341 Vali Loss: 0.601 Vali Acc: 0.837 Test Loss: 0.601 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2778239
	speed: 0.3822s/iter; left time: 17171.1600s
	iters: 200, epoch: 5 | loss: 0.4869009
	speed: 0.0756s/iter; left time: 3387.0796s
	iters: 300, epoch: 5 | loss: 2.5975742
	speed: 0.0786s/iter; left time: 3516.7240s
	iters: 400, epoch: 5 | loss: 2.7046180
	speed: 0.0851s/iter; left time: 3799.2755s
Epoch: 5 cost time: 38.018632650375366
Epoch: 5, Steps: 469 | Train Loss: 1.481 Vali Loss: 2.521 Vali Acc: 0.104 Test Loss: 2.521 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3353214
	speed: 0.3388s/iter; left time: 15060.9479s
	iters: 200, epoch: 6 | loss: 2.2579169
	speed: 0.0773s/iter; left time: 3426.7231s
	iters: 300, epoch: 6 | loss: 2.4550502
	speed: 0.0791s/iter; left time: 3501.1863s
	iters: 400, epoch: 6 | loss: 2.3451116
	speed: 0.0705s/iter; left time: 3115.1116s
Epoch: 6 cost time: 35.68367910385132
Epoch: 6, Steps: 469 | Train Loss: 2.374 Vali Loss: 2.330 Vali Acc: 0.096 Test Loss: 2.330 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3647912
	speed: 0.3319s/iter; left time: 14601.0827s
	iters: 200, epoch: 7 | loss: 2.3769026
	speed: 0.0634s/iter; left time: 2783.0079s
	iters: 300, epoch: 7 | loss: 2.2494123
	speed: 0.0677s/iter; left time: 2964.5954s
	iters: 400, epoch: 7 | loss: 2.3127425
	speed: 0.0705s/iter; left time: 3080.5052s
Epoch: 7 cost time: 32.792927980422974
Epoch: 7, Steps: 469 | Train Loss: 2.326 Vali Loss: 2.312 Vali Acc: 0.104 Test Loss: 2.312 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3259954
	speed: 0.3808s/iter; left time: 16571.3357s
	iters: 200, epoch: 8 | loss: 2.2953262
	speed: 0.0914s/iter; left time: 3968.7001s
	iters: 300, epoch: 8 | loss: 2.3076384
	speed: 0.0877s/iter; left time: 3798.1508s
	iters: 400, epoch: 8 | loss: 2.3605943
	speed: 0.0885s/iter; left time: 3824.4158s
Epoch: 8 cost time: 41.863656520843506
Epoch: 8, Steps: 469 | Train Loss: 2.317 Vali Loss: 2.308 Vali Acc: 0.104 Test Loss: 2.308 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3106487
	speed: 0.3981s/iter; left time: 17138.1487s
	iters: 200, epoch: 9 | loss: 2.3142288
	speed: 0.0903s/iter; left time: 3876.8843s
	iters: 300, epoch: 9 | loss: 2.3804345
	speed: 0.0913s/iter; left time: 3913.9594s
	iters: 400, epoch: 9 | loss: 2.3355150
	speed: 0.0849s/iter; left time: 3630.9691s
Epoch: 9 cost time: 40.74449419975281
Epoch: 9, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.308 Vali Acc: 0.104 Test Loss: 2.308 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2291934
	speed: 0.4032s/iter; left time: 17168.8124s
	iters: 200, epoch: 10 | loss: 2.2768893
	speed: 0.0855s/iter; left time: 3632.9298s
	iters: 300, epoch: 10 | loss: 2.2983904
	speed: 0.0831s/iter; left time: 3519.6680s
	iters: 400, epoch: 10 | loss: 2.3454549
	speed: 0.0876s/iter; left time: 3702.8900s
Epoch: 10 cost time: 41.77237272262573
Epoch: 10, Steps: 469 | Train Loss: 2.309 Vali Loss: 2.307 Vali Acc: 0.096 Test Loss: 2.307 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3005638
	speed: 0.3953s/iter; left time: 16646.6714s
	iters: 200, epoch: 11 | loss: 2.3197706
	speed: 0.0953s/iter; left time: 4005.5811s
	iters: 300, epoch: 11 | loss: 2.2628655
	speed: 0.0856s/iter; left time: 3586.5306s
	iters: 400, epoch: 11 | loss: 2.3705883
	speed: 0.0846s/iter; left time: 3536.5894s
Epoch: 11 cost time: 41.864195108413696
Epoch: 11, Steps: 469 | Train Loss: 2.309 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3425918
	speed: 0.3895s/iter; left time: 16219.5492s
	iters: 200, epoch: 12 | loss: 2.2913370
	speed: 0.0803s/iter; left time: 3337.3288s
	iters: 300, epoch: 12 | loss: 2.2850432
	speed: 0.0844s/iter; left time: 3498.3553s
	iters: 400, epoch: 12 | loss: 2.2832446
	speed: 0.0823s/iter; left time: 3403.8466s
Epoch: 12 cost time: 39.180887937545776
Epoch: 12, Steps: 469 | Train Loss: 2.307 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9219554030874786
model parameter : 11093306
model size : 47.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5589541
	speed: 0.1055s/iter; left time: 4938.3574s
	iters: 200, epoch: 1 | loss: 0.3126361
	speed: 0.0885s/iter; left time: 4131.2700s
	iters: 300, epoch: 1 | loss: 0.0476112
	speed: 0.0760s/iter; left time: 3543.6956s
	iters: 400, epoch: 1 | loss: 0.5460465
	speed: 0.0728s/iter; left time: 3385.4891s
Epoch: 1 cost time: 39.78332281112671
Epoch: 1, Steps: 469 | Train Loss: 0.451 Vali Loss: 0.415 Vali Acc: 0.847 Test Loss: 0.415 Test Acc: 0.847
Validation loss decreased (inf --> -0.846765).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1993639
	speed: 0.3574s/iter; left time: 16557.6583s
	iters: 200, epoch: 2 | loss: 0.0805348
	speed: 0.0691s/iter; left time: 3196.3937s
	iters: 300, epoch: 2 | loss: 0.3729184
	speed: 0.0760s/iter; left time: 3506.7363s
	iters: 400, epoch: 2 | loss: 0.7647726
	speed: 0.0784s/iter; left time: 3607.2238s
Epoch: 2 cost time: 35.239675760269165
Epoch: 2, Steps: 469 | Train Loss: 0.286 Vali Loss: 0.366 Vali Acc: 0.910 Test Loss: 0.366 Test Acc: 0.910
Validation loss decreased (-0.846765 --> -0.910231).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0447476
	speed: 0.3750s/iter; left time: 17200.5075s
	iters: 200, epoch: 3 | loss: 0.4808292
	speed: 0.0797s/iter; left time: 3648.6199s
	iters: 300, epoch: 3 | loss: 0.2022554
	speed: 0.0779s/iter; left time: 3555.2627s
	iters: 400, epoch: 3 | loss: 0.0284125
	speed: 0.0780s/iter; left time: 3553.4298s
Epoch: 3 cost time: 38.11739754676819
Epoch: 3, Steps: 469 | Train Loss: 0.283 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7466169
	speed: 0.3579s/iter; left time: 16247.5068s
	iters: 200, epoch: 4 | loss: 0.6017520
	speed: 0.0829s/iter; left time: 3756.7350s
	iters: 300, epoch: 4 | loss: 0.1151494
	speed: 0.0735s/iter; left time: 3322.0127s
	iters: 400, epoch: 4 | loss: 0.2153005
	speed: 0.0741s/iter; left time: 3343.2863s
Epoch: 4 cost time: 36.563653230667114
Epoch: 4, Steps: 469 | Train Loss: 0.307 Vali Loss: 0.360 Vali Acc: 0.876 Test Loss: 0.360 Test Acc: 0.876
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4757598
	speed: 0.3397s/iter; left time: 15262.9792s
	iters: 200, epoch: 5 | loss: 0.3038823
	speed: 0.0738s/iter; left time: 3307.4901s
	iters: 300, epoch: 5 | loss: 0.2770630
	speed: 0.0774s/iter; left time: 3462.6007s
	iters: 400, epoch: 5 | loss: 0.1691868
	speed: 0.0769s/iter; left time: 3431.7484s
Epoch: 5 cost time: 35.31666278839111
Epoch: 5, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4392667
	speed: 0.3289s/iter; left time: 14620.4168s
	iters: 200, epoch: 6 | loss: 0.6185598
	speed: 0.0699s/iter; left time: 3099.7348s
	iters: 300, epoch: 6 | loss: 0.2490426
	speed: 0.0686s/iter; left time: 3036.6700s
	iters: 400, epoch: 6 | loss: 0.1920142
	speed: 0.0779s/iter; left time: 3440.0411s
Epoch: 6 cost time: 33.9601948261261
Epoch: 6, Steps: 469 | Train Loss: 0.390 Vali Loss: 0.720 Vali Acc: 0.837 Test Loss: 0.720 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7397604
	speed: 0.3201s/iter; left time: 14078.0915s
	iters: 200, epoch: 7 | loss: 0.3265362
	speed: 0.0675s/iter; left time: 2961.9023s
	iters: 300, epoch: 7 | loss: 1.1038122
	speed: 0.0703s/iter; left time: 3078.8551s
	iters: 400, epoch: 7 | loss: 0.6025934
	speed: 0.0696s/iter; left time: 3040.0827s
Epoch: 7 cost time: 32.61521601676941
Epoch: 7, Steps: 469 | Train Loss: 0.467 Vali Loss: 0.496 Vali Acc: 0.864 Test Loss: 0.496 Test Acc: 0.864
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.3214865
	speed: 0.3304s/iter; left time: 14379.6361s
	iters: 200, epoch: 8 | loss: 0.0326560
	speed: 0.0721s/iter; left time: 3128.2976s
	iters: 300, epoch: 8 | loss: 0.2508007
	speed: 0.0710s/iter; left time: 3076.4211s
	iters: 400, epoch: 8 | loss: 0.5411147
	speed: 0.0706s/iter; left time: 3051.7944s
Epoch: 8 cost time: 34.286603927612305
Epoch: 8, Steps: 469 | Train Loss: 0.434 Vali Loss: 0.500 Vali Acc: 0.849 Test Loss: 0.500 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.4879948
	speed: 0.3376s/iter; left time: 14533.0814s
	iters: 200, epoch: 9 | loss: 0.4802205
	speed: 0.0755s/iter; left time: 3243.1664s
	iters: 300, epoch: 9 | loss: 0.4263249
	speed: 0.0743s/iter; left time: 3184.9941s
	iters: 400, epoch: 9 | loss: 0.3571570
	speed: 0.0724s/iter; left time: 3093.1109s
Epoch: 9 cost time: 35.37128829956055
Epoch: 9, Steps: 469 | Train Loss: 0.448 Vali Loss: 0.378 Vali Acc: 0.908 Test Loss: 0.378 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1635011
	speed: 0.3349s/iter; left time: 14259.9268s
	iters: 200, epoch: 10 | loss: 0.6831925
	speed: 0.0759s/iter; left time: 3224.2193s
	iters: 300, epoch: 10 | loss: 0.4976220
	speed: 0.0843s/iter; left time: 3573.5028s
	iters: 400, epoch: 10 | loss: 0.0962432
	speed: 0.0859s/iter; left time: 3632.8298s
Epoch: 10 cost time: 38.449557304382324
Epoch: 10, Steps: 469 | Train Loss: 0.445 Vali Loss: 0.712 Vali Acc: 0.789 Test Loss: 0.712 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7875833
	speed: 0.4371s/iter; left time: 18406.4929s
	iters: 200, epoch: 11 | loss: 0.3761119
	speed: 0.0863s/iter; left time: 3626.8337s
	iters: 300, epoch: 11 | loss: 0.0641919
	speed: 0.0884s/iter; left time: 3704.8696s
	iters: 400, epoch: 11 | loss: 0.0317411
	speed: 0.0838s/iter; left time: 3502.1611s
Epoch: 11 cost time: 42.88616323471069
Epoch: 11, Steps: 469 | Train Loss: 0.344 Vali Loss: 0.637 Vali Acc: 0.805 Test Loss: 0.637 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7781341
	speed: 0.4128s/iter; left time: 17189.5389s
	iters: 200, epoch: 12 | loss: 0.1722346
	speed: 0.0865s/iter; left time: 3593.9205s
	iters: 300, epoch: 12 | loss: 0.4828206
	speed: 0.0815s/iter; left time: 3378.8602s
	iters: 400, epoch: 12 | loss: 0.0720653
	speed: 0.0847s/iter; left time: 3501.0690s
Epoch: 12 cost time: 40.17764949798584
Epoch: 12, Steps: 469 | Train Loss: 0.337 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9102344196683819
model parameter : 11092538
model size : 47.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2950750
	speed: 0.1065s/iter; left time: 4984.5562s
	iters: 200, epoch: 1 | loss: 0.0927032
	speed: 0.0963s/iter; left time: 4499.3582s
	iters: 300, epoch: 1 | loss: 0.2683928
	speed: 0.0906s/iter; left time: 4222.2839s
	iters: 400, epoch: 1 | loss: 0.1919507
	speed: 0.0894s/iter; left time: 4159.2385s
Epoch: 1 cost time: 44.646015644073486
Epoch: 1, Steps: 469 | Train Loss: 0.440 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
Validation loss decreased (inf --> -0.848481).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1842753
	speed: 0.4240s/iter; left time: 19647.0683s
	iters: 200, epoch: 2 | loss: 0.0838461
	speed: 0.0954s/iter; left time: 4408.9647s
	iters: 300, epoch: 2 | loss: 0.2887226
	speed: 0.0903s/iter; left time: 4164.7682s
	iters: 400, epoch: 2 | loss: 0.7844571
	speed: 0.0845s/iter; left time: 3890.9720s
Epoch: 2 cost time: 42.21679210662842
Epoch: 2, Steps: 469 | Train Loss: 0.289 Vali Loss: 0.384 Vali Acc: 0.879 Test Loss: 0.384 Test Acc: 0.879
Validation loss decreased (-0.848481 --> -0.879070).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3675534
	speed: 0.4306s/iter; left time: 19748.9976s
	iters: 200, epoch: 3 | loss: 0.1205158
	speed: 0.0924s/iter; left time: 4227.9978s
	iters: 300, epoch: 3 | loss: 0.1172500
	speed: 0.0925s/iter; left time: 4222.2151s
	iters: 400, epoch: 3 | loss: 0.6277955
	speed: 0.0965s/iter; left time: 4395.4767s
Epoch: 3 cost time: 44.29409146308899
Epoch: 3, Steps: 469 | Train Loss: 0.275 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1198643
	speed: 0.4244s/iter; left time: 19264.9309s
	iters: 200, epoch: 4 | loss: 0.1824801
	speed: 0.1074s/iter; left time: 4863.2635s
	iters: 300, epoch: 4 | loss: 0.1778009
	speed: 0.1170s/iter; left time: 5286.2182s
	iters: 400, epoch: 4 | loss: 0.0137166
	speed: 0.1051s/iter; left time: 4740.1612s
Epoch: 4 cost time: 49.99272918701172
Epoch: 4, Steps: 469 | Train Loss: 0.256 Vali Loss: 0.301 Vali Acc: 0.909 Test Loss: 0.301 Test Acc: 0.909
Validation loss decreased (-0.879070 --> -0.909374).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2737964
	speed: 0.4659s/iter; left time: 20931.6078s
	iters: 200, epoch: 5 | loss: 0.3418246
	speed: 0.0906s/iter; left time: 4060.9667s
	iters: 300, epoch: 5 | loss: 0.3762580
	speed: 0.1065s/iter; left time: 4763.4799s
	iters: 400, epoch: 5 | loss: 0.4008457
	speed: 0.1133s/iter; left time: 5057.9484s
Epoch: 5 cost time: 48.505953788757324
Epoch: 5, Steps: 469 | Train Loss: 0.284 Vali Loss: 0.391 Vali Acc: 0.887 Test Loss: 0.391 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4015134
	speed: 0.5227s/iter; left time: 23235.9135s
	iters: 200, epoch: 6 | loss: 0.3495505
	speed: 0.1089s/iter; left time: 4830.6146s
	iters: 300, epoch: 6 | loss: 0.1203034
	speed: 0.0967s/iter; left time: 4278.1048s
	iters: 400, epoch: 6 | loss: 0.2988306
	speed: 0.1024s/iter; left time: 4519.4048s
Epoch: 6 cost time: 52.02897500991821
Epoch: 6, Steps: 469 | Train Loss: 0.233 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.909374 --> -0.921952).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1229366
	speed: 0.5047s/iter; left time: 22198.9105s
	iters: 200, epoch: 7 | loss: 0.5624325
	speed: 0.1228s/iter; left time: 5389.7738s
	iters: 300, epoch: 7 | loss: 0.4764571
	speed: 0.1035s/iter; left time: 4531.0356s
	iters: 400, epoch: 7 | loss: 0.1666493
	speed: 0.0988s/iter; left time: 4315.1324s
Epoch: 7 cost time: 51.56905126571655
Epoch: 7, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5235217
	speed: 0.5014s/iter; left time: 21819.0107s
	iters: 200, epoch: 8 | loss: 0.0051881
	speed: 0.1187s/iter; left time: 5151.7895s
	iters: 300, epoch: 8 | loss: 0.0764012
	speed: 0.1051s/iter; left time: 4551.2158s
	iters: 400, epoch: 8 | loss: 0.1774239
	speed: 0.1196s/iter; left time: 5170.8394s
Epoch: 8 cost time: 54.308977127075195
Epoch: 8, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5007339
	speed: 0.4801s/iter; left time: 20665.9173s
	iters: 200, epoch: 9 | loss: 0.1993917
	speed: 0.1103s/iter; left time: 4735.2873s
	iters: 300, epoch: 9 | loss: 0.0066467
	speed: 0.1147s/iter; left time: 4915.8585s
	iters: 400, epoch: 9 | loss: 0.3222084
	speed: 0.1124s/iter; left time: 4802.9263s
Epoch: 9 cost time: 53.750481605529785
Epoch: 9, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.291 Vali Acc: 0.927 Test Loss: 0.291 Test Acc: 0.927
Validation loss decreased (-0.921952 --> -0.926527).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1171094
	speed: 0.5414s/iter; left time: 23054.7707s
	iters: 200, epoch: 10 | loss: 0.0125256
	speed: 0.1491s/iter; left time: 6334.7040s
	iters: 300, epoch: 10 | loss: 0.0087743
	speed: 0.1359s/iter; left time: 5758.1875s
	iters: 400, epoch: 10 | loss: 0.0518046
	speed: 0.1370s/iter; left time: 5791.6425s
Epoch: 10 cost time: 64.67659735679626
Epoch: 10, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
Validation loss decreased (-0.926527 --> -0.927670).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0146988
	speed: 0.5831s/iter; left time: 24553.6304s
	iters: 200, epoch: 11 | loss: 0.0160882
	speed: 0.1374s/iter; left time: 5770.5764s
	iters: 300, epoch: 11 | loss: 0.1728144
	speed: 0.1054s/iter; left time: 4417.4468s
	iters: 400, epoch: 11 | loss: 0.1982571
	speed: 0.1087s/iter; left time: 4546.4313s
Epoch: 11 cost time: 57.65287446975708
Epoch: 11, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.316 Vali Acc: 0.909 Test Loss: 0.316 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0214503
	speed: 0.5618s/iter; left time: 23394.9212s
	iters: 200, epoch: 12 | loss: 0.4014675
	speed: 0.1214s/iter; left time: 5041.3256s
	iters: 300, epoch: 12 | loss: 0.3069892
	speed: 0.1489s/iter; left time: 6169.6201s
	iters: 400, epoch: 12 | loss: 0.0815997
	speed: 0.1376s/iter; left time: 5686.8243s
Epoch: 12 cost time: 63.71565341949463
Epoch: 12, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.927670 --> -0.958546).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2154775
	speed: 0.5839s/iter; left time: 24039.2178s
	iters: 200, epoch: 13 | loss: 0.0221708
	speed: 0.1281s/iter; left time: 5259.6295s
	iters: 300, epoch: 13 | loss: 0.0284793
	speed: 0.1188s/iter; left time: 4868.4377s
	iters: 400, epoch: 13 | loss: 0.0403589
	speed: 0.1156s/iter; left time: 4726.6771s
Epoch: 13 cost time: 57.526060819625854
Epoch: 13, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.301 Vali Acc: 0.923 Test Loss: 0.301 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1946072
	speed: 0.5926s/iter; left time: 24121.1057s
	iters: 200, epoch: 14 | loss: 0.2533296
	speed: 0.1269s/iter; left time: 5153.5058s
	iters: 300, epoch: 14 | loss: 0.2253391
	speed: 0.1387s/iter; left time: 5618.1355s
	iters: 400, epoch: 14 | loss: 0.0168337
	speed: 0.1283s/iter; left time: 5185.7282s
Epoch: 14 cost time: 64.18177390098572
Epoch: 14, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.275 Vali Acc: 0.941 Test Loss: 0.275 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4812494
	speed: 0.5515s/iter; left time: 22189.0673s
	iters: 200, epoch: 15 | loss: 0.0105392
	speed: 0.1490s/iter; left time: 5978.3094s
	iters: 300, epoch: 15 | loss: 0.0176094
	speed: 0.1164s/iter; left time: 4661.6580s
	iters: 400, epoch: 15 | loss: 0.1964275
	speed: 0.1294s/iter; left time: 5166.8993s
Epoch: 15 cost time: 61.091307163238525
Epoch: 15, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.238 Vali Acc: 0.949 Test Loss: 0.238 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1102232
	speed: 0.5572s/iter; left time: 22155.7561s
	iters: 200, epoch: 16 | loss: 0.0170549
	speed: 0.1250s/iter; left time: 4958.5662s
	iters: 300, epoch: 16 | loss: 0.0541214
	speed: 0.1344s/iter; left time: 5316.2956s
	iters: 400, epoch: 16 | loss: 0.1424665
	speed: 0.1175s/iter; left time: 4636.3699s
Epoch: 16 cost time: 59.402974128723145
Epoch: 16, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0445556
	speed: 0.5409s/iter; left time: 21254.5003s
	iters: 200, epoch: 17 | loss: 0.1522088
	speed: 0.1073s/iter; left time: 4206.5834s
	iters: 300, epoch: 17 | loss: 0.0042830
	speed: 0.1132s/iter; left time: 4427.0346s
	iters: 400, epoch: 17 | loss: 0.2906329
	speed: 0.1170s/iter; left time: 4561.5985s
Epoch: 17 cost time: 54.79598331451416
Epoch: 17, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0067608
	speed: 0.5100s/iter; left time: 19803.6887s
	iters: 200, epoch: 18 | loss: 0.8558369
	speed: 0.1106s/iter; left time: 4285.2401s
	iters: 300, epoch: 18 | loss: 0.0064797
	speed: 0.1142s/iter; left time: 4411.8409s
	iters: 400, epoch: 18 | loss: 0.0120361
	speed: 0.1176s/iter; left time: 4531.6815s
Epoch: 18 cost time: 53.00586986541748
Epoch: 18, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.270 Vali Acc: 0.943 Test Loss: 0.270 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0640818
	speed: 0.4838s/iter; left time: 18557.0276s
	iters: 200, epoch: 19 | loss: 0.0158651
	speed: 0.1119s/iter; left time: 4282.3015s
	iters: 300, epoch: 19 | loss: 0.0135095
	speed: 0.1157s/iter; left time: 4416.3101s
	iters: 400, epoch: 19 | loss: 0.2980703
	speed: 0.1078s/iter; left time: 4102.5839s
Epoch: 19 cost time: 52.97564458847046
Epoch: 19, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0152654
	speed: 0.4901s/iter; left time: 18570.6494s
	iters: 200, epoch: 20 | loss: 0.0019844
	speed: 0.1022s/iter; left time: 3862.1212s
	iters: 300, epoch: 20 | loss: 0.0023406
	speed: 0.1091s/iter; left time: 4111.9015s
	iters: 400, epoch: 20 | loss: 0.0289212
	speed: 0.1164s/iter; left time: 4374.1116s
Epoch: 20 cost time: 52.39718580245972
Epoch: 20, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0031442
	speed: 0.5370s/iter; left time: 20096.0949s
	iters: 200, epoch: 21 | loss: 0.0267387
	speed: 0.1134s/iter; left time: 4233.2485s
	iters: 300, epoch: 21 | loss: 0.0570527
	speed: 0.1126s/iter; left time: 4190.7475s
	iters: 400, epoch: 21 | loss: 0.0048234
	speed: 0.1150s/iter; left time: 4267.8930s
Epoch: 21 cost time: 54.38994312286377
Epoch: 21, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
Validation loss decreased (-0.958546 --> -0.963120).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0103995
	speed: 0.5035s/iter; left time: 18606.6605s
	iters: 200, epoch: 22 | loss: 0.1509709
	speed: 0.0969s/iter; left time: 3572.6473s
	iters: 300, epoch: 22 | loss: 0.2915146
	speed: 0.0963s/iter; left time: 3540.4179s
	iters: 400, epoch: 22 | loss: 0.0168111
	speed: 0.0931s/iter; left time: 3412.7701s
Epoch: 22 cost time: 46.870086669921875
Epoch: 22, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0702226
	speed: 0.4131s/iter; left time: 15072.5396s
	iters: 200, epoch: 23 | loss: 0.1176522
	speed: 0.1229s/iter; left time: 4471.8417s
	iters: 300, epoch: 23 | loss: 0.0098498
	speed: 0.1025s/iter; left time: 3718.9530s
	iters: 400, epoch: 23 | loss: 0.0199599
	speed: 0.1155s/iter; left time: 4178.6258s
Epoch: 23 cost time: 52.45507860183716
Epoch: 23, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0026811
	speed: 0.5117s/iter; left time: 18426.7014s
	iters: 200, epoch: 24 | loss: 0.0031020
	speed: 0.1103s/iter; left time: 3960.9140s
	iters: 300, epoch: 24 | loss: 0.1116466
	speed: 0.1007s/iter; left time: 3605.8502s
	iters: 400, epoch: 24 | loss: 0.1219854
	speed: 0.0932s/iter; left time: 3330.1737s
Epoch: 24 cost time: 47.66951298713684
Epoch: 24, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.243 Vali Acc: 0.940 Test Loss: 0.243 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.1829446
	speed: 0.4189s/iter; left time: 14888.1086s
	iters: 200, epoch: 25 | loss: 0.0112467
	speed: 0.1060s/iter; left time: 3756.5016s
	iters: 300, epoch: 25 | loss: 0.3978300
	speed: 0.1117s/iter; left time: 3947.9802s
	iters: 400, epoch: 25 | loss: 0.2181229
	speed: 0.1046s/iter; left time: 3685.9025s
Epoch: 25 cost time: 48.45005202293396
Epoch: 25, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0064048
	speed: 0.4509s/iter; left time: 15816.0597s
	iters: 200, epoch: 26 | loss: 0.1018974
	speed: 0.1070s/iter; left time: 3742.6972s
	iters: 300, epoch: 26 | loss: 0.0074432
	speed: 0.0966s/iter; left time: 3369.3854s
	iters: 400, epoch: 26 | loss: 0.0255599
	speed: 0.1082s/iter; left time: 3762.0023s
Epoch: 26 cost time: 49.589964628219604
Epoch: 26, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0703918
	speed: 0.4871s/iter; left time: 16855.8056s
	iters: 200, epoch: 27 | loss: 0.2122483
	speed: 0.1072s/iter; left time: 3698.3368s
	iters: 300, epoch: 27 | loss: 0.3698118
	speed: 0.0970s/iter; left time: 3336.8600s
	iters: 400, epoch: 27 | loss: 0.0810680
	speed: 0.0979s/iter; left time: 3357.2335s
Epoch: 27 cost time: 48.23921227455139
Epoch: 27, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.232 Vali Acc: 0.945 Test Loss: 0.232 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0627250
	speed: 0.4922s/iter; left time: 16803.7661s
	iters: 200, epoch: 28 | loss: 0.0655415
	speed: 0.1046s/iter; left time: 3561.6563s
	iters: 300, epoch: 28 | loss: 0.0373375
	speed: 0.1094s/iter; left time: 3713.0922s
	iters: 400, epoch: 28 | loss: 0.0390027
	speed: 0.0989s/iter; left time: 3345.9504s
Epoch: 28 cost time: 50.00664401054382
Epoch: 28, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0843124
	speed: 0.4576s/iter; left time: 15405.9396s
	iters: 200, epoch: 29 | loss: 0.0553431
	speed: 0.0872s/iter; left time: 2928.0020s
	iters: 300, epoch: 29 | loss: 0.0161294
	speed: 0.0960s/iter; left time: 3212.0607s
	iters: 400, epoch: 29 | loss: 0.2241521
	speed: 0.0941s/iter; left time: 3141.3823s
Epoch: 29 cost time: 43.69475722312927
Epoch: 29, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.5431081
	speed: 0.4127s/iter; left time: 13702.4817s
	iters: 200, epoch: 30 | loss: 0.0027797
	speed: 0.0983s/iter; left time: 3255.0213s
	iters: 300, epoch: 30 | loss: 0.0483546
	speed: 0.0990s/iter; left time: 3268.1332s
	iters: 400, epoch: 30 | loss: 0.1442623
	speed: 0.0879s/iter; left time: 2890.9446s
Epoch: 30 cost time: 44.9077582359314
Epoch: 30, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.244 Vali Acc: 0.951 Test Loss: 0.244 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0251051
	speed: 0.4378s/iter; left time: 14331.1789s
	iters: 200, epoch: 31 | loss: 0.0114415
	speed: 0.0939s/iter; left time: 3062.8286s
	iters: 300, epoch: 31 | loss: 0.0177416
	speed: 0.0940s/iter; left time: 3059.0035s
	iters: 400, epoch: 31 | loss: 0.1266808
	speed: 0.0956s/iter; left time: 3101.1510s
Epoch: 31 cost time: 46.17282748222351
Epoch: 31, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.963120 --> -0.966837).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0050692
	speed: 0.4144s/iter; left time: 13370.8156s
	iters: 200, epoch: 32 | loss: 0.0514531
	speed: 0.1031s/iter; left time: 3316.1142s
	iters: 300, epoch: 32 | loss: 0.0065715
	speed: 0.0939s/iter; left time: 3011.2881s
	iters: 400, epoch: 32 | loss: 0.0043565
	speed: 0.1070s/iter; left time: 3420.7777s
Epoch: 32 cost time: 48.495421409606934
Epoch: 32, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0009267
	speed: 0.4466s/iter; left time: 14197.9046s
	iters: 200, epoch: 33 | loss: 0.0086535
	speed: 0.0890s/iter; left time: 2820.8388s
	iters: 300, epoch: 33 | loss: 0.1024373
	speed: 0.1143s/iter; left time: 3610.3566s
	iters: 400, epoch: 33 | loss: 0.0109887
	speed: 0.1169s/iter; left time: 3682.0861s
Epoch: 33 cost time: 49.43087935447693
Epoch: 33, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0403974
	speed: 0.4754s/iter; left time: 14892.8777s
	iters: 200, epoch: 34 | loss: 0.0610452
	speed: 0.1050s/iter; left time: 3279.6413s
	iters: 300, epoch: 34 | loss: 0.0022911
	speed: 0.0975s/iter; left time: 3034.6082s
	iters: 400, epoch: 34 | loss: 0.0274942
	speed: 0.1119s/iter; left time: 3471.5662s
Epoch: 34 cost time: 50.2457811832428
Epoch: 34, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0908876
	speed: 0.4810s/iter; left time: 14839.9183s
	iters: 200, epoch: 35 | loss: 0.1973419
	speed: 0.0990s/iter; left time: 3043.8656s
	iters: 300, epoch: 35 | loss: 0.0028286
	speed: 0.0943s/iter; left time: 2890.9809s
	iters: 400, epoch: 35 | loss: 0.0060053
	speed: 0.0972s/iter; left time: 2970.1267s
Epoch: 35 cost time: 46.19201040267944
Epoch: 35, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0111620
	speed: 0.4217s/iter; left time: 12812.6040s
	iters: 200, epoch: 36 | loss: 0.0042245
	speed: 0.0808s/iter; left time: 2447.7944s
	iters: 300, epoch: 36 | loss: 0.0120901
	speed: 0.0782s/iter; left time: 2361.7286s
	iters: 400, epoch: 36 | loss: 0.0039085
	speed: 0.0776s/iter; left time: 2333.3012s
Epoch: 36 cost time: 37.889410734176636
Epoch: 36, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.5145412
	speed: 0.4243s/iter; left time: 12694.8615s
	iters: 200, epoch: 37 | loss: 0.0238312
	speed: 0.0905s/iter; left time: 2699.7664s
	iters: 300, epoch: 37 | loss: 0.0758197
	speed: 0.0857s/iter; left time: 2547.6234s
	iters: 400, epoch: 37 | loss: 0.0067382
	speed: 0.0852s/iter; left time: 2522.2669s
Epoch: 37 cost time: 42.54699969291687
Epoch: 37, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0126084
	speed: 0.4217s/iter; left time: 12416.7722s
	iters: 200, epoch: 38 | loss: 0.0017137
	speed: 0.0932s/iter; left time: 2734.6082s
	iters: 300, epoch: 38 | loss: 0.1137430
	speed: 0.0973s/iter; left time: 2845.0638s
	iters: 400, epoch: 38 | loss: 0.0034366
	speed: 0.0806s/iter; left time: 2349.6997s
Epoch: 38 cost time: 41.873308181762695
Epoch: 38, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.250 Vali Acc: 0.957 Test Loss: 0.250 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.1506713
	speed: 0.3922s/iter; left time: 11365.0704s
	iters: 200, epoch: 39 | loss: 0.0036834
	speed: 0.0890s/iter; left time: 2569.4106s
	iters: 300, epoch: 39 | loss: 0.0042042
	speed: 0.0854s/iter; left time: 2458.7978s
	iters: 400, epoch: 39 | loss: 0.0070184
	speed: 0.0828s/iter; left time: 2374.3232s
Epoch: 39 cost time: 42.04922080039978
Epoch: 39, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0620508
	speed: 0.4045s/iter; left time: 11532.0286s
	iters: 200, epoch: 40 | loss: 0.1408959
	speed: 0.0905s/iter; left time: 2572.4208s
	iters: 300, epoch: 40 | loss: 0.0086156
	speed: 0.1082s/iter; left time: 3063.0394s
	iters: 400, epoch: 40 | loss: 0.1639461
	speed: 0.0908s/iter; left time: 2560.3702s
Epoch: 40 cost time: 43.8877911567688
Epoch: 40, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0308878
	speed: 0.4079s/iter; left time: 11437.2877s
	iters: 200, epoch: 41 | loss: 0.0058843
	speed: 0.0840s/iter; left time: 2346.3523s
	iters: 300, epoch: 41 | loss: 0.0018347
	speed: 0.0966s/iter; left time: 2688.7899s
	iters: 400, epoch: 41 | loss: 0.0696278
	speed: 0.1047s/iter; left time: 2903.9219s
Epoch: 41 cost time: 44.265180826187134
Epoch: 41, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 11091770
model size : 47.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2904814
	speed: 0.1186s/iter; left time: 5550.2206s
	iters: 200, epoch: 1 | loss: 0.0859690
	speed: 0.0846s/iter; left time: 3949.5469s
	iters: 300, epoch: 1 | loss: 0.5052055
	speed: 0.0819s/iter; left time: 3817.6353s
	iters: 400, epoch: 1 | loss: 0.3341724
	speed: 0.0856s/iter; left time: 3982.6060s
Epoch: 1 cost time: 43.02407264709473
Epoch: 1, Steps: 469 | Train Loss: 0.441 Vali Loss: 0.325 Vali Acc: 0.902 Test Loss: 0.325 Test Acc: 0.902
Validation loss decreased (inf --> -0.901941).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0745467
	speed: 0.3494s/iter; left time: 16189.1301s
	iters: 200, epoch: 2 | loss: 0.0544850
	speed: 0.0780s/iter; left time: 3605.4956s
	iters: 300, epoch: 2 | loss: 0.4066346
	speed: 0.0803s/iter; left time: 3705.5312s
	iters: 400, epoch: 2 | loss: 0.1749489
	speed: 0.0838s/iter; left time: 3858.6931s
Epoch: 2 cost time: 37.81698393821716
Epoch: 2, Steps: 469 | Train Loss: 0.249 Vali Loss: 0.777 Vali Acc: 0.832 Test Loss: 0.777 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0513949
	speed: 0.3827s/iter; left time: 17550.7130s
	iters: 200, epoch: 3 | loss: 0.0158866
	speed: 0.0808s/iter; left time: 3698.4432s
	iters: 300, epoch: 3 | loss: 0.3494043
	speed: 0.0773s/iter; left time: 3531.8704s
	iters: 400, epoch: 3 | loss: 1.1419625
	speed: 0.0769s/iter; left time: 3504.8491s
Epoch: 3 cost time: 37.98247194290161
Epoch: 3, Steps: 469 | Train Loss: 0.259 Vali Loss: 0.350 Vali Acc: 0.892 Test Loss: 0.350 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0773006
	speed: 0.3638s/iter; left time: 16512.7737s
	iters: 200, epoch: 4 | loss: 0.0797050
	speed: 0.0734s/iter; left time: 3326.5701s
	iters: 300, epoch: 4 | loss: 0.2264735
	speed: 0.0745s/iter; left time: 3368.0884s
	iters: 400, epoch: 4 | loss: 0.4455192
	speed: 0.0779s/iter; left time: 3510.9775s
Epoch: 4 cost time: 35.793344259262085
Epoch: 4, Steps: 469 | Train Loss: 0.279 Vali Loss: 0.279 Vali Acc: 0.919 Test Loss: 0.279 Test Acc: 0.919
Validation loss decreased (-0.901941 --> -0.918808).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4103419
	speed: 0.3566s/iter; left time: 16021.8865s
	iters: 200, epoch: 5 | loss: 0.5671101
	speed: 0.0745s/iter; left time: 3340.2968s
	iters: 300, epoch: 5 | loss: 0.8539967
	speed: 0.0721s/iter; left time: 3224.4820s
	iters: 400, epoch: 5 | loss: 0.7465783
	speed: 0.0849s/iter; left time: 3786.8547s
Epoch: 5 cost time: 36.87685990333557
Epoch: 5, Steps: 469 | Train Loss: 0.902 Vali Loss: 1.063 Vali Acc: 0.641 Test Loss: 1.063 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5437562
	speed: 0.3743s/iter; left time: 16638.0709s
	iters: 200, epoch: 6 | loss: 2.1049314
	speed: 0.0731s/iter; left time: 3240.6430s
	iters: 300, epoch: 6 | loss: 2.4765832
	speed: 0.0765s/iter; left time: 3387.5424s
	iters: 400, epoch: 6 | loss: 2.2086620
	speed: 0.0795s/iter; left time: 3509.7312s
Epoch: 6 cost time: 36.16536545753479
Epoch: 6, Steps: 469 | Train Loss: 1.928 Vali Loss: 2.116 Vali Acc: 0.245 Test Loss: 2.116 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0480139
	speed: 0.3448s/iter; left time: 15167.5639s
	iters: 200, epoch: 7 | loss: 1.7339368
	speed: 0.0756s/iter; left time: 3319.2140s
	iters: 300, epoch: 7 | loss: 1.6176513
	speed: 0.0744s/iter; left time: 3255.6808s
	iters: 400, epoch: 7 | loss: 2.2754812
	speed: 0.0798s/iter; left time: 3485.8158s
Epoch: 7 cost time: 36.56683015823364
Epoch: 7, Steps: 469 | Train Loss: 2.010 Vali Loss: 2.193 Vali Acc: 0.165 Test Loss: 2.193 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9423057
	speed: 0.3794s/iter; left time: 16510.9726s
	iters: 200, epoch: 8 | loss: 1.9764359
	speed: 0.0807s/iter; left time: 3503.5826s
	iters: 300, epoch: 8 | loss: 2.0839963
	speed: 0.0764s/iter; left time: 3309.8416s
	iters: 400, epoch: 8 | loss: 2.0750566
	speed: 0.0789s/iter; left time: 3408.5916s
Epoch: 8 cost time: 37.17211151123047
Epoch: 8, Steps: 469 | Train Loss: 2.077 Vali Loss: 2.051 Vali Acc: 0.198 Test Loss: 2.051 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.7717271
	speed: 0.3698s/iter; left time: 15921.4611s
	iters: 200, epoch: 9 | loss: 1.8587646
	speed: 0.0762s/iter; left time: 3274.6550s
	iters: 300, epoch: 9 | loss: 1.8820200
	speed: 0.0736s/iter; left time: 3153.3661s
	iters: 400, epoch: 9 | loss: 1.9304236
	speed: 0.0794s/iter; left time: 3395.4647s
Epoch: 9 cost time: 36.73002600669861
Epoch: 9, Steps: 469 | Train Loss: 2.002 Vali Loss: 2.092 Vali Acc: 0.204 Test Loss: 2.092 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.0058277
	speed: 0.3368s/iter; left time: 14339.7735s
	iters: 200, epoch: 10 | loss: 1.8405762
	speed: 0.0737s/iter; left time: 3131.7052s
	iters: 300, epoch: 10 | loss: 1.8774519
	speed: 0.0764s/iter; left time: 3238.5774s
	iters: 400, epoch: 10 | loss: 1.5094845
	speed: 0.0779s/iter; left time: 3293.8199s
Epoch: 10 cost time: 35.48621463775635
Epoch: 10, Steps: 469 | Train Loss: 1.990 Vali Loss: 1.977 Vali Acc: 0.195 Test Loss: 1.977 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.1002529
	speed: 0.3267s/iter; left time: 13757.4183s
	iters: 200, epoch: 11 | loss: 1.7250768
	speed: 0.0747s/iter; left time: 3137.1859s
	iters: 300, epoch: 11 | loss: 1.9143914
	speed: 0.0724s/iter; left time: 3035.2371s
	iters: 400, epoch: 11 | loss: 1.9764897
	speed: 0.0766s/iter; left time: 3202.8615s
Epoch: 11 cost time: 35.51858854293823
Epoch: 11, Steps: 469 | Train Loss: 1.912 Vali Loss: 1.982 Vali Acc: 0.222 Test Loss: 1.982 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.1674874
	speed: 0.3515s/iter; left time: 14637.5038s
	iters: 200, epoch: 12 | loss: 2.0154345
	speed: 0.0838s/iter; left time: 3479.4749s
	iters: 300, epoch: 12 | loss: 1.9599671
	speed: 0.0812s/iter; left time: 3363.7428s
	iters: 400, epoch: 12 | loss: 1.9270946
	speed: 0.0809s/iter; left time: 3344.4934s
Epoch: 12 cost time: 39.02397894859314
Epoch: 12, Steps: 469 | Train Loss: 1.953 Vali Loss: 2.053 Vali Acc: 0.220 Test Loss: 2.053 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.1049547
	speed: 0.3674s/iter; left time: 15125.8619s
	iters: 200, epoch: 13 | loss: 2.0832345
	speed: 0.0864s/iter; left time: 3549.2142s
	iters: 300, epoch: 13 | loss: 2.0671470
	speed: 0.0875s/iter; left time: 3583.6179s
	iters: 400, epoch: 13 | loss: 2.0168860
	speed: 0.0799s/iter; left time: 3264.8567s
Epoch: 13 cost time: 39.933945655822754
Epoch: 13, Steps: 469 | Train Loss: 1.975 Vali Loss: 2.054 Vali Acc: 0.216 Test Loss: 2.054 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.0803530
	speed: 0.3740s/iter; left time: 15221.9817s
	iters: 200, epoch: 14 | loss: 2.1699648
	speed: 0.0787s/iter; left time: 3196.3263s
	iters: 300, epoch: 14 | loss: 2.3406963
	speed: 0.0815s/iter; left time: 3302.0347s
	iters: 400, epoch: 14 | loss: 1.7885813
	speed: 0.0777s/iter; left time: 3140.2111s
Epoch: 14 cost time: 38.84918713569641
Epoch: 14, Steps: 469 | Train Loss: 1.955 Vali Loss: 1.970 Vali Acc: 0.208 Test Loss: 1.970 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9188107489994283
model parameter : 9255482
model size : 40.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3892113
	speed: 0.0968s/iter; left time: 4531.4764s
	iters: 200, epoch: 1 | loss: 0.1167522
	speed: 0.0829s/iter; left time: 3870.2726s
	iters: 300, epoch: 1 | loss: 0.1489138
	speed: 0.0809s/iter; left time: 3767.8734s
	iters: 400, epoch: 1 | loss: 0.0977087
	speed: 0.0782s/iter; left time: 3636.4217s
Epoch: 1 cost time: 39.10228705406189
Epoch: 1, Steps: 469 | Train Loss: 0.455 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
Validation loss decreased (inf --> -0.898796).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4386022
	speed: 0.3764s/iter; left time: 17439.4590s
	iters: 200, epoch: 2 | loss: 0.0236320
	speed: 0.0761s/iter; left time: 3518.1196s
	iters: 300, epoch: 2 | loss: 0.1118997
	speed: 0.0807s/iter; left time: 3723.9961s
	iters: 400, epoch: 2 | loss: 0.1317934
	speed: 0.0893s/iter; left time: 4111.3259s
Epoch: 2 cost time: 40.14151072502136
Epoch: 2, Steps: 469 | Train Loss: 0.240 Vali Loss: 0.385 Vali Acc: 0.885 Test Loss: 0.385 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1932572
	speed: 0.3748s/iter; left time: 17187.8478s
	iters: 200, epoch: 3 | loss: 0.0253763
	speed: 0.0733s/iter; left time: 3354.1233s
	iters: 300, epoch: 3 | loss: 0.4204250
	speed: 0.0725s/iter; left time: 3311.1816s
	iters: 400, epoch: 3 | loss: 0.4287439
	speed: 0.0798s/iter; left time: 3636.0445s
Epoch: 3 cost time: 36.04514932632446
Epoch: 3, Steps: 469 | Train Loss: 0.269 Vali Loss: 0.402 Vali Acc: 0.887 Test Loss: 0.402 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0615246
	speed: 0.3501s/iter; left time: 15890.2106s
	iters: 200, epoch: 4 | loss: 0.0424964
	speed: 0.0740s/iter; left time: 3351.0229s
	iters: 300, epoch: 4 | loss: 0.0519470
	speed: 0.0785s/iter; left time: 3547.8972s
	iters: 400, epoch: 4 | loss: 0.8843552
	speed: 0.0822s/iter; left time: 3706.9833s
Epoch: 4 cost time: 37.15504503250122
Epoch: 4, Steps: 469 | Train Loss: 0.328 Vali Loss: 0.561 Vali Acc: 0.843 Test Loss: 0.561 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0430166
	speed: 0.3551s/iter; left time: 15950.9428s
	iters: 200, epoch: 5 | loss: 0.2354537
	speed: 0.0895s/iter; left time: 4013.8747s
	iters: 300, epoch: 5 | loss: 0.3469607
	speed: 0.0760s/iter; left time: 3398.0748s
	iters: 400, epoch: 5 | loss: 0.3704913
	speed: 0.0686s/iter; left time: 3060.1983s
Epoch: 5 cost time: 37.00900459289551
Epoch: 5, Steps: 469 | Train Loss: 0.396 Vali Loss: 0.549 Vali Acc: 0.832 Test Loss: 0.549 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7733797
	speed: 0.3650s/iter; left time: 16226.9279s
	iters: 200, epoch: 6 | loss: 0.9455473
	speed: 0.0788s/iter; left time: 3495.3243s
	iters: 300, epoch: 6 | loss: 0.6952977
	speed: 0.0848s/iter; left time: 3752.5131s
	iters: 400, epoch: 6 | loss: 0.3576533
	speed: 0.0794s/iter; left time: 3504.7391s
Epoch: 6 cost time: 38.69408965110779
Epoch: 6, Steps: 469 | Train Loss: 0.675 Vali Loss: 0.538 Vali Acc: 0.813 Test Loss: 0.538 Test Acc: 0.813
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1734922
	speed: 0.3813s/iter; left time: 16770.0790s
	iters: 200, epoch: 7 | loss: 0.6309263
	speed: 0.0953s/iter; left time: 4181.0544s
	iters: 300, epoch: 7 | loss: 0.2019007
	speed: 0.0840s/iter; left time: 3677.9516s
	iters: 400, epoch: 7 | loss: 0.2891119
	speed: 0.0789s/iter; left time: 3446.4356s
Epoch: 7 cost time: 40.821661710739136
Epoch: 7, Steps: 469 | Train Loss: 0.411 Vali Loss: 0.590 Vali Acc: 0.823 Test Loss: 0.590 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3819284
	speed: 0.3566s/iter; left time: 15519.0796s
	iters: 200, epoch: 8 | loss: 0.4661219
	speed: 0.0757s/iter; left time: 3285.2732s
	iters: 300, epoch: 8 | loss: 0.3546965
	speed: 0.0736s/iter; left time: 3188.3591s
	iters: 400, epoch: 8 | loss: 0.6132188
	speed: 0.0808s/iter; left time: 3493.1462s
Epoch: 8 cost time: 36.617289781570435
Epoch: 8, Steps: 469 | Train Loss: 0.533 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.8414069
	speed: 0.3682s/iter; left time: 15852.2138s
	iters: 200, epoch: 9 | loss: 0.2461572
	speed: 0.0772s/iter; left time: 3317.6686s
	iters: 300, epoch: 9 | loss: 0.6490598
	speed: 0.0819s/iter; left time: 3507.2396s
	iters: 400, epoch: 9 | loss: 0.2955388
	speed: 0.0830s/iter; left time: 3548.9059s
Epoch: 9 cost time: 38.932440519332886
Epoch: 9, Steps: 469 | Train Loss: 0.490 Vali Loss: 0.739 Vali Acc: 0.805 Test Loss: 0.739 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.4341268
	speed: 0.3782s/iter; left time: 16102.5813s
	iters: 200, epoch: 10 | loss: 0.3083674
	speed: 0.0802s/iter; left time: 3405.7677s
	iters: 300, epoch: 10 | loss: 0.3273950
	speed: 0.0821s/iter; left time: 3479.5048s
	iters: 400, epoch: 10 | loss: 0.5537971
	speed: 0.0814s/iter; left time: 3439.7130s
Epoch: 10 cost time: 37.7181441783905
Epoch: 10, Steps: 469 | Train Loss: 0.571 Vali Loss: 0.527 Vali Acc: 0.830 Test Loss: 0.527 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.4070987
	speed: 0.3726s/iter; left time: 15691.5235s
	iters: 200, epoch: 11 | loss: 1.3736180
	speed: 0.0884s/iter; left time: 3714.9832s
	iters: 300, epoch: 11 | loss: 0.2281644
	speed: 0.0796s/iter; left time: 3336.6146s
	iters: 400, epoch: 11 | loss: 0.4970463
	speed: 0.0772s/iter; left time: 3229.4425s
Epoch: 11 cost time: 39.31393885612488
Epoch: 11, Steps: 469 | Train Loss: 0.497 Vali Loss: 1.221 Vali Acc: 0.725 Test Loss: 1.221 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.8987993138936535
model parameter : 9254714
model size : 40.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2972173
	speed: 0.0976s/iter; left time: 4569.6807s
	iters: 200, epoch: 1 | loss: 0.1912585
	speed: 0.0727s/iter; left time: 3395.0701s
	iters: 300, epoch: 1 | loss: 0.0415566
	speed: 0.0754s/iter; left time: 3515.7552s
	iters: 400, epoch: 1 | loss: 0.0213192
	speed: 0.0745s/iter; left time: 3463.9130s
Epoch: 1 cost time: 37.12958526611328
Epoch: 1, Steps: 469 | Train Loss: 0.456 Vali Loss: 0.315 Vali Acc: 0.892 Test Loss: 0.315 Test Acc: 0.892
Validation loss decreased (inf --> -0.891649).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0324481
	speed: 0.3517s/iter; left time: 16296.3181s
	iters: 200, epoch: 2 | loss: 0.0350888
	speed: 0.0804s/iter; left time: 3718.8913s
	iters: 300, epoch: 2 | loss: 0.2366923
	speed: 0.0718s/iter; left time: 3310.6157s
	iters: 400, epoch: 2 | loss: 0.0194998
	speed: 0.0703s/iter; left time: 3236.3408s
Epoch: 2 cost time: 35.7284951210022
Epoch: 2, Steps: 469 | Train Loss: 0.244 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
Validation loss decreased (-0.891649 --> -0.943108).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4888375
	speed: 0.3497s/iter; left time: 16040.4509s
	iters: 200, epoch: 3 | loss: 0.1341106
	speed: 0.0754s/iter; left time: 3448.7078s
	iters: 300, epoch: 3 | loss: 0.1880466
	speed: 0.0791s/iter; left time: 3613.8762s
	iters: 400, epoch: 3 | loss: 0.0450098
	speed: 0.0745s/iter; left time: 3393.6225s
Epoch: 3 cost time: 35.73620843887329
Epoch: 3, Steps: 469 | Train Loss: 0.260 Vali Loss: 0.318 Vali Acc: 0.901 Test Loss: 0.318 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2144081
	speed: 0.3352s/iter; left time: 15215.8664s
	iters: 200, epoch: 4 | loss: 0.1394256
	speed: 0.0718s/iter; left time: 3252.0776s
	iters: 300, epoch: 4 | loss: 0.1067681
	speed: 0.0767s/iter; left time: 3466.4521s
	iters: 400, epoch: 4 | loss: 0.5807602
	speed: 0.0728s/iter; left time: 3282.5262s
Epoch: 4 cost time: 35.821011543273926
Epoch: 4, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1385892
	speed: 0.3395s/iter; left time: 15250.6167s
	iters: 200, epoch: 5 | loss: 0.5501521
	speed: 0.0783s/iter; left time: 3511.7815s
	iters: 300, epoch: 5 | loss: 0.3003809
	speed: 0.0761s/iter; left time: 3401.6210s
	iters: 400, epoch: 5 | loss: 0.6527006
	speed: 0.0720s/iter; left time: 3214.1911s
Epoch: 5 cost time: 35.835289001464844
Epoch: 5, Steps: 469 | Train Loss: 0.434 Vali Loss: 0.754 Vali Acc: 0.795 Test Loss: 0.754 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3508285
	speed: 0.3365s/iter; left time: 14961.4198s
	iters: 200, epoch: 6 | loss: 0.7482560
	speed: 0.0735s/iter; left time: 3261.5920s
	iters: 300, epoch: 6 | loss: 0.1630809
	speed: 0.0727s/iter; left time: 3216.3066s
	iters: 400, epoch: 6 | loss: 0.4237855
	speed: 0.0715s/iter; left time: 3155.7825s
Epoch: 6 cost time: 34.61198544502258
Epoch: 6, Steps: 469 | Train Loss: 0.562 Vali Loss: 0.452 Vali Acc: 0.887 Test Loss: 0.452 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4529773
	speed: 0.3495s/iter; left time: 15373.9380s
	iters: 200, epoch: 7 | loss: 1.4257421
	speed: 0.0762s/iter; left time: 3345.7019s
	iters: 300, epoch: 7 | loss: 0.2375910
	speed: 0.0740s/iter; left time: 3241.9070s
	iters: 400, epoch: 7 | loss: 0.1527185
	speed: 0.0750s/iter; left time: 3274.9543s
Epoch: 7 cost time: 36.96964502334595
Epoch: 7, Steps: 469 | Train Loss: 0.435 Vali Loss: 0.521 Vali Acc: 0.852 Test Loss: 0.521 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2669476
	speed: 0.3599s/iter; left time: 15662.2163s
	iters: 200, epoch: 8 | loss: 0.6958311
	speed: 0.0801s/iter; left time: 3476.3427s
	iters: 300, epoch: 8 | loss: 0.1004077
	speed: 0.0924s/iter; left time: 4001.1695s
	iters: 400, epoch: 8 | loss: 0.5034404
	speed: 0.0776s/iter; left time: 3351.6291s
Epoch: 8 cost time: 38.239991188049316
Epoch: 8, Steps: 469 | Train Loss: 0.450 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6368297
	speed: 0.3245s/iter; left time: 13969.5856s
	iters: 200, epoch: 9 | loss: 0.1166661
	speed: 0.0710s/iter; left time: 3050.7954s
	iters: 300, epoch: 9 | loss: 0.1986670
	speed: 0.0795s/iter; left time: 3406.1033s
	iters: 400, epoch: 9 | loss: 0.8988497
	speed: 0.0735s/iter; left time: 3142.0986s
Epoch: 9 cost time: 34.98251676559448
Epoch: 9, Steps: 469 | Train Loss: 0.323 Vali Loss: 0.416 Vali Acc: 0.881 Test Loss: 0.416 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7973450
	speed: 0.3420s/iter; left time: 14564.0905s
	iters: 200, epoch: 10 | loss: 0.3198879
	speed: 0.0694s/iter; left time: 2947.5862s
	iters: 300, epoch: 10 | loss: 0.1401903
	speed: 0.0711s/iter; left time: 3015.1859s
	iters: 400, epoch: 10 | loss: 0.1151797
	speed: 0.0689s/iter; left time: 2915.1393s
Epoch: 10 cost time: 33.2529821395874
Epoch: 10, Steps: 469 | Train Loss: 0.301 Vali Loss: 0.340 Vali Acc: 0.905 Test Loss: 0.340 Test Acc: 0.905
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4706649
	speed: 0.3223s/iter; left time: 13571.2851s
	iters: 200, epoch: 11 | loss: 1.3274938
	speed: 0.0684s/iter; left time: 2872.8879s
	iters: 300, epoch: 11 | loss: 0.1315483
	speed: 0.0697s/iter; left time: 2919.4246s
	iters: 400, epoch: 11 | loss: 0.1841274
	speed: 0.0681s/iter; left time: 2847.9535s
Epoch: 11 cost time: 32.62354040145874
Epoch: 11, Steps: 469 | Train Loss: 0.288 Vali Loss: 0.599 Vali Acc: 0.857 Test Loss: 0.599 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0556362
	speed: 0.3252s/iter; left time: 13542.7964s
	iters: 200, epoch: 12 | loss: 0.1041180
	speed: 0.0689s/iter; left time: 2862.3472s
	iters: 300, epoch: 12 | loss: 0.6573336
	speed: 0.0766s/iter; left time: 3173.4981s
	iters: 400, epoch: 12 | loss: 0.0184413
	speed: 0.0738s/iter; left time: 3052.4812s
Epoch: 12 cost time: 34.64428639411926
Epoch: 12, Steps: 469 | Train Loss: 0.279 Vali Loss: 0.336 Vali Acc: 0.894 Test Loss: 0.336 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9431103487707261
model parameter : 9253946
model size : 40.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3447644
	speed: 0.0869s/iter; left time: 4067.7211s
	iters: 200, epoch: 1 | loss: 0.1454781
	speed: 0.0709s/iter; left time: 3311.7621s
	iters: 300, epoch: 1 | loss: 0.5442007
	speed: 0.0681s/iter; left time: 3174.2137s
	iters: 400, epoch: 1 | loss: 0.3464153
	speed: 0.0700s/iter; left time: 3255.4819s
Epoch: 1 cost time: 34.35705256462097
Epoch: 1, Steps: 469 | Train Loss: 0.442 Vali Loss: 0.408 Vali Acc: 0.859 Test Loss: 0.408 Test Acc: 0.859
Validation loss decreased (inf --> -0.859344).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4790967
	speed: 0.3138s/iter; left time: 14539.8241s
	iters: 200, epoch: 2 | loss: 0.2167666
	speed: 0.0654s/iter; left time: 3023.7903s
	iters: 300, epoch: 2 | loss: 0.2140024
	speed: 0.0684s/iter; left time: 3154.5900s
	iters: 400, epoch: 2 | loss: 0.4950822
	speed: 0.0661s/iter; left time: 3044.7316s
Epoch: 2 cost time: 31.858782052993774
Epoch: 2, Steps: 469 | Train Loss: 0.253 Vali Loss: 0.427 Vali Acc: 0.901 Test Loss: 0.427 Test Acc: 0.901
Validation loss decreased (-0.859344 --> -0.900796).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0805012
	speed: 0.3332s/iter; left time: 15279.5856s
	iters: 200, epoch: 3 | loss: 0.0713054
	speed: 0.0736s/iter; left time: 3368.0566s
	iters: 300, epoch: 3 | loss: 0.2428607
	speed: 0.0721s/iter; left time: 3292.1918s
	iters: 400, epoch: 3 | loss: 0.2744176
	speed: 0.0649s/iter; left time: 2957.4027s
Epoch: 3 cost time: 33.830891132354736
Epoch: 3, Steps: 469 | Train Loss: 0.240 Vali Loss: 0.442 Vali Acc: 0.868 Test Loss: 0.442 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4289567
	speed: 0.3200s/iter; left time: 14524.8461s
	iters: 200, epoch: 4 | loss: 0.3581968
	speed: 0.0745s/iter; left time: 3373.9821s
	iters: 300, epoch: 4 | loss: 0.0515775
	speed: 0.0741s/iter; left time: 3347.5896s
	iters: 400, epoch: 4 | loss: 0.1135760
	speed: 0.0731s/iter; left time: 3294.2142s
Epoch: 4 cost time: 34.51775360107422
Epoch: 4, Steps: 469 | Train Loss: 0.235 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
Validation loss decreased (-0.900796 --> -0.942250).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0811424
	speed: 0.3421s/iter; left time: 15370.9112s
	iters: 200, epoch: 5 | loss: 0.0470349
	speed: 0.0732s/iter; left time: 3279.9256s
	iters: 300, epoch: 5 | loss: 0.2479293
	speed: 0.0777s/iter; left time: 3475.1485s
	iters: 400, epoch: 5 | loss: 0.0731229
	speed: 0.0725s/iter; left time: 3234.4601s
Epoch: 5 cost time: 35.246411085128784
Epoch: 5, Steps: 469 | Train Loss: 0.251 Vali Loss: 0.388 Vali Acc: 0.890 Test Loss: 0.388 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0993744
	speed: 0.3366s/iter; left time: 14961.8560s
	iters: 200, epoch: 6 | loss: 0.7417171
	speed: 0.0716s/iter; left time: 3176.8383s
	iters: 300, epoch: 6 | loss: 0.0467789
	speed: 0.0692s/iter; left time: 3060.8258s
	iters: 400, epoch: 6 | loss: 0.4407859
	speed: 0.0675s/iter; left time: 2980.9657s
Epoch: 6 cost time: 33.29504036903381
Epoch: 6, Steps: 469 | Train Loss: 0.221 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0559722
	speed: 0.3145s/iter; left time: 13832.0165s
	iters: 200, epoch: 7 | loss: 0.2452030
	speed: 0.0732s/iter; left time: 3211.1753s
	iters: 300, epoch: 7 | loss: 0.0481705
	speed: 0.0744s/iter; left time: 3258.1760s
	iters: 400, epoch: 7 | loss: 0.0983708
	speed: 0.0704s/iter; left time: 3076.3896s
Epoch: 7 cost time: 33.65219044685364
Epoch: 7, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.527 Vali Acc: 0.802 Test Loss: 0.527 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0076771
	speed: 0.3214s/iter; left time: 13987.9486s
	iters: 200, epoch: 8 | loss: 0.2053323
	speed: 0.0797s/iter; left time: 3460.2829s
	iters: 300, epoch: 8 | loss: 1.0793898
	speed: 0.0786s/iter; left time: 3405.3655s
	iters: 400, epoch: 8 | loss: 0.0398201
	speed: 0.0762s/iter; left time: 3291.9063s
Epoch: 8 cost time: 36.01614284515381
Epoch: 8, Steps: 469 | Train Loss: 0.206 Vali Loss: 0.198 Vali Acc: 0.945 Test Loss: 0.198 Test Acc: 0.945
Validation loss decreased (-0.942250 --> -0.945110).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1266696
	speed: 0.3128s/iter; left time: 13465.8808s
	iters: 200, epoch: 9 | loss: 0.0795631
	speed: 0.0721s/iter; left time: 3095.4036s
	iters: 300, epoch: 9 | loss: 0.0536069
	speed: 0.0654s/iter; left time: 2800.7292s
	iters: 400, epoch: 9 | loss: 0.0735692
	speed: 0.0698s/iter; left time: 2983.2080s
Epoch: 9 cost time: 32.60491728782654
Epoch: 9, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0184610
	speed: 0.3178s/iter; left time: 13532.0833s
	iters: 200, epoch: 10 | loss: 0.1062444
	speed: 0.0711s/iter; left time: 3019.8671s
	iters: 300, epoch: 10 | loss: 0.0542578
	speed: 0.0667s/iter; left time: 2825.6633s
	iters: 400, epoch: 10 | loss: 0.0349366
	speed: 0.0653s/iter; left time: 2758.8515s
Epoch: 10 cost time: 32.713340520858765
Epoch: 10, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.261 Vali Acc: 0.936 Test Loss: 0.261 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8090792
	speed: 0.3129s/iter; left time: 13177.0687s
	iters: 200, epoch: 11 | loss: 0.0381324
	speed: 0.0643s/iter; left time: 2700.6637s
	iters: 300, epoch: 11 | loss: 0.0581798
	speed: 0.0648s/iter; left time: 2714.8650s
	iters: 400, epoch: 11 | loss: 0.0127216
	speed: 0.0642s/iter; left time: 2682.8428s
Epoch: 11 cost time: 31.088013887405396
Epoch: 11, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0779014
	speed: 0.3201s/iter; left time: 13330.2924s
	iters: 200, epoch: 12 | loss: 0.0729105
	speed: 0.0635s/iter; left time: 2636.8348s
	iters: 300, epoch: 12 | loss: 0.3085228
	speed: 0.0685s/iter; left time: 2837.8878s
	iters: 400, epoch: 12 | loss: 0.3629378
	speed: 0.0646s/iter; left time: 2671.6571s
Epoch: 12 cost time: 31.24453616142273
Epoch: 12, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0479296
	speed: 0.3105s/iter; left time: 12783.6263s
	iters: 200, epoch: 13 | loss: 0.0591636
	speed: 0.0657s/iter; left time: 2698.0089s
	iters: 300, epoch: 13 | loss: 0.0102782
	speed: 0.0654s/iter; left time: 2679.0240s
	iters: 400, epoch: 13 | loss: 0.4644500
	speed: 0.0678s/iter; left time: 2771.7295s
Epoch: 13 cost time: 31.724756479263306
Epoch: 13, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2012451
	speed: 0.3138s/iter; left time: 12773.8131s
	iters: 200, epoch: 14 | loss: 0.1571778
	speed: 0.0684s/iter; left time: 2777.3444s
	iters: 300, epoch: 14 | loss: 0.0314160
	speed: 0.0722s/iter; left time: 2925.3497s
	iters: 400, epoch: 14 | loss: 0.0038238
	speed: 0.0732s/iter; left time: 2957.8438s
Epoch: 14 cost time: 33.336392641067505
Epoch: 14, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.370 Vali Acc: 0.928 Test Loss: 0.370 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1272109
	speed: 0.3374s/iter; left time: 13575.2743s
	iters: 200, epoch: 15 | loss: 0.1919351
	speed: 0.0695s/iter; left time: 2791.2631s
	iters: 300, epoch: 15 | loss: 0.4383258
	speed: 0.0736s/iter; left time: 2946.5916s
	iters: 400, epoch: 15 | loss: 0.0806954
	speed: 0.0705s/iter; left time: 2816.9359s
Epoch: 15 cost time: 33.49137759208679
Epoch: 15, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0518686
	speed: 0.3209s/iter; left time: 12762.5048s
	iters: 200, epoch: 16 | loss: 0.0149839
	speed: 0.0676s/iter; left time: 2680.7123s
	iters: 300, epoch: 16 | loss: 0.0267009
	speed: 0.0713s/iter; left time: 2820.0458s
	iters: 400, epoch: 16 | loss: 0.0330104
	speed: 0.0659s/iter; left time: 2599.8079s
Epoch: 16 cost time: 32.160876750946045
Epoch: 16, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.945110 --> -0.952257).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0786609
	speed: 0.3304s/iter; left time: 12982.6840s
	iters: 200, epoch: 17 | loss: 0.0077838
	speed: 0.0740s/iter; left time: 2900.4845s
	iters: 300, epoch: 17 | loss: 0.0452338
	speed: 0.0678s/iter; left time: 2650.9236s
	iters: 400, epoch: 17 | loss: 0.0567434
	speed: 0.0691s/iter; left time: 2693.8917s
Epoch: 17 cost time: 33.742348432540894
Epoch: 17, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2499162
	speed: 0.3206s/iter; left time: 12449.7038s
	iters: 200, epoch: 18 | loss: 0.0238737
	speed: 0.0682s/iter; left time: 2642.1567s
	iters: 300, epoch: 18 | loss: 0.1253991
	speed: 0.0652s/iter; left time: 2520.1546s
	iters: 400, epoch: 18 | loss: 0.0331758
	speed: 0.0644s/iter; left time: 2483.0805s
Epoch: 18 cost time: 32.09341382980347
Epoch: 18, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
Validation loss decreased (-0.952257 --> -0.960833).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5102892
	speed: 0.3015s/iter; left time: 11566.1247s
	iters: 200, epoch: 19 | loss: 0.0791521
	speed: 0.0700s/iter; left time: 2677.8890s
	iters: 300, epoch: 19 | loss: 0.1194525
	speed: 0.0715s/iter; left time: 2727.4666s
	iters: 400, epoch: 19 | loss: 0.0706049
	speed: 0.0655s/iter; left time: 2492.2553s
Epoch: 19 cost time: 32.855987787246704
Epoch: 19, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0707457
	speed: 0.3151s/iter; left time: 11939.9213s
	iters: 200, epoch: 20 | loss: 0.0965992
	speed: 0.0668s/iter; left time: 2526.0423s
	iters: 300, epoch: 20 | loss: 0.0321889
	speed: 0.0674s/iter; left time: 2541.1129s
	iters: 400, epoch: 20 | loss: 0.0100424
	speed: 0.0659s/iter; left time: 2477.7308s
Epoch: 20 cost time: 32.32373929023743
Epoch: 20, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0191428
	speed: 0.3012s/iter; left time: 11269.8197s
	iters: 200, epoch: 21 | loss: 0.0663614
	speed: 0.0673s/iter; left time: 2511.1783s
	iters: 300, epoch: 21 | loss: 0.0053158
	speed: 0.0682s/iter; left time: 2538.8101s
	iters: 400, epoch: 21 | loss: 0.0289473
	speed: 0.0655s/iter; left time: 2431.3375s
Epoch: 21 cost time: 31.26786732673645
Epoch: 21, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.960833 --> -0.961691).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0031457
	speed: 0.2689s/iter; left time: 9936.4074s
	iters: 200, epoch: 22 | loss: 0.0775671
	speed: 0.0706s/iter; left time: 2600.2755s
	iters: 300, epoch: 22 | loss: 0.2752965
	speed: 0.0649s/iter; left time: 2385.1264s
	iters: 400, epoch: 22 | loss: 0.0083739
	speed: 0.0630s/iter; left time: 2308.4142s
Epoch: 22 cost time: 31.166471481323242
Epoch: 22, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.303 Vali Acc: 0.912 Test Loss: 0.303 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0095190
	speed: 0.3156s/iter; left time: 11513.4122s
	iters: 200, epoch: 23 | loss: 0.0909127
	speed: 0.0670s/iter; left time: 2437.1435s
	iters: 300, epoch: 23 | loss: 0.0258565
	speed: 0.0728s/iter; left time: 2639.7148s
	iters: 400, epoch: 23 | loss: 0.1663165
	speed: 0.0722s/iter; left time: 2612.5636s
Epoch: 23 cost time: 33.485252380371094
Epoch: 23, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0817810
	speed: 0.3251s/iter; left time: 11706.5836s
	iters: 200, epoch: 24 | loss: 0.0052938
	speed: 0.0719s/iter; left time: 2582.6567s
	iters: 300, epoch: 24 | loss: 0.0328878
	speed: 0.0689s/iter; left time: 2468.2847s
	iters: 400, epoch: 24 | loss: 0.0044748
	speed: 0.0711s/iter; left time: 2539.9656s
Epoch: 24 cost time: 33.76608753204346
Epoch: 24, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0695036
	speed: 0.3379s/iter; left time: 12010.7926s
	iters: 200, epoch: 25 | loss: 0.1674796
	speed: 0.0708s/iter; left time: 2510.9941s
	iters: 300, epoch: 25 | loss: 0.0147278
	speed: 0.0714s/iter; left time: 2523.6359s
	iters: 400, epoch: 25 | loss: 0.0080026
	speed: 0.0733s/iter; left time: 2583.9161s
Epoch: 25 cost time: 34.1393609046936
Epoch: 25, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0028385
	speed: 0.3167s/iter; left time: 11109.6486s
	iters: 200, epoch: 26 | loss: 0.0210981
	speed: 0.0683s/iter; left time: 2390.3329s
	iters: 300, epoch: 26 | loss: 0.0090237
	speed: 0.0733s/iter; left time: 2557.5535s
	iters: 400, epoch: 26 | loss: 0.0027944
	speed: 0.0691s/iter; left time: 2402.4957s
Epoch: 26 cost time: 33.40809416770935
Epoch: 26, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.256 Vali Acc: 0.949 Test Loss: 0.256 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0589879
	speed: 0.3174s/iter; left time: 10982.8787s
	iters: 200, epoch: 27 | loss: 0.0044504
	speed: 0.0766s/iter; left time: 2641.6376s
	iters: 300, epoch: 27 | loss: 0.0130706
	speed: 0.0719s/iter; left time: 2475.2628s
	iters: 400, epoch: 27 | loss: 0.0346584
	speed: 0.0709s/iter; left time: 2431.6351s
Epoch: 27 cost time: 35.18656396865845
Epoch: 27, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0111826
	speed: 0.3374s/iter; left time: 11518.3454s
	iters: 200, epoch: 28 | loss: 0.0071519
	speed: 0.0730s/iter; left time: 2484.6268s
	iters: 300, epoch: 28 | loss: 0.0747999
	speed: 0.0711s/iter; left time: 2411.4173s
	iters: 400, epoch: 28 | loss: 0.0689604
	speed: 0.0743s/iter; left time: 2514.3533s
Epoch: 28 cost time: 34.34649848937988
Epoch: 28, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0275276
	speed: 0.3348s/iter; left time: 11272.5031s
	iters: 200, epoch: 29 | loss: 0.0126395
	speed: 0.0728s/iter; left time: 2444.3862s
	iters: 300, epoch: 29 | loss: 0.1293668
	speed: 0.0727s/iter; left time: 2432.0535s
	iters: 400, epoch: 29 | loss: 0.2461119
	speed: 0.0733s/iter; left time: 2447.3827s
Epoch: 29 cost time: 35.67948079109192
Epoch: 29, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.961691 --> -0.964550).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0144040
	speed: 0.3375s/iter; left time: 11204.4663s
	iters: 200, epoch: 30 | loss: 0.1232580
	speed: 0.0740s/iter; left time: 2448.2345s
	iters: 300, epoch: 30 | loss: 0.0301164
	speed: 0.0747s/iter; left time: 2465.9535s
	iters: 400, epoch: 30 | loss: 0.2907203
	speed: 0.0749s/iter; left time: 2462.6686s
Epoch: 30 cost time: 35.17348003387451
Epoch: 30, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
Validation loss decreased (-0.964550 --> -0.965693).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0892513
	speed: 0.3232s/iter; left time: 10578.5758s
	iters: 200, epoch: 31 | loss: 0.1801163
	speed: 0.0671s/iter; left time: 2191.0660s
	iters: 300, epoch: 31 | loss: 0.0146774
	speed: 0.0688s/iter; left time: 2238.0277s
	iters: 400, epoch: 31 | loss: 0.1162271
	speed: 0.0704s/iter; left time: 2283.5425s
Epoch: 31 cost time: 32.566901206970215
Epoch: 31, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0014095
	speed: 0.3334s/iter; left time: 10756.6316s
	iters: 200, epoch: 32 | loss: 0.0019994
	speed: 0.0780s/iter; left time: 2508.1545s
	iters: 300, epoch: 32 | loss: 0.0059164
	speed: 0.0724s/iter; left time: 2320.0505s
	iters: 400, epoch: 32 | loss: 0.0009289
	speed: 0.0745s/iter; left time: 2380.0253s
Epoch: 32 cost time: 36.34233593940735
Epoch: 32, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.955 Test Loss: 0.210 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.4034511
	speed: 0.3511s/iter; left time: 11163.8515s
	iters: 200, epoch: 33 | loss: 0.1499079
	speed: 0.0756s/iter; left time: 2394.7655s
	iters: 300, epoch: 33 | loss: 0.0499983
	speed: 0.0760s/iter; left time: 2401.1583s
	iters: 400, epoch: 33 | loss: 0.0174847
	speed: 0.0757s/iter; left time: 2384.2482s
Epoch: 33 cost time: 36.27726435661316
Epoch: 33, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0560268
	speed: 0.3348s/iter; left time: 10486.9105s
	iters: 200, epoch: 34 | loss: 0.0382133
	speed: 0.0765s/iter; left time: 2388.4904s
	iters: 300, epoch: 34 | loss: 0.0067379
	speed: 0.0734s/iter; left time: 2283.8049s
	iters: 400, epoch: 34 | loss: 0.0022787
	speed: 0.0743s/iter; left time: 2306.3460s
Epoch: 34 cost time: 35.40408205986023
Epoch: 34, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0037331
	speed: 0.3000s/iter; left time: 9255.6543s
	iters: 200, epoch: 35 | loss: 0.0117819
	speed: 0.0739s/iter; left time: 2273.2139s
	iters: 300, epoch: 35 | loss: 0.0083457
	speed: 0.0719s/iter; left time: 2204.7438s
	iters: 400, epoch: 35 | loss: 0.0132727
	speed: 0.0685s/iter; left time: 2094.3943s
Epoch: 35 cost time: 33.90212845802307
Epoch: 35, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0827998
	speed: 0.3095s/iter; left time: 9403.2157s
	iters: 200, epoch: 36 | loss: 0.3608753
	speed: 0.0715s/iter; left time: 2165.9471s
	iters: 300, epoch: 36 | loss: 0.0012564
	speed: 0.0710s/iter; left time: 2142.2722s
	iters: 400, epoch: 36 | loss: 0.0082936
	speed: 0.0729s/iter; left time: 2193.4470s
Epoch: 36 cost time: 33.7661030292511
Epoch: 36, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0023558
	speed: 0.3283s/iter; left time: 9821.4959s
	iters: 200, epoch: 37 | loss: 0.0132750
	speed: 0.0677s/iter; left time: 2019.3037s
	iters: 300, epoch: 37 | loss: 0.0347709
	speed: 0.0693s/iter; left time: 2059.3002s
	iters: 400, epoch: 37 | loss: 0.2298374
	speed: 0.0740s/iter; left time: 2191.5119s
Epoch: 37 cost time: 33.61601424217224
Epoch: 37, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.2952002
	speed: 0.3289s/iter; left time: 9684.9414s
	iters: 200, epoch: 38 | loss: 0.0066035
	speed: 0.0665s/iter; left time: 1951.3478s
	iters: 300, epoch: 38 | loss: 0.0042715
	speed: 0.0677s/iter; left time: 1979.9883s
	iters: 400, epoch: 38 | loss: 0.0124366
	speed: 0.0665s/iter; left time: 1939.7696s
Epoch: 38 cost time: 32.71612191200256
Epoch: 38, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0306725
	speed: 0.3264s/iter; left time: 9457.8899s
	iters: 200, epoch: 39 | loss: 0.0022849
	speed: 0.0700s/iter; left time: 2022.5251s
	iters: 300, epoch: 39 | loss: 0.0030611
	speed: 0.0733s/iter; left time: 2109.0967s
	iters: 400, epoch: 39 | loss: 0.0271243
	speed: 0.0771s/iter; left time: 2211.3243s
Epoch: 39 cost time: 34.705525398254395
Epoch: 39, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.965693 --> -0.972269).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0015854
	speed: 0.3211s/iter; left time: 9155.7964s
	iters: 200, epoch: 40 | loss: 0.0012992
	speed: 0.0669s/iter; left time: 1900.0856s
	iters: 300, epoch: 40 | loss: 0.0029008
	speed: 0.0706s/iter; left time: 1999.7820s
	iters: 400, epoch: 40 | loss: 0.0054481
	speed: 0.0706s/iter; left time: 1992.2088s
Epoch: 40 cost time: 33.07091021537781
Epoch: 40, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.234 Vali Acc: 0.953 Test Loss: 0.234 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0048139
	speed: 0.3357s/iter; left time: 9414.5585s
	iters: 200, epoch: 41 | loss: 0.0271068
	speed: 0.0756s/iter; left time: 2112.8758s
	iters: 300, epoch: 41 | loss: 0.0608408
	speed: 0.0771s/iter; left time: 2145.7408s
	iters: 400, epoch: 41 | loss: 0.0010808
	speed: 0.0714s/iter; left time: 1980.3224s
Epoch: 41 cost time: 35.78012657165527
Epoch: 41, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.0064940
	speed: 0.3437s/iter; left time: 9476.2130s
	iters: 200, epoch: 42 | loss: 0.0233369
	speed: 0.0833s/iter; left time: 2289.4876s
	iters: 300, epoch: 42 | loss: 0.0428429
	speed: 0.0865s/iter; left time: 2366.4118s
	iters: 400, epoch: 42 | loss: 0.0027323
	speed: 0.0846s/iter; left time: 2306.6627s
Epoch: 42 cost time: 39.6496787071228
Epoch: 42, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0003338
	speed: 0.3443s/iter; left time: 9331.9548s
	iters: 200, epoch: 43 | loss: 0.0102389
	speed: 0.0745s/iter; left time: 2012.7309s
	iters: 300, epoch: 43 | loss: 0.2261221
	speed: 0.0714s/iter; left time: 1921.5314s
	iters: 400, epoch: 43 | loss: 0.1586199
	speed: 0.0693s/iter; left time: 1856.2911s
Epoch: 43 cost time: 34.27656030654907
Epoch: 43, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.1446321
	speed: 0.3187s/iter; left time: 8489.0511s
	iters: 200, epoch: 44 | loss: 0.1375286
	speed: 0.0671s/iter; left time: 1779.7575s
	iters: 300, epoch: 44 | loss: 0.0002834
	speed: 0.0681s/iter; left time: 1799.2027s
	iters: 400, epoch: 44 | loss: 0.0766012
	speed: 0.0703s/iter; left time: 1852.1908s
Epoch: 44 cost time: 32.72253108024597
Epoch: 44, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.0626105
	speed: 0.3329s/iter; left time: 8710.8248s
	iters: 200, epoch: 45 | loss: 0.0070354
	speed: 0.0719s/iter; left time: 1875.2899s
	iters: 300, epoch: 45 | loss: 0.0400208
	speed: 0.0705s/iter; left time: 1829.2351s
	iters: 400, epoch: 45 | loss: 0.0409214
	speed: 0.0761s/iter; left time: 1968.3224s
Epoch: 45 cost time: 35.215089082717896
Epoch: 45, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.0273108
	speed: 0.3266s/iter; left time: 8392.0816s
	iters: 200, epoch: 46 | loss: 0.0010498
	speed: 0.0735s/iter; left time: 1881.3575s
	iters: 300, epoch: 46 | loss: 0.0171942
	speed: 0.0706s/iter; left time: 1800.1201s
	iters: 400, epoch: 46 | loss: 0.0075110
	speed: 0.0711s/iter; left time: 1805.9908s
Epoch: 46 cost time: 33.90445566177368
Epoch: 46, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.267 Vali Acc: 0.945 Test Loss: 0.267 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.0012720
	speed: 0.3232s/iter; left time: 8152.3402s
	iters: 200, epoch: 47 | loss: 0.2515285
	speed: 0.0718s/iter; left time: 1804.6629s
	iters: 300, epoch: 47 | loss: 0.0494931
	speed: 0.0712s/iter; left time: 1781.5718s
	iters: 400, epoch: 47 | loss: 0.0588253
	speed: 0.0723s/iter; left time: 1803.1978s
Epoch: 47 cost time: 34.07448625564575
Epoch: 47, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.0358170
	speed: 0.3437s/iter; left time: 8509.4153s
	iters: 200, epoch: 48 | loss: 0.1129236
	speed: 0.0658s/iter; left time: 1623.0774s
	iters: 300, epoch: 48 | loss: 0.0048186
	speed: 0.0679s/iter; left time: 1668.4422s
	iters: 400, epoch: 48 | loss: 0.0489192
	speed: 0.0652s/iter; left time: 1595.1665s
Epoch: 48 cost time: 32.23629903793335
Epoch: 48, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.0023050
	speed: 0.2986s/iter; left time: 7252.2433s
	iters: 200, epoch: 49 | loss: 0.1300467
	speed: 0.0745s/iter; left time: 1802.6580s
	iters: 300, epoch: 49 | loss: 0.0167167
	speed: 0.0753s/iter; left time: 1813.8829s
	iters: 400, epoch: 49 | loss: 0.1125727
	speed: 0.0718s/iter; left time: 1722.1698s
Epoch: 49 cost time: 34.53522539138794
Epoch: 49, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9722698684962836
model parameter : 9253178
model size : 40.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2163549
	speed: 0.0911s/iter; left time: 4265.4319s
	iters: 200, epoch: 1 | loss: 0.1425014
	speed: 0.0728s/iter; left time: 3397.6302s
	iters: 300, epoch: 1 | loss: 0.1867152
	speed: 0.0706s/iter; left time: 3291.2908s
	iters: 400, epoch: 1 | loss: 0.6798623
	speed: 0.0685s/iter; left time: 3184.4867s
Epoch: 1 cost time: 35.029117584228516
Epoch: 1, Steps: 469 | Train Loss: 0.448 Vali Loss: 0.342 Vali Acc: 0.873 Test Loss: 0.342 Test Acc: 0.873
Validation loss decreased (inf --> -0.872781).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2998727
	speed: 0.3417s/iter; left time: 15829.4578s
	iters: 200, epoch: 2 | loss: 0.3498375
	speed: 0.0730s/iter; left time: 3375.8373s
	iters: 300, epoch: 2 | loss: 0.8873002
	speed: 0.0719s/iter; left time: 3318.6274s
	iters: 400, epoch: 2 | loss: 0.7569404
	speed: 0.0678s/iter; left time: 3122.9889s
Epoch: 2 cost time: 34.55969452857971
Epoch: 2, Steps: 469 | Train Loss: 0.260 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.872781 --> -0.937105).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1368817
	speed: 0.3395s/iter; left time: 15569.0961s
	iters: 200, epoch: 3 | loss: 0.0659750
	speed: 0.0710s/iter; left time: 3249.2331s
	iters: 300, epoch: 3 | loss: 0.2416385
	speed: 0.0711s/iter; left time: 3246.7030s
	iters: 400, epoch: 3 | loss: 0.1516705
	speed: 0.0675s/iter; left time: 3075.5039s
Epoch: 3 cost time: 33.85552430152893
Epoch: 3, Steps: 469 | Train Loss: 0.235 Vali Loss: 0.358 Vali Acc: 0.890 Test Loss: 0.358 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0276238
	speed: 0.3199s/iter; left time: 14521.1007s
	iters: 200, epoch: 4 | loss: 0.0172186
	speed: 0.0670s/iter; left time: 3034.9691s
	iters: 300, epoch: 4 | loss: 0.2949377
	speed: 0.0645s/iter; left time: 2916.9046s
	iters: 400, epoch: 4 | loss: 0.1731192
	speed: 0.0663s/iter; left time: 2990.5701s
Epoch: 4 cost time: 32.360684633255005
Epoch: 4, Steps: 469 | Train Loss: 0.298 Vali Loss: 0.513 Vali Acc: 0.840 Test Loss: 0.513 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1422778
	speed: 0.3148s/iter; left time: 14143.7840s
	iters: 200, epoch: 5 | loss: 0.3013640
	speed: 0.0690s/iter; left time: 3092.6283s
	iters: 300, epoch: 5 | loss: 0.7869692
	speed: 0.0692s/iter; left time: 3094.2939s
	iters: 400, epoch: 5 | loss: 0.8700536
	speed: 0.0697s/iter; left time: 3111.1786s
Epoch: 5 cost time: 33.52979636192322
Epoch: 5, Steps: 469 | Train Loss: 0.551 Vali Loss: 1.346 Vali Acc: 0.615 Test Loss: 1.346 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5146732
	speed: 0.3199s/iter; left time: 14221.5450s
	iters: 200, epoch: 6 | loss: 1.2956400
	speed: 0.0677s/iter; left time: 3002.1267s
	iters: 300, epoch: 6 | loss: 0.7419951
	speed: 0.0682s/iter; left time: 3017.9717s
	iters: 400, epoch: 6 | loss: 2.0123358
	speed: 0.0656s/iter; left time: 2897.3001s
Epoch: 6 cost time: 31.846452236175537
Epoch: 6, Steps: 469 | Train Loss: 1.069 Vali Loss: 2.288 Vali Acc: 0.333 Test Loss: 2.288 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.2577691
	speed: 0.2956s/iter; left time: 13003.3089s
	iters: 200, epoch: 7 | loss: 2.4364829
	speed: 0.0682s/iter; left time: 2991.9567s
	iters: 300, epoch: 7 | loss: 2.2912714
	speed: 0.0671s/iter; left time: 2936.3923s
	iters: 400, epoch: 7 | loss: 2.3429985
	speed: 0.0659s/iter; left time: 2876.9050s
Epoch: 7 cost time: 31.798736095428467
Epoch: 7, Steps: 469 | Train Loss: 2.321 Vali Loss: 2.334 Vali Acc: 0.096 Test Loss: 2.334 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3227816
	speed: 0.2973s/iter; left time: 12939.7445s
	iters: 200, epoch: 8 | loss: 2.2507448
	speed: 0.0691s/iter; left time: 3001.0594s
	iters: 300, epoch: 8 | loss: 2.3024902
	speed: 0.0664s/iter; left time: 2877.9499s
	iters: 400, epoch: 8 | loss: 2.3617904
	speed: 0.0674s/iter; left time: 2914.6007s
Epoch: 8 cost time: 32.552046060562134
Epoch: 8, Steps: 469 | Train Loss: 2.328 Vali Loss: 2.310 Vali Acc: 0.096 Test Loss: 2.310 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3240502
	speed: 0.3045s/iter; left time: 13110.4754s
	iters: 200, epoch: 9 | loss: 2.2871296
	speed: 0.0693s/iter; left time: 2977.3425s
	iters: 300, epoch: 9 | loss: 2.3303299
	speed: 0.0729s/iter; left time: 3124.0650s
	iters: 400, epoch: 9 | loss: 2.2437098
	speed: 0.0658s/iter; left time: 2814.6406s
Epoch: 9 cost time: 32.695409536361694
Epoch: 9, Steps: 469 | Train Loss: 2.312 Vali Loss: 2.318 Vali Acc: 0.104 Test Loss: 2.318 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2718570
	speed: 0.3226s/iter; left time: 13735.4794s
	iters: 200, epoch: 10 | loss: 2.2699313
	speed: 0.0731s/iter; left time: 3104.1283s
	iters: 300, epoch: 10 | loss: 2.3552227
	speed: 0.0718s/iter; left time: 3044.6855s
	iters: 400, epoch: 10 | loss: 2.2942846
	speed: 0.0733s/iter; left time: 3097.1507s
Epoch: 10 cost time: 34.73975229263306
Epoch: 10, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.304 Vali Acc: 0.096 Test Loss: 2.304 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.2982745
	speed: 0.3274s/iter; left time: 13785.1146s
	iters: 200, epoch: 11 | loss: 2.2969439
	speed: 0.0690s/iter; left time: 2899.1532s
	iters: 300, epoch: 11 | loss: 2.3184488
	speed: 0.0701s/iter; left time: 2940.0035s
	iters: 400, epoch: 11 | loss: 2.3012862
	speed: 0.0691s/iter; left time: 2888.1637s
Epoch: 11 cost time: 32.800835609436035
Epoch: 11, Steps: 469 | Train Loss: 2.309 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.2806895
	speed: 0.3216s/iter; left time: 13392.2001s
	iters: 200, epoch: 12 | loss: 2.3289552
	speed: 0.0716s/iter; left time: 2975.8108s
	iters: 300, epoch: 12 | loss: 2.2858806
	speed: 0.0755s/iter; left time: 3128.4851s
	iters: 400, epoch: 12 | loss: 2.3088632
	speed: 0.0718s/iter; left time: 2969.9801s
Epoch: 12 cost time: 34.83704662322998
Epoch: 12, Steps: 469 | Train Loss: 2.308 Vali Loss: 2.304 Vali Acc: 0.104 Test Loss: 2.304 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9371069182389937
model parameter : 8336186
model size : 36.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3087467
	speed: 0.0937s/iter; left time: 4387.5694s
	iters: 200, epoch: 1 | loss: 0.0287333
	speed: 0.0707s/iter; left time: 3300.1452s
	iters: 300, epoch: 1 | loss: 0.5364381
	speed: 0.0726s/iter; left time: 3385.2562s
	iters: 400, epoch: 1 | loss: 0.0747622
	speed: 0.0693s/iter; left time: 3220.6847s
Epoch: 1 cost time: 35.460763692855835
Epoch: 1, Steps: 469 | Train Loss: 0.441 Vali Loss: 0.388 Vali Acc: 0.858 Test Loss: 0.388 Test Acc: 0.858
Validation loss decreased (inf --> -0.858201).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4876245
	speed: 0.3122s/iter; left time: 14465.0886s
	iters: 200, epoch: 2 | loss: 0.2121720
	speed: 0.0653s/iter; left time: 3018.7877s
	iters: 300, epoch: 2 | loss: 0.1837605
	speed: 0.0699s/iter; left time: 3226.1066s
	iters: 400, epoch: 2 | loss: 0.2032049
	speed: 0.0732s/iter; left time: 3368.4028s
Epoch: 2 cost time: 33.609389543533325
Epoch: 2, Steps: 469 | Train Loss: 0.243 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
Validation loss decreased (-0.858201 --> -0.870206).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2312113
	speed: 0.3284s/iter; left time: 15059.8879s
	iters: 200, epoch: 3 | loss: 0.0369662
	speed: 0.0675s/iter; left time: 3087.9200s
	iters: 300, epoch: 3 | loss: 0.0569575
	speed: 0.0668s/iter; left time: 3051.6283s
	iters: 400, epoch: 3 | loss: 0.5638399
	speed: 0.0700s/iter; left time: 3188.2230s
Epoch: 3 cost time: 32.27535939216614
Epoch: 3, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
Validation loss decreased (-0.870206 --> -0.926813).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4033545
	speed: 0.3161s/iter; left time: 14350.4687s
	iters: 200, epoch: 4 | loss: 0.5185761
	speed: 0.0765s/iter; left time: 3463.4184s
	iters: 300, epoch: 4 | loss: 0.7679915
	speed: 0.0716s/iter; left time: 3234.2031s
	iters: 400, epoch: 4 | loss: 0.1394733
	speed: 0.0720s/iter; left time: 3248.2847s
Epoch: 4 cost time: 34.42604970932007
Epoch: 4, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3271670
	speed: 0.3125s/iter; left time: 14038.0595s
	iters: 200, epoch: 5 | loss: 0.0980747
	speed: 0.0692s/iter; left time: 3103.9116s
	iters: 300, epoch: 5 | loss: 0.2132560
	speed: 0.0677s/iter; left time: 3027.9458s
	iters: 400, epoch: 5 | loss: 0.3261927
	speed: 0.0724s/iter; left time: 3232.0566s
Epoch: 5 cost time: 33.30424094200134
Epoch: 5, Steps: 469 | Train Loss: 0.359 Vali Loss: 0.612 Vali Acc: 0.821 Test Loss: 0.612 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9736099
	speed: 0.3179s/iter; left time: 14131.1807s
	iters: 200, epoch: 6 | loss: 0.3564047
	speed: 0.0703s/iter; left time: 3118.2720s
	iters: 300, epoch: 6 | loss: 0.6539852
	speed: 0.0660s/iter; left time: 2922.7258s
	iters: 400, epoch: 6 | loss: 0.3378932
	speed: 0.0648s/iter; left time: 2860.9420s
Epoch: 6 cost time: 32.38688826560974
Epoch: 6, Steps: 469 | Train Loss: 0.412 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7760170
	speed: 0.3148s/iter; left time: 13845.3625s
	iters: 200, epoch: 7 | loss: 0.4751541
	speed: 0.0717s/iter; left time: 3146.7790s
	iters: 300, epoch: 7 | loss: 0.1174485
	speed: 0.0695s/iter; left time: 3044.4737s
	iters: 400, epoch: 7 | loss: 1.0698243
	speed: 0.0705s/iter; left time: 3077.7726s
Epoch: 7 cost time: 33.56566858291626
Epoch: 7, Steps: 469 | Train Loss: 0.518 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1906049
	speed: 0.3307s/iter; left time: 14392.2155s
	iters: 200, epoch: 8 | loss: 0.6169410
	speed: 0.0767s/iter; left time: 3329.4566s
	iters: 300, epoch: 8 | loss: 0.4045480
	speed: 0.0792s/iter; left time: 3429.5188s
	iters: 400, epoch: 8 | loss: 0.0978650
	speed: 0.0725s/iter; left time: 3134.4430s
Epoch: 8 cost time: 35.78578066825867
Epoch: 8, Steps: 469 | Train Loss: 0.540 Vali Loss: 0.534 Vali Acc: 0.823 Test Loss: 0.534 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2153791
	speed: 0.3275s/iter; left time: 14100.5348s
	iters: 200, epoch: 9 | loss: 0.0276653
	speed: 0.0699s/iter; left time: 3001.9081s
	iters: 300, epoch: 9 | loss: 0.1703853
	speed: 0.0734s/iter; left time: 3146.5029s
	iters: 400, epoch: 9 | loss: 0.3028299
	speed: 0.0728s/iter; left time: 3113.3024s
Epoch: 9 cost time: 34.24333310127258
Epoch: 9, Steps: 469 | Train Loss: 0.459 Vali Loss: 0.859 Vali Acc: 0.725 Test Loss: 0.859 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3751360
	speed: 0.3297s/iter; left time: 14037.7207s
	iters: 200, epoch: 10 | loss: 0.4399762
	speed: 0.0748s/iter; left time: 3178.0838s
	iters: 300, epoch: 10 | loss: 0.4683614
	speed: 0.0719s/iter; left time: 3048.8387s
	iters: 400, epoch: 10 | loss: 1.0179574
	speed: 0.0741s/iter; left time: 3132.2367s
Epoch: 10 cost time: 34.971471309661865
Epoch: 10, Steps: 469 | Train Loss: 0.492 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4177114
	speed: 0.3146s/iter; left time: 13248.9001s
	iters: 200, epoch: 11 | loss: 0.4193152
	speed: 0.0743s/iter; left time: 3121.5792s
	iters: 300, epoch: 11 | loss: 0.1171726
	speed: 0.0655s/iter; left time: 2746.3026s
	iters: 400, epoch: 11 | loss: 0.4105716
	speed: 0.0660s/iter; left time: 2760.5194s
Epoch: 11 cost time: 32.721341371536255
Epoch: 11, Steps: 469 | Train Loss: 0.407 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6516939
	speed: 0.2874s/iter; left time: 11967.1579s
	iters: 200, epoch: 12 | loss: 0.5175607
	speed: 0.0629s/iter; left time: 2614.6758s
	iters: 300, epoch: 12 | loss: 0.1414501
	speed: 0.0639s/iter; left time: 2646.9964s
	iters: 400, epoch: 12 | loss: 0.1114219
	speed: 0.0710s/iter; left time: 2934.9498s
Epoch: 12 cost time: 31.653746366500854
Epoch: 12, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.380 Vali Acc: 0.912 Test Loss: 0.380 Test Acc: 0.912
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.3331203
	speed: 0.3171s/iter; left time: 13054.5164s
	iters: 200, epoch: 13 | loss: 0.0247088
	speed: 0.0708s/iter; left time: 2909.9627s
	iters: 300, epoch: 13 | loss: 0.2506377
	speed: 0.0674s/iter; left time: 2759.5899s
	iters: 400, epoch: 13 | loss: 0.2536856
	speed: 0.0645s/iter; left time: 2634.2863s
Epoch: 13 cost time: 31.79671835899353
Epoch: 13, Steps: 469 | Train Loss: 0.287 Vali Loss: 0.344 Vali Acc: 0.905 Test Loss: 0.344 Test Acc: 0.905
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9268153230417381
model parameter : 8335418
model size : 36.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3158241
	speed: 0.0816s/iter; left time: 3817.1408s
	iters: 200, epoch: 1 | loss: 0.4034732
	speed: 0.0641s/iter; left time: 2995.5815s
	iters: 300, epoch: 1 | loss: 0.2124318
	speed: 0.0670s/iter; left time: 3121.3724s
	iters: 400, epoch: 1 | loss: 0.4039479
	speed: 0.0654s/iter; left time: 3041.0588s
Epoch: 1 cost time: 32.628233194351196
Epoch: 1, Steps: 469 | Train Loss: 0.442 Vali Loss: 0.400 Vali Acc: 0.881 Test Loss: 0.400 Test Acc: 0.881
Validation loss decreased (inf --> -0.880785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4420523
	speed: 0.3112s/iter; left time: 14418.5026s
	iters: 200, epoch: 2 | loss: 0.3314563
	speed: 0.0667s/iter; left time: 3085.3343s
	iters: 300, epoch: 2 | loss: 0.1121416
	speed: 0.0665s/iter; left time: 3068.3724s
	iters: 400, epoch: 2 | loss: 0.5109301
	speed: 0.0668s/iter; left time: 3073.6103s
Epoch: 2 cost time: 32.06201171875
Epoch: 2, Steps: 469 | Train Loss: 0.246 Vali Loss: 0.451 Vali Acc: 0.873 Test Loss: 0.451 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4475512
	speed: 0.3044s/iter; left time: 13960.4032s
	iters: 200, epoch: 3 | loss: 0.0680875
	speed: 0.0696s/iter; left time: 3186.9105s
	iters: 300, epoch: 3 | loss: 0.3081594
	speed: 0.0753s/iter; left time: 3437.6805s
	iters: 400, epoch: 3 | loss: 0.4931143
	speed: 0.0737s/iter; left time: 3357.0321s
Epoch: 3 cost time: 33.93492937088013
Epoch: 3, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.478 Vali Acc: 0.864 Test Loss: 0.478 Test Acc: 0.864
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1100379
	speed: 0.3336s/iter; left time: 15141.5702s
	iters: 200, epoch: 4 | loss: 0.4537607
	speed: 0.0712s/iter; left time: 3224.6302s
	iters: 300, epoch: 4 | loss: 0.5478565
	speed: 0.0717s/iter; left time: 3239.6679s
	iters: 400, epoch: 4 | loss: 0.0369773
	speed: 0.0732s/iter; left time: 3302.9484s
Epoch: 4 cost time: 33.93855309486389
Epoch: 4, Steps: 469 | Train Loss: 0.274 Vali Loss: 0.386 Vali Acc: 0.881 Test Loss: 0.386 Test Acc: 0.881
Validation loss decreased (-0.880785 --> -0.881357).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2343135
	speed: 0.3422s/iter; left time: 15375.3289s
	iters: 200, epoch: 5 | loss: 1.0002521
	speed: 0.0751s/iter; left time: 3365.6054s
	iters: 300, epoch: 5 | loss: 0.6394922
	speed: 0.0695s/iter; left time: 3109.6816s
	iters: 400, epoch: 5 | loss: 0.3240284
	speed: 0.0695s/iter; left time: 3103.0367s
Epoch: 5 cost time: 34.00765585899353
Epoch: 5, Steps: 469 | Train Loss: 0.376 Vali Loss: 0.466 Vali Acc: 0.886 Test Loss: 0.466 Test Acc: 0.886
Validation loss decreased (-0.881357 --> -0.886216).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2046505
	speed: 0.3251s/iter; left time: 14450.6734s
	iters: 200, epoch: 6 | loss: 0.1374308
	speed: 0.0747s/iter; left time: 3312.8838s
	iters: 300, epoch: 6 | loss: 0.3909429
	speed: 0.0752s/iter; left time: 3329.8657s
	iters: 400, epoch: 6 | loss: 0.3642291
	speed: 0.0742s/iter; left time: 3276.9072s
Epoch: 6 cost time: 34.487897872924805
Epoch: 6, Steps: 469 | Train Loss: 0.409 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4011340
	speed: 0.3183s/iter; left time: 13999.3512s
	iters: 200, epoch: 7 | loss: 0.6920894
	speed: 0.0763s/iter; left time: 3350.2096s
	iters: 300, epoch: 7 | loss: 0.5613968
	speed: 0.0707s/iter; left time: 3094.8115s
	iters: 400, epoch: 7 | loss: 0.3876784
	speed: 0.0716s/iter; left time: 3129.5036s
Epoch: 7 cost time: 34.206082582473755
Epoch: 7, Steps: 469 | Train Loss: 0.459 Vali Loss: 0.499 Vali Acc: 0.864 Test Loss: 0.499 Test Acc: 0.864
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1016587
	speed: 0.3279s/iter; left time: 14271.3604s
	iters: 200, epoch: 8 | loss: 0.2885196
	speed: 0.0728s/iter; left time: 3159.2707s
	iters: 300, epoch: 8 | loss: 0.2396893
	speed: 0.0681s/iter; left time: 2951.7575s
	iters: 400, epoch: 8 | loss: 0.5340028
	speed: 0.0663s/iter; left time: 2866.9166s
Epoch: 8 cost time: 33.72514319419861
Epoch: 8, Steps: 469 | Train Loss: 0.325 Vali Loss: 0.259 Vali Acc: 0.927 Test Loss: 0.259 Test Acc: 0.927
Validation loss decreased (-0.886216 --> -0.926527).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0709197
	speed: 0.2896s/iter; left time: 12466.6850s
	iters: 200, epoch: 9 | loss: 0.4860665
	speed: 0.0714s/iter; left time: 3064.7101s
	iters: 300, epoch: 9 | loss: 0.1964419
	speed: 0.0681s/iter; left time: 2917.2936s
	iters: 400, epoch: 9 | loss: 0.1009934
	speed: 0.0703s/iter; left time: 3003.8216s
Epoch: 9 cost time: 32.520392417907715
Epoch: 9, Steps: 469 | Train Loss: 0.313 Vali Loss: 0.360 Vali Acc: 0.892 Test Loss: 0.360 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1624191
	speed: 0.2854s/iter; left time: 12150.6276s
	iters: 200, epoch: 10 | loss: 0.2515048
	speed: 0.0709s/iter; left time: 3013.7566s
	iters: 300, epoch: 10 | loss: 1.0304539
	speed: 0.0708s/iter; left time: 3000.7636s
	iters: 400, epoch: 10 | loss: 0.1590048
	speed: 0.0689s/iter; left time: 2914.7072s
Epoch: 10 cost time: 33.063496112823486
Epoch: 10, Steps: 469 | Train Loss: 0.317 Vali Loss: 0.437 Vali Acc: 0.894 Test Loss: 0.437 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3496953
	speed: 0.3236s/iter; left time: 13628.0086s
	iters: 200, epoch: 11 | loss: 1.0978456
	speed: 0.0741s/iter; left time: 3112.3867s
	iters: 300, epoch: 11 | loss: 0.5215349
	speed: 0.0741s/iter; left time: 3105.0621s
	iters: 400, epoch: 11 | loss: 0.1936703
	speed: 0.0751s/iter; left time: 3139.4996s
Epoch: 11 cost time: 35.85186219215393
Epoch: 11, Steps: 469 | Train Loss: 0.327 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2848051
	speed: 0.3359s/iter; left time: 13989.4788s
	iters: 200, epoch: 12 | loss: 0.5996265
	speed: 0.0703s/iter; left time: 2921.8413s
	iters: 300, epoch: 12 | loss: 0.1419385
	speed: 0.0702s/iter; left time: 2907.6190s
	iters: 400, epoch: 12 | loss: 0.1166811
	speed: 0.0721s/iter; left time: 2980.0832s
Epoch: 12 cost time: 33.70546913146973
Epoch: 12, Steps: 469 | Train Loss: 0.272 Vali Loss: 0.332 Vali Acc: 0.912 Test Loss: 0.332 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7034346
	speed: 0.3309s/iter; left time: 13624.4265s
	iters: 200, epoch: 13 | loss: 0.2216896
	speed: 0.0703s/iter; left time: 2887.3072s
	iters: 300, epoch: 13 | loss: 0.5879699
	speed: 0.0712s/iter; left time: 2916.3109s
	iters: 400, epoch: 13 | loss: 0.4657864
	speed: 0.0700s/iter; left time: 2861.1642s
Epoch: 13 cost time: 33.85382604598999
Epoch: 13, Steps: 469 | Train Loss: 0.263 Vali Loss: 0.376 Vali Acc: 0.907 Test Loss: 0.376 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0173388
	speed: 0.3127s/iter; left time: 12729.0116s
	iters: 200, epoch: 14 | loss: 0.3557894
	speed: 0.0674s/iter; left time: 2735.0406s
	iters: 300, epoch: 14 | loss: 0.0573910
	speed: 0.0669s/iter; left time: 2711.1996s
	iters: 400, epoch: 14 | loss: 0.3925836
	speed: 0.0712s/iter; left time: 2876.4165s
Epoch: 14 cost time: 32.77971863746643
Epoch: 14, Steps: 469 | Train Loss: 0.230 Vali Loss: 0.365 Vali Acc: 0.893 Test Loss: 0.365 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4830409
	speed: 0.3158s/iter; left time: 12707.7031s
	iters: 200, epoch: 15 | loss: 0.1964066
	speed: 0.0724s/iter; left time: 2905.7481s
	iters: 300, epoch: 15 | loss: 0.6191939
	speed: 0.0727s/iter; left time: 2911.3075s
	iters: 400, epoch: 15 | loss: 0.3074311
	speed: 0.0667s/iter; left time: 2662.4101s
Epoch: 15 cost time: 33.675150632858276
Epoch: 15, Steps: 469 | Train Loss: 0.301 Vali Loss: 0.452 Vali Acc: 0.884 Test Loss: 0.452 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0842808
	speed: 0.3141s/iter; left time: 12489.6086s
	iters: 200, epoch: 16 | loss: 0.1332372
	speed: 0.0694s/iter; left time: 2753.8695s
	iters: 300, epoch: 16 | loss: 0.1997998
	speed: 0.0709s/iter; left time: 2806.5649s
	iters: 400, epoch: 16 | loss: 0.1453541
	speed: 0.0652s/iter; left time: 2573.9556s
Epoch: 16 cost time: 32.61713624000549
Epoch: 16, Steps: 469 | Train Loss: 0.257 Vali Loss: 1.424 Vali Acc: 0.699 Test Loss: 1.424 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2403128
	speed: 0.2979s/iter; left time: 11708.1046s
	iters: 200, epoch: 17 | loss: 0.1905084
	speed: 0.0640s/iter; left time: 2507.3452s
	iters: 300, epoch: 17 | loss: 0.6418954
	speed: 0.0678s/iter; left time: 2650.6187s
	iters: 400, epoch: 17 | loss: 0.3062688
	speed: 0.0675s/iter; left time: 2631.9151s
Epoch: 17 cost time: 31.648343324661255
Epoch: 17, Steps: 469 | Train Loss: 0.282 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.926527 --> -0.930529).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0715744
	speed: 0.3082s/iter; left time: 11968.1194s
	iters: 200, epoch: 18 | loss: 0.5424194
	speed: 0.0686s/iter; left time: 2658.2491s
	iters: 300, epoch: 18 | loss: 0.0185909
	speed: 0.0659s/iter; left time: 2544.6476s
	iters: 400, epoch: 18 | loss: 0.0111534
	speed: 0.0688s/iter; left time: 2651.2726s
Epoch: 18 cost time: 32.24579048156738
Epoch: 18, Steps: 469 | Train Loss: 0.193 Vali Loss: 0.447 Vali Acc: 0.893 Test Loss: 0.447 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0465169
	speed: 0.3222s/iter; left time: 12357.9590s
	iters: 200, epoch: 19 | loss: 0.1400363
	speed: 0.0674s/iter; left time: 2577.7358s
	iters: 300, epoch: 19 | loss: 0.0957204
	speed: 0.0646s/iter; left time: 2464.6293s
	iters: 400, epoch: 19 | loss: 0.3430806
	speed: 0.0671s/iter; left time: 2553.4767s
Epoch: 19 cost time: 31.91325569152832
Epoch: 19, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.930529 --> -0.937390).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5229571
	speed: 0.3047s/iter; left time: 11545.3239s
	iters: 200, epoch: 20 | loss: 0.1622244
	speed: 0.0667s/iter; left time: 2520.9898s
	iters: 300, epoch: 20 | loss: 0.0915345
	speed: 0.0677s/iter; left time: 2551.4628s
	iters: 400, epoch: 20 | loss: 0.7536427
	speed: 0.0744s/iter; left time: 2796.0939s
Epoch: 20 cost time: 32.36519432067871
Epoch: 20, Steps: 469 | Train Loss: 0.191 Vali Loss: 0.282 Vali Acc: 0.927 Test Loss: 0.282 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1418536
	speed: 0.3096s/iter; left time: 11586.2020s
	iters: 200, epoch: 21 | loss: 0.4149753
	speed: 0.0758s/iter; left time: 2830.4096s
	iters: 300, epoch: 21 | loss: 0.1066728
	speed: 0.0743s/iter; left time: 2763.9273s
	iters: 400, epoch: 21 | loss: 0.0603727
	speed: 0.0730s/iter; left time: 2708.2322s
Epoch: 21 cost time: 34.61257600784302
Epoch: 21, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
Validation loss decreased (-0.937390 --> -0.954257).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0518846
	speed: 0.3240s/iter; left time: 11973.3899s
	iters: 200, epoch: 22 | loss: 0.0409618
	speed: 0.0704s/iter; left time: 2595.4596s
	iters: 300, epoch: 22 | loss: 0.1938552
	speed: 0.0726s/iter; left time: 2669.3219s
	iters: 400, epoch: 22 | loss: 0.8000626
	speed: 0.0710s/iter; left time: 2600.5074s
Epoch: 22 cost time: 33.2831072807312
Epoch: 22, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.409 Vali Acc: 0.902 Test Loss: 0.409 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1525784
	speed: 0.3196s/iter; left time: 11659.6978s
	iters: 200, epoch: 23 | loss: 0.0133644
	speed: 0.0701s/iter; left time: 2552.1346s
	iters: 300, epoch: 23 | loss: 0.1571220
	speed: 0.0714s/iter; left time: 2590.8014s
	iters: 400, epoch: 23 | loss: 0.1282039
	speed: 0.0702s/iter; left time: 2539.0689s
Epoch: 23 cost time: 33.273080348968506
Epoch: 23, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1451798
	speed: 0.3066s/iter; left time: 11041.4872s
	iters: 200, epoch: 24 | loss: 0.4338695
	speed: 0.0676s/iter; left time: 2429.0150s
	iters: 300, epoch: 24 | loss: 0.0450824
	speed: 0.0684s/iter; left time: 2450.7300s
	iters: 400, epoch: 24 | loss: 0.0028798
	speed: 0.0706s/iter; left time: 2522.7112s
Epoch: 24 cost time: 33.058244466781616
Epoch: 24, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.4697427
	speed: 0.3123s/iter; left time: 11100.4388s
	iters: 200, epoch: 25 | loss: 0.1188151
	speed: 0.0715s/iter; left time: 2534.1871s
	iters: 300, epoch: 25 | loss: 0.1454016
	speed: 0.0718s/iter; left time: 2536.3465s
	iters: 400, epoch: 25 | loss: 0.1800038
	speed: 0.0662s/iter; left time: 2334.7139s
Epoch: 25 cost time: 33.023582458496094
Epoch: 25, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.314 Vali Acc: 0.927 Test Loss: 0.314 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1836212
	speed: 0.3231s/iter; left time: 11334.8071s
	iters: 200, epoch: 26 | loss: 0.0245566
	speed: 0.0714s/iter; left time: 2496.7618s
	iters: 300, epoch: 26 | loss: 0.1182493
	speed: 0.0663s/iter; left time: 2312.4599s
	iters: 400, epoch: 26 | loss: 0.1577935
	speed: 0.0654s/iter; left time: 2273.8695s
Epoch: 26 cost time: 33.59853482246399
Epoch: 26, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.5954406
	speed: 0.3017s/iter; left time: 10439.9601s
	iters: 200, epoch: 27 | loss: 0.0680549
	speed: 0.0640s/iter; left time: 2209.8796s
	iters: 300, epoch: 27 | loss: 0.0423268
	speed: 0.0710s/iter; left time: 2444.3479s
	iters: 400, epoch: 27 | loss: 0.3990755
	speed: 0.0701s/iter; left time: 2403.2500s
Epoch: 27 cost time: 32.56488656997681
Epoch: 27, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0329056
	speed: 0.3254s/iter; left time: 11107.9724s
	iters: 200, epoch: 28 | loss: 0.1259646
	speed: 0.0668s/iter; left time: 2274.6363s
	iters: 300, epoch: 28 | loss: 0.0300817
	speed: 0.0647s/iter; left time: 2194.2966s
	iters: 400, epoch: 28 | loss: 0.0326259
	speed: 0.0665s/iter; left time: 2249.3319s
Epoch: 28 cost time: 32.112080812454224
Epoch: 28, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.369 Vali Acc: 0.908 Test Loss: 0.369 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0366443
	speed: 0.3210s/iter; left time: 10806.4892s
	iters: 200, epoch: 29 | loss: 0.0198226
	speed: 0.0677s/iter; left time: 2270.9646s
	iters: 300, epoch: 29 | loss: 0.1779600
	speed: 0.0647s/iter; left time: 2164.7509s
	iters: 400, epoch: 29 | loss: 0.5303355
	speed: 0.0645s/iter; left time: 2151.8509s
Epoch: 29 cost time: 31.56402587890625
Epoch: 29, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.277 Vali Acc: 0.927 Test Loss: 0.277 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0038098
	speed: 0.3131s/iter; left time: 10394.8387s
	iters: 200, epoch: 30 | loss: 0.0483524
	speed: 0.0757s/iter; left time: 2504.4160s
	iters: 300, epoch: 30 | loss: 0.6529922
	speed: 0.0717s/iter; left time: 2366.7357s
	iters: 400, epoch: 30 | loss: 0.3545537
	speed: 0.0807s/iter; left time: 2656.4727s
Epoch: 30 cost time: 35.26428842544556
Epoch: 30, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.341 Vali Acc: 0.927 Test Loss: 0.341 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.3103271
	speed: 0.3243s/iter; left time: 10614.6809s
	iters: 200, epoch: 31 | loss: 0.3484177
	speed: 0.0722s/iter; left time: 2354.7276s
	iters: 300, epoch: 31 | loss: 0.0500739
	speed: 0.0739s/iter; left time: 2405.2088s
	iters: 400, epoch: 31 | loss: 0.0065407
	speed: 0.0676s/iter; left time: 2192.7488s
Epoch: 31 cost time: 33.713916063308716
Epoch: 31, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9542595769010863
model parameter : 8334650
model size : 36.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4200608
	speed: 0.0889s/iter; left time: 4160.5707s
	iters: 200, epoch: 1 | loss: 0.3212208
	speed: 0.0667s/iter; left time: 3115.1614s
	iters: 300, epoch: 1 | loss: 0.2548228
	speed: 0.0679s/iter; left time: 3163.2702s
	iters: 400, epoch: 1 | loss: 0.0681683
	speed: 0.0684s/iter; left time: 3179.2768s
Epoch: 1 cost time: 33.67543053627014
Epoch: 1, Steps: 469 | Train Loss: 0.440 Vali Loss: 0.388 Vali Acc: 0.881 Test Loss: 0.388 Test Acc: 0.881
Validation loss decreased (inf --> -0.880785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0991920
	speed: 0.2893s/iter; left time: 13404.4623s
	iters: 200, epoch: 2 | loss: 0.0761747
	speed: 0.0705s/iter; left time: 3258.0114s
	iters: 300, epoch: 2 | loss: 0.0458757
	speed: 0.0690s/iter; left time: 3185.1468s
	iters: 400, epoch: 2 | loss: 0.2502691
	speed: 0.0675s/iter; left time: 3107.0053s
Epoch: 2 cost time: 32.65154981613159
Epoch: 2, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.393 Vali Acc: 0.901 Test Loss: 0.393 Test Acc: 0.901
Validation loss decreased (-0.880785 --> -0.900511).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0907926
	speed: 0.3066s/iter; left time: 14061.9672s
	iters: 200, epoch: 3 | loss: 0.2619705
	speed: 0.0654s/iter; left time: 2993.0965s
	iters: 300, epoch: 3 | loss: 0.0849182
	speed: 0.0668s/iter; left time: 3052.0411s
	iters: 400, epoch: 3 | loss: 0.0704840
	speed: 0.0612s/iter; left time: 2789.3072s
Epoch: 3 cost time: 31.303335428237915
Epoch: 3, Steps: 469 | Train Loss: 0.220 Vali Loss: 0.380 Vali Acc: 0.888 Test Loss: 0.380 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4887708
	speed: 0.2867s/iter; left time: 13013.5140s
	iters: 200, epoch: 4 | loss: 0.2684518
	speed: 0.0673s/iter; left time: 3047.5054s
	iters: 300, epoch: 4 | loss: 0.4240825
	speed: 0.0691s/iter; left time: 3123.7185s
	iters: 400, epoch: 4 | loss: 0.1147337
	speed: 0.0670s/iter; left time: 3020.3643s
Epoch: 4 cost time: 31.588776111602783
Epoch: 4, Steps: 469 | Train Loss: 0.220 Vali Loss: 0.500 Vali Acc: 0.868 Test Loss: 0.500 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6630332
	speed: 0.3113s/iter; left time: 13985.6530s
	iters: 200, epoch: 5 | loss: 0.3857452
	speed: 0.0704s/iter; left time: 3155.7624s
	iters: 300, epoch: 5 | loss: 0.5338663
	speed: 0.0702s/iter; left time: 3141.4857s
	iters: 400, epoch: 5 | loss: 0.4579654
	speed: 0.0729s/iter; left time: 3253.5895s
Epoch: 5 cost time: 33.68638515472412
Epoch: 5, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.320 Vali Acc: 0.909 Test Loss: 0.320 Test Acc: 0.909
Validation loss decreased (-0.900511 --> -0.909374).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0556003
	speed: 0.3025s/iter; left time: 13450.0572s
	iters: 200, epoch: 6 | loss: 0.0108883
	speed: 0.0645s/iter; left time: 2862.4246s
	iters: 300, epoch: 6 | loss: 0.3150681
	speed: 0.0685s/iter; left time: 3032.2699s
	iters: 400, epoch: 6 | loss: 0.6430815
	speed: 0.0716s/iter; left time: 3161.2202s
Epoch: 6 cost time: 32.29148006439209
Epoch: 6, Steps: 469 | Train Loss: 0.215 Vali Loss: 0.442 Vali Acc: 0.894 Test Loss: 0.442 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0973735
	speed: 0.2856s/iter; left time: 12564.6067s
	iters: 200, epoch: 7 | loss: 0.0612534
	speed: 0.0687s/iter; left time: 3017.2192s
	iters: 300, epoch: 7 | loss: 0.3569904
	speed: 0.0768s/iter; left time: 3362.8432s
	iters: 400, epoch: 7 | loss: 0.1971722
	speed: 0.0747s/iter; left time: 3263.5483s
Epoch: 7 cost time: 33.79987835884094
Epoch: 7, Steps: 469 | Train Loss: 0.198 Vali Loss: 0.349 Vali Acc: 0.910 Test Loss: 0.349 Test Acc: 0.910
Validation loss decreased (-0.909374 --> -0.909945).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0407257
	speed: 0.3383s/iter; left time: 14722.5246s
	iters: 200, epoch: 8 | loss: 0.0171301
	speed: 0.0667s/iter; left time: 2895.4417s
	iters: 300, epoch: 8 | loss: 0.0049054
	speed: 0.0687s/iter; left time: 2977.8343s
	iters: 400, epoch: 8 | loss: 0.0615240
	speed: 0.0668s/iter; left time: 2886.5697s
Epoch: 8 cost time: 32.28859257698059
Epoch: 8, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.322 Vali Acc: 0.936 Test Loss: 0.322 Test Acc: 0.936
Validation loss decreased (-0.909945 --> -0.935960).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3833376
	speed: 0.3256s/iter; left time: 14017.7896s
	iters: 200, epoch: 9 | loss: 0.1064136
	speed: 0.0743s/iter; left time: 3192.6010s
	iters: 300, epoch: 9 | loss: 0.6385511
	speed: 0.0771s/iter; left time: 3304.3781s
	iters: 400, epoch: 9 | loss: 0.0561767
	speed: 0.0758s/iter; left time: 3240.1395s
Epoch: 9 cost time: 35.46027755737305
Epoch: 9, Steps: 469 | Train Loss: 0.196 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1208641
	speed: 0.3240s/iter; left time: 13795.8710s
	iters: 200, epoch: 10 | loss: 0.1976785
	speed: 0.0646s/iter; left time: 2742.6644s
	iters: 300, epoch: 10 | loss: 0.3724579
	speed: 0.0662s/iter; left time: 2804.7317s
	iters: 400, epoch: 10 | loss: 0.0295542
	speed: 0.0665s/iter; left time: 2809.5450s
Epoch: 10 cost time: 31.992152214050293
Epoch: 10, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.368 Vali Acc: 0.871 Test Loss: 0.368 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0049954
	speed: 0.3080s/iter; left time: 12970.0570s
	iters: 200, epoch: 11 | loss: 0.0103433
	speed: 0.0627s/iter; left time: 2634.5041s
	iters: 300, epoch: 11 | loss: 0.1349261
	speed: 0.0671s/iter; left time: 2810.6925s
	iters: 400, epoch: 11 | loss: 0.1437400
	speed: 0.0713s/iter; left time: 2979.0790s
Epoch: 11 cost time: 32.140010356903076
Epoch: 11, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.373 Vali Acc: 0.913 Test Loss: 0.373 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0358847
	speed: 0.3122s/iter; left time: 13000.4641s
	iters: 200, epoch: 12 | loss: 0.0287469
	speed: 0.0692s/iter; left time: 2873.7052s
	iters: 300, epoch: 12 | loss: 0.2411542
	speed: 0.0680s/iter; left time: 2816.3257s
	iters: 400, epoch: 12 | loss: 0.4061641
	speed: 0.0721s/iter; left time: 2979.5378s
Epoch: 12 cost time: 32.33000469207764
Epoch: 12, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.230 Vali Acc: 0.939 Test Loss: 0.230 Test Acc: 0.939
Validation loss decreased (-0.935960 --> -0.939392).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2913709
	speed: 0.3161s/iter; left time: 13015.8007s
	iters: 200, epoch: 13 | loss: 0.0024187
	speed: 0.0677s/iter; left time: 2780.5952s
	iters: 300, epoch: 13 | loss: 0.0341778
	speed: 0.0650s/iter; left time: 2662.2303s
	iters: 400, epoch: 13 | loss: 0.0607969
	speed: 0.0648s/iter; left time: 2647.6740s
Epoch: 13 cost time: 32.19095754623413
Epoch: 13, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5753285
	speed: 0.3137s/iter; left time: 12768.2125s
	iters: 200, epoch: 14 | loss: 0.0079777
	speed: 0.0695s/iter; left time: 2820.6177s
	iters: 300, epoch: 14 | loss: 0.0768759
	speed: 0.0661s/iter; left time: 2676.2493s
	iters: 400, epoch: 14 | loss: 0.6675772
	speed: 0.0641s/iter; left time: 2590.8876s
Epoch: 14 cost time: 32.534178256988525
Epoch: 14, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
Validation loss decreased (-0.939392 --> -0.953972).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1595280
	speed: 0.3355s/iter; left time: 13498.2883s
	iters: 200, epoch: 15 | loss: 0.0012762
	speed: 0.0675s/iter; left time: 2707.8739s
	iters: 300, epoch: 15 | loss: 0.3634837
	speed: 0.0683s/iter; left time: 2735.9918s
	iters: 400, epoch: 15 | loss: 0.0832568
	speed: 0.0658s/iter; left time: 2627.8827s
Epoch: 15 cost time: 32.757044553756714
Epoch: 15, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.214 Vali Acc: 0.934 Test Loss: 0.214 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0039053
	speed: 0.3067s/iter; left time: 12197.7287s
	iters: 200, epoch: 16 | loss: 0.0160320
	speed: 0.0636s/iter; left time: 2521.7027s
	iters: 300, epoch: 16 | loss: 0.0287900
	speed: 0.0619s/iter; left time: 2447.4837s
	iters: 400, epoch: 16 | loss: 0.0434309
	speed: 0.0639s/iter; left time: 2523.8256s
Epoch: 16 cost time: 30.537318468093872
Epoch: 16, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
Validation loss decreased (-0.953972 --> -0.954829).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0208236
	speed: 0.3325s/iter; left time: 13066.2164s
	iters: 200, epoch: 17 | loss: 0.0953457
	speed: 0.0669s/iter; left time: 2620.6606s
	iters: 300, epoch: 17 | loss: 0.0387229
	speed: 0.0722s/iter; left time: 2823.0156s
	iters: 400, epoch: 17 | loss: 0.1145177
	speed: 0.0710s/iter; left time: 2770.0161s
Epoch: 17 cost time: 33.684364795684814
Epoch: 17, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2315048
	speed: 0.3287s/iter; left time: 12762.1989s
	iters: 200, epoch: 18 | loss: 0.2367325
	speed: 0.0712s/iter; left time: 2756.9913s
	iters: 300, epoch: 18 | loss: 0.0583981
	speed: 0.0763s/iter; left time: 2946.5391s
	iters: 400, epoch: 18 | loss: 0.0055007
	speed: 0.0731s/iter; left time: 2817.2937s
Epoch: 18 cost time: 34.8961124420166
Epoch: 18, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.333 Vali Acc: 0.918 Test Loss: 0.333 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0123043
	speed: 0.3368s/iter; left time: 12919.4579s
	iters: 200, epoch: 19 | loss: 0.4326967
	speed: 0.0867s/iter; left time: 3317.6274s
	iters: 300, epoch: 19 | loss: 0.1463860
	speed: 0.0695s/iter; left time: 2651.3793s
	iters: 400, epoch: 19 | loss: 0.0381117
	speed: 0.0707s/iter; left time: 2691.9550s
Epoch: 19 cost time: 35.60592007637024
Epoch: 19, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0780433
	speed: 0.3218s/iter; left time: 12192.1424s
	iters: 200, epoch: 20 | loss: 0.1807627
	speed: 0.0703s/iter; left time: 2655.2305s
	iters: 300, epoch: 20 | loss: 0.0623148
	speed: 0.0641s/iter; left time: 2416.8531s
	iters: 400, epoch: 20 | loss: 0.2387067
	speed: 0.0655s/iter; left time: 2463.0605s
Epoch: 20 cost time: 32.33350729942322
Epoch: 20, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0040406
	speed: 0.3015s/iter; left time: 11280.7443s
	iters: 200, epoch: 21 | loss: 0.0201703
	speed: 0.0685s/iter; left time: 2557.8465s
	iters: 300, epoch: 21 | loss: 0.0049490
	speed: 0.0656s/iter; left time: 2440.0630s
	iters: 400, epoch: 21 | loss: 0.0612794
	speed: 0.0651s/iter; left time: 2415.1069s
Epoch: 21 cost time: 31.69187569618225
Epoch: 21, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0398693
	speed: 0.3192s/iter; left time: 11795.2766s
	iters: 200, epoch: 22 | loss: 0.0378861
	speed: 0.0652s/iter; left time: 2404.0041s
	iters: 300, epoch: 22 | loss: 0.0032085
	speed: 0.0636s/iter; left time: 2338.2604s
	iters: 400, epoch: 22 | loss: 0.0322498
	speed: 0.0717s/iter; left time: 2629.0871s
Epoch: 22 cost time: 32.28973722457886
Epoch: 22, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0611940
	speed: 0.3066s/iter; left time: 11184.0110s
	iters: 200, epoch: 23 | loss: 0.0212765
	speed: 0.0613s/iter; left time: 2228.5217s
	iters: 300, epoch: 23 | loss: 0.0015806
	speed: 0.0630s/iter; left time: 2286.6284s
	iters: 400, epoch: 23 | loss: 0.3118088
	speed: 0.0648s/iter; left time: 2345.7694s
Epoch: 23 cost time: 30.117422580718994
Epoch: 23, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.356 Vali Acc: 0.924 Test Loss: 0.356 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0120422
	speed: 0.3014s/iter; left time: 10853.3145s
	iters: 200, epoch: 24 | loss: 0.1410425
	speed: 0.0693s/iter; left time: 2489.4648s
	iters: 300, epoch: 24 | loss: 0.5800362
	speed: 0.0653s/iter; left time: 2338.0914s
	iters: 400, epoch: 24 | loss: 0.0498376
	speed: 0.0638s/iter; left time: 2280.1988s
Epoch: 24 cost time: 31.303215265274048
Epoch: 24, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1277233
	speed: 0.2709s/iter; left time: 9628.4379s
	iters: 200, epoch: 25 | loss: 0.0044955
	speed: 0.0674s/iter; left time: 2389.7070s
	iters: 300, epoch: 25 | loss: 0.1208555
	speed: 0.0675s/iter; left time: 2387.3362s
	iters: 400, epoch: 25 | loss: 0.0014341
	speed: 0.0652s/iter; left time: 2296.4582s
Epoch: 25 cost time: 31.40889549255371
Epoch: 25, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
Validation loss decreased (-0.954829 --> -0.961119).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0097636
	speed: 0.2941s/iter; left time: 10315.0534s
	iters: 200, epoch: 26 | loss: 0.0159645
	speed: 0.0645s/iter; left time: 2256.9476s
	iters: 300, epoch: 26 | loss: 0.0624955
	speed: 0.0694s/iter; left time: 2421.8655s
	iters: 400, epoch: 26 | loss: 0.0012926
	speed: 0.0673s/iter; left time: 2340.6369s
Epoch: 26 cost time: 31.593138456344604
Epoch: 26, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.281 Vali Acc: 0.935 Test Loss: 0.281 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.6115517
	speed: 0.3309s/iter; left time: 11450.8648s
	iters: 200, epoch: 27 | loss: 0.0029285
	speed: 0.0720s/iter; left time: 2486.0097s
	iters: 300, epoch: 27 | loss: 0.0636374
	speed: 0.0690s/iter; left time: 2375.0625s
	iters: 400, epoch: 27 | loss: 0.0222451
	speed: 0.0681s/iter; left time: 2335.4041s
Epoch: 27 cost time: 32.64838933944702
Epoch: 27, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0025097
	speed: 0.3111s/iter; left time: 10618.9903s
	iters: 200, epoch: 28 | loss: 0.0017037
	speed: 0.0674s/iter; left time: 2294.4962s
	iters: 300, epoch: 28 | loss: 0.4004961
	speed: 0.0664s/iter; left time: 2251.7882s
	iters: 400, epoch: 28 | loss: 0.0086604
	speed: 0.0679s/iter; left time: 2298.3130s
Epoch: 28 cost time: 32.57459092140198
Epoch: 28, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.241 Vali Acc: 0.938 Test Loss: 0.241 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0036007
	speed: 0.3020s/iter; left time: 10167.1515s
	iters: 200, epoch: 29 | loss: 0.0489738
	speed: 0.0612s/iter; left time: 2054.2603s
	iters: 300, epoch: 29 | loss: 0.0994893
	speed: 0.0592s/iter; left time: 1981.0146s
	iters: 400, epoch: 29 | loss: 0.0447736
	speed: 0.0574s/iter; left time: 1914.2446s
Epoch: 29 cost time: 29.7261004447937
Epoch: 29, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0779617
	speed: 0.2746s/iter; left time: 9116.2403s
	iters: 200, epoch: 30 | loss: 0.0506497
	speed: 0.0616s/iter; left time: 2039.1563s
	iters: 300, epoch: 30 | loss: 0.0089338
	speed: 0.0628s/iter; left time: 2073.2639s
	iters: 400, epoch: 30 | loss: 0.1082542
	speed: 0.0626s/iter; left time: 2059.2955s
Epoch: 30 cost time: 29.65010118484497
Epoch: 30, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.355 Vali Acc: 0.929 Test Loss: 0.355 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0246236
	speed: 0.2937s/iter; left time: 9613.4823s
	iters: 200, epoch: 31 | loss: 0.1540272
	speed: 0.0667s/iter; left time: 2175.9200s
	iters: 300, epoch: 31 | loss: 0.0342972
	speed: 0.0678s/iter; left time: 2205.9948s
	iters: 400, epoch: 31 | loss: 0.2234933
	speed: 0.0663s/iter; left time: 2151.3497s
Epoch: 31 cost time: 31.797091960906982
Epoch: 31, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.254 Vali Acc: 0.947 Test Loss: 0.254 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.1700135
	speed: 0.3059s/iter; left time: 9868.6478s
	iters: 200, epoch: 32 | loss: 0.1341760
	speed: 0.0702s/iter; left time: 2257.0206s
	iters: 300, epoch: 32 | loss: 0.0054949
	speed: 0.0693s/iter; left time: 2220.4024s
	iters: 400, epoch: 32 | loss: 0.0206015
	speed: 0.0668s/iter; left time: 2135.3286s
Epoch: 32 cost time: 32.79039931297302
Epoch: 32, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.227 Vali Acc: 0.952 Test Loss: 0.227 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.6458277
	speed: 0.2933s/iter; left time: 9325.1583s
	iters: 200, epoch: 33 | loss: 0.0014289
	speed: 0.0655s/iter; left time: 2076.8256s
	iters: 300, epoch: 33 | loss: 0.0250049
	speed: 0.0622s/iter; left time: 1964.2271s
	iters: 400, epoch: 33 | loss: 0.0058964
	speed: 0.0655s/iter; left time: 2062.7973s
Epoch: 33 cost time: 30.63389229774475
Epoch: 33, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.961119 --> -0.965121).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0967100
	speed: 0.2967s/iter; left time: 9292.5213s
	iters: 200, epoch: 34 | loss: 0.0023702
	speed: 0.0680s/iter; left time: 2124.3990s
	iters: 300, epoch: 34 | loss: 0.0325419
	speed: 0.0628s/iter; left time: 1955.3240s
	iters: 400, epoch: 34 | loss: 0.0047902
	speed: 0.0633s/iter; left time: 1964.4529s
Epoch: 34 cost time: 30.80223250389099
Epoch: 34, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0057343
	speed: 0.2890s/iter; left time: 8916.5035s
	iters: 200, epoch: 35 | loss: 0.0068948
	speed: 0.0631s/iter; left time: 1940.5819s
	iters: 300, epoch: 35 | loss: 0.0057026
	speed: 0.0623s/iter; left time: 1909.6395s
	iters: 400, epoch: 35 | loss: 0.0080057
	speed: 0.0644s/iter; left time: 1967.8255s
Epoch: 35 cost time: 30.35617995262146
Epoch: 35, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.965121 --> -0.966551).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.2786298
	speed: 0.3158s/iter; left time: 9596.6491s
	iters: 200, epoch: 36 | loss: 0.0151121
	speed: 0.0683s/iter; left time: 2067.2913s
	iters: 300, epoch: 36 | loss: 0.0571350
	speed: 0.0686s/iter; left time: 2070.2973s
	iters: 400, epoch: 36 | loss: 0.2411591
	speed: 0.0683s/iter; left time: 2053.9724s
Epoch: 36 cost time: 32.59514880180359
Epoch: 36, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.247 Vali Acc: 0.940 Test Loss: 0.247 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0441726
	speed: 0.3243s/iter; left time: 9701.3359s
	iters: 200, epoch: 37 | loss: 0.0026514
	speed: 0.0683s/iter; left time: 2035.8751s
	iters: 300, epoch: 37 | loss: 0.0099774
	speed: 0.0669s/iter; left time: 1989.4218s
	iters: 400, epoch: 37 | loss: 0.1557970
	speed: 0.0728s/iter; left time: 2157.2355s
Epoch: 37 cost time: 33.306586027145386
Epoch: 37, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.966551 --> -0.967694).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.2898743
	speed: 0.3290s/iter; left time: 9689.6699s
	iters: 200, epoch: 38 | loss: 0.0222344
	speed: 0.0654s/iter; left time: 1918.0579s
	iters: 300, epoch: 38 | loss: 0.4875776
	speed: 0.0694s/iter; left time: 2029.8865s
	iters: 400, epoch: 38 | loss: 0.0024120
	speed: 0.0723s/iter; left time: 2107.5634s
Epoch: 38 cost time: 32.27951669692993
Epoch: 38, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0137883
	speed: 0.2928s/iter; left time: 8484.7076s
	iters: 200, epoch: 39 | loss: 0.0026616
	speed: 0.0662s/iter; left time: 1910.3640s
	iters: 300, epoch: 39 | loss: 0.0034856
	speed: 0.0716s/iter; left time: 2059.9926s
	iters: 400, epoch: 39 | loss: 0.0098773
	speed: 0.0670s/iter; left time: 1922.1416s
Epoch: 39 cost time: 31.961626529693604
Epoch: 39, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.957 Test Loss: 0.250 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0013197
	speed: 0.3159s/iter; left time: 9006.0200s
	iters: 200, epoch: 40 | loss: 0.1256027
	speed: 0.0759s/iter; left time: 2157.1548s
	iters: 300, epoch: 40 | loss: 0.6301452
	speed: 0.0693s/iter; left time: 1961.2043s
	iters: 400, epoch: 40 | loss: 0.2766594
	speed: 0.0629s/iter; left time: 1775.7803s
Epoch: 40 cost time: 32.78770709037781
Epoch: 40, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.0419131
	speed: 0.2884s/iter; left time: 8085.8471s
	iters: 200, epoch: 41 | loss: 0.0069790
	speed: 0.0707s/iter; left time: 1975.7918s
	iters: 300, epoch: 41 | loss: 0.1237027
	speed: 0.0685s/iter; left time: 1907.2181s
	iters: 400, epoch: 41 | loss: 0.0436271
	speed: 0.0742s/iter; left time: 2059.5836s
Epoch: 41 cost time: 33.02148365974426
Epoch: 41, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.261 Vali Acc: 0.942 Test Loss: 0.261 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.0019224
	speed: 0.3061s/iter; left time: 8440.9693s
	iters: 200, epoch: 42 | loss: 0.0017820
	speed: 0.0641s/iter; left time: 1759.7226s
	iters: 300, epoch: 42 | loss: 0.0861390
	speed: 0.0643s/iter; left time: 1760.9547s
	iters: 400, epoch: 42 | loss: 0.0148103
	speed: 0.0628s/iter; left time: 1713.9645s
Epoch: 42 cost time: 30.677152156829834
Epoch: 42, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.967694 --> -0.969410).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.2301453
	speed: 0.3016s/iter; left time: 8173.7868s
	iters: 200, epoch: 43 | loss: 0.0006279
	speed: 0.0609s/iter; left time: 1644.2004s
	iters: 300, epoch: 43 | loss: 0.0557874
	speed: 0.0648s/iter; left time: 1742.3664s
	iters: 400, epoch: 43 | loss: 0.0812683
	speed: 0.0648s/iter; left time: 1735.5561s
Epoch: 43 cost time: 30.572697639465332
Epoch: 43, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0178412
	speed: 0.3103s/iter; left time: 8263.2361s
	iters: 200, epoch: 44 | loss: 0.0075828
	speed: 0.0657s/iter; left time: 1742.7872s
	iters: 300, epoch: 44 | loss: 0.0013113
	speed: 0.0692s/iter; left time: 1828.6697s
	iters: 400, epoch: 44 | loss: 0.0034363
	speed: 0.0677s/iter; left time: 1782.6419s
Epoch: 44 cost time: 31.94593644142151
Epoch: 44, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0055482
	speed: 0.3116s/iter; left time: 8152.7023s
	iters: 200, epoch: 45 | loss: 0.0125985
	speed: 0.0697s/iter; left time: 1817.0033s
	iters: 300, epoch: 45 | loss: 0.0006317
	speed: 0.0704s/iter; left time: 1826.9029s
	iters: 400, epoch: 45 | loss: 0.0050094
	speed: 0.0671s/iter; left time: 1735.3404s
Epoch: 45 cost time: 32.343106746673584
Epoch: 45, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.213 Vali Acc: 0.955 Test Loss: 0.213 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0009038
	speed: 0.3188s/iter; left time: 8192.5507s
	iters: 200, epoch: 46 | loss: 0.0204556
	speed: 0.0700s/iter; left time: 1791.5904s
	iters: 300, epoch: 46 | loss: 0.1230440
	speed: 0.0683s/iter; left time: 1742.2150s
	iters: 400, epoch: 46 | loss: 0.0050013
	speed: 0.0681s/iter; left time: 1729.9388s
Epoch: 46 cost time: 33.214834213256836
Epoch: 46, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.970839).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.2159587
	speed: 0.3199s/iter; left time: 8068.9312s
	iters: 200, epoch: 47 | loss: 0.0033419
	speed: 0.0680s/iter; left time: 1709.3076s
	iters: 300, epoch: 47 | loss: 0.0013828
	speed: 0.0753s/iter; left time: 1885.0136s
	iters: 400, epoch: 47 | loss: 0.0060532
	speed: 0.0763s/iter; left time: 1903.0384s
Epoch: 47 cost time: 34.337904930114746
Epoch: 47, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.240 Vali Acc: 0.945 Test Loss: 0.240 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 0.0237596
	speed: 0.3017s/iter; left time: 7469.2017s
	iters: 200, epoch: 48 | loss: 0.0459776
	speed: 0.0637s/iter; left time: 1571.8897s
	iters: 300, epoch: 48 | loss: 0.0488253
	speed: 0.0647s/iter; left time: 1589.5070s
	iters: 400, epoch: 48 | loss: 0.0688870
	speed: 0.0725s/iter; left time: 1773.6590s
Epoch: 48 cost time: 32.330745458602905
Epoch: 48, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.183 Vali Acc: 0.966 Test Loss: 0.183 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 0.0061972
	speed: 0.3132s/iter; left time: 7607.7712s
	iters: 200, epoch: 49 | loss: 0.0042148
	speed: 0.0636s/iter; left time: 1539.0970s
	iters: 300, epoch: 49 | loss: 0.0030348
	speed: 0.0695s/iter; left time: 1674.9818s
	iters: 400, epoch: 49 | loss: 0.0211436
	speed: 0.0719s/iter; left time: 1723.8278s
Epoch: 49 cost time: 31.350759267807007
Epoch: 49, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 0.0007879
	speed: 0.2871s/iter; left time: 6838.7653s
	iters: 200, epoch: 50 | loss: 0.0075518
	speed: 0.0729s/iter; left time: 1728.9745s
	iters: 300, epoch: 50 | loss: 0.1929694
	speed: 0.0643s/iter; left time: 1518.7126s
	iters: 400, epoch: 50 | loss: 0.2592775
	speed: 0.0589s/iter; left time: 1385.0072s
Epoch: 50 cost time: 30.625378847122192
Epoch: 50, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.299 Vali Acc: 0.929 Test Loss: 0.299 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 51 | loss: 0.0369485
	speed: 0.2770s/iter; left time: 6468.1038s
	iters: 200, epoch: 51 | loss: 0.0277700
	speed: 0.0681s/iter; left time: 1584.3870s
	iters: 300, epoch: 51 | loss: 0.0342534
	speed: 0.0667s/iter; left time: 1543.7910s
	iters: 400, epoch: 51 | loss: 0.0718157
	speed: 0.0632s/iter; left time: 1456.5797s
Epoch: 51 cost time: 31.14287543296814
Epoch: 51, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 52 | loss: 0.0354341
	speed: 0.2970s/iter; left time: 6794.8696s
	iters: 200, epoch: 52 | loss: 0.0177587
	speed: 0.0659s/iter; left time: 1500.4334s
	iters: 300, epoch: 52 | loss: 0.0007023
	speed: 0.0610s/iter; left time: 1383.1798s
	iters: 400, epoch: 52 | loss: 0.2621139
	speed: 0.0608s/iter; left time: 1373.9258s
Epoch: 52 cost time: 30.60534119606018
Epoch: 52, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 53 | loss: 0.0764861
	speed: 0.2778s/iter; left time: 6227.3218s
	iters: 200, epoch: 53 | loss: 0.0639633
	speed: 0.0630s/iter; left time: 1404.6711s
	iters: 300, epoch: 53 | loss: 0.0113853
	speed: 0.0625s/iter; left time: 1388.8378s
	iters: 400, epoch: 53 | loss: 0.0161471
	speed: 0.0663s/iter; left time: 1465.7682s
Epoch: 53 cost time: 30.75797963142395
Epoch: 53, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 54 | loss: 0.0104810
	speed: 0.3099s/iter; left time: 6800.6624s
	iters: 200, epoch: 54 | loss: 0.0120690
	speed: 0.0614s/iter; left time: 1341.4826s
	iters: 300, epoch: 54 | loss: 0.0151863
	speed: 0.0652s/iter; left time: 1417.8141s
	iters: 400, epoch: 54 | loss: 0.0160982
	speed: 0.0708s/iter; left time: 1531.7299s
Epoch: 54 cost time: 31.460369348526
Epoch: 54, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 55 | loss: 0.0037492
	speed: 0.2939s/iter; left time: 6311.8909s
	iters: 200, epoch: 55 | loss: 0.0071971
	speed: 0.0609s/iter; left time: 1302.6030s
	iters: 300, epoch: 55 | loss: 0.0056861
	speed: 0.0679s/iter; left time: 1444.8043s
	iters: 400, epoch: 55 | loss: 0.0235246
	speed: 0.0643s/iter; left time: 1361.6383s
Epoch: 55 cost time: 30.16329836845398
Epoch: 55, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 56 | loss: 0.0021359
	speed: 0.2902s/iter; left time: 6095.8041s
	iters: 200, epoch: 56 | loss: 0.0511665
	speed: 0.0719s/iter; left time: 1503.1298s
	iters: 300, epoch: 56 | loss: 0.0107233
	speed: 0.0712s/iter; left time: 1481.7429s
	iters: 400, epoch: 56 | loss: 0.0627930
	speed: 0.0687s/iter; left time: 1423.0880s
Epoch: 56 cost time: 33.366368770599365
Epoch: 56, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9708404802744426
model parameter : 8333882
model size : 36.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3164396
	speed: 0.0884s/iter; left time: 4138.8991s
	iters: 200, epoch: 1 | loss: 0.1343877
	speed: 0.0716s/iter; left time: 3343.5226s
	iters: 300, epoch: 1 | loss: 0.2254204
	speed: 0.0683s/iter; left time: 3180.9817s
	iters: 400, epoch: 1 | loss: 0.0363938
	speed: 0.0683s/iter; left time: 3176.1726s
Epoch: 1 cost time: 34.52263689041138
Epoch: 1, Steps: 469 | Train Loss: 0.446 Vali Loss: 0.313 Vali Acc: 0.905 Test Loss: 0.313 Test Acc: 0.905
Validation loss decreased (inf --> -0.905371).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2188846
	speed: 0.3261s/iter; left time: 15110.3646s
	iters: 200, epoch: 2 | loss: 0.0558745
	speed: 0.0686s/iter; left time: 3173.1016s
	iters: 300, epoch: 2 | loss: 0.1327896
	speed: 0.0706s/iter; left time: 3254.7500s
	iters: 400, epoch: 2 | loss: 0.0122751
	speed: 0.0751s/iter; left time: 3455.5190s
Epoch: 2 cost time: 33.666481733322144
Epoch: 2, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.350 Vali Acc: 0.897 Test Loss: 0.350 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0778913
	speed: 0.2987s/iter; left time: 13697.3594s
	iters: 200, epoch: 3 | loss: 0.5924499
	speed: 0.0679s/iter; left time: 3108.8070s
	iters: 300, epoch: 3 | loss: 0.0220214
	speed: 0.0625s/iter; left time: 2852.3646s
	iters: 400, epoch: 3 | loss: 0.0829035
	speed: 0.0615s/iter; left time: 2802.6549s
Epoch: 3 cost time: 30.54637098312378
Epoch: 3, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.311 Vali Acc: 0.893 Test Loss: 0.311 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0558339
	speed: 0.2712s/iter; left time: 12312.8053s
	iters: 200, epoch: 4 | loss: 0.2018833
	speed: 0.0709s/iter; left time: 3210.9079s
	iters: 300, epoch: 4 | loss: 0.4209422
	speed: 0.0680s/iter; left time: 3072.0737s
	iters: 400, epoch: 4 | loss: 0.2846089
	speed: 0.0692s/iter; left time: 3118.8351s
Epoch: 4 cost time: 32.353293895721436
Epoch: 4, Steps: 469 | Train Loss: 0.263 Vali Loss: 0.512 Vali Acc: 0.858 Test Loss: 0.512 Test Acc: 0.858
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1521481
	speed: 0.2933s/iter; left time: 13176.1076s
	iters: 200, epoch: 5 | loss: 0.6331065
	speed: 0.0709s/iter; left time: 3175.8753s
	iters: 300, epoch: 5 | loss: 1.8620837
	speed: 0.0714s/iter; left time: 3193.2908s
	iters: 400, epoch: 5 | loss: 2.3955646
	speed: 0.0715s/iter; left time: 3191.6250s
Epoch: 5 cost time: 32.70703887939453
Epoch: 5, Steps: 469 | Train Loss: 0.965 Vali Loss: 2.758 Vali Acc: 0.345 Test Loss: 2.758 Test Acc: 0.345
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.0256968
	speed: 0.2956s/iter; left time: 13143.2543s
	iters: 200, epoch: 6 | loss: 1.9348294
	speed: 0.0661s/iter; left time: 2930.1564s
	iters: 300, epoch: 6 | loss: 2.0043769
	speed: 0.0631s/iter; left time: 2794.5729s
	iters: 400, epoch: 6 | loss: 2.0945895
	speed: 0.0642s/iter; left time: 2833.6041s
Epoch: 6 cost time: 30.67483949661255
Epoch: 6, Steps: 469 | Train Loss: 2.057 Vali Loss: 1.972 Vali Acc: 0.203 Test Loss: 1.972 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.1896811
	speed: 0.2997s/iter; left time: 13185.0696s
	iters: 200, epoch: 7 | loss: 2.0956481
	speed: 0.0663s/iter; left time: 2908.1015s
	iters: 300, epoch: 7 | loss: 1.7030536
	speed: 0.0623s/iter; left time: 2727.6020s
	iters: 400, epoch: 7 | loss: 1.9882380
	speed: 0.0638s/iter; left time: 2788.2355s
Epoch: 7 cost time: 30.87189245223999
Epoch: 7, Steps: 469 | Train Loss: 1.953 Vali Loss: 1.915 Vali Acc: 0.203 Test Loss: 1.915 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.7482352
	speed: 0.3008s/iter; left time: 13091.2268s
	iters: 200, epoch: 8 | loss: 2.2652445
	speed: 0.0655s/iter; left time: 2843.8411s
	iters: 300, epoch: 8 | loss: 1.9776669
	speed: 0.0668s/iter; left time: 2893.4434s
	iters: 400, epoch: 8 | loss: 2.1254308
	speed: 0.0704s/iter; left time: 3043.5098s
Epoch: 8 cost time: 32.135698556900024
Epoch: 8, Steps: 469 | Train Loss: 1.950 Vali Loss: 1.920 Vali Acc: 0.191 Test Loss: 1.920 Test Acc: 0.191
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.1797702
	speed: 0.2969s/iter; left time: 12783.1649s
	iters: 200, epoch: 9 | loss: 2.0101199
	speed: 0.0723s/iter; left time: 3107.1744s
	iters: 300, epoch: 9 | loss: 1.8045690
	speed: 0.0753s/iter; left time: 3227.8439s
	iters: 400, epoch: 9 | loss: 1.9888663
	speed: 0.0695s/iter; left time: 2971.4079s
Epoch: 9 cost time: 33.33023715019226
Epoch: 9, Steps: 469 | Train Loss: 1.951 Vali Loss: 1.899 Vali Acc: 0.203 Test Loss: 1.899 Test Acc: 0.203
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.9013323
	speed: 0.3238s/iter; left time: 13786.8106s
	iters: 200, epoch: 10 | loss: 1.8869989
	speed: 0.0687s/iter; left time: 2917.8984s
	iters: 300, epoch: 10 | loss: 2.0871210
	speed: 0.0700s/iter; left time: 2967.4377s
	iters: 400, epoch: 10 | loss: 1.9968526
	speed: 0.0697s/iter; left time: 2947.2102s
Epoch: 10 cost time: 33.48734211921692
Epoch: 10, Steps: 469 | Train Loss: 1.907 Vali Loss: 1.924 Vali Acc: 0.182 Test Loss: 1.924 Test Acc: 0.182
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.9798702
	speed: 0.3233s/iter; left time: 13615.7936s
	iters: 200, epoch: 11 | loss: 1.7072349
	speed: 0.0711s/iter; left time: 2986.8406s
	iters: 300, epoch: 11 | loss: 1.8873210
	speed: 0.0756s/iter; left time: 3167.9052s
	iters: 400, epoch: 11 | loss: 1.6261708
	speed: 0.0767s/iter; left time: 3207.3337s
Epoch: 11 cost time: 35.40668320655823
Epoch: 11, Steps: 469 | Train Loss: 1.906 Vali Loss: 1.905 Vali Acc: 0.203 Test Loss: 1.905 Test Acc: 0.203
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9053744997141223
model parameter : 7876538
model size : 35.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5045332
	speed: 0.0808s/iter; left time: 3782.6576s
	iters: 200, epoch: 1 | loss: 0.3356134
	speed: 0.0736s/iter; left time: 3437.7710s
	iters: 300, epoch: 1 | loss: 0.1259517
	speed: 0.0691s/iter; left time: 3221.1045s
	iters: 400, epoch: 1 | loss: 0.1132703
	speed: 0.0659s/iter; left time: 3064.7539s
Epoch: 1 cost time: 33.87719225883484
Epoch: 1, Steps: 469 | Train Loss: 0.450 Vali Loss: 0.431 Vali Acc: 0.879 Test Loss: 0.431 Test Acc: 0.879
Validation loss decreased (inf --> -0.878498).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1502534
	speed: 0.3136s/iter; left time: 14529.2076s
	iters: 200, epoch: 2 | loss: 0.4832254
	speed: 0.0706s/iter; left time: 3263.0542s
	iters: 300, epoch: 2 | loss: 0.0233587
	speed: 0.0742s/iter; left time: 3424.9810s
	iters: 400, epoch: 2 | loss: 0.0792657
	speed: 0.0765s/iter; left time: 3519.7660s
Epoch: 2 cost time: 34.40891885757446
Epoch: 2, Steps: 469 | Train Loss: 0.223 Vali Loss: 0.295 Vali Acc: 0.901 Test Loss: 0.295 Test Acc: 0.901
Validation loss decreased (-0.878498 --> -0.901083).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0512888
	speed: 0.3060s/iter; left time: 14034.3713s
	iters: 200, epoch: 3 | loss: 0.4198475
	speed: 0.0695s/iter; left time: 3179.2808s
	iters: 300, epoch: 3 | loss: 0.3063484
	speed: 0.0655s/iter; left time: 2989.3751s
	iters: 400, epoch: 3 | loss: 0.2535774
	speed: 0.0655s/iter; left time: 2982.9049s
Epoch: 3 cost time: 31.647204399108887
Epoch: 3, Steps: 469 | Train Loss: 0.240 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3335546
	speed: 0.3071s/iter; left time: 13941.9143s
	iters: 200, epoch: 4 | loss: 0.2739812
	speed: 0.0771s/iter; left time: 3490.7670s
	iters: 300, epoch: 4 | loss: 0.2951217
	speed: 0.0721s/iter; left time: 3260.3454s
	iters: 400, epoch: 4 | loss: 0.1643197
	speed: 0.0682s/iter; left time: 3073.3149s
Epoch: 4 cost time: 34.57903289794922
Epoch: 4, Steps: 469 | Train Loss: 0.290 Vali Loss: 0.382 Vali Acc: 0.872 Test Loss: 0.382 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0891380
	speed: 0.3164s/iter; left time: 14213.5460s
	iters: 200, epoch: 5 | loss: 0.2309019
	speed: 0.0649s/iter; left time: 2908.3502s
	iters: 300, epoch: 5 | loss: 1.2354499
	speed: 0.0671s/iter; left time: 3000.6183s
	iters: 400, epoch: 5 | loss: 1.4320295
	speed: 0.0666s/iter; left time: 2972.1742s
Epoch: 5 cost time: 31.877644538879395
Epoch: 5, Steps: 469 | Train Loss: 0.946 Vali Loss: 2.145 Vali Acc: 0.210 Test Loss: 2.145 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.5690889
	speed: 0.3143s/iter; left time: 13974.7405s
	iters: 200, epoch: 6 | loss: 1.6552150
	speed: 0.0667s/iter; left time: 2959.2677s
	iters: 300, epoch: 6 | loss: 2.3218827
	speed: 0.0647s/iter; left time: 2862.6116s
	iters: 400, epoch: 6 | loss: 2.2992489
	speed: 0.0687s/iter; left time: 3033.0125s
Epoch: 6 cost time: 32.70705485343933
Epoch: 6, Steps: 469 | Train Loss: 2.186 Vali Loss: 2.089 Vali Acc: 0.190 Test Loss: 2.089 Test Acc: 0.190
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.0072672
	speed: 0.3165s/iter; left time: 13923.4648s
	iters: 200, epoch: 7 | loss: 2.0687551
	speed: 0.0710s/iter; left time: 3117.4234s
	iters: 300, epoch: 7 | loss: 2.0844927
	speed: 0.0734s/iter; left time: 3215.6092s
	iters: 400, epoch: 7 | loss: 1.9193645
	speed: 0.0722s/iter; left time: 3152.2940s
Epoch: 7 cost time: 33.87869310379028
Epoch: 7, Steps: 469 | Train Loss: 2.068 Vali Loss: 2.315 Vali Acc: 0.104 Test Loss: 2.315 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3117046
	speed: 0.3148s/iter; left time: 13699.7533s
	iters: 200, epoch: 8 | loss: 2.4228876
	speed: 0.0711s/iter; left time: 3086.7905s
	iters: 300, epoch: 8 | loss: 2.3247647
	speed: 0.0746s/iter; left time: 3231.3517s
	iters: 400, epoch: 8 | loss: 2.2389357
	speed: 0.0728s/iter; left time: 3144.2167s
Epoch: 8 cost time: 34.25952434539795
Epoch: 8, Steps: 469 | Train Loss: 2.314 Vali Loss: 2.313 Vali Acc: 0.104 Test Loss: 2.313 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3246510
	speed: 0.3153s/iter; left time: 13573.8736s
	iters: 200, epoch: 9 | loss: 2.2415581
	speed: 0.0700s/iter; left time: 3008.4697s
	iters: 300, epoch: 9 | loss: 2.2817945
	speed: 0.0744s/iter; left time: 3188.4298s
	iters: 400, epoch: 9 | loss: 2.3597980
	speed: 0.0703s/iter; left time: 3006.8110s
Epoch: 9 cost time: 34.071126222610474
Epoch: 9, Steps: 469 | Train Loss: 2.311 Vali Loss: 2.304 Vali Acc: 0.096 Test Loss: 2.304 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.3475950
	speed: 0.3165s/iter; left time: 13476.1957s
	iters: 200, epoch: 10 | loss: 2.3061919
	speed: 0.0677s/iter; left time: 2877.8372s
	iters: 300, epoch: 10 | loss: 2.3583148
	speed: 0.0655s/iter; left time: 2777.8278s
	iters: 400, epoch: 10 | loss: 2.3207631
	speed: 0.0669s/iter; left time: 2826.9989s
Epoch: 10 cost time: 32.10163378715515
Epoch: 10, Steps: 469 | Train Loss: 2.310 Vali Loss: 2.308 Vali Acc: 0.104 Test Loss: 2.308 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3163207
	speed: 0.3143s/iter; left time: 13235.4227s
	iters: 200, epoch: 11 | loss: 2.3144617
	speed: 0.0701s/iter; left time: 2944.5065s
	iters: 300, epoch: 11 | loss: 2.2973828
	speed: 0.0683s/iter; left time: 2862.1160s
	iters: 400, epoch: 11 | loss: 2.2943559
	speed: 0.0698s/iter; left time: 2919.3964s
Epoch: 11 cost time: 32.972052812576294
Epoch: 11, Steps: 469 | Train Loss: 2.309 Vali Loss: 2.303 Vali Acc: 0.104 Test Loss: 2.303 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3255975
	speed: 0.3147s/iter; left time: 13105.5822s
	iters: 200, epoch: 12 | loss: 2.2695413
	speed: 0.0686s/iter; left time: 2851.5911s
	iters: 300, epoch: 12 | loss: 2.3289001
	speed: 0.0663s/iter; left time: 2748.8137s
	iters: 400, epoch: 12 | loss: 2.2692084
	speed: 0.0659s/iter; left time: 2722.7145s
Epoch: 12 cost time: 32.302406787872314
Epoch: 12, Steps: 469 | Train Loss: 2.308 Vali Loss: 2.308 Vali Acc: 0.096 Test Loss: 2.308 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9010863350485993
model parameter : 7875770
model size : 35.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2884985
	speed: 0.0925s/iter; left time: 4328.3211s
	iters: 200, epoch: 1 | loss: 1.0792859
	speed: 0.0668s/iter; left time: 3118.1473s
	iters: 300, epoch: 1 | loss: 0.1158930
	speed: 0.0714s/iter; left time: 3326.1710s
	iters: 400, epoch: 1 | loss: 0.1447238
	speed: 0.0717s/iter; left time: 3334.2552s
Epoch: 1 cost time: 35.25241804122925
Epoch: 1, Steps: 469 | Train Loss: 0.438 Vali Loss: 0.378 Vali Acc: 0.876 Test Loss: 0.378 Test Acc: 0.876
Validation loss decreased (inf --> -0.875639).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6733931
	speed: 0.3062s/iter; left time: 14185.3839s
	iters: 200, epoch: 2 | loss: 0.5441784
	speed: 0.0706s/iter; left time: 3265.9768s
	iters: 300, epoch: 2 | loss: 0.2207703
	speed: 0.0759s/iter; left time: 3501.3679s
	iters: 400, epoch: 2 | loss: 0.1807974
	speed: 0.0750s/iter; left time: 3452.8954s
Epoch: 2 cost time: 34.12100338935852
Epoch: 2, Steps: 469 | Train Loss: 0.240 Vali Loss: 0.264 Vali Acc: 0.909 Test Loss: 0.264 Test Acc: 0.909
Validation loss decreased (-0.875639 --> -0.908517).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4872653
	speed: 0.3068s/iter; left time: 14071.5749s
	iters: 200, epoch: 3 | loss: 0.2039820
	speed: 0.0776s/iter; left time: 3549.0705s
	iters: 300, epoch: 3 | loss: 0.5236323
	speed: 0.0725s/iter; left time: 3309.3448s
	iters: 400, epoch: 3 | loss: 0.1729557
	speed: 0.0683s/iter; left time: 3110.5446s
Epoch: 3 cost time: 34.24323916435242
Epoch: 3, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
Validation loss decreased (-0.908517 --> -0.925383).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3613826
	speed: 0.3382s/iter; left time: 15351.2090s
	iters: 200, epoch: 4 | loss: 0.4383830
	speed: 0.0697s/iter; left time: 3157.2047s
	iters: 300, epoch: 4 | loss: 0.0505249
	speed: 0.0720s/iter; left time: 3252.4992s
	iters: 400, epoch: 4 | loss: 0.0702421
	speed: 0.0780s/iter; left time: 3519.4617s
Epoch: 4 cost time: 35.328922510147095
Epoch: 4, Steps: 469 | Train Loss: 0.239 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.925383 --> -0.931387).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8023357
	speed: 0.3576s/iter; left time: 16065.6350s
	iters: 200, epoch: 5 | loss: 0.4300187
	speed: 0.0784s/iter; left time: 3515.0477s
	iters: 300, epoch: 5 | loss: 0.0896703
	speed: 0.0752s/iter; left time: 3364.3281s
	iters: 400, epoch: 5 | loss: 0.4318359
	speed: 0.0730s/iter; left time: 3255.3948s
Epoch: 5 cost time: 36.17224383354187
Epoch: 5, Steps: 469 | Train Loss: 0.259 Vali Loss: 0.367 Vali Acc: 0.916 Test Loss: 0.367 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5273364
	speed: 0.3298s/iter; left time: 14661.4110s
	iters: 200, epoch: 6 | loss: 0.2566417
	speed: 0.0793s/iter; left time: 3516.0479s
	iters: 300, epoch: 6 | loss: 0.1735068
	speed: 0.0793s/iter; left time: 3509.4192s
	iters: 400, epoch: 6 | loss: 0.4034053
	speed: 0.0755s/iter; left time: 3333.0344s
Epoch: 6 cost time: 35.60650849342346
Epoch: 6, Steps: 469 | Train Loss: 0.296 Vali Loss: 0.459 Vali Acc: 0.871 Test Loss: 0.459 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0972391
	speed: 0.3036s/iter; left time: 13355.7011s
	iters: 200, epoch: 7 | loss: 0.8838578
	speed: 0.0670s/iter; left time: 2939.7537s
	iters: 300, epoch: 7 | loss: 0.0539491
	speed: 0.0687s/iter; left time: 3008.1341s
	iters: 400, epoch: 7 | loss: 0.0817648
	speed: 0.0716s/iter; left time: 3127.4408s
Epoch: 7 cost time: 32.936880111694336
Epoch: 7, Steps: 469 | Train Loss: 0.363 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0975759
	speed: 0.3259s/iter; left time: 14180.5674s
	iters: 200, epoch: 8 | loss: 0.4752989
	speed: 0.0711s/iter; left time: 3086.3652s
	iters: 300, epoch: 8 | loss: 0.4721367
	speed: 0.0803s/iter; left time: 3479.7590s
	iters: 400, epoch: 8 | loss: 0.2651128
	speed: 0.0767s/iter; left time: 3313.5302s
Epoch: 8 cost time: 34.963268518447876
Epoch: 8, Steps: 469 | Train Loss: 0.362 Vali Loss: 0.529 Vali Acc: 0.852 Test Loss: 0.529 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0551907
	speed: 0.3257s/iter; left time: 14022.5653s
	iters: 200, epoch: 9 | loss: 0.2821708
	speed: 0.0744s/iter; left time: 3196.3967s
	iters: 300, epoch: 9 | loss: 0.1668130
	speed: 0.0716s/iter; left time: 3067.3716s
	iters: 400, epoch: 9 | loss: 0.1200348
	speed: 0.0700s/iter; left time: 2990.5121s
Epoch: 9 cost time: 34.65313744544983
Epoch: 9, Steps: 469 | Train Loss: 0.362 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4976007
	speed: 0.3216s/iter; left time: 13692.5976s
	iters: 200, epoch: 10 | loss: 0.1805069
	speed: 0.0721s/iter; left time: 3064.1006s
	iters: 300, epoch: 10 | loss: 0.0815766
	speed: 0.0683s/iter; left time: 2893.2019s
	iters: 400, epoch: 10 | loss: 0.3787658
	speed: 0.0719s/iter; left time: 3040.6745s
Epoch: 10 cost time: 34.19142532348633
Epoch: 10, Steps: 469 | Train Loss: 0.307 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1616988
	speed: 0.3109s/iter; left time: 13091.6119s
	iters: 200, epoch: 11 | loss: 0.6554040
	speed: 0.0679s/iter; left time: 2853.4524s
	iters: 300, epoch: 11 | loss: 0.1783701
	speed: 0.0656s/iter; left time: 2750.8558s
	iters: 400, epoch: 11 | loss: 0.5063655
	speed: 0.0748s/iter; left time: 3128.9817s
Epoch: 11 cost time: 33.78313159942627
Epoch: 11, Steps: 469 | Train Loss: 0.271 Vali Loss: 0.398 Vali Acc: 0.898 Test Loss: 0.398 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0676579
	speed: 0.3213s/iter; left time: 13379.7783s
	iters: 200, epoch: 12 | loss: 0.5747505
	speed: 0.0718s/iter; left time: 2982.5808s
	iters: 300, epoch: 12 | loss: 0.0957954
	speed: 0.0748s/iter; left time: 3101.3794s
	iters: 400, epoch: 12 | loss: 0.0395567
	speed: 0.0723s/iter; left time: 2990.2304s
Epoch: 12 cost time: 34.41204595565796
Epoch: 12, Steps: 469 | Train Loss: 0.243 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0621328
	speed: 0.3480s/iter; left time: 14326.9257s
	iters: 200, epoch: 13 | loss: 0.3190930
	speed: 0.0687s/iter; left time: 2823.3903s
	iters: 300, epoch: 13 | loss: 0.1164189
	speed: 0.0703s/iter; left time: 2879.8199s
	iters: 400, epoch: 13 | loss: 0.3204058
	speed: 0.0687s/iter; left time: 2809.1998s
Epoch: 13 cost time: 34.18667507171631
Epoch: 13, Steps: 469 | Train Loss: 0.278 Vali Loss: 0.320 Vali Acc: 0.915 Test Loss: 0.320 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2912597
	speed: 0.3379s/iter; left time: 13753.6514s
	iters: 200, epoch: 14 | loss: 0.3202553
	speed: 0.0734s/iter; left time: 2982.2435s
	iters: 300, epoch: 14 | loss: 0.1796254
	speed: 0.0772s/iter; left time: 3125.0897s
	iters: 400, epoch: 14 | loss: 0.4004012
	speed: 0.0719s/iter; left time: 2906.2562s
Epoch: 14 cost time: 34.922571420669556
Epoch: 14, Steps: 469 | Train Loss: 0.273 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9313893653516295
model parameter : 7875002
model size : 35.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2045895
	speed: 0.0889s/iter; left time: 4162.0080s
	iters: 200, epoch: 1 | loss: 0.2663337
	speed: 0.0705s/iter; left time: 3290.7331s
	iters: 300, epoch: 1 | loss: 0.1239872
	speed: 0.0696s/iter; left time: 3244.2549s
	iters: 400, epoch: 1 | loss: 0.1009768
	speed: 0.0711s/iter; left time: 3306.1428s
Epoch: 1 cost time: 35.05561304092407
Epoch: 1, Steps: 469 | Train Loss: 0.444 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
Validation loss decreased (inf --> -0.894222).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4038484
	speed: 0.3154s/iter; left time: 14612.1538s
	iters: 200, epoch: 2 | loss: 0.0822464
	speed: 0.0722s/iter; left time: 3338.1521s
	iters: 300, epoch: 2 | loss: 0.1104907
	speed: 0.0772s/iter; left time: 3559.3785s
	iters: 400, epoch: 2 | loss: 0.3044393
	speed: 0.0742s/iter; left time: 3417.8141s
Epoch: 2 cost time: 34.532893896102905
Epoch: 2, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1394153
	speed: 0.3017s/iter; left time: 13835.2321s
	iters: 200, epoch: 3 | loss: 0.5921102
	speed: 0.0707s/iter; left time: 3233.2764s
	iters: 300, epoch: 3 | loss: 0.2434271
	speed: 0.0685s/iter; left time: 3126.5593s
	iters: 400, epoch: 3 | loss: 0.4681813
	speed: 0.0702s/iter; left time: 3199.6357s
Epoch: 3 cost time: 33.3807418346405
Epoch: 3, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.894222 --> -0.931387).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3400847
	speed: 0.3074s/iter; left time: 13956.3230s
	iters: 200, epoch: 4 | loss: 0.1550816
	speed: 0.0670s/iter; left time: 3034.7756s
	iters: 300, epoch: 4 | loss: 0.1090825
	speed: 0.0724s/iter; left time: 3270.9104s
	iters: 400, epoch: 4 | loss: 0.0188033
	speed: 0.0676s/iter; left time: 3050.5845s
Epoch: 4 cost time: 32.62734508514404
Epoch: 4, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.397 Vali Acc: 0.905 Test Loss: 0.397 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6073166
	speed: 0.3109s/iter; left time: 13966.0831s
	iters: 200, epoch: 5 | loss: 0.4361716
	speed: 0.0685s/iter; left time: 3068.6576s
	iters: 300, epoch: 5 | loss: 0.0959334
	speed: 0.0668s/iter; left time: 2988.4039s
	iters: 400, epoch: 5 | loss: 0.1552692
	speed: 0.0670s/iter; left time: 2989.3729s
Epoch: 5 cost time: 32.1409637928009
Epoch: 5, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3111959
	speed: 0.2821s/iter; left time: 12542.3129s
	iters: 200, epoch: 6 | loss: 0.9226148
	speed: 0.0629s/iter; left time: 2792.0439s
	iters: 300, epoch: 6 | loss: 0.6142752
	speed: 0.0734s/iter; left time: 3249.4308s
	iters: 400, epoch: 6 | loss: 0.1183463
	speed: 0.0675s/iter; left time: 2979.0829s
Epoch: 6 cost time: 31.326172590255737
Epoch: 6, Steps: 469 | Train Loss: 0.219 Vali Loss: 0.346 Vali Acc: 0.918 Test Loss: 0.346 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0453567
	speed: 0.3018s/iter; left time: 13273.8838s
	iters: 200, epoch: 7 | loss: 0.0547005
	speed: 0.0719s/iter; left time: 3153.6514s
	iters: 300, epoch: 7 | loss: 0.1742330
	speed: 0.0759s/iter; left time: 3324.9294s
	iters: 400, epoch: 7 | loss: 0.3534841
	speed: 0.0743s/iter; left time: 3245.1394s
Epoch: 7 cost time: 34.44021797180176
Epoch: 7, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.501 Vali Acc: 0.879 Test Loss: 0.501 Test Acc: 0.879
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1451171
	speed: 0.3179s/iter; left time: 13834.1717s
	iters: 200, epoch: 8 | loss: 0.0432910
	speed: 0.0683s/iter; left time: 2963.7551s
	iters: 300, epoch: 8 | loss: 0.3672950
	speed: 0.0690s/iter; left time: 2987.4719s
	iters: 400, epoch: 8 | loss: 0.0297261
	speed: 0.0666s/iter; left time: 2880.2680s
Epoch: 8 cost time: 32.26881289482117
Epoch: 8, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.273 Vali Acc: 0.938 Test Loss: 0.273 Test Acc: 0.938
Validation loss decreased (-0.931387 --> -0.937676).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0468378
	speed: 0.3068s/iter; left time: 13207.2369s
	iters: 200, epoch: 9 | loss: 0.4068833
	speed: 0.0648s/iter; left time: 2784.0317s
	iters: 300, epoch: 9 | loss: 0.0270672
	speed: 0.0599s/iter; left time: 2567.7500s
	iters: 400, epoch: 9 | loss: 0.5220445
	speed: 0.0571s/iter; left time: 2440.6339s
Epoch: 9 cost time: 30.1651930809021
Epoch: 9, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1056793
	speed: 0.2790s/iter; left time: 11879.9859s
	iters: 200, epoch: 10 | loss: 0.0182349
	speed: 0.0667s/iter; left time: 2834.1098s
	iters: 300, epoch: 10 | loss: 0.0919363
	speed: 0.0639s/iter; left time: 2706.2641s
	iters: 400, epoch: 10 | loss: 0.1588410
	speed: 0.0622s/iter; left time: 2628.2670s
Epoch: 10 cost time: 30.597262620925903
Epoch: 10, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
Validation loss decreased (-0.937676 --> -0.946539).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2833212
	speed: 0.2858s/iter; left time: 12035.9721s
	iters: 200, epoch: 11 | loss: 0.0101981
	speed: 0.0636s/iter; left time: 2672.3503s
	iters: 300, epoch: 11 | loss: 0.4492639
	speed: 0.0625s/iter; left time: 2618.3004s
	iters: 400, epoch: 11 | loss: 0.3713725
	speed: 0.0693s/iter; left time: 2899.4758s
Epoch: 11 cost time: 30.71946144104004
Epoch: 11, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0555452
	speed: 0.3027s/iter; left time: 12604.5361s
	iters: 200, epoch: 12 | loss: 0.0419754
	speed: 0.0607s/iter; left time: 2522.6460s
	iters: 300, epoch: 12 | loss: 0.0889582
	speed: 0.0640s/iter; left time: 2651.3178s
	iters: 400, epoch: 12 | loss: 0.0081928
	speed: 0.0654s/iter; left time: 2704.6989s
Epoch: 12 cost time: 30.898552417755127
Epoch: 12, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.258 Vali Acc: 0.934 Test Loss: 0.258 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1055958
	speed: 0.2841s/iter; left time: 11697.0396s
	iters: 200, epoch: 13 | loss: 0.1291185
	speed: 0.0654s/iter; left time: 2686.1580s
	iters: 300, epoch: 13 | loss: 0.0112076
	speed: 0.0637s/iter; left time: 2608.9499s
	iters: 400, epoch: 13 | loss: 0.1014645
	speed: 0.0642s/iter; left time: 2623.8645s
Epoch: 13 cost time: 30.190462350845337
Epoch: 13, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.280 Vali Acc: 0.921 Test Loss: 0.280 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1064535
	speed: 0.2813s/iter; left time: 11451.7181s
	iters: 200, epoch: 14 | loss: 0.0399958
	speed: 0.0618s/iter; left time: 2510.4843s
	iters: 300, epoch: 14 | loss: 0.0140326
	speed: 0.0595s/iter; left time: 2410.7403s
	iters: 400, epoch: 14 | loss: 0.0623604
	speed: 0.0635s/iter; left time: 2566.7833s
Epoch: 14 cost time: 29.58333468437195
Epoch: 14, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1050454
	speed: 0.2856s/iter; left time: 11490.3916s
	iters: 200, epoch: 15 | loss: 0.5203456
	speed: 0.0647s/iter; left time: 2595.3350s
	iters: 300, epoch: 15 | loss: 0.0167501
	speed: 0.0662s/iter; left time: 2648.6632s
	iters: 400, epoch: 15 | loss: 0.3628171
	speed: 0.0649s/iter; left time: 2590.6589s
Epoch: 15 cost time: 30.813421726226807
Epoch: 15, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.348 Vali Acc: 0.921 Test Loss: 0.348 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.3074854
	speed: 0.2980s/iter; left time: 11848.5029s
	iters: 200, epoch: 16 | loss: 0.0882988
	speed: 0.0682s/iter; left time: 2705.2830s
	iters: 300, epoch: 16 | loss: 0.2075885
	speed: 0.0688s/iter; left time: 2722.6235s
	iters: 400, epoch: 16 | loss: 0.5282757
	speed: 0.0699s/iter; left time: 2758.6175s
Epoch: 16 cost time: 33.09894895553589
Epoch: 16, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1864038
	speed: 0.3097s/iter; left time: 12171.1061s
	iters: 200, epoch: 17 | loss: 0.0200643
	speed: 0.0687s/iter; left time: 2693.4773s
	iters: 300, epoch: 17 | loss: 0.0132132
	speed: 0.0674s/iter; left time: 2636.3221s
	iters: 400, epoch: 17 | loss: 0.1413763
	speed: 0.0670s/iter; left time: 2612.6702s
Epoch: 17 cost time: 32.4545259475708
Epoch: 17, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4698008
	speed: 0.3095s/iter; left time: 12016.5560s
	iters: 200, epoch: 18 | loss: 0.0066440
	speed: 0.0641s/iter; left time: 2482.7921s
	iters: 300, epoch: 18 | loss: 0.3360212
	speed: 0.0629s/iter; left time: 2430.0527s
	iters: 400, epoch: 18 | loss: 0.0494833
	speed: 0.0644s/iter; left time: 2482.2284s
Epoch: 18 cost time: 30.39406442642212
Epoch: 18, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0703046
	speed: 0.2903s/iter; left time: 11134.3744s
	iters: 200, epoch: 19 | loss: 0.0723565
	speed: 0.0668s/iter; left time: 2556.1545s
	iters: 300, epoch: 19 | loss: 0.0362571
	speed: 0.0694s/iter; left time: 2647.5748s
	iters: 400, epoch: 19 | loss: 0.3123513
	speed: 0.0697s/iter; left time: 2651.4861s
Epoch: 19 cost time: 31.92437982559204
Epoch: 19, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.194 Vali Acc: 0.945 Test Loss: 0.194 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0084771
	speed: 0.2805s/iter; left time: 10626.3280s
	iters: 200, epoch: 20 | loss: 0.5373338
	speed: 0.0657s/iter; left time: 2484.1251s
	iters: 300, epoch: 20 | loss: 0.0147541
	speed: 0.0653s/iter; left time: 2460.9983s
	iters: 400, epoch: 20 | loss: 0.0093312
	speed: 0.0662s/iter; left time: 2486.8497s
Epoch: 20 cost time: 31.160442352294922
Epoch: 20, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9465408805031447
model parameter : 7874234
model size : 35.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4268519
	speed: 0.0804s/iter; left time: 3763.6215s
	iters: 200, epoch: 1 | loss: 0.2405292
	speed: 0.0705s/iter; left time: 3292.8596s
	iters: 300, epoch: 1 | loss: 0.3207146
	speed: 0.0708s/iter; left time: 3298.2470s
	iters: 400, epoch: 1 | loss: 0.0946899
	speed: 0.0743s/iter; left time: 3454.7556s
Epoch: 1 cost time: 34.503044843673706
Epoch: 1, Steps: 469 | Train Loss: 0.476 Vali Loss: 0.274 Vali Acc: 0.905 Test Loss: 0.274 Test Acc: 0.905
Validation loss decreased (inf --> -0.904514).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0615317
	speed: 0.2883s/iter; left time: 13357.5997s
	iters: 200, epoch: 2 | loss: 0.1063854
	speed: 0.0675s/iter; left time: 3120.5825s
	iters: 300, epoch: 2 | loss: 0.3006349
	speed: 0.0642s/iter; left time: 2959.6131s
	iters: 400, epoch: 2 | loss: 0.4442013
	speed: 0.0676s/iter; left time: 3111.0296s
Epoch: 2 cost time: 31.79693078994751
Epoch: 2, Steps: 469 | Train Loss: 0.206 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
Validation loss decreased (-0.904514 --> -0.913090).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4270231
	speed: 0.2990s/iter; left time: 13711.4264s
	iters: 200, epoch: 3 | loss: 0.0349222
	speed: 0.0669s/iter; left time: 3060.4760s
	iters: 300, epoch: 3 | loss: 0.2494029
	speed: 0.0715s/iter; left time: 3267.1588s
	iters: 400, epoch: 3 | loss: 0.2489805
	speed: 0.0696s/iter; left time: 3171.2789s
Epoch: 3 cost time: 32.1891655921936
Epoch: 3, Steps: 469 | Train Loss: 0.191 Vali Loss: 0.277 Vali Acc: 0.939 Test Loss: 0.277 Test Acc: 0.939
Validation loss decreased (-0.913090 --> -0.938819).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3274407
	speed: 0.3121s/iter; left time: 14166.9320s
	iters: 200, epoch: 4 | loss: 0.1368337
	speed: 0.0716s/iter; left time: 3243.0982s
	iters: 300, epoch: 4 | loss: 0.3106554
	speed: 0.0762s/iter; left time: 3442.7247s
	iters: 400, epoch: 4 | loss: 0.0534867
	speed: 0.0721s/iter; left time: 3249.6940s
Epoch: 4 cost time: 34.464003562927246
Epoch: 4, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0309855
	speed: 0.3191s/iter; left time: 14337.1412s
	iters: 200, epoch: 5 | loss: 0.0030873
	speed: 0.0711s/iter; left time: 3189.1625s
	iters: 300, epoch: 5 | loss: 0.0338028
	speed: 0.0723s/iter; left time: 3234.9696s
	iters: 400, epoch: 5 | loss: 0.0443145
	speed: 0.0704s/iter; left time: 3141.2013s
Epoch: 5 cost time: 33.78647065162659
Epoch: 5, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.938819 --> -0.949969).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0085762
	speed: 0.3170s/iter; left time: 14091.8050s
	iters: 200, epoch: 6 | loss: 0.3291856
	speed: 0.0679s/iter; left time: 3012.2456s
	iters: 300, epoch: 6 | loss: 0.0257635
	speed: 0.0695s/iter; left time: 3076.0901s
	iters: 400, epoch: 6 | loss: 0.2124034
	speed: 0.0685s/iter; left time: 3023.3969s
Epoch: 6 cost time: 33.285555839538574
Epoch: 6, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0233107
	speed: 0.3267s/iter; left time: 14372.5873s
	iters: 200, epoch: 7 | loss: 0.0167929
	speed: 0.0665s/iter; left time: 2916.4114s
	iters: 300, epoch: 7 | loss: 0.1117982
	speed: 0.0740s/iter; left time: 3239.5732s
	iters: 400, epoch: 7 | loss: 0.0968446
	speed: 0.0643s/iter; left time: 2809.4029s
Epoch: 7 cost time: 32.507134199142456
Epoch: 7, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.227 Vali Acc: 0.947 Test Loss: 0.227 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5038642
	speed: 0.2823s/iter; left time: 12284.9485s
	iters: 200, epoch: 8 | loss: 0.0098363
	speed: 0.0701s/iter; left time: 3044.0131s
	iters: 300, epoch: 8 | loss: 0.0050577
	speed: 0.0644s/iter; left time: 2790.7813s
	iters: 400, epoch: 8 | loss: 0.5391544
	speed: 0.0666s/iter; left time: 2876.8661s
Epoch: 8 cost time: 31.820530652999878
Epoch: 8, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.521 Vali Acc: 0.863 Test Loss: 0.521 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2591255
	speed: 0.3045s/iter; left time: 13110.3213s
	iters: 200, epoch: 9 | loss: 0.0130129
	speed: 0.0659s/iter; left time: 2828.8292s
	iters: 300, epoch: 9 | loss: 0.0160437
	speed: 0.0656s/iter; left time: 2810.5251s
	iters: 400, epoch: 9 | loss: 0.3575187
	speed: 0.0655s/iter; left time: 2798.2987s
Epoch: 9 cost time: 31.553446292877197
Epoch: 9, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.374 Vali Acc: 0.914 Test Loss: 0.374 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0039256
	speed: 0.2982s/iter; left time: 12696.0050s
	iters: 200, epoch: 10 | loss: 0.1120418
	speed: 0.0670s/iter; left time: 2847.1932s
	iters: 300, epoch: 10 | loss: 0.0071284
	speed: 0.0668s/iter; left time: 2828.9224s
	iters: 400, epoch: 10 | loss: 0.4689066
	speed: 0.0686s/iter; left time: 2898.3623s
Epoch: 10 cost time: 31.831692218780518
Epoch: 10, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0953715
	speed: 0.3016s/iter; left time: 12701.1955s
	iters: 200, epoch: 11 | loss: 0.0089087
	speed: 0.0695s/iter; left time: 2920.8507s
	iters: 300, epoch: 11 | loss: 0.0140297
	speed: 0.0689s/iter; left time: 2888.3476s
	iters: 400, epoch: 11 | loss: 0.0093976
	speed: 0.0759s/iter; left time: 3171.9076s
Epoch: 11 cost time: 34.137380838394165
Epoch: 11, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0027399
	speed: 0.3115s/iter; left time: 12971.6808s
	iters: 200, epoch: 12 | loss: 0.0044576
	speed: 0.0691s/iter; left time: 2872.0159s
	iters: 300, epoch: 12 | loss: 0.3140804
	speed: 0.0676s/iter; left time: 2803.0297s
	iters: 400, epoch: 12 | loss: 0.0658649
	speed: 0.0697s/iter; left time: 2880.7729s
Epoch: 12 cost time: 32.77686643600464
Epoch: 12, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
Validation loss decreased (-0.949969 --> -0.953400).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0528018
	speed: 0.3107s/iter; left time: 12791.0035s
	iters: 200, epoch: 13 | loss: 0.0254731
	speed: 0.0662s/iter; left time: 2717.4540s
	iters: 300, epoch: 13 | loss: 0.2670590
	speed: 0.0664s/iter; left time: 2721.5097s
	iters: 400, epoch: 13 | loss: 0.0416038
	speed: 0.0660s/iter; left time: 2699.3527s
Epoch: 13 cost time: 32.119739055633545
Epoch: 13, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2283436
	speed: 0.3057s/iter; left time: 12441.2995s
	iters: 200, epoch: 14 | loss: 0.0156432
	speed: 0.0704s/iter; left time: 2859.2198s
	iters: 300, epoch: 14 | loss: 0.0265823
	speed: 0.0700s/iter; left time: 2834.9869s
	iters: 400, epoch: 14 | loss: 0.0034478
	speed: 0.0744s/iter; left time: 3004.6959s
Epoch: 14 cost time: 33.61892032623291
Epoch: 14, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2665069
	speed: 0.3235s/iter; left time: 13015.2418s
	iters: 200, epoch: 15 | loss: 0.5557885
	speed: 0.0722s/iter; left time: 2897.1114s
	iters: 300, epoch: 15 | loss: 0.0054281
	speed: 0.0765s/iter; left time: 3061.8545s
	iters: 400, epoch: 15 | loss: 0.0035646
	speed: 0.0698s/iter; left time: 2787.9910s
Epoch: 15 cost time: 34.96510696411133
Epoch: 15, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.953400 --> -0.958260).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3160902
	speed: 0.3065s/iter; left time: 12186.4985s
	iters: 200, epoch: 16 | loss: 0.0316488
	speed: 0.0663s/iter; left time: 2631.4526s
	iters: 300, epoch: 16 | loss: 0.0154604
	speed: 0.0730s/iter; left time: 2887.2932s
	iters: 400, epoch: 16 | loss: 0.0063836
	speed: 0.0701s/iter; left time: 2764.7950s
Epoch: 16 cost time: 33.57679605484009
Epoch: 16, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.958260 --> -0.959404).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0333989
	speed: 0.3206s/iter; left time: 12600.1276s
	iters: 200, epoch: 17 | loss: 0.0798194
	speed: 0.0710s/iter; left time: 2781.4069s
	iters: 300, epoch: 17 | loss: 0.1213954
	speed: 0.0678s/iter; left time: 2649.7850s
	iters: 400, epoch: 17 | loss: 0.0010215
	speed: 0.0644s/iter; left time: 2513.0055s
Epoch: 17 cost time: 32.08014941215515
Epoch: 17, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.959404 --> -0.969124).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0277895
	speed: 0.2775s/iter; left time: 10773.4589s
	iters: 200, epoch: 18 | loss: 0.0424062
	speed: 0.0613s/iter; left time: 2375.5926s
	iters: 300, epoch: 18 | loss: 0.0017332
	speed: 0.0663s/iter; left time: 2559.3041s
	iters: 400, epoch: 18 | loss: 0.0262570
	speed: 0.0690s/iter; left time: 2657.1667s
Epoch: 18 cost time: 31.25542950630188
Epoch: 18, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971125).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0048849
	speed: 0.3040s/iter; left time: 11660.7153s
	iters: 200, epoch: 19 | loss: 0.0145235
	speed: 0.0723s/iter; left time: 2765.6777s
	iters: 300, epoch: 19 | loss: 0.3411678
	speed: 0.0738s/iter; left time: 2817.8730s
	iters: 400, epoch: 19 | loss: 0.0181460
	speed: 0.0747s/iter; left time: 2841.7398s
Epoch: 19 cost time: 34.01583433151245
Epoch: 19, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0029164
	speed: 0.3048s/iter; left time: 11548.4400s
	iters: 200, epoch: 20 | loss: 0.0078817
	speed: 0.0697s/iter; left time: 2633.8668s
	iters: 300, epoch: 20 | loss: 0.0054754
	speed: 0.0646s/iter; left time: 2436.2421s
	iters: 400, epoch: 20 | loss: 0.0030065
	speed: 0.0642s/iter; left time: 2411.6252s
Epoch: 20 cost time: 31.837854623794556
Epoch: 20, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.370 Vali Acc: 0.901 Test Loss: 0.370 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0273824
	speed: 0.3149s/iter; left time: 11783.7509s
	iters: 200, epoch: 21 | loss: 0.0117402
	speed: 0.0711s/iter; left time: 2652.9373s
	iters: 300, epoch: 21 | loss: 0.3226116
	speed: 0.0653s/iter; left time: 2429.4280s
	iters: 400, epoch: 21 | loss: 0.0291446
	speed: 0.0623s/iter; left time: 2312.3377s
Epoch: 21 cost time: 32.162830114364624
Epoch: 21, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1483081
	speed: 0.3086s/iter; left time: 11403.7886s
	iters: 200, epoch: 22 | loss: 0.0178921
	speed: 0.0705s/iter; left time: 2596.6370s
	iters: 300, epoch: 22 | loss: 0.4613360
	speed: 0.0632s/iter; left time: 2322.4895s
	iters: 400, epoch: 22 | loss: 0.0586602
	speed: 0.0658s/iter; left time: 2412.2387s
Epoch: 22 cost time: 32.27843189239502
Epoch: 22, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0314184
	speed: 0.3093s/iter; left time: 11284.0868s
	iters: 200, epoch: 23 | loss: 0.0084743
	speed: 0.0685s/iter; left time: 2491.9547s
	iters: 300, epoch: 23 | loss: 0.0687645
	speed: 0.0713s/iter; left time: 2588.3493s
	iters: 400, epoch: 23 | loss: 0.0136733
	speed: 0.0744s/iter; left time: 2693.6239s
Epoch: 23 cost time: 33.67484378814697
Epoch: 23, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.7238467
	speed: 0.3272s/iter; left time: 11785.0250s
	iters: 200, epoch: 24 | loss: 0.3572918
	speed: 0.0695s/iter; left time: 2497.3264s
	iters: 300, epoch: 24 | loss: 0.0425370
	speed: 0.0691s/iter; left time: 2473.5457s
	iters: 400, epoch: 24 | loss: 0.0219736
	speed: 0.0660s/iter; left time: 2355.4779s
Epoch: 24 cost time: 33.28523397445679
Epoch: 24, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0188885
	speed: 0.3031s/iter; left time: 10774.0876s
	iters: 200, epoch: 25 | loss: 0.0311255
	speed: 0.0609s/iter; left time: 2158.9143s
	iters: 300, epoch: 25 | loss: 0.0243015
	speed: 0.0597s/iter; left time: 2109.8510s
	iters: 400, epoch: 25 | loss: 0.1170869
	speed: 0.0661s/iter; left time: 2330.4211s
Epoch: 25 cost time: 29.83357048034668
Epoch: 25, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0081650
	speed: 0.2930s/iter; left time: 10276.8544s
	iters: 200, epoch: 26 | loss: 0.0838349
	speed: 0.0664s/iter; left time: 2322.2407s
	iters: 300, epoch: 26 | loss: 0.0114847
	speed: 0.0717s/iter; left time: 2499.6068s
	iters: 400, epoch: 26 | loss: 0.1322383
	speed: 0.0602s/iter; left time: 2094.3519s
Epoch: 26 cost time: 31.09137988090515
Epoch: 26, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0022430
	speed: 0.2783s/iter; left time: 9629.7516s
	iters: 200, epoch: 27 | loss: 0.0014932
	speed: 0.0617s/iter; left time: 2129.3182s
	iters: 300, epoch: 27 | loss: 0.0246074
	speed: 0.0653s/iter; left time: 2247.5060s
	iters: 400, epoch: 27 | loss: 0.3620059
	speed: 0.0623s/iter; left time: 2137.9852s
Epoch: 27 cost time: 30.229811191558838
Epoch: 27, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.303 Vali Acc: 0.929 Test Loss: 0.303 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0067346
	speed: 0.3022s/iter; left time: 10317.0914s
	iters: 200, epoch: 28 | loss: 0.0730485
	speed: 0.0668s/iter; left time: 2273.7678s
	iters: 300, epoch: 28 | loss: 0.0154736
	speed: 0.0643s/iter; left time: 2180.8460s
	iters: 400, epoch: 28 | loss: 0.0067568
	speed: 0.0660s/iter; left time: 2231.7207s
Epoch: 28 cost time: 31.488223552703857
Epoch: 28, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9711263579188107
model parameter : 3715642
model size : 16.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4370038
	speed: 0.0815s/iter; left time: 3813.6902s
	iters: 200, epoch: 1 | loss: 0.2262785
	speed: 0.0689s/iter; left time: 3219.3496s
	iters: 300, epoch: 1 | loss: 0.1898138
	speed: 0.0598s/iter; left time: 2788.7668s
	iters: 400, epoch: 1 | loss: 0.3158635
	speed: 0.0639s/iter; left time: 2973.3314s
Epoch: 1 cost time: 31.833503484725952
Epoch: 1, Steps: 469 | Train Loss: 0.483 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (inf --> -0.929958).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0868100
	speed: 0.2927s/iter; left time: 13562.3185s
	iters: 200, epoch: 2 | loss: 0.0968972
	speed: 0.0685s/iter; left time: 3165.3411s
	iters: 300, epoch: 2 | loss: 0.1301786
	speed: 0.0659s/iter; left time: 3042.1365s
	iters: 400, epoch: 2 | loss: 0.5782097
	speed: 0.0790s/iter; left time: 3637.2498s
Epoch: 2 cost time: 34.067553997039795
Epoch: 2, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.218 Vali Acc: 0.934 Test Loss: 0.218 Test Acc: 0.934
Validation loss decreased (-0.929958 --> -0.933674).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2069315
	speed: 0.3466s/iter; left time: 15897.8642s
	iters: 200, epoch: 3 | loss: 0.2708834
	speed: 0.0656s/iter; left time: 3002.0635s
	iters: 300, epoch: 3 | loss: 0.0995913
	speed: 0.0668s/iter; left time: 3051.5774s
	iters: 400, epoch: 3 | loss: 0.5282974
	speed: 0.0702s/iter; left time: 3199.5397s
Epoch: 3 cost time: 32.687171459198
Epoch: 3, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.261 Vali Acc: 0.934 Test Loss: 0.261 Test Acc: 0.934
Validation loss decreased (-0.933674 --> -0.933960).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0640097
	speed: 0.3036s/iter; left time: 13779.5329s
	iters: 200, epoch: 4 | loss: 0.7001885
	speed: 0.0659s/iter; left time: 2983.9280s
	iters: 300, epoch: 4 | loss: 0.3312236
	speed: 0.0699s/iter; left time: 3157.7013s
	iters: 400, epoch: 4 | loss: 0.0285642
	speed: 0.0711s/iter; left time: 3208.3981s
Epoch: 4 cost time: 32.79863119125366
Epoch: 4, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1843624
	speed: 0.3075s/iter; left time: 13816.4731s
	iters: 200, epoch: 5 | loss: 0.0884801
	speed: 0.0683s/iter; left time: 3063.1447s
	iters: 300, epoch: 5 | loss: 0.4444184
	speed: 0.0683s/iter; left time: 3054.5269s
	iters: 400, epoch: 5 | loss: 0.0247274
	speed: 0.0629s/iter; left time: 2808.7148s
Epoch: 5 cost time: 31.389625787734985
Epoch: 5, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.432 Vali Acc: 0.905 Test Loss: 0.432 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0836478
	speed: 0.2770s/iter; left time: 12314.4043s
	iters: 200, epoch: 6 | loss: 0.0252377
	speed: 0.0646s/iter; left time: 2867.3239s
	iters: 300, epoch: 6 | loss: 0.0069301
	speed: 0.0639s/iter; left time: 2827.4374s
	iters: 400, epoch: 6 | loss: 0.0305337
	speed: 0.0639s/iter; left time: 2820.1513s
Epoch: 6 cost time: 30.42634081840515
Epoch: 6, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2714329
	speed: 0.2840s/iter; left time: 12493.8529s
	iters: 200, epoch: 7 | loss: 0.4988170
	speed: 0.0608s/iter; left time: 2667.2966s
	iters: 300, epoch: 7 | loss: 0.1010636
	speed: 0.0590s/iter; left time: 2585.4202s
	iters: 400, epoch: 7 | loss: 0.1435340
	speed: 0.0618s/iter; left time: 2698.5184s
Epoch: 7 cost time: 29.57176160812378
Epoch: 7, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
Validation loss decreased (-0.933960 --> -0.965693).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0584381
	speed: 0.2912s/iter; left time: 12673.5083s
	iters: 200, epoch: 8 | loss: 0.0060810
	speed: 0.0595s/iter; left time: 2583.8825s
	iters: 300, epoch: 8 | loss: 0.0112280
	speed: 0.0613s/iter; left time: 2656.7669s
	iters: 400, epoch: 8 | loss: 0.2997786
	speed: 0.0632s/iter; left time: 2730.5351s
Epoch: 8 cost time: 28.84278893470764
Epoch: 8, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0408248
	speed: 0.2751s/iter; left time: 11841.8996s
	iters: 200, epoch: 9 | loss: 0.1184936
	speed: 0.0643s/iter; left time: 2761.9733s
	iters: 300, epoch: 9 | loss: 0.0860809
	speed: 0.0596s/iter; left time: 2553.0099s
	iters: 400, epoch: 9 | loss: 0.0185851
	speed: 0.0618s/iter; left time: 2640.5660s
Epoch: 9 cost time: 29.634965896606445
Epoch: 9, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0539083
	speed: 0.2717s/iter; left time: 11570.4182s
	iters: 200, epoch: 10 | loss: 0.0347773
	speed: 0.0596s/iter; left time: 2529.7460s
	iters: 300, epoch: 10 | loss: 0.0109425
	speed: 0.0592s/iter; left time: 2510.6717s
	iters: 400, epoch: 10 | loss: 0.0334678
	speed: 0.0628s/iter; left time: 2657.0757s
Epoch: 10 cost time: 29.17306089401245
Epoch: 10, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0456627
	speed: 0.2786s/iter; left time: 11732.6681s
	iters: 200, epoch: 11 | loss: 0.0276052
	speed: 0.0621s/iter; left time: 2609.7062s
	iters: 300, epoch: 11 | loss: 0.0468503
	speed: 0.0655s/iter; left time: 2745.5039s
	iters: 400, epoch: 11 | loss: 0.0027696
	speed: 0.0666s/iter; left time: 2786.1982s
Epoch: 11 cost time: 30.702617168426514
Epoch: 11, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1703329
	speed: 0.3122s/iter; left time: 12999.0647s
	iters: 200, epoch: 12 | loss: 0.0745601
	speed: 0.0724s/iter; left time: 3009.6168s
	iters: 300, epoch: 12 | loss: 0.2904420
	speed: 0.0721s/iter; left time: 2986.7354s
	iters: 400, epoch: 12 | loss: 0.5419481
	speed: 0.0679s/iter; left time: 2806.8959s
Epoch: 12 cost time: 33.04811406135559
Epoch: 12, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0537192
	speed: 0.2895s/iter; left time: 11919.7948s
	iters: 200, epoch: 13 | loss: 0.0116274
	speed: 0.0641s/iter; left time: 2632.6719s
	iters: 300, epoch: 13 | loss: 0.1285369
	speed: 0.0654s/iter; left time: 2680.7119s
	iters: 400, epoch: 13 | loss: 0.4544621
	speed: 0.0675s/iter; left time: 2759.1837s
Epoch: 13 cost time: 31.304595232009888
Epoch: 13, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1571950
	speed: 0.2945s/iter; left time: 11985.6743s
	iters: 200, epoch: 14 | loss: 0.0124670
	speed: 0.0594s/iter; left time: 2411.1253s
	iters: 300, epoch: 14 | loss: 0.0290461
	speed: 0.0623s/iter; left time: 2521.6033s
	iters: 400, epoch: 14 | loss: 0.0118284
	speed: 0.0633s/iter; left time: 2557.0864s
Epoch: 14 cost time: 29.870412588119507
Epoch: 14, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0117023
	speed: 0.2772s/iter; left time: 11153.2946s
	iters: 200, epoch: 15 | loss: 0.1261273
	speed: 0.0604s/iter; left time: 2424.9458s
	iters: 300, epoch: 15 | loss: 0.0051392
	speed: 0.0643s/iter; left time: 2572.7172s
	iters: 400, epoch: 15 | loss: 0.0097914
	speed: 0.0609s/iter; left time: 2431.1176s
Epoch: 15 cost time: 29.480454444885254
Epoch: 15, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.191 Vali Acc: 0.961 Test Loss: 0.191 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2434126
	speed: 0.2821s/iter; left time: 11216.4824s
	iters: 200, epoch: 16 | loss: 0.1282894
	speed: 0.0675s/iter; left time: 2677.2799s
	iters: 300, epoch: 16 | loss: 0.3306900
	speed: 0.0640s/iter; left time: 2531.5215s
	iters: 400, epoch: 16 | loss: 0.3838798
	speed: 0.0625s/iter; left time: 2466.7648s
Epoch: 16 cost time: 31.32371473312378
Epoch: 16, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.287 Vali Acc: 0.936 Test Loss: 0.287 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0320308
	speed: 0.2842s/iter; left time: 11166.6939s
	iters: 200, epoch: 17 | loss: 0.0138596
	speed: 0.0621s/iter; left time: 2434.1675s
	iters: 300, epoch: 17 | loss: 0.0401234
	speed: 0.0617s/iter; left time: 2411.5480s
	iters: 400, epoch: 17 | loss: 0.0274095
	speed: 0.0615s/iter; left time: 2399.4984s
Epoch: 17 cost time: 29.772032260894775
Epoch: 17, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9656946826758147
model parameter : 3715258
model size : 16.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4780877
	speed: 0.0856s/iter; left time: 4007.1194s
	iters: 200, epoch: 1 | loss: 0.1520297
	speed: 0.0710s/iter; left time: 3316.3328s
	iters: 300, epoch: 1 | loss: 0.2645428
	speed: 0.0651s/iter; left time: 3036.0512s
	iters: 400, epoch: 1 | loss: 0.2361376
	speed: 0.0678s/iter; left time: 3151.8540s
Epoch: 1 cost time: 33.449023723602295
Epoch: 1, Steps: 469 | Train Loss: 0.469 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
Validation loss decreased (inf --> -0.954830).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0860662
	speed: 0.2886s/iter; left time: 13370.7176s
	iters: 200, epoch: 2 | loss: 0.0365735
	speed: 0.0615s/iter; left time: 2844.0789s
	iters: 300, epoch: 2 | loss: 0.2170334
	speed: 0.0613s/iter; left time: 2827.2827s
	iters: 400, epoch: 2 | loss: 0.7192652
	speed: 0.0579s/iter; left time: 2666.7906s
Epoch: 2 cost time: 29.49802017211914
Epoch: 2, Steps: 469 | Train Loss: 0.227 Vali Loss: 0.299 Vali Acc: 0.892 Test Loss: 0.299 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0120800
	speed: 0.2879s/iter; left time: 13202.9965s
	iters: 200, epoch: 3 | loss: 0.1675581
	speed: 0.0646s/iter; left time: 2955.6987s
	iters: 300, epoch: 3 | loss: 0.4110470
	speed: 0.0657s/iter; left time: 3001.9832s
	iters: 400, epoch: 3 | loss: 0.0647037
	speed: 0.0684s/iter; left time: 3114.2932s
Epoch: 3 cost time: 31.72294306755066
Epoch: 3, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.269 Vali Acc: 0.939 Test Loss: 0.269 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1877568
	speed: 0.3115s/iter; left time: 14142.4758s
	iters: 200, epoch: 4 | loss: 0.3675316
	speed: 0.0668s/iter; left time: 3023.7130s
	iters: 300, epoch: 4 | loss: 0.0122315
	speed: 0.0666s/iter; left time: 3009.7613s
	iters: 400, epoch: 4 | loss: 0.1980474
	speed: 0.0682s/iter; left time: 3075.3703s
Epoch: 4 cost time: 32.56594634056091
Epoch: 4, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0288165
	speed: 0.3013s/iter; left time: 13536.8397s
	iters: 200, epoch: 5 | loss: 0.0039557
	speed: 0.0693s/iter; left time: 3104.9400s
	iters: 300, epoch: 5 | loss: 0.0102514
	speed: 0.0747s/iter; left time: 3338.8111s
	iters: 400, epoch: 5 | loss: 0.0733809
	speed: 0.0702s/iter; left time: 3130.8741s
Epoch: 5 cost time: 33.34666991233826
Epoch: 5, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0575863
	speed: 0.2964s/iter; left time: 13177.1219s
	iters: 200, epoch: 6 | loss: 0.0084373
	speed: 0.0692s/iter; left time: 3069.8589s
	iters: 300, epoch: 6 | loss: 0.1270182
	speed: 0.0640s/iter; left time: 2833.5023s
	iters: 400, epoch: 6 | loss: 0.0060465
	speed: 0.0611s/iter; left time: 2699.5073s
Epoch: 6 cost time: 31.32161235809326
Epoch: 6, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.253 Vali Acc: 0.934 Test Loss: 0.253 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1180304
	speed: 0.2880s/iter; left time: 12670.1476s
	iters: 200, epoch: 7 | loss: 0.1947056
	speed: 0.0636s/iter; left time: 2790.2606s
	iters: 300, epoch: 7 | loss: 0.7944831
	speed: 0.0613s/iter; left time: 2685.9491s
	iters: 400, epoch: 7 | loss: 0.0644166
	speed: 0.0596s/iter; left time: 2605.1240s
Epoch: 7 cost time: 29.71857500076294
Epoch: 7, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.302 Vali Acc: 0.910 Test Loss: 0.302 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0368979
	speed: 0.2850s/iter; left time: 12401.5641s
	iters: 200, epoch: 8 | loss: 0.0984263
	speed: 0.0626s/iter; left time: 2719.7995s
	iters: 300, epoch: 8 | loss: 0.3829732
	speed: 0.0656s/iter; left time: 2842.0027s
	iters: 400, epoch: 8 | loss: 0.0104182
	speed: 0.0638s/iter; left time: 2755.1499s
Epoch: 8 cost time: 30.707428455352783
Epoch: 8, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4270418
	speed: 0.2589s/iter; left time: 11146.3632s
	iters: 200, epoch: 9 | loss: 0.1991511
	speed: 0.0602s/iter; left time: 2587.3811s
	iters: 300, epoch: 9 | loss: 0.0334432
	speed: 0.0582s/iter; left time: 2494.8238s
	iters: 400, epoch: 9 | loss: 0.1026422
	speed: 0.0592s/iter; left time: 2530.0976s
Epoch: 9 cost time: 28.218655586242676
Epoch: 9, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0043500
	speed: 0.2839s/iter; left time: 12086.8092s
	iters: 200, epoch: 10 | loss: 0.0484179
	speed: 0.0636s/iter; left time: 2700.2346s
	iters: 300, epoch: 10 | loss: 0.0594368
	speed: 0.0671s/iter; left time: 2841.7182s
	iters: 400, epoch: 10 | loss: 0.0234156
	speed: 0.0604s/iter; left time: 2553.5788s
Epoch: 10 cost time: 30.978928565979004
Epoch: 10, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0047843
	speed: 0.2809s/iter; left time: 11827.3337s
	iters: 200, epoch: 11 | loss: 0.1751768
	speed: 0.0648s/iter; left time: 2723.1217s
	iters: 300, epoch: 11 | loss: 0.0045398
	speed: 0.0665s/iter; left time: 2785.4245s
	iters: 400, epoch: 11 | loss: 0.0037788
	speed: 0.0693s/iter; left time: 2896.8006s
Epoch: 11 cost time: 31.200631856918335
Epoch: 11, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9548313321898227
model parameter : 3714874
model size : 16.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4496858
	speed: 0.0817s/iter; left time: 3824.3446s
	iters: 200, epoch: 1 | loss: 0.5508326
	speed: 0.0644s/iter; left time: 3008.2694s
	iters: 300, epoch: 1 | loss: 0.1065665
	speed: 0.0682s/iter; left time: 3178.1697s
	iters: 400, epoch: 1 | loss: 0.1628446
	speed: 0.0712s/iter; left time: 3312.4819s
Epoch: 1 cost time: 33.69907093048096
Epoch: 1, Steps: 469 | Train Loss: 0.466 Vali Loss: 0.319 Vali Acc: 0.898 Test Loss: 0.319 Test Acc: 0.898
Validation loss decreased (inf --> -0.898224).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6073285
	speed: 0.2960s/iter; left time: 13714.3486s
	iters: 200, epoch: 2 | loss: 0.0251292
	speed: 0.0660s/iter; left time: 3053.1701s
	iters: 300, epoch: 2 | loss: 0.0475264
	speed: 0.0658s/iter; left time: 3036.7245s
	iters: 400, epoch: 2 | loss: 0.2787094
	speed: 0.0649s/iter; left time: 2988.8209s
Epoch: 2 cost time: 30.86385226249695
Epoch: 2, Steps: 469 | Train Loss: 0.199 Vali Loss: 0.245 Vali Acc: 0.923 Test Loss: 0.245 Test Acc: 0.923
Validation loss decreased (-0.898224 --> -0.922525).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4327092
	speed: 0.2909s/iter; left time: 13340.2278s
	iters: 200, epoch: 3 | loss: 0.1914555
	speed: 0.0671s/iter; left time: 3071.0167s
	iters: 300, epoch: 3 | loss: 0.2407730
	speed: 0.0650s/iter; left time: 2969.5794s
	iters: 400, epoch: 3 | loss: 0.0079952
	speed: 0.0640s/iter; left time: 2914.5997s
Epoch: 3 cost time: 30.914475440979004
Epoch: 3, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.285 Vali Acc: 0.927 Test Loss: 0.285 Test Acc: 0.927
Validation loss decreased (-0.922525 --> -0.927098).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6073919
	speed: 0.2991s/iter; left time: 13575.6754s
	iters: 200, epoch: 4 | loss: 0.0606904
	speed: 0.0639s/iter; left time: 2895.1978s
	iters: 300, epoch: 4 | loss: 0.0768175
	speed: 0.0636s/iter; left time: 2873.2792s
	iters: 400, epoch: 4 | loss: 0.0518560
	speed: 0.0631s/iter; left time: 2845.3846s
Epoch: 4 cost time: 30.651667594909668
Epoch: 4, Steps: 469 | Train Loss: 0.187 Vali Loss: 0.278 Vali Acc: 0.915 Test Loss: 0.278 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0471662
	speed: 0.2788s/iter; left time: 12524.1754s
	iters: 200, epoch: 5 | loss: 0.0651793
	speed: 0.0717s/iter; left time: 3214.5893s
	iters: 300, epoch: 5 | loss: 0.0722606
	speed: 0.0671s/iter; left time: 3002.8318s
	iters: 400, epoch: 5 | loss: 0.0514589
	speed: 0.0652s/iter; left time: 2911.2006s
Epoch: 5 cost time: 32.07038378715515
Epoch: 5, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1727453
	speed: 0.2914s/iter; left time: 12954.4498s
	iters: 200, epoch: 6 | loss: 0.0270839
	speed: 0.0623s/iter; left time: 2763.4676s
	iters: 300, epoch: 6 | loss: 0.3648693
	speed: 0.0644s/iter; left time: 2850.7204s
	iters: 400, epoch: 6 | loss: 0.0529860
	speed: 0.0642s/iter; left time: 2836.4676s
Epoch: 6 cost time: 30.84279227256775
Epoch: 6, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
Validation loss decreased (-0.927098 --> -0.944538).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0144322
	speed: 0.2926s/iter; left time: 12870.3008s
	iters: 200, epoch: 7 | loss: 0.5415367
	speed: 0.0687s/iter; left time: 3015.2256s
	iters: 300, epoch: 7 | loss: 0.1583186
	speed: 0.0723s/iter; left time: 3163.8162s
	iters: 400, epoch: 7 | loss: 0.4501839
	speed: 0.0684s/iter; left time: 2987.9707s
Epoch: 7 cost time: 32.34304928779602
Epoch: 7, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2218449
	speed: 0.2806s/iter; left time: 12210.0826s
	iters: 200, epoch: 8 | loss: 0.2918847
	speed: 0.0713s/iter; left time: 3095.0690s
	iters: 300, epoch: 8 | loss: 0.0067934
	speed: 0.0722s/iter; left time: 3125.5751s
	iters: 400, epoch: 8 | loss: 0.0077714
	speed: 0.0684s/iter; left time: 2955.3181s
Epoch: 8 cost time: 33.37000870704651
Epoch: 8, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1750435
	speed: 0.3014s/iter; left time: 12977.0773s
	iters: 200, epoch: 9 | loss: 0.1623096
	speed: 0.0647s/iter; left time: 2777.1077s
	iters: 300, epoch: 9 | loss: 0.0166025
	speed: 0.0682s/iter; left time: 2924.0133s
	iters: 400, epoch: 9 | loss: 0.0070197
	speed: 0.0716s/iter; left time: 3062.5229s
Epoch: 9 cost time: 32.274733781814575
Epoch: 9, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0210393
	speed: 0.2882s/iter; left time: 12272.8360s
	iters: 200, epoch: 10 | loss: 0.0080236
	speed: 0.0676s/iter; left time: 2873.6643s
	iters: 300, epoch: 10 | loss: 0.0252061
	speed: 0.0616s/iter; left time: 2610.1456s
	iters: 400, epoch: 10 | loss: 0.0755029
	speed: 0.0624s/iter; left time: 2639.5260s
Epoch: 10 cost time: 30.370126962661743
Epoch: 10, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.338 Vali Acc: 0.927 Test Loss: 0.338 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0913873
	speed: 0.2886s/iter; left time: 12152.9562s
	iters: 200, epoch: 11 | loss: 0.0084959
	speed: 0.0674s/iter; left time: 2833.3245s
	iters: 300, epoch: 11 | loss: 0.2532752
	speed: 0.0617s/iter; left time: 2586.9528s
	iters: 400, epoch: 11 | loss: 0.0092079
	speed: 0.0644s/iter; left time: 2691.5436s
Epoch: 11 cost time: 31.03591561317444
Epoch: 11, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2332756
	speed: 0.2825s/iter; left time: 11763.0207s
	iters: 200, epoch: 12 | loss: 0.0369080
	speed: 0.0679s/iter; left time: 2820.3311s
	iters: 300, epoch: 12 | loss: 0.2976802
	speed: 0.0701s/iter; left time: 2903.3028s
	iters: 400, epoch: 12 | loss: 0.0511783
	speed: 0.0652s/iter; left time: 2695.5224s
Epoch: 12 cost time: 32.065773487091064
Epoch: 12, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.259 Vali Acc: 0.945 Test Loss: 0.259 Test Acc: 0.945
Validation loss decreased (-0.944538 --> -0.945109).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0329388
	speed: 0.3014s/iter; left time: 12408.2070s
	iters: 200, epoch: 13 | loss: 0.0201133
	speed: 0.0715s/iter; left time: 2935.7928s
	iters: 300, epoch: 13 | loss: 0.0069190
	speed: 0.0654s/iter; left time: 2681.4025s
	iters: 400, epoch: 13 | loss: 0.0105267
	speed: 0.0662s/iter; left time: 2703.7555s
Epoch: 13 cost time: 32.167545795440674
Epoch: 13, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.945109 --> -0.951113).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8771048
	speed: 0.2785s/iter; left time: 11336.4922s
	iters: 200, epoch: 14 | loss: 0.0573834
	speed: 0.0613s/iter; left time: 2487.7646s
	iters: 300, epoch: 14 | loss: 0.0401467
	speed: 0.0599s/iter; left time: 2425.3875s
	iters: 400, epoch: 14 | loss: 0.0463579
	speed: 0.0612s/iter; left time: 2471.0998s
Epoch: 14 cost time: 29.43627119064331
Epoch: 14, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.231 Vali Acc: 0.949 Test Loss: 0.231 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0162966
	speed: 0.2860s/iter; left time: 11508.0852s
	iters: 200, epoch: 15 | loss: 0.0266368
	speed: 0.0590s/iter; left time: 2366.1303s
	iters: 300, epoch: 15 | loss: 0.0312881
	speed: 0.0617s/iter; left time: 2471.8027s
	iters: 400, epoch: 15 | loss: 0.0023365
	speed: 0.0657s/iter; left time: 2623.5098s
Epoch: 15 cost time: 29.877611875534058
Epoch: 15, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
Validation loss decreased (-0.951113 --> -0.968838).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0077596
	speed: 0.2751s/iter; left time: 10939.4244s
	iters: 200, epoch: 16 | loss: 0.0060975
	speed: 0.0654s/iter; left time: 2595.7326s
	iters: 300, epoch: 16 | loss: 0.0046719
	speed: 0.0661s/iter; left time: 2614.8304s
	iters: 400, epoch: 16 | loss: 0.0095879
	speed: 0.0682s/iter; left time: 2690.1635s
Epoch: 16 cost time: 31.687618494033813
Epoch: 16, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.273 Vali Acc: 0.936 Test Loss: 0.273 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0359548
	speed: 0.2805s/iter; left time: 11024.1228s
	iters: 200, epoch: 17 | loss: 0.0325202
	speed: 0.0592s/iter; left time: 2320.1127s
	iters: 300, epoch: 17 | loss: 0.0023830
	speed: 0.0598s/iter; left time: 2337.6043s
	iters: 400, epoch: 17 | loss: 0.0038881
	speed: 0.0629s/iter; left time: 2453.9705s
Epoch: 17 cost time: 29.362956523895264
Epoch: 17, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0027052
	speed: 0.2675s/iter; left time: 10386.1708s
	iters: 200, epoch: 18 | loss: 0.0361251
	speed: 0.0630s/iter; left time: 2440.3767s
	iters: 300, epoch: 18 | loss: 0.0371047
	speed: 0.0633s/iter; left time: 2444.6470s
	iters: 400, epoch: 18 | loss: 0.0687791
	speed: 0.0623s/iter; left time: 2401.9548s
Epoch: 18 cost time: 29.387096881866455
Epoch: 18, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0082265
	speed: 0.2756s/iter; left time: 10573.0349s
	iters: 200, epoch: 19 | loss: 0.0185441
	speed: 0.0649s/iter; left time: 2483.2923s
	iters: 300, epoch: 19 | loss: 0.0378241
	speed: 0.0614s/iter; left time: 2342.6045s
	iters: 400, epoch: 19 | loss: 0.0214084
	speed: 0.0681s/iter; left time: 2592.3638s
Epoch: 19 cost time: 30.46552014350891
Epoch: 19, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.248 Vali Acc: 0.936 Test Loss: 0.248 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0072580
	speed: 0.2529s/iter; left time: 9581.3814s
	iters: 200, epoch: 20 | loss: 0.0156646
	speed: 0.0617s/iter; left time: 2332.1562s
	iters: 300, epoch: 20 | loss: 0.0239546
	speed: 0.0661s/iter; left time: 2492.0794s
	iters: 400, epoch: 20 | loss: 0.0128081
	speed: 0.0653s/iter; left time: 2454.8229s
Epoch: 20 cost time: 31.071470260620117
Epoch: 20, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0012971
	speed: 0.3088s/iter; left time: 11557.1190s
	iters: 200, epoch: 21 | loss: 0.0226247
	speed: 0.0674s/iter; left time: 2514.0337s
	iters: 300, epoch: 21 | loss: 0.0142552
	speed: 0.0676s/iter; left time: 2514.8560s
	iters: 400, epoch: 21 | loss: 0.0030322
	speed: 0.0718s/iter; left time: 2664.5355s
Epoch: 21 cost time: 32.6769323348999
Epoch: 21, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0119664
	speed: 0.2862s/iter; left time: 10575.7518s
	iters: 200, epoch: 22 | loss: 0.2054704
	speed: 0.0637s/iter; left time: 2345.6845s
	iters: 300, epoch: 22 | loss: 0.0063007
	speed: 0.0656s/iter; left time: 2412.2021s
	iters: 400, epoch: 22 | loss: 0.2063313
	speed: 0.0699s/iter; left time: 2560.4228s
Epoch: 22 cost time: 30.897542238235474
Epoch: 22, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1320305
	speed: 0.2843s/iter; left time: 10371.9670s
	iters: 200, epoch: 23 | loss: 0.0293917
	speed: 0.0688s/iter; left time: 2502.0364s
	iters: 300, epoch: 23 | loss: 0.0134354
	speed: 0.0610s/iter; left time: 2211.6339s
	iters: 400, epoch: 23 | loss: 0.0396289
	speed: 0.0609s/iter; left time: 2205.2903s
Epoch: 23 cost time: 30.632978916168213
Epoch: 23, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0056640
	speed: 0.2799s/iter; left time: 10079.1460s
	iters: 200, epoch: 24 | loss: 0.0168769
	speed: 0.0606s/iter; left time: 2175.3019s
	iters: 300, epoch: 24 | loss: 0.0233283
	speed: 0.0616s/iter; left time: 2206.7550s
	iters: 400, epoch: 24 | loss: 0.0028472
	speed: 0.0616s/iter; left time: 2201.0541s
Epoch: 24 cost time: 29.65661859512329
Epoch: 24, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0032951
	speed: 0.2722s/iter; left time: 9674.9822s
	iters: 200, epoch: 25 | loss: 0.0018894
	speed: 0.0590s/iter; left time: 2090.4476s
	iters: 300, epoch: 25 | loss: 0.0015444
	speed: 0.0612s/iter; left time: 2162.2769s
	iters: 400, epoch: 25 | loss: 0.0060712
	speed: 0.0645s/iter; left time: 2274.7851s
Epoch: 25 cost time: 28.955387830734253
Epoch: 25, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.968839336763865
model parameter : 3714490
model size : 16.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6494333
	speed: 0.0771s/iter; left time: 3608.2234s
	iters: 200, epoch: 1 | loss: 0.3674425
	speed: 0.0589s/iter; left time: 2751.6802s
	iters: 300, epoch: 1 | loss: 0.3906497
	speed: 0.0606s/iter; left time: 2823.9618s
	iters: 400, epoch: 1 | loss: 0.0978938
	speed: 0.0630s/iter; left time: 2927.4177s
Epoch: 1 cost time: 30.54411029815674
Epoch: 1, Steps: 469 | Train Loss: 0.483 Vali Loss: 0.327 Vali Acc: 0.892 Test Loss: 0.327 Test Acc: 0.892
Validation loss decreased (inf --> -0.892221).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0341250
	speed: 0.2789s/iter; left time: 12920.4606s
	iters: 200, epoch: 2 | loss: 0.2486317
	speed: 0.0669s/iter; left time: 3093.5037s
	iters: 300, epoch: 2 | loss: 0.0309398
	speed: 0.0721s/iter; left time: 3326.4979s
	iters: 400, epoch: 2 | loss: 0.2838917
	speed: 0.0650s/iter; left time: 2991.2344s
Epoch: 2 cost time: 31.769450902938843
Epoch: 2, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.322 Vali Acc: 0.919 Test Loss: 0.322 Test Acc: 0.919
Validation loss decreased (-0.892221 --> -0.918808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2821255
	speed: 0.2773s/iter; left time: 12716.9010s
	iters: 200, epoch: 3 | loss: 0.0069459
	speed: 0.0685s/iter; left time: 3134.5399s
	iters: 300, epoch: 3 | loss: 0.4742496
	speed: 0.0657s/iter; left time: 3002.2281s
	iters: 400, epoch: 3 | loss: 0.1101351
	speed: 0.0621s/iter; left time: 2829.6783s
Epoch: 3 cost time: 30.9313223361969
Epoch: 3, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
Validation loss decreased (-0.918808 --> -0.931673).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0074202
	speed: 0.2902s/iter; left time: 13175.2151s
	iters: 200, epoch: 4 | loss: 0.0166832
	speed: 0.0668s/iter; left time: 3024.8872s
	iters: 300, epoch: 4 | loss: 0.0614302
	speed: 0.0655s/iter; left time: 2960.3402s
	iters: 400, epoch: 4 | loss: 0.5371747
	speed: 0.0650s/iter; left time: 2930.7476s
Epoch: 4 cost time: 31.30316162109375
Epoch: 4, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.931673 --> -0.944252).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3337271
	speed: 0.3090s/iter; left time: 13883.3029s
	iters: 200, epoch: 5 | loss: 0.0083821
	speed: 0.0642s/iter; left time: 2876.1687s
	iters: 300, epoch: 5 | loss: 0.0133799
	speed: 0.0690s/iter; left time: 3086.6175s
	iters: 400, epoch: 5 | loss: 0.1822712
	speed: 0.0684s/iter; left time: 3053.8388s
Epoch: 5 cost time: 32.28275012969971
Epoch: 5, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3301161
	speed: 0.2855s/iter; left time: 12691.4257s
	iters: 200, epoch: 6 | loss: 0.0993622
	speed: 0.0636s/iter; left time: 2823.2554s
	iters: 300, epoch: 6 | loss: 0.0861941
	speed: 0.0678s/iter; left time: 2999.3888s
	iters: 400, epoch: 6 | loss: 0.4126173
	speed: 0.0615s/iter; left time: 2717.1227s
Epoch: 6 cost time: 30.31392216682434
Epoch: 6, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1969061
	speed: 0.2777s/iter; left time: 12216.9814s
	iters: 200, epoch: 7 | loss: 0.1173620
	speed: 0.0610s/iter; left time: 2679.2426s
	iters: 300, epoch: 7 | loss: 0.3177324
	speed: 0.0641s/iter; left time: 2807.1177s
	iters: 400, epoch: 7 | loss: 0.3159223
	speed: 0.0643s/iter; left time: 2809.9109s
Epoch: 7 cost time: 30.3088641166687
Epoch: 7, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.233 Vali Acc: 0.936 Test Loss: 0.233 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0106128
	speed: 0.2714s/iter; left time: 11808.7316s
	iters: 200, epoch: 8 | loss: 0.1170940
	speed: 0.0593s/iter; left time: 2573.7525s
	iters: 300, epoch: 8 | loss: 0.0047783
	speed: 0.0634s/iter; left time: 2746.7846s
	iters: 400, epoch: 8 | loss: 0.3864476
	speed: 0.0644s/iter; left time: 2782.3033s
Epoch: 8 cost time: 29.4912428855896
Epoch: 8, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.944252 --> -0.948254).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0112901
	speed: 0.2903s/iter; left time: 12496.8098s
	iters: 200, epoch: 9 | loss: 0.0152661
	speed: 0.0625s/iter; left time: 2682.6061s
	iters: 300, epoch: 9 | loss: 0.2227380
	speed: 0.0657s/iter; left time: 2817.3010s
	iters: 400, epoch: 9 | loss: 0.0118641
	speed: 0.0619s/iter; left time: 2647.4297s
Epoch: 9 cost time: 30.21513795852661
Epoch: 9, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
Validation loss decreased (-0.948254 --> -0.963406).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0008938
	speed: 0.3012s/iter; left time: 12826.4565s
	iters: 200, epoch: 10 | loss: 0.0296331
	speed: 0.0671s/iter; left time: 2848.6916s
	iters: 300, epoch: 10 | loss: 0.0157672
	speed: 0.0612s/iter; left time: 2594.1019s
	iters: 400, epoch: 10 | loss: 0.0259729
	speed: 0.0604s/iter; left time: 2555.2002s
Epoch: 10 cost time: 30.874423027038574
Epoch: 10, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.216 Vali Acc: 0.940 Test Loss: 0.216 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0089607
	speed: 0.2735s/iter; left time: 11518.9100s
	iters: 200, epoch: 11 | loss: 0.0786874
	speed: 0.0658s/iter; left time: 2763.4011s
	iters: 300, epoch: 11 | loss: 0.2067597
	speed: 0.0681s/iter; left time: 2853.9416s
	iters: 400, epoch: 11 | loss: 0.0306158
	speed: 0.0685s/iter; left time: 2865.6673s
Epoch: 11 cost time: 31.48327660560608
Epoch: 11, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0272132
	speed: 0.2811s/iter; left time: 11706.5897s
	iters: 200, epoch: 12 | loss: 0.1954475
	speed: 0.0623s/iter; left time: 2586.6078s
	iters: 300, epoch: 12 | loss: 0.0172547
	speed: 0.0653s/iter; left time: 2705.5075s
	iters: 400, epoch: 12 | loss: 0.0188285
	speed: 0.0652s/iter; left time: 2693.9946s
Epoch: 12 cost time: 29.807366609573364
Epoch: 12, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.261 Vali Acc: 0.929 Test Loss: 0.261 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5366462
	speed: 0.2755s/iter; left time: 11344.3744s
	iters: 200, epoch: 13 | loss: 0.0043707
	speed: 0.0671s/iter; left time: 2755.1569s
	iters: 300, epoch: 13 | loss: 0.0484899
	speed: 0.0645s/iter; left time: 2644.0084s
	iters: 400, epoch: 13 | loss: 0.1201046
	speed: 0.0676s/iter; left time: 2762.1660s
Epoch: 13 cost time: 32.200443267822266
Epoch: 13, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.326 Vali Acc: 0.924 Test Loss: 0.326 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0037096
	speed: 0.3115s/iter; left time: 12679.9223s
	iters: 200, epoch: 14 | loss: 0.0033613
	speed: 0.0661s/iter; left time: 2683.8922s
	iters: 300, epoch: 14 | loss: 0.0970804
	speed: 0.0694s/iter; left time: 2809.7059s
	iters: 400, epoch: 14 | loss: 0.0957280
	speed: 0.0704s/iter; left time: 2845.5444s
Epoch: 14 cost time: 32.376920223236084
Epoch: 14, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0455450
	speed: 0.2890s/iter; left time: 11626.5739s
	iters: 200, epoch: 15 | loss: 0.0133884
	speed: 0.0620s/iter; left time: 2489.3421s
	iters: 300, epoch: 15 | loss: 0.0041582
	speed: 0.0648s/iter; left time: 2593.2664s
	iters: 400, epoch: 15 | loss: 0.5263882
	speed: 0.0611s/iter; left time: 2439.8227s
Epoch: 15 cost time: 29.49526071548462
Epoch: 15, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.963406 --> -0.964836).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0102062
	speed: 0.2750s/iter; left time: 10934.8108s
	iters: 200, epoch: 16 | loss: 0.0163820
	speed: 0.0646s/iter; left time: 2563.4806s
	iters: 300, epoch: 16 | loss: 0.1419003
	speed: 0.0654s/iter; left time: 2589.2028s
	iters: 400, epoch: 16 | loss: 0.0107187
	speed: 0.0676s/iter; left time: 2668.4531s
Epoch: 16 cost time: 31.68200445175171
Epoch: 16, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0193192
	speed: 0.2876s/iter; left time: 11301.1604s
	iters: 200, epoch: 17 | loss: 0.0082074
	speed: 0.0629s/iter; left time: 2464.5286s
	iters: 300, epoch: 17 | loss: 0.0210837
	speed: 0.0610s/iter; left time: 2385.2882s
	iters: 400, epoch: 17 | loss: 0.0361397
	speed: 0.0627s/iter; left time: 2445.8348s
Epoch: 17 cost time: 29.532385110855103
Epoch: 17, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4455497
	speed: 0.2857s/iter; left time: 11093.1092s
	iters: 200, epoch: 18 | loss: 0.0369242
	speed: 0.0664s/iter; left time: 2570.1042s
	iters: 300, epoch: 18 | loss: 0.0021481
	speed: 0.0681s/iter; left time: 2631.9134s
	iters: 400, epoch: 18 | loss: 0.1729938
	speed: 0.0671s/iter; left time: 2585.7011s
Epoch: 18 cost time: 31.795544385910034
Epoch: 18, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1712544
	speed: 0.2762s/iter; left time: 10593.2348s
	iters: 200, epoch: 19 | loss: 0.0167089
	speed: 0.0604s/iter; left time: 2310.1841s
	iters: 300, epoch: 19 | loss: 0.0105244
	speed: 0.0585s/iter; left time: 2234.0351s
	iters: 400, epoch: 19 | loss: 0.0087243
	speed: 0.0595s/iter; left time: 2265.4933s
Epoch: 19 cost time: 28.7932288646698
Epoch: 19, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0885143
	speed: 0.2809s/iter; left time: 10643.4610s
	iters: 200, epoch: 20 | loss: 0.1532194
	speed: 0.0625s/iter; left time: 2361.8248s
	iters: 300, epoch: 20 | loss: 0.0194028
	speed: 0.0665s/iter; left time: 2505.9476s
	iters: 400, epoch: 20 | loss: 0.0345941
	speed: 0.0615s/iter; left time: 2311.9571s
Epoch: 20 cost time: 30.067793369293213
Epoch: 20, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.311 Vali Acc: 0.905 Test Loss: 0.311 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1751328
	speed: 0.2852s/iter; left time: 10673.1423s
	iters: 200, epoch: 21 | loss: 0.0033329
	speed: 0.0646s/iter; left time: 2412.2112s
	iters: 300, epoch: 21 | loss: 0.0079667
	speed: 0.0680s/iter; left time: 2529.5742s
	iters: 400, epoch: 21 | loss: 0.0292631
	speed: 0.0689s/iter; left time: 2559.1915s
Epoch: 21 cost time: 31.926493644714355
Epoch: 21, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0094901
	speed: 0.2990s/iter; left time: 11049.0869s
	iters: 200, epoch: 22 | loss: 0.0010438
	speed: 0.0659s/iter; left time: 2428.9068s
	iters: 300, epoch: 22 | loss: 0.0258829
	speed: 0.0668s/iter; left time: 2456.7764s
	iters: 400, epoch: 22 | loss: 0.0328637
	speed: 0.0665s/iter; left time: 2436.6001s
Epoch: 22 cost time: 30.78098487854004
Epoch: 22, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0148554
	speed: 0.3025s/iter; left time: 11034.5059s
	iters: 200, epoch: 23 | loss: 0.0163089
	speed: 0.0737s/iter; left time: 2680.8908s
	iters: 300, epoch: 23 | loss: 0.0072807
	speed: 0.0674s/iter; left time: 2446.9197s
	iters: 400, epoch: 23 | loss: 0.0249631
	speed: 0.0681s/iter; left time: 2464.0763s
Epoch: 23 cost time: 33.37748146057129
Epoch: 23, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.966551).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0125575
	speed: 0.3066s/iter; left time: 11041.7210s
	iters: 200, epoch: 24 | loss: 0.0218745
	speed: 0.0631s/iter; left time: 2265.6030s
	iters: 300, epoch: 24 | loss: 0.0052736
	speed: 0.0598s/iter; left time: 2143.3272s
	iters: 400, epoch: 24 | loss: 0.1774574
	speed: 0.0599s/iter; left time: 2138.9066s
Epoch: 24 cost time: 29.463218688964844
Epoch: 24, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0062298
	speed: 0.2686s/iter; left time: 9547.2326s
	iters: 200, epoch: 25 | loss: 0.0254176
	speed: 0.0606s/iter; left time: 2148.6709s
	iters: 300, epoch: 25 | loss: 0.0880467
	speed: 0.0618s/iter; left time: 2183.9702s
	iters: 400, epoch: 25 | loss: 0.0106413
	speed: 0.0602s/iter; left time: 2120.4053s
Epoch: 25 cost time: 28.744935989379883
Epoch: 25, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.314 Vali Acc: 0.934 Test Loss: 0.314 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3491836
	speed: 0.2601s/iter; left time: 9124.8034s
	iters: 200, epoch: 26 | loss: 0.0268970
	speed: 0.0650s/iter; left time: 2272.9736s
	iters: 300, epoch: 26 | loss: 0.0052266
	speed: 0.0650s/iter; left time: 2268.2877s
	iters: 400, epoch: 26 | loss: 0.0729660
	speed: 0.0682s/iter; left time: 2372.6691s
Epoch: 26 cost time: 30.69611382484436
Epoch: 26, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0114133
	speed: 0.2593s/iter; left time: 8973.7961s
	iters: 200, epoch: 27 | loss: 0.1673260
	speed: 0.0600s/iter; left time: 2068.8630s
	iters: 300, epoch: 27 | loss: 0.2361118
	speed: 0.0659s/iter; left time: 2266.6123s
	iters: 400, epoch: 27 | loss: 0.0210649
	speed: 0.0617s/iter; left time: 2118.2623s
Epoch: 27 cost time: 28.77318263053894
Epoch: 27, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.294 Vali Acc: 0.921 Test Loss: 0.294 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0302661
	speed: 0.2723s/iter; left time: 9296.4888s
	iters: 200, epoch: 28 | loss: 0.0412175
	speed: 0.0668s/iter; left time: 2273.5493s
	iters: 300, epoch: 28 | loss: 0.0038894
	speed: 0.0600s/iter; left time: 2036.5667s
	iters: 400, epoch: 28 | loss: 0.0113481
	speed: 0.0582s/iter; left time: 1970.9582s
Epoch: 28 cost time: 29.15281915664673
Epoch: 28, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1430551
	speed: 0.2649s/iter; left time: 8920.4274s
	iters: 200, epoch: 29 | loss: 0.0518696
	speed: 0.0620s/iter; left time: 2082.3243s
	iters: 300, epoch: 29 | loss: 0.0099156
	speed: 0.0582s/iter; left time: 1949.1890s
	iters: 400, epoch: 29 | loss: 0.0028240
	speed: 0.0599s/iter; left time: 1999.6886s
Epoch: 29 cost time: 29.431103706359863
Epoch: 29, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0036455
	speed: 0.2829s/iter; left time: 9391.0680s
	iters: 200, epoch: 30 | loss: 0.0036644
	speed: 0.0616s/iter; left time: 2039.6952s
	iters: 300, epoch: 30 | loss: 0.2658602
	speed: 0.0594s/iter; left time: 1961.4659s
	iters: 400, epoch: 30 | loss: 0.4158713
	speed: 0.0707s/iter; left time: 2325.2743s
Epoch: 30 cost time: 30.945690631866455
Epoch: 30, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2253166
	speed: 0.2998s/iter; left time: 9811.6328s
	iters: 200, epoch: 31 | loss: 0.0029561
	speed: 0.0652s/iter; left time: 2129.0051s
	iters: 300, epoch: 31 | loss: 0.0060469
	speed: 0.0684s/iter; left time: 2226.0053s
	iters: 400, epoch: 31 | loss: 0.0056597
	speed: 0.0718s/iter; left time: 2327.5965s
Epoch: 31 cost time: 31.847087621688843
Epoch: 31, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0012402
	speed: 0.2940s/iter; left time: 9485.6927s
	iters: 200, epoch: 32 | loss: 0.0031889
	speed: 0.0731s/iter; left time: 2349.8630s
	iters: 300, epoch: 32 | loss: 0.0056489
	speed: 0.0681s/iter; left time: 2182.5248s
	iters: 400, epoch: 32 | loss: 0.0951856
	speed: 0.0629s/iter; left time: 2009.4335s
Epoch: 32 cost time: 32.65505313873291
Epoch: 32, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0162065
	speed: 0.3002s/iter; left time: 9545.2942s
	iters: 200, epoch: 33 | loss: 0.0108708
	speed: 0.0653s/iter; left time: 2068.3971s
	iters: 300, epoch: 33 | loss: 0.0184431
	speed: 0.0686s/iter; left time: 2168.1887s
	iters: 400, epoch: 33 | loss: 0.0165635
	speed: 0.0622s/iter; left time: 1960.4039s
Epoch: 33 cost time: 31.608981370925903
Epoch: 33, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9665523156089194
model parameter : 2794554
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4540920
	speed: 0.0891s/iter; left time: 4170.7134s
	iters: 200, epoch: 1 | loss: 0.2577686
	speed: 0.0695s/iter; left time: 3247.8515s
	iters: 300, epoch: 1 | loss: 0.2988463
	speed: 0.0645s/iter; left time: 3007.7484s
	iters: 400, epoch: 1 | loss: 0.1500944
	speed: 0.0631s/iter; left time: 2934.6806s
Epoch: 1 cost time: 32.78056788444519
Epoch: 1, Steps: 469 | Train Loss: 0.475 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
Validation loss decreased (inf --> -0.899940).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0339521
	speed: 0.2792s/iter; left time: 12934.9112s
	iters: 200, epoch: 2 | loss: 0.1792221
	speed: 0.0599s/iter; left time: 2769.7136s
	iters: 300, epoch: 2 | loss: 0.0810507
	speed: 0.0594s/iter; left time: 2742.0226s
	iters: 400, epoch: 2 | loss: 0.6004912
	speed: 0.0603s/iter; left time: 2776.2435s
Epoch: 2 cost time: 29.00584387779236
Epoch: 2, Steps: 469 | Train Loss: 0.196 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.899940 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4840067
	speed: 0.2726s/iter; left time: 12501.2574s
	iters: 200, epoch: 3 | loss: 0.0089938
	speed: 0.0582s/iter; left time: 2662.6016s
	iters: 300, epoch: 3 | loss: 0.0879750
	speed: 0.0594s/iter; left time: 2711.2036s
	iters: 400, epoch: 3 | loss: 0.1515129
	speed: 0.0633s/iter; left time: 2884.0505s
Epoch: 3 cost time: 29.053505897521973
Epoch: 3, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.208 Vali Acc: 0.934 Test Loss: 0.208 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1947529
	speed: 0.2779s/iter; left time: 12617.2021s
	iters: 200, epoch: 4 | loss: 0.0048617
	speed: 0.0676s/iter; left time: 3061.5838s
	iters: 300, epoch: 4 | loss: 0.0870586
	speed: 0.0638s/iter; left time: 2883.0868s
	iters: 400, epoch: 4 | loss: 0.2461253
	speed: 0.0603s/iter; left time: 2720.9035s
Epoch: 4 cost time: 30.27738070487976
Epoch: 4, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.313 Vali Acc: 0.913 Test Loss: 0.313 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0984559
	speed: 0.2625s/iter; left time: 11794.4220s
	iters: 200, epoch: 5 | loss: 0.3074519
	speed: 0.0631s/iter; left time: 2828.4091s
	iters: 300, epoch: 5 | loss: 0.7718810
	speed: 0.0608s/iter; left time: 2721.2880s
	iters: 400, epoch: 5 | loss: 0.0504704
	speed: 0.0590s/iter; left time: 2631.2126s
Epoch: 5 cost time: 29.350951194763184
Epoch: 5, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0121332
	speed: 0.2788s/iter; left time: 12392.7006s
	iters: 200, epoch: 6 | loss: 0.0848752
	speed: 0.0709s/iter; left time: 3144.7922s
	iters: 300, epoch: 6 | loss: 0.2197960
	speed: 0.0712s/iter; left time: 3150.4555s
	iters: 400, epoch: 6 | loss: 0.2738325
	speed: 0.0660s/iter; left time: 2914.0215s
Epoch: 6 cost time: 32.26197385787964
Epoch: 6, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.948826 --> -0.959404).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0755966
	speed: 0.2817s/iter; left time: 12389.0569s
	iters: 200, epoch: 7 | loss: 0.0417324
	speed: 0.0645s/iter; left time: 2829.0153s
	iters: 300, epoch: 7 | loss: 0.3515630
	speed: 0.0658s/iter; left time: 2879.1090s
	iters: 400, epoch: 7 | loss: 0.1742694
	speed: 0.0633s/iter; left time: 2763.2694s
Epoch: 7 cost time: 30.439617156982422
Epoch: 7, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0712278
	speed: 0.2870s/iter; left time: 12489.9616s
	iters: 200, epoch: 8 | loss: 0.0098516
	speed: 0.0660s/iter; left time: 2867.0442s
	iters: 300, epoch: 8 | loss: 0.0306134
	speed: 0.0632s/iter; left time: 2736.4844s
	iters: 400, epoch: 8 | loss: 0.0204154
	speed: 0.0660s/iter; left time: 2853.7768s
Epoch: 8 cost time: 30.970019340515137
Epoch: 8, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.959404 --> -0.962549).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0094240
	speed: 0.2918s/iter; left time: 12561.6620s
	iters: 200, epoch: 9 | loss: 0.0375356
	speed: 0.0611s/iter; left time: 2622.8676s
	iters: 300, epoch: 9 | loss: 0.0289028
	speed: 0.0613s/iter; left time: 2626.7909s
	iters: 400, epoch: 9 | loss: 0.2231907
	speed: 0.0638s/iter; left time: 2728.1428s
Epoch: 9 cost time: 29.751561403274536
Epoch: 9, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0041149
	speed: 0.2711s/iter; left time: 11542.8984s
	iters: 200, epoch: 10 | loss: 0.0067873
	speed: 0.0642s/iter; left time: 2725.6520s
	iters: 300, epoch: 10 | loss: 0.0303208
	speed: 0.0636s/iter; left time: 2697.3929s
	iters: 400, epoch: 10 | loss: 0.0031228
	speed: 0.0603s/iter; left time: 2549.2956s
Epoch: 10 cost time: 29.535154581069946
Epoch: 10, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0465117
	speed: 0.2580s/iter; left time: 10863.1190s
	iters: 200, epoch: 11 | loss: 0.0084111
	speed: 0.0596s/iter; left time: 2504.8686s
	iters: 300, epoch: 11 | loss: 0.2014198
	speed: 0.0608s/iter; left time: 2546.6669s
	iters: 400, epoch: 11 | loss: 0.4604913
	speed: 0.0656s/iter; left time: 2743.6919s
Epoch: 11 cost time: 29.7724392414093
Epoch: 11, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4206996
	speed: 0.2664s/iter; left time: 11094.6720s
	iters: 200, epoch: 12 | loss: 0.2044822
	speed: 0.0570s/iter; left time: 2366.6451s
	iters: 300, epoch: 12 | loss: 0.4340161
	speed: 0.0640s/iter; left time: 2652.4862s
	iters: 400, epoch: 12 | loss: 0.0056804
	speed: 0.0610s/iter; left time: 2523.2246s
Epoch: 12 cost time: 28.706864595413208
Epoch: 12, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0427274
	speed: 0.2779s/iter; left time: 11442.1115s
	iters: 200, epoch: 13 | loss: 0.4065383
	speed: 0.0669s/iter; left time: 2749.7390s
	iters: 300, epoch: 13 | loss: 0.0611991
	speed: 0.0644s/iter; left time: 2638.6264s
	iters: 400, epoch: 13 | loss: 0.0175552
	speed: 0.0624s/iter; left time: 2549.9191s
Epoch: 13 cost time: 30.81090235710144
Epoch: 13, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.293 Vali Acc: 0.914 Test Loss: 0.293 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0147963
	speed: 0.2724s/iter; left time: 11089.4997s
	iters: 200, epoch: 14 | loss: 0.1210368
	speed: 0.0626s/iter; left time: 2542.6200s
	iters: 300, epoch: 14 | loss: 0.0040011
	speed: 0.0660s/iter; left time: 2674.7822s
	iters: 400, epoch: 14 | loss: 0.0407938
	speed: 0.0616s/iter; left time: 2487.9135s
Epoch: 14 cost time: 30.035802364349365
Epoch: 14, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0039571
	speed: 0.2728s/iter; left time: 10974.4597s
	iters: 200, epoch: 15 | loss: 0.0503248
	speed: 0.0649s/iter; left time: 2604.7270s
	iters: 300, epoch: 15 | loss: 0.0082755
	speed: 0.0629s/iter; left time: 2517.2851s
	iters: 400, epoch: 15 | loss: 0.0087203
	speed: 0.0679s/iter; left time: 2710.0331s
Epoch: 15 cost time: 30.975126266479492
Epoch: 15, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0124099
	speed: 0.2967s/iter; left time: 11800.5374s
	iters: 200, epoch: 16 | loss: 0.2330470
	speed: 0.0682s/iter; left time: 2706.3126s
	iters: 300, epoch: 16 | loss: 0.0135648
	speed: 0.0642s/iter; left time: 2539.1894s
	iters: 400, epoch: 16 | loss: 0.0123152
	speed: 0.0643s/iter; left time: 2537.6066s
Epoch: 16 cost time: 31.117576122283936
Epoch: 16, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0079696
	speed: 0.3019s/iter; left time: 11864.1284s
	iters: 200, epoch: 17 | loss: 0.0236222
	speed: 0.0662s/iter; left time: 2593.6889s
	iters: 300, epoch: 17 | loss: 0.0056089
	speed: 0.0641s/iter; left time: 2504.3677s
	iters: 400, epoch: 17 | loss: 0.0149984
	speed: 0.0630s/iter; left time: 2455.8973s
Epoch: 17 cost time: 31.240917682647705
Epoch: 17, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0260410
	speed: 0.2788s/iter; left time: 10824.9754s
	iters: 200, epoch: 18 | loss: 0.0068551
	speed: 0.0614s/iter; left time: 2378.3100s
	iters: 300, epoch: 18 | loss: 0.4950407
	speed: 0.0624s/iter; left time: 2411.2725s
	iters: 400, epoch: 18 | loss: 0.0055262
	speed: 0.0614s/iter; left time: 2363.9697s
Epoch: 18 cost time: 29.916281938552856
Epoch: 18, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.962549 --> -0.962834).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0077047
	speed: 0.2905s/iter; left time: 11144.4887s
	iters: 200, epoch: 19 | loss: 0.0933070
	speed: 0.0638s/iter; left time: 2441.6780s
	iters: 300, epoch: 19 | loss: 0.0026300
	speed: 0.0604s/iter; left time: 2305.3761s
	iters: 400, epoch: 19 | loss: 0.1033271
	speed: 0.0658s/iter; left time: 2505.7156s
Epoch: 19 cost time: 30.448721408843994
Epoch: 19, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0771716
	speed: 0.2797s/iter; left time: 10598.5444s
	iters: 200, epoch: 20 | loss: 0.0032341
	speed: 0.0646s/iter; left time: 2442.2820s
	iters: 300, epoch: 20 | loss: 0.5605695
	speed: 0.0609s/iter; left time: 2295.1359s
	iters: 400, epoch: 20 | loss: 0.1930774
	speed: 0.0610s/iter; left time: 2294.0814s
Epoch: 20 cost time: 29.957676649093628
Epoch: 20, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0121758
	speed: 0.2956s/iter; left time: 11061.1755s
	iters: 200, epoch: 21 | loss: 0.0037816
	speed: 0.0627s/iter; left time: 2338.7796s
	iters: 300, epoch: 21 | loss: 0.0024499
	speed: 0.0659s/iter; left time: 2452.0437s
	iters: 400, epoch: 21 | loss: 0.6874996
	speed: 0.0608s/iter; left time: 2258.2883s
Epoch: 21 cost time: 30.03712034225464
Epoch: 21, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
Validation loss decreased (-0.962834 --> -0.966265).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0034899
	speed: 0.2827s/iter; left time: 10444.9527s
	iters: 200, epoch: 22 | loss: 0.1490675
	speed: 0.0690s/iter; left time: 2541.3792s
	iters: 300, epoch: 22 | loss: 0.0067232
	speed: 0.0703s/iter; left time: 2585.3202s
	iters: 400, epoch: 22 | loss: 0.0142962
	speed: 0.0719s/iter; left time: 2636.7877s
Epoch: 22 cost time: 32.86890196800232
Epoch: 22, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0058964
	speed: 0.2838s/iter; left time: 10353.2146s
	iters: 200, epoch: 23 | loss: 0.2792048
	speed: 0.0665s/iter; left time: 2418.4353s
	iters: 300, epoch: 23 | loss: 0.0112572
	speed: 0.0652s/iter; left time: 2367.3207s
	iters: 400, epoch: 23 | loss: 0.0696724
	speed: 0.0637s/iter; left time: 2306.3626s
Epoch: 23 cost time: 30.885587453842163
Epoch: 23, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2977313
	speed: 0.2751s/iter; left time: 9906.6239s
	iters: 200, epoch: 24 | loss: 0.0089880
	speed: 0.0631s/iter; left time: 2265.0337s
	iters: 300, epoch: 24 | loss: 0.2377807
	speed: 0.0696s/iter; left time: 2492.4403s
	iters: 400, epoch: 24 | loss: 0.1568567
	speed: 0.0717s/iter; left time: 2559.7151s
Epoch: 24 cost time: 32.23175573348999
Epoch: 24, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.6550264
	speed: 0.3256s/iter; left time: 11573.9633s
	iters: 200, epoch: 25 | loss: 0.1561191
	speed: 0.0717s/iter; left time: 2542.4342s
	iters: 300, epoch: 25 | loss: 0.0183658
	speed: 0.0700s/iter; left time: 2472.6382s
	iters: 400, epoch: 25 | loss: 0.0499781
	speed: 0.0673s/iter; left time: 2373.2539s
Epoch: 25 cost time: 33.17082214355469
Epoch: 25, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0570232
	speed: 0.2955s/iter; left time: 10366.6620s
	iters: 200, epoch: 26 | loss: 0.0025232
	speed: 0.0702s/iter; left time: 2455.2303s
	iters: 300, epoch: 26 | loss: 0.0038567
	speed: 0.0728s/iter; left time: 2538.4624s
	iters: 400, epoch: 26 | loss: 0.0085993
	speed: 0.0648s/iter; left time: 2252.2152s
Epoch: 26 cost time: 32.463379859924316
Epoch: 26, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.936 Test Loss: 0.257 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1012077
	speed: 0.2761s/iter; left time: 9554.6126s
	iters: 200, epoch: 27 | loss: 0.0450989
	speed: 0.0643s/iter; left time: 2217.8068s
	iters: 300, epoch: 27 | loss: 0.0049397
	speed: 0.0603s/iter; left time: 2076.1128s
	iters: 400, epoch: 27 | loss: 0.0135223
	speed: 0.0592s/iter; left time: 2032.5063s
Epoch: 27 cost time: 30.17974829673767
Epoch: 27, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0204225
	speed: 0.2725s/iter; left time: 9301.7028s
	iters: 200, epoch: 28 | loss: 0.0038356
	speed: 0.0640s/iter; left time: 2178.0570s
	iters: 300, epoch: 28 | loss: 0.0195314
	speed: 0.0629s/iter; left time: 2133.1745s
	iters: 400, epoch: 28 | loss: 0.0169124
	speed: 0.0629s/iter; left time: 2128.6658s
Epoch: 28 cost time: 29.698968172073364
Epoch: 28, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0106064
	speed: 0.2675s/iter; left time: 9005.0349s
	iters: 200, epoch: 29 | loss: 0.0224029
	speed: 0.0618s/iter; left time: 2074.4912s
	iters: 300, epoch: 29 | loss: 0.0098035
	speed: 0.0642s/iter; left time: 2148.2522s
	iters: 400, epoch: 29 | loss: 0.0393989
	speed: 0.0669s/iter; left time: 2232.9023s
Epoch: 29 cost time: 30.57559561729431
Epoch: 29, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0101050
	speed: 0.2868s/iter; left time: 9522.5281s
	iters: 200, epoch: 30 | loss: 0.0022604
	speed: 0.0643s/iter; left time: 2129.3329s
	iters: 300, epoch: 30 | loss: 0.1866903
	speed: 0.0636s/iter; left time: 2099.4874s
	iters: 400, epoch: 30 | loss: 0.0019442
	speed: 0.0607s/iter; left time: 1996.3998s
Epoch: 30 cost time: 30.039596796035767
Epoch: 30, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.966265 --> -0.973412).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0606409
	speed: 0.2708s/iter; left time: 8862.8861s
	iters: 200, epoch: 31 | loss: 0.0039801
	speed: 0.0643s/iter; left time: 2097.2190s
	iters: 300, epoch: 31 | loss: 0.0169746
	speed: 0.0604s/iter; left time: 1965.9777s
	iters: 400, epoch: 31 | loss: 0.0019793
	speed: 0.0582s/iter; left time: 1887.4971s
Epoch: 31 cost time: 28.90842318534851
Epoch: 31, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0913570
	speed: 0.2677s/iter; left time: 8636.2764s
	iters: 200, epoch: 32 | loss: 0.0212754
	speed: 0.0592s/iter; left time: 1902.4065s
	iters: 300, epoch: 32 | loss: 0.0008799
	speed: 0.0619s/iter; left time: 1985.6958s
	iters: 400, epoch: 32 | loss: 0.1295043
	speed: 0.0687s/iter; left time: 2196.5099s
Epoch: 32 cost time: 29.814703702926636
Epoch: 32, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0062852
	speed: 0.2632s/iter; left time: 8367.8265s
	iters: 200, epoch: 33 | loss: 0.0129091
	speed: 0.0600s/iter; left time: 1900.8409s
	iters: 300, epoch: 33 | loss: 0.0034705
	speed: 0.0625s/iter; left time: 1975.5723s
	iters: 400, epoch: 33 | loss: 0.0097847
	speed: 0.0653s/iter; left time: 2056.5694s
Epoch: 33 cost time: 30.080557584762573
Epoch: 33, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0167852
	speed: 0.3047s/iter; left time: 9543.6998s
	iters: 200, epoch: 34 | loss: 0.0475504
	speed: 0.0669s/iter; left time: 2089.1879s
	iters: 300, epoch: 34 | loss: 0.0444636
	speed: 0.0672s/iter; left time: 2092.8963s
	iters: 400, epoch: 34 | loss: 0.0529382
	speed: 0.0649s/iter; left time: 2012.6731s
Epoch: 34 cost time: 31.916486263275146
Epoch: 34, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0052718
	speed: 0.2903s/iter; left time: 8956.8909s
	iters: 200, epoch: 35 | loss: 0.1536399
	speed: 0.0666s/iter; left time: 2048.1386s
	iters: 300, epoch: 35 | loss: 0.0891857
	speed: 0.0657s/iter; left time: 2013.8274s
	iters: 400, epoch: 35 | loss: 0.1259606
	speed: 0.0658s/iter; left time: 2010.3623s
Epoch: 35 cost time: 31.371249437332153
Epoch: 35, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0044158
	speed: 0.2545s/iter; left time: 7732.1703s
	iters: 200, epoch: 36 | loss: 0.0666869
	speed: 0.0634s/iter; left time: 1920.8630s
	iters: 300, epoch: 36 | loss: 0.0061866
	speed: 0.0635s/iter; left time: 1916.4712s
	iters: 400, epoch: 36 | loss: 0.0141057
	speed: 0.0626s/iter; left time: 1883.2364s
Epoch: 36 cost time: 29.825756788253784
Epoch: 36, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0070532
	speed: 0.2713s/iter; left time: 8117.4642s
	iters: 200, epoch: 37 | loss: 0.0006027
	speed: 0.0626s/iter; left time: 1867.6646s
	iters: 300, epoch: 37 | loss: 0.1911570
	speed: 0.0629s/iter; left time: 1870.4633s
	iters: 400, epoch: 37 | loss: 0.1054453
	speed: 0.0609s/iter; left time: 1802.8328s
Epoch: 37 cost time: 29.80676817893982
Epoch: 37, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0213925
	speed: 0.2719s/iter; left time: 8007.1091s
	iters: 200, epoch: 38 | loss: 0.0008564
	speed: 0.0618s/iter; left time: 1813.9350s
	iters: 300, epoch: 38 | loss: 0.0162502
	speed: 0.0642s/iter; left time: 1877.3495s
	iters: 400, epoch: 38 | loss: 0.0007700
	speed: 0.0628s/iter; left time: 1829.6409s
Epoch: 38 cost time: 29.769648551940918
Epoch: 38, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.946 Test Loss: 0.307 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0142441
	speed: 0.2777s/iter; left time: 8047.7319s
	iters: 200, epoch: 39 | loss: 0.0016819
	speed: 0.0700s/iter; left time: 2022.8330s
	iters: 300, epoch: 39 | loss: 0.0468169
	speed: 0.0628s/iter; left time: 1808.3902s
	iters: 400, epoch: 39 | loss: 0.0012096
	speed: 0.0607s/iter; left time: 1739.7214s
Epoch: 39 cost time: 30.945016145706177
Epoch: 39, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0014978
	speed: 0.2663s/iter; left time: 7592.7341s
	iters: 200, epoch: 40 | loss: 0.0053982
	speed: 0.0598s/iter; left time: 1699.0053s
	iters: 300, epoch: 40 | loss: 0.0086627
	speed: 0.0597s/iter; left time: 1690.4689s
	iters: 400, epoch: 40 | loss: 0.1119540
	speed: 0.0632s/iter; left time: 1783.8257s
Epoch: 40 cost time: 29.108440399169922
Epoch: 40, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9734133790737565
model parameter : 2794170
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3595118
	speed: 0.0759s/iter; left time: 3554.5070s
	iters: 200, epoch: 1 | loss: 0.3685538
	speed: 0.0640s/iter; left time: 2990.1245s
	iters: 300, epoch: 1 | loss: 0.1332931
	speed: 0.0619s/iter; left time: 2885.3987s
	iters: 400, epoch: 1 | loss: 0.0526346
	speed: 0.0617s/iter; left time: 2870.8499s
Epoch: 1 cost time: 30.799971342086792
Epoch: 1, Steps: 469 | Train Loss: 0.491 Vali Loss: 0.325 Vali Acc: 0.880 Test Loss: 0.325 Test Acc: 0.880
Validation loss decreased (inf --> -0.879642).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1474906
	speed: 0.2703s/iter; left time: 12524.4346s
	iters: 200, epoch: 2 | loss: 0.1238373
	speed: 0.0626s/iter; left time: 2893.5103s
	iters: 300, epoch: 2 | loss: 0.2968296
	speed: 0.0621s/iter; left time: 2865.7838s
	iters: 400, epoch: 2 | loss: 0.0851565
	speed: 0.0648s/iter; left time: 2984.6230s
Epoch: 2 cost time: 29.72281265258789
Epoch: 2, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.237 Vali Acc: 0.929 Test Loss: 0.237 Test Acc: 0.929
Validation loss decreased (-0.879642 --> -0.929100).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1222234
	speed: 0.3012s/iter; left time: 13815.9060s
	iters: 200, epoch: 3 | loss: 0.1016544
	speed: 0.0665s/iter; left time: 3043.5776s
	iters: 300, epoch: 3 | loss: 0.0500087
	speed: 0.0660s/iter; left time: 3012.2500s
	iters: 400, epoch: 3 | loss: 0.3011996
	speed: 0.0660s/iter; left time: 3008.7680s
Epoch: 3 cost time: 31.61649227142334
Epoch: 3, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4015135
	speed: 0.2902s/iter; left time: 13174.0980s
	iters: 200, epoch: 4 | loss: 0.0217477
	speed: 0.0649s/iter; left time: 2940.7034s
	iters: 300, epoch: 4 | loss: 0.0292785
	speed: 0.0651s/iter; left time: 2941.1218s
	iters: 400, epoch: 4 | loss: 0.7468263
	speed: 0.0662s/iter; left time: 2985.7524s
Epoch: 4 cost time: 30.849340438842773
Epoch: 4, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.345 Vali Acc: 0.904 Test Loss: 0.345 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2713516
	speed: 0.2962s/iter; left time: 13308.0847s
	iters: 200, epoch: 5 | loss: 0.5788105
	speed: 0.0612s/iter; left time: 2742.1562s
	iters: 300, epoch: 5 | loss: 0.0286437
	speed: 0.0648s/iter; left time: 2899.6420s
	iters: 400, epoch: 5 | loss: 0.2165598
	speed: 0.0643s/iter; left time: 2870.4516s
Epoch: 5 cost time: 30.510430812835693
Epoch: 5, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.929100 --> -0.932816).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2714788
	speed: 0.2705s/iter; left time: 12025.8983s
	iters: 200, epoch: 6 | loss: 0.0234456
	speed: 0.0652s/iter; left time: 2891.9138s
	iters: 300, epoch: 6 | loss: 0.0022979
	speed: 0.0631s/iter; left time: 2794.0014s
	iters: 400, epoch: 6 | loss: 0.0201011
	speed: 0.0610s/iter; left time: 2691.9065s
Epoch: 6 cost time: 29.69828510284424
Epoch: 6, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.304 Vali Acc: 0.920 Test Loss: 0.304 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1173519
	speed: 0.2771s/iter; left time: 12188.2899s
	iters: 200, epoch: 7 | loss: 0.0411663
	speed: 0.0653s/iter; left time: 2865.2335s
	iters: 300, epoch: 7 | loss: 0.0047079
	speed: 0.0635s/iter; left time: 2780.6788s
	iters: 400, epoch: 7 | loss: 0.0155403
	speed: 0.0604s/iter; left time: 2640.6890s
Epoch: 7 cost time: 30.78476858139038
Epoch: 7, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.183 Vali Acc: 0.940 Test Loss: 0.183 Test Acc: 0.940
Validation loss decreased (-0.932816 --> -0.939964).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4408708
	speed: 0.2630s/iter; left time: 11447.3382s
	iters: 200, epoch: 8 | loss: 0.0771827
	speed: 0.0656s/iter; left time: 2849.7333s
	iters: 300, epoch: 8 | loss: 0.0016462
	speed: 0.0627s/iter; left time: 2713.8732s
	iters: 400, epoch: 8 | loss: 0.0913386
	speed: 0.0585s/iter; left time: 2529.7774s
Epoch: 8 cost time: 29.589084148406982
Epoch: 8, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.238 Vali Acc: 0.940 Test Loss: 0.238 Test Acc: 0.940
Validation loss decreased (-0.939964 --> -0.940249).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0764476
	speed: 0.2655s/iter; left time: 11429.8474s
	iters: 200, epoch: 9 | loss: 0.0220943
	speed: 0.0608s/iter; left time: 2610.5435s
	iters: 300, epoch: 9 | loss: 0.1904817
	speed: 0.0611s/iter; left time: 2616.1291s
	iters: 400, epoch: 9 | loss: 0.5576854
	speed: 0.0600s/iter; left time: 2566.3498s
Epoch: 9 cost time: 28.879197120666504
Epoch: 9, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0568346
	speed: 0.2582s/iter; left time: 10993.4025s
	iters: 200, epoch: 10 | loss: 0.3679107
	speed: 0.0591s/iter; left time: 2508.5528s
	iters: 300, epoch: 10 | loss: 0.0173747
	speed: 0.0674s/iter; left time: 2856.9219s
	iters: 400, epoch: 10 | loss: 0.0062749
	speed: 0.0613s/iter; left time: 2589.7997s
Epoch: 10 cost time: 28.84226083755493
Epoch: 10, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.940249 --> -0.952257).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0060507
	speed: 0.2642s/iter; left time: 11125.8683s
	iters: 200, epoch: 11 | loss: 0.2638345
	speed: 0.0672s/iter; left time: 2821.2989s
	iters: 300, epoch: 11 | loss: 0.0386617
	speed: 0.0688s/iter; left time: 2883.2009s
	iters: 400, epoch: 11 | loss: 0.0085912
	speed: 0.0682s/iter; left time: 2850.1613s
Epoch: 11 cost time: 31.664286613464355
Epoch: 11, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.238 Vali Acc: 0.945 Test Loss: 0.238 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0327832
	speed: 0.3005s/iter; left time: 12515.1173s
	iters: 200, epoch: 12 | loss: 0.0207499
	speed: 0.0682s/iter; left time: 2831.8098s
	iters: 300, epoch: 12 | loss: 0.5024562
	speed: 0.0665s/iter; left time: 2755.4334s
	iters: 400, epoch: 12 | loss: 0.0274929
	speed: 0.0633s/iter; left time: 2618.5142s
Epoch: 12 cost time: 32.31781768798828
Epoch: 12, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.952257 --> -0.961977).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1558129
	speed: 0.3027s/iter; left time: 12462.1168s
	iters: 200, epoch: 13 | loss: 0.3828777
	speed: 0.0627s/iter; left time: 2574.2003s
	iters: 300, epoch: 13 | loss: 0.0131665
	speed: 0.0654s/iter; left time: 2678.4553s
	iters: 400, epoch: 13 | loss: 0.0196786
	speed: 0.0635s/iter; left time: 2593.5745s
Epoch: 13 cost time: 30.581012964248657
Epoch: 13, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2996580
	speed: 0.2716s/iter; left time: 11057.1893s
	iters: 200, epoch: 14 | loss: 0.1411715
	speed: 0.0630s/iter; left time: 2557.3097s
	iters: 300, epoch: 14 | loss: 0.0707968
	speed: 0.0630s/iter; left time: 2551.8850s
	iters: 400, epoch: 14 | loss: 0.0848832
	speed: 0.0663s/iter; left time: 2680.5972s
Epoch: 14 cost time: 30.054385662078857
Epoch: 14, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0112733
	speed: 0.2614s/iter; left time: 10516.0626s
	iters: 200, epoch: 15 | loss: 0.1803800
	speed: 0.0639s/iter; left time: 2565.0359s
	iters: 300, epoch: 15 | loss: 0.3094595
	speed: 0.0614s/iter; left time: 2459.7162s
	iters: 400, epoch: 15 | loss: 0.0035764
	speed: 0.0629s/iter; left time: 2513.8413s
Epoch: 15 cost time: 29.764144897460938
Epoch: 15, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.233 Vali Acc: 0.947 Test Loss: 0.233 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0014309
	speed: 0.2775s/iter; left time: 11036.9409s
	iters: 200, epoch: 16 | loss: 0.1427928
	speed: 0.0631s/iter; left time: 2501.3040s
	iters: 300, epoch: 16 | loss: 0.0014105
	speed: 0.0633s/iter; left time: 2506.2296s
	iters: 400, epoch: 16 | loss: 0.0681256
	speed: 0.0598s/iter; left time: 2358.4885s
Epoch: 16 cost time: 29.57461714744568
Epoch: 16, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3680681
	speed: 0.2806s/iter; left time: 11025.5148s
	iters: 200, epoch: 17 | loss: 0.0010101
	speed: 0.0634s/iter; left time: 2483.8806s
	iters: 300, epoch: 17 | loss: 0.0062734
	speed: 0.0619s/iter; left time: 2420.5527s
	iters: 400, epoch: 17 | loss: 0.0014070
	speed: 0.0643s/iter; left time: 2508.0690s
Epoch: 17 cost time: 30.347668409347534
Epoch: 17, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0223713
	speed: 0.2677s/iter; left time: 10392.8838s
	iters: 200, epoch: 18 | loss: 0.4145969
	speed: 0.0636s/iter; left time: 2463.7186s
	iters: 300, epoch: 18 | loss: 0.0024725
	speed: 0.0660s/iter; left time: 2548.9074s
	iters: 400, epoch: 18 | loss: 0.0104182
	speed: 0.0673s/iter; left time: 2591.1123s
Epoch: 18 cost time: 30.258612632751465
Epoch: 18, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0041754
	speed: 0.2661s/iter; left time: 10206.2253s
	iters: 200, epoch: 19 | loss: 0.0021478
	speed: 0.0627s/iter; left time: 2397.4889s
	iters: 300, epoch: 19 | loss: 0.0071006
	speed: 0.0604s/iter; left time: 2305.6853s
	iters: 400, epoch: 19 | loss: 0.0042611
	speed: 0.0628s/iter; left time: 2390.7871s
Epoch: 19 cost time: 29.713542222976685
Epoch: 19, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0039393
	speed: 0.2762s/iter; left time: 10464.2452s
	iters: 200, epoch: 20 | loss: 0.0003300
	speed: 0.0586s/iter; left time: 2213.1756s
	iters: 300, epoch: 20 | loss: 0.0080724
	speed: 0.0620s/iter; left time: 2335.6966s
	iters: 400, epoch: 20 | loss: 0.0181333
	speed: 0.0639s/iter; left time: 2400.2663s
Epoch: 20 cost time: 29.291608095169067
Epoch: 20, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4114767
	speed: 0.2950s/iter; left time: 11039.0448s
	iters: 200, epoch: 21 | loss: 0.4971431
	speed: 0.0657s/iter; left time: 2452.5319s
	iters: 300, epoch: 21 | loss: 0.4739740
	speed: 0.0639s/iter; left time: 2378.4014s
	iters: 400, epoch: 21 | loss: 0.0376971
	speed: 0.0660s/iter; left time: 2450.4888s
Epoch: 21 cost time: 31.063234567642212
Epoch: 21, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0045925
	speed: 0.2891s/iter; left time: 10683.1644s
	iters: 200, epoch: 22 | loss: 0.0026129
	speed: 0.0649s/iter; left time: 2390.5665s
	iters: 300, epoch: 22 | loss: 0.1834357
	speed: 0.0678s/iter; left time: 2490.5968s
	iters: 400, epoch: 22 | loss: 0.0905792
	speed: 0.0666s/iter; left time: 2441.1722s
Epoch: 22 cost time: 31.112536430358887
Epoch: 22, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
Validation loss decreased (-0.961977 --> -0.963692).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0031510
	speed: 0.2777s/iter; left time: 10130.6112s
	iters: 200, epoch: 23 | loss: 0.0122230
	speed: 0.0625s/iter; left time: 2273.7986s
	iters: 300, epoch: 23 | loss: 0.0028400
	speed: 0.0624s/iter; left time: 2263.9597s
	iters: 400, epoch: 23 | loss: 0.1021293
	speed: 0.0607s/iter; left time: 2197.2935s
Epoch: 23 cost time: 28.975341320037842
Epoch: 23, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.7965406
	speed: 0.2598s/iter; left time: 9354.6645s
	iters: 200, epoch: 24 | loss: 0.0997228
	speed: 0.0573s/iter; left time: 2058.9540s
	iters: 300, epoch: 24 | loss: 0.0073810
	speed: 0.0557s/iter; left time: 1994.1177s
	iters: 400, epoch: 24 | loss: 0.0042584
	speed: 0.0612s/iter; left time: 2183.9374s
Epoch: 24 cost time: 28.289134979248047
Epoch: 24, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0019007
	speed: 0.2735s/iter; left time: 9721.4117s
	iters: 200, epoch: 25 | loss: 0.0013265
	speed: 0.0635s/iter; left time: 2251.9052s
	iters: 300, epoch: 25 | loss: 0.0139418
	speed: 0.0608s/iter; left time: 2149.9109s
	iters: 400, epoch: 25 | loss: 0.0965173
	speed: 0.0618s/iter; left time: 2178.7834s
Epoch: 25 cost time: 29.526418209075928
Epoch: 25, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0612786
	speed: 0.2734s/iter; left time: 9588.8495s
	iters: 200, epoch: 26 | loss: 0.0018105
	speed: 0.0628s/iter; left time: 2196.6095s
	iters: 300, epoch: 26 | loss: 0.0028052
	speed: 0.0659s/iter; left time: 2298.1197s
	iters: 400, epoch: 26 | loss: 0.0016287
	speed: 0.0621s/iter; left time: 2158.7051s
Epoch: 26 cost time: 30.29821515083313
Epoch: 26, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0123516
	speed: 0.2736s/iter; left time: 9469.7222s
	iters: 200, epoch: 27 | loss: 0.0025277
	speed: 0.0596s/iter; left time: 2054.9927s
	iters: 300, epoch: 27 | loss: 0.0370310
	speed: 0.0608s/iter; left time: 2092.4881s
	iters: 400, epoch: 27 | loss: 0.0348596
	speed: 0.0649s/iter; left time: 2226.8743s
Epoch: 27 cost time: 29.389144897460938
Epoch: 27, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0127654
	speed: 0.2600s/iter; left time: 8876.5975s
	iters: 200, epoch: 28 | loss: 0.0629462
	speed: 0.0581s/iter; left time: 1978.1696s
	iters: 300, epoch: 28 | loss: 0.0727848
	speed: 0.0633s/iter; left time: 2146.6708s
	iters: 400, epoch: 28 | loss: 0.0006758
	speed: 0.0639s/iter; left time: 2163.5530s
Epoch: 28 cost time: 29.243889093399048
Epoch: 28, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.351 Vali Acc: 0.921 Test Loss: 0.351 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0212924
	speed: 0.2758s/iter; left time: 9287.1701s
	iters: 200, epoch: 29 | loss: 0.0075553
	speed: 0.0613s/iter; left time: 2057.1834s
	iters: 300, epoch: 29 | loss: 0.2300805
	speed: 0.0644s/iter; left time: 2154.0823s
	iters: 400, epoch: 29 | loss: 0.1661995
	speed: 0.0651s/iter; left time: 2171.6554s
Epoch: 29 cost time: 30.68240237236023
Epoch: 29, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0052479
	speed: 0.2914s/iter; left time: 9675.9649s
	iters: 200, epoch: 30 | loss: 0.0052319
	speed: 0.0688s/iter; left time: 2277.4191s
	iters: 300, epoch: 30 | loss: 0.0040465
	speed: 0.0642s/iter; left time: 2118.8229s
	iters: 400, epoch: 30 | loss: 0.0019777
	speed: 0.0629s/iter; left time: 2069.4483s
Epoch: 30 cost time: 31.068824529647827
Epoch: 30, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0138134
	speed: 0.2745s/iter; left time: 8983.6582s
	iters: 200, epoch: 31 | loss: 0.0076043
	speed: 0.0641s/iter; left time: 2090.8480s
	iters: 300, epoch: 31 | loss: 0.0214574
	speed: 0.0692s/iter; left time: 2249.9003s
	iters: 400, epoch: 31 | loss: 0.0010629
	speed: 0.0643s/iter; left time: 2084.3593s
Epoch: 31 cost time: 30.9836745262146
Epoch: 31, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.5162277
	speed: 0.2866s/iter; left time: 9245.9592s
	iters: 200, epoch: 32 | loss: 0.0041715
	speed: 0.0659s/iter; left time: 2119.5186s
	iters: 300, epoch: 32 | loss: 0.0011236
	speed: 0.0679s/iter; left time: 2176.9541s
	iters: 400, epoch: 32 | loss: 0.0190442
	speed: 0.0644s/iter; left time: 2057.9330s
Epoch: 32 cost time: 30.951224327087402
Epoch: 32, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9636935391652373
model parameter : 2793786
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7606711
	speed: 0.0763s/iter; left time: 3570.1876s
	iters: 200, epoch: 1 | loss: 0.2934020
	speed: 0.0624s/iter; left time: 2915.0521s
	iters: 300, epoch: 1 | loss: 0.5681835
	speed: 0.0646s/iter; left time: 3008.6698s
	iters: 400, epoch: 1 | loss: 0.0685444
	speed: 0.0593s/iter; left time: 2759.0622s
Epoch: 1 cost time: 30.48391842842102
Epoch: 1, Steps: 469 | Train Loss: 0.468 Vali Loss: 0.429 Vali Acc: 0.863 Test Loss: 0.429 Test Acc: 0.863
Validation loss decreased (inf --> -0.863346).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1459420
	speed: 0.2661s/iter; left time: 12328.6139s
	iters: 200, epoch: 2 | loss: 0.3661670
	speed: 0.0579s/iter; left time: 2678.3434s
	iters: 300, epoch: 2 | loss: 0.3640187
	speed: 0.0562s/iter; left time: 2592.6260s
	iters: 400, epoch: 2 | loss: 0.2733995
	speed: 0.0602s/iter; left time: 2771.3754s
Epoch: 2 cost time: 27.936572074890137
Epoch: 2, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.233 Vali Acc: 0.934 Test Loss: 0.233 Test Acc: 0.934
Validation loss decreased (-0.863346 --> -0.933960).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1544987
	speed: 0.2715s/iter; left time: 12451.7025s
	iters: 200, epoch: 3 | loss: 0.0288019
	speed: 0.0596s/iter; left time: 2725.4884s
	iters: 300, epoch: 3 | loss: 0.0836051
	speed: 0.0581s/iter; left time: 2655.1154s
	iters: 400, epoch: 3 | loss: 0.0352707
	speed: 0.0587s/iter; left time: 2673.4107s
Epoch: 3 cost time: 28.15443730354309
Epoch: 3, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0909666
	speed: 0.2666s/iter; left time: 12101.6699s
	iters: 200, epoch: 4 | loss: 0.0605554
	speed: 0.0594s/iter; left time: 2690.0921s
	iters: 300, epoch: 4 | loss: 0.3383990
	speed: 0.0601s/iter; left time: 2718.4177s
	iters: 400, epoch: 4 | loss: 0.1733096
	speed: 0.0600s/iter; left time: 2705.1951s
Epoch: 4 cost time: 28.88336753845215
Epoch: 4, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2078375
	speed: 0.2558s/iter; left time: 11491.2583s
	iters: 200, epoch: 5 | loss: 0.0650935
	speed: 0.0601s/iter; left time: 2696.0479s
	iters: 300, epoch: 5 | loss: 0.0358924
	speed: 0.0622s/iter; left time: 2781.3854s
	iters: 400, epoch: 5 | loss: 0.0548190
	speed: 0.0634s/iter; left time: 2831.0300s
Epoch: 5 cost time: 29.20266032218933
Epoch: 5, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
Validation loss decreased (-0.933960 --> -0.954544).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4465448
	speed: 0.2707s/iter; left time: 12033.1055s
	iters: 200, epoch: 6 | loss: 0.3150030
	speed: 0.0614s/iter; left time: 2722.3137s
	iters: 300, epoch: 6 | loss: 0.0103789
	speed: 0.0655s/iter; left time: 2896.7673s
	iters: 400, epoch: 6 | loss: 0.0253855
	speed: 0.0610s/iter; left time: 2693.9656s
Epoch: 6 cost time: 29.450291395187378
Epoch: 6, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2465840
	speed: 0.2928s/iter; left time: 12880.3326s
	iters: 200, epoch: 7 | loss: 0.1785212
	speed: 0.0625s/iter; left time: 2743.1561s
	iters: 300, epoch: 7 | loss: 0.0560179
	speed: 0.0598s/iter; left time: 2616.5148s
	iters: 400, epoch: 7 | loss: 0.2809947
	speed: 0.0584s/iter; left time: 2553.2207s
Epoch: 7 cost time: 29.712174892425537
Epoch: 7, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1092247
	speed: 0.2800s/iter; left time: 12187.1040s
	iters: 200, epoch: 8 | loss: 0.1319153
	speed: 0.0695s/iter; left time: 3016.1699s
	iters: 300, epoch: 8 | loss: 0.1385466
	speed: 0.0642s/iter; left time: 2780.3407s
	iters: 400, epoch: 8 | loss: 0.0047416
	speed: 0.0628s/iter; left time: 2713.5695s
Epoch: 8 cost time: 31.142135620117188
Epoch: 8, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0195682
	speed: 0.2664s/iter; left time: 11468.0140s
	iters: 200, epoch: 9 | loss: 0.0400916
	speed: 0.0518s/iter; left time: 2225.7916s
	iters: 300, epoch: 9 | loss: 0.0217054
	speed: 0.0572s/iter; left time: 2451.3345s
	iters: 400, epoch: 9 | loss: 0.0214346
	speed: 0.0666s/iter; left time: 2846.0465s
Epoch: 9 cost time: 27.847376585006714
Epoch: 9, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.320 Vali Acc: 0.914 Test Loss: 0.320 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0055308
	speed: 0.2610s/iter; left time: 11114.6369s
	iters: 200, epoch: 10 | loss: 0.0178344
	speed: 0.0592s/iter; left time: 2514.8083s
	iters: 300, epoch: 10 | loss: 0.0177211
	speed: 0.0620s/iter; left time: 2627.3552s
	iters: 400, epoch: 10 | loss: 0.0233827
	speed: 0.0599s/iter; left time: 2531.3016s
Epoch: 10 cost time: 28.46226167678833
Epoch: 10, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0028173
	speed: 0.2707s/iter; left time: 11400.5076s
	iters: 200, epoch: 11 | loss: 0.1748862
	speed: 0.0576s/iter; left time: 2419.5336s
	iters: 300, epoch: 11 | loss: 0.0149168
	speed: 0.0566s/iter; left time: 2373.9136s
	iters: 400, epoch: 11 | loss: 0.0087644
	speed: 0.0559s/iter; left time: 2336.0697s
Epoch: 11 cost time: 27.251243352890015
Epoch: 11, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.301 Vali Acc: 0.916 Test Loss: 0.301 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1120519
	speed: 0.2502s/iter; left time: 10419.5827s
	iters: 200, epoch: 12 | loss: 0.2301416
	speed: 0.0579s/iter; left time: 2406.5811s
	iters: 300, epoch: 12 | loss: 0.0245368
	speed: 0.0597s/iter; left time: 2475.5103s
	iters: 400, epoch: 12 | loss: 0.0176078
	speed: 0.0588s/iter; left time: 2431.5447s
Epoch: 12 cost time: 28.04241108894348
Epoch: 12, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1390267
	speed: 0.2628s/iter; left time: 10818.2607s
	iters: 200, epoch: 13 | loss: 0.0160927
	speed: 0.0597s/iter; left time: 2453.8229s
	iters: 300, epoch: 13 | loss: 0.0190303
	speed: 0.0591s/iter; left time: 2422.6045s
	iters: 400, epoch: 13 | loss: 0.0855519
	speed: 0.0646s/iter; left time: 2641.7398s
Epoch: 13 cost time: 29.066402196884155
Epoch: 13, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0289702
	speed: 0.2609s/iter; left time: 10619.6863s
	iters: 200, epoch: 14 | loss: 0.0876222
	speed: 0.0572s/iter; left time: 2322.0482s
	iters: 300, epoch: 14 | loss: 0.0405914
	speed: 0.0585s/iter; left time: 2371.3198s
	iters: 400, epoch: 14 | loss: 0.1624144
	speed: 0.0587s/iter; left time: 2373.2215s
Epoch: 14 cost time: 27.4478178024292
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.228 Vali Acc: 0.957 Test Loss: 0.228 Test Acc: 0.957
Validation loss decreased (-0.954544 --> -0.957402).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2276863
	speed: 0.2610s/iter; left time: 10501.1077s
	iters: 200, epoch: 15 | loss: 0.0358294
	speed: 0.0667s/iter; left time: 2676.3876s
	iters: 300, epoch: 15 | loss: 0.0136953
	speed: 0.0594s/iter; left time: 2376.1116s
	iters: 400, epoch: 15 | loss: 0.0955992
	speed: 0.0584s/iter; left time: 2332.7649s
Epoch: 15 cost time: 29.231085300445557
Epoch: 15, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0039628
	speed: 0.2762s/iter; left time: 10983.8351s
	iters: 200, epoch: 16 | loss: 0.0463701
	speed: 0.0600s/iter; left time: 2380.8613s
	iters: 300, epoch: 16 | loss: 0.0783894
	speed: 0.0616s/iter; left time: 2437.7247s
	iters: 400, epoch: 16 | loss: 0.0276426
	speed: 0.0613s/iter; left time: 2420.5713s
Epoch: 16 cost time: 29.376333236694336
Epoch: 16, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.248 Vali Acc: 0.936 Test Loss: 0.248 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0023992
	speed: 0.2818s/iter; left time: 11075.3424s
	iters: 200, epoch: 17 | loss: 0.0049308
	speed: 0.0587s/iter; left time: 2300.6746s
	iters: 300, epoch: 17 | loss: 0.0052325
	speed: 0.0637s/iter; left time: 2489.4970s
	iters: 400, epoch: 17 | loss: 0.0077276
	speed: 0.0615s/iter; left time: 2396.4098s
Epoch: 17 cost time: 29.17062544822693
Epoch: 17, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.957402 --> -0.957688).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5666764
	speed: 0.2838s/iter; left time: 11021.1678s
	iters: 200, epoch: 18 | loss: 0.2761589
	speed: 0.0680s/iter; left time: 2632.2359s
	iters: 300, epoch: 18 | loss: 0.0309165
	speed: 0.0649s/iter; left time: 2508.0573s
	iters: 400, epoch: 18 | loss: 0.0041500
	speed: 0.0570s/iter; left time: 2195.1229s
Epoch: 18 cost time: 29.668680906295776
Epoch: 18, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.309 Vali Acc: 0.940 Test Loss: 0.309 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0077383
	speed: 0.2672s/iter; left time: 10248.3478s
	iters: 200, epoch: 19 | loss: 0.0174205
	speed: 0.0580s/iter; left time: 2218.4328s
	iters: 300, epoch: 19 | loss: 0.0080474
	speed: 0.0579s/iter; left time: 2210.1874s
	iters: 400, epoch: 19 | loss: 0.0052746
	speed: 0.0591s/iter; left time: 2249.7268s
Epoch: 19 cost time: 28.20148801803589
Epoch: 19, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1512917
	speed: 0.2756s/iter; left time: 10442.7404s
	iters: 200, epoch: 20 | loss: 0.0035152
	speed: 0.0613s/iter; left time: 2316.7488s
	iters: 300, epoch: 20 | loss: 0.0141058
	speed: 0.0580s/iter; left time: 2187.3936s
	iters: 400, epoch: 20 | loss: 0.0039700
	speed: 0.0628s/iter; left time: 2361.1120s
Epoch: 20 cost time: 29.054619312286377
Epoch: 20, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0144900
	speed: 0.2582s/iter; left time: 9663.4954s
	iters: 200, epoch: 21 | loss: 0.0430232
	speed: 0.0599s/iter; left time: 2234.9970s
	iters: 300, epoch: 21 | loss: 0.0057691
	speed: 0.0604s/iter; left time: 2248.9844s
	iters: 400, epoch: 21 | loss: 0.1330985
	speed: 0.0609s/iter; left time: 2259.3672s
Epoch: 21 cost time: 27.99339199066162
Epoch: 21, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.241 Vali Acc: 0.940 Test Loss: 0.241 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0083156
	speed: 0.2363s/iter; left time: 8730.5942s
	iters: 200, epoch: 22 | loss: 0.1654606
	speed: 0.0528s/iter; left time: 1947.3466s
	iters: 300, epoch: 22 | loss: 0.0030810
	speed: 0.0553s/iter; left time: 2032.4864s
	iters: 400, epoch: 22 | loss: 0.0015120
	speed: 0.0604s/iter; left time: 2214.4880s
Epoch: 22 cost time: 27.20741057395935
Epoch: 22, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.265 Vali Acc: 0.924 Test Loss: 0.265 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0028437
	speed: 0.2584s/iter; left time: 9426.9024s
	iters: 200, epoch: 23 | loss: 0.1719480
	speed: 0.0578s/iter; left time: 2101.7350s
	iters: 300, epoch: 23 | loss: 0.0265166
	speed: 0.0561s/iter; left time: 2037.2702s
	iters: 400, epoch: 23 | loss: 0.0048128
	speed: 0.0600s/iter; left time: 2170.4589s
Epoch: 23 cost time: 27.691518306732178
Epoch: 23, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.245 Vali Acc: 0.946 Test Loss: 0.245 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.4286193
	speed: 0.2712s/iter; left time: 9767.6783s
	iters: 200, epoch: 24 | loss: 0.0011687
	speed: 0.0625s/iter; left time: 2244.1880s
	iters: 300, epoch: 24 | loss: 0.0189780
	speed: 0.0607s/iter; left time: 2173.5194s
	iters: 400, epoch: 24 | loss: 0.0016846
	speed: 0.0595s/iter; left time: 2126.0186s
Epoch: 24 cost time: 28.70471453666687
Epoch: 24, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2942074
	speed: 0.2637s/iter; left time: 9374.6960s
	iters: 200, epoch: 25 | loss: 0.0058236
	speed: 0.0653s/iter; left time: 2313.3521s
	iters: 300, epoch: 25 | loss: 0.0164420
	speed: 0.0639s/iter; left time: 2258.5505s
	iters: 400, epoch: 25 | loss: 0.0030505
	speed: 0.0637s/iter; left time: 2245.4312s
Epoch: 25 cost time: 30.810205698013306
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0049658
	speed: 0.2712s/iter; left time: 9511.6059s
	iters: 200, epoch: 26 | loss: 0.0736485
	speed: 0.0594s/iter; left time: 2076.9579s
	iters: 300, epoch: 26 | loss: 0.0052611
	speed: 0.0615s/iter; left time: 2146.0619s
	iters: 400, epoch: 26 | loss: 0.0040340
	speed: 0.0674s/iter; left time: 2343.1663s
Epoch: 26 cost time: 29.648957014083862
Epoch: 26, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0091542
	speed: 0.2814s/iter; left time: 9740.0498s
	iters: 200, epoch: 27 | loss: 0.0163164
	speed: 0.0615s/iter; left time: 2122.0433s
	iters: 300, epoch: 27 | loss: 0.0062818
	speed: 0.0621s/iter; left time: 2137.7257s
	iters: 400, epoch: 27 | loss: 0.3735440
	speed: 0.0618s/iter; left time: 2120.4515s
Epoch: 27 cost time: 29.531565189361572
Epoch: 27, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.957688 --> -0.957974).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0132184
	speed: 0.2639s/iter; left time: 9008.4525s
	iters: 200, epoch: 28 | loss: 0.0103372
	speed: 0.0612s/iter; left time: 2082.5494s
	iters: 300, epoch: 28 | loss: 0.0392115
	speed: 0.0581s/iter; left time: 1972.3558s
	iters: 400, epoch: 28 | loss: 0.0052719
	speed: 0.0570s/iter; left time: 1928.0597s
Epoch: 28 cost time: 27.80339288711548
Epoch: 28, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.957974 --> -0.963120).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0045527
	speed: 0.2615s/iter; left time: 8805.3128s
	iters: 200, epoch: 29 | loss: 0.0129079
	speed: 0.0642s/iter; left time: 2155.2327s
	iters: 300, epoch: 29 | loss: 0.0066463
	speed: 0.0600s/iter; left time: 2006.7991s
	iters: 400, epoch: 29 | loss: 0.0007055
	speed: 0.0587s/iter; left time: 1960.3194s
Epoch: 29 cost time: 29.194056510925293
Epoch: 29, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.248 Vali Acc: 0.951 Test Loss: 0.248 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0473719
	speed: 0.2597s/iter; left time: 8622.9394s
	iters: 200, epoch: 30 | loss: 0.0684253
	speed: 0.0583s/iter; left time: 1928.6369s
	iters: 300, epoch: 30 | loss: 0.0263032
	speed: 0.0590s/iter; left time: 1948.2967s
	iters: 400, epoch: 30 | loss: 0.0171490
	speed: 0.0632s/iter; left time: 2077.8761s
Epoch: 30 cost time: 28.812677145004272
Epoch: 30, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0034722
	speed: 0.2698s/iter; left time: 8831.4984s
	iters: 200, epoch: 31 | loss: 0.0665046
	speed: 0.0566s/iter; left time: 1845.5539s
	iters: 300, epoch: 31 | loss: 0.0759100
	speed: 0.0576s/iter; left time: 1874.7200s
	iters: 400, epoch: 31 | loss: 0.0038161
	speed: 0.0580s/iter; left time: 1881.9480s
Epoch: 31 cost time: 27.821998119354248
Epoch: 31, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0194768
	speed: 0.2688s/iter; left time: 8672.6828s
	iters: 200, epoch: 32 | loss: 0.0080064
	speed: 0.0566s/iter; left time: 1819.9506s
	iters: 300, epoch: 32 | loss: 0.0017681
	speed: 0.0588s/iter; left time: 1886.4738s
	iters: 400, epoch: 32 | loss: 0.0320088
	speed: 0.0602s/iter; left time: 1924.8305s
Epoch: 32 cost time: 27.827012062072754
Epoch: 32, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.218 Vali Acc: 0.945 Test Loss: 0.218 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0397730
	speed: 0.2514s/iter; left time: 7993.7497s
	iters: 200, epoch: 33 | loss: 0.0649182
	speed: 0.0610s/iter; left time: 1934.4890s
	iters: 300, epoch: 33 | loss: 0.0057529
	speed: 0.0627s/iter; left time: 1980.4457s
	iters: 400, epoch: 33 | loss: 0.0025067
	speed: 0.0622s/iter; left time: 1959.8897s
Epoch: 33 cost time: 28.90620732307434
Epoch: 33, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0645756
	speed: 0.2592s/iter; left time: 8118.8792s
	iters: 200, epoch: 34 | loss: 0.0086219
	speed: 0.0603s/iter; left time: 1882.2965s
	iters: 300, epoch: 34 | loss: 0.0066955
	speed: 0.0607s/iter; left time: 1888.5367s
	iters: 400, epoch: 34 | loss: 0.1224416
	speed: 0.0644s/iter; left time: 1997.1973s
Epoch: 34 cost time: 29.702410221099854
Epoch: 34, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0063793
	speed: 0.2928s/iter; left time: 9035.3173s
	iters: 200, epoch: 35 | loss: 0.0013557
	speed: 0.0606s/iter; left time: 1862.8715s
	iters: 300, epoch: 35 | loss: 0.0421248
	speed: 0.0608s/iter; left time: 1863.5304s
	iters: 400, epoch: 35 | loss: 0.0012948
	speed: 0.0605s/iter; left time: 1848.6919s
Epoch: 35 cost time: 29.187395095825195
Epoch: 35, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0028814
	speed: 0.2820s/iter; left time: 8568.9511s
	iters: 200, epoch: 36 | loss: 0.1908729
	speed: 0.0620s/iter; left time: 1876.2835s
	iters: 300, epoch: 36 | loss: 0.0017242
	speed: 0.0618s/iter; left time: 1866.6578s
	iters: 400, epoch: 36 | loss: 0.1148214
	speed: 0.0643s/iter; left time: 1935.4059s
Epoch: 36 cost time: 30.02372670173645
Epoch: 36, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.963120 --> -0.963406).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0100228
	speed: 0.2600s/iter; left time: 7778.7623s
	iters: 200, epoch: 37 | loss: 0.0502548
	speed: 0.0618s/iter; left time: 1843.3404s
	iters: 300, epoch: 37 | loss: 0.0055924
	speed: 0.0614s/iter; left time: 1823.5840s
	iters: 400, epoch: 37 | loss: 0.0013837
	speed: 0.0573s/iter; left time: 1696.6637s
Epoch: 37 cost time: 28.296845197677612
Epoch: 37, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.963406 --> -0.969696).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0037852
	speed: 0.2576s/iter; left time: 7586.6427s
	iters: 200, epoch: 38 | loss: 0.0013919
	speed: 0.0626s/iter; left time: 1837.7637s
	iters: 300, epoch: 38 | loss: 0.0123139
	speed: 0.0647s/iter; left time: 1893.7101s
	iters: 400, epoch: 38 | loss: 0.0005828
	speed: 0.0656s/iter; left time: 1913.0540s
Epoch: 38 cost time: 29.898463010787964
Epoch: 38, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0041306
	speed: 0.2625s/iter; left time: 7606.8951s
	iters: 200, epoch: 39 | loss: 0.0020281
	speed: 0.0591s/iter; left time: 1705.6608s
	iters: 300, epoch: 39 | loss: 0.0125354
	speed: 0.0584s/iter; left time: 1680.7417s
	iters: 400, epoch: 39 | loss: 0.0189543
	speed: 0.0620s/iter; left time: 1779.1995s
Epoch: 39 cost time: 28.617332220077515
Epoch: 39, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0019880
	speed: 0.2725s/iter; left time: 7768.2898s
	iters: 200, epoch: 40 | loss: 0.0025795
	speed: 0.0582s/iter; left time: 1653.0770s
	iters: 300, epoch: 40 | loss: 0.0088250
	speed: 0.0566s/iter; left time: 1603.0288s
	iters: 400, epoch: 40 | loss: 0.0192448
	speed: 0.0599s/iter; left time: 1689.6389s
Epoch: 40 cost time: 28.03579592704773
Epoch: 40, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.0295780
	speed: 0.2662s/iter; left time: 7463.1857s
	iters: 200, epoch: 41 | loss: 0.8094405
	speed: 0.0590s/iter; left time: 1649.6993s
	iters: 300, epoch: 41 | loss: 0.0062552
	speed: 0.0594s/iter; left time: 1654.3087s
	iters: 400, epoch: 41 | loss: 0.0095856
	speed: 0.0558s/iter; left time: 1547.3048s
Epoch: 41 cost time: 28.24405074119568
Epoch: 41, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.0010920
	speed: 0.2563s/iter; left time: 7067.9576s
	iters: 200, epoch: 42 | loss: 0.0007911
	speed: 0.0586s/iter; left time: 1609.3165s
	iters: 300, epoch: 42 | loss: 0.0675518
	speed: 0.0553s/iter; left time: 1513.8384s
	iters: 400, epoch: 42 | loss: 0.0172323
	speed: 0.0604s/iter; left time: 1646.7607s
Epoch: 42 cost time: 27.719640970230103
Epoch: 42, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 0.0006430
	speed: 0.2708s/iter; left time: 7339.3916s
	iters: 200, epoch: 43 | loss: 0.0008179
	speed: 0.0585s/iter; left time: 1580.2258s
	iters: 300, epoch: 43 | loss: 0.0100896
	speed: 0.0551s/iter; left time: 1483.5345s
	iters: 400, epoch: 43 | loss: 0.0119929
	speed: 0.0611s/iter; left time: 1637.1747s
Epoch: 43 cost time: 28.11883544921875
Epoch: 43, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.189 Vali Acc: 0.966 Test Loss: 0.189 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 0.0028489
	speed: 0.2816s/iter; left time: 7499.5505s
	iters: 200, epoch: 44 | loss: 0.0048851
	speed: 0.0661s/iter; left time: 1752.7937s
	iters: 300, epoch: 44 | loss: 0.0037534
	speed: 0.0640s/iter; left time: 1691.2378s
	iters: 400, epoch: 44 | loss: 0.3639396
	speed: 0.0601s/iter; left time: 1583.4563s
Epoch: 44 cost time: 29.614579677581787
Epoch: 44, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.0006277
	speed: 0.2702s/iter; left time: 7069.5967s
	iters: 200, epoch: 45 | loss: 0.0022641
	speed: 0.0638s/iter; left time: 1662.6694s
	iters: 300, epoch: 45 | loss: 0.0065205
	speed: 0.0616s/iter; left time: 1598.4082s
	iters: 400, epoch: 45 | loss: 0.0033235
	speed: 0.0619s/iter; left time: 1600.1882s
Epoch: 45 cost time: 29.92232632637024
Epoch: 45, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 46 | loss: 0.0344748
	speed: 0.2831s/iter; left time: 7274.4807s
	iters: 200, epoch: 46 | loss: 0.0003137
	speed: 0.0662s/iter; left time: 1694.7881s
	iters: 300, epoch: 46 | loss: 0.0069104
	speed: 0.0586s/iter; left time: 1495.1874s
	iters: 400, epoch: 46 | loss: 0.0043049
	speed: 0.0589s/iter; left time: 1495.5083s
Epoch: 46 cost time: 29.422261953353882
Epoch: 46, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 47 | loss: 0.0261687
	speed: 0.2586s/iter; left time: 6523.9815s
	iters: 200, epoch: 47 | loss: 0.0030750
	speed: 0.0569s/iter; left time: 1429.0403s
	iters: 300, epoch: 47 | loss: 0.0005901
	speed: 0.0618s/iter; left time: 1546.1380s
	iters: 400, epoch: 47 | loss: 0.0010219
	speed: 0.0622s/iter; left time: 1550.8049s
Epoch: 47 cost time: 28.553926467895508
Epoch: 47, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9696969696969697
model parameter : 2793402
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5249625
	speed: 0.0773s/iter; left time: 3617.6923s
	iters: 200, epoch: 1 | loss: 0.1093007
	speed: 0.0665s/iter; left time: 3105.6301s
	iters: 300, epoch: 1 | loss: 0.3730850
	speed: 0.0677s/iter; left time: 3156.8893s
	iters: 400, epoch: 1 | loss: 0.0817901
	speed: 0.0703s/iter; left time: 3269.6163s
Epoch: 1 cost time: 32.577120780944824
Epoch: 1, Steps: 469 | Train Loss: 0.504 Vali Loss: 0.229 Vali Acc: 0.929 Test Loss: 0.229 Test Acc: 0.929
Validation loss decreased (inf --> -0.928814).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0982018
	speed: 0.2670s/iter; left time: 12368.7901s
	iters: 200, epoch: 2 | loss: 0.2027183
	speed: 0.0629s/iter; left time: 2908.1086s
	iters: 300, epoch: 2 | loss: 0.0286114
	speed: 0.0653s/iter; left time: 3013.2654s
	iters: 400, epoch: 2 | loss: 0.3658904
	speed: 0.0659s/iter; left time: 3031.8987s
Epoch: 2 cost time: 29.888039588928223
Epoch: 2, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.219 Vali Acc: 0.934 Test Loss: 0.219 Test Acc: 0.934
Validation loss decreased (-0.928814 --> -0.934246).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0618640
	speed: 0.2476s/iter; left time: 11354.0431s
	iters: 200, epoch: 3 | loss: 0.2286353
	speed: 0.0615s/iter; left time: 2812.7444s
	iters: 300, epoch: 3 | loss: 0.0485779
	speed: 0.0667s/iter; left time: 3044.4642s
	iters: 400, epoch: 3 | loss: 0.0411597
	speed: 0.0609s/iter; left time: 2773.9717s
Epoch: 3 cost time: 29.89460062980652
Epoch: 3, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.346 Vali Acc: 0.905 Test Loss: 0.346 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2824829
	speed: 0.2657s/iter; left time: 12062.3688s
	iters: 200, epoch: 4 | loss: 0.1522673
	speed: 0.0592s/iter; left time: 2682.2996s
	iters: 300, epoch: 4 | loss: 0.1229344
	speed: 0.0619s/iter; left time: 2796.1209s
	iters: 400, epoch: 4 | loss: 0.3622849
	speed: 0.0658s/iter; left time: 2965.7505s
Epoch: 4 cost time: 29.279722452163696
Epoch: 4, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.934246 --> -0.962263).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0808264
	speed: 0.2773s/iter; left time: 12458.2563s
	iters: 200, epoch: 5 | loss: 0.2128742
	speed: 0.0677s/iter; left time: 3036.2075s
	iters: 300, epoch: 5 | loss: 0.0061210
	speed: 0.0664s/iter; left time: 2970.3202s
	iters: 400, epoch: 5 | loss: 0.0074149
	speed: 0.0657s/iter; left time: 2933.3059s
Epoch: 5 cost time: 31.828713178634644
Epoch: 5, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0144964
	speed: 0.2945s/iter; left time: 13090.2431s
	iters: 200, epoch: 6 | loss: 0.0460809
	speed: 0.0660s/iter; left time: 2926.0968s
	iters: 300, epoch: 6 | loss: 0.0142398
	speed: 0.0664s/iter; left time: 2938.4814s
	iters: 400, epoch: 6 | loss: 0.0436650
	speed: 0.0661s/iter; left time: 2917.1656s
Epoch: 6 cost time: 31.436596870422363
Epoch: 6, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0088290
	speed: 0.2926s/iter; left time: 12869.6305s
	iters: 200, epoch: 7 | loss: 0.1294943
	speed: 0.0594s/iter; left time: 2607.2561s
	iters: 300, epoch: 7 | loss: 0.0034464
	speed: 0.0642s/iter; left time: 2809.9869s
	iters: 400, epoch: 7 | loss: 0.0519632
	speed: 0.0643s/iter; left time: 2808.0227s
Epoch: 7 cost time: 29.896066904067993
Epoch: 7, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0995811
	speed: 0.2754s/iter; left time: 11982.6897s
	iters: 200, epoch: 8 | loss: 0.0844336
	speed: 0.0610s/iter; left time: 2649.5978s
	iters: 300, epoch: 8 | loss: 0.0776913
	speed: 0.0614s/iter; left time: 2659.8563s
	iters: 400, epoch: 8 | loss: 0.0244259
	speed: 0.0595s/iter; left time: 2569.6644s
Epoch: 8 cost time: 29.145480155944824
Epoch: 8, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.217 Vali Acc: 0.945 Test Loss: 0.217 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1809012
	speed: 0.2711s/iter; left time: 11669.1928s
	iters: 200, epoch: 9 | loss: 0.2893181
	speed: 0.0667s/iter; left time: 2863.8119s
	iters: 300, epoch: 9 | loss: 0.0317073
	speed: 0.0631s/iter; left time: 2703.0956s
	iters: 400, epoch: 9 | loss: 0.0216096
	speed: 0.0571s/iter; left time: 2439.7390s
Epoch: 9 cost time: 29.680427312850952
Epoch: 9, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0604373
	speed: 0.2625s/iter; left time: 11176.6568s
	iters: 200, epoch: 10 | loss: 0.1929300
	speed: 0.0668s/iter; left time: 2838.9766s
	iters: 300, epoch: 10 | loss: 0.3656342
	speed: 0.0667s/iter; left time: 2825.6197s
	iters: 400, epoch: 10 | loss: 0.0596301
	speed: 0.0640s/iter; left time: 2705.5555s
Epoch: 10 cost time: 30.99211549758911
Epoch: 10, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0111161
	speed: 0.2738s/iter; left time: 11530.2603s
	iters: 200, epoch: 11 | loss: 0.0192274
	speed: 0.0611s/iter; left time: 2565.5244s
	iters: 300, epoch: 11 | loss: 0.0270875
	speed: 0.0622s/iter; left time: 2608.8077s
	iters: 400, epoch: 11 | loss: 0.0407124
	speed: 0.0593s/iter; left time: 2480.9809s
Epoch: 11 cost time: 29.331129550933838
Epoch: 11, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0360769
	speed: 0.2620s/iter; left time: 10911.1577s
	iters: 200, epoch: 12 | loss: 0.1941412
	speed: 0.0572s/iter; left time: 2374.4915s
	iters: 300, epoch: 12 | loss: 0.0553321
	speed: 0.0610s/iter; left time: 2529.4198s
	iters: 400, epoch: 12 | loss: 0.0176932
	speed: 0.0641s/iter; left time: 2648.1532s
Epoch: 12 cost time: 28.74388098716736
Epoch: 12, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0008796
	speed: 0.2693s/iter; left time: 11086.1597s
	iters: 200, epoch: 13 | loss: 0.2334237
	speed: 0.0668s/iter; left time: 2744.4352s
	iters: 300, epoch: 13 | loss: 0.0346605
	speed: 0.0640s/iter; left time: 2623.6601s
	iters: 400, epoch: 13 | loss: 0.0027854
	speed: 0.0610s/iter; left time: 2494.0335s
Epoch: 13 cost time: 30.184702157974243
Epoch: 13, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0347991
	speed: 0.2712s/iter; left time: 11037.3152s
	iters: 200, epoch: 14 | loss: 0.1748436
	speed: 0.0650s/iter; left time: 2639.6814s
	iters: 300, epoch: 14 | loss: 0.0417583
	speed: 0.0650s/iter; left time: 2631.8872s
	iters: 400, epoch: 14 | loss: 0.0144589
	speed: 0.0686s/iter; left time: 2769.9248s
Epoch: 14 cost time: 31.40214228630066
Epoch: 14, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9622641509433962
model parameter : 2334010
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6711857
	speed: 0.0888s/iter; left time: 4154.3799s
	iters: 200, epoch: 1 | loss: 0.2790945
	speed: 0.0709s/iter; left time: 3309.6926s
	iters: 300, epoch: 1 | loss: 0.2328147
	speed: 0.0658s/iter; left time: 3065.2776s
	iters: 400, epoch: 1 | loss: 0.0959134
	speed: 0.0610s/iter; left time: 2835.0113s
Epoch: 1 cost time: 32.62914776802063
Epoch: 1, Steps: 469 | Train Loss: 0.511 Vali Loss: 0.273 Vali Acc: 0.921 Test Loss: 0.273 Test Acc: 0.921
Validation loss decreased (inf --> -0.921381).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2480793
	speed: 0.2553s/iter; left time: 11827.2019s
	iters: 200, epoch: 2 | loss: 0.3006187
	speed: 0.0639s/iter; left time: 2956.1826s
	iters: 300, epoch: 2 | loss: 0.3388398
	speed: 0.0628s/iter; left time: 2895.6365s
	iters: 400, epoch: 2 | loss: 0.1286310
	speed: 0.0625s/iter; left time: 2874.8771s
Epoch: 2 cost time: 29.810765981674194
Epoch: 2, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.921381 --> -0.921667).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0608154
	speed: 0.2756s/iter; left time: 12640.1319s
	iters: 200, epoch: 3 | loss: 0.0501673
	speed: 0.0641s/iter; left time: 2934.2045s
	iters: 300, epoch: 3 | loss: 0.2698732
	speed: 0.0636s/iter; left time: 2905.2374s
	iters: 400, epoch: 3 | loss: 0.0203593
	speed: 0.0657s/iter; left time: 2993.8767s
Epoch: 3 cost time: 30.936511754989624
Epoch: 3, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.283 Vali Acc: 0.927 Test Loss: 0.283 Test Acc: 0.927
Validation loss decreased (-0.921667 --> -0.927098).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2993230
	speed: 0.2770s/iter; left time: 12572.6431s
	iters: 200, epoch: 4 | loss: 0.0064729
	speed: 0.0583s/iter; left time: 2640.9999s
	iters: 300, epoch: 4 | loss: 0.0489276
	speed: 0.0661s/iter; left time: 2986.9578s
	iters: 400, epoch: 4 | loss: 0.0200200
	speed: 0.0675s/iter; left time: 3042.2504s
Epoch: 4 cost time: 30.303916215896606
Epoch: 4, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.293 Vali Acc: 0.910 Test Loss: 0.293 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1876708
	speed: 0.2791s/iter; left time: 12540.7400s
	iters: 200, epoch: 5 | loss: 0.0927784
	speed: 0.0642s/iter; left time: 2877.4895s
	iters: 300, epoch: 5 | loss: 0.0913596
	speed: 0.0654s/iter; left time: 2924.1262s
	iters: 400, epoch: 5 | loss: 0.2049707
	speed: 0.0627s/iter; left time: 2797.9409s
Epoch: 5 cost time: 31.066253423690796
Epoch: 5, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0022270
	speed: 0.2832s/iter; left time: 12591.1714s
	iters: 200, epoch: 6 | loss: 0.0037554
	speed: 0.0625s/iter; left time: 2773.9728s
	iters: 300, epoch: 6 | loss: 0.0271158
	speed: 0.0602s/iter; left time: 2663.6084s
	iters: 400, epoch: 6 | loss: 0.0169752
	speed: 0.0609s/iter; left time: 2688.0900s
Epoch: 6 cost time: 29.615308046340942
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.213 Vali Acc: 0.940 Test Loss: 0.213 Test Acc: 0.940
Validation loss decreased (-0.927098 --> -0.939964).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7236801
	speed: 0.2674s/iter; left time: 11760.9402s
	iters: 200, epoch: 7 | loss: 0.0209288
	speed: 0.0623s/iter; left time: 2732.2174s
	iters: 300, epoch: 7 | loss: 0.3110369
	speed: 0.0612s/iter; left time: 2679.3233s
	iters: 400, epoch: 7 | loss: 0.0718503
	speed: 0.0565s/iter; left time: 2470.3986s
Epoch: 7 cost time: 28.394742250442505
Epoch: 7, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6064497
	speed: 0.2631s/iter; left time: 11448.8079s
	iters: 200, epoch: 8 | loss: 0.0225641
	speed: 0.0603s/iter; left time: 2619.5718s
	iters: 300, epoch: 8 | loss: 0.1633271
	speed: 0.0662s/iter; left time: 2865.8602s
	iters: 400, epoch: 8 | loss: 0.2142037
	speed: 0.0614s/iter; left time: 2655.4605s
Epoch: 8 cost time: 29.8443021774292
Epoch: 8, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.218 Vali Acc: 0.945 Test Loss: 0.218 Test Acc: 0.945
Validation loss decreased (-0.939964 --> -0.945109).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0096814
	speed: 0.2941s/iter; left time: 12661.9274s
	iters: 200, epoch: 9 | loss: 0.0231628
	speed: 0.0642s/iter; left time: 2758.3663s
	iters: 300, epoch: 9 | loss: 0.0772003
	speed: 0.0633s/iter; left time: 2713.1339s
	iters: 400, epoch: 9 | loss: 0.0046382
	speed: 0.0688s/iter; left time: 2939.2030s
Epoch: 9 cost time: 31.69344210624695
Epoch: 9, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.945109 --> -0.964836).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0435118
	speed: 0.2961s/iter; left time: 12607.7722s
	iters: 200, epoch: 10 | loss: 0.4998299
	speed: 0.0691s/iter; left time: 2935.8370s
	iters: 300, epoch: 10 | loss: 0.1439591
	speed: 0.0652s/iter; left time: 2762.2908s
	iters: 400, epoch: 10 | loss: 0.9462467
	speed: 0.0640s/iter; left time: 2704.9461s
Epoch: 10 cost time: 31.230509519577026
Epoch: 10, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.966551).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0124744
	speed: 0.2874s/iter; left time: 12101.3027s
	iters: 200, epoch: 11 | loss: 0.0582535
	speed: 0.0670s/iter; left time: 2814.7163s
	iters: 300, epoch: 11 | loss: 0.3841553
	speed: 0.0715s/iter; left time: 2996.2918s
	iters: 400, epoch: 11 | loss: 0.0113878
	speed: 0.0640s/iter; left time: 2675.4386s
Epoch: 11 cost time: 31.286014318466187
Epoch: 11, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0104948
	speed: 0.2806s/iter; left time: 11684.8572s
	iters: 200, epoch: 12 | loss: 0.0342326
	speed: 0.0626s/iter; left time: 2602.1126s
	iters: 300, epoch: 12 | loss: 0.3734308
	speed: 0.0602s/iter; left time: 2494.3119s
	iters: 400, epoch: 12 | loss: 0.5520932
	speed: 0.0580s/iter; left time: 2399.5949s
Epoch: 12 cost time: 29.360066175460815
Epoch: 12, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0725298
	speed: 0.2598s/iter; left time: 10696.0221s
	iters: 200, epoch: 13 | loss: 0.0086479
	speed: 0.0651s/iter; left time: 2675.8432s
	iters: 300, epoch: 13 | loss: 0.4412767
	speed: 0.0659s/iter; left time: 2702.1454s
	iters: 400, epoch: 13 | loss: 0.4386152
	speed: 0.0613s/iter; left time: 2506.0572s
Epoch: 13 cost time: 29.991251230239868
Epoch: 13, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0096675
	speed: 0.2689s/iter; left time: 10946.9703s
	iters: 200, epoch: 14 | loss: 0.0219523
	speed: 0.0614s/iter; left time: 2493.6084s
	iters: 300, epoch: 14 | loss: 0.0069123
	speed: 0.0626s/iter; left time: 2537.4722s
	iters: 400, epoch: 14 | loss: 0.1592710
	speed: 0.0668s/iter; left time: 2700.9730s
Epoch: 14 cost time: 30.068966388702393
Epoch: 14, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.920 Test Loss: 0.307 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0063147
	speed: 0.2620s/iter; left time: 10542.4639s
	iters: 200, epoch: 15 | loss: 0.0073733
	speed: 0.0612s/iter; left time: 2457.0337s
	iters: 300, epoch: 15 | loss: 0.1176387
	speed: 0.0605s/iter; left time: 2422.6087s
	iters: 400, epoch: 15 | loss: 0.0131635
	speed: 0.0579s/iter; left time: 2310.6889s
Epoch: 15 cost time: 28.35689926147461
Epoch: 15, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0233271
	speed: 0.2726s/iter; left time: 10839.2788s
	iters: 200, epoch: 16 | loss: 0.0591641
	speed: 0.0621s/iter; left time: 2463.4370s
	iters: 300, epoch: 16 | loss: 0.0316745
	speed: 0.0601s/iter; left time: 2376.1480s
	iters: 400, epoch: 16 | loss: 0.0434874
	speed: 0.0587s/iter; left time: 2316.2556s
Epoch: 16 cost time: 29.38162875175476
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0069610
	speed: 0.2753s/iter; left time: 10818.1068s
	iters: 200, epoch: 17 | loss: 0.0470968
	speed: 0.0586s/iter; left time: 2296.4989s
	iters: 300, epoch: 17 | loss: 0.0469280
	speed: 0.0616s/iter; left time: 2408.2186s
	iters: 400, epoch: 17 | loss: 0.0330859
	speed: 0.0643s/iter; left time: 2506.1434s
Epoch: 17 cost time: 29.437488555908203
Epoch: 17, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0358146
	speed: 0.2737s/iter; left time: 10628.2069s
	iters: 200, epoch: 18 | loss: 0.3074228
	speed: 0.0676s/iter; left time: 2618.8590s
	iters: 300, epoch: 18 | loss: 0.0276378
	speed: 0.0636s/iter; left time: 2457.3821s
	iters: 400, epoch: 18 | loss: 0.0639928
	speed: 0.0627s/iter; left time: 2414.3265s
Epoch: 18 cost time: 30.604655504226685
Epoch: 18, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0020666
	speed: 0.2866s/iter; left time: 10994.0444s
	iters: 200, epoch: 19 | loss: 0.0330007
	speed: 0.0606s/iter; left time: 2319.5089s
	iters: 300, epoch: 19 | loss: 0.2658235
	speed: 0.0652s/iter; left time: 2487.0874s
	iters: 400, epoch: 19 | loss: 0.0091600
	speed: 0.0617s/iter; left time: 2346.8145s
Epoch: 19 cost time: 29.759214878082275
Epoch: 19, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0565133
	speed: 0.2870s/iter; left time: 10872.7560s
	iters: 200, epoch: 20 | loss: 0.4574052
	speed: 0.0645s/iter; left time: 2438.0828s
	iters: 300, epoch: 20 | loss: 0.0301298
	speed: 0.0635s/iter; left time: 2392.9293s
	iters: 400, epoch: 20 | loss: 0.0996206
	speed: 0.0642s/iter; left time: 2413.8735s
Epoch: 20 cost time: 30.64393424987793
Epoch: 20, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9665523156089194
model parameter : 2333626
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5031163
	speed: 0.0721s/iter; left time: 3376.4143s
	iters: 200, epoch: 1 | loss: 0.1819343
	speed: 0.0605s/iter; left time: 2827.0202s
	iters: 300, epoch: 1 | loss: 0.4475187
	speed: 0.0587s/iter; left time: 2735.9632s
	iters: 400, epoch: 1 | loss: 0.1815568
	speed: 0.0599s/iter; left time: 2784.9075s
Epoch: 1 cost time: 29.305697202682495
Epoch: 1, Steps: 469 | Train Loss: 0.504 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (inf --> -0.932816).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0610148
	speed: 0.2702s/iter; left time: 12518.5414s
	iters: 200, epoch: 2 | loss: 0.0622688
	speed: 0.0613s/iter; left time: 2833.1676s
	iters: 300, epoch: 2 | loss: 0.2190864
	speed: 0.0594s/iter; left time: 2742.1130s
	iters: 400, epoch: 2 | loss: 0.4426750
	speed: 0.0609s/iter; left time: 2803.6788s
Epoch: 2 cost time: 29.132941722869873
Epoch: 2, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.248 Vali Acc: 0.923 Test Loss: 0.248 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0110152
	speed: 0.2583s/iter; left time: 11846.8516s
	iters: 200, epoch: 3 | loss: 0.0552659
	speed: 0.0604s/iter; left time: 2762.3964s
	iters: 300, epoch: 3 | loss: 0.0354239
	speed: 0.0631s/iter; left time: 2879.8797s
	iters: 400, epoch: 3 | loss: 0.1648597
	speed: 0.0635s/iter; left time: 2893.0400s
Epoch: 3 cost time: 29.29530429840088
Epoch: 3, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2485833
	speed: 0.2588s/iter; left time: 11749.6905s
	iters: 200, epoch: 4 | loss: 0.0154046
	speed: 0.0662s/iter; left time: 3000.2473s
	iters: 300, epoch: 4 | loss: 0.2551886
	speed: 0.0606s/iter; left time: 2737.8829s
	iters: 400, epoch: 4 | loss: 0.1748711
	speed: 0.0623s/iter; left time: 2807.3759s
Epoch: 4 cost time: 29.559937953948975
Epoch: 4, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.932816 --> -0.949684).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1372288
	speed: 0.2586s/iter; left time: 11619.0948s
	iters: 200, epoch: 5 | loss: 0.0678346
	speed: 0.0570s/iter; left time: 2556.8380s
	iters: 300, epoch: 5 | loss: 0.0772108
	speed: 0.0603s/iter; left time: 2696.2186s
	iters: 400, epoch: 5 | loss: 0.1153418
	speed: 0.0598s/iter; left time: 2668.4227s
Epoch: 5 cost time: 28.321654319763184
Epoch: 5, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.308 Vali Acc: 0.892 Test Loss: 0.308 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2985858
	speed: 0.2803s/iter; left time: 12459.8287s
	iters: 200, epoch: 6 | loss: 0.4496826
	speed: 0.0597s/iter; left time: 2649.1234s
	iters: 300, epoch: 6 | loss: 0.0097972
	speed: 0.0598s/iter; left time: 2647.6233s
	iters: 400, epoch: 6 | loss: 0.0169079
	speed: 0.0614s/iter; left time: 2712.5249s
Epoch: 6 cost time: 29.245768547058105
Epoch: 6, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.258 Vali Acc: 0.939 Test Loss: 0.258 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4748059
	speed: 0.2852s/iter; left time: 12544.4034s
	iters: 200, epoch: 7 | loss: 0.0145518
	speed: 0.0673s/iter; left time: 2951.4976s
	iters: 300, epoch: 7 | loss: 0.0960095
	speed: 0.0682s/iter; left time: 2986.4038s
	iters: 400, epoch: 7 | loss: 0.0099171
	speed: 0.0657s/iter; left time: 2872.2666s
Epoch: 7 cost time: 30.977487087249756
Epoch: 7, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.333 Vali Acc: 0.915 Test Loss: 0.333 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0176002
	speed: 0.2824s/iter; left time: 12287.4406s
	iters: 200, epoch: 8 | loss: 0.0069812
	speed: 0.0666s/iter; left time: 2889.6413s
	iters: 300, epoch: 8 | loss: 0.1305030
	speed: 0.0667s/iter; left time: 2889.9650s
	iters: 400, epoch: 8 | loss: 0.1226076
	speed: 0.0618s/iter; left time: 2672.8181s
Epoch: 8 cost time: 31.15904402732849
Epoch: 8, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0124564
	speed: 0.2681s/iter; left time: 11541.3180s
	iters: 200, epoch: 9 | loss: 0.0155107
	speed: 0.0649s/iter; left time: 2787.3699s
	iters: 300, epoch: 9 | loss: 0.0524441
	speed: 0.0698s/iter; left time: 2991.8464s
	iters: 400, epoch: 9 | loss: 0.4086074
	speed: 0.0730s/iter; left time: 3120.6763s
Epoch: 9 cost time: 33.54452896118164
Epoch: 9, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.949684 --> -0.957689).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2758557
	speed: 0.3288s/iter; left time: 14002.3590s
	iters: 200, epoch: 10 | loss: 0.0050612
	speed: 0.0733s/iter; left time: 3114.4690s
	iters: 300, epoch: 10 | loss: 0.4531812
	speed: 0.0767s/iter; left time: 3250.3942s
	iters: 400, epoch: 10 | loss: 0.5871143
	speed: 0.0788s/iter; left time: 3331.3618s
Epoch: 10 cost time: 36.20777130126953
Epoch: 10, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0647623
	speed: 0.3352s/iter; left time: 14114.6183s
	iters: 200, epoch: 11 | loss: 0.0057579
	speed: 0.0750s/iter; left time: 3152.0306s
	iters: 300, epoch: 11 | loss: 0.0257040
	speed: 0.0709s/iter; left time: 2970.1683s
	iters: 400, epoch: 11 | loss: 0.1058428
	speed: 0.0746s/iter; left time: 3117.3754s
Epoch: 11 cost time: 36.02204966545105
Epoch: 11, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0057091
	speed: 0.3275s/iter; left time: 13635.8476s
	iters: 200, epoch: 12 | loss: 0.2999766
	speed: 0.0678s/iter; left time: 2815.9716s
	iters: 300, epoch: 12 | loss: 0.0260140
	speed: 0.0702s/iter; left time: 2907.6367s
	iters: 400, epoch: 12 | loss: 0.0064267
	speed: 0.0702s/iter; left time: 2902.8331s
Epoch: 12 cost time: 33.053937911987305
Epoch: 12, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.957689 --> -0.959118).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0854514
	speed: 0.3052s/iter; left time: 12567.0132s
	iters: 200, epoch: 13 | loss: 0.0100142
	speed: 0.0714s/iter; left time: 2933.4474s
	iters: 300, epoch: 13 | loss: 0.2431497
	speed: 0.0776s/iter; left time: 3179.8308s
	iters: 400, epoch: 13 | loss: 0.4372611
	speed: 0.0733s/iter; left time: 2997.0709s
Epoch: 13 cost time: 34.85893988609314
Epoch: 13, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2925628
	speed: 0.3200s/iter; left time: 13023.4171s
	iters: 200, epoch: 14 | loss: 0.0243881
	speed: 0.0725s/iter; left time: 2942.4878s
	iters: 300, epoch: 14 | loss: 0.0151918
	speed: 0.0803s/iter; left time: 3251.8602s
	iters: 400, epoch: 14 | loss: 0.0077194
	speed: 0.0765s/iter; left time: 3091.7462s
Epoch: 14 cost time: 35.59303545951843
Epoch: 14, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0145827
	speed: 0.3415s/iter; left time: 13741.4122s
	iters: 200, epoch: 15 | loss: 0.0030799
	speed: 0.0800s/iter; left time: 3208.9236s
	iters: 300, epoch: 15 | loss: 0.0093262
	speed: 0.0767s/iter; left time: 3069.1003s
	iters: 400, epoch: 15 | loss: 0.2168407
	speed: 0.0812s/iter; left time: 3243.7943s
Epoch: 15 cost time: 37.80574822425842
Epoch: 15, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.257 Vali Acc: 0.940 Test Loss: 0.257 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2492048
	speed: 0.3479s/iter; left time: 13836.1800s
	iters: 200, epoch: 16 | loss: 0.0156513
	speed: 0.0812s/iter; left time: 3219.4056s
	iters: 300, epoch: 16 | loss: 0.0081775
	speed: 0.0757s/iter; left time: 2994.5246s
	iters: 400, epoch: 16 | loss: 0.0039649
	speed: 0.0752s/iter; left time: 2966.9402s
Epoch: 16 cost time: 35.948508739471436
Epoch: 16, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0074299
	speed: 0.3157s/iter; left time: 12406.1993s
	iters: 200, epoch: 17 | loss: 0.0950687
	speed: 0.0799s/iter; left time: 3132.6483s
	iters: 300, epoch: 17 | loss: 0.0014809
	speed: 0.0740s/iter; left time: 2893.6772s
	iters: 400, epoch: 17 | loss: 0.2737730
	speed: 0.0752s/iter; left time: 2933.7313s
Epoch: 17 cost time: 35.90233874320984
Epoch: 17, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0096117
	speed: 0.3281s/iter; left time: 12739.8634s
	iters: 200, epoch: 18 | loss: 0.0059273
	speed: 0.0735s/iter; left time: 2847.8194s
	iters: 300, epoch: 18 | loss: 0.2307186
	speed: 0.0727s/iter; left time: 2808.7903s
	iters: 400, epoch: 18 | loss: 0.0354764
	speed: 0.0744s/iter; left time: 2866.9364s
Epoch: 18 cost time: 34.820130348205566
Epoch: 18, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.261 Vali Acc: 0.938 Test Loss: 0.261 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0057667
	speed: 0.3022s/iter; left time: 11591.4495s
	iters: 200, epoch: 19 | loss: 0.0251115
	speed: 0.0799s/iter; left time: 3055.0371s
	iters: 300, epoch: 19 | loss: 0.0419636
	speed: 0.0701s/iter; left time: 2674.7054s
	iters: 400, epoch: 19 | loss: 0.0022555
	speed: 0.0692s/iter; left time: 2632.2050s
Epoch: 19 cost time: 34.20355010032654
Epoch: 19, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0110202
	speed: 0.2909s/iter; left time: 11020.7523s
	iters: 200, epoch: 20 | loss: 0.0027462
	speed: 0.0718s/iter; left time: 2713.2702s
	iters: 300, epoch: 20 | loss: 0.1449261
	speed: 0.0709s/iter; left time: 2671.6319s
	iters: 400, epoch: 20 | loss: 0.0047838
	speed: 0.0690s/iter; left time: 2593.8809s
Epoch: 20 cost time: 32.920841455459595
Epoch: 20, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0104213
	speed: 0.2858s/iter; left time: 10695.3684s
	iters: 200, epoch: 21 | loss: 0.0006908
	speed: 0.0761s/iter; left time: 2841.9164s
	iters: 300, epoch: 21 | loss: 0.0186198
	speed: 0.0715s/iter; left time: 2660.5753s
	iters: 400, epoch: 21 | loss: 0.0039836
	speed: 0.0685s/iter; left time: 2542.3724s
Epoch: 21 cost time: 35.046241760253906
Epoch: 21, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0139773
	speed: 0.3046s/iter; left time: 11257.0185s
	iters: 200, epoch: 22 | loss: 0.2673203
	speed: 0.0720s/iter; left time: 2654.4800s
	iters: 300, epoch: 22 | loss: 0.1721296
	speed: 0.0717s/iter; left time: 2634.0914s
	iters: 400, epoch: 22 | loss: 0.0138878
	speed: 0.0712s/iter; left time: 2609.0933s
Epoch: 22 cost time: 34.2373743057251
Epoch: 22, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
Validation loss decreased (-0.959118 --> -0.961690).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0990491
	speed: 0.3100s/iter; left time: 11308.4595s
	iters: 200, epoch: 23 | loss: 0.0482459
	speed: 0.0789s/iter; left time: 2869.6278s
	iters: 300, epoch: 23 | loss: 0.2668557
	speed: 0.0751s/iter; left time: 2726.5045s
	iters: 400, epoch: 23 | loss: 0.0434577
	speed: 0.0740s/iter; left time: 2675.8949s
Epoch: 23 cost time: 35.229180574417114
Epoch: 23, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.223 Vali Acc: 0.953 Test Loss: 0.223 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0020170
	speed: 0.3139s/iter; left time: 11306.2553s
	iters: 200, epoch: 24 | loss: 0.0048540
	speed: 0.0680s/iter; left time: 2442.4963s
	iters: 300, epoch: 24 | loss: 0.0411115
	speed: 0.0679s/iter; left time: 2433.0567s
	iters: 400, epoch: 24 | loss: 0.0043547
	speed: 0.0719s/iter; left time: 2568.5396s
Epoch: 24 cost time: 33.82142090797424
Epoch: 24, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.961690 --> -0.965407).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0563287
	speed: 0.3126s/iter; left time: 11111.0208s
	iters: 200, epoch: 25 | loss: 0.2122632
	speed: 0.0756s/iter; left time: 2679.1242s
	iters: 300, epoch: 25 | loss: 0.3971707
	speed: 0.0783s/iter; left time: 2769.2033s
	iters: 400, epoch: 25 | loss: 0.0113567
	speed: 0.0768s/iter; left time: 2708.5391s
Epoch: 25 cost time: 36.1365065574646
Epoch: 25, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.304 Vali Acc: 0.945 Test Loss: 0.304 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1107219
	speed: 0.3212s/iter; left time: 11264.8646s
	iters: 200, epoch: 26 | loss: 0.0279030
	speed: 0.0687s/iter; left time: 2403.8133s
	iters: 300, epoch: 26 | loss: 0.4107166
	speed: 0.0678s/iter; left time: 2365.3420s
	iters: 400, epoch: 26 | loss: 0.0068883
	speed: 0.0735s/iter; left time: 2557.5589s
Epoch: 26 cost time: 33.36026334762573
Epoch: 26, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.5397072
	speed: 0.3079s/iter; left time: 10654.0555s
	iters: 200, epoch: 27 | loss: 0.0362493
	speed: 0.0729s/iter; left time: 2516.9823s
	iters: 300, epoch: 27 | loss: 0.1352435
	speed: 0.0735s/iter; left time: 2527.7028s
	iters: 400, epoch: 27 | loss: 0.0042996
	speed: 0.0675s/iter; left time: 2316.2641s
Epoch: 27 cost time: 34.412612199783325
Epoch: 27, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0172946
	speed: 0.3121s/iter; left time: 10655.8540s
	iters: 200, epoch: 28 | loss: 0.1318005
	speed: 0.0753s/iter; left time: 2563.0337s
	iters: 300, epoch: 28 | loss: 0.2635648
	speed: 0.0824s/iter; left time: 2796.0268s
	iters: 400, epoch: 28 | loss: 0.0120422
	speed: 0.0770s/iter; left time: 2606.8779s
Epoch: 28 cost time: 36.22937822341919
Epoch: 28, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0117215
	speed: 0.3311s/iter; left time: 11146.4640s
	iters: 200, epoch: 29 | loss: 0.0731110
	speed: 0.0701s/iter; left time: 2351.8085s
	iters: 300, epoch: 29 | loss: 0.0066314
	speed: 0.0747s/iter; left time: 2498.9874s
	iters: 400, epoch: 29 | loss: 0.0273382
	speed: 0.0781s/iter; left time: 2607.7865s
Epoch: 29 cost time: 36.18427348136902
Epoch: 29, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0081124
	speed: 0.3267s/iter; left time: 10847.3872s
	iters: 200, epoch: 30 | loss: 0.0030958
	speed: 0.0734s/iter; left time: 2429.0977s
	iters: 300, epoch: 30 | loss: 0.0062840
	speed: 0.0731s/iter; left time: 2413.4426s
	iters: 400, epoch: 30 | loss: 0.1279982
	speed: 0.0687s/iter; left time: 2258.7733s
Epoch: 30 cost time: 33.80166482925415
Epoch: 30, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0553915
	speed: 0.2907s/iter; left time: 9513.9579s
	iters: 200, epoch: 31 | loss: 0.0011197
	speed: 0.0691s/iter; left time: 2253.4689s
	iters: 300, epoch: 31 | loss: 0.0013230
	speed: 0.0695s/iter; left time: 2259.8367s
	iters: 400, epoch: 31 | loss: 0.0554769
	speed: 0.0681s/iter; left time: 2208.9545s
Epoch: 31 cost time: 32.73836374282837
Epoch: 31, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
Validation loss decreased (-0.965407 --> -0.965693).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0018650
	speed: 0.3115s/iter; left time: 10048.4642s
	iters: 200, epoch: 32 | loss: 0.0259333
	speed: 0.0722s/iter; left time: 2322.1867s
	iters: 300, epoch: 32 | loss: 0.0037902
	speed: 0.0582s/iter; left time: 1864.7502s
	iters: 400, epoch: 32 | loss: 0.0056646
	speed: 0.0581s/iter; left time: 1857.9916s
Epoch: 32 cost time: 30.683715105056763
Epoch: 32, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0190414
	speed: 0.2539s/iter; left time: 8070.9431s
	iters: 200, epoch: 33 | loss: 0.0431334
	speed: 0.0616s/iter; left time: 1950.9695s
	iters: 300, epoch: 33 | loss: 0.0017341
	speed: 0.0594s/iter; left time: 1877.8647s
	iters: 400, epoch: 33 | loss: 0.0025888
	speed: 0.0574s/iter; left time: 1806.8952s
Epoch: 33 cost time: 28.95406198501587
Epoch: 33, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0007009
	speed: 0.2607s/iter; left time: 8166.6067s
	iters: 200, epoch: 34 | loss: 0.0027771
	speed: 0.0582s/iter; left time: 1817.8153s
	iters: 300, epoch: 34 | loss: 0.0576961
	speed: 0.0676s/iter; left time: 2105.3832s
	iters: 400, epoch: 34 | loss: 0.0130303
	speed: 0.0648s/iter; left time: 2009.4132s
Epoch: 34 cost time: 28.95279622077942
Epoch: 34, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.223 Vali Acc: 0.955 Test Loss: 0.223 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0440254
	speed: 0.2151s/iter; left time: 6637.6689s
	iters: 200, epoch: 35 | loss: 0.0259257
	speed: 0.0531s/iter; left time: 1633.2575s
	iters: 300, epoch: 35 | loss: 0.0015822
	speed: 0.0589s/iter; left time: 1806.6180s
	iters: 400, epoch: 35 | loss: 0.0456990
	speed: 0.0653s/iter; left time: 1994.7753s
Epoch: 35 cost time: 28.00057363510132
Epoch: 35, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0041706
	speed: 0.3266s/iter; left time: 9924.2694s
	iters: 200, epoch: 36 | loss: 0.0604369
	speed: 0.0847s/iter; left time: 2565.6996s
	iters: 300, epoch: 36 | loss: 0.0038974
	speed: 0.0942s/iter; left time: 2843.6678s
	iters: 400, epoch: 36 | loss: 0.0013868
	speed: 0.0893s/iter; left time: 2685.2426s
Epoch: 36 cost time: 41.952101945877075
Epoch: 36, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0034155
	speed: 0.4138s/iter; left time: 12379.7708s
	iters: 200, epoch: 37 | loss: 0.0150881
	speed: 0.1002s/iter; left time: 2988.8489s
	iters: 300, epoch: 37 | loss: 0.0557870
	speed: 0.0977s/iter; left time: 2903.1504s
	iters: 400, epoch: 37 | loss: 0.0010557
	speed: 0.0859s/iter; left time: 2544.8149s
Epoch: 37 cost time: 43.99187469482422
Epoch: 37, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0397387
	speed: 0.4415s/iter; left time: 13001.1989s
	iters: 200, epoch: 38 | loss: 0.0206977
	speed: 0.0965s/iter; left time: 2831.8474s
	iters: 300, epoch: 38 | loss: 0.1323461
	speed: 0.1012s/iter; left time: 2959.5970s
	iters: 400, epoch: 38 | loss: 0.0188934
	speed: 0.1151s/iter; left time: 3355.8701s
Epoch: 38 cost time: 48.720165967941284
Epoch: 38, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.239 Vali Acc: 0.960 Test Loss: 0.239 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0044652
	speed: 0.4378s/iter; left time: 12686.8236s
	iters: 200, epoch: 39 | loss: 0.0044700
	speed: 0.1066s/iter; left time: 3077.9000s
	iters: 300, epoch: 39 | loss: 0.0109953
	speed: 0.0810s/iter; left time: 2331.5087s
	iters: 400, epoch: 39 | loss: 0.0405447
	speed: 0.0791s/iter; left time: 2267.9738s
Epoch: 39 cost time: 44.24609422683716
Epoch: 39, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.963 Test Loss: 0.234 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0437215
	speed: 0.3928s/iter; left time: 11197.4808s
	iters: 200, epoch: 40 | loss: 0.0288088
	speed: 0.0946s/iter; left time: 2687.7895s
	iters: 300, epoch: 40 | loss: 0.0013502
	speed: 0.0951s/iter; left time: 2691.1294s
	iters: 400, epoch: 40 | loss: 0.0021059
	speed: 0.1022s/iter; left time: 2882.5111s
Epoch: 40 cost time: 45.081671476364136
Epoch: 40, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.283 Vali Acc: 0.939 Test Loss: 0.283 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0118208
	speed: 0.4036s/iter; left time: 11318.6421s
	iters: 200, epoch: 41 | loss: 0.0917337
	speed: 0.0995s/iter; left time: 2778.9359s
	iters: 300, epoch: 41 | loss: 0.0625247
	speed: 0.1000s/iter; left time: 2784.5603s
	iters: 400, epoch: 41 | loss: 0.0004944
	speed: 0.1009s/iter; left time: 2800.4235s
Epoch: 41 cost time: 47.26066279411316
Epoch: 41, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9656946826758147
model parameter : 2333242
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4554359
	speed: 0.1381s/iter; left time: 6461.5576s
	iters: 200, epoch: 1 | loss: 0.3325056
	speed: 0.1119s/iter; left time: 5227.8609s
	iters: 300, epoch: 1 | loss: 0.0831397
	speed: 0.1320s/iter; left time: 6150.8879s
	iters: 400, epoch: 1 | loss: 0.0309235
	speed: 0.1060s/iter; left time: 4929.7510s
Epoch: 1 cost time: 55.76044058799744
Epoch: 1, Steps: 469 | Train Loss: 0.517 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
Validation loss decreased (inf --> -0.930243).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1791456
	speed: 0.4841s/iter; left time: 22427.3203s
	iters: 200, epoch: 2 | loss: 0.1530089
	speed: 0.0989s/iter; left time: 4574.5996s
	iters: 300, epoch: 2 | loss: 0.0693083
	speed: 0.1024s/iter; left time: 4721.9789s
	iters: 400, epoch: 2 | loss: 0.0466134
	speed: 0.1221s/iter; left time: 5621.4261s
Epoch: 2 cost time: 51.68992757797241
Epoch: 2, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.263 Vali Acc: 0.929 Test Loss: 0.263 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0430783
	speed: 0.4924s/iter; left time: 22581.0648s
	iters: 200, epoch: 3 | loss: 0.0149053
	speed: 0.1352s/iter; left time: 6188.3547s
	iters: 300, epoch: 3 | loss: 0.0791149
	speed: 0.1194s/iter; left time: 5452.9763s
	iters: 400, epoch: 3 | loss: 0.2557308
	speed: 0.1128s/iter; left time: 5138.0861s
Epoch: 3 cost time: 54.7309136390686
Epoch: 3, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
Validation loss decreased (-0.930243 --> -0.945967).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0223484
	speed: 0.4888s/iter; left time: 22188.1548s
	iters: 200, epoch: 4 | loss: 0.0129832
	speed: 0.0999s/iter; left time: 4525.5128s
	iters: 300, epoch: 4 | loss: 0.0049643
	speed: 0.0954s/iter; left time: 4311.0175s
	iters: 400, epoch: 4 | loss: 0.0064522
	speed: 0.0991s/iter; left time: 4467.9808s
Epoch: 4 cost time: 47.68186020851135
Epoch: 4, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.945967 --> -0.965408).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2959749
	speed: 0.4447s/iter; left time: 19976.1582s
	iters: 200, epoch: 5 | loss: 0.2112344
	speed: 0.0958s/iter; left time: 4292.6444s
	iters: 300, epoch: 5 | loss: 0.0221160
	speed: 0.0890s/iter; left time: 3979.3324s
	iters: 400, epoch: 5 | loss: 0.2460255
	speed: 0.0876s/iter; left time: 3907.3771s
Epoch: 5 cost time: 45.953750133514404
Epoch: 5, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0491123
	speed: 0.4378s/iter; left time: 19461.6019s
	iters: 200, epoch: 6 | loss: 0.0739869
	speed: 0.1056s/iter; left time: 4684.5706s
	iters: 300, epoch: 6 | loss: 0.0354902
	speed: 0.1010s/iter; left time: 4470.1091s
	iters: 400, epoch: 6 | loss: 0.0199802
	speed: 0.1055s/iter; left time: 4658.2049s
Epoch: 6 cost time: 49.277870178222656
Epoch: 6, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3454373
	speed: 0.5166s/iter; left time: 22722.1615s
	iters: 200, epoch: 7 | loss: 0.0301484
	speed: 0.1197s/iter; left time: 5255.2821s
	iters: 300, epoch: 7 | loss: 0.0233162
	speed: 0.1262s/iter; left time: 5527.2222s
	iters: 400, epoch: 7 | loss: 0.1402426
	speed: 0.1226s/iter; left time: 5357.3376s
Epoch: 7 cost time: 56.61823916435242
Epoch: 7, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.316 Vali Acc: 0.924 Test Loss: 0.316 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0429684
	speed: 0.4172s/iter; left time: 18154.1443s
	iters: 200, epoch: 8 | loss: 0.0830769
	speed: 0.1142s/iter; left time: 4956.9746s
	iters: 300, epoch: 8 | loss: 0.0522425
	speed: 0.0963s/iter; left time: 4172.1129s
	iters: 400, epoch: 8 | loss: 0.0970365
	speed: 0.1087s/iter; left time: 4698.9534s
Epoch: 8 cost time: 49.18371391296387
Epoch: 8, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0223205
	speed: 0.5100s/iter; left time: 21952.8766s
	iters: 200, epoch: 9 | loss: 0.2815678
	speed: 0.1126s/iter; left time: 4835.7536s
	iters: 300, epoch: 9 | loss: 0.2435450
	speed: 0.1153s/iter; left time: 4941.9590s
	iters: 400, epoch: 9 | loss: 0.1163588
	speed: 0.1362s/iter; left time: 5821.5330s
Epoch: 9 cost time: 59.84023594856262
Epoch: 9, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.308 Vali Acc: 0.912 Test Loss: 0.308 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0197374
	speed: 0.5703s/iter; left time: 24284.4251s
	iters: 200, epoch: 10 | loss: 0.0101345
	speed: 0.1240s/iter; left time: 5265.8267s
	iters: 300, epoch: 10 | loss: 0.1607562
	speed: 0.1273s/iter; left time: 5396.2674s
	iters: 400, epoch: 10 | loss: 0.0699202
	speed: 0.1394s/iter; left time: 5894.5059s
Epoch: 10 cost time: 62.047770261764526
Epoch: 10, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0125721
	speed: 0.4555s/iter; left time: 19182.3737s
	iters: 200, epoch: 11 | loss: 0.0208787
	speed: 0.1001s/iter; left time: 4204.8778s
	iters: 300, epoch: 11 | loss: 0.1209183
	speed: 0.0936s/iter; left time: 3920.9183s
	iters: 400, epoch: 11 | loss: 0.0066573
	speed: 0.1321s/iter; left time: 5525.0172s
Epoch: 11 cost time: 52.024516344070435
Epoch: 11, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0835043
	speed: 0.4904s/iter; left time: 20422.6773s
	iters: 200, epoch: 12 | loss: 0.0211236
	speed: 0.1240s/iter; left time: 5152.6423s
	iters: 300, epoch: 12 | loss: 0.0056713
	speed: 0.1530s/iter; left time: 6341.3399s
	iters: 400, epoch: 12 | loss: 0.2189209
	speed: 0.1348s/iter; left time: 5574.8815s
Epoch: 12 cost time: 62.14586424827576
Epoch: 12, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0322419
	speed: 0.5207s/iter; left time: 21440.5518s
	iters: 200, epoch: 13 | loss: 0.0137614
	speed: 0.1127s/iter; left time: 4629.4928s
	iters: 300, epoch: 13 | loss: 0.1149656
	speed: 0.0996s/iter; left time: 4079.2984s
	iters: 400, epoch: 13 | loss: 0.0246224
	speed: 0.0903s/iter; left time: 3690.8002s
Epoch: 13 cost time: 50.01815056800842
Epoch: 13, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0477767
	speed: 0.4484s/iter; left time: 18251.1623s
	iters: 200, epoch: 14 | loss: 0.0272482
	speed: 0.0875s/iter; left time: 3553.7125s
	iters: 300, epoch: 14 | loss: 0.0032720
	speed: 0.0972s/iter; left time: 3938.6203s
	iters: 400, epoch: 14 | loss: 0.0160164
	speed: 0.1001s/iter; left time: 4044.9724s
Epoch: 14 cost time: 46.59681057929993
Epoch: 14, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.317 Vali Acc: 0.932 Test Loss: 0.317 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9654088050314465
model parameter : 2332858
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4585423
	speed: 0.1419s/iter; left time: 6641.7190s
	iters: 200, epoch: 1 | loss: 0.5235163
	speed: 0.1155s/iter; left time: 5393.0474s
	iters: 300, epoch: 1 | loss: 0.2505157
	speed: 0.1054s/iter; left time: 4912.4543s
	iters: 400, epoch: 1 | loss: 0.2382580
	speed: 0.0895s/iter; left time: 4161.9665s
Epoch: 1 cost time: 52.0980122089386
Epoch: 1, Steps: 469 | Train Loss: 0.530 Vali Loss: 0.346 Vali Acc: 0.879 Test Loss: 0.346 Test Acc: 0.879
Validation loss decreased (inf --> -0.879070).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0562318
	speed: 0.4874s/iter; left time: 22582.4499s
	iters: 200, epoch: 2 | loss: 0.6837534
	speed: 0.1295s/iter; left time: 5985.6496s
	iters: 300, epoch: 2 | loss: 0.0628449
	speed: 0.1163s/iter; left time: 5367.0616s
	iters: 400, epoch: 2 | loss: 0.1697644
	speed: 0.1187s/iter; left time: 5462.2131s
Epoch: 2 cost time: 55.69371461868286
Epoch: 2, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.242 Vali Acc: 0.923 Test Loss: 0.242 Test Acc: 0.923
Validation loss decreased (-0.879070 --> -0.922811).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2770292
	speed: 0.5242s/iter; left time: 24039.1067s
	iters: 200, epoch: 3 | loss: 0.0131463
	speed: 0.1097s/iter; left time: 5019.8199s
	iters: 300, epoch: 3 | loss: 0.0893931
	speed: 0.0943s/iter; left time: 4305.5542s
	iters: 400, epoch: 3 | loss: 0.0089581
	speed: 0.1162s/iter; left time: 5293.7919s
Epoch: 3 cost time: 55.051881313323975
Epoch: 3, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.264 Vali Acc: 0.940 Test Loss: 0.264 Test Acc: 0.940
Validation loss decreased (-0.922811 --> -0.939963).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0137391
	speed: 0.5119s/iter; left time: 23239.2609s
	iters: 200, epoch: 4 | loss: 0.4043523
	speed: 0.1256s/iter; left time: 5688.5961s
	iters: 300, epoch: 4 | loss: 0.0347077
	speed: 0.1120s/iter; left time: 5060.2087s
	iters: 400, epoch: 4 | loss: 0.1268713
	speed: 0.1310s/iter; left time: 5906.3238s
Epoch: 4 cost time: 57.17617130279541
Epoch: 4, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.939963 --> -0.940821).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0278446
	speed: 0.5164s/iter; left time: 23199.1866s
	iters: 200, epoch: 5 | loss: 0.5067101
	speed: 0.1223s/iter; left time: 5480.8440s
	iters: 300, epoch: 5 | loss: 0.0444653
	speed: 0.1221s/iter; left time: 5462.0935s
	iters: 400, epoch: 5 | loss: 0.2356092
	speed: 0.1154s/iter; left time: 5148.4279s
Epoch: 5 cost time: 57.92408013343811
Epoch: 5, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.940821 --> -0.949112).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0268164
	speed: 0.5371s/iter; left time: 23878.4622s
	iters: 200, epoch: 6 | loss: 0.1349557
	speed: 0.1170s/iter; left time: 5190.8181s
	iters: 300, epoch: 6 | loss: 0.2975315
	speed: 0.1135s/iter; left time: 5021.9025s
	iters: 400, epoch: 6 | loss: 0.0431231
	speed: 0.0979s/iter; left time: 4322.9900s
Epoch: 6 cost time: 52.68188691139221
Epoch: 6, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.211 Vali Acc: 0.940 Test Loss: 0.211 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0365739
	speed: 0.4484s/iter; left time: 19723.4831s
	iters: 200, epoch: 7 | loss: 0.1062052
	speed: 0.0939s/iter; left time: 4122.5941s
	iters: 300, epoch: 7 | loss: 0.0347553
	speed: 0.1016s/iter; left time: 4446.9814s
	iters: 400, epoch: 7 | loss: 0.0114151
	speed: 0.1079s/iter; left time: 4712.1995s
Epoch: 7 cost time: 48.40601134300232
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0179072
	speed: 0.4453s/iter; left time: 19378.4683s
	iters: 200, epoch: 8 | loss: 0.1636094
	speed: 0.1008s/iter; left time: 4375.3148s
	iters: 300, epoch: 8 | loss: 0.0164415
	speed: 0.1171s/iter; left time: 5070.7186s
	iters: 400, epoch: 8 | loss: 0.1428363
	speed: 0.0911s/iter; left time: 3937.6721s
Epoch: 8 cost time: 49.66117763519287
Epoch: 8, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1264174
	speed: 0.5011s/iter; left time: 21573.0631s
	iters: 200, epoch: 9 | loss: 0.0019035
	speed: 0.0880s/iter; left time: 3780.2459s
	iters: 300, epoch: 9 | loss: 0.0293966
	speed: 0.0912s/iter; left time: 3906.4702s
	iters: 400, epoch: 9 | loss: 0.0825262
	speed: 0.0963s/iter; left time: 4117.0195s
Epoch: 9 cost time: 44.09223771095276
Epoch: 9, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.282 Vali Acc: 0.927 Test Loss: 0.282 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0195284
	speed: 0.4372s/iter; left time: 18616.1494s
	iters: 200, epoch: 10 | loss: 0.0340747
	speed: 0.0795s/iter; left time: 3379.0571s
	iters: 300, epoch: 10 | loss: 0.1333147
	speed: 0.0884s/iter; left time: 3746.3036s
	iters: 400, epoch: 10 | loss: 0.3108709
	speed: 0.1052s/iter; left time: 4447.1032s
Epoch: 10 cost time: 43.72784781455994
Epoch: 10, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0763146
	speed: 0.4452s/iter; left time: 18747.3938s
	iters: 200, epoch: 11 | loss: 0.0372204
	speed: 0.1052s/iter; left time: 4420.9246s
	iters: 300, epoch: 11 | loss: 0.0093651
	speed: 0.0919s/iter; left time: 3850.9054s
	iters: 400, epoch: 11 | loss: 0.0097647
	speed: 0.0957s/iter; left time: 3999.5132s
Epoch: 11 cost time: 46.3921480178833
Epoch: 11, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2855718
	speed: 0.5136s/iter; left time: 21386.0085s
	iters: 200, epoch: 12 | loss: 0.0129138
	speed: 0.1096s/iter; left time: 4553.0271s
	iters: 300, epoch: 12 | loss: 0.0850697
	speed: 0.1108s/iter; left time: 4592.8641s
	iters: 400, epoch: 12 | loss: 0.0762069
	speed: 0.1072s/iter; left time: 4430.5303s
Epoch: 12 cost time: 51.827998638153076
Epoch: 12, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.179 Vali Acc: 0.945 Test Loss: 0.179 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0054033
	speed: 0.5118s/iter; left time: 21073.6885s
	iters: 200, epoch: 13 | loss: 0.0279242
	speed: 0.1032s/iter; left time: 4238.4043s
	iters: 300, epoch: 13 | loss: 0.0787210
	speed: 0.1162s/iter; left time: 4762.5535s
	iters: 400, epoch: 13 | loss: 0.1547160
	speed: 0.1329s/iter; left time: 5430.3791s
Epoch: 13 cost time: 54.52813768386841
Epoch: 13, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0818102
	speed: 0.5531s/iter; left time: 22511.3635s
	iters: 200, epoch: 14 | loss: 0.0289568
	speed: 0.1322s/iter; left time: 5369.5437s
	iters: 300, epoch: 14 | loss: 0.0813114
	speed: 0.1141s/iter; left time: 4619.5892s
	iters: 400, epoch: 14 | loss: 0.1962193
	speed: 0.1299s/iter; left time: 5247.3264s
Epoch: 14 cost time: 58.51844358444214
Epoch: 14, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.949112 --> -0.961691).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0196363
	speed: 0.5417s/iter; left time: 21795.3548s
	iters: 200, epoch: 15 | loss: 0.0101927
	speed: 0.1108s/iter; left time: 4445.5980s
	iters: 300, epoch: 15 | loss: 0.0141275
	speed: 0.1234s/iter; left time: 4939.2318s
	iters: 400, epoch: 15 | loss: 0.0947113
	speed: 0.1156s/iter; left time: 4614.5017s
Epoch: 15 cost time: 56.70169758796692
Epoch: 15, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0326223
	speed: 0.5031s/iter; left time: 20006.6904s
	iters: 200, epoch: 16 | loss: 0.0694652
	speed: 0.1385s/iter; left time: 5495.4072s
	iters: 300, epoch: 16 | loss: 0.0131939
	speed: 0.1043s/iter; left time: 4128.3516s
	iters: 400, epoch: 16 | loss: 0.0114292
	speed: 0.1013s/iter; left time: 3999.2304s
Epoch: 16 cost time: 54.381386518478394
Epoch: 16, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0594014
	speed: 0.5109s/iter; left time: 20078.2993s
	iters: 200, epoch: 17 | loss: 0.0174024
	speed: 0.1207s/iter; left time: 4732.1021s
	iters: 300, epoch: 17 | loss: 0.0129032
	speed: 0.1226s/iter; left time: 4791.6093s
	iters: 400, epoch: 17 | loss: 0.0025171
	speed: 0.1202s/iter; left time: 4687.5708s
Epoch: 17 cost time: 58.73332381248474
Epoch: 17, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0319072
	speed: 0.5902s/iter; left time: 22917.3991s
	iters: 200, epoch: 18 | loss: 0.0919537
	speed: 0.1277s/iter; left time: 4944.5609s
	iters: 300, epoch: 18 | loss: 0.0228051
	speed: 0.1345s/iter; left time: 5193.8255s
	iters: 400, epoch: 18 | loss: 0.0315549
	speed: 0.1111s/iter; left time: 4281.5477s
Epoch: 18 cost time: 59.34338426589966
Epoch: 18, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.225 Vali Acc: 0.952 Test Loss: 0.225 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0624371
	speed: 0.5872s/iter; left time: 22523.1815s
	iters: 200, epoch: 19 | loss: 0.0012134
	speed: 0.1462s/iter; left time: 5592.1361s
	iters: 300, epoch: 19 | loss: 0.0049815
	speed: 0.1581s/iter; left time: 6031.2198s
	iters: 400, epoch: 19 | loss: 0.5081914
	speed: 0.1505s/iter; left time: 5726.3877s
Epoch: 19 cost time: 70.69401454925537
Epoch: 19, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.227 Vali Acc: 0.949 Test Loss: 0.227 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1144439
	speed: 0.5303s/iter; left time: 20094.8258s
	iters: 200, epoch: 20 | loss: 0.1471001
	speed: 0.1527s/iter; left time: 5772.2122s
	iters: 300, epoch: 20 | loss: 0.0091703
	speed: 0.1267s/iter; left time: 4774.2598s
	iters: 400, epoch: 20 | loss: 0.0089077
	speed: 0.1369s/iter; left time: 5146.5293s
Epoch: 20 cost time: 65.50879716873169
Epoch: 20, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1686164
	speed: 0.5590s/iter; left time: 20919.2875s
	iters: 200, epoch: 21 | loss: 0.1320995
	speed: 0.1359s/iter; left time: 5070.5335s
	iters: 300, epoch: 21 | loss: 0.1433875
	speed: 0.1242s/iter; left time: 4624.6657s
	iters: 400, epoch: 21 | loss: 0.0041943
	speed: 0.1475s/iter; left time: 5474.7216s
Epoch: 21 cost time: 66.06472277641296
Epoch: 21, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.254 Vali Acc: 0.936 Test Loss: 0.254 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0911621
	speed: 0.6422s/iter; left time: 23731.7886s
	iters: 200, epoch: 22 | loss: 0.1110473
	speed: 0.1530s/iter; left time: 5637.1438s
	iters: 300, epoch: 22 | loss: 0.4277358
	speed: 0.1398s/iter; left time: 5137.7486s
	iters: 400, epoch: 22 | loss: 0.0513755
	speed: 0.1447s/iter; left time: 5305.2418s
Epoch: 22 cost time: 66.19406723976135
Epoch: 22, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2086574
	speed: 0.6036s/iter; left time: 22020.6079s
	iters: 200, epoch: 23 | loss: 0.3136335
	speed: 0.1343s/iter; left time: 4887.2139s
	iters: 300, epoch: 23 | loss: 0.0570241
	speed: 0.1285s/iter; left time: 4663.8400s
	iters: 400, epoch: 23 | loss: 0.0400109
	speed: 0.1523s/iter; left time: 5509.3037s
Epoch: 23 cost time: 63.71801996231079
Epoch: 23, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1690836
	speed: 0.5859s/iter; left time: 21101.4219s
	iters: 200, epoch: 24 | loss: 0.0281910
	speed: 0.1404s/iter; left time: 5040.7217s
	iters: 300, epoch: 24 | loss: 0.0058616
	speed: 0.1399s/iter; left time: 5012.0712s
	iters: 400, epoch: 24 | loss: 0.0063748
	speed: 0.1462s/iter; left time: 5221.8650s
Epoch: 24 cost time: 67.10588049888611
Epoch: 24, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9616923956546598
model parameter : 2103738
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8881233
	speed: 0.1272s/iter; left time: 5953.6758s
	iters: 200, epoch: 1 | loss: 0.1202298
	speed: 0.0973s/iter; left time: 4543.7825s
	iters: 300, epoch: 1 | loss: 0.1004488
	speed: 0.1077s/iter; left time: 5018.2468s
	iters: 400, epoch: 1 | loss: 0.1677304
	speed: 0.1001s/iter; left time: 4653.3575s
Epoch: 1 cost time: 51.36539936065674
Epoch: 1, Steps: 469 | Train Loss: 0.520 Vali Loss: 0.237 Vali Acc: 0.934 Test Loss: 0.237 Test Acc: 0.934
Validation loss decreased (inf --> -0.933674).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1384324
	speed: 0.5437s/iter; left time: 25190.7510s
	iters: 200, epoch: 2 | loss: 0.5186642
	speed: 0.1352s/iter; left time: 6248.6560s
	iters: 300, epoch: 2 | loss: 0.0390380
	speed: 0.1322s/iter; left time: 6098.1874s
	iters: 400, epoch: 2 | loss: 0.0614179
	speed: 0.1276s/iter; left time: 5873.1002s
Epoch: 2 cost time: 62.67292261123657
Epoch: 2, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1196854
	speed: 0.5602s/iter; left time: 25693.1859s
	iters: 200, epoch: 3 | loss: 0.0581822
	speed: 0.1168s/iter; left time: 5343.4249s
	iters: 300, epoch: 3 | loss: 0.1922537
	speed: 0.0984s/iter; left time: 4493.2887s
	iters: 400, epoch: 3 | loss: 0.1207267
	speed: 0.1047s/iter; left time: 4768.4767s
Epoch: 3 cost time: 52.316174030303955
Epoch: 3, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.933674 --> -0.942822).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1039229
	speed: 0.5077s/iter; left time: 23044.8607s
	iters: 200, epoch: 4 | loss: 0.0673084
	speed: 0.1038s/iter; left time: 4703.7333s
	iters: 300, epoch: 4 | loss: 0.0957145
	speed: 0.0980s/iter; left time: 4427.3505s
	iters: 400, epoch: 4 | loss: 0.1838871
	speed: 0.1075s/iter; left time: 4845.6461s
Epoch: 4 cost time: 51.55773067474365
Epoch: 4, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.942822 --> -0.950827).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0529377
	speed: 0.5188s/iter; left time: 23309.1215s
	iters: 200, epoch: 5 | loss: 0.0158483
	speed: 0.1102s/iter; left time: 4939.7882s
	iters: 300, epoch: 5 | loss: 0.1929045
	speed: 0.1070s/iter; left time: 4783.9331s
	iters: 400, epoch: 5 | loss: 0.0077589
	speed: 0.1059s/iter; left time: 4724.4588s
Epoch: 5 cost time: 52.65975785255432
Epoch: 5, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0367917
	speed: 0.4911s/iter; left time: 21833.5765s
	iters: 200, epoch: 6 | loss: 0.0224096
	speed: 0.0979s/iter; left time: 4342.6190s
	iters: 300, epoch: 6 | loss: 0.2071779
	speed: 0.1036s/iter; left time: 4585.6289s
	iters: 400, epoch: 6 | loss: 0.1251892
	speed: 0.1118s/iter; left time: 4934.6650s
Epoch: 6 cost time: 49.54269790649414
Epoch: 6, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.243 Vali Acc: 0.940 Test Loss: 0.243 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0241692
	speed: 0.4609s/iter; left time: 20274.6404s
	iters: 200, epoch: 7 | loss: 0.1925892
	speed: 0.1065s/iter; left time: 4674.4315s
	iters: 300, epoch: 7 | loss: 0.0034044
	speed: 0.1019s/iter; left time: 4460.0300s
	iters: 400, epoch: 7 | loss: 0.0539685
	speed: 0.1034s/iter; left time: 4518.6372s
Epoch: 7 cost time: 48.66205096244812
Epoch: 7, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.293 Vali Acc: 0.918 Test Loss: 0.293 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0791018
	speed: 0.4763s/iter; left time: 20725.8435s
	iters: 200, epoch: 8 | loss: 0.0643130
	speed: 0.1024s/iter; left time: 4446.9042s
	iters: 300, epoch: 8 | loss: 0.0137591
	speed: 0.0959s/iter; left time: 4154.5213s
	iters: 400, epoch: 8 | loss: 0.0061753
	speed: 0.1071s/iter; left time: 4630.6892s
Epoch: 8 cost time: 48.87676978111267
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0087952
	speed: 0.5316s/iter; left time: 22886.2057s
	iters: 200, epoch: 9 | loss: 0.0131921
	speed: 0.1423s/iter; left time: 6110.9898s
	iters: 300, epoch: 9 | loss: 0.0551553
	speed: 0.1319s/iter; left time: 5649.8421s
	iters: 400, epoch: 9 | loss: 0.9972599
	speed: 0.1313s/iter; left time: 5614.6499s
Epoch: 9 cost time: 64.6642336845398
Epoch: 9, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.950827 --> -0.963406).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0085993
	speed: 0.5140s/iter; left time: 21888.1316s
	iters: 200, epoch: 10 | loss: 0.0731663
	speed: 0.1285s/iter; left time: 5460.5696s
	iters: 300, epoch: 10 | loss: 0.0309733
	speed: 0.1292s/iter; left time: 5475.0323s
	iters: 400, epoch: 10 | loss: 0.0379399
	speed: 0.1308s/iter; left time: 5529.0351s
Epoch: 10 cost time: 62.57611012458801
Epoch: 10, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1514702
	speed: 0.5142s/iter; left time: 21653.1240s
	iters: 200, epoch: 11 | loss: 0.1000121
	speed: 0.1305s/iter; left time: 5482.8920s
	iters: 300, epoch: 11 | loss: 0.0942747
	speed: 0.1315s/iter; left time: 5511.2734s
	iters: 400, epoch: 11 | loss: 0.0034152
	speed: 0.1304s/iter; left time: 5450.7119s
Epoch: 11 cost time: 61.67141938209534
Epoch: 11, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0136740
	speed: 0.5603s/iter; left time: 23330.5305s
	iters: 200, epoch: 12 | loss: 0.3175233
	speed: 0.1233s/iter; left time: 5124.0901s
	iters: 300, epoch: 12 | loss: 0.0386614
	speed: 0.1112s/iter; left time: 4608.2227s
	iters: 400, epoch: 12 | loss: 0.0182895
	speed: 0.1261s/iter; left time: 5211.3136s
Epoch: 12 cost time: 61.22926068305969
Epoch: 12, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7501432
	speed: 0.6108s/iter; left time: 25147.3368s
	iters: 200, epoch: 13 | loss: 0.0175920
	speed: 0.1502s/iter; left time: 6167.3908s
	iters: 300, epoch: 13 | loss: 0.1317409
	speed: 0.1492s/iter; left time: 6111.9535s
	iters: 400, epoch: 13 | loss: 0.0072817
	speed: 0.1245s/iter; left time: 5087.1702s
Epoch: 13 cost time: 65.78702688217163
Epoch: 13, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0742255
	speed: 0.5398s/iter; left time: 21971.9272s
	iters: 200, epoch: 14 | loss: 0.0681037
	speed: 0.1215s/iter; left time: 4933.4474s
	iters: 300, epoch: 14 | loss: 0.0108734
	speed: 0.1100s/iter; left time: 4454.0444s
	iters: 400, epoch: 14 | loss: 0.2089510
	speed: 0.1261s/iter; left time: 5094.7672s
Epoch: 14 cost time: 58.25836372375488
Epoch: 14, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0109156
	speed: 0.5250s/iter; left time: 21122.1020s
	iters: 200, epoch: 15 | loss: 0.0398813
	speed: 0.1119s/iter; left time: 4492.7030s
	iters: 300, epoch: 15 | loss: 0.0771554
	speed: 0.1118s/iter; left time: 4477.7620s
	iters: 400, epoch: 15 | loss: 0.0435090
	speed: 0.1032s/iter; left time: 4120.6687s
Epoch: 15 cost time: 53.36454963684082
Epoch: 15, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0456544
	speed: 0.5082s/iter; left time: 20209.6318s
	iters: 200, epoch: 16 | loss: 0.0874022
	speed: 0.1189s/iter; left time: 4716.1145s
	iters: 300, epoch: 16 | loss: 0.1536630
	speed: 0.1238s/iter; left time: 4898.1498s
	iters: 400, epoch: 16 | loss: 0.0490451
	speed: 0.1087s/iter; left time: 4289.5245s
Epoch: 16 cost time: 54.29390215873718
Epoch: 16, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0061263
	speed: 0.4905s/iter; left time: 19276.4458s
	iters: 200, epoch: 17 | loss: 0.0426913
	speed: 0.1025s/iter; left time: 4017.9570s
	iters: 300, epoch: 17 | loss: 0.0026987
	speed: 0.0983s/iter; left time: 3843.7331s
	iters: 400, epoch: 17 | loss: 0.0102617
	speed: 0.1004s/iter; left time: 3913.5726s
Epoch: 17 cost time: 48.338090896606445
Epoch: 17, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0245663
	speed: 0.4847s/iter; left time: 18818.8834s
	iters: 200, epoch: 18 | loss: 0.0493645
	speed: 0.1100s/iter; left time: 4258.8420s
	iters: 300, epoch: 18 | loss: 0.0026990
	speed: 0.1028s/iter; left time: 3971.9261s
	iters: 400, epoch: 18 | loss: 0.2667835
	speed: 0.1126s/iter; left time: 4338.7227s
Epoch: 18 cost time: 52.463815689086914
Epoch: 18, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.240 Vali Acc: 0.945 Test Loss: 0.240 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0336765
	speed: 0.5446s/iter; left time: 20890.2688s
	iters: 200, epoch: 19 | loss: 0.0157454
	speed: 0.1296s/iter; left time: 4958.3672s
	iters: 300, epoch: 19 | loss: 0.0304296
	speed: 0.1284s/iter; left time: 4901.2917s
	iters: 400, epoch: 19 | loss: 0.0138795
	speed: 0.1182s/iter; left time: 4498.6170s
Epoch: 19 cost time: 59.53580832481384
Epoch: 19, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9634076615208691
model parameter : 2103354
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5872059
	speed: 0.1166s/iter; left time: 5458.2533s
	iters: 200, epoch: 1 | loss: 0.3660255
	speed: 0.0913s/iter; left time: 4265.5656s
	iters: 300, epoch: 1 | loss: 0.2765321
	speed: 0.0915s/iter; left time: 4263.4479s
	iters: 400, epoch: 1 | loss: 0.2503869
	speed: 0.0861s/iter; left time: 4004.4225s
Epoch: 1 cost time: 44.09795093536377
Epoch: 1, Steps: 469 | Train Loss: 0.529 Vali Loss: 0.334 Vali Acc: 0.890 Test Loss: 0.334 Test Acc: 0.890
Validation loss decreased (inf --> -0.889934).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1506767
	speed: 0.4376s/iter; left time: 20276.4655s
	iters: 200, epoch: 2 | loss: 0.1703314
	speed: 0.0966s/iter; left time: 4465.8498s
	iters: 300, epoch: 2 | loss: 0.0285198
	speed: 0.0975s/iter; left time: 4497.5507s
	iters: 400, epoch: 2 | loss: 0.0459631
	speed: 0.1081s/iter; left time: 4977.0324s
Epoch: 2 cost time: 46.34453892707825
Epoch: 2, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.311 Vali Acc: 0.914 Test Loss: 0.311 Test Acc: 0.914
Validation loss decreased (-0.889934 --> -0.913662).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1209040
	speed: 0.4441s/iter; left time: 20365.6733s
	iters: 200, epoch: 3 | loss: 0.0639657
	speed: 0.0906s/iter; left time: 4146.4901s
	iters: 300, epoch: 3 | loss: 0.0299352
	speed: 0.0959s/iter; left time: 4379.7113s
	iters: 400, epoch: 3 | loss: 0.1248721
	speed: 0.0966s/iter; left time: 4403.5898s
Epoch: 3 cost time: 45.30442929267883
Epoch: 3, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0943189
	speed: 0.4551s/iter; left time: 20660.5842s
	iters: 200, epoch: 4 | loss: 0.0444630
	speed: 0.0880s/iter; left time: 3987.3392s
	iters: 300, epoch: 4 | loss: 0.0144868
	speed: 0.0916s/iter; left time: 4137.9570s
	iters: 400, epoch: 4 | loss: 0.1305297
	speed: 0.0895s/iter; left time: 4036.6058s
Epoch: 4 cost time: 45.87032175064087
Epoch: 4, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.268 Vali Acc: 0.936 Test Loss: 0.268 Test Acc: 0.936
Validation loss decreased (-0.913662 --> -0.936247).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0225849
	speed: 0.4195s/iter; left time: 18847.8637s
	iters: 200, epoch: 5 | loss: 0.0285288
	speed: 0.0867s/iter; left time: 3887.3318s
	iters: 300, epoch: 5 | loss: 0.0256840
	speed: 0.0965s/iter; left time: 4314.7161s
	iters: 400, epoch: 5 | loss: 0.0174162
	speed: 0.0936s/iter; left time: 4175.4084s
Epoch: 5 cost time: 44.72652769088745
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
Validation loss decreased (-0.936247 --> -0.943108).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0115615
	speed: 0.3972s/iter; left time: 17656.9565s
	iters: 200, epoch: 6 | loss: 0.0079048
	speed: 0.0987s/iter; left time: 4379.6511s
	iters: 300, epoch: 6 | loss: 0.0018727
	speed: 0.0969s/iter; left time: 4290.5787s
	iters: 400, epoch: 6 | loss: 0.2523194
	speed: 0.0963s/iter; left time: 4252.4758s
Epoch: 6 cost time: 44.945992946624756
Epoch: 6, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0515650
	speed: 0.4225s/iter; left time: 18584.6004s
	iters: 200, epoch: 7 | loss: 0.0023741
	speed: 0.1039s/iter; left time: 4557.8116s
	iters: 300, epoch: 7 | loss: 0.2868789
	speed: 0.1051s/iter; left time: 4600.4575s
	iters: 400, epoch: 7 | loss: 0.1655287
	speed: 0.0866s/iter; left time: 3783.7616s
Epoch: 7 cost time: 45.020928621292114
Epoch: 7, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1615495
	speed: 0.3769s/iter; left time: 16401.9981s
	iters: 200, epoch: 8 | loss: 0.2416168
	speed: 0.0788s/iter; left time: 3421.4872s
	iters: 300, epoch: 8 | loss: 0.0051970
	speed: 0.0818s/iter; left time: 3542.7986s
	iters: 400, epoch: 8 | loss: 0.2673749
	speed: 0.0812s/iter; left time: 3508.7515s
Epoch: 8 cost time: 38.19801592826843
Epoch: 8, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.943108 --> -0.953114).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0045864
	speed: 0.3630s/iter; left time: 15625.6600s
	iters: 200, epoch: 9 | loss: 0.0825223
	speed: 0.0793s/iter; left time: 3406.9362s
	iters: 300, epoch: 9 | loss: 0.0020502
	speed: 0.0752s/iter; left time: 3223.3942s
	iters: 400, epoch: 9 | loss: 0.0560620
	speed: 0.0817s/iter; left time: 3490.9254s
Epoch: 9 cost time: 38.843082904815674
Epoch: 9, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.355 Vali Acc: 0.916 Test Loss: 0.355 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0093849
	speed: 0.3857s/iter; left time: 16422.3613s
	iters: 200, epoch: 10 | loss: 0.0671524
	speed: 0.0879s/iter; left time: 3732.6909s
	iters: 300, epoch: 10 | loss: 0.0210013
	speed: 0.0794s/iter; left time: 3365.0493s
	iters: 400, epoch: 10 | loss: 0.4810822
	speed: 0.0857s/iter; left time: 3622.1379s
Epoch: 10 cost time: 39.92444658279419
Epoch: 10, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.953114 --> -0.960547).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0044079
	speed: 0.3835s/iter; left time: 16147.9670s
	iters: 200, epoch: 11 | loss: 0.0053286
	speed: 0.0891s/iter; left time: 3741.8703s
	iters: 300, epoch: 11 | loss: 0.0926905
	speed: 0.0880s/iter; left time: 3686.9592s
	iters: 400, epoch: 11 | loss: 0.0642300
	speed: 0.0867s/iter; left time: 3624.3049s
Epoch: 11 cost time: 41.43482232093811
Epoch: 11, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0316865
	speed: 0.3773s/iter; left time: 15712.3892s
	iters: 200, epoch: 12 | loss: 0.4134422
	speed: 0.0921s/iter; left time: 3825.3375s
	iters: 300, epoch: 12 | loss: 0.1745732
	speed: 0.0808s/iter; left time: 3346.7295s
	iters: 400, epoch: 12 | loss: 0.0559377
	speed: 0.0748s/iter; left time: 3094.1945s
Epoch: 12 cost time: 40.01953434944153
Epoch: 12, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.194 Vali Acc: 0.953 Test Loss: 0.194 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1060695
	speed: 0.3819s/iter; left time: 15725.2967s
	iters: 200, epoch: 13 | loss: 0.0155987
	speed: 0.0867s/iter; left time: 3560.7126s
	iters: 300, epoch: 13 | loss: 0.0297102
	speed: 0.0783s/iter; left time: 3207.0616s
	iters: 400, epoch: 13 | loss: 0.0080183
	speed: 0.0786s/iter; left time: 3213.1643s
Epoch: 13 cost time: 39.471776723861694
Epoch: 13, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0065020
	speed: 0.3891s/iter; left time: 15838.9330s
	iters: 200, epoch: 14 | loss: 0.0102408
	speed: 0.0961s/iter; left time: 3901.8816s
	iters: 300, epoch: 14 | loss: 0.0421973
	speed: 0.0884s/iter; left time: 3580.9396s
	iters: 400, epoch: 14 | loss: 0.0062095
	speed: 0.0847s/iter; left time: 3420.2724s
Epoch: 14 cost time: 41.44736409187317
Epoch: 14, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0284938
	speed: 0.4104s/iter; left time: 16511.2139s
	iters: 200, epoch: 15 | loss: 0.2281536
	speed: 0.0875s/iter; left time: 3511.3950s
	iters: 300, epoch: 15 | loss: 0.1427702
	speed: 0.0892s/iter; left time: 3573.0478s
	iters: 400, epoch: 15 | loss: 0.2600217
	speed: 0.0817s/iter; left time: 3264.1488s
Epoch: 15 cost time: 41.61444568634033
Epoch: 15, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1495764
	speed: 0.3635s/iter; left time: 14456.5175s
	iters: 200, epoch: 16 | loss: 0.0034238
	speed: 0.1008s/iter; left time: 3996.5301s
	iters: 300, epoch: 16 | loss: 0.4315610
	speed: 0.0791s/iter; left time: 3127.7325s
	iters: 400, epoch: 16 | loss: 0.1801026
	speed: 0.0781s/iter; left time: 3082.9620s
Epoch: 16 cost time: 42.205816984176636
Epoch: 16, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1843593
	speed: 0.3991s/iter; left time: 15683.7232s
	iters: 200, epoch: 17 | loss: 0.1764851
	speed: 0.0913s/iter; left time: 3577.5586s
	iters: 300, epoch: 17 | loss: 0.0113432
	speed: 0.0818s/iter; left time: 3199.3335s
	iters: 400, epoch: 17 | loss: 0.1041024
	speed: 0.0871s/iter; left time: 3395.3662s
Epoch: 17 cost time: 41.53357005119324
Epoch: 17, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0081301
	speed: 0.3696s/iter; left time: 14350.5759s
	iters: 200, epoch: 18 | loss: 0.0474587
	speed: 0.0752s/iter; left time: 2911.1605s
	iters: 300, epoch: 18 | loss: 0.0340458
	speed: 0.0779s/iter; left time: 3007.5408s
	iters: 400, epoch: 18 | loss: 0.0103968
	speed: 0.0829s/iter; left time: 3194.9081s
Epoch: 18 cost time: 37.96126699447632
Epoch: 18, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3253773
	speed: 0.3534s/iter; left time: 13557.7211s
	iters: 200, epoch: 19 | loss: 0.0675229
	speed: 0.0813s/iter; left time: 3111.5350s
	iters: 300, epoch: 19 | loss: 0.0528903
	speed: 0.0836s/iter; left time: 3189.6665s
	iters: 400, epoch: 19 | loss: 0.0087538
	speed: 0.0762s/iter; left time: 2898.5118s
Epoch: 19 cost time: 37.900113582611084
Epoch: 19, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0472533
	speed: 0.3666s/iter; left time: 13891.2093s
	iters: 200, epoch: 20 | loss: 0.0980863
	speed: 0.0843s/iter; left time: 3185.3357s
	iters: 300, epoch: 20 | loss: 0.0025584
	speed: 0.0795s/iter; left time: 2996.4640s
	iters: 400, epoch: 20 | loss: 0.2331741
	speed: 0.0789s/iter; left time: 2966.6359s
Epoch: 20 cost time: 38.66976451873779
Epoch: 20, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9605488850771869
model parameter : 2102970
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3484635
	speed: 0.1009s/iter; left time: 4722.3298s
	iters: 200, epoch: 1 | loss: 0.9168950
	speed: 0.0900s/iter; left time: 4204.0676s
	iters: 300, epoch: 1 | loss: 0.0933763
	speed: 0.0835s/iter; left time: 3890.0703s
	iters: 400, epoch: 1 | loss: 0.3117011
	speed: 0.0737s/iter; left time: 3426.1224s
Epoch: 1 cost time: 39.91765356063843
Epoch: 1, Steps: 469 | Train Loss: 0.522 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
Validation loss decreased (inf --> -0.922239).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3009230
	speed: 0.3548s/iter; left time: 16440.2925s
	iters: 200, epoch: 2 | loss: 0.1786056
	speed: 0.0763s/iter; left time: 3529.3725s
	iters: 300, epoch: 2 | loss: 0.1691811
	speed: 0.0832s/iter; left time: 3836.7724s
	iters: 400, epoch: 2 | loss: 0.1277175
	speed: 0.0876s/iter; left time: 4033.6895s
Epoch: 2 cost time: 38.0531325340271
Epoch: 2, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.279 Vali Acc: 0.901 Test Loss: 0.279 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5859699
	speed: 0.3683s/iter; left time: 16892.7768s
	iters: 200, epoch: 3 | loss: 0.1891119
	speed: 0.0848s/iter; left time: 3882.2373s
	iters: 300, epoch: 3 | loss: 0.0427757
	speed: 0.0776s/iter; left time: 3545.6666s
	iters: 400, epoch: 3 | loss: 0.0438668
	speed: 0.0864s/iter; left time: 3937.0239s
Epoch: 3 cost time: 39.323164224624634
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.383 Vali Acc: 0.890 Test Loss: 0.383 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0122866
	speed: 0.3670s/iter; left time: 16657.4151s
	iters: 200, epoch: 4 | loss: 0.0362391
	speed: 0.0722s/iter; left time: 3268.7599s
	iters: 300, epoch: 4 | loss: 0.2467420
	speed: 0.0697s/iter; left time: 3148.0290s
	iters: 400, epoch: 4 | loss: 0.0302749
	speed: 0.0769s/iter; left time: 3469.8431s
Epoch: 4 cost time: 36.488747358322144
Epoch: 4, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.202 Vali Acc: 0.934 Test Loss: 0.202 Test Acc: 0.934
Validation loss decreased (-0.922239 --> -0.933674).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0155300
	speed: 0.3440s/iter; left time: 15452.2006s
	iters: 200, epoch: 5 | loss: 0.2037188
	speed: 0.0855s/iter; left time: 3831.0513s
	iters: 300, epoch: 5 | loss: 0.1966847
	speed: 0.0859s/iter; left time: 3840.0117s
	iters: 400, epoch: 5 | loss: 0.0876317
	speed: 0.0822s/iter; left time: 3668.7453s
Epoch: 5 cost time: 38.5749032497406
Epoch: 5, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.239 Vali Acc: 0.923 Test Loss: 0.239 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0231410
	speed: 0.3643s/iter; left time: 16195.3755s
	iters: 200, epoch: 6 | loss: 0.1523943
	speed: 0.0854s/iter; left time: 3789.4122s
	iters: 300, epoch: 6 | loss: 0.0112574
	speed: 0.0830s/iter; left time: 3671.5486s
	iters: 400, epoch: 6 | loss: 0.1682151
	speed: 0.0851s/iter; left time: 3759.0193s
Epoch: 6 cost time: 39.06831479072571
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.933674 --> -0.966837).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1877694
	speed: 0.3545s/iter; left time: 15594.0554s
	iters: 200, epoch: 7 | loss: 0.0092475
	speed: 0.0692s/iter; left time: 3037.2732s
	iters: 300, epoch: 7 | loss: 0.0268998
	speed: 0.0719s/iter; left time: 3148.7469s
	iters: 400, epoch: 7 | loss: 0.3385864
	speed: 0.0763s/iter; left time: 3332.9369s
Epoch: 7 cost time: 35.55732870101929
Epoch: 7, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0139443
	speed: 0.3609s/iter; left time: 15706.7906s
	iters: 200, epoch: 8 | loss: 0.0057149
	speed: 0.0878s/iter; left time: 3812.0109s
	iters: 300, epoch: 8 | loss: 0.0068375
	speed: 0.0927s/iter; left time: 4014.2426s
	iters: 400, epoch: 8 | loss: 0.0021202
	speed: 0.0779s/iter; left time: 3365.5754s
Epoch: 8 cost time: 38.935401916503906
Epoch: 8, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0233419
	speed: 0.3716s/iter; left time: 15997.6604s
	iters: 200, epoch: 9 | loss: 0.0067485
	speed: 0.0915s/iter; left time: 3931.6559s
	iters: 300, epoch: 9 | loss: 0.1181638
	speed: 0.0850s/iter; left time: 3644.0646s
	iters: 400, epoch: 9 | loss: 0.0160308
	speed: 0.0854s/iter; left time: 3648.6610s
Epoch: 9 cost time: 40.09854173660278
Epoch: 9, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.210 Vali Acc: 0.936 Test Loss: 0.210 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1231068
	speed: 0.3842s/iter; left time: 16360.9090s
	iters: 200, epoch: 10 | loss: 0.0571351
	speed: 0.0837s/iter; left time: 3557.2107s
	iters: 300, epoch: 10 | loss: 0.0295682
	speed: 0.0926s/iter; left time: 3922.3925s
	iters: 400, epoch: 10 | loss: 0.0729621
	speed: 0.0828s/iter; left time: 3498.9284s
Epoch: 10 cost time: 40.317471742630005
Epoch: 10, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3843395
	speed: 0.3817s/iter; left time: 16075.0223s
	iters: 200, epoch: 11 | loss: 0.1040774
	speed: 0.0876s/iter; left time: 3682.2109s
	iters: 300, epoch: 11 | loss: 0.0052586
	speed: 0.0760s/iter; left time: 3184.4861s
	iters: 400, epoch: 11 | loss: 0.0077891
	speed: 0.0814s/iter; left time: 3404.7334s
Epoch: 11 cost time: 40.354243993759155
Epoch: 11, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0018743
	speed: 0.3715s/iter; left time: 15470.3159s
	iters: 200, epoch: 12 | loss: 0.0020224
	speed: 0.0896s/iter; left time: 3721.4991s
	iters: 300, epoch: 12 | loss: 0.0551443
	speed: 0.0913s/iter; left time: 3784.9031s
	iters: 400, epoch: 12 | loss: 0.0157726
	speed: 0.0766s/iter; left time: 3168.2385s
Epoch: 12 cost time: 40.709336042404175
Epoch: 12, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4149583
	speed: 0.3711s/iter; left time: 15278.6434s
	iters: 200, epoch: 13 | loss: 0.0038102
	speed: 0.0799s/iter; left time: 3281.4725s
	iters: 300, epoch: 13 | loss: 0.2166348
	speed: 0.0817s/iter; left time: 3346.3347s
	iters: 400, epoch: 13 | loss: 0.0270900
	speed: 0.0827s/iter; left time: 3380.8259s
Epoch: 13 cost time: 37.86843013763428
Epoch: 13, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0656772
	speed: 0.3337s/iter; left time: 13582.3632s
	iters: 200, epoch: 14 | loss: 0.0631617
	speed: 0.0704s/iter; left time: 2856.6926s
	iters: 300, epoch: 14 | loss: 0.2269334
	speed: 0.0789s/iter; left time: 3196.8902s
	iters: 400, epoch: 14 | loss: 0.0024537
	speed: 0.0809s/iter; left time: 3268.8522s
Epoch: 14 cost time: 36.271217584609985
Epoch: 14, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.296 Vali Acc: 0.908 Test Loss: 0.296 Test Acc: 0.908
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0044536
	speed: 0.3327s/iter; left time: 13385.5900s
	iters: 200, epoch: 15 | loss: 0.0136709
	speed: 0.0745s/iter; left time: 2989.5210s
	iters: 300, epoch: 15 | loss: 0.0127502
	speed: 0.0790s/iter; left time: 3163.5795s
	iters: 400, epoch: 15 | loss: 0.0171987
	speed: 0.0775s/iter; left time: 3093.4182s
Epoch: 15 cost time: 36.775678873062134
Epoch: 15, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.244 Vali Acc: 0.939 Test Loss: 0.244 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0393960
	speed: 0.3391s/iter; left time: 13484.5654s
	iters: 200, epoch: 16 | loss: 0.0185682
	speed: 0.0764s/iter; left time: 3030.4645s
	iters: 300, epoch: 16 | loss: 0.1650008
	speed: 0.0715s/iter; left time: 2829.3581s
	iters: 400, epoch: 16 | loss: 0.0140088
	speed: 0.0757s/iter; left time: 2986.7786s
Epoch: 16 cost time: 36.48030161857605
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 2102586
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9570109
	speed: 0.0963s/iter; left time: 4505.3273s
	iters: 200, epoch: 1 | loss: 0.5836614
	speed: 0.0690s/iter; left time: 3224.2525s
	iters: 300, epoch: 1 | loss: 0.3371025
	speed: 0.0723s/iter; left time: 3370.5552s
	iters: 400, epoch: 1 | loss: 0.1735645
	speed: 0.0843s/iter; left time: 3922.0985s
Epoch: 1 cost time: 38.10972285270691
Epoch: 1, Steps: 469 | Train Loss: 0.606 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
Validation loss decreased (inf --> -0.861917).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3172183
	speed: 0.3246s/iter; left time: 15037.9575s
	iters: 200, epoch: 2 | loss: 0.0503311
	speed: 0.0681s/iter; left time: 3148.6392s
	iters: 300, epoch: 2 | loss: 0.3713314
	speed: 0.0752s/iter; left time: 3467.2697s
	iters: 400, epoch: 2 | loss: 0.0392031
	speed: 0.0716s/iter; left time: 3294.0703s
Epoch: 2 cost time: 33.84007143974304
Epoch: 2, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.861917 --> -0.925383).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0981233
	speed: 0.3326s/iter; left time: 15252.9568s
	iters: 200, epoch: 3 | loss: 0.0847866
	speed: 0.0683s/iter; left time: 3125.1343s
	iters: 300, epoch: 3 | loss: 0.0639068
	speed: 0.0857s/iter; left time: 3913.5504s
	iters: 400, epoch: 3 | loss: 0.1739511
	speed: 0.0818s/iter; left time: 3728.9344s
Epoch: 3 cost time: 36.0904061794281
Epoch: 3, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0565162
	speed: 0.3292s/iter; left time: 14944.8188s
	iters: 200, epoch: 4 | loss: 0.1148821
	speed: 0.0691s/iter; left time: 3128.7476s
	iters: 300, epoch: 4 | loss: 0.1501151
	speed: 0.0700s/iter; left time: 3162.5430s
	iters: 400, epoch: 4 | loss: 0.1883115
	speed: 0.0731s/iter; left time: 3296.3045s
Epoch: 4 cost time: 34.22485089302063
Epoch: 4, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.925383 --> -0.936533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1823134
	speed: 0.3182s/iter; left time: 14294.8178s
	iters: 200, epoch: 5 | loss: 0.2143492
	speed: 0.0785s/iter; left time: 3520.3468s
	iters: 300, epoch: 5 | loss: 0.5654811
	speed: 0.0691s/iter; left time: 3088.8274s
	iters: 400, epoch: 5 | loss: 0.0568111
	speed: 0.0738s/iter; left time: 3292.7299s
Epoch: 5 cost time: 34.93515086174011
Epoch: 5, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.259 Vali Acc: 0.936 Test Loss: 0.259 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0618441
	speed: 0.3281s/iter; left time: 14583.9529s
	iters: 200, epoch: 6 | loss: 0.0190123
	speed: 0.0705s/iter; left time: 3128.1138s
	iters: 300, epoch: 6 | loss: 0.0127143
	speed: 0.0783s/iter; left time: 3463.9039s
	iters: 400, epoch: 6 | loss: 0.0530552
	speed: 0.0745s/iter; left time: 3288.1222s
Epoch: 6 cost time: 35.00693392753601
Epoch: 6, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.936533 --> -0.953400).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0160220
	speed: 0.3153s/iter; left time: 13867.3731s
	iters: 200, epoch: 7 | loss: 0.0249679
	speed: 0.0730s/iter; left time: 3201.5903s
	iters: 300, epoch: 7 | loss: 0.0059756
	speed: 0.0748s/iter; left time: 3273.5001s
	iters: 400, epoch: 7 | loss: 0.0080684
	speed: 0.0792s/iter; left time: 3459.0792s
Epoch: 7 cost time: 35.63131546974182
Epoch: 7, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1222982
	speed: 0.3338s/iter; left time: 14526.7831s
	iters: 200, epoch: 8 | loss: 0.1245854
	speed: 0.0729s/iter; left time: 3163.7254s
	iters: 300, epoch: 8 | loss: 0.0120908
	speed: 0.0783s/iter; left time: 3393.2029s
	iters: 400, epoch: 8 | loss: 0.0663918
	speed: 0.0813s/iter; left time: 3514.1135s
Epoch: 8 cost time: 36.02888083457947
Epoch: 8, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.246 Vali Acc: 0.945 Test Loss: 0.246 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2432239
	speed: 0.3265s/iter; left time: 14055.3058s
	iters: 200, epoch: 9 | loss: 0.3572276
	speed: 0.0746s/iter; left time: 3204.7315s
	iters: 300, epoch: 9 | loss: 0.0125117
	speed: 0.0800s/iter; left time: 3426.4585s
	iters: 400, epoch: 9 | loss: 0.2835330
	speed: 0.0802s/iter; left time: 3427.2845s
Epoch: 9 cost time: 36.10219597816467
Epoch: 9, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.227 Vali Acc: 0.949 Test Loss: 0.227 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2921385
	speed: 0.3311s/iter; left time: 14100.0673s
	iters: 200, epoch: 10 | loss: 0.0809592
	speed: 0.0706s/iter; left time: 2999.4788s
	iters: 300, epoch: 10 | loss: 0.0036965
	speed: 0.0773s/iter; left time: 3274.8511s
	iters: 400, epoch: 10 | loss: 0.0226717
	speed: 0.0862s/iter; left time: 3642.8356s
Epoch: 10 cost time: 36.4435510635376
Epoch: 10, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.226 Vali Acc: 0.945 Test Loss: 0.226 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0136654
	speed: 0.3447s/iter; left time: 14513.6383s
	iters: 200, epoch: 11 | loss: 0.0679921
	speed: 0.0836s/iter; left time: 3510.3081s
	iters: 300, epoch: 11 | loss: 0.2105030
	speed: 0.0766s/iter; left time: 3211.1536s
	iters: 400, epoch: 11 | loss: 0.0072290
	speed: 0.0774s/iter; left time: 3237.7077s
Epoch: 11 cost time: 37.11912989616394
Epoch: 11, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0332858
	speed: 0.3034s/iter; left time: 12635.8916s
	iters: 200, epoch: 12 | loss: 0.0038171
	speed: 0.0634s/iter; left time: 2634.3327s
	iters: 300, epoch: 12 | loss: 0.1191012
	speed: 0.0666s/iter; left time: 2758.9886s
	iters: 400, epoch: 12 | loss: 0.0148732
	speed: 0.0626s/iter; left time: 2588.9361s
Epoch: 12 cost time: 30.22666335105896
Epoch: 12, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.953400 --> -0.958260).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0084176
	speed: 0.3169s/iter; left time: 13045.9361s
	iters: 200, epoch: 13 | loss: 0.0079761
	speed: 0.0669s/iter; left time: 2749.1905s
	iters: 300, epoch: 13 | loss: 0.0106407
	speed: 0.0737s/iter; left time: 3021.3196s
	iters: 400, epoch: 13 | loss: 0.1413145
	speed: 0.0709s/iter; left time: 2896.1836s
Epoch: 13 cost time: 34.445740699768066
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0051803
	speed: 0.3202s/iter; left time: 13034.7197s
	iters: 200, epoch: 14 | loss: 0.2038786
	speed: 0.0679s/iter; left time: 2757.0323s
	iters: 300, epoch: 14 | loss: 0.1533056
	speed: 0.0701s/iter; left time: 2839.6293s
	iters: 400, epoch: 14 | loss: 0.1203155
	speed: 0.0632s/iter; left time: 2555.2791s
Epoch: 14 cost time: 31.966471433639526
Epoch: 14, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.253 Vali Acc: 0.947 Test Loss: 0.253 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0912581
	speed: 0.2943s/iter; left time: 11841.4885s
	iters: 200, epoch: 15 | loss: 0.0022771
	speed: 0.0730s/iter; left time: 2930.6073s
	iters: 300, epoch: 15 | loss: 0.0627188
	speed: 0.0735s/iter; left time: 2944.3680s
	iters: 400, epoch: 15 | loss: 0.0027911
	speed: 0.0708s/iter; left time: 2828.3564s
Epoch: 15 cost time: 34.15200924873352
Epoch: 15, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.174 Vali Acc: 0.966 Test Loss: 0.174 Test Acc: 0.966
Validation loss decreased (-0.958260 --> -0.965979).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0042182
	speed: 0.2978s/iter; left time: 11841.0048s
	iters: 200, epoch: 16 | loss: 0.1023525
	speed: 0.0680s/iter; left time: 2696.8975s
	iters: 300, epoch: 16 | loss: 0.0068774
	speed: 0.0644s/iter; left time: 2547.0001s
	iters: 400, epoch: 16 | loss: 0.0093051
	speed: 0.0744s/iter; left time: 2938.1520s
Epoch: 16 cost time: 33.4823899269104
Epoch: 16, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0055511
	speed: 0.3209s/iter; left time: 12609.5238s
	iters: 200, epoch: 17 | loss: 0.0067663
	speed: 0.0762s/iter; left time: 2986.3001s
	iters: 300, epoch: 17 | loss: 0.0505884
	speed: 0.0786s/iter; left time: 3073.3416s
	iters: 400, epoch: 17 | loss: 0.0186108
	speed: 0.0673s/iter; left time: 2625.7863s
Epoch: 17 cost time: 35.38016986846924
Epoch: 17, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0038338
	speed: 0.3253s/iter; left time: 12628.9179s
	iters: 200, epoch: 18 | loss: 0.0177557
	speed: 0.0683s/iter; left time: 2645.5105s
	iters: 300, epoch: 18 | loss: 0.0026615
	speed: 0.0698s/iter; left time: 2695.6056s
	iters: 400, epoch: 18 | loss: 0.0109902
	speed: 0.0733s/iter; left time: 2823.0263s
Epoch: 18 cost time: 33.8490264415741
Epoch: 18, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.965979 --> -0.972841).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0163199
	speed: 0.3309s/iter; left time: 12694.3534s
	iters: 200, epoch: 19 | loss: 0.1573422
	speed: 0.0750s/iter; left time: 2868.5990s
	iters: 300, epoch: 19 | loss: 0.0045008
	speed: 0.0786s/iter; left time: 3000.9154s
	iters: 400, epoch: 19 | loss: 0.0478761
	speed: 0.0683s/iter; left time: 2597.6698s
Epoch: 19 cost time: 34.94015955924988
Epoch: 19, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0803524
	speed: 0.2979s/iter; left time: 11286.7662s
	iters: 200, epoch: 20 | loss: 0.0151384
	speed: 0.0649s/iter; left time: 2452.4800s
	iters: 300, epoch: 20 | loss: 0.7653077
	speed: 0.0634s/iter; left time: 2388.3817s
	iters: 400, epoch: 20 | loss: 0.0107540
	speed: 0.0742s/iter; left time: 2788.3062s
Epoch: 20 cost time: 33.828601360321045
Epoch: 20, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6287684
	speed: 0.3277s/iter; left time: 12261.5454s
	iters: 200, epoch: 21 | loss: 0.0104140
	speed: 0.0742s/iter; left time: 2768.2381s
	iters: 300, epoch: 21 | loss: 0.0024859
	speed: 0.0689s/iter; left time: 2566.1717s
	iters: 400, epoch: 21 | loss: 0.0816143
	speed: 0.0730s/iter; left time: 2711.5814s
Epoch: 21 cost time: 34.815512895584106
Epoch: 21, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0061035
	speed: 0.3577s/iter; left time: 13217.0381s
	iters: 200, epoch: 22 | loss: 0.0132918
	speed: 0.0770s/iter; left time: 2836.4983s
	iters: 300, epoch: 22 | loss: 0.0014156
	speed: 0.0810s/iter; left time: 2976.5612s
	iters: 400, epoch: 22 | loss: 0.3933836
	speed: 0.0866s/iter; left time: 3175.8635s
Epoch: 22 cost time: 37.42373251914978
Epoch: 22, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0015708
	speed: 0.3442s/iter; left time: 12555.8644s
	iters: 200, epoch: 23 | loss: 0.0020599
	speed: 0.0755s/iter; left time: 2747.6931s
	iters: 300, epoch: 23 | loss: 0.1410743
	speed: 0.0713s/iter; left time: 2585.6399s
	iters: 400, epoch: 23 | loss: 0.0125758
	speed: 0.0732s/iter; left time: 2649.4859s
Epoch: 23 cost time: 36.02069044113159
Epoch: 23, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0050817
	speed: 0.3475s/iter; left time: 12513.7821s
	iters: 200, epoch: 24 | loss: 0.0047596
	speed: 0.0797s/iter; left time: 2860.6028s
	iters: 300, epoch: 24 | loss: 0.0584895
	speed: 0.0874s/iter; left time: 3129.6544s
	iters: 400, epoch: 24 | loss: 0.0866732
	speed: 0.0766s/iter; left time: 2734.2877s
Epoch: 24 cost time: 37.32949352264404
Epoch: 24, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.973698).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0057095
	speed: 0.3292s/iter; left time: 11702.7755s
	iters: 200, epoch: 25 | loss: 0.0013778
	speed: 0.0751s/iter; left time: 2663.1919s
	iters: 300, epoch: 25 | loss: 0.0022588
	speed: 0.0813s/iter; left time: 2872.4027s
	iters: 400, epoch: 25 | loss: 0.0051507
	speed: 0.0779s/iter; left time: 2744.1051s
Epoch: 25 cost time: 36.30669355392456
Epoch: 25, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0850332
	speed: 0.3337s/iter; left time: 11705.7238s
	iters: 200, epoch: 26 | loss: 0.0022469
	speed: 0.0779s/iter; left time: 2723.5676s
	iters: 300, epoch: 26 | loss: 0.0032061
	speed: 0.0735s/iter; left time: 2564.3677s
	iters: 400, epoch: 26 | loss: 0.0046941
	speed: 0.0756s/iter; left time: 2630.2424s
Epoch: 26 cost time: 35.33777618408203
Epoch: 26, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0313032
	speed: 0.3243s/iter; left time: 11221.7578s
	iters: 200, epoch: 27 | loss: 0.0089077
	speed: 0.0710s/iter; left time: 2451.7138s
	iters: 300, epoch: 27 | loss: 0.0015937
	speed: 0.0810s/iter; left time: 2788.4929s
	iters: 400, epoch: 27 | loss: 0.0059686
	speed: 0.0807s/iter; left time: 2770.1538s
Epoch: 27 cost time: 36.41140913963318
Epoch: 27, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.965 Test Loss: 0.225 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0552108
	speed: 0.3073s/iter; left time: 10491.6722s
	iters: 200, epoch: 28 | loss: 0.0018181
	speed: 0.0709s/iter; left time: 2412.3859s
	iters: 300, epoch: 28 | loss: 0.1211589
	speed: 0.0700s/iter; left time: 2376.5130s
	iters: 400, epoch: 28 | loss: 0.0088269
	speed: 0.0843s/iter; left time: 2852.6023s
Epoch: 28 cost time: 35.697258710861206
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0013696
	speed: 0.3366s/iter; left time: 11334.3070s
	iters: 200, epoch: 29 | loss: 0.0026959
	speed: 0.0713s/iter; left time: 2394.9191s
	iters: 300, epoch: 29 | loss: 0.0334019
	speed: 0.0701s/iter; left time: 2345.4300s
	iters: 400, epoch: 29 | loss: 0.0271731
	speed: 0.0737s/iter; left time: 2459.9829s
Epoch: 29 cost time: 34.65956664085388
Epoch: 29, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4356188
	speed: 0.3152s/iter; left time: 10464.5492s
	iters: 200, epoch: 30 | loss: 0.0017698
	speed: 0.0656s/iter; left time: 2170.8086s
	iters: 300, epoch: 30 | loss: 0.0017151
	speed: 0.0761s/iter; left time: 2511.3574s
	iters: 400, epoch: 30 | loss: 0.0022710
	speed: 0.0825s/iter; left time: 2714.1249s
Epoch: 30 cost time: 34.85583472251892
Epoch: 30, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0016732
	speed: 0.3485s/iter; left time: 11408.2352s
	iters: 200, epoch: 31 | loss: 0.0076045
	speed: 0.0724s/iter; left time: 2361.6594s
	iters: 300, epoch: 31 | loss: 0.0015843
	speed: 0.0795s/iter; left time: 2585.6766s
	iters: 400, epoch: 31 | loss: 0.0022553
	speed: 0.0775s/iter; left time: 2511.9245s
Epoch: 31 cost time: 36.9406259059906
Epoch: 31, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0174830
	speed: 0.3536s/iter; left time: 11408.9372s
	iters: 200, epoch: 32 | loss: 0.0030782
	speed: 0.0708s/iter; left time: 2276.8029s
	iters: 300, epoch: 32 | loss: 0.0031151
	speed: 0.0743s/iter; left time: 2380.8676s
	iters: 400, epoch: 32 | loss: 0.0014669
	speed: 0.0712s/iter; left time: 2274.9277s
Epoch: 32 cost time: 36.04489541053772
Epoch: 32, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0015155
	speed: 0.3328s/iter; left time: 10579.1691s
	iters: 200, epoch: 33 | loss: 0.0752135
	speed: 0.0774s/iter; left time: 2451.8993s
	iters: 300, epoch: 33 | loss: 0.0012862
	speed: 0.0743s/iter; left time: 2348.8199s
	iters: 400, epoch: 33 | loss: 0.0032962
	speed: 0.0736s/iter; left time: 2317.3998s
Epoch: 33 cost time: 35.38554573059082
Epoch: 33, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0015123
	speed: 0.3218s/iter; left time: 10078.6644s
	iters: 200, epoch: 34 | loss: 0.0011536
	speed: 0.0851s/iter; left time: 2656.8906s
	iters: 300, epoch: 34 | loss: 0.1199339
	speed: 0.0808s/iter; left time: 2515.4572s
	iters: 400, epoch: 34 | loss: 0.0030984
	speed: 0.0684s/iter; left time: 2122.6459s
Epoch: 34 cost time: 35.96611833572388
Epoch: 34, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.203 Vali Acc: 0.964 Test Loss: 0.203 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9736992567181246
model parameter : 1402682
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8773287
	speed: 0.1023s/iter; left time: 4788.2202s
	iters: 200, epoch: 1 | loss: 0.2724559
	speed: 0.0839s/iter; left time: 3916.4401s
	iters: 300, epoch: 1 | loss: 0.3124002
	speed: 0.0820s/iter; left time: 3821.8450s
	iters: 400, epoch: 1 | loss: 0.2211879
	speed: 0.0826s/iter; left time: 3840.9768s
Epoch: 1 cost time: 39.816686153411865
Epoch: 1, Steps: 469 | Train Loss: 0.601 Vali Loss: 0.521 Vali Acc: 0.846 Test Loss: 0.521 Test Acc: 0.846
Validation loss decreased (inf --> -0.845907).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3184240
	speed: 0.3445s/iter; left time: 15961.0934s
	iters: 200, epoch: 2 | loss: 0.3025754
	speed: 0.0739s/iter; left time: 3415.8865s
	iters: 300, epoch: 2 | loss: 0.2580142
	speed: 0.0784s/iter; left time: 3614.5364s
	iters: 400, epoch: 2 | loss: 0.1130027
	speed: 0.0745s/iter; left time: 3428.9934s
Epoch: 2 cost time: 36.47816777229309
Epoch: 2, Steps: 469 | Train Loss: 0.189 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
Validation loss decreased (-0.845907 --> -0.943394).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0427890
	speed: 0.3303s/iter; left time: 15150.3995s
	iters: 200, epoch: 3 | loss: 0.0605361
	speed: 0.0736s/iter; left time: 3366.9287s
	iters: 300, epoch: 3 | loss: 0.0127908
	speed: 0.0747s/iter; left time: 3410.6532s
	iters: 400, epoch: 3 | loss: 0.1389060
	speed: 0.0829s/iter; left time: 3778.4589s
Epoch: 3 cost time: 36.622551679611206
Epoch: 3, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.943394 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0061227
	speed: 0.3224s/iter; left time: 14632.7799s
	iters: 200, epoch: 4 | loss: 0.1630983
	speed: 0.0758s/iter; left time: 3434.4208s
	iters: 300, epoch: 4 | loss: 0.3426394
	speed: 0.0777s/iter; left time: 3510.5479s
	iters: 400, epoch: 4 | loss: 0.3964327
	speed: 0.0783s/iter; left time: 3531.4103s
Epoch: 4 cost time: 36.63682842254639
Epoch: 4, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0681806
	speed: 0.3375s/iter; left time: 15161.1121s
	iters: 200, epoch: 5 | loss: 0.0674476
	speed: 0.0747s/iter; left time: 3350.5473s
	iters: 300, epoch: 5 | loss: 0.1604961
	speed: 0.0752s/iter; left time: 3361.8166s
	iters: 400, epoch: 5 | loss: 0.0817967
	speed: 0.0903s/iter; left time: 4028.4512s
Epoch: 5 cost time: 37.96756076812744
Epoch: 5, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1318689
	speed: 0.3452s/iter; left time: 15346.9637s
	iters: 200, epoch: 6 | loss: 0.1863909
	speed: 0.0692s/iter; left time: 3071.1865s
	iters: 300, epoch: 6 | loss: 0.0620334
	speed: 0.0741s/iter; left time: 3278.6503s
	iters: 400, epoch: 6 | loss: 0.1086641
	speed: 0.0697s/iter; left time: 3079.8135s
Epoch: 6 cost time: 34.52135634422302
Epoch: 6, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0320091
	speed: 0.3150s/iter; left time: 13854.0767s
	iters: 200, epoch: 7 | loss: 0.0133592
	speed: 0.0709s/iter; left time: 3110.5878s
	iters: 300, epoch: 7 | loss: 0.0589168
	speed: 0.0781s/iter; left time: 3421.7154s
	iters: 400, epoch: 7 | loss: 0.0068272
	speed: 0.0687s/iter; left time: 3003.2419s
Epoch: 7 cost time: 33.700653314590454
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1278149
	speed: 0.3290s/iter; left time: 14317.7281s
	iters: 200, epoch: 8 | loss: 0.0077252
	speed: 0.0682s/iter; left time: 2963.1787s
	iters: 300, epoch: 8 | loss: 0.0189745
	speed: 0.0778s/iter; left time: 3371.1085s
	iters: 400, epoch: 8 | loss: 0.2245620
	speed: 0.0774s/iter; left time: 3344.5233s
Epoch: 8 cost time: 34.870725870132446
Epoch: 8, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0326513
	speed: 0.3096s/iter; left time: 13327.8933s
	iters: 200, epoch: 9 | loss: 0.0122877
	speed: 0.0683s/iter; left time: 2932.4399s
	iters: 300, epoch: 9 | loss: 0.2172995
	speed: 0.0716s/iter; left time: 3068.2723s
	iters: 400, epoch: 9 | loss: 0.1106228
	speed: 0.0716s/iter; left time: 3061.4865s
Epoch: 9 cost time: 33.29358267784119
Epoch: 9, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.317 Vali Acc: 0.932 Test Loss: 0.317 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0024989
	speed: 0.3142s/iter; left time: 13378.5535s
	iters: 200, epoch: 10 | loss: 0.2592489
	speed: 0.0682s/iter; left time: 2896.2356s
	iters: 300, epoch: 10 | loss: 0.0639002
	speed: 0.0739s/iter; left time: 3133.9122s
	iters: 400, epoch: 10 | loss: 0.1479787
	speed: 0.0751s/iter; left time: 3175.7741s
Epoch: 10 cost time: 34.22643733024597
Epoch: 10, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.227 Vali Acc: 0.951 Test Loss: 0.227 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7034186
	speed: 0.3072s/iter; left time: 12937.9039s
	iters: 200, epoch: 11 | loss: 0.0365378
	speed: 0.0680s/iter; left time: 2858.5273s
	iters: 300, epoch: 11 | loss: 0.0081046
	speed: 0.0768s/iter; left time: 3216.7147s
	iters: 400, epoch: 11 | loss: 0.0092371
	speed: 0.0710s/iter; left time: 2968.8182s
Epoch: 11 cost time: 33.82034111022949
Epoch: 11, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0038693
	speed: 0.3286s/iter; left time: 13683.6476s
	iters: 200, epoch: 12 | loss: 0.0029739
	speed: 0.0896s/iter; left time: 3720.3787s
	iters: 300, epoch: 12 | loss: 0.0106924
	speed: 0.0789s/iter; left time: 3270.8155s
	iters: 400, epoch: 12 | loss: 0.4765210
	speed: 0.0769s/iter; left time: 3179.2942s
Epoch: 12 cost time: 39.20229768753052
Epoch: 12, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
Validation loss decreased (-0.955973 --> -0.959689).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0032605
	speed: 0.3426s/iter; left time: 14104.5966s
	iters: 200, epoch: 13 | loss: 0.0029248
	speed: 0.0731s/iter; left time: 3000.4446s
	iters: 300, epoch: 13 | loss: 0.0078120
	speed: 0.0760s/iter; left time: 3112.0964s
	iters: 400, epoch: 13 | loss: 0.0139738
	speed: 0.0769s/iter; left time: 3142.5024s
Epoch: 13 cost time: 35.438860177993774
Epoch: 13, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
Validation loss decreased (-0.959689 --> -0.965407).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0712770
	speed: 0.3229s/iter; left time: 13143.0855s
	iters: 200, epoch: 14 | loss: 0.0543870
	speed: 0.0749s/iter; left time: 3041.0253s
	iters: 300, epoch: 14 | loss: 0.0019005
	speed: 0.0797s/iter; left time: 3227.8558s
	iters: 400, epoch: 14 | loss: 0.0048234
	speed: 0.0723s/iter; left time: 2922.7717s
Epoch: 14 cost time: 35.47999954223633
Epoch: 14, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0161954
	speed: 0.2986s/iter; left time: 12014.0478s
	iters: 200, epoch: 15 | loss: 0.0032556
	speed: 0.0697s/iter; left time: 2795.5906s
	iters: 300, epoch: 15 | loss: 0.1188760
	speed: 0.0690s/iter; left time: 2762.2765s
	iters: 400, epoch: 15 | loss: 0.0249537
	speed: 0.0661s/iter; left time: 2638.9057s
Epoch: 15 cost time: 32.34608554840088
Epoch: 15, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4680369
	speed: 0.2829s/iter; left time: 11249.8076s
	iters: 200, epoch: 16 | loss: 0.0038729
	speed: 0.0622s/iter; left time: 2468.3186s
	iters: 300, epoch: 16 | loss: 0.0047285
	speed: 0.0718s/iter; left time: 2840.0763s
	iters: 400, epoch: 16 | loss: 0.3488759
	speed: 0.0663s/iter; left time: 2617.0101s
Epoch: 16 cost time: 31.203855752944946
Epoch: 16, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0126545
	speed: 0.3142s/iter; left time: 12348.6788s
	iters: 200, epoch: 17 | loss: 0.0359311
	speed: 0.0762s/iter; left time: 2985.0429s
	iters: 300, epoch: 17 | loss: 0.0159589
	speed: 0.0721s/iter; left time: 2820.7669s
	iters: 400, epoch: 17 | loss: 0.0348187
	speed: 0.0688s/iter; left time: 2682.1819s
Epoch: 17 cost time: 34.718735218048096
Epoch: 17, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.1746731
	speed: 0.2910s/iter; left time: 11297.5296s
	iters: 200, epoch: 18 | loss: 0.0053100
	speed: 0.0685s/iter; left time: 2653.4535s
	iters: 300, epoch: 18 | loss: 0.0107733
	speed: 0.0673s/iter; left time: 2598.2947s
	iters: 400, epoch: 18 | loss: 0.0017299
	speed: 0.0684s/iter; left time: 2636.6834s
Epoch: 18 cost time: 32.177324295043945
Epoch: 18, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0074504
	speed: 0.3067s/iter; left time: 11765.0321s
	iters: 200, epoch: 19 | loss: 0.0020770
	speed: 0.0673s/iter; left time: 2574.6977s
	iters: 300, epoch: 19 | loss: 0.0014932
	speed: 0.0743s/iter; left time: 2833.9862s
	iters: 400, epoch: 19 | loss: 0.3180782
	speed: 0.0684s/iter; left time: 2602.8805s
Epoch: 19 cost time: 32.61359524726868
Epoch: 19, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0035991
	speed: 0.2932s/iter; left time: 11108.5256s
	iters: 200, epoch: 20 | loss: 0.0112077
	speed: 0.0668s/iter; left time: 2526.1271s
	iters: 300, epoch: 20 | loss: 0.0013765
	speed: 0.0669s/iter; left time: 2523.3283s
	iters: 400, epoch: 20 | loss: 0.5888582
	speed: 0.0731s/iter; left time: 2746.8641s
Epoch: 20 cost time: 32.77891826629639
Epoch: 20, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2374570
	speed: 0.3216s/iter; left time: 12036.1087s
	iters: 200, epoch: 21 | loss: 0.0021997
	speed: 0.0695s/iter; left time: 2593.3518s
	iters: 300, epoch: 21 | loss: 0.0064176
	speed: 0.0703s/iter; left time: 2617.9152s
	iters: 400, epoch: 21 | loss: 0.0046366
	speed: 0.0753s/iter; left time: 2795.7453s
Epoch: 21 cost time: 34.279727935791016
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2996364
	speed: 0.3275s/iter; left time: 12100.0984s
	iters: 200, epoch: 22 | loss: 0.1202092
	speed: 0.0733s/iter; left time: 2699.8302s
	iters: 300, epoch: 22 | loss: 0.2969337
	speed: 0.0706s/iter; left time: 2595.5956s
	iters: 400, epoch: 22 | loss: 0.0770503
	speed: 0.0703s/iter; left time: 2577.7539s
Epoch: 22 cost time: 33.81813931465149
Epoch: 22, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
Validation loss decreased (-0.965407 --> -0.965693).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0044320
	speed: 0.3085s/iter; left time: 11256.0601s
	iters: 200, epoch: 23 | loss: 0.0011059
	speed: 0.0685s/iter; left time: 2490.7075s
	iters: 300, epoch: 23 | loss: 0.0061325
	speed: 0.0696s/iter; left time: 2525.5411s
	iters: 400, epoch: 23 | loss: 0.0020989
	speed: 0.0689s/iter; left time: 2493.7772s
Epoch: 23 cost time: 32.374940156936646
Epoch: 23, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0006058
	speed: 0.2937s/iter; left time: 10579.1100s
	iters: 200, epoch: 24 | loss: 0.0158558
	speed: 0.0644s/iter; left time: 2313.9118s
	iters: 300, epoch: 24 | loss: 0.1042568
	speed: 0.0635s/iter; left time: 2272.7674s
	iters: 400, epoch: 24 | loss: 0.0049265
	speed: 0.0709s/iter; left time: 2532.4780s
Epoch: 24 cost time: 32.31057691574097
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0035232
	speed: 0.2869s/iter; left time: 10198.2066s
	iters: 200, epoch: 25 | loss: 0.0032454
	speed: 0.0669s/iter; left time: 2373.0160s
	iters: 300, epoch: 25 | loss: 0.0195262
	speed: 0.0639s/iter; left time: 2257.8076s
	iters: 400, epoch: 25 | loss: 0.0017950
	speed: 0.0692s/iter; left time: 2439.6832s
Epoch: 25 cost time: 31.817604780197144
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.966837).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0451103
	speed: 0.3081s/iter; left time: 10807.6953s
	iters: 200, epoch: 26 | loss: 0.4223986
	speed: 0.0657s/iter; left time: 2297.7212s
	iters: 300, epoch: 26 | loss: 0.0073577
	speed: 0.0614s/iter; left time: 2141.5563s
	iters: 400, epoch: 26 | loss: 0.0132025
	speed: 0.0623s/iter; left time: 2167.2090s
Epoch: 26 cost time: 30.79138970375061
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0190041
	speed: 0.2871s/iter; left time: 9935.9068s
	iters: 200, epoch: 27 | loss: 0.0014679
	speed: 0.0618s/iter; left time: 2131.7403s
	iters: 300, epoch: 27 | loss: 0.0189199
	speed: 0.0646s/iter; left time: 2221.8635s
	iters: 400, epoch: 27 | loss: 0.0043688
	speed: 0.0663s/iter; left time: 2275.6849s
Epoch: 27 cost time: 31.159470796585083
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0138333
	speed: 0.3011s/iter; left time: 10280.5291s
	iters: 200, epoch: 28 | loss: 0.1228970
	speed: 0.0642s/iter; left time: 2185.0410s
	iters: 300, epoch: 28 | loss: 0.0018582
	speed: 0.0636s/iter; left time: 2158.1199s
	iters: 400, epoch: 28 | loss: 0.0248113
	speed: 0.0655s/iter; left time: 2214.7601s
Epoch: 28 cost time: 31.36313033103943
Epoch: 28, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.966837 --> -0.971697).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0080688
	speed: 0.2859s/iter; left time: 9625.3186s
	iters: 200, epoch: 29 | loss: 0.0017995
	speed: 0.0665s/iter; left time: 2232.5487s
	iters: 300, epoch: 29 | loss: 0.0193748
	speed: 0.0714s/iter; left time: 2389.5112s
	iters: 400, epoch: 29 | loss: 0.0029811
	speed: 0.0758s/iter; left time: 2530.9201s
Epoch: 29 cost time: 33.671833753585815
Epoch: 29, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.955 Test Loss: 0.219 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0589867
	speed: 0.3244s/iter; left time: 10769.6107s
	iters: 200, epoch: 30 | loss: 0.0039604
	speed: 0.0745s/iter; left time: 2464.4383s
	iters: 300, epoch: 30 | loss: 0.0025475
	speed: 0.0716s/iter; left time: 2362.4713s
	iters: 400, epoch: 30 | loss: 0.0037240
	speed: 0.0734s/iter; left time: 2415.1360s
Epoch: 30 cost time: 34.84645748138428
Epoch: 30, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0046790
	speed: 0.3125s/iter; left time: 10229.4155s
	iters: 200, epoch: 31 | loss: 0.0010044
	speed: 0.0653s/iter; left time: 2131.2718s
	iters: 300, epoch: 31 | loss: 0.0829541
	speed: 0.0677s/iter; left time: 2201.8280s
	iters: 400, epoch: 31 | loss: 0.0038431
	speed: 0.0717s/iter; left time: 2326.5720s
Epoch: 31 cost time: 32.303210496902466
Epoch: 31, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0214945
	speed: 0.2942s/iter; left time: 9492.5927s
	iters: 200, epoch: 32 | loss: 0.0075183
	speed: 0.0617s/iter; left time: 1985.1049s
	iters: 300, epoch: 32 | loss: 0.0274278
	speed: 0.0688s/iter; left time: 2206.1933s
	iters: 400, epoch: 32 | loss: 0.0005774
	speed: 0.0699s/iter; left time: 2235.6109s
Epoch: 32 cost time: 31.62826895713806
Epoch: 32, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0542483
	speed: 0.3165s/iter; left time: 10061.9495s
	iters: 200, epoch: 33 | loss: 0.0094348
	speed: 0.0709s/iter; left time: 2246.6100s
	iters: 300, epoch: 33 | loss: 0.0022127
	speed: 0.0708s/iter; left time: 2235.3988s
	iters: 400, epoch: 33 | loss: 0.1163519
	speed: 0.0681s/iter; left time: 2143.4022s
Epoch: 33 cost time: 33.29189372062683
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0026364
	speed: 0.2988s/iter; left time: 9358.6003s
	iters: 200, epoch: 34 | loss: 0.0009359
	speed: 0.0693s/iter; left time: 2162.5267s
	iters: 300, epoch: 34 | loss: 0.0024870
	speed: 0.0634s/iter; left time: 1973.1673s
	iters: 400, epoch: 34 | loss: 0.6306645
	speed: 0.0641s/iter; left time: 1988.5911s
Epoch: 34 cost time: 31.511976718902588
Epoch: 34, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.971697 --> -0.975127).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0014296
	speed: 0.2928s/iter; left time: 9033.1061s
	iters: 200, epoch: 35 | loss: 0.0474342
	speed: 0.0729s/iter; left time: 2240.6961s
	iters: 300, epoch: 35 | loss: 0.0179564
	speed: 0.0663s/iter; left time: 2032.1139s
	iters: 400, epoch: 35 | loss: 0.0069891
	speed: 0.0713s/iter; left time: 2177.7007s
Epoch: 35 cost time: 33.278010845184326
Epoch: 35, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0455734
	speed: 0.2522s/iter; left time: 7663.0631s
	iters: 200, epoch: 36 | loss: 0.0008875
	speed: 0.0611s/iter; left time: 1849.1949s
	iters: 300, epoch: 36 | loss: 0.0015235
	speed: 0.0662s/iter; left time: 1998.4375s
	iters: 400, epoch: 36 | loss: 0.0073705
	speed: 0.0666s/iter; left time: 2004.2197s
Epoch: 36 cost time: 30.46971893310547
Epoch: 36, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.255 Vali Acc: 0.957 Test Loss: 0.255 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0019764
	speed: 0.2867s/iter; left time: 8576.6231s
	iters: 200, epoch: 37 | loss: 0.0014760
	speed: 0.0762s/iter; left time: 2271.5208s
	iters: 300, epoch: 37 | loss: 0.0012282
	speed: 0.0731s/iter; left time: 2172.4156s
	iters: 400, epoch: 37 | loss: 0.0038872
	speed: 0.0724s/iter; left time: 2145.2784s
Epoch: 37 cost time: 35.00987267494202
Epoch: 37, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0008007
	speed: 0.3166s/iter; left time: 9322.8082s
	iters: 200, epoch: 38 | loss: 0.0468576
	speed: 0.0780s/iter; left time: 2287.7187s
	iters: 300, epoch: 38 | loss: 0.0010445
	speed: 0.0760s/iter; left time: 2221.8152s
	iters: 400, epoch: 38 | loss: 0.0062624
	speed: 0.0673s/iter; left time: 1961.6404s
Epoch: 38 cost time: 34.813579082489014
Epoch: 38, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0005099
	speed: 0.3032s/iter; left time: 8787.2208s
	iters: 200, epoch: 39 | loss: 0.0018538
	speed: 0.0678s/iter; left time: 1957.3067s
	iters: 300, epoch: 39 | loss: 0.0008123
	speed: 0.0792s/iter; left time: 2278.0182s
	iters: 400, epoch: 39 | loss: 0.0067573
	speed: 0.0736s/iter; left time: 2109.7857s
Epoch: 39 cost time: 34.62206315994263
Epoch: 39, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.2601743
	speed: 0.3090s/iter; left time: 8810.3680s
	iters: 200, epoch: 40 | loss: 0.0025054
	speed: 0.0698s/iter; left time: 1984.3090s
	iters: 300, epoch: 40 | loss: 0.0014501
	speed: 0.0783s/iter; left time: 2216.2170s
	iters: 400, epoch: 40 | loss: 0.0412251
	speed: 0.0709s/iter; left time: 2000.1924s
Epoch: 40 cost time: 33.91164207458496
Epoch: 40, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.947 Test Loss: 0.265 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0142062
	speed: 0.2885s/iter; left time: 8090.4947s
	iters: 200, epoch: 41 | loss: 0.0017873
	speed: 0.0659s/iter; left time: 1840.5278s
	iters: 300, epoch: 41 | loss: 0.0006332
	speed: 0.0677s/iter; left time: 1884.1331s
	iters: 400, epoch: 41 | loss: 0.1362582
	speed: 0.0741s/iter; left time: 2056.6175s
Epoch: 41 cost time: 32.383220195770264
Epoch: 41, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0027075
	speed: 0.3003s/iter; left time: 8279.5360s
	iters: 200, epoch: 42 | loss: 0.0076937
	speed: 0.0670s/iter; left time: 1840.2885s
	iters: 300, epoch: 42 | loss: 0.0021062
	speed: 0.0713s/iter; left time: 1951.5644s
	iters: 400, epoch: 42 | loss: 0.0029315
	speed: 0.0702s/iter; left time: 1914.2699s
Epoch: 42 cost time: 33.28250789642334
Epoch: 42, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0026342
	speed: 0.2923s/iter; left time: 7921.1918s
	iters: 200, epoch: 43 | loss: 0.0110017
	speed: 0.0674s/iter; left time: 1820.5576s
	iters: 300, epoch: 43 | loss: 0.0211825
	speed: 0.0684s/iter; left time: 1840.0290s
	iters: 400, epoch: 43 | loss: 0.0011233
	speed: 0.0697s/iter; left time: 1869.0377s
Epoch: 43 cost time: 32.137874603271484
Epoch: 43, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0037371
	speed: 0.3081s/iter; left time: 8204.8979s
	iters: 200, epoch: 44 | loss: 0.0020283
	speed: 0.0653s/iter; left time: 1733.9681s
	iters: 300, epoch: 44 | loss: 0.5499108
	speed: 0.0677s/iter; left time: 1788.4108s
	iters: 400, epoch: 44 | loss: 0.0025895
	speed: 0.0695s/iter; left time: 1830.2453s
Epoch: 44 cost time: 32.688098669052124
Epoch: 44, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.975127 --> -0.975127).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0589827
	speed: 0.2939s/iter; left time: 7688.9024s
	iters: 200, epoch: 45 | loss: 0.0276010
	speed: 0.0684s/iter; left time: 1782.8466s
	iters: 300, epoch: 45 | loss: 0.0027533
	speed: 0.0693s/iter; left time: 1799.9203s
	iters: 400, epoch: 45 | loss: 0.0019383
	speed: 0.0660s/iter; left time: 1706.8120s
Epoch: 45 cost time: 31.688429355621338
Epoch: 45, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0012601
	speed: 0.3047s/iter; left time: 7830.4073s
	iters: 200, epoch: 46 | loss: 0.0013475
	speed: 0.0745s/iter; left time: 1908.0296s
	iters: 300, epoch: 46 | loss: 0.0013405
	speed: 0.0732s/iter; left time: 1866.5945s
	iters: 400, epoch: 46 | loss: 0.0002861
	speed: 0.0722s/iter; left time: 1834.1507s
Epoch: 46 cost time: 34.98738241195679
Epoch: 46, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0005733
	speed: 0.3207s/iter; left time: 8091.0250s
	iters: 200, epoch: 47 | loss: 0.0011095
	speed: 0.0727s/iter; left time: 1827.8627s
	iters: 300, epoch: 47 | loss: 0.0010125
	speed: 0.0711s/iter; left time: 1780.3660s
	iters: 400, epoch: 47 | loss: 0.0029862
	speed: 0.0703s/iter; left time: 1751.3783s
Epoch: 47 cost time: 34.33704972267151
Epoch: 47, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0005883
	speed: 0.2946s/iter; left time: 7294.3441s
	iters: 200, epoch: 48 | loss: 0.0024941
	speed: 0.0710s/iter; left time: 1751.9137s
	iters: 300, epoch: 48 | loss: 0.0012289
	speed: 0.0738s/iter; left time: 1812.4526s
	iters: 400, epoch: 48 | loss: 0.0018778
	speed: 0.0702s/iter; left time: 1716.1386s
Epoch: 48 cost time: 33.28722333908081
Epoch: 48, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.0002477
	speed: 0.3147s/iter; left time: 7642.7980s
	iters: 200, epoch: 49 | loss: 0.0016365
	speed: 0.0662s/iter; left time: 1601.9211s
	iters: 300, epoch: 49 | loss: 0.0004360
	speed: 0.0632s/iter; left time: 1521.4862s
	iters: 400, epoch: 49 | loss: 0.0035166
	speed: 0.0684s/iter; left time: 1641.1445s
Epoch: 49 cost time: 31.41725468635559
Epoch: 49, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.260 Vali Acc: 0.955 Test Loss: 0.260 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.0009568
	speed: 0.2842s/iter; left time: 6770.3483s
	iters: 200, epoch: 50 | loss: 0.0009863
	speed: 0.0683s/iter; left time: 1620.7231s
	iters: 300, epoch: 50 | loss: 0.0077478
	speed: 0.0648s/iter; left time: 1529.4839s
	iters: 400, epoch: 50 | loss: 0.0019359
	speed: 0.0699s/iter; left time: 1643.2172s
Epoch: 50 cost time: 32.17167854309082
Epoch: 50, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.0024173
	speed: 0.2891s/iter; left time: 6750.5722s
	iters: 200, epoch: 51 | loss: 0.1304468
	speed: 0.0684s/iter; left time: 1589.6309s
	iters: 300, epoch: 51 | loss: 0.0023193
	speed: 0.0661s/iter; left time: 1530.2534s
	iters: 400, epoch: 51 | loss: 0.0764535
	speed: 0.0663s/iter; left time: 1528.9481s
Epoch: 51 cost time: 31.170652389526367
Epoch: 51, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.0004090
	speed: 0.3054s/iter; left time: 6987.1629s
	iters: 200, epoch: 52 | loss: 0.0006557
	speed: 0.0681s/iter; left time: 1550.8791s
	iters: 300, epoch: 52 | loss: 0.0013725
	speed: 0.0679s/iter; left time: 1539.8651s
	iters: 400, epoch: 52 | loss: 0.0009231
	speed: 0.0712s/iter; left time: 1606.9867s
Epoch: 52 cost time: 33.56995368003845
Epoch: 52, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.0118860
	speed: 0.3031s/iter; left time: 6793.9323s
	iters: 200, epoch: 53 | loss: 0.0013434
	speed: 0.0716s/iter; left time: 1598.0811s
	iters: 300, epoch: 53 | loss: 0.0004008
	speed: 0.0703s/iter; left time: 1560.4797s
	iters: 400, epoch: 53 | loss: 0.0002597
	speed: 0.0667s/iter; left time: 1475.6239s
Epoch: 53 cost time: 33.37518262863159
Epoch: 53, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 0.4913544
	speed: 0.2934s/iter; left time: 6438.2700s
	iters: 200, epoch: 54 | loss: 0.0004270
	speed: 0.0627s/iter; left time: 1369.8719s
	iters: 300, epoch: 54 | loss: 0.0017126
	speed: 0.0674s/iter; left time: 1465.6413s
	iters: 400, epoch: 54 | loss: 0.0243961
	speed: 0.0641s/iter; left time: 1388.2250s
Epoch: 54 cost time: 30.26165533065796
Epoch: 54, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 1402490
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9464602
	speed: 0.0981s/iter; left time: 4593.3812s
	iters: 200, epoch: 1 | loss: 0.3840238
	speed: 0.0726s/iter; left time: 3390.4910s
	iters: 300, epoch: 1 | loss: 0.2823431
	speed: 0.0714s/iter; left time: 3326.6899s
	iters: 400, epoch: 1 | loss: 0.6243637
	speed: 0.0729s/iter; left time: 3389.6501s
Epoch: 1 cost time: 36.70316791534424
Epoch: 1, Steps: 469 | Train Loss: 0.591 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
Validation loss decreased (inf --> -0.915092).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1705381
	speed: 0.3124s/iter; left time: 14475.5169s
	iters: 200, epoch: 2 | loss: 0.1520350
	speed: 0.0711s/iter; left time: 3288.4907s
	iters: 300, epoch: 2 | loss: 0.3224072
	speed: 0.0682s/iter; left time: 3146.5664s
	iters: 400, epoch: 2 | loss: 0.0833881
	speed: 0.0712s/iter; left time: 3278.9084s
Epoch: 2 cost time: 32.93246579170227
Epoch: 2, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0370241
	speed: 0.2764s/iter; left time: 12675.4432s
	iters: 200, epoch: 3 | loss: 0.0450469
	speed: 0.0744s/iter; left time: 3407.0168s
	iters: 300, epoch: 3 | loss: 0.6829832
	speed: 0.0748s/iter; left time: 3414.7510s
	iters: 400, epoch: 3 | loss: 0.0189721
	speed: 0.0646s/iter; left time: 2943.6883s
Epoch: 3 cost time: 33.102262020111084
Epoch: 3, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.915092 --> -0.970553).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0085756
	speed: 0.2899s/iter; left time: 13161.3925s
	iters: 200, epoch: 4 | loss: 0.0622224
	speed: 0.0646s/iter; left time: 2924.5799s
	iters: 300, epoch: 4 | loss: 0.0231695
	speed: 0.0654s/iter; left time: 2956.6449s
	iters: 400, epoch: 4 | loss: 0.0328689
	speed: 0.0700s/iter; left time: 3156.6047s
Epoch: 4 cost time: 31.573336124420166
Epoch: 4, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1308275
	speed: 0.3038s/iter; left time: 13646.4773s
	iters: 200, epoch: 5 | loss: 0.0090410
	speed: 0.0727s/iter; left time: 3257.0149s
	iters: 300, epoch: 5 | loss: 0.1045480
	speed: 0.0674s/iter; left time: 3013.6381s
	iters: 400, epoch: 5 | loss: 0.0091417
	speed: 0.0640s/iter; left time: 2857.1371s
Epoch: 5 cost time: 33.510557889938354
Epoch: 5, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.247 Vali Acc: 0.938 Test Loss: 0.247 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0534847
	speed: 0.3067s/iter; left time: 13634.5727s
	iters: 200, epoch: 6 | loss: 0.0282256
	speed: 0.0746s/iter; left time: 3310.6091s
	iters: 300, epoch: 6 | loss: 0.1854904
	speed: 0.0697s/iter; left time: 3083.0814s
	iters: 400, epoch: 6 | loss: 0.0768244
	speed: 0.0652s/iter; left time: 2878.3061s
Epoch: 6 cost time: 32.235170125961304
Epoch: 6, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1800000
	speed: 0.3015s/iter; left time: 13264.0550s
	iters: 200, epoch: 7 | loss: 0.1434588
	speed: 0.0726s/iter; left time: 3186.9087s
	iters: 300, epoch: 7 | loss: 0.0052729
	speed: 0.0725s/iter; left time: 3174.2129s
	iters: 400, epoch: 7 | loss: 0.4008148
	speed: 0.0791s/iter; left time: 3454.4274s
Epoch: 7 cost time: 34.931811571121216
Epoch: 7, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0292375
	speed: 0.2912s/iter; left time: 12670.3025s
	iters: 200, epoch: 8 | loss: 0.8518942
	speed: 0.0684s/iter; left time: 2970.6875s
	iters: 300, epoch: 8 | loss: 0.0045348
	speed: 0.0697s/iter; left time: 3018.9245s
	iters: 400, epoch: 8 | loss: 0.0458006
	speed: 0.0698s/iter; left time: 3014.7311s
Epoch: 8 cost time: 32.90374159812927
Epoch: 8, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.258 Vali Acc: 0.934 Test Loss: 0.258 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0050037
	speed: 0.3173s/iter; left time: 13658.9569s
	iters: 200, epoch: 9 | loss: 0.0029373
	speed: 0.0727s/iter; left time: 3123.6946s
	iters: 300, epoch: 9 | loss: 0.0268092
	speed: 0.0732s/iter; left time: 3137.1462s
	iters: 400, epoch: 9 | loss: 0.0062229
	speed: 0.0716s/iter; left time: 3061.3483s
Epoch: 9 cost time: 34.565584897994995
Epoch: 9, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.231 Vali Acc: 0.936 Test Loss: 0.231 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1093443
	speed: 0.3242s/iter; left time: 13802.4537s
	iters: 200, epoch: 10 | loss: 0.0163600
	speed: 0.0711s/iter; left time: 3018.2042s
	iters: 300, epoch: 10 | loss: 0.5218476
	speed: 0.0698s/iter; left time: 2956.5304s
	iters: 400, epoch: 10 | loss: 0.0629429
	speed: 0.0749s/iter; left time: 3165.7824s
Epoch: 10 cost time: 34.28955268859863
Epoch: 10, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2555346
	speed: 0.3311s/iter; left time: 13944.2818s
	iters: 200, epoch: 11 | loss: 0.0409606
	speed: 0.0702s/iter; left time: 2948.3770s
	iters: 300, epoch: 11 | loss: 0.0883893
	speed: 0.0648s/iter; left time: 2717.2777s
	iters: 400, epoch: 11 | loss: 0.0032713
	speed: 0.0648s/iter; left time: 2709.5413s
Epoch: 11 cost time: 32.5243604183197
Epoch: 11, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0478683
	speed: 0.3239s/iter; left time: 13488.9986s
	iters: 200, epoch: 12 | loss: 0.0126209
	speed: 0.0688s/iter; left time: 2858.6574s
	iters: 300, epoch: 12 | loss: 0.2000521
	speed: 0.0687s/iter; left time: 2848.1127s
	iters: 400, epoch: 12 | loss: 0.0526823
	speed: 0.0664s/iter; left time: 2744.6099s
Epoch: 12 cost time: 32.19117498397827
Epoch: 12, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0142860
	speed: 0.2909s/iter; left time: 11975.7426s
	iters: 200, epoch: 13 | loss: 0.0677937
	speed: 0.0674s/iter; left time: 2769.8722s
	iters: 300, epoch: 13 | loss: 0.4338654
	speed: 0.0710s/iter; left time: 2908.6012s
	iters: 400, epoch: 13 | loss: 0.0624154
	speed: 0.0670s/iter; left time: 2737.4323s
Epoch: 13 cost time: 33.40990734100342
Epoch: 13, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9705546026300743
model parameter : 1402298
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5951171
	speed: 0.0886s/iter; left time: 4146.0190s
	iters: 200, epoch: 1 | loss: 0.2242859
	speed: 0.0628s/iter; left time: 2934.4054s
	iters: 300, epoch: 1 | loss: 0.3359554
	speed: 0.0629s/iter; left time: 2933.1820s
	iters: 400, epoch: 1 | loss: 0.3816048
	speed: 0.0597s/iter; left time: 2776.0943s
Epoch: 1 cost time: 32.08764696121216
Epoch: 1, Steps: 469 | Train Loss: 0.585 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (inf --> -0.875353).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1490022
	speed: 0.2541s/iter; left time: 11774.0050s
	iters: 200, epoch: 2 | loss: 0.1450339
	speed: 0.0638s/iter; left time: 2950.2957s
	iters: 300, epoch: 2 | loss: 0.0395144
	speed: 0.0699s/iter; left time: 3223.8196s
	iters: 400, epoch: 2 | loss: 0.1209320
	speed: 0.0677s/iter; left time: 3115.5439s
Epoch: 2 cost time: 32.16608166694641
Epoch: 2, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.251 Vali Acc: 0.918 Test Loss: 0.251 Test Acc: 0.918
Validation loss decreased (-0.875353 --> -0.918236).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1923364
	speed: 0.3181s/iter; left time: 14589.5082s
	iters: 200, epoch: 3 | loss: 0.1352496
	speed: 0.0755s/iter; left time: 3455.7328s
	iters: 300, epoch: 3 | loss: 0.0121550
	speed: 0.0687s/iter; left time: 3138.0907s
	iters: 400, epoch: 3 | loss: 0.1350498
	speed: 0.0663s/iter; left time: 3020.0045s
Epoch: 3 cost time: 34.021933794021606
Epoch: 3, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.320 Vali Acc: 0.915 Test Loss: 0.320 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1563356
	speed: 0.2986s/iter; left time: 13556.0534s
	iters: 200, epoch: 4 | loss: 0.0678172
	speed: 0.0638s/iter; left time: 2888.0734s
	iters: 300, epoch: 4 | loss: 0.0117726
	speed: 0.0657s/iter; left time: 2969.6164s
	iters: 400, epoch: 4 | loss: 0.4149402
	speed: 0.0731s/iter; left time: 3294.1474s
Epoch: 4 cost time: 32.331472396850586
Epoch: 4, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
Validation loss decreased (-0.918236 --> -0.940249).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3745919
	speed: 0.3127s/iter; left time: 14049.6101s
	iters: 200, epoch: 5 | loss: 0.1467156
	speed: 0.0720s/iter; left time: 3225.5220s
	iters: 300, epoch: 5 | loss: 0.0552053
	speed: 0.0688s/iter; left time: 3078.5877s
	iters: 400, epoch: 5 | loss: 0.0051887
	speed: 0.0654s/iter; left time: 2919.2829s
Epoch: 5 cost time: 32.349786043167114
Epoch: 5, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0109914
	speed: 0.2826s/iter; left time: 12564.4706s
	iters: 200, epoch: 6 | loss: 0.1688178
	speed: 0.0589s/iter; left time: 2611.6649s
	iters: 300, epoch: 6 | loss: 0.1200248
	speed: 0.0657s/iter; left time: 2909.5767s
	iters: 400, epoch: 6 | loss: 0.2733327
	speed: 0.0762s/iter; left time: 3363.1509s
Epoch: 6 cost time: 31.464145183563232
Epoch: 6, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
Validation loss decreased (-0.940249 --> -0.949398).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2512192
	speed: 0.2859s/iter; left time: 12577.5191s
	iters: 200, epoch: 7 | loss: 0.0735230
	speed: 0.0655s/iter; left time: 2872.8125s
	iters: 300, epoch: 7 | loss: 0.1638247
	speed: 0.0706s/iter; left time: 3092.1594s
	iters: 400, epoch: 7 | loss: 0.0097095
	speed: 0.0692s/iter; left time: 3024.3139s
Epoch: 7 cost time: 32.50497484207153
Epoch: 7, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
Validation loss decreased (-0.949398 --> -0.954258).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2140512
	speed: 0.3080s/iter; left time: 13403.3267s
	iters: 200, epoch: 8 | loss: 0.0236693
	speed: 0.0630s/iter; left time: 2734.1810s
	iters: 300, epoch: 8 | loss: 0.0061027
	speed: 0.0637s/iter; left time: 2760.3727s
	iters: 400, epoch: 8 | loss: 0.1059611
	speed: 0.0650s/iter; left time: 2808.6221s
Epoch: 8 cost time: 30.54293394088745
Epoch: 8, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0506821
	speed: 0.2909s/iter; left time: 12522.0095s
	iters: 200, epoch: 9 | loss: 0.0246701
	speed: 0.0662s/iter; left time: 2845.1018s
	iters: 300, epoch: 9 | loss: 0.0943421
	speed: 0.0648s/iter; left time: 2777.9543s
	iters: 400, epoch: 9 | loss: 0.0192813
	speed: 0.0649s/iter; left time: 2772.4382s
Epoch: 9 cost time: 31.074375867843628
Epoch: 9, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.954258 --> -0.963120).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0123450
	speed: 0.3043s/iter; left time: 12956.4439s
	iters: 200, epoch: 10 | loss: 0.3145489
	speed: 0.0615s/iter; left time: 2613.6930s
	iters: 300, epoch: 10 | loss: 0.0205540
	speed: 0.0634s/iter; left time: 2688.5337s
	iters: 400, epoch: 10 | loss: 0.5498558
	speed: 0.0637s/iter; left time: 2695.2362s
Epoch: 10 cost time: 30.20982813835144
Epoch: 10, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0063506
	speed: 0.2881s/iter; left time: 12131.1050s
	iters: 200, epoch: 11 | loss: 0.0187301
	speed: 0.0677s/iter; left time: 2842.1608s
	iters: 300, epoch: 11 | loss: 0.0039048
	speed: 0.0610s/iter; left time: 2557.1316s
	iters: 400, epoch: 11 | loss: 0.0303831
	speed: 0.0615s/iter; left time: 2571.0355s
Epoch: 11 cost time: 30.23749613761902
Epoch: 11, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0051725
	speed: 0.2977s/iter; left time: 12397.4475s
	iters: 200, epoch: 12 | loss: 0.4708509
	speed: 0.0668s/iter; left time: 2775.0467s
	iters: 300, epoch: 12 | loss: 0.1221189
	speed: 0.0629s/iter; left time: 2607.4145s
	iters: 400, epoch: 12 | loss: 0.0684611
	speed: 0.0659s/iter; left time: 2723.5024s
Epoch: 12 cost time: 31.65104055404663
Epoch: 12, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0037468
	speed: 0.2924s/iter; left time: 12039.3470s
	iters: 200, epoch: 13 | loss: 0.0440229
	speed: 0.0687s/iter; left time: 2821.9270s
	iters: 300, epoch: 13 | loss: 0.0289797
	speed: 0.0659s/iter; left time: 2701.5498s
	iters: 400, epoch: 13 | loss: 0.0094653
	speed: 0.0639s/iter; left time: 2610.1587s
Epoch: 13 cost time: 31.12526226043701
Epoch: 13, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0030978
	speed: 0.3078s/iter; left time: 12528.4444s
	iters: 200, epoch: 14 | loss: 0.0046747
	speed: 0.0679s/iter; left time: 2756.8216s
	iters: 300, epoch: 14 | loss: 0.0050576
	speed: 0.0678s/iter; left time: 2747.9750s
	iters: 400, epoch: 14 | loss: 0.0251463
	speed: 0.0681s/iter; left time: 2751.5185s
Epoch: 14 cost time: 32.57104206085205
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0390809
	speed: 0.3160s/iter; left time: 12714.2865s
	iters: 200, epoch: 15 | loss: 0.0666536
	speed: 0.0668s/iter; left time: 2682.6748s
	iters: 300, epoch: 15 | loss: 0.0070842
	speed: 0.0683s/iter; left time: 2733.5497s
	iters: 400, epoch: 15 | loss: 0.9402152
	speed: 0.0680s/iter; left time: 2714.4226s
Epoch: 15 cost time: 31.500760793685913
Epoch: 15, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0778275
	speed: 0.3080s/iter; left time: 12248.2609s
	iters: 200, epoch: 16 | loss: 0.0038839
	speed: 0.0642s/iter; left time: 2548.3366s
	iters: 300, epoch: 16 | loss: 0.0244641
	speed: 0.0687s/iter; left time: 2717.4968s
	iters: 400, epoch: 16 | loss: 0.1004345
	speed: 0.0679s/iter; left time: 2679.2224s
Epoch: 16 cost time: 32.42997598648071
Epoch: 16, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3957434
	speed: 0.3068s/iter; left time: 12056.7767s
	iters: 200, epoch: 17 | loss: 0.1316527
	speed: 0.0640s/iter; left time: 2508.1585s
	iters: 300, epoch: 17 | loss: 0.0108603
	speed: 0.0674s/iter; left time: 2636.4821s
	iters: 400, epoch: 17 | loss: 0.0054616
	speed: 0.0668s/iter; left time: 2604.6617s
Epoch: 17 cost time: 31.414769411087036
Epoch: 17, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0049355
	speed: 0.2901s/iter; left time: 11262.2988s
	iters: 200, epoch: 18 | loss: 0.0049521
	speed: 0.0634s/iter; left time: 2455.2901s
	iters: 300, epoch: 18 | loss: 0.0112247
	speed: 0.0607s/iter; left time: 2345.1870s
	iters: 400, epoch: 18 | loss: 0.0210670
	speed: 0.0611s/iter; left time: 2355.5778s
Epoch: 18 cost time: 29.397690296173096
Epoch: 18, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.239 Vali Acc: 0.942 Test Loss: 0.239 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0250976
	speed: 0.2950s/iter; left time: 11314.6185s
	iters: 200, epoch: 19 | loss: 0.0047511
	speed: 0.0648s/iter; left time: 2478.0804s
	iters: 300, epoch: 19 | loss: 0.3102396
	speed: 0.0673s/iter; left time: 2568.3998s
	iters: 400, epoch: 19 | loss: 0.0160868
	speed: 0.0711s/iter; left time: 2707.7018s
Epoch: 19 cost time: 31.710984230041504
Epoch: 19, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9631217838765008
model parameter : 1402106
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9630105
	speed: 0.0824s/iter; left time: 3857.1246s
	iters: 200, epoch: 1 | loss: 0.3298170
	speed: 0.0661s/iter; left time: 3087.4015s
	iters: 300, epoch: 1 | loss: 0.4595515
	speed: 0.0655s/iter; left time: 3054.4686s
	iters: 400, epoch: 1 | loss: 0.1365242
	speed: 0.0637s/iter; left time: 2963.9063s
Epoch: 1 cost time: 32.23375630378723
Epoch: 1, Steps: 469 | Train Loss: 0.631 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (inf --> -0.906229).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1436418
	speed: 0.2633s/iter; left time: 12199.4578s
	iters: 200, epoch: 2 | loss: 0.0940238
	speed: 0.0720s/iter; left time: 3329.4483s
	iters: 300, epoch: 2 | loss: 0.3491469
	speed: 0.0732s/iter; left time: 3377.0844s
	iters: 400, epoch: 2 | loss: 0.0431348
	speed: 0.0719s/iter; left time: 3310.7437s
Epoch: 2 cost time: 32.72443914413452
Epoch: 2, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.906229 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1067986
	speed: 0.2994s/iter; left time: 13729.9052s
	iters: 200, epoch: 3 | loss: 0.0324153
	speed: 0.0682s/iter; left time: 3119.4554s
	iters: 300, epoch: 3 | loss: 0.0708379
	speed: 0.0622s/iter; left time: 2841.7872s
	iters: 400, epoch: 3 | loss: 0.3559476
	speed: 0.0637s/iter; left time: 2902.4957s
Epoch: 3 cost time: 31.559677124023438
Epoch: 3, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.256 Vali Acc: 0.923 Test Loss: 0.256 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1093140
	speed: 0.2940s/iter; left time: 13344.9546s
	iters: 200, epoch: 4 | loss: 0.0109270
	speed: 0.0669s/iter; left time: 3029.0878s
	iters: 300, epoch: 4 | loss: 0.1745986
	speed: 0.0748s/iter; left time: 3382.2665s
	iters: 400, epoch: 4 | loss: 0.0119109
	speed: 0.0739s/iter; left time: 3331.1776s
Epoch: 4 cost time: 32.891663551330566
Epoch: 4, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.269 Vali Acc: 0.932 Test Loss: 0.269 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0623607
	speed: 0.3268s/iter; left time: 14683.1904s
	iters: 200, epoch: 5 | loss: 0.0044105
	speed: 0.0701s/iter; left time: 3142.6524s
	iters: 300, epoch: 5 | loss: 0.1742213
	speed: 0.0678s/iter; left time: 3032.4363s
	iters: 400, epoch: 5 | loss: 0.1625972
	speed: 0.0728s/iter; left time: 3250.6417s
Epoch: 5 cost time: 34.124634981155396
Epoch: 5, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0045084
	speed: 0.3188s/iter; left time: 14170.8257s
	iters: 200, epoch: 6 | loss: 0.0471073
	speed: 0.0682s/iter; left time: 3025.7934s
	iters: 300, epoch: 6 | loss: 0.0216395
	speed: 0.0696s/iter; left time: 3079.6167s
	iters: 400, epoch: 6 | loss: 0.0687518
	speed: 0.0679s/iter; left time: 2998.7711s
Epoch: 6 cost time: 32.62924551963806
Epoch: 6, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0512899
	speed: 0.3198s/iter; left time: 14065.9434s
	iters: 200, epoch: 7 | loss: 0.0943481
	speed: 0.0713s/iter; left time: 3129.5867s
	iters: 300, epoch: 7 | loss: 0.5170985
	speed: 0.0692s/iter; left time: 3030.2711s
	iters: 400, epoch: 7 | loss: 0.0859546
	speed: 0.0695s/iter; left time: 3037.4604s
Epoch: 7 cost time: 33.3476300239563
Epoch: 7, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0062112
	speed: 0.3074s/iter; left time: 13378.8363s
	iters: 200, epoch: 8 | loss: 0.0226573
	speed: 0.0684s/iter; left time: 2970.4510s
	iters: 300, epoch: 8 | loss: 0.0072620
	speed: 0.0620s/iter; left time: 2684.8684s
	iters: 400, epoch: 8 | loss: 0.0947921
	speed: 0.0632s/iter; left time: 2731.8204s
Epoch: 8 cost time: 31.325589656829834
Epoch: 8, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.964264 --> -0.968552).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0039957
	speed: 0.2889s/iter; left time: 12436.1548s
	iters: 200, epoch: 9 | loss: 0.1760978
	speed: 0.0645s/iter; left time: 2770.1333s
	iters: 300, epoch: 9 | loss: 0.2366962
	speed: 0.0681s/iter; left time: 2919.5023s
	iters: 400, epoch: 9 | loss: 0.0059853
	speed: 0.0722s/iter; left time: 3088.6089s
Epoch: 9 cost time: 32.16181683540344
Epoch: 9, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3722205
	speed: 0.2980s/iter; left time: 12690.3383s
	iters: 200, epoch: 10 | loss: 0.3014978
	speed: 0.0686s/iter; left time: 2915.0635s
	iters: 300, epoch: 10 | loss: 0.0180995
	speed: 0.0692s/iter; left time: 2933.9293s
	iters: 400, epoch: 10 | loss: 0.0056004
	speed: 0.0724s/iter; left time: 3062.3429s
Epoch: 10 cost time: 32.98280119895935
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0468977
	speed: 0.3096s/iter; left time: 13037.6990s
	iters: 200, epoch: 11 | loss: 0.0408165
	speed: 0.0726s/iter; left time: 3048.0461s
	iters: 300, epoch: 11 | loss: 0.0129156
	speed: 0.0652s/iter; left time: 2733.5978s
	iters: 400, epoch: 11 | loss: 0.0739599
	speed: 0.0638s/iter; left time: 2667.7793s
Epoch: 11 cost time: 32.3617889881134
Epoch: 11, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0107397
	speed: 0.2922s/iter; left time: 12168.0641s
	iters: 200, epoch: 12 | loss: 0.1248116
	speed: 0.0624s/iter; left time: 2591.5469s
	iters: 300, epoch: 12 | loss: 0.1144115
	speed: 0.0650s/iter; left time: 2693.6260s
	iters: 400, epoch: 12 | loss: 0.0094281
	speed: 0.0696s/iter; left time: 2877.6927s
Epoch: 12 cost time: 31.692359685897827
Epoch: 12, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0298023
	speed: 0.3064s/iter; left time: 12614.6016s
	iters: 200, epoch: 13 | loss: 0.0100610
	speed: 0.0702s/iter; left time: 2883.6428s
	iters: 300, epoch: 13 | loss: 0.0143678
	speed: 0.0659s/iter; left time: 2698.4549s
	iters: 400, epoch: 13 | loss: 0.2576866
	speed: 0.0618s/iter; left time: 2526.3000s
Epoch: 13 cost time: 31.495470762252808
Epoch: 13, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0124645
	speed: 0.3000s/iter; left time: 12211.9586s
	iters: 200, epoch: 14 | loss: 0.1541346
	speed: 0.0658s/iter; left time: 2670.7027s
	iters: 300, epoch: 14 | loss: 0.0241475
	speed: 0.0672s/iter; left time: 2723.5565s
	iters: 400, epoch: 14 | loss: 0.0151549
	speed: 0.0701s/iter; left time: 2833.2765s
Epoch: 14 cost time: 32.07717800140381
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0035825
	speed: 0.3041s/iter; left time: 12236.8027s
	iters: 200, epoch: 15 | loss: 0.5155604
	speed: 0.0716s/iter; left time: 2871.9244s
	iters: 300, epoch: 15 | loss: 0.1685474
	speed: 0.0752s/iter; left time: 3009.6275s
	iters: 400, epoch: 15 | loss: 0.3569682
	speed: 0.0764s/iter; left time: 3053.0268s
Epoch: 15 cost time: 35.2018563747406
Epoch: 15, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0099330
	speed: 0.3227s/iter; left time: 12834.4674s
	iters: 200, epoch: 16 | loss: 0.0164174
	speed: 0.0812s/iter; left time: 3221.3286s
	iters: 300, epoch: 16 | loss: 0.0267583
	speed: 0.0730s/iter; left time: 2889.8883s
	iters: 400, epoch: 16 | loss: 0.0235616
	speed: 0.0647s/iter; left time: 2553.1117s
Epoch: 16 cost time: 33.885072231292725
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0033799
	speed: 0.2892s/iter; left time: 11365.7579s
	iters: 200, epoch: 17 | loss: 0.0054230
	speed: 0.0682s/iter; left time: 2671.4971s
	iters: 300, epoch: 17 | loss: 0.0831678
	speed: 0.0707s/iter; left time: 2765.1196s
	iters: 400, epoch: 17 | loss: 0.0165407
	speed: 0.0715s/iter; left time: 2787.9702s
Epoch: 17 cost time: 33.71863794326782
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.280 Vali Acc: 0.936 Test Loss: 0.280 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0009282
	speed: 0.3222s/iter; left time: 12510.6332s
	iters: 200, epoch: 18 | loss: 0.1056439
	speed: 0.0707s/iter; left time: 2739.7591s
	iters: 300, epoch: 18 | loss: 0.1914225
	speed: 0.0633s/iter; left time: 2444.5257s
	iters: 400, epoch: 18 | loss: 0.0041205
	speed: 0.0622s/iter; left time: 2397.4786s
Epoch: 18 cost time: 31.240935564041138
Epoch: 18, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9685534591194969
model parameter : 940346
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0406533
	speed: 0.0811s/iter; left time: 3794.6647s
	iters: 200, epoch: 1 | loss: 0.5177291
	speed: 0.0639s/iter; left time: 2981.9167s
	iters: 300, epoch: 1 | loss: 0.2650424
	speed: 0.0688s/iter; left time: 3204.6635s
	iters: 400, epoch: 1 | loss: 0.1296007
	speed: 0.0654s/iter; left time: 3042.4044s
Epoch: 1 cost time: 32.70996809005737
Epoch: 1, Steps: 469 | Train Loss: 0.618 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
Validation loss decreased (inf --> -0.899654).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0442575
	speed: 0.2947s/iter; left time: 13655.5783s
	iters: 200, epoch: 2 | loss: 0.1612745
	speed: 0.0652s/iter; left time: 3012.2573s
	iters: 300, epoch: 2 | loss: 0.2473447
	speed: 0.0660s/iter; left time: 3043.4098s
	iters: 400, epoch: 2 | loss: 0.0753101
	speed: 0.0656s/iter; left time: 3018.9222s
Epoch: 2 cost time: 31.049776554107666
Epoch: 2, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.305 Vali Acc: 0.902 Test Loss: 0.305 Test Acc: 0.902
Validation loss decreased (-0.899654 --> -0.902227).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2738408
	speed: 0.2995s/iter; left time: 13737.4639s
	iters: 200, epoch: 3 | loss: 0.0109042
	speed: 0.0632s/iter; left time: 2892.4255s
	iters: 300, epoch: 3 | loss: 0.4982019
	speed: 0.0675s/iter; left time: 3083.8105s
	iters: 400, epoch: 3 | loss: 0.2665435
	speed: 0.0655s/iter; left time: 2984.1526s
Epoch: 3 cost time: 31.149075984954834
Epoch: 3, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.902227 --> -0.940535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0082427
	speed: 0.3025s/iter; left time: 13730.7147s
	iters: 200, epoch: 4 | loss: 0.0345004
	speed: 0.0722s/iter; left time: 3271.9312s
	iters: 300, epoch: 4 | loss: 0.0404742
	speed: 0.0719s/iter; left time: 3250.1795s
	iters: 400, epoch: 4 | loss: 0.0383335
	speed: 0.0751s/iter; left time: 3387.9302s
Epoch: 4 cost time: 33.90629816055298
Epoch: 4, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0191091
	speed: 0.2998s/iter; left time: 13467.9865s
	iters: 200, epoch: 5 | loss: 0.8719116
	speed: 0.0677s/iter; left time: 3036.1545s
	iters: 300, epoch: 5 | loss: 0.0368478
	speed: 0.0634s/iter; left time: 2836.3618s
	iters: 400, epoch: 5 | loss: 0.2028906
	speed: 0.0628s/iter; left time: 2803.1728s
Epoch: 5 cost time: 30.58307719230652
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1161545
	speed: 0.2924s/iter; left time: 12997.0483s
	iters: 200, epoch: 6 | loss: 0.0880504
	speed: 0.0681s/iter; left time: 3022.1916s
	iters: 300, epoch: 6 | loss: 0.1200998
	speed: 0.0682s/iter; left time: 3019.8364s
	iters: 400, epoch: 6 | loss: 0.0290502
	speed: 0.0689s/iter; left time: 3041.2394s
Epoch: 6 cost time: 32.10438656806946
Epoch: 6, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
Validation loss decreased (-0.940535 --> -0.955115).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1059205
	speed: 0.3179s/iter; left time: 13984.7576s
	iters: 200, epoch: 7 | loss: 0.0088778
	speed: 0.0691s/iter; left time: 3032.3488s
	iters: 300, epoch: 7 | loss: 0.0085178
	speed: 0.0693s/iter; left time: 3033.9753s
	iters: 400, epoch: 7 | loss: 0.0081599
	speed: 0.0695s/iter; left time: 3037.4483s
Epoch: 7 cost time: 33.879971981048584
Epoch: 7, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.194 Vali Acc: 0.945 Test Loss: 0.194 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0454599
	speed: 0.3217s/iter; left time: 14000.4343s
	iters: 200, epoch: 8 | loss: 0.0188233
	speed: 0.0667s/iter; left time: 2897.0873s
	iters: 300, epoch: 8 | loss: 0.0646316
	speed: 0.0694s/iter; left time: 3007.5251s
	iters: 400, epoch: 8 | loss: 0.0935220
	speed: 0.0662s/iter; left time: 2861.3855s
Epoch: 8 cost time: 31.46581792831421
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0016287
	speed: 0.3204s/iter; left time: 13793.1334s
	iters: 200, epoch: 9 | loss: 0.0086079
	speed: 0.0705s/iter; left time: 3029.9506s
	iters: 300, epoch: 9 | loss: 0.1018277
	speed: 0.0709s/iter; left time: 3036.9920s
	iters: 400, epoch: 9 | loss: 0.3711181
	speed: 0.0747s/iter; left time: 3194.9744s
Epoch: 9 cost time: 34.34399437904358
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0018927
	speed: 0.3061s/iter; left time: 13032.6806s
	iters: 200, epoch: 10 | loss: 0.1813129
	speed: 0.0700s/iter; left time: 2972.7771s
	iters: 300, epoch: 10 | loss: 0.0159976
	speed: 0.0671s/iter; left time: 2842.4486s
	iters: 400, epoch: 10 | loss: 0.0214256
	speed: 0.0638s/iter; left time: 2697.7147s
Epoch: 10 cost time: 31.161046028137207
Epoch: 10, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0271304
	speed: 0.2825s/iter; left time: 11897.1637s
	iters: 200, epoch: 11 | loss: 0.0022115
	speed: 0.0623s/iter; left time: 2615.6693s
	iters: 300, epoch: 11 | loss: 0.0051864
	speed: 0.0617s/iter; left time: 2586.1342s
	iters: 400, epoch: 11 | loss: 0.2246204
	speed: 0.0610s/iter; left time: 2552.3737s
Epoch: 11 cost time: 29.569642782211304
Epoch: 11, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0087844
	speed: 0.3030s/iter; left time: 12618.1364s
	iters: 200, epoch: 12 | loss: 0.0063380
	speed: 0.0702s/iter; left time: 2916.6065s
	iters: 300, epoch: 12 | loss: 0.0540875
	speed: 0.0729s/iter; left time: 3020.3340s
	iters: 400, epoch: 12 | loss: 0.0012949
	speed: 0.0653s/iter; left time: 2701.2488s
Epoch: 12 cost time: 32.775675773620605
Epoch: 12, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.955115 --> -0.961977).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0060044
	speed: 0.2965s/iter; left time: 12206.3235s
	iters: 200, epoch: 13 | loss: 0.0064324
	speed: 0.0674s/iter; left time: 2768.8021s
	iters: 300, epoch: 13 | loss: 0.2533254
	speed: 0.0659s/iter; left time: 2699.5891s
	iters: 400, epoch: 13 | loss: 0.0041241
	speed: 0.0660s/iter; left time: 2698.7410s
Epoch: 13 cost time: 31.23948645591736
Epoch: 13, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.260 Vali Acc: 0.929 Test Loss: 0.260 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0056410
	speed: 0.3044s/iter; left time: 12391.1233s
	iters: 200, epoch: 14 | loss: 0.0058731
	speed: 0.0659s/iter; left time: 2674.5271s
	iters: 300, epoch: 14 | loss: 0.0083983
	speed: 0.0642s/iter; left time: 2599.1362s
	iters: 400, epoch: 14 | loss: 0.0016285
	speed: 0.0655s/iter; left time: 2647.7444s
Epoch: 14 cost time: 31.720035314559937
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.257 Vali Acc: 0.951 Test Loss: 0.257 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0047408
	speed: 0.2936s/iter; left time: 11811.3645s
	iters: 200, epoch: 15 | loss: 0.0051218
	speed: 0.0682s/iter; left time: 2736.3233s
	iters: 300, epoch: 15 | loss: 0.0070118
	speed: 0.0626s/iter; left time: 2506.5192s
	iters: 400, epoch: 15 | loss: 0.0329322
	speed: 0.0612s/iter; left time: 2443.5753s
Epoch: 15 cost time: 30.379703998565674
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0053764
	speed: 0.3055s/iter; left time: 12149.9885s
	iters: 200, epoch: 16 | loss: 0.0151606
	speed: 0.0723s/iter; left time: 2869.3157s
	iters: 300, epoch: 16 | loss: 0.0966284
	speed: 0.0693s/iter; left time: 2740.1770s
	iters: 400, epoch: 16 | loss: 0.0858918
	speed: 0.0682s/iter; left time: 2689.6270s
Epoch: 16 cost time: 33.77483677864075
Epoch: 16, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.961977 --> -0.967408).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0008386
	speed: 0.2981s/iter; left time: 11713.0992s
	iters: 200, epoch: 17 | loss: 0.0076711
	speed: 0.0644s/iter; left time: 2524.6973s
	iters: 300, epoch: 17 | loss: 0.0302087
	speed: 0.0657s/iter; left time: 2570.5893s
	iters: 400, epoch: 17 | loss: 0.0999730
	speed: 0.0702s/iter; left time: 2736.9064s
Epoch: 17 cost time: 31.3297860622406
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0006756
	speed: 0.2940s/iter; left time: 11417.0617s
	iters: 200, epoch: 18 | loss: 0.0009323
	speed: 0.0679s/iter; left time: 2630.0797s
	iters: 300, epoch: 18 | loss: 0.0670292
	speed: 0.0716s/iter; left time: 2766.2014s
	iters: 400, epoch: 18 | loss: 0.1890235
	speed: 0.0695s/iter; left time: 2678.3750s
Epoch: 18 cost time: 33.347355365753174
Epoch: 18, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1054587
	speed: 0.3199s/iter; left time: 12272.9277s
	iters: 200, epoch: 19 | loss: 0.0825425
	speed: 0.0689s/iter; left time: 2634.5806s
	iters: 300, epoch: 19 | loss: 0.0007065
	speed: 0.0748s/iter; left time: 2854.7914s
	iters: 400, epoch: 19 | loss: 0.0154244
	speed: 0.0694s/iter; left time: 2639.8665s
Epoch: 19 cost time: 33.579286336898804
Epoch: 19, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0092371
	speed: 0.3302s/iter; left time: 12512.8379s
	iters: 200, epoch: 20 | loss: 0.0966812
	speed: 0.0633s/iter; left time: 2391.7541s
	iters: 300, epoch: 20 | loss: 0.0023963
	speed: 0.0670s/iter; left time: 2525.1840s
	iters: 400, epoch: 20 | loss: 0.0059855
	speed: 0.0685s/iter; left time: 2573.5090s
Epoch: 20 cost time: 31.88246989250183
Epoch: 20, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.315 Vali Acc: 0.951 Test Loss: 0.315 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0023255
	speed: 0.3111s/iter; left time: 11643.2575s
	iters: 200, epoch: 21 | loss: 0.0015088
	speed: 0.0672s/iter; left time: 2509.1811s
	iters: 300, epoch: 21 | loss: 0.0007008
	speed: 0.0713s/iter; left time: 2655.2694s
	iters: 400, epoch: 21 | loss: 0.0060204
	speed: 0.0669s/iter; left time: 2484.7174s
Epoch: 21 cost time: 33.454530477523804
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1424130
	speed: 0.3022s/iter; left time: 11167.7489s
	iters: 200, epoch: 22 | loss: 0.0042614
	speed: 0.0645s/iter; left time: 2376.6473s
	iters: 300, epoch: 22 | loss: 0.0572134
	speed: 0.0663s/iter; left time: 2437.2018s
	iters: 400, epoch: 22 | loss: 0.0016437
	speed: 0.0655s/iter; left time: 2400.4115s
Epoch: 22 cost time: 31.24093508720398
Epoch: 22, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0021457
	speed: 0.2988s/iter; left time: 10901.3959s
	iters: 200, epoch: 23 | loss: 0.0341564
	speed: 0.0735s/iter; left time: 2674.1983s
	iters: 300, epoch: 23 | loss: 0.0022619
	speed: 0.0696s/iter; left time: 2524.3080s
	iters: 400, epoch: 23 | loss: 0.0151255
	speed: 0.0704s/iter; left time: 2547.1309s
Epoch: 23 cost time: 33.47700762748718
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.320 Vali Acc: 0.936 Test Loss: 0.320 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0022608
	speed: 0.3068s/iter; left time: 11049.9353s
	iters: 200, epoch: 24 | loss: 0.0338975
	speed: 0.0679s/iter; left time: 2439.6968s
	iters: 300, epoch: 24 | loss: 0.0017466
	speed: 0.0681s/iter; left time: 2440.4616s
	iters: 400, epoch: 24 | loss: 0.1028023
	speed: 0.0678s/iter; left time: 2419.8344s
Epoch: 24 cost time: 32.38434314727783
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0891638
	speed: 0.2866s/iter; left time: 10186.2716s
	iters: 200, epoch: 25 | loss: 0.0016050
	speed: 0.0656s/iter; left time: 2326.5786s
	iters: 300, epoch: 25 | loss: 0.5331552
	speed: 0.0705s/iter; left time: 2492.7640s
	iters: 400, epoch: 25 | loss: 0.0014097
	speed: 0.0664s/iter; left time: 2339.3976s
Epoch: 25 cost time: 31.40376091003418
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0032392
	speed: 0.3080s/iter; left time: 10804.8923s
	iters: 200, epoch: 26 | loss: 0.0016567
	speed: 0.0684s/iter; left time: 2394.0226s
	iters: 300, epoch: 26 | loss: 0.0097323
	speed: 0.0680s/iter; left time: 2370.5754s
	iters: 400, epoch: 26 | loss: 0.0402654
	speed: 0.0700s/iter; left time: 2435.5632s
Epoch: 26 cost time: 32.58172106742859
Epoch: 26, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.967408 --> -0.970267).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0023085
	speed: 0.3031s/iter; left time: 10487.9322s
	iters: 200, epoch: 27 | loss: 0.0003687
	speed: 0.0682s/iter; left time: 2352.8729s
	iters: 300, epoch: 27 | loss: 0.0524790
	speed: 0.0659s/iter; left time: 2267.6734s
	iters: 400, epoch: 27 | loss: 0.0760920
	speed: 0.0613s/iter; left time: 2103.8083s
Epoch: 27 cost time: 31.658223628997803
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.1851653
	speed: 0.3062s/iter; left time: 10453.8075s
	iters: 200, epoch: 28 | loss: 0.0020237
	speed: 0.0723s/iter; left time: 2459.9581s
	iters: 300, epoch: 28 | loss: 0.0038335
	speed: 0.0725s/iter; left time: 2462.1550s
	iters: 400, epoch: 28 | loss: 0.0024537
	speed: 0.0712s/iter; left time: 2409.8231s
Epoch: 28 cost time: 34.520525217056274
Epoch: 28, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.971411).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0022474
	speed: 0.3275s/iter; left time: 11027.1341s
	iters: 200, epoch: 29 | loss: 0.0004211
	speed: 0.0730s/iter; left time: 2449.2098s
	iters: 300, epoch: 29 | loss: 0.0144704
	speed: 0.0697s/iter; left time: 2333.2785s
	iters: 400, epoch: 29 | loss: 0.0072874
	speed: 0.0709s/iter; left time: 2367.2551s
Epoch: 29 cost time: 33.83821702003479
Epoch: 29, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0014510
	speed: 0.3225s/iter; left time: 10708.0014s
	iters: 200, epoch: 30 | loss: 0.0325920
	speed: 0.0688s/iter; left time: 2275.6332s
	iters: 300, epoch: 30 | loss: 0.0036683
	speed: 0.0649s/iter; left time: 2141.2986s
	iters: 400, epoch: 30 | loss: 0.0985878
	speed: 0.0728s/iter; left time: 2393.5823s
Epoch: 30 cost time: 32.88486623764038
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.283 Vali Acc: 0.949 Test Loss: 0.283 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0023460
	speed: 0.2957s/iter; left time: 9679.3102s
	iters: 200, epoch: 31 | loss: 0.0057996
	speed: 0.0699s/iter; left time: 2280.8506s
	iters: 300, epoch: 31 | loss: 0.0044014
	speed: 0.0736s/iter; left time: 2394.1365s
	iters: 400, epoch: 31 | loss: 0.3598197
	speed: 0.0655s/iter; left time: 2123.7245s
Epoch: 31 cost time: 33.24549055099487
Epoch: 31, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0005716
	speed: 0.2961s/iter; left time: 9552.3976s
	iters: 200, epoch: 32 | loss: 0.0038591
	speed: 0.0617s/iter; left time: 1985.8869s
	iters: 300, epoch: 32 | loss: 0.0003728
	speed: 0.0623s/iter; left time: 1998.7917s
	iters: 400, epoch: 32 | loss: 0.0009107
	speed: 0.0641s/iter; left time: 2048.5768s
Epoch: 32 cost time: 30.213176250457764
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971696).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0010749
	speed: 0.3053s/iter; left time: 9705.2549s
	iters: 200, epoch: 33 | loss: 0.0015516
	speed: 0.0719s/iter; left time: 2277.5912s
	iters: 300, epoch: 33 | loss: 0.2000736
	speed: 0.0630s/iter; left time: 1990.9873s
	iters: 400, epoch: 33 | loss: 0.0001680
	speed: 0.0669s/iter; left time: 2106.7028s
Epoch: 33 cost time: 32.60567092895508
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0048439
	speed: 0.2916s/iter; left time: 9132.8470s
	iters: 200, epoch: 34 | loss: 0.0010851
	speed: 0.0693s/iter; left time: 2163.7955s
	iters: 300, epoch: 34 | loss: 0.0005161
	speed: 0.0647s/iter; left time: 2013.0162s
	iters: 400, epoch: 34 | loss: 0.0017461
	speed: 0.0670s/iter; left time: 2077.7669s
Epoch: 34 cost time: 31.46081852912903
Epoch: 34, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.353 Vali Acc: 0.938 Test Loss: 0.353 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0197150
	speed: 0.2921s/iter; left time: 9012.7556s
	iters: 200, epoch: 35 | loss: 0.0133780
	speed: 0.0619s/iter; left time: 1903.1798s
	iters: 300, epoch: 35 | loss: 0.0096197
	speed: 0.0681s/iter; left time: 2088.7728s
	iters: 400, epoch: 35 | loss: 0.0674680
	speed: 0.0675s/iter; left time: 2063.0044s
Epoch: 35 cost time: 30.678361654281616
Epoch: 35, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0003196
	speed: 0.2975s/iter; left time: 9039.1473s
	iters: 200, epoch: 36 | loss: 0.0055734
	speed: 0.0663s/iter; left time: 2006.8405s
	iters: 300, epoch: 36 | loss: 0.0098775
	speed: 0.0661s/iter; left time: 1995.7774s
	iters: 400, epoch: 36 | loss: 0.0006779
	speed: 0.0649s/iter; left time: 1952.6026s
Epoch: 36 cost time: 31.482902765274048
Epoch: 36, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.1373882
	speed: 0.2961s/iter; left time: 8858.7821s
	iters: 200, epoch: 37 | loss: 0.0028113
	speed: 0.0617s/iter; left time: 1838.8309s
	iters: 300, epoch: 37 | loss: 0.0850699
	speed: 0.0617s/iter; left time: 1832.5585s
	iters: 400, epoch: 37 | loss: 0.2897592
	speed: 0.0607s/iter; left time: 1798.4277s
Epoch: 37 cost time: 29.45811653137207
Epoch: 37, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0025242
	speed: 0.2787s/iter; left time: 8207.3426s
	iters: 200, epoch: 38 | loss: 0.3762429
	speed: 0.0653s/iter; left time: 1914.9774s
	iters: 300, epoch: 38 | loss: 0.0006362
	speed: 0.0652s/iter; left time: 1908.2126s
	iters: 400, epoch: 38 | loss: 0.0003972
	speed: 0.0714s/iter; left time: 2080.6626s
Epoch: 38 cost time: 31.157495975494385
Epoch: 38, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.321 Vali Acc: 0.943 Test Loss: 0.321 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0024553
	speed: 0.3048s/iter; left time: 8831.5657s
	iters: 200, epoch: 39 | loss: 0.0122958
	speed: 0.0671s/iter; left time: 1938.8500s
	iters: 300, epoch: 39 | loss: 0.0044692
	speed: 0.0713s/iter; left time: 2051.2333s
	iters: 400, epoch: 39 | loss: 0.0025598
	speed: 0.0696s/iter; left time: 1994.9784s
Epoch: 39 cost time: 32.856643199920654
Epoch: 39, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.954 Test Loss: 0.289 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.1355818
	speed: 0.3114s/iter; left time: 8878.7514s
	iters: 200, epoch: 40 | loss: 0.4592405
	speed: 0.0643s/iter; left time: 1827.5255s
	iters: 300, epoch: 40 | loss: 0.5066596
	speed: 0.0641s/iter; left time: 1815.4376s
	iters: 400, epoch: 40 | loss: 0.0168347
	speed: 0.0659s/iter; left time: 1858.6454s
Epoch: 40 cost time: 30.8936984539032
Epoch: 40, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0023833
	speed: 0.3135s/iter; left time: 8791.9410s
	iters: 200, epoch: 41 | loss: 0.0013253
	speed: 0.0674s/iter; left time: 1882.0517s
	iters: 300, epoch: 41 | loss: 0.0210892
	speed: 0.0671s/iter; left time: 1866.8391s
	iters: 400, epoch: 41 | loss: 0.0020048
	speed: 0.0654s/iter; left time: 1813.1485s
Epoch: 41 cost time: 31.692533493041992
Epoch: 41, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0009813
	speed: 0.2856s/iter; left time: 7873.4408s
	iters: 200, epoch: 42 | loss: 0.0068482
	speed: 0.0633s/iter; left time: 1739.5060s
	iters: 300, epoch: 42 | loss: 0.0003415
	speed: 0.0608s/iter; left time: 1665.1062s
	iters: 400, epoch: 42 | loss: 0.0007709
	speed: 0.0604s/iter; left time: 1647.8914s
Epoch: 42 cost time: 29.257883071899414
Epoch: 42, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.971696 --> -0.973412).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0015051
	speed: 0.2872s/iter; left time: 7783.5615s
	iters: 200, epoch: 43 | loss: 0.0005337
	speed: 0.0646s/iter; left time: 1743.2629s
	iters: 300, epoch: 43 | loss: 0.0021281
	speed: 0.0666s/iter; left time: 1791.7269s
	iters: 400, epoch: 43 | loss: 0.0224483
	speed: 0.0641s/iter; left time: 1717.9323s
Epoch: 43 cost time: 30.782866954803467
Epoch: 43, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0007784
	speed: 0.2878s/iter; left time: 7665.2729s
	iters: 200, epoch: 44 | loss: 0.0020530
	speed: 0.0583s/iter; left time: 1547.3854s
	iters: 300, epoch: 44 | loss: 0.0003469
	speed: 0.0626s/iter; left time: 1655.7819s
	iters: 400, epoch: 44 | loss: 0.0016552
	speed: 0.0617s/iter; left time: 1624.4105s
Epoch: 44 cost time: 28.759047031402588
Epoch: 44, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.961 Test Loss: 0.197 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0009338
	speed: 0.2729s/iter; left time: 7139.2559s
	iters: 200, epoch: 45 | loss: 0.0010829
	speed: 0.0630s/iter; left time: 1642.7832s
	iters: 300, epoch: 45 | loss: 0.0040063
	speed: 0.0621s/iter; left time: 1612.4109s
	iters: 400, epoch: 45 | loss: 0.0007743
	speed: 0.0597s/iter; left time: 1544.2822s
Epoch: 45 cost time: 29.202860355377197
Epoch: 45, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.975127).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.0011922
	speed: 0.2890s/iter; left time: 7426.0146s
	iters: 200, epoch: 46 | loss: 0.0335101
	speed: 0.0619s/iter; left time: 1585.3431s
	iters: 300, epoch: 46 | loss: 0.0882964
	speed: 0.0630s/iter; left time: 1606.0893s
	iters: 400, epoch: 46 | loss: 0.0024675
	speed: 0.0627s/iter; left time: 1592.1113s
Epoch: 46 cost time: 30.031053066253662
Epoch: 46, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.963 Test Loss: 0.218 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 0.0003573
	speed: 0.2883s/iter; left time: 7273.5403s
	iters: 200, epoch: 47 | loss: 0.0003053
	speed: 0.0636s/iter; left time: 1599.0515s
	iters: 300, epoch: 47 | loss: 0.0007356
	speed: 0.0627s/iter; left time: 1568.3217s
	iters: 400, epoch: 47 | loss: 0.0022027
	speed: 0.0617s/iter; left time: 1537.6226s
Epoch: 47 cost time: 29.847856760025024
Epoch: 47, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.0095846
	speed: 0.2760s/iter; left time: 6832.1091s
	iters: 200, epoch: 48 | loss: 0.0005912
	speed: 0.0639s/iter; left time: 1575.7212s
	iters: 300, epoch: 48 | loss: 0.1436172
	speed: 0.0592s/iter; left time: 1452.7536s
	iters: 400, epoch: 48 | loss: 0.0037804
	speed: 0.0617s/iter; left time: 1509.5414s
Epoch: 48 cost time: 29.16490888595581
Epoch: 48, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 0.0301827
	speed: 0.2840s/iter; left time: 6897.8632s
	iters: 200, epoch: 49 | loss: 0.0066660
	speed: 0.0636s/iter; left time: 1538.1511s
	iters: 300, epoch: 49 | loss: 0.0024713
	speed: 0.0645s/iter; left time: 1553.1044s
	iters: 400, epoch: 49 | loss: 0.0004909
	speed: 0.0614s/iter; left time: 1471.9375s
Epoch: 49 cost time: 29.708391427993774
Epoch: 49, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.281 Vali Acc: 0.955 Test Loss: 0.281 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 0.0006152
	speed: 0.2899s/iter; left time: 6905.3173s
	iters: 200, epoch: 50 | loss: 0.0108320
	speed: 0.0676s/iter; left time: 1602.8500s
	iters: 300, epoch: 50 | loss: 0.0226393
	speed: 0.0662s/iter; left time: 1562.5402s
	iters: 400, epoch: 50 | loss: 0.1424198
	speed: 0.0676s/iter; left time: 1589.4618s
Epoch: 50 cost time: 31.772062063217163
Epoch: 50, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.961 Test Loss: 0.219 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 0.1228187
	speed: 0.2975s/iter; left time: 6947.2592s
	iters: 200, epoch: 51 | loss: 0.0014060
	speed: 0.0656s/iter; left time: 1525.8468s
	iters: 300, epoch: 51 | loss: 0.0015872
	speed: 0.0634s/iter; left time: 1466.9076s
	iters: 400, epoch: 51 | loss: 0.0013491
	speed: 0.0650s/iter; left time: 1497.5804s
Epoch: 51 cost time: 30.781675338745117
Epoch: 51, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 52 | loss: 0.0004678
	speed: 0.3017s/iter; left time: 6902.3812s
	iters: 200, epoch: 52 | loss: 0.0006103
	speed: 0.0647s/iter; left time: 1474.7838s
	iters: 300, epoch: 52 | loss: 0.0001850
	speed: 0.0670s/iter; left time: 1519.8541s
	iters: 400, epoch: 52 | loss: 0.0002834
	speed: 0.0646s/iter; left time: 1457.9473s
Epoch: 52 cost time: 30.58586049079895
Epoch: 52, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 53 | loss: 0.0015303
	speed: 0.2900s/iter; left time: 6500.4296s
	iters: 200, epoch: 53 | loss: 0.0065608
	speed: 0.0653s/iter; left time: 1457.8675s
	iters: 300, epoch: 53 | loss: 0.0053189
	speed: 0.0638s/iter; left time: 1417.1552s
	iters: 400, epoch: 53 | loss: 0.0063477
	speed: 0.0657s/iter; left time: 1453.3421s
Epoch: 53 cost time: 30.712942838668823
Epoch: 53, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 54 | loss: 0.0077045
	speed: 0.2836s/iter; left time: 6222.6953s
	iters: 200, epoch: 54 | loss: 0.0031400
	speed: 0.0632s/iter; left time: 1380.9000s
	iters: 300, epoch: 54 | loss: 0.0003280
	speed: 0.0625s/iter; left time: 1359.2106s
	iters: 400, epoch: 54 | loss: 0.0000702
	speed: 0.0661s/iter; left time: 1429.8156s
Epoch: 54 cost time: 29.98824667930603
Epoch: 54, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 55 | loss: 0.0084290
	speed: 0.2714s/iter; left time: 5827.3020s
	iters: 200, epoch: 55 | loss: 0.0653925
	speed: 0.0604s/iter; left time: 1291.4077s
	iters: 300, epoch: 55 | loss: 0.0044708
	speed: 0.0608s/iter; left time: 1294.1408s
	iters: 400, epoch: 55 | loss: 0.0006462
	speed: 0.0628s/iter; left time: 1330.2917s
Epoch: 55 cost time: 28.991106271743774
Epoch: 55, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 940154
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7352328
	speed: 0.0861s/iter; left time: 4027.4376s
	iters: 200, epoch: 1 | loss: 0.4741739
	speed: 0.0672s/iter; left time: 3136.9597s
	iters: 300, epoch: 1 | loss: 0.2940775
	speed: 0.0647s/iter; left time: 3014.1177s
	iters: 400, epoch: 1 | loss: 0.2756286
	speed: 0.0651s/iter; left time: 3026.0364s
Epoch: 1 cost time: 32.69602560997009
Epoch: 1, Steps: 469 | Train Loss: 0.621 Vali Loss: 0.414 Vali Acc: 0.865 Test Loss: 0.414 Test Acc: 0.865
Validation loss decreased (inf --> -0.864776).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0301764
	speed: 0.2571s/iter; left time: 11912.7219s
	iters: 200, epoch: 2 | loss: 0.0431251
	speed: 0.0650s/iter; left time: 3005.5169s
	iters: 300, epoch: 2 | loss: 0.1277257
	speed: 0.0628s/iter; left time: 2896.4494s
	iters: 400, epoch: 2 | loss: 0.0802869
	speed: 0.0609s/iter; left time: 2804.9442s
Epoch: 2 cost time: 29.881680727005005
Epoch: 2, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.399 Vali Acc: 0.878 Test Loss: 0.399 Test Acc: 0.878
Validation loss decreased (-0.864776 --> -0.878212).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0543792
	speed: 0.2791s/iter; left time: 12801.7829s
	iters: 200, epoch: 3 | loss: 0.1238094
	speed: 0.0624s/iter; left time: 2857.3755s
	iters: 300, epoch: 3 | loss: 0.1076169
	speed: 0.0651s/iter; left time: 2972.4460s
	iters: 400, epoch: 3 | loss: 0.2226989
	speed: 0.0659s/iter; left time: 3003.3260s
Epoch: 3 cost time: 30.29040217399597
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.193 Vali Acc: 0.934 Test Loss: 0.193 Test Acc: 0.934
Validation loss decreased (-0.878212 --> -0.934246).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0190919
	speed: 0.2940s/iter; left time: 13347.4998s
	iters: 200, epoch: 4 | loss: 0.0528453
	speed: 0.0656s/iter; left time: 2972.1116s
	iters: 300, epoch: 4 | loss: 0.0885353
	speed: 0.0653s/iter; left time: 2952.5497s
	iters: 400, epoch: 4 | loss: 0.0396304
	speed: 0.0651s/iter; left time: 2935.6104s
Epoch: 4 cost time: 31.068819284439087
Epoch: 4, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.383 Vali Acc: 0.899 Test Loss: 0.383 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3204596
	speed: 0.2878s/iter; left time: 12930.0670s
	iters: 200, epoch: 5 | loss: 0.2749477
	speed: 0.0615s/iter; left time: 2758.0184s
	iters: 300, epoch: 5 | loss: 0.0145706
	speed: 0.0628s/iter; left time: 2808.6833s
	iters: 400, epoch: 5 | loss: 0.0120553
	speed: 0.0620s/iter; left time: 2765.4281s
Epoch: 5 cost time: 29.966410160064697
Epoch: 5, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.934246 --> -0.964550).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0127041
	speed: 0.3001s/iter; left time: 13342.9014s
	iters: 200, epoch: 6 | loss: 0.0062519
	speed: 0.0679s/iter; left time: 3012.5228s
	iters: 300, epoch: 6 | loss: 0.0117528
	speed: 0.0666s/iter; left time: 2946.5311s
	iters: 400, epoch: 6 | loss: 0.0877711
	speed: 0.0660s/iter; left time: 2912.6204s
Epoch: 6 cost time: 31.939329147338867
Epoch: 6, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0877323
	speed: 0.3077s/iter; left time: 13536.6961s
	iters: 200, epoch: 7 | loss: 0.0432424
	speed: 0.0664s/iter; left time: 2915.2950s
	iters: 300, epoch: 7 | loss: 0.0118128
	speed: 0.0718s/iter; left time: 3142.7493s
	iters: 400, epoch: 7 | loss: 0.0444144
	speed: 0.0678s/iter; left time: 2960.3150s
Epoch: 7 cost time: 32.03828573226929
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0042251
	speed: 0.2736s/iter; left time: 11908.2171s
	iters: 200, epoch: 8 | loss: 0.0405775
	speed: 0.0688s/iter; left time: 2985.8703s
	iters: 300, epoch: 8 | loss: 0.0049614
	speed: 0.0681s/iter; left time: 2950.3860s
	iters: 400, epoch: 8 | loss: 0.0042288
	speed: 0.0687s/iter; left time: 2970.3589s
Epoch: 8 cost time: 31.914944410324097
Epoch: 8, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.311 Vali Acc: 0.923 Test Loss: 0.311 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0070560
	speed: 0.2839s/iter; left time: 12219.8892s
	iters: 200, epoch: 9 | loss: 0.0510195
	speed: 0.0624s/iter; left time: 2678.1643s
	iters: 300, epoch: 9 | loss: 0.0072973
	speed: 0.0614s/iter; left time: 2631.1991s
	iters: 400, epoch: 9 | loss: 0.1055258
	speed: 0.0672s/iter; left time: 2872.6725s
Epoch: 9 cost time: 30.64756155014038
Epoch: 9, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0049134
	speed: 0.2851s/iter; left time: 12137.6636s
	iters: 200, epoch: 10 | loss: 0.0042270
	speed: 0.0657s/iter; left time: 2789.5344s
	iters: 300, epoch: 10 | loss: 0.0176072
	speed: 0.0626s/iter; left time: 2654.2495s
	iters: 400, epoch: 10 | loss: 0.0025677
	speed: 0.0625s/iter; left time: 2642.6928s
Epoch: 10 cost time: 30.06557607650757
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0031049
	speed: 0.2834s/iter; left time: 11933.7132s
	iters: 200, epoch: 11 | loss: 0.0269464
	speed: 0.0657s/iter; left time: 2761.4666s
	iters: 300, epoch: 11 | loss: 0.0227291
	speed: 0.0643s/iter; left time: 2695.9873s
	iters: 400, epoch: 11 | loss: 0.2007263
	speed: 0.0666s/iter; left time: 2783.8439s
Epoch: 11 cost time: 31.36585831642151
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0061712
	speed: 0.2907s/iter; left time: 12107.3218s
	iters: 200, epoch: 12 | loss: 0.1151711
	speed: 0.0624s/iter; left time: 2591.0803s
	iters: 300, epoch: 12 | loss: 0.0216193
	speed: 0.0637s/iter; left time: 2640.6196s
	iters: 400, epoch: 12 | loss: 0.0070560
	speed: 0.0623s/iter; left time: 2577.3857s
Epoch: 12 cost time: 30.432549953460693
Epoch: 12, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1489509
	speed: 0.2804s/iter; left time: 11543.0284s
	iters: 200, epoch: 13 | loss: 0.0046816
	speed: 0.0693s/iter; left time: 2848.0503s
	iters: 300, epoch: 13 | loss: 0.2892004
	speed: 0.0675s/iter; left time: 2764.8049s
	iters: 400, epoch: 13 | loss: 0.0101523
	speed: 0.0656s/iter; left time: 2680.2010s
Epoch: 13 cost time: 31.4415180683136
Epoch: 13, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0291373
	speed: 0.2893s/iter; left time: 11776.1996s
	iters: 200, epoch: 14 | loss: 0.0139051
	speed: 0.0627s/iter; left time: 2546.8808s
	iters: 300, epoch: 14 | loss: 0.1991594
	speed: 0.0624s/iter; left time: 2526.6100s
	iters: 400, epoch: 14 | loss: 0.0166014
	speed: 0.0636s/iter; left time: 2570.4124s
Epoch: 14 cost time: 30.181646823883057
Epoch: 14, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.964550 --> -0.973984).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0220898
	speed: 0.2810s/iter; left time: 11306.4495s
	iters: 200, epoch: 15 | loss: 0.0030377
	speed: 0.0598s/iter; left time: 2399.7497s
	iters: 300, epoch: 15 | loss: 0.7313435
	speed: 0.0614s/iter; left time: 2456.4112s
	iters: 400, epoch: 15 | loss: 0.0155361
	speed: 0.0630s/iter; left time: 2515.5001s
Epoch: 15 cost time: 29.28916573524475
Epoch: 15, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0181655
	speed: 0.2883s/iter; left time: 11464.1915s
	iters: 200, epoch: 16 | loss: 0.0031218
	speed: 0.0639s/iter; left time: 2534.4323s
	iters: 300, epoch: 16 | loss: 0.1911618
	speed: 0.0637s/iter; left time: 2521.6620s
	iters: 400, epoch: 16 | loss: 0.0036025
	speed: 0.0624s/iter; left time: 2462.8240s
Epoch: 16 cost time: 30.720542430877686
Epoch: 16, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1491969
	speed: 0.3035s/iter; left time: 11925.8472s
	iters: 200, epoch: 17 | loss: 0.0088734
	speed: 0.0638s/iter; left time: 2499.6812s
	iters: 300, epoch: 17 | loss: 0.4541033
	speed: 0.0656s/iter; left time: 2565.1187s
	iters: 400, epoch: 17 | loss: 0.0060714
	speed: 0.0659s/iter; left time: 2568.2302s
Epoch: 17 cost time: 30.806325435638428
Epoch: 17, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2059015
	speed: 0.2963s/iter; left time: 11505.9927s
	iters: 200, epoch: 18 | loss: 0.0087367
	speed: 0.0668s/iter; left time: 2586.5997s
	iters: 300, epoch: 18 | loss: 0.0135328
	speed: 0.0655s/iter; left time: 2528.3492s
	iters: 400, epoch: 18 | loss: 0.0271516
	speed: 0.0670s/iter; left time: 2582.6955s
Epoch: 18 cost time: 31.115234375
Epoch: 18, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0062180
	speed: 0.2922s/iter; left time: 11209.0139s
	iters: 200, epoch: 19 | loss: 0.0012013
	speed: 0.0670s/iter; left time: 2564.7912s
	iters: 300, epoch: 19 | loss: 0.0023756
	speed: 0.0664s/iter; left time: 2533.7823s
	iters: 400, epoch: 19 | loss: 0.0063220
	speed: 0.0637s/iter; left time: 2422.9781s
Epoch: 19 cost time: 30.737252473831177
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0030802
	speed: 0.2825s/iter; left time: 10702.1679s
	iters: 200, epoch: 20 | loss: 0.1203995
	speed: 0.0632s/iter; left time: 2388.1802s
	iters: 300, epoch: 20 | loss: 0.0012742
	speed: 0.0646s/iter; left time: 2435.0223s
	iters: 400, epoch: 20 | loss: 0.0126637
	speed: 0.0664s/iter; left time: 2495.6266s
Epoch: 20 cost time: 30.28364610671997
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.248 Vali Acc: 0.953 Test Loss: 0.248 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0044479
	speed: 0.2685s/iter; left time: 10048.0209s
	iters: 200, epoch: 21 | loss: 0.0021033
	speed: 0.0608s/iter; left time: 2269.8769s
	iters: 300, epoch: 21 | loss: 0.0881356
	speed: 0.0621s/iter; left time: 2310.9165s
	iters: 400, epoch: 21 | loss: 0.0053815
	speed: 0.0613s/iter; left time: 2274.3287s
Epoch: 21 cost time: 29.066206693649292
Epoch: 21, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0015495
	speed: 0.2767s/iter; left time: 10226.2231s
	iters: 200, epoch: 22 | loss: 0.0030542
	speed: 0.0628s/iter; left time: 2314.8451s
	iters: 300, epoch: 22 | loss: 0.0008227
	speed: 0.0640s/iter; left time: 2351.4348s
	iters: 400, epoch: 22 | loss: 0.0012577
	speed: 0.0648s/iter; left time: 2373.4336s
Epoch: 22 cost time: 30.323441743850708
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0019579
	speed: 0.2763s/iter; left time: 10081.1108s
	iters: 200, epoch: 23 | loss: 0.0195290
	speed: 0.0604s/iter; left time: 2196.7279s
	iters: 300, epoch: 23 | loss: 0.0022561
	speed: 0.0578s/iter; left time: 2096.1759s
	iters: 400, epoch: 23 | loss: 0.0027241
	speed: 0.0617s/iter; left time: 2231.0790s
Epoch: 23 cost time: 29.053346157073975
Epoch: 23, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0073924
	speed: 0.2829s/iter; left time: 10187.2727s
	iters: 200, epoch: 24 | loss: 0.0122302
	speed: 0.0623s/iter; left time: 2237.3095s
	iters: 300, epoch: 24 | loss: 0.0059790
	speed: 0.0630s/iter; left time: 2256.9799s
	iters: 400, epoch: 24 | loss: 0.0020245
	speed: 0.0622s/iter; left time: 2220.7151s
Epoch: 24 cost time: 29.335423946380615
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9739851343624929
model parameter : 939962
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8887935
	speed: 0.0771s/iter; left time: 3608.4400s
	iters: 200, epoch: 1 | loss: 0.5390794
	speed: 0.0654s/iter; left time: 3055.5816s
	iters: 300, epoch: 1 | loss: 0.1414222
	speed: 0.0638s/iter; left time: 2974.1935s
	iters: 400, epoch: 1 | loss: 0.2841569
	speed: 0.0668s/iter; left time: 3105.7688s
Epoch: 1 cost time: 31.92790699005127
Epoch: 1, Steps: 469 | Train Loss: 0.619 Vali Loss: 0.278 Vali Acc: 0.921 Test Loss: 0.278 Test Acc: 0.921
Validation loss decreased (inf --> -0.921095).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1143644
	speed: 0.2911s/iter; left time: 13487.8900s
	iters: 200, epoch: 2 | loss: 0.0599997
	speed: 0.0649s/iter; left time: 2998.7242s
	iters: 300, epoch: 2 | loss: 0.0401729
	speed: 0.0638s/iter; left time: 2941.5418s
	iters: 400, epoch: 2 | loss: 0.2939042
	speed: 0.0626s/iter; left time: 2882.2459s
Epoch: 2 cost time: 30.726636171340942
Epoch: 2, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.921095 --> -0.934818).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1450030
	speed: 0.2948s/iter; left time: 13520.0229s
	iters: 200, epoch: 3 | loss: 0.0901112
	speed: 0.0633s/iter; left time: 2897.9750s
	iters: 300, epoch: 3 | loss: 0.0937498
	speed: 0.0638s/iter; left time: 2912.8010s
	iters: 400, epoch: 3 | loss: 0.1134759
	speed: 0.0692s/iter; left time: 3150.9437s
Epoch: 3 cost time: 31.532784700393677
Epoch: 3, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3356736
	speed: 0.3034s/iter; left time: 13770.5301s
	iters: 200, epoch: 4 | loss: 0.0158209
	speed: 0.0688s/iter; left time: 3116.8564s
	iters: 300, epoch: 4 | loss: 0.0246767
	speed: 0.0711s/iter; left time: 3215.0485s
	iters: 400, epoch: 4 | loss: 0.0043007
	speed: 0.0694s/iter; left time: 3127.7907s
Epoch: 4 cost time: 33.23179316520691
Epoch: 4, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
Validation loss decreased (-0.934818 --> -0.938534).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0226065
	speed: 0.3123s/iter; left time: 14031.3948s
	iters: 200, epoch: 5 | loss: 0.0329719
	speed: 0.0639s/iter; left time: 2862.3604s
	iters: 300, epoch: 5 | loss: 0.0340934
	speed: 0.0664s/iter; left time: 2969.9295s
	iters: 400, epoch: 5 | loss: 0.0660029
	speed: 0.0686s/iter; left time: 3059.9603s
Epoch: 5 cost time: 31.705840826034546
Epoch: 5, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
Validation loss decreased (-0.938534 --> -0.956545).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1726317
	speed: 0.2892s/iter; left time: 12855.0748s
	iters: 200, epoch: 6 | loss: 0.0331522
	speed: 0.0654s/iter; left time: 2902.3870s
	iters: 300, epoch: 6 | loss: 0.2767886
	speed: 0.0602s/iter; left time: 2662.6450s
	iters: 400, epoch: 6 | loss: 0.0076965
	speed: 0.0624s/iter; left time: 2756.2417s
Epoch: 6 cost time: 29.974684953689575
Epoch: 6, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.224 Vali Acc: 0.940 Test Loss: 0.224 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0760637
	speed: 0.2847s/iter; left time: 12521.6274s
	iters: 200, epoch: 7 | loss: 0.1717850
	speed: 0.0618s/iter; left time: 2711.2081s
	iters: 300, epoch: 7 | loss: 0.0209589
	speed: 0.0659s/iter; left time: 2886.4820s
	iters: 400, epoch: 7 | loss: 0.4200433
	speed: 0.0652s/iter; left time: 2848.1428s
Epoch: 7 cost time: 30.498199939727783
Epoch: 7, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.278 Vali Acc: 0.936 Test Loss: 0.278 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0109899
	speed: 0.2854s/iter; left time: 12421.6373s
	iters: 200, epoch: 8 | loss: 0.2602913
	speed: 0.0647s/iter; left time: 2808.3356s
	iters: 300, epoch: 8 | loss: 0.0797316
	speed: 0.0614s/iter; left time: 2658.1852s
	iters: 400, epoch: 8 | loss: 0.0081431
	speed: 0.0622s/iter; left time: 2686.9367s
Epoch: 8 cost time: 30.30051040649414
Epoch: 8, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
Validation loss decreased (-0.956545 --> -0.957975).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0179010
	speed: 0.2923s/iter; left time: 12581.5733s
	iters: 200, epoch: 9 | loss: 0.0205575
	speed: 0.0617s/iter; left time: 2651.3400s
	iters: 300, epoch: 9 | loss: 0.0208152
	speed: 0.0606s/iter; left time: 2595.2682s
	iters: 400, epoch: 9 | loss: 0.0680443
	speed: 0.0645s/iter; left time: 2758.9304s
Epoch: 9 cost time: 29.848591566085815
Epoch: 9, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.957975 --> -0.964836).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0368089
	speed: 0.2692s/iter; left time: 11462.0912s
	iters: 200, epoch: 10 | loss: 0.0077759
	speed: 0.0674s/iter; left time: 2863.0513s
	iters: 300, epoch: 10 | loss: 0.0285142
	speed: 0.0599s/iter; left time: 2537.2334s
	iters: 400, epoch: 10 | loss: 0.0025532
	speed: 0.0614s/iter; left time: 2595.6023s
Epoch: 10 cost time: 29.93244242668152
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0024371
	speed: 0.2881s/iter; left time: 12130.5135s
	iters: 200, epoch: 11 | loss: 0.0053939
	speed: 0.0618s/iter; left time: 2598.0486s
	iters: 300, epoch: 11 | loss: 0.0748701
	speed: 0.0620s/iter; left time: 2599.4297s
	iters: 400, epoch: 11 | loss: 0.0088122
	speed: 0.0647s/iter; left time: 2704.7342s
Epoch: 11 cost time: 29.891204595565796
Epoch: 11, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0099134
	speed: 0.2855s/iter; left time: 11887.6410s
	iters: 200, epoch: 12 | loss: 0.0196922
	speed: 0.0629s/iter; left time: 2612.6932s
	iters: 300, epoch: 12 | loss: 0.0656088
	speed: 0.0617s/iter; left time: 2555.4442s
	iters: 400, epoch: 12 | loss: 0.0036191
	speed: 0.0578s/iter; left time: 2388.9867s
Epoch: 12 cost time: 28.94593906402588
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1233077
	speed: 0.2670s/iter; left time: 10994.3853s
	iters: 200, epoch: 13 | loss: 0.0864827
	speed: 0.0634s/iter; left time: 2603.9424s
	iters: 300, epoch: 13 | loss: 0.0162664
	speed: 0.0622s/iter; left time: 2546.4791s
	iters: 400, epoch: 13 | loss: 0.0326038
	speed: 0.0641s/iter; left time: 2619.1172s
Epoch: 13 cost time: 29.676815271377563
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1178964
	speed: 0.2818s/iter; left time: 11471.9705s
	iters: 200, epoch: 14 | loss: 0.0021837
	speed: 0.0631s/iter; left time: 2563.5272s
	iters: 300, epoch: 14 | loss: 0.2082218
	speed: 0.0642s/iter; left time: 2601.8360s
	iters: 400, epoch: 14 | loss: 0.0017977
	speed: 0.0649s/iter; left time: 2621.5334s
Epoch: 14 cost time: 30.422508001327515
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1725529
	speed: 0.2822s/iter; left time: 11352.8823s
	iters: 200, epoch: 15 | loss: 0.0348646
	speed: 0.0616s/iter; left time: 2470.9639s
	iters: 300, epoch: 15 | loss: 0.0243716
	speed: 0.0634s/iter; left time: 2538.7206s
	iters: 400, epoch: 15 | loss: 0.0017592
	speed: 0.0638s/iter; left time: 2547.2931s
Epoch: 15 cost time: 29.840692043304443
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.964836 --> -0.967694).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0769454
	speed: 0.2931s/iter; left time: 11656.0926s
	iters: 200, epoch: 16 | loss: 0.0074844
	speed: 0.0699s/iter; left time: 2771.6320s
	iters: 300, epoch: 16 | loss: 0.0036600
	speed: 0.0665s/iter; left time: 2629.7414s
	iters: 400, epoch: 16 | loss: 0.0198884
	speed: 0.0659s/iter; left time: 2600.4904s
Epoch: 16 cost time: 31.46419596672058
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0049436
	speed: 0.2549s/iter; left time: 10017.1338s
	iters: 200, epoch: 17 | loss: 0.0867329
	speed: 0.0602s/iter; left time: 2360.8199s
	iters: 300, epoch: 17 | loss: 0.3599287
	speed: 0.0608s/iter; left time: 2377.5965s
	iters: 400, epoch: 17 | loss: 0.0016033
	speed: 0.0593s/iter; left time: 2312.1678s
Epoch: 17 cost time: 28.515023469924927
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0027308
	speed: 0.2686s/iter; left time: 10428.2868s
	iters: 200, epoch: 18 | loss: 0.0016936
	speed: 0.0603s/iter; left time: 2336.4416s
	iters: 300, epoch: 18 | loss: 0.0843733
	speed: 0.0595s/iter; left time: 2300.0213s
	iters: 400, epoch: 18 | loss: 0.0035007
	speed: 0.0583s/iter; left time: 2244.9465s
Epoch: 18 cost time: 28.211986541748047
Epoch: 18, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0025976
	speed: 0.2713s/iter; left time: 10408.0508s
	iters: 200, epoch: 19 | loss: 0.0344009
	speed: 0.0620s/iter; left time: 2371.2967s
	iters: 300, epoch: 19 | loss: 0.0033805
	speed: 0.0585s/iter; left time: 2233.1354s
	iters: 400, epoch: 19 | loss: 0.0067474
	speed: 0.0602s/iter; left time: 2291.4036s
Epoch: 19 cost time: 28.862916707992554
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.967694 --> -0.973412).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0042996
	speed: 0.2720s/iter; left time: 10306.4108s
	iters: 200, epoch: 20 | loss: 0.0008526
	speed: 0.0593s/iter; left time: 2241.1397s
	iters: 300, epoch: 20 | loss: 0.0181104
	speed: 0.0614s/iter; left time: 2314.3340s
	iters: 400, epoch: 20 | loss: 0.1548555
	speed: 0.0604s/iter; left time: 2269.8731s
Epoch: 20 cost time: 28.751648902893066
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0010864
	speed: 0.2722s/iter; left time: 10185.3954s
	iters: 200, epoch: 21 | loss: 0.0055598
	speed: 0.0593s/iter; left time: 2211.9456s
	iters: 300, epoch: 21 | loss: 0.0049432
	speed: 0.0601s/iter; left time: 2236.9825s
	iters: 400, epoch: 21 | loss: 0.0123914
	speed: 0.0606s/iter; left time: 2248.2270s
Epoch: 21 cost time: 28.464747190475464
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.974841).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0106457
	speed: 0.2594s/iter; left time: 9586.8360s
	iters: 200, epoch: 22 | loss: 0.0037071
	speed: 0.0599s/iter; left time: 2206.7902s
	iters: 300, epoch: 22 | loss: 0.0064778
	speed: 0.0591s/iter; left time: 2170.2160s
	iters: 400, epoch: 22 | loss: 0.0167297
	speed: 0.0596s/iter; left time: 2185.5538s
Epoch: 22 cost time: 28.2108211517334
Epoch: 22, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0054643
	speed: 0.2735s/iter; left time: 9976.3490s
	iters: 200, epoch: 23 | loss: 0.0540224
	speed: 0.0631s/iter; left time: 2296.5646s
	iters: 300, epoch: 23 | loss: 0.0006353
	speed: 0.0613s/iter; left time: 2225.0588s
	iters: 400, epoch: 23 | loss: 0.0008766
	speed: 0.0599s/iter; left time: 2167.2947s
Epoch: 23 cost time: 29.236685752868652
Epoch: 23, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.7006271
	speed: 0.2835s/iter; left time: 10209.3024s
	iters: 200, epoch: 24 | loss: 0.0087727
	speed: 0.0649s/iter; left time: 2330.8637s
	iters: 300, epoch: 24 | loss: 0.0050984
	speed: 0.0597s/iter; left time: 2137.1287s
	iters: 400, epoch: 24 | loss: 0.0038790
	speed: 0.0596s/iter; left time: 2128.8715s
Epoch: 24 cost time: 29.42797827720642
Epoch: 24, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0008816
	speed: 0.2655s/iter; left time: 9435.8640s
	iters: 200, epoch: 25 | loss: 0.0014046
	speed: 0.0608s/iter; left time: 2153.4464s
	iters: 300, epoch: 25 | loss: 0.0171604
	speed: 0.0617s/iter; left time: 2180.7695s
	iters: 400, epoch: 25 | loss: 0.0015411
	speed: 0.0602s/iter; left time: 2120.7735s
Epoch: 25 cost time: 28.850954294204712
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0111821
	speed: 0.2851s/iter; left time: 10001.8149s
	iters: 200, epoch: 26 | loss: 0.0026967
	speed: 0.0668s/iter; left time: 2337.3028s
	iters: 300, epoch: 26 | loss: 0.1346945
	speed: 0.0644s/iter; left time: 2246.0898s
	iters: 400, epoch: 26 | loss: 0.0007805
	speed: 0.0643s/iter; left time: 2236.1006s
Epoch: 26 cost time: 30.892558813095093
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.957 Test Loss: 0.220 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0022909
	speed: 0.3006s/iter; left time: 10403.9180s
	iters: 200, epoch: 27 | loss: 0.0007619
	speed: 0.0616s/iter; left time: 2126.3946s
	iters: 300, epoch: 27 | loss: 0.0010831
	speed: 0.0626s/iter; left time: 2154.5615s
	iters: 400, epoch: 27 | loss: 0.1334771
	speed: 0.0647s/iter; left time: 2220.9223s
Epoch: 27 cost time: 29.89941954612732
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0020354
	speed: 0.2706s/iter; left time: 9238.0007s
	iters: 200, epoch: 28 | loss: 0.0005054
	speed: 0.0657s/iter; left time: 2235.2428s
	iters: 300, epoch: 28 | loss: 0.0018794
	speed: 0.0605s/iter; left time: 2054.6512s
	iters: 400, epoch: 28 | loss: 0.0011039
	speed: 0.0601s/iter; left time: 2032.9258s
Epoch: 28 cost time: 29.71838140487671
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.274 Vali Acc: 0.945 Test Loss: 0.274 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0620229
	speed: 0.2865s/iter; left time: 9646.6621s
	iters: 200, epoch: 29 | loss: 0.2460869
	speed: 0.0663s/iter; left time: 2224.6226s
	iters: 300, epoch: 29 | loss: 0.0059219
	speed: 0.0619s/iter; left time: 2070.4354s
	iters: 400, epoch: 29 | loss: 0.0003152
	speed: 0.0615s/iter; left time: 2051.3225s
Epoch: 29 cost time: 30.139926433563232
Epoch: 29, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.965 Test Loss: 0.186 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0029999
	speed: 0.2671s/iter; left time: 8867.8638s
	iters: 200, epoch: 30 | loss: 0.0004026
	speed: 0.0663s/iter; left time: 2195.4392s
	iters: 300, epoch: 30 | loss: 0.0441182
	speed: 0.0617s/iter; left time: 2036.3713s
	iters: 400, epoch: 30 | loss: 0.0025038
	speed: 0.0634s/iter; left time: 2085.1762s
Epoch: 30 cost time: 30.094250679016113
Epoch: 30, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0071691
	speed: 0.2778s/iter; left time: 9094.2211s
	iters: 200, epoch: 31 | loss: 0.0032401
	speed: 0.0607s/iter; left time: 1980.7078s
	iters: 300, epoch: 31 | loss: 0.0043003
	speed: 0.0617s/iter; left time: 2006.3957s
	iters: 400, epoch: 31 | loss: 0.5131254
	speed: 0.0631s/iter; left time: 2046.0522s
Epoch: 31 cost time: 29.08427596092224
Epoch: 31, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 939770
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9223623
	speed: 0.0792s/iter; left time: 3705.2607s
	iters: 200, epoch: 1 | loss: 0.2978958
	speed: 0.0631s/iter; left time: 2944.6171s
	iters: 300, epoch: 1 | loss: 0.3155313
	speed: 0.0609s/iter; left time: 2839.3152s
	iters: 400, epoch: 1 | loss: 0.2859367
	speed: 0.0609s/iter; left time: 2830.3883s
Epoch: 1 cost time: 30.735035181045532
Epoch: 1, Steps: 469 | Train Loss: 0.675 Vali Loss: 0.300 Vali Acc: 0.912 Test Loss: 0.300 Test Acc: 0.912
Validation loss decreased (inf --> -0.912233).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2731873
	speed: 0.2826s/iter; left time: 13094.7601s
	iters: 200, epoch: 2 | loss: 0.2371892
	speed: 0.0624s/iter; left time: 2882.9135s
	iters: 300, epoch: 2 | loss: 0.0673592
	speed: 0.0629s/iter; left time: 2899.6841s
	iters: 400, epoch: 2 | loss: 0.0563945
	speed: 0.0621s/iter; left time: 2859.8230s
Epoch: 2 cost time: 29.83756160736084
Epoch: 2, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.278 Vali Acc: 0.905 Test Loss: 0.278 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1836376
	speed: 0.2642s/iter; left time: 12115.1243s
	iters: 200, epoch: 3 | loss: 0.0885231
	speed: 0.0593s/iter; left time: 2715.6274s
	iters: 300, epoch: 3 | loss: 0.2134232
	speed: 0.0653s/iter; left time: 2982.1083s
	iters: 400, epoch: 3 | loss: 0.0951072
	speed: 0.0655s/iter; left time: 2985.7398s
Epoch: 3 cost time: 29.934246301651
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
Validation loss decreased (-0.912233 --> -0.957975).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0516717
	speed: 0.2831s/iter; left time: 12849.9609s
	iters: 200, epoch: 4 | loss: 0.0547373
	speed: 0.0637s/iter; left time: 2885.8309s
	iters: 300, epoch: 4 | loss: 0.4392611
	speed: 0.0676s/iter; left time: 3053.6452s
	iters: 400, epoch: 4 | loss: 0.0934315
	speed: 0.0677s/iter; left time: 3052.2842s
Epoch: 4 cost time: 30.836114406585693
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.235 Vali Acc: 0.929 Test Loss: 0.235 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0118686
	speed: 0.2776s/iter; left time: 12470.3439s
	iters: 200, epoch: 5 | loss: 0.0136365
	speed: 0.0600s/iter; left time: 2691.2751s
	iters: 300, epoch: 5 | loss: 0.0810441
	speed: 0.0607s/iter; left time: 2715.6742s
	iters: 400, epoch: 5 | loss: 0.0057445
	speed: 0.0611s/iter; left time: 2726.1737s
Epoch: 5 cost time: 29.049740314483643
Epoch: 5, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0118742
	speed: 0.2524s/iter; left time: 11221.1085s
	iters: 200, epoch: 6 | loss: 0.0375894
	speed: 0.0604s/iter; left time: 2678.2049s
	iters: 300, epoch: 6 | loss: 0.0394570
	speed: 0.0630s/iter; left time: 2788.5009s
	iters: 400, epoch: 6 | loss: 0.1641296
	speed: 0.0608s/iter; left time: 2685.4978s
Epoch: 6 cost time: 28.72828698158264
Epoch: 6, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0051556
	speed: 0.2716s/iter; left time: 11945.2918s
	iters: 200, epoch: 7 | loss: 0.0768955
	speed: 0.0640s/iter; left time: 2810.4638s
	iters: 300, epoch: 7 | loss: 0.0614832
	speed: 0.0654s/iter; left time: 2865.0940s
	iters: 400, epoch: 7 | loss: 0.0052465
	speed: 0.0649s/iter; left time: 2836.9753s
Epoch: 7 cost time: 30.343611240386963
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.957975 --> -0.965122).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0221618
	speed: 0.2989s/iter; left time: 13008.3502s
	iters: 200, epoch: 8 | loss: 0.0046302
	speed: 0.0638s/iter; left time: 2767.9857s
	iters: 300, epoch: 8 | loss: 0.2328651
	speed: 0.0620s/iter; left time: 2687.4058s
	iters: 400, epoch: 8 | loss: 0.0020509
	speed: 0.0615s/iter; left time: 2659.3389s
Epoch: 8 cost time: 29.774354934692383
Epoch: 8, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0069214
	speed: 0.2893s/iter; left time: 12453.9646s
	iters: 200, epoch: 9 | loss: 0.1415043
	speed: 0.0635s/iter; left time: 2725.6609s
	iters: 300, epoch: 9 | loss: 0.0448568
	speed: 0.0615s/iter; left time: 2636.6175s
	iters: 400, epoch: 9 | loss: 0.0503404
	speed: 0.0629s/iter; left time: 2689.5284s
Epoch: 9 cost time: 29.885390043258667
Epoch: 9, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
Validation loss decreased (-0.965122 --> -0.965693).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0473185
	speed: 0.2917s/iter; left time: 12419.7697s
	iters: 200, epoch: 10 | loss: 0.0359902
	speed: 0.0628s/iter; left time: 2667.0846s
	iters: 300, epoch: 10 | loss: 0.3649670
	speed: 0.0664s/iter; left time: 2813.3245s
	iters: 400, epoch: 10 | loss: 0.0554527
	speed: 0.0632s/iter; left time: 2672.8251s
Epoch: 10 cost time: 30.318594455718994
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2879389
	speed: 0.2484s/iter; left time: 10460.7050s
	iters: 200, epoch: 11 | loss: 0.0031584
	speed: 0.0566s/iter; left time: 2379.0175s
	iters: 300, epoch: 11 | loss: 0.0158166
	speed: 0.0607s/iter; left time: 2543.1933s
	iters: 400, epoch: 11 | loss: 0.2534637
	speed: 0.0591s/iter; left time: 2472.5981s
Epoch: 11 cost time: 27.811030864715576
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0041062
	speed: 0.2788s/iter; left time: 11611.6843s
	iters: 200, epoch: 12 | loss: 0.0008379
	speed: 0.0610s/iter; left time: 2532.3319s
	iters: 300, epoch: 12 | loss: 0.0008816
	speed: 0.0582s/iter; left time: 2411.1170s
	iters: 400, epoch: 12 | loss: 0.0248252
	speed: 0.0598s/iter; left time: 2471.1292s
Epoch: 12 cost time: 28.94283390045166
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0054222
	speed: 0.2628s/iter; left time: 10822.0916s
	iters: 200, epoch: 13 | loss: 0.0158196
	speed: 0.0564s/iter; left time: 2315.4642s
	iters: 300, epoch: 13 | loss: 0.1424921
	speed: 0.0574s/iter; left time: 2352.6881s
	iters: 400, epoch: 13 | loss: 0.0232819
	speed: 0.0601s/iter; left time: 2455.0321s
Epoch: 13 cost time: 27.77523446083069
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0109374
	speed: 0.2733s/iter; left time: 11126.3271s
	iters: 200, epoch: 14 | loss: 0.0307924
	speed: 0.0611s/iter; left time: 2479.3797s
	iters: 300, epoch: 14 | loss: 0.0035729
	speed: 0.0599s/iter; left time: 2425.3176s
	iters: 400, epoch: 14 | loss: 0.0038550
	speed: 0.0660s/iter; left time: 2665.8338s
Epoch: 14 cost time: 29.449836492538452
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.967409).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0304454
	speed: 0.2791s/iter; left time: 11228.1922s
	iters: 200, epoch: 15 | loss: 0.0026460
	speed: 0.0639s/iter; left time: 2563.2452s
	iters: 300, epoch: 15 | loss: 0.0042625
	speed: 0.0612s/iter; left time: 2449.2640s
	iters: 400, epoch: 15 | loss: 0.1056401
	speed: 0.0659s/iter; left time: 2632.2309s
Epoch: 15 cost time: 29.96143078804016
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0016903
	speed: 0.2765s/iter; left time: 10994.8458s
	iters: 200, epoch: 16 | loss: 0.0014560
	speed: 0.0594s/iter; left time: 2356.4942s
	iters: 300, epoch: 16 | loss: 0.0035863
	speed: 0.0615s/iter; left time: 2431.7412s
	iters: 400, epoch: 16 | loss: 0.1449485
	speed: 0.0600s/iter; left time: 2367.0041s
Epoch: 16 cost time: 28.765255212783813
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2641101
	speed: 0.2823s/iter; left time: 11093.3575s
	iters: 200, epoch: 17 | loss: 0.0033792
	speed: 0.0632s/iter; left time: 2476.0914s
	iters: 300, epoch: 17 | loss: 0.0015134
	speed: 0.0603s/iter; left time: 2357.2946s
	iters: 400, epoch: 17 | loss: 0.0028127
	speed: 0.0621s/iter; left time: 2422.3955s
Epoch: 17 cost time: 29.9212486743927
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0188433
	speed: 0.2817s/iter; left time: 10936.0066s
	iters: 200, epoch: 18 | loss: 0.1436186
	speed: 0.0614s/iter; left time: 2379.1507s
	iters: 300, epoch: 18 | loss: 0.0011331
	speed: 0.0621s/iter; left time: 2399.4419s
	iters: 400, epoch: 18 | loss: 0.0479449
	speed: 0.0615s/iter; left time: 2367.5637s
Epoch: 18 cost time: 29.540733814239502
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0135758
	speed: 0.3026s/iter; left time: 11608.5359s
	iters: 200, epoch: 19 | loss: 0.1671976
	speed: 0.0738s/iter; left time: 2822.0327s
	iters: 300, epoch: 19 | loss: 0.0034064
	speed: 0.0675s/iter; left time: 2577.4329s
	iters: 400, epoch: 19 | loss: 0.0033505
	speed: 0.0682s/iter; left time: 2594.7705s
Epoch: 19 cost time: 32.69749069213867
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0017310
	speed: 0.3111s/iter; left time: 11788.8987s
	iters: 200, epoch: 20 | loss: 0.0052253
	speed: 0.0751s/iter; left time: 2837.2933s
	iters: 300, epoch: 20 | loss: 0.0061845
	speed: 0.0728s/iter; left time: 2745.7107s
	iters: 400, epoch: 20 | loss: 0.0021968
	speed: 0.0679s/iter; left time: 2551.4822s
Epoch: 20 cost time: 33.83531403541565
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.945 Test Loss: 0.228 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0012701
	speed: 0.3042s/iter; left time: 11383.9834s
	iters: 200, epoch: 21 | loss: 0.0177620
	speed: 0.0623s/iter; left time: 2326.7787s
	iters: 300, epoch: 21 | loss: 0.0005283
	speed: 0.0628s/iter; left time: 2336.4604s
	iters: 400, epoch: 21 | loss: 0.0380000
	speed: 0.0614s/iter; left time: 2277.4531s
Epoch: 21 cost time: 29.70400834083557
Epoch: 21, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0023989
	speed: 0.2851s/iter; left time: 10535.3085s
	iters: 200, epoch: 22 | loss: 0.0139999
	speed: 0.0651s/iter; left time: 2400.5881s
	iters: 300, epoch: 22 | loss: 0.0010563
	speed: 0.0648s/iter; left time: 2381.5582s
	iters: 400, epoch: 22 | loss: 0.4061197
	speed: 0.0676s/iter; left time: 2478.8427s
Epoch: 22 cost time: 31.219939708709717
Epoch: 22, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0586193
	speed: 0.2830s/iter; left time: 10326.0749s
	iters: 200, epoch: 23 | loss: 0.0226711
	speed: 0.0643s/iter; left time: 2340.9848s
	iters: 300, epoch: 23 | loss: 0.0274273
	speed: 0.0655s/iter; left time: 2377.6333s
	iters: 400, epoch: 23 | loss: 0.0082078
	speed: 0.0651s/iter; left time: 2355.2565s
Epoch: 23 cost time: 30.63654851913452
Epoch: 23, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0071218
	speed: 0.2695s/iter; left time: 9706.6042s
	iters: 200, epoch: 24 | loss: 0.0039922
	speed: 0.0617s/iter; left time: 2215.3843s
	iters: 300, epoch: 24 | loss: 0.0018881
	speed: 0.0661s/iter; left time: 2367.8072s
	iters: 400, epoch: 24 | loss: 0.2051318
	speed: 0.0652s/iter; left time: 2329.8735s
Epoch: 24 cost time: 30.34809899330139
Epoch: 24, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.967409948542024
model parameter : 709178
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2382606
	speed: 0.0756s/iter; left time: 3538.4683s
	iters: 200, epoch: 1 | loss: 0.5151547
	speed: 0.0603s/iter; left time: 2817.7809s
	iters: 300, epoch: 1 | loss: 0.1898840
	speed: 0.0611s/iter; left time: 2848.9300s
	iters: 400, epoch: 1 | loss: 0.1034327
	speed: 0.0601s/iter; left time: 2796.5048s
Epoch: 1 cost time: 30.2868435382843
Epoch: 1, Steps: 469 | Train Loss: 0.687 Vali Loss: 0.289 Vali Acc: 0.913 Test Loss: 0.289 Test Acc: 0.913
Validation loss decreased (inf --> -0.912804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0475084
	speed: 0.2840s/iter; left time: 13160.1173s
	iters: 200, epoch: 2 | loss: 0.6625241
	speed: 0.0646s/iter; left time: 2984.5847s
	iters: 300, epoch: 2 | loss: 0.0653546
	speed: 0.0641s/iter; left time: 2959.1380s
	iters: 400, epoch: 2 | loss: 0.0609082
	speed: 0.0628s/iter; left time: 2890.5219s
Epoch: 2 cost time: 30.235177516937256
Epoch: 2, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.912804 --> -0.919380).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0154481
	speed: 0.2796s/iter; left time: 12824.1099s
	iters: 200, epoch: 3 | loss: 0.6619042
	speed: 0.0637s/iter; left time: 2914.5390s
	iters: 300, epoch: 3 | loss: 0.1389481
	speed: 0.0616s/iter; left time: 2813.1742s
	iters: 400, epoch: 3 | loss: 0.1015903
	speed: 0.0640s/iter; left time: 2914.7284s
Epoch: 3 cost time: 30.43028712272644
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.919380 --> -0.949684).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0724867
	speed: 0.2791s/iter; left time: 12670.8236s
	iters: 200, epoch: 4 | loss: 0.4528655
	speed: 0.0641s/iter; left time: 2902.8250s
	iters: 300, epoch: 4 | loss: 0.1233146
	speed: 0.0623s/iter; left time: 2813.5793s
	iters: 400, epoch: 4 | loss: 0.1715781
	speed: 0.0621s/iter; left time: 2799.4586s
Epoch: 4 cost time: 30.128199815750122
Epoch: 4, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.262 Vali Acc: 0.923 Test Loss: 0.262 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0030799
	speed: 0.2879s/iter; left time: 12933.8522s
	iters: 200, epoch: 5 | loss: 0.0122131
	speed: 0.0673s/iter; left time: 3016.0765s
	iters: 300, epoch: 5 | loss: 0.1402534
	speed: 0.0673s/iter; left time: 3011.9552s
	iters: 400, epoch: 5 | loss: 0.0438524
	speed: 0.0672s/iter; left time: 2997.0645s
Epoch: 5 cost time: 31.72424626350403
Epoch: 5, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.949684 --> -0.971983).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4880258
	speed: 0.2977s/iter; left time: 13236.4875s
	iters: 200, epoch: 6 | loss: 0.0096487
	speed: 0.0654s/iter; left time: 2902.0876s
	iters: 300, epoch: 6 | loss: 0.0056614
	speed: 0.0657s/iter; left time: 2908.0266s
	iters: 400, epoch: 6 | loss: 0.0566741
	speed: 0.0650s/iter; left time: 2868.8358s
Epoch: 6 cost time: 31.084407567977905
Epoch: 6, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0277142
	speed: 0.3017s/iter; left time: 13270.8904s
	iters: 200, epoch: 7 | loss: 0.0076908
	speed: 0.0626s/iter; left time: 2747.6632s
	iters: 300, epoch: 7 | loss: 0.0021432
	speed: 0.0636s/iter; left time: 2782.6794s
	iters: 400, epoch: 7 | loss: 0.1127599
	speed: 0.0621s/iter; left time: 2711.5619s
Epoch: 7 cost time: 30.137187242507935
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0039031
	speed: 0.2609s/iter; left time: 11355.5497s
	iters: 200, epoch: 8 | loss: 0.0230918
	speed: 0.0603s/iter; left time: 2619.3190s
	iters: 300, epoch: 8 | loss: 0.0258076
	speed: 0.0617s/iter; left time: 2672.3838s
	iters: 400, epoch: 8 | loss: 0.1130589
	speed: 0.0599s/iter; left time: 2587.9282s
Epoch: 8 cost time: 29.151592016220093
Epoch: 8, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0113060
	speed: 0.2799s/iter; left time: 12048.8799s
	iters: 200, epoch: 9 | loss: 0.0048586
	speed: 0.0659s/iter; left time: 2830.6602s
	iters: 300, epoch: 9 | loss: 0.0104181
	speed: 0.0624s/iter; left time: 2673.3924s
	iters: 400, epoch: 9 | loss: 0.0013261
	speed: 0.0642s/iter; left time: 2744.3671s
Epoch: 9 cost time: 30.500255823135376
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0020856
	speed: 0.2828s/iter; left time: 12040.4166s
	iters: 200, epoch: 10 | loss: 0.0171374
	speed: 0.0628s/iter; left time: 2669.7661s
	iters: 300, epoch: 10 | loss: 0.0009893
	speed: 0.0625s/iter; left time: 2648.3458s
	iters: 400, epoch: 10 | loss: 0.0026364
	speed: 0.0619s/iter; left time: 2619.0118s
Epoch: 10 cost time: 29.741885900497437
Epoch: 10, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0377006
	speed: 0.2742s/iter; left time: 11544.9488s
	iters: 200, epoch: 11 | loss: 0.0160965
	speed: 0.0632s/iter; left time: 2656.1961s
	iters: 300, epoch: 11 | loss: 0.0100099
	speed: 0.0611s/iter; left time: 2559.5638s
	iters: 400, epoch: 11 | loss: 0.0033512
	speed: 0.0620s/iter; left time: 2591.1926s
Epoch: 11 cost time: 29.23995018005371
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0216699
	speed: 0.2749s/iter; left time: 11447.4600s
	iters: 200, epoch: 12 | loss: 0.0017902
	speed: 0.0612s/iter; left time: 2541.0319s
	iters: 300, epoch: 12 | loss: 0.0023207
	speed: 0.0625s/iter; left time: 2589.4181s
	iters: 400, epoch: 12 | loss: 0.2291137
	speed: 0.0598s/iter; left time: 2473.7071s
Epoch: 12 cost time: 29.269901514053345
Epoch: 12, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0013999
	speed: 0.2791s/iter; left time: 11489.6547s
	iters: 200, epoch: 13 | loss: 0.0124476
	speed: 0.0587s/iter; left time: 2409.3726s
	iters: 300, epoch: 13 | loss: 0.0030190
	speed: 0.0602s/iter; left time: 2468.0567s
	iters: 400, epoch: 13 | loss: 0.0017762
	speed: 0.0624s/iter; left time: 2548.5326s
Epoch: 13 cost time: 28.869618892669678
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1417837
	speed: 0.2678s/iter; left time: 10901.7917s
	iters: 200, epoch: 14 | loss: 0.0029178
	speed: 0.0599s/iter; left time: 2432.7509s
	iters: 300, epoch: 14 | loss: 0.0073830
	speed: 0.0612s/iter; left time: 2479.8668s
	iters: 400, epoch: 14 | loss: 0.0445450
	speed: 0.0602s/iter; left time: 2431.9751s
Epoch: 14 cost time: 28.49236273765564
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.318 Vali Acc: 0.934 Test Loss: 0.318 Test Acc: 0.934
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0039878
	speed: 0.2693s/iter; left time: 10833.7069s
	iters: 200, epoch: 15 | loss: 0.1176226
	speed: 0.0603s/iter; left time: 2422.1421s
	iters: 300, epoch: 15 | loss: 0.0108605
	speed: 0.0606s/iter; left time: 2425.9139s
	iters: 400, epoch: 15 | loss: 0.0821209
	speed: 0.0622s/iter; left time: 2483.6859s
Epoch: 15 cost time: 28.998100757598877
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 708986
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1038249
	speed: 0.0832s/iter; left time: 3892.7810s
	iters: 200, epoch: 1 | loss: 0.6972311
	speed: 0.0637s/iter; left time: 2972.6160s
	iters: 300, epoch: 1 | loss: 0.2331572
	speed: 0.0587s/iter; left time: 2737.1811s
	iters: 400, epoch: 1 | loss: 0.1934607
	speed: 0.0597s/iter; left time: 2773.8219s
Epoch: 1 cost time: 30.78879714012146
Epoch: 1, Steps: 469 | Train Loss: 0.681 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (inf --> -0.899939).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1127755
	speed: 0.2798s/iter; left time: 12965.8846s
	iters: 200, epoch: 2 | loss: 0.2128651
	speed: 0.0627s/iter; left time: 2898.7965s
	iters: 300, epoch: 2 | loss: 0.1347538
	speed: 0.0614s/iter; left time: 2832.5627s
	iters: 400, epoch: 2 | loss: 1.0289091
	speed: 0.0615s/iter; left time: 2832.5210s
Epoch: 2 cost time: 29.295567274093628
Epoch: 2, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.403 Vali Acc: 0.887 Test Loss: 0.403 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0238484
	speed: 0.2841s/iter; left time: 13029.5495s
	iters: 200, epoch: 3 | loss: 0.0192260
	speed: 0.0633s/iter; left time: 2897.9356s
	iters: 300, epoch: 3 | loss: 0.0829514
	speed: 0.0627s/iter; left time: 2862.1375s
	iters: 400, epoch: 3 | loss: 0.0107675
	speed: 0.0653s/iter; left time: 2976.5491s
Epoch: 3 cost time: 30.02503991127014
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.303 Vali Acc: 0.893 Test Loss: 0.303 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1365635
	speed: 0.2674s/iter; left time: 12137.3958s
	iters: 200, epoch: 4 | loss: 0.3042793
	speed: 0.0609s/iter; left time: 2758.2326s
	iters: 300, epoch: 4 | loss: 0.0192069
	speed: 0.0585s/iter; left time: 2644.9866s
	iters: 400, epoch: 4 | loss: 0.0475222
	speed: 0.0603s/iter; left time: 2719.6871s
Epoch: 4 cost time: 28.517658710479736
Epoch: 4, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.899939 --> -0.959976).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0440404
	speed: 0.2661s/iter; left time: 11955.7765s
	iters: 200, epoch: 5 | loss: 0.1637695
	speed: 0.0660s/iter; left time: 2958.3697s
	iters: 300, epoch: 5 | loss: 0.0301224
	speed: 0.0698s/iter; left time: 3123.1362s
	iters: 400, epoch: 5 | loss: 0.0699580
	speed: 0.0655s/iter; left time: 2924.3600s
Epoch: 5 cost time: 31.40316390991211
Epoch: 5, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
Validation loss decreased (-0.959976 --> -0.961405).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0065199
	speed: 0.2841s/iter; left time: 12627.8454s
	iters: 200, epoch: 6 | loss: 0.0475577
	speed: 0.0627s/iter; left time: 2780.3212s
	iters: 300, epoch: 6 | loss: 0.1470045
	speed: 0.0628s/iter; left time: 2779.0586s
	iters: 400, epoch: 6 | loss: 0.0033608
	speed: 0.0595s/iter; left time: 2626.2206s
Epoch: 6 cost time: 29.76836085319519
Epoch: 6, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.231 Vali Acc: 0.945 Test Loss: 0.231 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2930014
	speed: 0.2704s/iter; left time: 11893.1216s
	iters: 200, epoch: 7 | loss: 0.0039100
	speed: 0.0591s/iter; left time: 2593.8382s
	iters: 300, epoch: 7 | loss: 0.2277583
	speed: 0.0585s/iter; left time: 2562.8162s
	iters: 400, epoch: 7 | loss: 0.0043253
	speed: 0.0580s/iter; left time: 2534.0844s
Epoch: 7 cost time: 27.875542163848877
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.348 Vali Acc: 0.910 Test Loss: 0.348 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0313454
	speed: 0.2638s/iter; left time: 11480.6753s
	iters: 200, epoch: 8 | loss: 0.0912604
	speed: 0.0583s/iter; left time: 2530.0450s
	iters: 300, epoch: 8 | loss: 0.0460140
	speed: 0.0621s/iter; left time: 2687.9438s
	iters: 400, epoch: 8 | loss: 0.1118567
	speed: 0.0581s/iter; left time: 2509.3786s
Epoch: 8 cost time: 28.095053672790527
Epoch: 8, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0017745
	speed: 0.2645s/iter; left time: 11387.2962s
	iters: 200, epoch: 9 | loss: 0.1797128
	speed: 0.0592s/iter; left time: 2541.3057s
	iters: 300, epoch: 9 | loss: 0.0387619
	speed: 0.0608s/iter; left time: 2604.0605s
	iters: 400, epoch: 9 | loss: 0.1284197
	speed: 0.0594s/iter; left time: 2538.3901s
Epoch: 9 cost time: 28.5479679107666
Epoch: 9, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.961405 --> -0.962548).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3329096
	speed: 0.2768s/iter; left time: 11784.9330s
	iters: 200, epoch: 10 | loss: 0.1113234
	speed: 0.0568s/iter; left time: 2413.5659s
	iters: 300, epoch: 10 | loss: 0.0138511
	speed: 0.0638s/iter; left time: 2705.1021s
	iters: 400, epoch: 10 | loss: 0.0463294
	speed: 0.0591s/iter; left time: 2500.5610s
Epoch: 10 cost time: 28.6546847820282
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0167401
	speed: 0.2692s/iter; left time: 11337.4305s
	iters: 200, epoch: 11 | loss: 0.0044756
	speed: 0.0615s/iter; left time: 2583.6603s
	iters: 300, epoch: 11 | loss: 0.0104581
	speed: 0.0616s/iter; left time: 2579.9967s
	iters: 400, epoch: 11 | loss: 0.0104519
	speed: 0.0624s/iter; left time: 2608.5299s
Epoch: 11 cost time: 29.20320749282837
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.962548 --> -0.968838).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0066460
	speed: 0.2915s/iter; left time: 12137.4344s
	iters: 200, epoch: 12 | loss: 0.0093199
	speed: 0.0636s/iter; left time: 2641.0121s
	iters: 300, epoch: 12 | loss: 0.4345552
	speed: 0.0634s/iter; left time: 2626.4277s
	iters: 400, epoch: 12 | loss: 0.0063570
	speed: 0.0629s/iter; left time: 2599.6460s
Epoch: 12 cost time: 30.22390651702881
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0060809
	speed: 0.2958s/iter; left time: 12177.7863s
	iters: 200, epoch: 13 | loss: 0.0033242
	speed: 0.0614s/iter; left time: 2523.0678s
	iters: 300, epoch: 13 | loss: 0.0137600
	speed: 0.0627s/iter; left time: 2568.6220s
	iters: 400, epoch: 13 | loss: 0.1866609
	speed: 0.0609s/iter; left time: 2490.6472s
Epoch: 13 cost time: 29.736509799957275
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3502241
	speed: 0.2609s/iter; left time: 10619.3197s
	iters: 200, epoch: 14 | loss: 0.4751011
	speed: 0.0612s/iter; left time: 2484.3424s
	iters: 300, epoch: 14 | loss: 0.0028849
	speed: 0.0601s/iter; left time: 2435.0566s
	iters: 400, epoch: 14 | loss: 0.0031077
	speed: 0.0589s/iter; left time: 2379.3211s
Epoch: 14 cost time: 28.057904481887817
Epoch: 14, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0042637
	speed: 0.2667s/iter; left time: 10731.7011s
	iters: 200, epoch: 15 | loss: 0.0020801
	speed: 0.0606s/iter; left time: 2430.6337s
	iters: 300, epoch: 15 | loss: 0.0025895
	speed: 0.0612s/iter; left time: 2449.0094s
	iters: 400, epoch: 15 | loss: 0.8161483
	speed: 0.0588s/iter; left time: 2348.4169s
Epoch: 15 cost time: 28.50498914718628
Epoch: 15, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0110261
	speed: 0.2748s/iter; left time: 10926.3337s
	iters: 200, epoch: 16 | loss: 0.0017749
	speed: 0.0607s/iter; left time: 2406.7267s
	iters: 300, epoch: 16 | loss: 0.0134196
	speed: 0.0581s/iter; left time: 2299.0228s
	iters: 400, epoch: 16 | loss: 0.0086070
	speed: 0.0601s/iter; left time: 2370.8907s
Epoch: 16 cost time: 28.70766854286194
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.968838 --> -0.975413).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0011269
	speed: 0.2676s/iter; left time: 10516.3984s
	iters: 200, epoch: 17 | loss: 0.0021286
	speed: 0.0596s/iter; left time: 2336.6120s
	iters: 300, epoch: 17 | loss: 0.0110470
	speed: 0.0621s/iter; left time: 2426.4131s
	iters: 400, epoch: 17 | loss: 0.0020002
	speed: 0.0605s/iter; left time: 2360.4332s
Epoch: 17 cost time: 28.53597664833069
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.942 Test Loss: 0.272 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0011252
	speed: 0.2676s/iter; left time: 10390.0110s
	iters: 200, epoch: 18 | loss: 0.0104537
	speed: 0.0606s/iter; left time: 2345.8558s
	iters: 300, epoch: 18 | loss: 0.0162584
	speed: 0.0597s/iter; left time: 2305.3000s
	iters: 400, epoch: 18 | loss: 0.2532135
	speed: 0.0607s/iter; left time: 2338.6262s
Epoch: 18 cost time: 29.09648895263672
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0048923
	speed: 0.2770s/iter; left time: 10626.8843s
	iters: 200, epoch: 19 | loss: 0.0098251
	speed: 0.0580s/iter; left time: 2220.2280s
	iters: 300, epoch: 19 | loss: 0.0038187
	speed: 0.0609s/iter; left time: 2322.7781s
	iters: 400, epoch: 19 | loss: 0.0382216
	speed: 0.0603s/iter; left time: 2295.8841s
Epoch: 19 cost time: 28.66469168663025
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0009285
	speed: 0.2747s/iter; left time: 10407.5981s
	iters: 200, epoch: 20 | loss: 0.0027436
	speed: 0.0634s/iter; left time: 2394.4385s
	iters: 300, epoch: 20 | loss: 0.0320234
	speed: 0.0678s/iter; left time: 2556.4512s
	iters: 400, epoch: 20 | loss: 0.0019420
	speed: 0.0620s/iter; left time: 2330.2876s
Epoch: 20 cost time: 30.161709308624268
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.945 Test Loss: 0.199 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1788071
	speed: 0.2760s/iter; left time: 10327.7945s
	iters: 200, epoch: 21 | loss: 0.0277984
	speed: 0.0594s/iter; left time: 2217.5180s
	iters: 300, epoch: 21 | loss: 0.0010021
	speed: 0.0601s/iter; left time: 2237.2943s
	iters: 400, epoch: 21 | loss: 0.0014636
	speed: 0.0576s/iter; left time: 2139.8043s
Epoch: 21 cost time: 28.26680302619934
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.966 Test Loss: 0.206 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0051297
	speed: 0.2680s/iter; left time: 9902.0868s
	iters: 200, epoch: 22 | loss: 0.0049597
	speed: 0.0597s/iter; left time: 2201.5773s
	iters: 300, epoch: 22 | loss: 0.0037218
	speed: 0.0584s/iter; left time: 2146.6196s
	iters: 400, epoch: 22 | loss: 0.0012317
	speed: 0.0582s/iter; left time: 2133.1486s
Epoch: 22 cost time: 28.222725868225098
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0093746
	speed: 0.2936s/iter; left time: 10711.2121s
	iters: 200, epoch: 23 | loss: 0.0040378
	speed: 0.0630s/iter; left time: 2291.2078s
	iters: 300, epoch: 23 | loss: 0.1645599
	speed: 0.0652s/iter; left time: 2364.5494s
	iters: 400, epoch: 23 | loss: 0.0019636
	speed: 0.0636s/iter; left time: 2302.8628s
Epoch: 23 cost time: 30.197261333465576
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0397041
	speed: 0.2919s/iter; left time: 10511.8665s
	iters: 200, epoch: 24 | loss: 0.0010091
	speed: 0.0625s/iter; left time: 2243.5959s
	iters: 300, epoch: 24 | loss: 0.0239270
	speed: 0.0620s/iter; left time: 2221.6704s
	iters: 400, epoch: 24 | loss: 0.1394299
	speed: 0.0647s/iter; left time: 2309.5919s
Epoch: 24 cost time: 30.013900995254517
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0012760
	speed: 0.2967s/iter; left time: 10546.2324s
	iters: 200, epoch: 25 | loss: 0.0253206
	speed: 0.0629s/iter; left time: 2229.9194s
	iters: 300, epoch: 25 | loss: 0.0770412
	speed: 0.0653s/iter; left time: 2306.8122s
	iters: 400, epoch: 25 | loss: 0.0012279
	speed: 0.0623s/iter; left time: 2195.5823s
Epoch: 25 cost time: 30.60251498222351
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0019073
	speed: 0.2803s/iter; left time: 9832.8932s
	iters: 200, epoch: 26 | loss: 0.0164946
	speed: 0.0627s/iter; left time: 2191.8573s
	iters: 300, epoch: 26 | loss: 0.0030975
	speed: 0.0621s/iter; left time: 2165.2794s
	iters: 400, epoch: 26 | loss: 0.0033212
	speed: 0.0616s/iter; left time: 2142.1411s
Epoch: 26 cost time: 29.510714769363403
Epoch: 26, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 708794
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7351122
	speed: 0.0734s/iter; left time: 3433.6955s
	iters: 200, epoch: 1 | loss: 0.4580834
	speed: 0.0603s/iter; left time: 2815.8483s
	iters: 300, epoch: 1 | loss: 0.1964077
	speed: 0.0610s/iter; left time: 2841.6013s
	iters: 400, epoch: 1 | loss: 0.0654076
	speed: 0.0644s/iter; left time: 2993.8351s
Epoch: 1 cost time: 30.350076913833618
Epoch: 1, Steps: 469 | Train Loss: 0.679 Vali Loss: 0.391 Vali Acc: 0.879 Test Loss: 0.391 Test Acc: 0.879
Validation loss decreased (inf --> -0.878784).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2044238
	speed: 0.2727s/iter; left time: 12633.0033s
	iters: 200, epoch: 2 | loss: 0.1275898
	speed: 0.0601s/iter; left time: 2778.8943s
	iters: 300, epoch: 2 | loss: 0.1030074
	speed: 0.0578s/iter; left time: 2665.7419s
	iters: 400, epoch: 2 | loss: 0.1627845
	speed: 0.0581s/iter; left time: 2673.5900s
Epoch: 2 cost time: 28.764606714248657
Epoch: 2, Steps: 469 | Train Loss: 0.172 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
Validation loss decreased (-0.878784 --> -0.938534).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0933164
	speed: 0.2710s/iter; left time: 12429.6547s
	iters: 200, epoch: 3 | loss: 0.2312092
	speed: 0.0621s/iter; left time: 2843.8761s
	iters: 300, epoch: 3 | loss: 0.3437533
	speed: 0.0603s/iter; left time: 2752.4401s
	iters: 400, epoch: 3 | loss: 0.2517733
	speed: 0.0589s/iter; left time: 2683.2289s
Epoch: 3 cost time: 28.585216522216797
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.202 Vali Acc: 0.936 Test Loss: 0.202 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0905994
	speed: 0.2360s/iter; left time: 10712.8382s
	iters: 200, epoch: 4 | loss: 0.0590385
	speed: 0.0585s/iter; left time: 2650.7949s
	iters: 300, epoch: 4 | loss: 0.0831830
	speed: 0.0590s/iter; left time: 2667.0211s
	iters: 400, epoch: 4 | loss: 0.1559679
	speed: 0.0620s/iter; left time: 2794.5285s
Epoch: 4 cost time: 28.820409297943115
Epoch: 4, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.306 Vali Acc: 0.909 Test Loss: 0.306 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3243057
	speed: 0.2759s/iter; left time: 12394.1393s
	iters: 200, epoch: 5 | loss: 0.2759114
	speed: 0.0611s/iter; left time: 2740.5364s
	iters: 300, epoch: 5 | loss: 0.1216408
	speed: 0.0569s/iter; left time: 2544.4464s
	iters: 400, epoch: 5 | loss: 0.0137114
	speed: 0.0574s/iter; left time: 2560.0894s
Epoch: 5 cost time: 27.736484050750732
Epoch: 5, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.938534 --> -0.949112).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0133274
	speed: 0.2738s/iter; left time: 12173.1297s
	iters: 200, epoch: 6 | loss: 0.1262141
	speed: 0.0589s/iter; left time: 2612.0247s
	iters: 300, epoch: 6 | loss: 0.1354659
	speed: 0.0606s/iter; left time: 2683.7589s
	iters: 400, epoch: 6 | loss: 0.4244553
	speed: 0.0632s/iter; left time: 2791.1414s
Epoch: 6 cost time: 28.720048666000366
Epoch: 6, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
Validation loss decreased (-0.949112 --> -0.952828).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0074449
	speed: 0.2833s/iter; left time: 12460.4587s
	iters: 200, epoch: 7 | loss: 0.0116338
	speed: 0.0622s/iter; left time: 2729.5427s
	iters: 300, epoch: 7 | loss: 0.7621444
	speed: 0.0647s/iter; left time: 2833.3999s
	iters: 400, epoch: 7 | loss: 0.0576140
	speed: 0.0621s/iter; left time: 2711.1788s
Epoch: 7 cost time: 29.917369842529297
Epoch: 7, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.952828 --> -0.968838).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0341338
	speed: 0.2827s/iter; left time: 12300.4995s
	iters: 200, epoch: 8 | loss: 0.1499668
	speed: 0.0615s/iter; left time: 2671.4141s
	iters: 300, epoch: 8 | loss: 0.0452341
	speed: 0.0616s/iter; left time: 2669.4829s
	iters: 400, epoch: 8 | loss: 0.0052285
	speed: 0.0616s/iter; left time: 2661.8330s
Epoch: 8 cost time: 29.030561685562134
Epoch: 8, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.192 Vali Acc: 0.961 Test Loss: 0.192 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2333742
	speed: 0.2926s/iter; left time: 12594.6073s
	iters: 200, epoch: 9 | loss: 0.1211261
	speed: 0.0619s/iter; left time: 2660.5667s
	iters: 300, epoch: 9 | loss: 0.2082487
	speed: 0.0630s/iter; left time: 2698.6430s
	iters: 400, epoch: 9 | loss: 0.5181113
	speed: 0.0622s/iter; left time: 2656.9924s
Epoch: 9 cost time: 29.77272367477417
Epoch: 9, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0358190
	speed: 0.2698s/iter; left time: 11486.0109s
	iters: 200, epoch: 10 | loss: 0.2589607
	speed: 0.0566s/iter; left time: 2406.4447s
	iters: 300, epoch: 10 | loss: 0.1755958
	speed: 0.0592s/iter; left time: 2508.8764s
	iters: 400, epoch: 10 | loss: 0.1034430
	speed: 0.0562s/iter; left time: 2377.2472s
Epoch: 10 cost time: 27.619725704193115
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0015621
	speed: 0.2725s/iter; left time: 11473.6145s
	iters: 200, epoch: 11 | loss: 0.2210873
	speed: 0.0609s/iter; left time: 2558.0568s
	iters: 300, epoch: 11 | loss: 0.3388066
	speed: 0.0618s/iter; left time: 2589.9319s
	iters: 400, epoch: 11 | loss: 0.0059738
	speed: 0.0626s/iter; left time: 2618.2860s
Epoch: 11 cost time: 29.344727993011475
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0128364
	speed: 0.2786s/iter; left time: 11600.3300s
	iters: 200, epoch: 12 | loss: 0.3649017
	speed: 0.0623s/iter; left time: 2589.1708s
	iters: 300, epoch: 12 | loss: 0.2822808
	speed: 0.0640s/iter; left time: 2651.1104s
	iters: 400, epoch: 12 | loss: 0.0006580
	speed: 0.0618s/iter; left time: 2555.7945s
Epoch: 12 cost time: 29.72279453277588
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0336716
	speed: 0.2667s/iter; left time: 10979.0756s
	iters: 200, epoch: 13 | loss: 0.0523104
	speed: 0.0636s/iter; left time: 2611.0849s
	iters: 300, epoch: 13 | loss: 0.0953352
	speed: 0.0610s/iter; left time: 2500.1149s
	iters: 400, epoch: 13 | loss: 0.0080089
	speed: 0.0605s/iter; left time: 2474.8172s
Epoch: 13 cost time: 29.355076551437378
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0020113
	speed: 0.2782s/iter; left time: 11322.5058s
	iters: 200, epoch: 14 | loss: 0.0028704
	speed: 0.0618s/iter; left time: 2510.5693s
	iters: 300, epoch: 14 | loss: 0.0025828
	speed: 0.0623s/iter; left time: 2522.2371s
	iters: 400, epoch: 14 | loss: 0.1062486
	speed: 0.0614s/iter; left time: 2482.4695s
Epoch: 14 cost time: 29.840749979019165
Epoch: 14, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0127220
	speed: 0.2668s/iter; left time: 10735.9611s
	iters: 200, epoch: 15 | loss: 0.0039870
	speed: 0.0610s/iter; left time: 2450.0960s
	iters: 300, epoch: 15 | loss: 0.0012646
	speed: 0.0587s/iter; left time: 2348.3751s
	iters: 400, epoch: 15 | loss: 0.0033193
	speed: 0.0564s/iter; left time: 2252.3876s
Epoch: 15 cost time: 27.803977251052856
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2844630
	speed: 0.2567s/iter; left time: 10208.1868s
	iters: 200, epoch: 16 | loss: 0.0150977
	speed: 0.0584s/iter; left time: 2315.8867s
	iters: 300, epoch: 16 | loss: 0.0177196
	speed: 0.0610s/iter; left time: 2414.7905s
	iters: 400, epoch: 16 | loss: 0.0912171
	speed: 0.0625s/iter; left time: 2465.7989s
Epoch: 16 cost time: 28.27592158317566
Epoch: 16, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0121346
	speed: 0.2663s/iter; left time: 10465.5096s
	iters: 200, epoch: 17 | loss: 0.0023295
	speed: 0.0597s/iter; left time: 2339.1411s
	iters: 300, epoch: 17 | loss: 0.0027588
	speed: 0.0571s/iter; left time: 2233.2156s
	iters: 400, epoch: 17 | loss: 0.0010744
	speed: 0.0582s/iter; left time: 2270.1465s
Epoch: 17 cost time: 28.060100555419922
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.968839336763865
model parameter : 708602
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1559871
	speed: 0.0817s/iter; left time: 3824.1838s
	iters: 200, epoch: 1 | loss: 0.3490950
	speed: 0.0660s/iter; left time: 3083.8333s
	iters: 300, epoch: 1 | loss: 0.2921433
	speed: 0.0691s/iter; left time: 3221.4766s
	iters: 400, epoch: 1 | loss: 0.0854351
	speed: 0.0725s/iter; left time: 3369.6306s
Epoch: 1 cost time: 33.46457481384277
Epoch: 1, Steps: 469 | Train Loss: 0.691 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
Validation loss decreased (inf --> -0.903370).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7269603
	speed: 0.2923s/iter; left time: 13541.7228s
	iters: 200, epoch: 2 | loss: 0.0854848
	speed: 0.0595s/iter; left time: 2752.9200s
	iters: 300, epoch: 2 | loss: 0.1306410
	speed: 0.0632s/iter; left time: 2913.7079s
	iters: 400, epoch: 2 | loss: 0.2355514
	speed: 0.0641s/iter; left time: 2951.3912s
Epoch: 2 cost time: 30.00029468536377
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.208 Vali Acc: 0.936 Test Loss: 0.208 Test Acc: 0.936
Validation loss decreased (-0.903370 --> -0.936247).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1432393
	speed: 0.3021s/iter; left time: 13855.2305s
	iters: 200, epoch: 3 | loss: 0.0987709
	speed: 0.0652s/iter; left time: 2982.1937s
	iters: 300, epoch: 3 | loss: 0.2909992
	speed: 0.0631s/iter; left time: 2881.1966s
	iters: 400, epoch: 3 | loss: 0.1653324
	speed: 0.0614s/iter; left time: 2796.5851s
Epoch: 3 cost time: 30.46150302886963
Epoch: 3, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.292 Vali Acc: 0.918 Test Loss: 0.292 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0318096
	speed: 0.2656s/iter; left time: 12054.4051s
	iters: 200, epoch: 4 | loss: 0.0046018
	speed: 0.0599s/iter; left time: 2713.4414s
	iters: 300, epoch: 4 | loss: 0.0308265
	speed: 0.0609s/iter; left time: 2752.5095s
	iters: 400, epoch: 4 | loss: 0.3801128
	speed: 0.0595s/iter; left time: 2684.0003s
Epoch: 4 cost time: 28.770057916641235
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.256 Vali Acc: 0.940 Test Loss: 0.256 Test Acc: 0.940
Validation loss decreased (-0.936247 --> -0.940249).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3172640
	speed: 0.2736s/iter; left time: 12291.8995s
	iters: 200, epoch: 5 | loss: 0.0229680
	speed: 0.0601s/iter; left time: 2692.5465s
	iters: 300, epoch: 5 | loss: 0.2975595
	speed: 0.0625s/iter; left time: 2796.8716s
	iters: 400, epoch: 5 | loss: 0.0067366
	speed: 0.0638s/iter; left time: 2846.1631s
Epoch: 5 cost time: 29.553823471069336
Epoch: 5, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.940249 --> -0.954258).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0086232
	speed: 0.2781s/iter; left time: 12364.5381s
	iters: 200, epoch: 6 | loss: 0.0054914
	speed: 0.0638s/iter; left time: 2830.4677s
	iters: 300, epoch: 6 | loss: 0.0582224
	speed: 0.0649s/iter; left time: 2874.2365s
	iters: 400, epoch: 6 | loss: 0.4711453
	speed: 0.0647s/iter; left time: 2856.7013s
Epoch: 6 cost time: 30.17896795272827
Epoch: 6, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0067354
	speed: 0.2699s/iter; left time: 11873.7087s
	iters: 200, epoch: 7 | loss: 0.0165641
	speed: 0.0604s/iter; left time: 2649.0971s
	iters: 300, epoch: 7 | loss: 0.0107959
	speed: 0.0596s/iter; left time: 2611.8176s
	iters: 400, epoch: 7 | loss: 0.0539200
	speed: 0.0608s/iter; left time: 2655.5245s
Epoch: 7 cost time: 28.605849742889404
Epoch: 7, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
Validation loss decreased (-0.954258 --> -0.955401).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0056522
	speed: 0.2709s/iter; left time: 11787.0361s
	iters: 200, epoch: 8 | loss: 0.0038861
	speed: 0.0621s/iter; left time: 2698.2579s
	iters: 300, epoch: 8 | loss: 0.0243890
	speed: 0.0597s/iter; left time: 2585.6856s
	iters: 400, epoch: 8 | loss: 0.0290559
	speed: 0.0621s/iter; left time: 2684.7909s
Epoch: 8 cost time: 29.514325857162476
Epoch: 8, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.217 Vali Acc: 0.953 Test Loss: 0.217 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0416095
	speed: 0.2725s/iter; left time: 11731.0466s
	iters: 200, epoch: 9 | loss: 0.0675703
	speed: 0.0570s/iter; left time: 2448.9709s
	iters: 300, epoch: 9 | loss: 0.0245837
	speed: 0.0586s/iter; left time: 2510.0925s
	iters: 400, epoch: 9 | loss: 0.0099583
	speed: 0.0642s/iter; left time: 2746.0870s
Epoch: 9 cost time: 28.95410180091858
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0065081
	speed: 0.2634s/iter; left time: 11217.1203s
	iters: 200, epoch: 10 | loss: 0.1798496
	speed: 0.0558s/iter; left time: 2370.2679s
	iters: 300, epoch: 10 | loss: 0.0062027
	speed: 0.0575s/iter; left time: 2436.5961s
	iters: 400, epoch: 10 | loss: 0.0195801
	speed: 0.0627s/iter; left time: 2652.3874s
Epoch: 10 cost time: 27.93965435028076
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955401 --> -0.955973).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0020590
	speed: 0.2788s/iter; left time: 11740.8647s
	iters: 200, epoch: 11 | loss: 0.1012309
	speed: 0.0673s/iter; left time: 2828.1927s
	iters: 300, epoch: 11 | loss: 0.0778044
	speed: 0.0649s/iter; left time: 2718.9447s
	iters: 400, epoch: 11 | loss: 0.0094504
	speed: 0.0656s/iter; left time: 2744.8103s
Epoch: 11 cost time: 31.00220251083374
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.955973 --> -0.964264).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0043862
	speed: 0.2989s/iter; left time: 12446.2543s
	iters: 200, epoch: 12 | loss: 0.0376051
	speed: 0.0633s/iter; left time: 2630.3871s
	iters: 300, epoch: 12 | loss: 0.1399207
	speed: 0.0637s/iter; left time: 2640.7106s
	iters: 400, epoch: 12 | loss: 0.1822970
	speed: 0.0644s/iter; left time: 2663.8383s
Epoch: 12 cost time: 30.495970964431763
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.964264 --> -0.966837).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0081254
	speed: 0.2896s/iter; left time: 11924.6880s
	iters: 200, epoch: 13 | loss: 0.0027975
	speed: 0.0614s/iter; left time: 2522.7974s
	iters: 300, epoch: 13 | loss: 0.0012627
	speed: 0.0651s/iter; left time: 2665.4381s
	iters: 400, epoch: 13 | loss: 0.0915882
	speed: 0.0674s/iter; left time: 2756.1387s
Epoch: 13 cost time: 30.493268728256226
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0093284
	speed: 0.2728s/iter; left time: 11105.6565s
	iters: 200, epoch: 14 | loss: 0.0036816
	speed: 0.0615s/iter; left time: 2497.8295s
	iters: 300, epoch: 14 | loss: 0.0159334
	speed: 0.0634s/iter; left time: 2568.5703s
	iters: 400, epoch: 14 | loss: 0.0339916
	speed: 0.0599s/iter; left time: 2419.6642s
Epoch: 14 cost time: 29.18717360496521
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0707560
	speed: 0.2728s/iter; left time: 10975.8498s
	iters: 200, epoch: 15 | loss: 0.0353927
	speed: 0.0601s/iter; left time: 2412.9968s
	iters: 300, epoch: 15 | loss: 0.0009157
	speed: 0.0617s/iter; left time: 2469.5937s
	iters: 400, epoch: 15 | loss: 0.0008211
	speed: 0.0620s/iter; left time: 2474.3137s
Epoch: 15 cost time: 29.269394159317017
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0480671
	speed: 0.2677s/iter; left time: 10643.4981s
	iters: 200, epoch: 16 | loss: 0.0675519
	speed: 0.0620s/iter; left time: 2460.6366s
	iters: 300, epoch: 16 | loss: 0.0004369
	speed: 0.0619s/iter; left time: 2450.7647s
	iters: 400, epoch: 16 | loss: 0.2978473
	speed: 0.0613s/iter; left time: 2418.1303s
Epoch: 16 cost time: 29.35510015487671
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0087985
	speed: 0.2722s/iter; left time: 10697.6701s
	iters: 200, epoch: 17 | loss: 0.2284831
	speed: 0.0616s/iter; left time: 2414.3537s
	iters: 300, epoch: 17 | loss: 0.0401176
	speed: 0.0613s/iter; left time: 2395.2293s
	iters: 400, epoch: 17 | loss: 0.0061413
	speed: 0.0597s/iter; left time: 2328.1559s
Epoch: 17 cost time: 29.42958950996399
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.269 Vali Acc: 0.942 Test Loss: 0.269 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0266758
	speed: 0.2801s/iter; left time: 10875.8169s
	iters: 200, epoch: 18 | loss: 0.0268742
	speed: 0.0628s/iter; left time: 2430.1839s
	iters: 300, epoch: 18 | loss: 0.0063052
	speed: 0.0640s/iter; left time: 2471.6250s
	iters: 400, epoch: 18 | loss: 0.3091561
	speed: 0.0622s/iter; left time: 2394.6060s
Epoch: 18 cost time: 29.833494186401367
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0173317
	speed: 0.2763s/iter; left time: 10600.1400s
	iters: 200, epoch: 19 | loss: 0.0104594
	speed: 0.0600s/iter; left time: 2294.0763s
	iters: 300, epoch: 19 | loss: 0.4514654
	speed: 0.0623s/iter; left time: 2376.3518s
	iters: 400, epoch: 19 | loss: 0.0048380
	speed: 0.0645s/iter; left time: 2455.9009s
Epoch: 19 cost time: 29.745726585388184
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2001833
	speed: 0.2755s/iter; left time: 10439.7008s
	iters: 200, epoch: 20 | loss: 0.0047128
	speed: 0.0594s/iter; left time: 2244.4246s
	iters: 300, epoch: 20 | loss: 0.0143504
	speed: 0.0597s/iter; left time: 2251.1600s
	iters: 400, epoch: 20 | loss: 0.0045495
	speed: 0.0613s/iter; left time: 2303.1486s
Epoch: 20 cost time: 28.90653395652771
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0004805
	speed: 0.2770s/iter; left time: 10367.2493s
	iters: 200, epoch: 21 | loss: 0.1352609
	speed: 0.0594s/iter; left time: 2215.7472s
	iters: 300, epoch: 21 | loss: 0.0008703
	speed: 0.0640s/iter; left time: 2382.4094s
	iters: 400, epoch: 21 | loss: 0.0431421
	speed: 0.0614s/iter; left time: 2277.7422s
Epoch: 21 cost time: 29.134066581726074
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.954 Test Loss: 0.237 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0331795
	speed: 0.3030s/iter; left time: 11197.2278s
	iters: 200, epoch: 22 | loss: 0.0039979
	speed: 0.0720s/iter; left time: 2651.8879s
	iters: 300, epoch: 22 | loss: 0.0018978
	speed: 0.0677s/iter; left time: 2489.7072s
	iters: 400, epoch: 22 | loss: 0.0065688
	speed: 0.0668s/iter; left time: 2446.8142s
Epoch: 22 cost time: 32.92687702178955
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 593594
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8239247
	speed: 0.0854s/iter; left time: 3997.7343s
	iters: 200, epoch: 1 | loss: 0.3011158
	speed: 0.0650s/iter; left time: 3033.6870s
	iters: 300, epoch: 1 | loss: 0.3059662
	speed: 0.0690s/iter; left time: 3215.6045s
	iters: 400, epoch: 1 | loss: 0.1145298
	speed: 0.0647s/iter; left time: 3007.5519s
Epoch: 1 cost time: 32.87865662574768
Epoch: 1, Steps: 469 | Train Loss: 0.692 Vali Loss: 0.287 Vali Acc: 0.909 Test Loss: 0.287 Test Acc: 0.909
Validation loss decreased (inf --> -0.908516).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2746620
	speed: 0.2881s/iter; left time: 13346.6203s
	iters: 200, epoch: 2 | loss: 0.1303003
	speed: 0.0640s/iter; left time: 2960.2766s
	iters: 300, epoch: 2 | loss: 0.1612962
	speed: 0.0662s/iter; left time: 3053.7865s
	iters: 400, epoch: 2 | loss: 0.0565554
	speed: 0.0631s/iter; left time: 2903.1766s
Epoch: 2 cost time: 30.780945777893066
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.908516 --> -0.959118).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0730089
	speed: 0.2776s/iter; left time: 12732.1973s
	iters: 200, epoch: 3 | loss: 0.0672894
	speed: 0.0608s/iter; left time: 2780.6984s
	iters: 300, epoch: 3 | loss: 0.0194729
	speed: 0.0637s/iter; left time: 2908.0673s
	iters: 400, epoch: 3 | loss: 0.0088269
	speed: 0.0591s/iter; left time: 2692.8057s
Epoch: 3 cost time: 29.172446727752686
Epoch: 3, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (-0.959118 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102531
	speed: 0.2680s/iter; left time: 12164.0908s
	iters: 200, epoch: 4 | loss: 0.0363844
	speed: 0.0586s/iter; left time: 2653.9744s
	iters: 300, epoch: 4 | loss: 0.0275775
	speed: 0.0625s/iter; left time: 2822.7778s
	iters: 400, epoch: 4 | loss: 0.0074826
	speed: 0.0603s/iter; left time: 2718.0253s
Epoch: 4 cost time: 28.72891664505005
Epoch: 4, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0111929
	speed: 0.2743s/iter; left time: 12324.7822s
	iters: 200, epoch: 5 | loss: 0.2698833
	speed: 0.0641s/iter; left time: 2874.6313s
	iters: 300, epoch: 5 | loss: 0.0084498
	speed: 0.0682s/iter; left time: 3049.1899s
	iters: 400, epoch: 5 | loss: 0.4022006
	speed: 0.0639s/iter; left time: 2851.4044s
Epoch: 5 cost time: 30.96967363357544
Epoch: 5, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0045860
	speed: 0.2731s/iter; left time: 12143.1237s
	iters: 200, epoch: 6 | loss: 0.0050670
	speed: 0.0616s/iter; left time: 2730.2807s
	iters: 300, epoch: 6 | loss: 0.0417700
	speed: 0.0662s/iter; left time: 2928.9012s
	iters: 400, epoch: 6 | loss: 0.0658871
	speed: 0.0641s/iter; left time: 2828.9994s
Epoch: 6 cost time: 30.2107150554657
Epoch: 6, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0215884
	speed: 0.2806s/iter; left time: 12341.5334s
	iters: 200, epoch: 7 | loss: 0.0042246
	speed: 0.0617s/iter; left time: 2708.4618s
	iters: 300, epoch: 7 | loss: 0.0600309
	speed: 0.0623s/iter; left time: 2728.5543s
	iters: 400, epoch: 7 | loss: 0.0875213
	speed: 0.0605s/iter; left time: 2641.9030s
Epoch: 7 cost time: 29.63692593574524
Epoch: 7, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0196551
	speed: 0.2743s/iter; left time: 11938.9795s
	iters: 200, epoch: 8 | loss: 0.1402117
	speed: 0.0573s/iter; left time: 2487.4259s
	iters: 300, epoch: 8 | loss: 0.1475818
	speed: 0.0589s/iter; left time: 2550.9023s
	iters: 400, epoch: 8 | loss: 0.3597454
	speed: 0.0606s/iter; left time: 2618.7118s
Epoch: 8 cost time: 28.396167278289795
Epoch: 8, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0587596
	speed: 0.2743s/iter; left time: 11809.4330s
	iters: 200, epoch: 9 | loss: 0.0761300
	speed: 0.0674s/iter; left time: 2894.1008s
	iters: 300, epoch: 9 | loss: 0.1693663
	speed: 0.0663s/iter; left time: 2841.0071s
	iters: 400, epoch: 9 | loss: 0.0065251
	speed: 0.0678s/iter; left time: 2898.6503s
Epoch: 9 cost time: 31.825969457626343
Epoch: 9, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0016004
	speed: 0.2897s/iter; left time: 12333.8787s
	iters: 200, epoch: 10 | loss: 0.0114886
	speed: 0.0623s/iter; left time: 2647.0110s
	iters: 300, epoch: 10 | loss: 0.0050725
	speed: 0.0625s/iter; left time: 2650.3615s
	iters: 400, epoch: 10 | loss: 0.0148628
	speed: 0.0632s/iter; left time: 2673.6887s
Epoch: 10 cost time: 30.264195442199707
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3026260
	speed: 0.3025s/iter; left time: 12737.6570s
	iters: 200, epoch: 11 | loss: 0.0224999
	speed: 0.0627s/iter; left time: 2635.1944s
	iters: 300, epoch: 11 | loss: 0.0516057
	speed: 0.0657s/iter; left time: 2752.9649s
	iters: 400, epoch: 11 | loss: 0.0028375
	speed: 0.0682s/iter; left time: 2852.3820s
Epoch: 11 cost time: 31.577808380126953
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.961119 --> -0.964550).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0013658
	speed: 0.2995s/iter; left time: 12471.4200s
	iters: 200, epoch: 12 | loss: 0.0036459
	speed: 0.0636s/iter; left time: 2642.3020s
	iters: 300, epoch: 12 | loss: 0.0143008
	speed: 0.0654s/iter; left time: 2710.0201s
	iters: 400, epoch: 12 | loss: 0.0025441
	speed: 0.0639s/iter; left time: 2641.4749s
Epoch: 12 cost time: 30.690409421920776
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0007935
	speed: 0.2958s/iter; left time: 12178.1325s
	iters: 200, epoch: 13 | loss: 0.0078311
	speed: 0.0672s/iter; left time: 2761.3130s
	iters: 300, epoch: 13 | loss: 0.1140950
	speed: 0.0678s/iter; left time: 2777.7601s
	iters: 400, epoch: 13 | loss: 0.0064063
	speed: 0.0641s/iter; left time: 2620.0215s
Epoch: 13 cost time: 31.09739661216736
Epoch: 13, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.964550 --> -0.966837).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0030267
	speed: 0.2789s/iter; left time: 11353.5317s
	iters: 200, epoch: 14 | loss: 0.0014141
	speed: 0.0697s/iter; left time: 2830.0655s
	iters: 300, epoch: 14 | loss: 0.0018261
	speed: 0.0651s/iter; left time: 2635.8133s
	iters: 400, epoch: 14 | loss: 0.0856522
	speed: 0.0627s/iter; left time: 2534.5126s
Epoch: 14 cost time: 31.201391220092773
Epoch: 14, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0018399
	speed: 0.2705s/iter; left time: 10885.4951s
	iters: 200, epoch: 15 | loss: 0.0034019
	speed: 0.0630s/iter; left time: 2526.7618s
	iters: 300, epoch: 15 | loss: 0.0177798
	speed: 0.0639s/iter; left time: 2558.6460s
	iters: 400, epoch: 15 | loss: 0.0020503
	speed: 0.0604s/iter; left time: 2412.2333s
Epoch: 15 cost time: 29.778934240341187
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0115361
	speed: 0.2710s/iter; left time: 10778.1375s
	iters: 200, epoch: 16 | loss: 0.0535747
	speed: 0.0590s/iter; left time: 2341.8389s
	iters: 300, epoch: 16 | loss: 0.1648656
	speed: 0.0580s/iter; left time: 2296.3901s
	iters: 400, epoch: 16 | loss: 0.0017993
	speed: 0.0610s/iter; left time: 2408.4134s
Epoch: 16 cost time: 28.503791570663452
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1092401
	speed: 0.2735s/iter; left time: 10748.4912s
	iters: 200, epoch: 17 | loss: 0.0017392
	speed: 0.0631s/iter; left time: 2473.5476s
	iters: 300, epoch: 17 | loss: 0.0170789
	speed: 0.0633s/iter; left time: 2476.0433s
	iters: 400, epoch: 17 | loss: 0.0055101
	speed: 0.0660s/iter; left time: 2575.7114s
Epoch: 17 cost time: 30.460771083831787
Epoch: 17, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0056481
	speed: 0.2817s/iter; left time: 10939.6129s
	iters: 200, epoch: 18 | loss: 0.0051955
	speed: 0.0606s/iter; left time: 2348.1993s
	iters: 300, epoch: 18 | loss: 0.2658218
	speed: 0.0597s/iter; left time: 2307.6843s
	iters: 400, epoch: 18 | loss: 0.0818001
	speed: 0.0605s/iter; left time: 2329.7542s
Epoch: 18 cost time: 28.670768976211548
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.966837 --> -0.967123).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4179461
	speed: 0.2624s/iter; left time: 10066.6162s
	iters: 200, epoch: 19 | loss: 0.0028980
	speed: 0.0605s/iter; left time: 2315.7621s
	iters: 300, epoch: 19 | loss: 0.0015010
	speed: 0.0607s/iter; left time: 2316.6209s
	iters: 400, epoch: 19 | loss: 0.1545594
	speed: 0.0595s/iter; left time: 2265.4374s
Epoch: 19 cost time: 28.562300205230713
Epoch: 19, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0011297
	speed: 0.2756s/iter; left time: 10443.6588s
	iters: 200, epoch: 20 | loss: 0.0075837
	speed: 0.0629s/iter; left time: 2378.6571s
	iters: 300, epoch: 20 | loss: 0.0008716
	speed: 0.0660s/iter; left time: 2488.0665s
	iters: 400, epoch: 20 | loss: 0.2268235
	speed: 0.0616s/iter; left time: 2316.6187s
Epoch: 20 cost time: 29.9874484539032
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0028078
	speed: 0.2689s/iter; left time: 10060.7943s
	iters: 200, epoch: 21 | loss: 0.0016427
	speed: 0.0598s/iter; left time: 2233.1474s
	iters: 300, epoch: 21 | loss: 0.0094789
	speed: 0.0619s/iter; left time: 2304.2587s
	iters: 400, epoch: 21 | loss: 0.0373853
	speed: 0.0628s/iter; left time: 2330.9504s
Epoch: 21 cost time: 29.107905626296997
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0626512
	speed: 0.2802s/iter; left time: 10354.5925s
	iters: 200, epoch: 22 | loss: 0.0339794
	speed: 0.0655s/iter; left time: 2414.1904s
	iters: 300, epoch: 22 | loss: 0.0008859
	speed: 0.0663s/iter; left time: 2435.0622s
	iters: 400, epoch: 22 | loss: 0.0005911
	speed: 0.0644s/iter; left time: 2361.4436s
Epoch: 22 cost time: 31.133056163787842
Epoch: 22, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.967123 --> -0.969410).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0034131
	speed: 0.2973s/iter; left time: 10845.1780s
	iters: 200, epoch: 23 | loss: 0.0073246
	speed: 0.0634s/iter; left time: 2305.6806s
	iters: 300, epoch: 23 | loss: 0.2130294
	speed: 0.0615s/iter; left time: 2232.1900s
	iters: 400, epoch: 23 | loss: 0.0018739
	speed: 0.0613s/iter; left time: 2219.4539s
Epoch: 23 cost time: 29.78885841369629
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0008798
	speed: 0.2923s/iter; left time: 10527.0043s
	iters: 200, epoch: 24 | loss: 0.0029481
	speed: 0.0665s/iter; left time: 2386.5475s
	iters: 300, epoch: 24 | loss: 0.0031945
	speed: 0.0672s/iter; left time: 2406.9964s
	iters: 400, epoch: 24 | loss: 0.0008685
	speed: 0.0666s/iter; left time: 2377.6264s
Epoch: 24 cost time: 31.172407150268555
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0144033
	speed: 0.2792s/iter; left time: 9925.3014s
	iters: 200, epoch: 25 | loss: 0.0004753
	speed: 0.0656s/iter; left time: 2325.6747s
	iters: 300, epoch: 25 | loss: 0.0086106
	speed: 0.0642s/iter; left time: 2269.5521s
	iters: 400, epoch: 25 | loss: 0.0013585
	speed: 0.0636s/iter; left time: 2240.3299s
Epoch: 25 cost time: 30.20540428161621
Epoch: 25, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.4870081
	speed: 0.2588s/iter; left time: 9076.5754s
	iters: 200, epoch: 26 | loss: 0.0058251
	speed: 0.0586s/iter; left time: 2047.9263s
	iters: 300, epoch: 26 | loss: 0.0095294
	speed: 0.0603s/iter; left time: 2104.0638s
	iters: 400, epoch: 26 | loss: 0.2418168
	speed: 0.0624s/iter; left time: 2169.6771s
Epoch: 26 cost time: 28.48754858970642
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0049639
	speed: 0.2748s/iter; left time: 9510.9652s
	iters: 200, epoch: 27 | loss: 0.0014689
	speed: 0.0625s/iter; left time: 2156.3596s
	iters: 300, epoch: 27 | loss: 0.0053940
	speed: 0.0671s/iter; left time: 2307.0365s
	iters: 400, epoch: 27 | loss: 0.0009728
	speed: 0.0642s/iter; left time: 2202.6891s
Epoch: 27 cost time: 30.16048502922058
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0507283
	speed: 0.2751s/iter; left time: 9390.2501s
	iters: 200, epoch: 28 | loss: 0.0402106
	speed: 0.0595s/iter; left time: 2026.0440s
	iters: 300, epoch: 28 | loss: 0.0032899
	speed: 0.0593s/iter; left time: 2013.7242s
	iters: 400, epoch: 28 | loss: 0.0005325
	speed: 0.0621s/iter; left time: 2100.3842s
Epoch: 28 cost time: 28.849270343780518
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.971125).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0293109
	speed: 0.2685s/iter; left time: 9041.0315s
	iters: 200, epoch: 29 | loss: 0.0012588
	speed: 0.0592s/iter; left time: 1988.1994s
	iters: 300, epoch: 29 | loss: 0.0011633
	speed: 0.0585s/iter; left time: 1958.2592s
	iters: 400, epoch: 29 | loss: 0.0045888
	speed: 0.0617s/iter; left time: 2060.1736s
Epoch: 29 cost time: 28.406312227249146
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0002341
	speed: 0.2760s/iter; left time: 9163.9699s
	iters: 200, epoch: 30 | loss: 0.0024622
	speed: 0.0606s/iter; left time: 2006.6869s
	iters: 300, epoch: 30 | loss: 0.0011965
	speed: 0.0588s/iter; left time: 1939.2500s
	iters: 400, epoch: 30 | loss: 0.4396000
	speed: 0.0557s/iter; left time: 1832.9168s
Epoch: 30 cost time: 27.52871823310852
Epoch: 30, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0014190
	speed: 0.2722s/iter; left time: 8909.9280s
	iters: 200, epoch: 31 | loss: 0.0012897
	speed: 0.0609s/iter; left time: 1986.1669s
	iters: 300, epoch: 31 | loss: 0.0052605
	speed: 0.0574s/iter; left time: 1868.5156s
	iters: 400, epoch: 31 | loss: 0.0009192
	speed: 0.0593s/iter; left time: 1922.3536s
Epoch: 31 cost time: 28.459279537200928
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.974842).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0049213
	speed: 0.2721s/iter; left time: 8779.4947s
	iters: 200, epoch: 32 | loss: 0.0002159
	speed: 0.0627s/iter; left time: 2016.6031s
	iters: 300, epoch: 32 | loss: 0.0032405
	speed: 0.0641s/iter; left time: 2054.5136s
	iters: 400, epoch: 32 | loss: 0.0091886
	speed: 0.0607s/iter; left time: 1939.7406s
Epoch: 32 cost time: 29.622109413146973
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.2065017
	speed: 0.2975s/iter; left time: 9458.9175s
	iters: 200, epoch: 33 | loss: 0.0246565
	speed: 0.0638s/iter; left time: 2021.4046s
	iters: 300, epoch: 33 | loss: 0.0220936
	speed: 0.0641s/iter; left time: 2025.0632s
	iters: 400, epoch: 33 | loss: 0.0010964
	speed: 0.0612s/iter; left time: 1926.7369s
Epoch: 33 cost time: 30.36671543121338
Epoch: 33, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0010529
	speed: 0.2912s/iter; left time: 9121.2211s
	iters: 200, epoch: 34 | loss: 0.0028710
	speed: 0.0620s/iter; left time: 1934.3541s
	iters: 300, epoch: 34 | loss: 0.0020903
	speed: 0.0620s/iter; left time: 1928.1892s
	iters: 400, epoch: 34 | loss: 0.0008098
	speed: 0.0680s/iter; left time: 2110.4047s
Epoch: 34 cost time: 30.063656091690063
Epoch: 34, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0004305
	speed: 0.2742s/iter; left time: 8461.4650s
	iters: 200, epoch: 35 | loss: 0.0032028
	speed: 0.0598s/iter; left time: 1840.1831s
	iters: 300, epoch: 35 | loss: 0.0006850
	speed: 0.0596s/iter; left time: 1827.6817s
	iters: 400, epoch: 35 | loss: 0.0333908
	speed: 0.0598s/iter; left time: 1828.3977s
Epoch: 35 cost time: 28.434696197509766
Epoch: 35, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0014953
	speed: 0.2752s/iter; left time: 8363.2120s
	iters: 200, epoch: 36 | loss: 0.0021374
	speed: 0.0597s/iter; left time: 1807.7746s
	iters: 300, epoch: 36 | loss: 0.0008217
	speed: 0.0599s/iter; left time: 1809.2040s
	iters: 400, epoch: 36 | loss: 0.4483859
	speed: 0.0604s/iter; left time: 1817.8939s
Epoch: 36 cost time: 29.17866826057434
Epoch: 36, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0004189
	speed: 0.2718s/iter; left time: 8130.4918s
	iters: 200, epoch: 37 | loss: 0.0002645
	speed: 0.0605s/iter; left time: 1802.6859s
	iters: 300, epoch: 37 | loss: 0.0015217
	speed: 0.0612s/iter; left time: 1818.9150s
	iters: 400, epoch: 37 | loss: 0.0010487
	speed: 0.0616s/iter; left time: 1823.3040s
Epoch: 37 cost time: 28.772262573242188
Epoch: 37, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0104120
	speed: 0.2685s/iter; left time: 7906.1557s
	iters: 200, epoch: 38 | loss: 0.0006849
	speed: 0.0582s/iter; left time: 1707.5367s
	iters: 300, epoch: 38 | loss: 0.0073656
	speed: 0.0586s/iter; left time: 1713.1838s
	iters: 400, epoch: 38 | loss: 0.0011950
	speed: 0.0565s/iter; left time: 1647.6764s
Epoch: 38 cost time: 27.90337634086609
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0016035
	speed: 0.2722s/iter; left time: 7887.0615s
	iters: 200, epoch: 39 | loss: 0.0517534
	speed: 0.0605s/iter; left time: 1748.1893s
	iters: 300, epoch: 39 | loss: 0.0010491
	speed: 0.0605s/iter; left time: 1741.2332s
	iters: 400, epoch: 39 | loss: 0.0386173
	speed: 0.0599s/iter; left time: 1719.0837s
Epoch: 39 cost time: 28.932235956192017
Epoch: 39, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0068045
	speed: 0.2737s/iter; left time: 7804.0986s
	iters: 200, epoch: 40 | loss: 0.0131239
	speed: 0.0622s/iter; left time: 1766.7361s
	iters: 300, epoch: 40 | loss: 0.0001111
	speed: 0.0614s/iter; left time: 1738.3343s
	iters: 400, epoch: 40 | loss: 0.0035810
	speed: 0.0601s/iter; left time: 1695.0473s
Epoch: 40 cost time: 29.054996728897095
Epoch: 40, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.961 Test Loss: 0.179 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0002859
	speed: 0.2697s/iter; left time: 7563.5560s
	iters: 200, epoch: 41 | loss: 0.0030795
	speed: 0.0614s/iter; left time: 1716.1401s
	iters: 300, epoch: 41 | loss: 0.0025818
	speed: 0.0599s/iter; left time: 1667.1701s
	iters: 400, epoch: 41 | loss: 0.0013091
	speed: 0.0608s/iter; left time: 1685.6895s
Epoch: 41 cost time: 28.727163791656494
Epoch: 41, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975985).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0004466
	speed: 0.2120s/iter; left time: 5843.9301s
	iters: 200, epoch: 42 | loss: 0.0035890
	speed: 0.0551s/iter; left time: 1512.3932s
	iters: 300, epoch: 42 | loss: 0.0588430
	speed: 0.0620s/iter; left time: 1696.1854s
	iters: 400, epoch: 42 | loss: 0.0692593
	speed: 0.0651s/iter; left time: 1775.2050s
Epoch: 42 cost time: 28.51205587387085
Epoch: 42, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.961 Test Loss: 0.209 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.0537580
	speed: 0.3065s/iter; left time: 8306.1624s
	iters: 200, epoch: 43 | loss: 0.0009297
	speed: 0.0683s/iter; left time: 1843.9942s
	iters: 300, epoch: 43 | loss: 0.4726743
	speed: 0.0678s/iter; left time: 1822.7040s
	iters: 400, epoch: 43 | loss: 0.0050519
	speed: 0.0695s/iter; left time: 1864.0815s
Epoch: 43 cost time: 32.277052879333496
Epoch: 43, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.0002633
	speed: 0.2922s/iter; left time: 7781.6678s
	iters: 200, epoch: 44 | loss: 0.0022666
	speed: 0.0641s/iter; left time: 1699.8587s
	iters: 300, epoch: 44 | loss: 0.0103072
	speed: 0.0667s/iter; left time: 1763.4512s
	iters: 400, epoch: 44 | loss: 0.0005012
	speed: 0.0654s/iter; left time: 1721.0144s
Epoch: 44 cost time: 31.03277850151062
Epoch: 44, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.0002489
	speed: 0.2974s/iter; left time: 7781.8492s
	iters: 200, epoch: 45 | loss: 0.0008049
	speed: 0.0645s/iter; left time: 1681.8126s
	iters: 300, epoch: 45 | loss: 0.0008022
	speed: 0.0624s/iter; left time: 1619.5198s
	iters: 400, epoch: 45 | loss: 0.0227111
	speed: 0.0631s/iter; left time: 1631.5826s
Epoch: 45 cost time: 30.6592915058136
Epoch: 45, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 0.0655270
	speed: 0.2735s/iter; left time: 7027.4378s
	iters: 200, epoch: 46 | loss: 0.0002149
	speed: 0.0592s/iter; left time: 1516.4733s
	iters: 300, epoch: 46 | loss: 0.0048403
	speed: 0.0613s/iter; left time: 1562.8010s
	iters: 400, epoch: 46 | loss: 0.0008433
	speed: 0.0644s/iter; left time: 1636.5568s
Epoch: 46 cost time: 29.3548264503479
Epoch: 46, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.0018901
	speed: 0.2691s/iter; left time: 6788.8327s
	iters: 200, epoch: 47 | loss: 0.0089841
	speed: 0.0591s/iter; left time: 1485.2350s
	iters: 300, epoch: 47 | loss: 0.0001944
	speed: 0.0629s/iter; left time: 1574.8614s
	iters: 400, epoch: 47 | loss: 0.0001527
	speed: 0.0614s/iter; left time: 1531.1582s
Epoch: 47 cost time: 28.844297885894775
Epoch: 47, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 0.0001577
	speed: 0.2709s/iter; left time: 6706.2965s
	iters: 200, epoch: 48 | loss: 0.0199093
	speed: 0.0634s/iter; left time: 1564.1149s
	iters: 300, epoch: 48 | loss: 0.0003713
	speed: 0.0657s/iter; left time: 1613.6831s
	iters: 400, epoch: 48 | loss: 0.0000781
	speed: 0.0633s/iter; left time: 1547.4700s
Epoch: 48 cost time: 30.03752088546753
Epoch: 48, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.0006575
	speed: 0.2747s/iter; left time: 6671.4749s
	iters: 200, epoch: 49 | loss: 0.0000793
	speed: 0.0586s/iter; left time: 1417.0527s
	iters: 300, epoch: 49 | loss: 0.0053541
	speed: 0.0601s/iter; left time: 1446.6199s
	iters: 400, epoch: 49 | loss: 0.0036971
	speed: 0.0587s/iter; left time: 1409.1516s
Epoch: 49 cost time: 28.47322726249695
Epoch: 49, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 0.0032930
	speed: 0.2706s/iter; left time: 6445.1341s
	iters: 200, epoch: 50 | loss: 0.0017237
	speed: 0.0630s/iter; left time: 1495.3879s
	iters: 300, epoch: 50 | loss: 0.1326472
	speed: 0.0593s/iter; left time: 1400.8576s
	iters: 400, epoch: 50 | loss: 0.0002897
	speed: 0.0617s/iter; left time: 1451.9675s
Epoch: 50 cost time: 29.193437099456787
Epoch: 50, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 0.2323210
	speed: 0.2793s/iter; left time: 6521.8075s
	iters: 200, epoch: 51 | loss: 0.0019134
	speed: 0.0632s/iter; left time: 1468.8275s
	iters: 300, epoch: 51 | loss: 0.4066967
	speed: 0.0592s/iter; left time: 1371.2005s
	iters: 400, epoch: 51 | loss: 0.0016951
	speed: 0.0590s/iter; left time: 1360.6320s
Epoch: 51 cost time: 28.77258849143982
Epoch: 51, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 593402
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0231717
	speed: 0.0744s/iter; left time: 3481.4328s
	iters: 200, epoch: 1 | loss: 0.5366337
	speed: 0.0629s/iter; left time: 2938.9733s
	iters: 300, epoch: 1 | loss: 0.1725909
	speed: 0.0602s/iter; left time: 2806.6561s
	iters: 400, epoch: 1 | loss: 0.0917570
	speed: 0.0600s/iter; left time: 2787.9413s
Epoch: 1 cost time: 30.030606508255005
Epoch: 1, Steps: 469 | Train Loss: 0.717 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
Validation loss decreased (inf --> -0.912804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2188355
	speed: 0.2857s/iter; left time: 13237.9680s
	iters: 200, epoch: 2 | loss: 0.2580019
	speed: 0.0643s/iter; left time: 2972.4857s
	iters: 300, epoch: 2 | loss: 0.1352833
	speed: 0.0634s/iter; left time: 2925.6117s
	iters: 400, epoch: 2 | loss: 0.0152465
	speed: 0.0630s/iter; left time: 2900.6147s
Epoch: 2 cost time: 30.38415241241455
Epoch: 2, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.321 Vali Acc: 0.908 Test Loss: 0.321 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0395274
	speed: 0.2903s/iter; left time: 13315.9750s
	iters: 200, epoch: 3 | loss: 0.0797377
	speed: 0.0683s/iter; left time: 3125.0721s
	iters: 300, epoch: 3 | loss: 0.0595727
	speed: 0.0689s/iter; left time: 3148.0111s
	iters: 400, epoch: 3 | loss: 0.0623009
	speed: 0.0654s/iter; left time: 2977.8454s
Epoch: 3 cost time: 31.7804536819458
Epoch: 3, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
Validation loss decreased (-0.912804 --> -0.938248).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0758058
	speed: 0.3026s/iter; left time: 13737.4285s
	iters: 200, epoch: 4 | loss: 0.1710551
	speed: 0.0650s/iter; left time: 2946.2161s
	iters: 300, epoch: 4 | loss: 0.4914490
	speed: 0.0600s/iter; left time: 2710.9611s
	iters: 400, epoch: 4 | loss: 0.0041507
	speed: 0.0609s/iter; left time: 2746.4742s
Epoch: 4 cost time: 29.84837293624878
Epoch: 4, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0606196
	speed: 0.2651s/iter; left time: 11908.8655s
	iters: 200, epoch: 5 | loss: 0.1994824
	speed: 0.0600s/iter; left time: 2691.0088s
	iters: 300, epoch: 5 | loss: 0.0853664
	speed: 0.0616s/iter; left time: 2752.8799s
	iters: 400, epoch: 5 | loss: 0.0048824
	speed: 0.0621s/iter; left time: 2772.3668s
Epoch: 5 cost time: 28.960245370864868
Epoch: 5, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
Validation loss decreased (-0.938248 --> -0.943108).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0103847
	speed: 0.2893s/iter; left time: 12861.0797s
	iters: 200, epoch: 6 | loss: 0.0077000
	speed: 0.0645s/iter; left time: 2860.6756s
	iters: 300, epoch: 6 | loss: 0.0116686
	speed: 0.0641s/iter; left time: 2835.8284s
	iters: 400, epoch: 6 | loss: 0.0148004
	speed: 0.0639s/iter; left time: 2823.0030s
Epoch: 6 cost time: 31.2917697429657
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0113748
	speed: 0.2776s/iter; left time: 12210.4076s
	iters: 200, epoch: 7 | loss: 0.0086397
	speed: 0.0621s/iter; left time: 2726.1468s
	iters: 300, epoch: 7 | loss: 0.3609983
	speed: 0.0615s/iter; left time: 2691.0155s
	iters: 400, epoch: 7 | loss: 0.0265262
	speed: 0.0622s/iter; left time: 2716.8147s
Epoch: 7 cost time: 29.439342260360718
Epoch: 7, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.943108 --> -0.945967).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1574761
	speed: 0.2780s/iter; left time: 12097.5123s
	iters: 200, epoch: 8 | loss: 0.0043607
	speed: 0.0644s/iter; left time: 2794.8951s
	iters: 300, epoch: 8 | loss: 0.0112416
	speed: 0.0666s/iter; left time: 2885.0962s
	iters: 400, epoch: 8 | loss: 0.3216297
	speed: 0.0655s/iter; left time: 2832.5158s
Epoch: 8 cost time: 30.76309084892273
Epoch: 8, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (-0.945967 --> -0.952543).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0023289
	speed: 0.2848s/iter; left time: 12258.6205s
	iters: 200, epoch: 9 | loss: 0.0174291
	speed: 0.0639s/iter; left time: 2742.4383s
	iters: 300, epoch: 9 | loss: 0.0024255
	speed: 0.0586s/iter; left time: 2512.7434s
	iters: 400, epoch: 9 | loss: 0.2023057
	speed: 0.0607s/iter; left time: 2594.6128s
Epoch: 9 cost time: 29.168699741363525
Epoch: 9, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.304 Vali Acc: 0.934 Test Loss: 0.304 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0053946
	speed: 0.2672s/iter; left time: 11379.3445s
	iters: 200, epoch: 10 | loss: 0.0048786
	speed: 0.0644s/iter; left time: 2736.8617s
	iters: 300, epoch: 10 | loss: 0.0510787
	speed: 0.0602s/iter; left time: 2550.1656s
	iters: 400, epoch: 10 | loss: 0.0036709
	speed: 0.0618s/iter; left time: 2614.7988s
Epoch: 10 cost time: 29.534154176712036
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.189 Vali Acc: 0.955 Test Loss: 0.189 Test Acc: 0.955
Validation loss decreased (-0.952543 --> -0.954829).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1574871
	speed: 0.2819s/iter; left time: 11871.5145s
	iters: 200, epoch: 11 | loss: 0.1348912
	speed: 0.0633s/iter; left time: 2657.4623s
	iters: 300, epoch: 11 | loss: 0.0897529
	speed: 0.0634s/iter; left time: 2658.2888s
	iters: 400, epoch: 11 | loss: 0.0075669
	speed: 0.0606s/iter; left time: 2532.2454s
Epoch: 11 cost time: 30.08983564376831
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
Validation loss decreased (-0.954829 --> -0.956259).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0039125
	speed: 0.2867s/iter; left time: 11939.5908s
	iters: 200, epoch: 12 | loss: 0.0035780
	speed: 0.0649s/iter; left time: 2694.8672s
	iters: 300, epoch: 12 | loss: 0.0015667
	speed: 0.0651s/iter; left time: 2696.3372s
	iters: 400, epoch: 12 | loss: 0.0027022
	speed: 0.0680s/iter; left time: 2810.3634s
Epoch: 12 cost time: 31.032419443130493
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0182052
	speed: 0.3034s/iter; left time: 12490.8393s
	iters: 200, epoch: 13 | loss: 0.0006538
	speed: 0.0710s/iter; left time: 2917.8905s
	iters: 300, epoch: 13 | loss: 0.0140009
	speed: 0.0740s/iter; left time: 3030.1117s
	iters: 400, epoch: 13 | loss: 0.0053160
	speed: 0.0697s/iter; left time: 2850.7902s
Epoch: 13 cost time: 33.77487015724182
Epoch: 13, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.336 Vali Acc: 0.923 Test Loss: 0.336 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0039503
	speed: 0.3005s/iter; left time: 12231.4946s
	iters: 200, epoch: 14 | loss: 0.0018818
	speed: 0.0712s/iter; left time: 2889.9498s
	iters: 300, epoch: 14 | loss: 0.1099731
	speed: 0.0667s/iter; left time: 2703.6042s
	iters: 400, epoch: 14 | loss: 0.0013337
	speed: 0.0664s/iter; left time: 2682.0428s
Epoch: 14 cost time: 32.046536922454834
Epoch: 14, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
Validation loss decreased (-0.956259 --> -0.966265).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0026594
	speed: 0.2662s/iter; left time: 10712.3659s
	iters: 200, epoch: 15 | loss: 0.0005808
	speed: 0.0620s/iter; left time: 2487.6313s
	iters: 300, epoch: 15 | loss: 0.0014377
	speed: 0.0609s/iter; left time: 2437.9675s
	iters: 400, epoch: 15 | loss: 0.0009969
	speed: 0.0605s/iter; left time: 2417.0023s
Epoch: 15 cost time: 29.373462915420532
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0057712
	speed: 0.2900s/iter; left time: 11532.5138s
	iters: 200, epoch: 16 | loss: 0.0026861
	speed: 0.0597s/iter; left time: 2369.2960s
	iters: 300, epoch: 16 | loss: 0.0088499
	speed: 0.0658s/iter; left time: 2602.3329s
	iters: 400, epoch: 16 | loss: 0.0493913
	speed: 0.0633s/iter; left time: 2497.4684s
Epoch: 16 cost time: 29.842806100845337
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.966265 --> -0.967694).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0028218
	speed: 0.2730s/iter; left time: 10726.2719s
	iters: 200, epoch: 17 | loss: 0.0018043
	speed: 0.0644s/iter; left time: 2524.4177s
	iters: 300, epoch: 17 | loss: 0.0029624
	speed: 0.0607s/iter; left time: 2373.1726s
	iters: 400, epoch: 17 | loss: 0.0681082
	speed: 0.0599s/iter; left time: 2336.7936s
Epoch: 17 cost time: 29.525615215301514
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0653195
	speed: 0.2809s/iter; left time: 10906.6235s
	iters: 200, epoch: 18 | loss: 0.0018268
	speed: 0.0617s/iter; left time: 2391.3559s
	iters: 300, epoch: 18 | loss: 0.5259225
	speed: 0.0616s/iter; left time: 2380.4837s
	iters: 400, epoch: 18 | loss: 0.0021674
	speed: 0.0615s/iter; left time: 2369.4614s
Epoch: 18 cost time: 29.48171830177307
Epoch: 18, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0050633
	speed: 0.2742s/iter; left time: 10518.5050s
	iters: 200, epoch: 19 | loss: 0.0026006
	speed: 0.0606s/iter; left time: 2317.0682s
	iters: 300, epoch: 19 | loss: 0.0043984
	speed: 0.0632s/iter; left time: 2412.9942s
	iters: 400, epoch: 19 | loss: 0.0053107
	speed: 0.0698s/iter; left time: 2656.9172s
Epoch: 19 cost time: 30.39615821838379
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0005458
	speed: 0.2837s/iter; left time: 10750.4533s
	iters: 200, epoch: 20 | loss: 0.0114443
	speed: 0.0614s/iter; left time: 2319.5196s
	iters: 300, epoch: 20 | loss: 0.0035280
	speed: 0.0601s/iter; left time: 2265.1964s
	iters: 400, epoch: 20 | loss: 0.0211252
	speed: 0.0608s/iter; left time: 2283.8504s
Epoch: 20 cost time: 29.312155961990356
Epoch: 20, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.967694 --> -0.968838).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0009835
	speed: 0.2800s/iter; left time: 10476.6083s
	iters: 200, epoch: 21 | loss: 0.0048819
	speed: 0.0612s/iter; left time: 2285.8841s
	iters: 300, epoch: 21 | loss: 0.0044881
	speed: 0.0637s/iter; left time: 2371.0237s
	iters: 400, epoch: 21 | loss: 0.0275759
	speed: 0.0589s/iter; left time: 2186.2942s
Epoch: 21 cost time: 28.91521692276001
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.968838 --> -0.969696).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0177414
	speed: 0.2691s/iter; left time: 9943.8090s
	iters: 200, epoch: 22 | loss: 0.0029248
	speed: 0.0615s/iter; left time: 2267.9470s
	iters: 300, epoch: 22 | loss: 0.0028275
	speed: 0.0590s/iter; left time: 2170.0065s
	iters: 400, epoch: 22 | loss: 0.0045499
	speed: 0.0591s/iter; left time: 2166.8627s
Epoch: 22 cost time: 28.834836959838867
Epoch: 22, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0178297
	speed: 0.2848s/iter; left time: 10388.9392s
	iters: 200, epoch: 23 | loss: 0.0098679
	speed: 0.0638s/iter; left time: 2319.9310s
	iters: 300, epoch: 23 | loss: 0.0007351
	speed: 0.0639s/iter; left time: 2317.6238s
	iters: 400, epoch: 23 | loss: 0.0009145
	speed: 0.0645s/iter; left time: 2332.0143s
Epoch: 23 cost time: 30.36413550376892
Epoch: 23, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.969696 --> -0.975985).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0217357
	speed: 0.2912s/iter; left time: 10488.6490s
	iters: 200, epoch: 24 | loss: 0.0022496
	speed: 0.0682s/iter; left time: 2450.8647s
	iters: 300, epoch: 24 | loss: 0.0032440
	speed: 0.0705s/iter; left time: 2525.1763s
	iters: 400, epoch: 24 | loss: 0.0019486
	speed: 0.0677s/iter; left time: 2418.6271s
Epoch: 24 cost time: 32.07404708862305
Epoch: 24, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0006294
	speed: 0.2669s/iter; left time: 9485.9648s
	iters: 200, epoch: 25 | loss: 0.0006855
	speed: 0.0631s/iter; left time: 2237.6559s
	iters: 300, epoch: 25 | loss: 0.0025927
	speed: 0.0618s/iter; left time: 2182.5848s
	iters: 400, epoch: 25 | loss: 0.0007117
	speed: 0.0639s/iter; left time: 2251.5709s
Epoch: 25 cost time: 29.646173000335693
Epoch: 25, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0210591
	speed: 0.2773s/iter; left time: 9728.0889s
	iters: 200, epoch: 26 | loss: 0.0022009
	speed: 0.0642s/iter; left time: 2246.4340s
	iters: 300, epoch: 26 | loss: 0.0033097
	speed: 0.0626s/iter; left time: 2183.8958s
	iters: 400, epoch: 26 | loss: 0.0006859
	speed: 0.0638s/iter; left time: 2219.2677s
Epoch: 26 cost time: 29.89614224433899
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0033587
	speed: 0.2755s/iter; left time: 9534.5908s
	iters: 200, epoch: 27 | loss: 0.0019198
	speed: 0.0605s/iter; left time: 2086.1957s
	iters: 300, epoch: 27 | loss: 0.0089256
	speed: 0.0580s/iter; left time: 1994.0410s
	iters: 400, epoch: 27 | loss: 0.0091078
	speed: 0.0624s/iter; left time: 2141.6956s
Epoch: 27 cost time: 29.037216901779175
Epoch: 27, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0004393
	speed: 0.2868s/iter; left time: 9789.6197s
	iters: 200, epoch: 28 | loss: 0.0053482
	speed: 0.0635s/iter; left time: 2160.6423s
	iters: 300, epoch: 28 | loss: 0.0012889
	speed: 0.0590s/iter; left time: 2003.5326s
	iters: 400, epoch: 28 | loss: 0.0009118
	speed: 0.0610s/iter; left time: 2064.4039s
Epoch: 28 cost time: 29.133002281188965
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0022799
	speed: 0.2646s/iter; left time: 8909.5532s
	iters: 200, epoch: 29 | loss: 0.0029559
	speed: 0.0638s/iter; left time: 2140.3220s
	iters: 300, epoch: 29 | loss: 0.0006551
	speed: 0.0621s/iter; left time: 2080.0559s
	iters: 400, epoch: 29 | loss: 0.0203189
	speed: 0.0602s/iter; left time: 2009.4660s
Epoch: 29 cost time: 29.247958660125732
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0049429
	speed: 0.2686s/iter; left time: 8916.5415s
	iters: 200, epoch: 30 | loss: 0.0051570
	speed: 0.0599s/iter; left time: 1983.2936s
	iters: 300, epoch: 30 | loss: 0.0216461
	speed: 0.0605s/iter; left time: 1995.4935s
	iters: 400, epoch: 30 | loss: 0.0007221
	speed: 0.0619s/iter; left time: 2037.4282s
Epoch: 30 cost time: 29.168418645858765
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0028190
	speed: 0.2865s/iter; left time: 9377.2952s
	iters: 200, epoch: 31 | loss: 0.0016855
	speed: 0.0642s/iter; left time: 2095.2746s
	iters: 300, epoch: 31 | loss: 0.0086546
	speed: 0.0638s/iter; left time: 2074.6901s
	iters: 400, epoch: 31 | loss: 0.0078070
	speed: 0.0640s/iter; left time: 2074.8063s
Epoch: 31 cost time: 30.17657780647278
Epoch: 31, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0047518
	speed: 0.2707s/iter; left time: 8732.0252s
	iters: 200, epoch: 32 | loss: 0.0194447
	speed: 0.0602s/iter; left time: 1937.6558s
	iters: 300, epoch: 32 | loss: 0.2754941
	speed: 0.0593s/iter; left time: 1901.1007s
	iters: 400, epoch: 32 | loss: 0.0021040
	speed: 0.0609s/iter; left time: 1945.1532s
Epoch: 32 cost time: 28.694243669509888
Epoch: 32, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0029977
	speed: 0.2879s/iter; left time: 9153.8514s
	iters: 200, epoch: 33 | loss: 0.0376362
	speed: 0.0667s/iter; left time: 2114.9992s
	iters: 300, epoch: 33 | loss: 0.4010919
	speed: 0.0666s/iter; left time: 2103.3044s
	iters: 400, epoch: 33 | loss: 0.0005371
	speed: 0.0692s/iter; left time: 2179.8167s
Epoch: 33 cost time: 31.895554304122925
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 593210
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2858263
	speed: 0.0793s/iter; left time: 3711.0639s
	iters: 200, epoch: 1 | loss: 0.5105637
	speed: 0.0607s/iter; left time: 2834.5144s
	iters: 300, epoch: 1 | loss: 0.1869630
	speed: 0.0653s/iter; left time: 3041.5714s
	iters: 400, epoch: 1 | loss: 0.1176943
	speed: 0.0661s/iter; left time: 3075.3951s
Epoch: 1 cost time: 31.91396999359131
Epoch: 1, Steps: 469 | Train Loss: 0.693 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (inf --> -0.899654).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1803648
	speed: 0.2951s/iter; left time: 13670.4608s
	iters: 200, epoch: 2 | loss: 0.1425046
	speed: 0.0669s/iter; left time: 3091.1481s
	iters: 300, epoch: 2 | loss: 0.1993841
	speed: 0.0677s/iter; left time: 3122.0733s
	iters: 400, epoch: 2 | loss: 0.1603169
	speed: 0.0694s/iter; left time: 3194.4217s
Epoch: 2 cost time: 31.78501605987549
Epoch: 2, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.217 Vali Acc: 0.929 Test Loss: 0.217 Test Acc: 0.929
Validation loss decreased (-0.899654 --> -0.929386).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0408471
	speed: 0.3144s/iter; left time: 14419.3324s
	iters: 200, epoch: 3 | loss: 0.0771114
	speed: 0.0637s/iter; left time: 2916.6278s
	iters: 300, epoch: 3 | loss: 0.0242248
	speed: 0.0596s/iter; left time: 2721.7872s
	iters: 400, epoch: 3 | loss: 0.0876866
	speed: 0.0585s/iter; left time: 2666.0686s
Epoch: 3 cost time: 29.971543073654175
Epoch: 3, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.929386 --> -0.951399).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2268321
	speed: 0.2774s/iter; left time: 12592.8606s
	iters: 200, epoch: 4 | loss: 0.0955349
	speed: 0.0671s/iter; left time: 3040.0092s
	iters: 300, epoch: 4 | loss: 0.0267034
	speed: 0.0635s/iter; left time: 2870.2318s
	iters: 400, epoch: 4 | loss: 0.0153895
	speed: 0.0608s/iter; left time: 2742.0475s
Epoch: 4 cost time: 30.31514811515808
Epoch: 4, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.215 Vali Acc: 0.945 Test Loss: 0.215 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0222982
	speed: 0.2752s/iter; left time: 12363.7634s
	iters: 200, epoch: 5 | loss: 0.0332766
	speed: 0.0618s/iter; left time: 2770.1834s
	iters: 300, epoch: 5 | loss: 0.0089487
	speed: 0.0597s/iter; left time: 2670.8951s
	iters: 400, epoch: 5 | loss: 0.0193277
	speed: 0.0617s/iter; left time: 2753.1946s
Epoch: 5 cost time: 29.453105449676514
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0179047
	speed: 0.2722s/iter; left time: 12102.4757s
	iters: 200, epoch: 6 | loss: 0.0295648
	speed: 0.0619s/iter; left time: 2747.2529s
	iters: 300, epoch: 6 | loss: 0.1371154
	speed: 0.0629s/iter; left time: 2785.0790s
	iters: 400, epoch: 6 | loss: 0.0102373
	speed: 0.0648s/iter; left time: 2862.9117s
Epoch: 6 cost time: 29.758718252182007
Epoch: 6, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.951399 --> -0.957974).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1399521
	speed: 0.2794s/iter; left time: 12290.9656s
	iters: 200, epoch: 7 | loss: 0.0328902
	speed: 0.0615s/iter; left time: 2699.3573s
	iters: 300, epoch: 7 | loss: 0.0310650
	speed: 0.0597s/iter; left time: 2616.2072s
	iters: 400, epoch: 7 | loss: 0.0061946
	speed: 0.0606s/iter; left time: 2646.6670s
Epoch: 7 cost time: 29.092884302139282
Epoch: 7, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1105203
	speed: 0.2360s/iter; left time: 10270.8922s
	iters: 200, epoch: 8 | loss: 0.0199151
	speed: 0.0594s/iter; left time: 2578.0391s
	iters: 300, epoch: 8 | loss: 0.0084499
	speed: 0.0596s/iter; left time: 2579.8203s
	iters: 400, epoch: 8 | loss: 0.0115781
	speed: 0.0577s/iter; left time: 2494.8400s
Epoch: 8 cost time: 27.82763910293579
Epoch: 8, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.957974 --> -0.962549).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3468116
	speed: 0.2585s/iter; left time: 11126.6974s
	iters: 200, epoch: 9 | loss: 0.0455536
	speed: 0.0608s/iter; left time: 2612.5219s
	iters: 300, epoch: 9 | loss: 0.0032655
	speed: 0.0601s/iter; left time: 2577.1981s
	iters: 400, epoch: 9 | loss: 0.0815317
	speed: 0.0597s/iter; left time: 2552.5630s
Epoch: 9 cost time: 28.75338912010193
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0026891
	speed: 0.2743s/iter; left time: 11679.1869s
	iters: 200, epoch: 10 | loss: 0.0231930
	speed: 0.0591s/iter; left time: 2512.0293s
	iters: 300, epoch: 10 | loss: 0.0180437
	speed: 0.0612s/iter; left time: 2594.7598s
	iters: 400, epoch: 10 | loss: 0.0119270
	speed: 0.0634s/iter; left time: 2680.4045s
Epoch: 10 cost time: 29.11919641494751
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0470263
	speed: 0.2722s/iter; left time: 11461.7880s
	iters: 200, epoch: 11 | loss: 0.0020139
	speed: 0.0626s/iter; left time: 2631.5261s
	iters: 300, epoch: 11 | loss: 0.0041520
	speed: 0.0622s/iter; left time: 2606.1275s
	iters: 400, epoch: 11 | loss: 0.0023469
	speed: 0.0627s/iter; left time: 2621.6629s
Epoch: 11 cost time: 29.66738772392273
Epoch: 11, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0045440
	speed: 0.2853s/iter; left time: 11880.8742s
	iters: 200, epoch: 12 | loss: 0.0995295
	speed: 0.0615s/iter; left time: 2554.8648s
	iters: 300, epoch: 12 | loss: 0.0569629
	speed: 0.0671s/iter; left time: 2780.3914s
	iters: 400, epoch: 12 | loss: 0.4815685
	speed: 0.0603s/iter; left time: 2493.9261s
Epoch: 12 cost time: 29.551109790802002
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.962549 --> -0.966265).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0326093
	speed: 0.2860s/iter; left time: 11776.8847s
	iters: 200, epoch: 13 | loss: 0.0242295
	speed: 0.0643s/iter; left time: 2639.4509s
	iters: 300, epoch: 13 | loss: 0.0013305
	speed: 0.0646s/iter; left time: 2645.8894s
	iters: 400, epoch: 13 | loss: 0.0060573
	speed: 0.0649s/iter; left time: 2653.7200s
Epoch: 13 cost time: 30.25266695022583
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0059189
	speed: 0.2875s/iter; left time: 11701.1840s
	iters: 200, epoch: 14 | loss: 0.0023070
	speed: 0.0629s/iter; left time: 2552.7436s
	iters: 300, epoch: 14 | loss: 0.0172747
	speed: 0.0620s/iter; left time: 2511.7655s
	iters: 400, epoch: 14 | loss: 0.0061146
	speed: 0.0623s/iter; left time: 2516.9717s
Epoch: 14 cost time: 29.48291325569153
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0035735
	speed: 0.2576s/iter; left time: 10364.5744s
	iters: 200, epoch: 15 | loss: 0.0369518
	speed: 0.0607s/iter; left time: 2437.4379s
	iters: 300, epoch: 15 | loss: 0.0030188
	speed: 0.0627s/iter; left time: 2511.7991s
	iters: 400, epoch: 15 | loss: 0.0011315
	speed: 0.0596s/iter; left time: 2381.5176s
Epoch: 15 cost time: 28.95300555229187
Epoch: 15, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.249 Vali Acc: 0.934 Test Loss: 0.249 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0329578
	speed: 0.2808s/iter; left time: 11165.1626s
	iters: 200, epoch: 16 | loss: 0.0028207
	speed: 0.0622s/iter; left time: 2467.3075s
	iters: 300, epoch: 16 | loss: 0.0148983
	speed: 0.0620s/iter; left time: 2453.3105s
	iters: 400, epoch: 16 | loss: 0.0094112
	speed: 0.0637s/iter; left time: 2512.5657s
Epoch: 16 cost time: 29.73157262802124
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0063296
	speed: 0.2869s/iter; left time: 11276.2550s
	iters: 200, epoch: 17 | loss: 0.0090312
	speed: 0.0605s/iter; left time: 2372.6865s
	iters: 300, epoch: 17 | loss: 0.0116924
	speed: 0.0566s/iter; left time: 2214.2154s
	iters: 400, epoch: 17 | loss: 0.0638517
	speed: 0.0590s/iter; left time: 2301.3598s
Epoch: 17 cost time: 28.178006649017334
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0032943
	speed: 0.2660s/iter; left time: 10328.0958s
	iters: 200, epoch: 18 | loss: 0.0026712
	speed: 0.0567s/iter; left time: 2196.1017s
	iters: 300, epoch: 18 | loss: 0.0013195
	speed: 0.0577s/iter; left time: 2228.6311s
	iters: 400, epoch: 18 | loss: 0.0801492
	speed: 0.0575s/iter; left time: 2216.8460s
Epoch: 18 cost time: 27.526228189468384
Epoch: 18, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.192 Vali Acc: 0.961 Test Loss: 0.192 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3563302
	speed: 0.2666s/iter; left time: 10226.8330s
	iters: 200, epoch: 19 | loss: 0.0350361
	speed: 0.0608s/iter; left time: 2327.0756s
	iters: 300, epoch: 19 | loss: 0.0034939
	speed: 0.0612s/iter; left time: 2336.2666s
	iters: 400, epoch: 19 | loss: 0.0032032
	speed: 0.0616s/iter; left time: 2345.8839s
Epoch: 19 cost time: 28.750733375549316
Epoch: 19, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0038832
	speed: 0.2711s/iter; left time: 10273.0564s
	iters: 200, epoch: 20 | loss: 0.0004337
	speed: 0.0574s/iter; left time: 2168.0639s
	iters: 300, epoch: 20 | loss: 0.0010547
	speed: 0.0596s/iter; left time: 2248.0522s
	iters: 400, epoch: 20 | loss: 0.0177514
	speed: 0.0641s/iter; left time: 2409.5970s
Epoch: 20 cost time: 28.792466640472412
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.966265 --> -0.969696).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0025170
	speed: 0.2708s/iter; left time: 10132.6905s
	iters: 200, epoch: 21 | loss: 0.1203788
	speed: 0.0625s/iter; left time: 2333.7320s
	iters: 300, epoch: 21 | loss: 0.3368489
	speed: 0.0587s/iter; left time: 2185.5923s
	iters: 400, epoch: 21 | loss: 0.0215580
	speed: 0.0593s/iter; left time: 2201.1590s
Epoch: 21 cost time: 28.133676528930664
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0434925
	speed: 0.2655s/iter; left time: 9811.8863s
	iters: 200, epoch: 22 | loss: 0.0035265
	speed: 0.0584s/iter; left time: 2150.7658s
	iters: 300, epoch: 22 | loss: 0.0034241
	speed: 0.0594s/iter; left time: 2183.0052s
	iters: 400, epoch: 22 | loss: 0.0013222
	speed: 0.0593s/iter; left time: 2173.0569s
Epoch: 22 cost time: 28.253119945526123
Epoch: 22, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5469351
	speed: 0.2787s/iter; left time: 10166.9378s
	iters: 200, epoch: 23 | loss: 0.1153242
	speed: 0.0667s/iter; left time: 2427.3184s
	iters: 300, epoch: 23 | loss: 0.0016264
	speed: 0.0641s/iter; left time: 2327.3424s
	iters: 400, epoch: 23 | loss: 0.0023622
	speed: 0.0628s/iter; left time: 2271.1235s
Epoch: 23 cost time: 30.509706258773804
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0007222
	speed: 0.2955s/iter; left time: 10642.7495s
	iters: 200, epoch: 24 | loss: 0.0790960
	speed: 0.0631s/iter; left time: 2266.0026s
	iters: 300, epoch: 24 | loss: 0.0415145
	speed: 0.0662s/iter; left time: 2370.7551s
	iters: 400, epoch: 24 | loss: 0.0129638
	speed: 0.0595s/iter; left time: 2125.1951s
Epoch: 24 cost time: 29.681612730026245
Epoch: 24, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0123466
	speed: 0.2885s/iter; left time: 10253.5687s
	iters: 200, epoch: 25 | loss: 0.0164186
	speed: 0.0606s/iter; left time: 2148.1143s
	iters: 300, epoch: 25 | loss: 0.0005266
	speed: 0.0645s/iter; left time: 2279.4236s
	iters: 400, epoch: 25 | loss: 0.0420215
	speed: 0.0632s/iter; left time: 2227.8014s
Epoch: 25 cost time: 29.960702419281006
Epoch: 25, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3091232
	speed: 0.2727s/iter; left time: 9563.9122s
	iters: 200, epoch: 26 | loss: 0.0085373
	speed: 0.0605s/iter; left time: 2115.1958s
	iters: 300, epoch: 26 | loss: 0.1865115
	speed: 0.0627s/iter; left time: 2187.4514s
	iters: 400, epoch: 26 | loss: 0.0115902
	speed: 0.0617s/iter; left time: 2145.0740s
Epoch: 26 cost time: 29.334122896194458
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0007870
	speed: 0.2691s/iter; left time: 9313.3188s
	iters: 200, epoch: 27 | loss: 0.0943453
	speed: 0.0571s/iter; left time: 1971.2912s
	iters: 300, epoch: 27 | loss: 0.0155190
	speed: 0.0649s/iter; left time: 2232.3212s
	iters: 400, epoch: 27 | loss: 0.0117165
	speed: 0.0617s/iter; left time: 2118.1004s
Epoch: 27 cost time: 28.216816186904907
Epoch: 27, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1825597
	speed: 0.2754s/iter; left time: 9402.0404s
	iters: 200, epoch: 28 | loss: 0.0029252
	speed: 0.0610s/iter; left time: 2074.8178s
	iters: 300, epoch: 28 | loss: 0.0196304
	speed: 0.0593s/iter; left time: 2012.0347s
	iters: 400, epoch: 28 | loss: 0.0122844
	speed: 0.0579s/iter; left time: 1959.2787s
Epoch: 28 cost time: 28.81928849220276
Epoch: 28, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.971125).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0014382
	speed: 0.2723s/iter; left time: 9166.5149s
	iters: 200, epoch: 29 | loss: 0.0005353
	speed: 0.0572s/iter; left time: 1920.8225s
	iters: 300, epoch: 29 | loss: 0.0013102
	speed: 0.0598s/iter; left time: 2000.9163s
	iters: 400, epoch: 29 | loss: 0.0342561
	speed: 0.0548s/iter; left time: 1830.2101s
Epoch: 29 cost time: 27.34691023826599
Epoch: 29, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0585989
	speed: 0.2346s/iter; left time: 7790.1503s
	iters: 200, epoch: 30 | loss: 0.0022781
	speed: 0.0582s/iter; left time: 1928.0344s
	iters: 300, epoch: 30 | loss: 0.0013129
	speed: 0.0582s/iter; left time: 1919.3401s
	iters: 400, epoch: 30 | loss: 0.0013875
	speed: 0.0606s/iter; left time: 1994.5881s
Epoch: 30 cost time: 27.991701364517212
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0114479
	speed: 0.2685s/iter; left time: 8788.5148s
	iters: 200, epoch: 31 | loss: 0.0084774
	speed: 0.0587s/iter; left time: 1913.9815s
	iters: 300, epoch: 31 | loss: 0.0189734
	speed: 0.0588s/iter; left time: 1912.3114s
	iters: 400, epoch: 31 | loss: 0.0010995
	speed: 0.0597s/iter; left time: 1937.4572s
Epoch: 31 cost time: 28.062992572784424
Epoch: 31, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.955 Test Loss: 0.205 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0016332
	speed: 0.2612s/iter; left time: 8428.3837s
	iters: 200, epoch: 32 | loss: 0.0005051
	speed: 0.0586s/iter; left time: 1885.4021s
	iters: 300, epoch: 32 | loss: 0.0019289
	speed: 0.0585s/iter; left time: 1876.7082s
	iters: 400, epoch: 32 | loss: 0.0090607
	speed: 0.0598s/iter; left time: 1912.0440s
Epoch: 32 cost time: 27.849720239639282
Epoch: 32, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0014272
	speed: 0.2600s/iter; left time: 8265.0923s
	iters: 200, epoch: 33 | loss: 0.0018325
	speed: 0.0594s/iter; left time: 1883.2054s
	iters: 300, epoch: 33 | loss: 0.0004742
	speed: 0.0583s/iter; left time: 1841.0942s
	iters: 400, epoch: 33 | loss: 0.0394681
	speed: 0.0585s/iter; left time: 1843.0011s
Epoch: 33 cost time: 28.138569116592407
Epoch: 33, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0008971
	speed: 0.2668s/iter; left time: 8356.9154s
	iters: 200, epoch: 34 | loss: 0.0038143
	speed: 0.0608s/iter; left time: 1898.7174s
	iters: 300, epoch: 34 | loss: 0.0003562
	speed: 0.0651s/iter; left time: 2024.6513s
	iters: 400, epoch: 34 | loss: 0.0004854
	speed: 0.0627s/iter; left time: 1944.4255s
Epoch: 34 cost time: 29.45497417449951
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0023783
	speed: 0.2842s/iter; left time: 8767.6438s
	iters: 200, epoch: 35 | loss: 0.0007469
	speed: 0.0609s/iter; left time: 1873.9785s
	iters: 300, epoch: 35 | loss: 0.0015315
	speed: 0.0632s/iter; left time: 1937.3009s
	iters: 400, epoch: 35 | loss: 0.0005241
	speed: 0.0615s/iter; left time: 1880.1608s
Epoch: 35 cost time: 29.227046728134155
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0934998
	speed: 0.2854s/iter; left time: 8672.6843s
	iters: 200, epoch: 36 | loss: 0.0067577
	speed: 0.0625s/iter; left time: 1892.5655s
	iters: 300, epoch: 36 | loss: 0.0012805
	speed: 0.0623s/iter; left time: 1881.1938s
	iters: 400, epoch: 36 | loss: 0.0028213
	speed: 0.0653s/iter; left time: 1964.6221s
Epoch: 36 cost time: 29.91733193397522
Epoch: 36, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.971125 --> -0.976843).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0019485
	speed: 0.2857s/iter; left time: 8548.6221s
	iters: 200, epoch: 37 | loss: 0.0085240
	speed: 0.0594s/iter; left time: 1771.9577s
	iters: 300, epoch: 37 | loss: 0.0007090
	speed: 0.0551s/iter; left time: 1637.2666s
	iters: 400, epoch: 37 | loss: 0.0005590
	speed: 0.0555s/iter; left time: 1643.5085s
Epoch: 37 cost time: 27.049806594848633
Epoch: 37, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0104185
	speed: 0.2461s/iter; left time: 7247.9944s
	iters: 200, epoch: 38 | loss: 0.0019347
	speed: 0.0625s/iter; left time: 1835.5609s
	iters: 300, epoch: 38 | loss: 0.4300276
	speed: 0.0590s/iter; left time: 1724.5506s
	iters: 400, epoch: 38 | loss: 0.0005418
	speed: 0.0614s/iter; left time: 1788.3014s
Epoch: 38 cost time: 29.11114192008972
Epoch: 38, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0210491
	speed: 0.2686s/iter; left time: 7784.8439s
	iters: 200, epoch: 39 | loss: 0.0006348
	speed: 0.0579s/iter; left time: 1673.2187s
	iters: 300, epoch: 39 | loss: 0.0008882
	speed: 0.0593s/iter; left time: 1707.3396s
	iters: 400, epoch: 39 | loss: 0.0025952
	speed: 0.0598s/iter; left time: 1716.0084s
Epoch: 39 cost time: 27.837754249572754
Epoch: 39, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0011128
	speed: 0.2587s/iter; left time: 7375.5338s
	iters: 200, epoch: 40 | loss: 0.0010990
	speed: 0.0581s/iter; left time: 1651.1316s
	iters: 300, epoch: 40 | loss: 0.0003154
	speed: 0.0600s/iter; left time: 1699.4436s
	iters: 400, epoch: 40 | loss: 0.0007070
	speed: 0.0573s/iter; left time: 1615.7938s
Epoch: 40 cost time: 27.88352060317993
Epoch: 40, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0017037
	speed: 0.2699s/iter; left time: 7568.3801s
	iters: 200, epoch: 41 | loss: 0.0033008
	speed: 0.0593s/iter; left time: 1655.8281s
	iters: 300, epoch: 41 | loss: 0.0028776
	speed: 0.0620s/iter; left time: 1725.3222s
	iters: 400, epoch: 41 | loss: 0.0354342
	speed: 0.0612s/iter; left time: 1697.1818s
Epoch: 41 cost time: 28.58681082725525
Epoch: 41, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0009539
	speed: 0.2703s/iter; left time: 7451.3481s
	iters: 200, epoch: 42 | loss: 0.0025469
	speed: 0.0592s/iter; left time: 1626.5571s
	iters: 300, epoch: 42 | loss: 0.4033122
	speed: 0.0623s/iter; left time: 1706.5527s
	iters: 400, epoch: 42 | loss: 0.0003241
	speed: 0.0604s/iter; left time: 1646.4082s
Epoch: 42 cost time: 28.760169506072998
Epoch: 42, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.1660107
	speed: 0.2793s/iter; left time: 7570.6082s
	iters: 200, epoch: 43 | loss: 0.0029787
	speed: 0.0634s/iter; left time: 1711.1706s
	iters: 300, epoch: 43 | loss: 0.0028534
	speed: 0.0626s/iter; left time: 1684.1096s
	iters: 400, epoch: 43 | loss: 0.0006979
	speed: 0.0603s/iter; left time: 1616.8002s
Epoch: 43 cost time: 29.474636554718018
Epoch: 43, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0005997
	speed: 0.2793s/iter; left time: 7439.4639s
	iters: 200, epoch: 44 | loss: 0.0900362
	speed: 0.0623s/iter; left time: 1653.1343s
	iters: 300, epoch: 44 | loss: 0.0018854
	speed: 0.0598s/iter; left time: 1579.6667s
	iters: 400, epoch: 44 | loss: 0.0006243
	speed: 0.0604s/iter; left time: 1590.3643s
Epoch: 44 cost time: 28.85745143890381
Epoch: 44, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0025036
	speed: 0.2585s/iter; left time: 6763.9057s
	iters: 200, epoch: 45 | loss: 0.0017596
	speed: 0.0609s/iter; left time: 1587.3926s
	iters: 300, epoch: 45 | loss: 0.0171542
	speed: 0.0667s/iter; left time: 1731.2543s
	iters: 400, epoch: 45 | loss: 0.0004358
	speed: 0.0651s/iter; left time: 1684.6070s
Epoch: 45 cost time: 29.86903715133667
Epoch: 45, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0008112
	speed: 0.2860s/iter; left time: 7349.0445s
	iters: 200, epoch: 46 | loss: 0.0012470
	speed: 0.0653s/iter; left time: 1671.1329s
	iters: 300, epoch: 46 | loss: 0.0006082
	speed: 0.0647s/iter; left time: 1648.7692s
	iters: 400, epoch: 46 | loss: 0.0280078
	speed: 0.0673s/iter; left time: 1709.1800s
Epoch: 46 cost time: 31.179649114608765
Epoch: 46, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 593018
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0844687
	speed: 0.0774s/iter; left time: 3623.2981s
	iters: 200, epoch: 1 | loss: 0.5850797
	speed: 0.0626s/iter; left time: 2924.7476s
	iters: 300, epoch: 1 | loss: 0.3311795
	speed: 0.0638s/iter; left time: 2971.8165s
	iters: 400, epoch: 1 | loss: 0.2824988
	speed: 0.0650s/iter; left time: 3022.6125s
Epoch: 1 cost time: 31.414679050445557
Epoch: 1, Steps: 469 | Train Loss: 0.781 Vali Loss: 0.417 Vali Acc: 0.878 Test Loss: 0.417 Test Acc: 0.878
Validation loss decreased (inf --> -0.878212).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3238276
	speed: 0.2763s/iter; left time: 12803.5235s
	iters: 200, epoch: 2 | loss: 0.5716344
	speed: 0.0624s/iter; left time: 2885.7378s
	iters: 300, epoch: 2 | loss: 0.0646630
	speed: 0.0574s/iter; left time: 2646.5964s
	iters: 400, epoch: 2 | loss: 0.3108597
	speed: 0.0603s/iter; left time: 2776.1380s
Epoch: 2 cost time: 28.985454559326172
Epoch: 2, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.878212 --> -0.921667).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1735691
	speed: 0.2725s/iter; left time: 12499.5444s
	iters: 200, epoch: 3 | loss: 0.1463954
	speed: 0.0636s/iter; left time: 2908.3467s
	iters: 300, epoch: 3 | loss: 0.1414599
	speed: 0.0628s/iter; left time: 2866.2466s
	iters: 400, epoch: 3 | loss: 0.2627390
	speed: 0.0618s/iter; left time: 2814.6642s
Epoch: 3 cost time: 29.684876680374146
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1845659
	speed: 0.2709s/iter; left time: 12295.5734s
	iters: 200, epoch: 4 | loss: 0.3904481
	speed: 0.0608s/iter; left time: 2752.2553s
	iters: 300, epoch: 4 | loss: 0.0330235
	speed: 0.0599s/iter; left time: 2709.0650s
	iters: 400, epoch: 4 | loss: 0.0856161
	speed: 0.0611s/iter; left time: 2754.8490s
Epoch: 4 cost time: 29.539369821548462
Epoch: 4, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.261 Vali Acc: 0.928 Test Loss: 0.261 Test Acc: 0.928
Validation loss decreased (-0.921667 --> -0.928242).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0647091
	speed: 0.2811s/iter; left time: 12628.7556s
	iters: 200, epoch: 5 | loss: 0.0096293
	speed: 0.0598s/iter; left time: 2681.1978s
	iters: 300, epoch: 5 | loss: 0.0042510
	speed: 0.0603s/iter; left time: 2694.8054s
	iters: 400, epoch: 5 | loss: 0.0054155
	speed: 0.0611s/iter; left time: 2727.2231s
Epoch: 5 cost time: 28.532866716384888
Epoch: 5, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
Validation loss decreased (-0.928242 --> -0.939392).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1176093
	speed: 0.2789s/iter; left time: 12399.2953s
	iters: 200, epoch: 6 | loss: 0.0050877
	speed: 0.0652s/iter; left time: 2893.7270s
	iters: 300, epoch: 6 | loss: 0.0229167
	speed: 0.0627s/iter; left time: 2775.3276s
	iters: 400, epoch: 6 | loss: 0.1696613
	speed: 0.0610s/iter; left time: 2693.6628s
Epoch: 6 cost time: 30.10932946205139
Epoch: 6, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
Validation loss decreased (-0.939392 --> -0.946539).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0044700
	speed: 0.2751s/iter; left time: 12101.2313s
	iters: 200, epoch: 7 | loss: 0.0461571
	speed: 0.0597s/iter; left time: 2621.2565s
	iters: 300, epoch: 7 | loss: 0.0118769
	speed: 0.0596s/iter; left time: 2607.9190s
	iters: 400, epoch: 7 | loss: 0.0259461
	speed: 0.0585s/iter; left time: 2553.6289s
Epoch: 7 cost time: 28.882357835769653
Epoch: 7, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.946539 --> -0.948254).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0450677
	speed: 0.2676s/iter; left time: 11644.2448s
	iters: 200, epoch: 8 | loss: 0.0073822
	speed: 0.0601s/iter; left time: 2609.6681s
	iters: 300, epoch: 8 | loss: 0.0679499
	speed: 0.0594s/iter; left time: 2573.3299s
	iters: 400, epoch: 8 | loss: 0.0096640
	speed: 0.0580s/iter; left time: 2505.1964s
Epoch: 8 cost time: 27.987597942352295
Epoch: 8, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.948254 --> -0.964836).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3925675
	speed: 0.2720s/iter; left time: 11708.4922s
	iters: 200, epoch: 9 | loss: 0.0595991
	speed: 0.0603s/iter; left time: 2589.3872s
	iters: 300, epoch: 9 | loss: 0.0057213
	speed: 0.0588s/iter; left time: 2521.4549s
	iters: 400, epoch: 9 | loss: 0.0578356
	speed: 0.0600s/iter; left time: 2564.3012s
Epoch: 9 cost time: 28.70195770263672
Epoch: 9, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0141291
	speed: 0.2761s/iter; left time: 11754.8380s
	iters: 200, epoch: 10 | loss: 0.1388665
	speed: 0.0623s/iter; left time: 2648.6226s
	iters: 300, epoch: 10 | loss: 0.0177080
	speed: 0.0609s/iter; left time: 2582.4060s
	iters: 400, epoch: 10 | loss: 0.3635046
	speed: 0.0671s/iter; left time: 2836.1847s
Epoch: 10 cost time: 30.039344310760498
Epoch: 10, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0047610
	speed: 0.2962s/iter; left time: 12474.6055s
	iters: 200, epoch: 11 | loss: 0.1109364
	speed: 0.0612s/iter; left time: 2569.0024s
	iters: 300, epoch: 11 | loss: 0.0094494
	speed: 0.0628s/iter; left time: 2632.2252s
	iters: 400, epoch: 11 | loss: 0.0027715
	speed: 0.0628s/iter; left time: 2623.9210s
Epoch: 11 cost time: 29.86945652961731
Epoch: 11, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2613883
	speed: 0.2977s/iter; left time: 12395.4102s
	iters: 200, epoch: 12 | loss: 0.0054132
	speed: 0.0664s/iter; left time: 2757.4225s
	iters: 300, epoch: 12 | loss: 0.0201093
	speed: 0.0622s/iter; left time: 2577.1644s
	iters: 400, epoch: 12 | loss: 0.0286335
	speed: 0.0609s/iter; left time: 2518.0741s
Epoch: 12 cost time: 30.637486457824707
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.966837).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0176597
	speed: 0.2811s/iter; left time: 11572.8318s
	iters: 200, epoch: 13 | loss: 0.0112435
	speed: 0.0588s/iter; left time: 2413.9991s
	iters: 300, epoch: 13 | loss: 0.4038191
	speed: 0.0620s/iter; left time: 2538.4356s
	iters: 400, epoch: 13 | loss: 0.0056965
	speed: 0.0649s/iter; left time: 2651.2366s
Epoch: 13 cost time: 29.005476236343384
Epoch: 13, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.966837 --> -0.967694).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0060106
	speed: 0.2676s/iter; left time: 10892.6298s
	iters: 200, epoch: 14 | loss: 0.0440994
	speed: 0.0613s/iter; left time: 2488.3927s
	iters: 300, epoch: 14 | loss: 0.0177243
	speed: 0.0624s/iter; left time: 2529.1246s
	iters: 400, epoch: 14 | loss: 0.0248244
	speed: 0.0598s/iter; left time: 2417.1370s
Epoch: 14 cost time: 29.009661436080933
Epoch: 14, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0338915
	speed: 0.2731s/iter; left time: 10986.8316s
	iters: 200, epoch: 15 | loss: 0.0030105
	speed: 0.0605s/iter; left time: 2429.8659s
	iters: 300, epoch: 15 | loss: 0.0056969
	speed: 0.0594s/iter; left time: 2378.1911s
	iters: 400, epoch: 15 | loss: 0.0214410
	speed: 0.0601s/iter; left time: 2400.4655s
Epoch: 15 cost time: 28.60137701034546
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0031252
	speed: 0.2713s/iter; left time: 10787.8570s
	iters: 200, epoch: 16 | loss: 0.0013099
	speed: 0.0579s/iter; left time: 2298.2312s
	iters: 300, epoch: 16 | loss: 0.0033299
	speed: 0.0581s/iter; left time: 2300.0632s
	iters: 400, epoch: 16 | loss: 0.0030748
	speed: 0.0588s/iter; left time: 2320.4443s
Epoch: 16 cost time: 28.26055121421814
Epoch: 16, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0256180
	speed: 0.2741s/iter; left time: 10771.7297s
	iters: 200, epoch: 17 | loss: 0.0074477
	speed: 0.0627s/iter; left time: 2457.3290s
	iters: 300, epoch: 17 | loss: 0.0128338
	speed: 0.0629s/iter; left time: 2459.4993s
	iters: 400, epoch: 17 | loss: 0.0074724
	speed: 0.0595s/iter; left time: 2321.9796s
Epoch: 17 cost time: 29.10906410217285
Epoch: 17, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.179 Vali Acc: 0.966 Test Loss: 0.179 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0454257
	speed: 0.2709s/iter; left time: 10518.9831s
	iters: 200, epoch: 18 | loss: 0.0051549
	speed: 0.0586s/iter; left time: 2269.9958s
	iters: 300, epoch: 18 | loss: 0.0046438
	speed: 0.0592s/iter; left time: 2287.3700s
	iters: 400, epoch: 18 | loss: 0.5892109
	speed: 0.0589s/iter; left time: 2268.1871s
Epoch: 18 cost time: 28.350444793701172
Epoch: 18, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.967694 --> -0.974270).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0055335
	speed: 0.2609s/iter; left time: 10008.0166s
	iters: 200, epoch: 19 | loss: 0.0760634
	speed: 0.0646s/iter; left time: 2472.3845s
	iters: 300, epoch: 19 | loss: 0.1935689
	speed: 0.0637s/iter; left time: 2432.5505s
	iters: 400, epoch: 19 | loss: 0.0070535
	speed: 0.0646s/iter; left time: 2460.4107s
Epoch: 19 cost time: 30.27831268310547
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0047955
	speed: 0.2792s/iter; left time: 10578.5490s
	iters: 200, epoch: 20 | loss: 0.0366237
	speed: 0.0603s/iter; left time: 2279.8232s
	iters: 300, epoch: 20 | loss: 0.0056337
	speed: 0.0590s/iter; left time: 2225.3615s
	iters: 400, epoch: 20 | loss: 0.0026213
	speed: 0.0594s/iter; left time: 2232.9315s
Epoch: 20 cost time: 28.658073663711548
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2942778
	speed: 0.2751s/iter; left time: 10293.4875s
	iters: 200, epoch: 21 | loss: 0.0639638
	speed: 0.0623s/iter; left time: 2324.4095s
	iters: 300, epoch: 21 | loss: 0.0067088
	speed: 0.0628s/iter; left time: 2336.3934s
	iters: 400, epoch: 21 | loss: 0.0039781
	speed: 0.0646s/iter; left time: 2398.1983s
Epoch: 21 cost time: 29.766140460968018
Epoch: 21, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0028519
	speed: 0.3001s/iter; left time: 11090.9617s
	iters: 200, epoch: 22 | loss: 0.0039091
	speed: 0.0666s/iter; left time: 2454.1624s
	iters: 300, epoch: 22 | loss: 0.1131793
	speed: 0.0609s/iter; left time: 2237.2836s
	iters: 400, epoch: 22 | loss: 0.0124908
	speed: 0.0632s/iter; left time: 2315.2532s
Epoch: 22 cost time: 30.948915243148804
Epoch: 22, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0235900
	speed: 0.3054s/iter; left time: 11142.0387s
	iters: 200, epoch: 23 | loss: 0.3622833
	speed: 0.0656s/iter; left time: 2387.5627s
	iters: 300, epoch: 23 | loss: 0.0044240
	speed: 0.0656s/iter; left time: 2381.9545s
	iters: 400, epoch: 23 | loss: 0.0153676
	speed: 0.0633s/iter; left time: 2289.4404s
Epoch: 23 cost time: 30.672149181365967
Epoch: 23, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.245 Vali Acc: 0.953 Test Loss: 0.245 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0020533
	speed: 0.2719s/iter; left time: 9792.1001s
	iters: 200, epoch: 24 | loss: 0.0059835
	speed: 0.0608s/iter; left time: 2184.8849s
	iters: 300, epoch: 24 | loss: 0.0049799
	speed: 0.0610s/iter; left time: 2185.2685s
	iters: 400, epoch: 24 | loss: 0.2172912
	speed: 0.0622s/iter; left time: 2222.0001s
Epoch: 24 cost time: 28.980045318603516
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1630310
	speed: 0.2776s/iter; left time: 9868.7969s
	iters: 200, epoch: 25 | loss: 0.0064267
	speed: 0.0607s/iter; left time: 2151.7325s
	iters: 300, epoch: 25 | loss: 0.0022852
	speed: 0.0614s/iter; left time: 2170.6078s
	iters: 400, epoch: 25 | loss: 0.0209997
	speed: 0.0579s/iter; left time: 2042.3625s
Epoch: 25 cost time: 28.918978214263916
Epoch: 25, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0021250
	speed: 0.2746s/iter; left time: 9630.9332s
	iters: 200, epoch: 26 | loss: 0.0020618
	speed: 0.0619s/iter; left time: 2164.3829s
	iters: 300, epoch: 26 | loss: 0.0034960
	speed: 0.0619s/iter; left time: 2160.0731s
	iters: 400, epoch: 26 | loss: 0.0010948
	speed: 0.0601s/iter; left time: 2089.3810s
Epoch: 26 cost time: 29.41850185394287
Epoch: 26, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0137625
	speed: 0.2697s/iter; left time: 9334.8898s
	iters: 200, epoch: 27 | loss: 0.0019679
	speed: 0.0605s/iter; left time: 2086.8009s
	iters: 300, epoch: 27 | loss: 0.0016811
	speed: 0.0645s/iter; left time: 2218.9295s
	iters: 400, epoch: 27 | loss: 0.0046851
	speed: 0.0633s/iter; left time: 2169.9576s
Epoch: 27 cost time: 29.651036500930786
Epoch: 27, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0129531
	speed: 0.2697s/iter; left time: 9205.6151s
	iters: 200, epoch: 28 | loss: 0.0083047
	speed: 0.0688s/iter; left time: 2340.7062s
	iters: 300, epoch: 28 | loss: 0.0061185
	speed: 0.0641s/iter; left time: 2175.6085s
	iters: 400, epoch: 28 | loss: 0.0020851
	speed: 0.0609s/iter; left time: 2062.0967s
Epoch: 28 cost time: 30.372783660888672
Epoch: 28, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 590266
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0272943
	speed: 0.0763s/iter; left time: 3568.6686s
	iters: 200, epoch: 1 | loss: 0.8520133
	speed: 0.0607s/iter; left time: 2832.6226s
	iters: 300, epoch: 1 | loss: 0.2783283
	speed: 0.0647s/iter; left time: 3013.7248s
	iters: 400, epoch: 1 | loss: 0.4349623
	speed: 0.0602s/iter; left time: 2800.8020s
Epoch: 1 cost time: 30.314804792404175
Epoch: 1, Steps: 469 | Train Loss: 0.831 Vali Loss: 0.351 Vali Acc: 0.888 Test Loss: 0.351 Test Acc: 0.888
Validation loss decreased (inf --> -0.887647).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1781663
	speed: 0.2595s/iter; left time: 12022.5507s
	iters: 200, epoch: 2 | loss: 0.5143136
	speed: 0.0617s/iter; left time: 2852.3943s
	iters: 300, epoch: 2 | loss: 0.2333520
	speed: 0.0623s/iter; left time: 2874.1844s
	iters: 400, epoch: 2 | loss: 0.1243020
	speed: 0.0618s/iter; left time: 2844.4016s
Epoch: 2 cost time: 29.03008270263672
Epoch: 2, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.887647 --> -0.925669).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0452672
	speed: 0.2719s/iter; left time: 12468.3315s
	iters: 200, epoch: 3 | loss: 0.1064836
	speed: 0.0586s/iter; left time: 2680.5191s
	iters: 300, epoch: 3 | loss: 0.2976744
	speed: 0.0619s/iter; left time: 2824.9539s
	iters: 400, epoch: 3 | loss: 0.0162553
	speed: 0.0624s/iter; left time: 2842.2151s
Epoch: 3 cost time: 28.770296573638916
Epoch: 3, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.283 Vali Acc: 0.915 Test Loss: 0.283 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1068217
	speed: 0.2851s/iter; left time: 12942.8722s
	iters: 200, epoch: 4 | loss: 0.1723208
	speed: 0.0622s/iter; left time: 2817.5870s
	iters: 300, epoch: 4 | loss: 0.3659330
	speed: 0.0614s/iter; left time: 2773.1349s
	iters: 400, epoch: 4 | loss: 0.0234694
	speed: 0.0606s/iter; left time: 2732.1049s
Epoch: 4 cost time: 29.13899254798889
Epoch: 4, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.925669 --> -0.940536).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1441079
	speed: 0.2876s/iter; left time: 12922.2892s
	iters: 200, epoch: 5 | loss: 0.2992204
	speed: 0.0637s/iter; left time: 2857.2452s
	iters: 300, epoch: 5 | loss: 0.6824033
	speed: 0.0650s/iter; left time: 2908.3141s
	iters: 400, epoch: 5 | loss: 0.0123125
	speed: 0.0673s/iter; left time: 3001.2676s
Epoch: 5 cost time: 31.00741720199585
Epoch: 5, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.243 Vali Acc: 0.947 Test Loss: 0.243 Test Acc: 0.947
Validation loss decreased (-0.940536 --> -0.947396).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2707217
	speed: 0.2915s/iter; left time: 12958.6745s
	iters: 200, epoch: 6 | loss: 0.0215097
	speed: 0.0671s/iter; left time: 2977.3378s
	iters: 300, epoch: 6 | loss: 0.0375719
	speed: 0.0660s/iter; left time: 2921.5573s
	iters: 400, epoch: 6 | loss: 0.0077082
	speed: 0.0627s/iter; left time: 2768.5398s
Epoch: 6 cost time: 30.362918615341187
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1767120
	speed: 0.2623s/iter; left time: 11539.1305s
	iters: 200, epoch: 7 | loss: 0.0070220
	speed: 0.0597s/iter; left time: 2618.3479s
	iters: 300, epoch: 7 | loss: 0.1672475
	speed: 0.0587s/iter; left time: 2568.9411s
	iters: 400, epoch: 7 | loss: 0.0095768
	speed: 0.0583s/iter; left time: 2546.3243s
Epoch: 7 cost time: 27.691049098968506
Epoch: 7, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.947396 --> -0.948254).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0028575
	speed: 0.2743s/iter; left time: 11936.2008s
	iters: 200, epoch: 8 | loss: 0.1380594
	speed: 0.0645s/iter; left time: 2802.6042s
	iters: 300, epoch: 8 | loss: 0.0349175
	speed: 0.0689s/iter; left time: 2983.8856s
	iters: 400, epoch: 8 | loss: 0.0494835
	speed: 0.0633s/iter; left time: 2735.8935s
Epoch: 8 cost time: 30.58838963508606
Epoch: 8, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.948254 --> -0.951685).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0118776
	speed: 0.2727s/iter; left time: 11739.5599s
	iters: 200, epoch: 9 | loss: 0.0113775
	speed: 0.0594s/iter; left time: 2552.8396s
	iters: 300, epoch: 9 | loss: 0.0406550
	speed: 0.0579s/iter; left time: 2480.7218s
	iters: 400, epoch: 9 | loss: 0.0346176
	speed: 0.0616s/iter; left time: 2632.7508s
Epoch: 9 cost time: 28.338223695755005
Epoch: 9, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.951685 --> -0.956831).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0326723
	speed: 0.2717s/iter; left time: 11568.9360s
	iters: 200, epoch: 10 | loss: 0.0240818
	speed: 0.0612s/iter; left time: 2600.8759s
	iters: 300, epoch: 10 | loss: 0.0101636
	speed: 0.0616s/iter; left time: 2611.1659s
	iters: 400, epoch: 10 | loss: 0.0503218
	speed: 0.0625s/iter; left time: 2643.7381s
Epoch: 10 cost time: 29.19539761543274
Epoch: 10, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.956831 --> -0.959976).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0166808
	speed: 0.2731s/iter; left time: 11500.6190s
	iters: 200, epoch: 11 | loss: 0.0046448
	speed: 0.0595s/iter; left time: 2499.5201s
	iters: 300, epoch: 11 | loss: 0.0432636
	speed: 0.0597s/iter; left time: 2503.4330s
	iters: 400, epoch: 11 | loss: 0.0088980
	speed: 0.0604s/iter; left time: 2525.7349s
Epoch: 11 cost time: 28.60168480873108
Epoch: 11, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
Validation loss decreased (-0.959976 --> -0.960547).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0111115
	speed: 0.2719s/iter; left time: 11324.2956s
	iters: 200, epoch: 12 | loss: 0.0159730
	speed: 0.0603s/iter; left time: 2504.9557s
	iters: 300, epoch: 12 | loss: 0.0324781
	speed: 0.0618s/iter; left time: 2560.3226s
	iters: 400, epoch: 12 | loss: 0.0040860
	speed: 0.0593s/iter; left time: 2452.4174s
Epoch: 12 cost time: 29.29450249671936
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0073104
	speed: 0.2667s/iter; left time: 10982.6637s
	iters: 200, epoch: 13 | loss: 0.0154710
	speed: 0.0636s/iter; left time: 2610.9266s
	iters: 300, epoch: 13 | loss: 0.0147633
	speed: 0.0674s/iter; left time: 2760.8484s
	iters: 400, epoch: 13 | loss: 0.0839747
	speed: 0.0699s/iter; left time: 2858.4073s
Epoch: 13 cost time: 30.382803440093994
Epoch: 13, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.960547 --> -0.965693).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2303203
	speed: 0.2536s/iter; left time: 10322.5020s
	iters: 200, epoch: 14 | loss: 0.0064092
	speed: 0.0656s/iter; left time: 2664.7150s
	iters: 300, epoch: 14 | loss: 0.0133417
	speed: 0.0609s/iter; left time: 2467.9605s
	iters: 400, epoch: 14 | loss: 0.0075131
	speed: 0.0620s/iter; left time: 2506.5649s
Epoch: 14 cost time: 29.757331371307373
Epoch: 14, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0091902
	speed: 0.2878s/iter; left time: 11580.2041s
	iters: 200, epoch: 15 | loss: 0.0101667
	speed: 0.0626s/iter; left time: 2512.6632s
	iters: 300, epoch: 15 | loss: 0.2463758
	speed: 0.0629s/iter; left time: 2516.7802s
	iters: 400, epoch: 15 | loss: 0.6004716
	speed: 0.0633s/iter; left time: 2526.3731s
Epoch: 15 cost time: 29.987367868423462
Epoch: 15, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0138272
	speed: 0.2948s/iter; left time: 11722.6362s
	iters: 200, epoch: 16 | loss: 0.1719015
	speed: 0.0624s/iter; left time: 2474.2642s
	iters: 300, epoch: 16 | loss: 0.0028465
	speed: 0.0615s/iter; left time: 2432.4605s
	iters: 400, epoch: 16 | loss: 0.7806813
	speed: 0.0620s/iter; left time: 2447.4631s
Epoch: 16 cost time: 29.47464346885681
Epoch: 16, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.265 Vali Acc: 0.955 Test Loss: 0.265 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0030638
	speed: 0.2805s/iter; left time: 11022.4150s
	iters: 200, epoch: 17 | loss: 0.0021128
	speed: 0.0624s/iter; left time: 2445.7866s
	iters: 300, epoch: 17 | loss: 0.0011648
	speed: 0.0628s/iter; left time: 2455.0736s
	iters: 400, epoch: 17 | loss: 0.0015135
	speed: 0.0648s/iter; left time: 2526.7527s
Epoch: 17 cost time: 29.832481622695923
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0012293
	speed: 0.2667s/iter; left time: 10354.1978s
	iters: 200, epoch: 18 | loss: 0.0015737
	speed: 0.0585s/iter; left time: 2266.6915s
	iters: 300, epoch: 18 | loss: 0.0213108
	speed: 0.0615s/iter; left time: 2375.5894s
	iters: 400, epoch: 18 | loss: 0.0032046
	speed: 0.0594s/iter; left time: 2287.5443s
Epoch: 18 cost time: 28.008602619171143
Epoch: 18, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.966551).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0149536
	speed: 0.2631s/iter; left time: 10093.1774s
	iters: 200, epoch: 19 | loss: 0.0077839
	speed: 0.0616s/iter; left time: 2358.6523s
	iters: 300, epoch: 19 | loss: 0.1156811
	speed: 0.0598s/iter; left time: 2282.8593s
	iters: 400, epoch: 19 | loss: 0.0264124
	speed: 0.0592s/iter; left time: 2254.9890s
Epoch: 19 cost time: 29.052367448806763
Epoch: 19, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.966551 --> -0.967980).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1282311
	speed: 0.2818s/iter; left time: 10675.9354s
	iters: 200, epoch: 20 | loss: 0.0067717
	speed: 0.0636s/iter; left time: 2404.9220s
	iters: 300, epoch: 20 | loss: 0.5031568
	speed: 0.0602s/iter; left time: 2270.3918s
	iters: 400, epoch: 20 | loss: 0.0062235
	speed: 0.0614s/iter; left time: 2306.4768s
Epoch: 20 cost time: 29.174078226089478
Epoch: 20, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0042746
	speed: 0.2672s/iter; left time: 9998.5948s
	iters: 200, epoch: 21 | loss: 0.0177297
	speed: 0.0626s/iter; left time: 2336.6524s
	iters: 300, epoch: 21 | loss: 0.0010553
	speed: 0.0610s/iter; left time: 2270.8184s
	iters: 400, epoch: 21 | loss: 0.0402074
	speed: 0.0633s/iter; left time: 2350.4153s
Epoch: 21 cost time: 29.2420871257782
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.322 Vali Acc: 0.929 Test Loss: 0.322 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0029601
	speed: 0.2687s/iter; left time: 9930.0426s
	iters: 200, epoch: 22 | loss: 0.0211737
	speed: 0.0600s/iter; left time: 2210.0439s
	iters: 300, epoch: 22 | loss: 0.2029250
	speed: 0.0635s/iter; left time: 2334.6126s
	iters: 400, epoch: 22 | loss: 0.0428421
	speed: 0.0647s/iter; left time: 2371.3847s
Epoch: 22 cost time: 29.600497007369995
Epoch: 22, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0089434
	speed: 0.2750s/iter; left time: 10032.0714s
	iters: 200, epoch: 23 | loss: 0.0926432
	speed: 0.0627s/iter; left time: 2280.6379s
	iters: 300, epoch: 23 | loss: 0.0030310
	speed: 0.0613s/iter; left time: 2224.8280s
	iters: 400, epoch: 23 | loss: 0.0066453
	speed: 0.0627s/iter; left time: 2266.9850s
Epoch: 23 cost time: 29.683763027191162
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.967980 --> -0.975985).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0269502
	speed: 0.2653s/iter; left time: 9554.9868s
	iters: 200, epoch: 24 | loss: 0.0270906
	speed: 0.0603s/iter; left time: 2166.1322s
	iters: 300, epoch: 24 | loss: 0.0083453
	speed: 0.0585s/iter; left time: 2093.5846s
	iters: 400, epoch: 24 | loss: 0.0035011
	speed: 0.0585s/iter; left time: 2087.5163s
Epoch: 24 cost time: 28.046303033828735
Epoch: 24, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0019131
	speed: 0.2845s/iter; left time: 10113.0344s
	iters: 200, epoch: 25 | loss: 0.0229315
	speed: 0.0668s/iter; left time: 2366.7823s
	iters: 300, epoch: 25 | loss: 0.3653294
	speed: 0.0630s/iter; left time: 2227.6983s
	iters: 400, epoch: 25 | loss: 0.0075090
	speed: 0.0684s/iter; left time: 2411.5739s
Epoch: 25 cost time: 31.276631593704224
Epoch: 25, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.6341808
	speed: 0.2936s/iter; left time: 10297.2019s
	iters: 200, epoch: 26 | loss: 0.0054259
	speed: 0.0645s/iter; left time: 2257.2049s
	iters: 300, epoch: 26 | loss: 0.0114568
	speed: 0.0638s/iter; left time: 2224.2108s
	iters: 400, epoch: 26 | loss: 0.0064779
	speed: 0.0638s/iter; left time: 2219.1193s
Epoch: 26 cost time: 30.19974446296692
Epoch: 26, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0310686
	speed: 0.2900s/iter; left time: 10037.4179s
	iters: 200, epoch: 27 | loss: 0.0022821
	speed: 0.0652s/iter; left time: 2249.3561s
	iters: 300, epoch: 27 | loss: 0.0075750
	speed: 0.0665s/iter; left time: 2287.0554s
	iters: 400, epoch: 27 | loss: 0.2736293
	speed: 0.0629s/iter; left time: 2157.6062s
Epoch: 27 cost time: 30.364136219024658
Epoch: 27, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.382 Vali Acc: 0.938 Test Loss: 0.382 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0055402
	speed: 0.2563s/iter; left time: 8749.0802s
	iters: 200, epoch: 28 | loss: 0.0108309
	speed: 0.0584s/iter; left time: 1986.6377s
	iters: 300, epoch: 28 | loss: 0.0018448
	speed: 0.0582s/iter; left time: 1973.5972s
	iters: 400, epoch: 28 | loss: 0.0111354
	speed: 0.0592s/iter; left time: 2004.7029s
Epoch: 28 cost time: 27.661034107208252
Epoch: 28, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0072016
	speed: 0.2722s/iter; left time: 9163.5717s
	iters: 200, epoch: 29 | loss: 0.0045034
	speed: 0.0606s/iter; left time: 2034.2219s
	iters: 300, epoch: 29 | loss: 0.0029809
	speed: 0.0625s/iter; left time: 2091.5334s
	iters: 400, epoch: 29 | loss: 0.0112278
	speed: 0.0620s/iter; left time: 2069.2426s
Epoch: 29 cost time: 28.965370893478394
Epoch: 29, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0026081
	speed: 0.2656s/iter; left time: 8819.0295s
	iters: 200, epoch: 30 | loss: 0.0186610
	speed: 0.0593s/iter; left time: 1963.4610s
	iters: 300, epoch: 30 | loss: 0.0027435
	speed: 0.0612s/iter; left time: 2018.9779s
	iters: 400, epoch: 30 | loss: 0.0870836
	speed: 0.0601s/iter; left time: 1978.0393s
Epoch: 30 cost time: 28.404035568237305
Epoch: 30, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0025444
	speed: 0.2679s/iter; left time: 8767.2886s
	iters: 200, epoch: 31 | loss: 0.0516312
	speed: 0.0584s/iter; left time: 1904.5358s
	iters: 300, epoch: 31 | loss: 0.0014977
	speed: 0.0595s/iter; left time: 1936.0404s
	iters: 400, epoch: 31 | loss: 0.0011224
	speed: 0.0591s/iter; left time: 1917.6533s
Epoch: 31 cost time: 28.22196364402771
Epoch: 31, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0017786
	speed: 0.2672s/iter; left time: 8620.6864s
	iters: 200, epoch: 32 | loss: 0.0124321
	speed: 0.0611s/iter; left time: 1966.4959s
	iters: 300, epoch: 32 | loss: 0.0026222
	speed: 0.0609s/iter; left time: 1953.0911s
	iters: 400, epoch: 32 | loss: 0.0125256
	speed: 0.0612s/iter; left time: 1955.7397s
Epoch: 32 cost time: 28.956376552581787
Epoch: 32, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0052387
	speed: 0.2610s/iter; left time: 8296.5312s
	iters: 200, epoch: 33 | loss: 0.0051181
	speed: 0.0586s/iter; left time: 1857.7509s
	iters: 300, epoch: 33 | loss: 0.0022503
	speed: 0.0582s/iter; left time: 1839.2139s
	iters: 400, epoch: 33 | loss: 0.0014844
	speed: 0.0567s/iter; left time: 1786.6980s
Epoch: 33 cost time: 27.647021293640137
Epoch: 33, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 590170
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2694774
	speed: 0.0755s/iter; left time: 3535.1674s
	iters: 200, epoch: 1 | loss: 0.8191782
	speed: 0.0585s/iter; left time: 2733.6575s
	iters: 300, epoch: 1 | loss: 0.1769527
	speed: 0.0616s/iter; left time: 2870.0242s
	iters: 400, epoch: 1 | loss: 0.4421618
	speed: 0.0637s/iter; left time: 2963.6359s
Epoch: 1 cost time: 30.14076256752014
Epoch: 1, Steps: 469 | Train Loss: 0.826 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
Validation loss decreased (inf --> -0.925669).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1343193
	speed: 0.2389s/iter; left time: 11070.5196s
	iters: 200, epoch: 2 | loss: 0.2113841
	speed: 0.0556s/iter; left time: 2572.4375s
	iters: 300, epoch: 2 | loss: 0.1202964
	speed: 0.0597s/iter; left time: 2752.1728s
	iters: 400, epoch: 2 | loss: 0.4360933
	speed: 0.0627s/iter; left time: 2888.3353s
Epoch: 2 cost time: 27.730345726013184
Epoch: 2, Steps: 469 | Train Loss: 0.209 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.925669 --> -0.931387).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1976280
	speed: 0.2752s/iter; left time: 12620.1947s
	iters: 200, epoch: 3 | loss: 0.0780629
	speed: 0.0603s/iter; left time: 2759.7627s
	iters: 300, epoch: 3 | loss: 0.2460902
	speed: 0.0592s/iter; left time: 2703.0402s
	iters: 400, epoch: 3 | loss: 0.0902204
	speed: 0.0607s/iter; left time: 2764.4397s
Epoch: 3 cost time: 28.749773740768433
Epoch: 3, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.931387 --> -0.932817).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0097585
	speed: 0.2894s/iter; left time: 13138.6555s
	iters: 200, epoch: 4 | loss: 0.0140368
	speed: 0.0622s/iter; left time: 2817.2976s
	iters: 300, epoch: 4 | loss: 0.4691324
	speed: 0.0622s/iter; left time: 2812.1136s
	iters: 400, epoch: 4 | loss: 0.2309741
	speed: 0.0619s/iter; left time: 2789.7625s
Epoch: 4 cost time: 29.643530130386353
Epoch: 4, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1189336
	speed: 0.2781s/iter; left time: 12491.6626s
	iters: 200, epoch: 5 | loss: 0.2077963
	speed: 0.0638s/iter; left time: 2860.9311s
	iters: 300, epoch: 5 | loss: 0.0330921
	speed: 0.0612s/iter; left time: 2739.2685s
	iters: 400, epoch: 5 | loss: 0.3123247
	speed: 0.0606s/iter; left time: 2702.7336s
Epoch: 5 cost time: 29.272810697555542
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.323 Vali Acc: 0.927 Test Loss: 0.323 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0327481
	speed: 0.2599s/iter; left time: 11554.3860s
	iters: 200, epoch: 6 | loss: 0.0070592
	speed: 0.0624s/iter; left time: 2766.8356s
	iters: 300, epoch: 6 | loss: 0.1326918
	speed: 0.0635s/iter; left time: 2812.3842s
	iters: 400, epoch: 6 | loss: 0.3523699
	speed: 0.0579s/iter; left time: 2556.8155s
Epoch: 6 cost time: 28.58218550682068
Epoch: 6, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.396 Vali Acc: 0.895 Test Loss: 0.396 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0105191
	speed: 0.2679s/iter; left time: 11784.3621s
	iters: 200, epoch: 7 | loss: 0.0224994
	speed: 0.0581s/iter; left time: 2548.8665s
	iters: 300, epoch: 7 | loss: 0.0120401
	speed: 0.0590s/iter; left time: 2584.0854s
	iters: 400, epoch: 7 | loss: 0.1243951
	speed: 0.0592s/iter; left time: 2586.2765s
Epoch: 7 cost time: 28.1362566947937
Epoch: 7, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.932817 --> -0.965407).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0036695
	speed: 0.2762s/iter; left time: 12017.6316s
	iters: 200, epoch: 8 | loss: 0.0077435
	speed: 0.0644s/iter; left time: 2794.6806s
	iters: 300, epoch: 8 | loss: 0.0111823
	speed: 0.0594s/iter; left time: 2572.6732s
	iters: 400, epoch: 8 | loss: 0.0387282
	speed: 0.0598s/iter; left time: 2584.9526s
Epoch: 8 cost time: 29.102664470672607
Epoch: 8, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0504192
	speed: 0.2635s/iter; left time: 11341.9373s
	iters: 200, epoch: 9 | loss: 0.2452761
	speed: 0.0562s/iter; left time: 2412.2384s
	iters: 300, epoch: 9 | loss: 0.0140117
	speed: 0.0580s/iter; left time: 2487.2134s
	iters: 400, epoch: 9 | loss: 0.1846752
	speed: 0.0598s/iter; left time: 2558.4891s
Epoch: 9 cost time: 27.606216430664062
Epoch: 9, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0296448
	speed: 0.2698s/iter; left time: 11490.0854s
	iters: 200, epoch: 10 | loss: 0.0025043
	speed: 0.0634s/iter; left time: 2691.1442s
	iters: 300, epoch: 10 | loss: 0.1498758
	speed: 0.0646s/iter; left time: 2738.6868s
	iters: 400, epoch: 10 | loss: 0.0591333
	speed: 0.0645s/iter; left time: 2725.1567s
Epoch: 10 cost time: 30.246451377868652
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.212 Vali Acc: 0.962 Test Loss: 0.212 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0273320
	speed: 0.2848s/iter; left time: 11994.1414s
	iters: 200, epoch: 11 | loss: 0.3775426
	speed: 0.0686s/iter; left time: 2880.2192s
	iters: 300, epoch: 11 | loss: 0.1297728
	speed: 0.0657s/iter; left time: 2754.4758s
	iters: 400, epoch: 11 | loss: 0.0162708
	speed: 0.0612s/iter; left time: 2560.3984s
Epoch: 11 cost time: 31.28961944580078
Epoch: 11, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2695882
	speed: 0.2671s/iter; left time: 11120.8159s
	iters: 200, epoch: 12 | loss: 0.0037364
	speed: 0.0569s/iter; left time: 2364.2384s
	iters: 300, epoch: 12 | loss: 0.0021517
	speed: 0.0585s/iter; left time: 2422.7291s
	iters: 400, epoch: 12 | loss: 0.3058326
	speed: 0.0595s/iter; left time: 2459.8102s
Epoch: 12 cost time: 28.16722059249878
Epoch: 12, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0059542
	speed: 0.2855s/iter; left time: 11752.9760s
	iters: 200, epoch: 13 | loss: 0.0051768
	speed: 0.0691s/iter; left time: 2836.6366s
	iters: 300, epoch: 13 | loss: 0.0024730
	speed: 0.0742s/iter; left time: 3041.6060s
	iters: 400, epoch: 13 | loss: 0.0033068
	speed: 0.0648s/iter; left time: 2649.9814s
Epoch: 13 cost time: 32.615644693374634
Epoch: 13, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0249156
	speed: 0.2917s/iter; left time: 11872.0621s
	iters: 200, epoch: 14 | loss: 0.0046194
	speed: 0.0652s/iter; left time: 2648.6599s
	iters: 300, epoch: 14 | loss: 0.0225462
	speed: 0.0674s/iter; left time: 2728.8140s
	iters: 400, epoch: 14 | loss: 0.3155656
	speed: 0.0607s/iter; left time: 2451.8906s
Epoch: 14 cost time: 30.10622239112854
Epoch: 14, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0041041
	speed: 0.2754s/iter; left time: 11082.3289s
	iters: 200, epoch: 15 | loss: 0.0035880
	speed: 0.0605s/iter; left time: 2430.0177s
	iters: 300, epoch: 15 | loss: 0.0020706
	speed: 0.0602s/iter; left time: 2412.0313s
	iters: 400, epoch: 15 | loss: 0.0038688
	speed: 0.0631s/iter; left time: 2518.2618s
Epoch: 15 cost time: 29.419881343841553
Epoch: 15, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2913775
	speed: 0.2729s/iter; left time: 10851.6181s
	iters: 200, epoch: 16 | loss: 0.0234001
	speed: 0.0603s/iter; left time: 2393.6048s
	iters: 300, epoch: 16 | loss: 0.0385297
	speed: 0.0596s/iter; left time: 2359.4746s
	iters: 400, epoch: 16 | loss: 0.0061609
	speed: 0.0579s/iter; left time: 2287.0436s
Epoch: 16 cost time: 28.197770595550537
Epoch: 16, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.965407 --> -0.967694).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0018725
	speed: 0.2663s/iter; left time: 10464.6337s
	iters: 200, epoch: 17 | loss: 0.3171273
	speed: 0.0592s/iter; left time: 2319.8514s
	iters: 300, epoch: 17 | loss: 0.0088230
	speed: 0.0580s/iter; left time: 2268.0909s
	iters: 400, epoch: 17 | loss: 0.0175344
	speed: 0.0571s/iter; left time: 2226.8217s
Epoch: 17 cost time: 27.695560932159424
Epoch: 17, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1934486
	speed: 0.2561s/iter; left time: 9943.2982s
	iters: 200, epoch: 18 | loss: 0.4213752
	speed: 0.0588s/iter; left time: 2279.0665s
	iters: 300, epoch: 18 | loss: 0.1658470
	speed: 0.0599s/iter; left time: 2315.3604s
	iters: 400, epoch: 18 | loss: 0.0089924
	speed: 0.0618s/iter; left time: 2379.6686s
Epoch: 18 cost time: 28.481188774108887
Epoch: 18, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
Validation loss decreased (-0.967694 --> -0.968838).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4070484
	speed: 0.2473s/iter; left time: 9487.6817s
	iters: 200, epoch: 19 | loss: 0.0050575
	speed: 0.0602s/iter; left time: 2301.4730s
	iters: 300, epoch: 19 | loss: 0.0012703
	speed: 0.0638s/iter; left time: 2435.6084s
	iters: 400, epoch: 19 | loss: 0.0267283
	speed: 0.0577s/iter; left time: 2197.6575s
Epoch: 19 cost time: 28.256911993026733
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0137961
	speed: 0.2396s/iter; left time: 9077.7351s
	iters: 200, epoch: 20 | loss: 0.0591031
	speed: 0.0602s/iter; left time: 2274.3193s
	iters: 300, epoch: 20 | loss: 0.0060465
	speed: 0.0646s/iter; left time: 2433.0858s
	iters: 400, epoch: 20 | loss: 0.5703392
	speed: 0.0602s/iter; left time: 2263.5172s
Epoch: 20 cost time: 28.548574447631836
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0626506
	speed: 0.2555s/iter; left time: 9559.3513s
	iters: 200, epoch: 21 | loss: 0.0029889
	speed: 0.0586s/iter; left time: 2185.1864s
	iters: 300, epoch: 21 | loss: 0.0036674
	speed: 0.0586s/iter; left time: 2180.1545s
	iters: 400, epoch: 21 | loss: 0.0044130
	speed: 0.0582s/iter; left time: 2160.2585s
Epoch: 21 cost time: 27.718058109283447
Epoch: 21, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1804351
	speed: 0.2653s/iter; left time: 9801.8098s
	iters: 200, epoch: 22 | loss: 0.1542295
	speed: 0.0585s/iter; left time: 2157.4138s
	iters: 300, epoch: 22 | loss: 0.0078993
	speed: 0.0593s/iter; left time: 2179.0401s
	iters: 400, epoch: 22 | loss: 0.0896017
	speed: 0.0589s/iter; left time: 2159.5091s
Epoch: 22 cost time: 28.178667068481445
Epoch: 22, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0497848
	speed: 0.2613s/iter; left time: 9533.3777s
	iters: 200, epoch: 23 | loss: 0.0058449
	speed: 0.0639s/iter; left time: 2324.3958s
	iters: 300, epoch: 23 | loss: 0.1484332
	speed: 0.0651s/iter; left time: 2361.8918s
	iters: 400, epoch: 23 | loss: 0.0006492
	speed: 0.0626s/iter; left time: 2263.9528s
Epoch: 23 cost time: 29.868915796279907
Epoch: 23, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0040215
	speed: 0.2949s/iter; left time: 10620.4097s
	iters: 200, epoch: 24 | loss: 0.0032590
	speed: 0.0671s/iter; left time: 2411.0635s
	iters: 300, epoch: 24 | loss: 0.0036691
	speed: 0.0626s/iter; left time: 2241.6552s
	iters: 400, epoch: 24 | loss: 0.0501978
	speed: 0.0636s/iter; left time: 2272.2983s
Epoch: 24 cost time: 31.118054628372192
Epoch: 24, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.970553).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0014276
	speed: 0.2830s/iter; left time: 10059.0041s
	iters: 200, epoch: 25 | loss: 0.1161897
	speed: 0.0621s/iter; left time: 2200.7163s
	iters: 300, epoch: 25 | loss: 0.0101187
	speed: 0.0632s/iter; left time: 2232.2960s
	iters: 400, epoch: 25 | loss: 0.0017141
	speed: 0.0651s/iter; left time: 2293.6797s
Epoch: 25 cost time: 29.479820013046265
Epoch: 25, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.2341451
	speed: 0.2703s/iter; left time: 9481.8862s
	iters: 200, epoch: 26 | loss: 0.1266401
	speed: 0.0574s/iter; left time: 2008.1156s
	iters: 300, epoch: 26 | loss: 0.0030169
	speed: 0.0584s/iter; left time: 2035.9013s
	iters: 400, epoch: 26 | loss: 0.0018847
	speed: 0.0578s/iter; left time: 2010.8250s
Epoch: 26 cost time: 27.619078874588013
Epoch: 26, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.184 Vali Acc: 0.965 Test Loss: 0.184 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0036697
	speed: 0.2757s/iter; left time: 9541.2947s
	iters: 200, epoch: 27 | loss: 0.0556216
	speed: 0.0634s/iter; left time: 2186.9476s
	iters: 300, epoch: 27 | loss: 0.5424188
	speed: 0.0585s/iter; left time: 2011.7215s
	iters: 400, epoch: 27 | loss: 0.0012702
	speed: 0.0596s/iter; left time: 2043.1753s
Epoch: 27 cost time: 28.92884588241577
Epoch: 27, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.970553 --> -0.975985).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0027284
	speed: 0.2685s/iter; left time: 9167.5892s
	iters: 200, epoch: 28 | loss: 0.5279911
	speed: 0.0571s/iter; left time: 1944.6826s
	iters: 300, epoch: 28 | loss: 0.0031669
	speed: 0.0582s/iter; left time: 1974.0852s
	iters: 400, epoch: 28 | loss: 0.0032266
	speed: 0.0604s/iter; left time: 2044.6519s
Epoch: 28 cost time: 28.03073787689209
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.219 Vali Acc: 0.961 Test Loss: 0.219 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0014916
	speed: 0.2647s/iter; left time: 8912.0120s
	iters: 200, epoch: 29 | loss: 0.0032508
	speed: 0.0588s/iter; left time: 1975.4619s
	iters: 300, epoch: 29 | loss: 0.0012999
	speed: 0.0573s/iter; left time: 1918.8219s
	iters: 400, epoch: 29 | loss: 0.0064653
	speed: 0.0577s/iter; left time: 1926.5071s
Epoch: 29 cost time: 28.29947257041931
Epoch: 29, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0975050
	speed: 0.2692s/iter; left time: 8938.1670s
	iters: 200, epoch: 30 | loss: 0.0012872
	speed: 0.0628s/iter; left time: 2077.8609s
	iters: 300, epoch: 30 | loss: 0.0084157
	speed: 0.0606s/iter; left time: 1998.9150s
	iters: 400, epoch: 30 | loss: 0.0052827
	speed: 0.0587s/iter; left time: 1930.3540s
Epoch: 30 cost time: 28.96050477027893
Epoch: 30, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0052245
	speed: 0.2669s/iter; left time: 8734.5131s
	iters: 200, epoch: 31 | loss: 0.0017315
	speed: 0.0583s/iter; left time: 1903.7880s
	iters: 300, epoch: 31 | loss: 0.4810001
	speed: 0.0607s/iter; left time: 1975.6732s
	iters: 400, epoch: 31 | loss: 0.1523405
	speed: 0.0636s/iter; left time: 2062.1006s
Epoch: 31 cost time: 28.654290437698364
Epoch: 31, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0183571
	speed: 0.2602s/iter; left time: 8393.1522s
	iters: 200, epoch: 32 | loss: 0.0012211
	speed: 0.0569s/iter; left time: 1829.8283s
	iters: 300, epoch: 32 | loss: 0.1569726
	speed: 0.0570s/iter; left time: 1827.6978s
	iters: 400, epoch: 32 | loss: 0.0019488
	speed: 0.0563s/iter; left time: 1798.2867s
Epoch: 32 cost time: 27.24267816543579
Epoch: 32, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0024695
	speed: 0.2626s/iter; left time: 8348.5477s
	iters: 200, epoch: 33 | loss: 0.0005247
	speed: 0.0617s/iter; left time: 1955.2263s
	iters: 300, epoch: 33 | loss: 0.0013097
	speed: 0.0591s/iter; left time: 1868.3990s
	iters: 400, epoch: 33 | loss: 0.0125871
	speed: 0.0587s/iter; left time: 1849.3697s
Epoch: 33 cost time: 28.216309547424316
Epoch: 33, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0751210
	speed: 0.2657s/iter; left time: 8321.8379s
	iters: 200, epoch: 34 | loss: 0.0057954
	speed: 0.0582s/iter; left time: 1816.9416s
	iters: 300, epoch: 34 | loss: 0.0124401
	speed: 0.0620s/iter; left time: 1929.3721s
	iters: 400, epoch: 34 | loss: 0.1042710
	speed: 0.0605s/iter; left time: 1876.0336s
Epoch: 34 cost time: 28.687395095825195
Epoch: 34, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0024702
	speed: 0.2894s/iter; left time: 8927.9292s
	iters: 200, epoch: 35 | loss: 0.3030945
	speed: 0.0643s/iter; left time: 1976.6988s
	iters: 300, epoch: 35 | loss: 0.0008487
	speed: 0.0643s/iter; left time: 1972.2043s
	iters: 400, epoch: 35 | loss: 0.0020412
	speed: 0.0610s/iter; left time: 1862.4418s
Epoch: 35 cost time: 29.956570148468018
Epoch: 35, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0020864
	speed: 0.2802s/iter; left time: 8515.0449s
	iters: 200, epoch: 36 | loss: 0.0629508
	speed: 0.0604s/iter; left time: 1828.1069s
	iters: 300, epoch: 36 | loss: 0.0058515
	speed: 0.0603s/iter; left time: 1821.3599s
	iters: 400, epoch: 36 | loss: 0.0069632
	speed: 0.0599s/iter; left time: 1802.4459s
Epoch: 36 cost time: 28.993245124816895
Epoch: 36, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977129).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0028977
	speed: 0.2759s/iter; left time: 8254.1776s
	iters: 200, epoch: 37 | loss: 0.0049390
	speed: 0.0573s/iter; left time: 1708.7512s
	iters: 300, epoch: 37 | loss: 0.0519136
	speed: 0.0599s/iter; left time: 1779.7228s
	iters: 400, epoch: 37 | loss: 0.0093284
	speed: 0.0586s/iter; left time: 1737.0361s
Epoch: 37 cost time: 27.455305337905884
Epoch: 37, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0021243
	speed: 0.2667s/iter; left time: 7854.8030s
	iters: 200, epoch: 38 | loss: 0.0013657
	speed: 0.0625s/iter; left time: 1833.3440s
	iters: 300, epoch: 38 | loss: 0.0153225
	speed: 0.0643s/iter; left time: 1880.6771s
	iters: 400, epoch: 38 | loss: 0.0024807
	speed: 0.0618s/iter; left time: 1802.1054s
Epoch: 38 cost time: 29.28550910949707
Epoch: 38, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0028702
	speed: 0.2494s/iter; left time: 7227.9438s
	iters: 200, epoch: 39 | loss: 0.0087541
	speed: 0.0545s/iter; left time: 1573.6364s
	iters: 300, epoch: 39 | loss: 0.0019142
	speed: 0.0566s/iter; left time: 1628.5243s
	iters: 400, epoch: 39 | loss: 0.0017293
	speed: 0.0585s/iter; left time: 1677.0938s
Epoch: 39 cost time: 26.828797578811646
Epoch: 39, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0028292
	speed: 0.2642s/iter; left time: 7531.5144s
	iters: 200, epoch: 40 | loss: 0.1132920
	speed: 0.0625s/iter; left time: 1775.4647s
	iters: 300, epoch: 40 | loss: 0.0043580
	speed: 0.0601s/iter; left time: 1701.5142s
	iters: 400, epoch: 40 | loss: 0.0012931
	speed: 0.0624s/iter; left time: 1760.0073s
Epoch: 40 cost time: 29.200201988220215
Epoch: 40, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0201941
	speed: 0.2639s/iter; left time: 7401.0118s
	iters: 200, epoch: 41 | loss: 0.0021398
	speed: 0.0571s/iter; left time: 1596.5806s
	iters: 300, epoch: 41 | loss: 0.0024135
	speed: 0.0609s/iter; left time: 1696.8577s
	iters: 400, epoch: 41 | loss: 0.4109286
	speed: 0.0591s/iter; left time: 1638.9032s
Epoch: 41 cost time: 27.89750385284424
Epoch: 41, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0010153
	speed: 0.2651s/iter; left time: 7310.4122s
	iters: 200, epoch: 42 | loss: 0.0025001
	speed: 0.0586s/iter; left time: 1610.3074s
	iters: 300, epoch: 42 | loss: 0.0016362
	speed: 0.0550s/iter; left time: 1506.4535s
	iters: 400, epoch: 42 | loss: 0.0032780
	speed: 0.0571s/iter; left time: 1558.1281s
Epoch: 42 cost time: 27.356728076934814
Epoch: 42, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0026638
	speed: 0.2546s/iter; left time: 6900.6062s
	iters: 200, epoch: 43 | loss: 0.0026734
	speed: 0.0611s/iter; left time: 1648.6427s
	iters: 300, epoch: 43 | loss: 0.0162272
	speed: 0.0589s/iter; left time: 1583.4343s
	iters: 400, epoch: 43 | loss: 0.0015861
	speed: 0.0564s/iter; left time: 1511.6874s
Epoch: 43 cost time: 28.053674459457397
Epoch: 43, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.961 Test Loss: 0.224 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0012078
	speed: 0.2599s/iter; left time: 6922.2043s
	iters: 200, epoch: 44 | loss: 0.1069777
	speed: 0.0581s/iter; left time: 1541.1895s
	iters: 300, epoch: 44 | loss: 0.0018385
	speed: 0.0598s/iter; left time: 1580.2658s
	iters: 400, epoch: 44 | loss: 0.0014827
	speed: 0.0644s/iter; left time: 1696.5532s
Epoch: 44 cost time: 28.713309288024902
Epoch: 44, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0075437
	speed: 0.2830s/iter; left time: 7404.0465s
	iters: 200, epoch: 45 | loss: 0.2109699
	speed: 0.0661s/iter; left time: 1722.3409s
	iters: 300, epoch: 45 | loss: 0.0006293
	speed: 0.0648s/iter; left time: 1681.9984s
	iters: 400, epoch: 45 | loss: 0.0022408
	speed: 0.0667s/iter; left time: 1724.5118s
Epoch: 45 cost time: 31.19458818435669
Epoch: 45, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0052614
	speed: 0.2843s/iter; left time: 7305.4754s
	iters: 200, epoch: 46 | loss: 0.0047681
	speed: 0.0636s/iter; left time: 1629.0773s
	iters: 300, epoch: 46 | loss: 0.0068377
	speed: 0.0656s/iter; left time: 1672.0596s
	iters: 400, epoch: 46 | loss: 0.0010290
	speed: 0.0653s/iter; left time: 1657.4675s
Epoch: 46 cost time: 30.264957189559937
Epoch: 46, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 590074
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8576607
	speed: 0.0764s/iter; left time: 3574.1655s
	iters: 200, epoch: 1 | loss: 0.6195812
	speed: 0.0630s/iter; left time: 2940.2449s
	iters: 300, epoch: 1 | loss: 0.2958153
	speed: 0.0613s/iter; left time: 2858.4344s
	iters: 400, epoch: 1 | loss: 0.2801679
	speed: 0.0617s/iter; left time: 2869.6409s
Epoch: 1 cost time: 30.584686994552612
Epoch: 1, Steps: 469 | Train Loss: 0.774 Vali Loss: 0.328 Vali Acc: 0.892 Test Loss: 0.328 Test Acc: 0.892
Validation loss decreased (inf --> -0.891935).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1938916
	speed: 0.2689s/iter; left time: 12457.4225s
	iters: 200, epoch: 2 | loss: 0.0724828
	speed: 0.0583s/iter; left time: 2693.4079s
	iters: 300, epoch: 2 | loss: 0.1049948
	speed: 0.0596s/iter; left time: 2748.2243s
	iters: 400, epoch: 2 | loss: 0.1518998
	speed: 0.0589s/iter; left time: 2710.8392s
Epoch: 2 cost time: 27.890188217163086
Epoch: 2, Steps: 469 | Train Loss: 0.212 Vali Loss: 0.230 Vali Acc: 0.940 Test Loss: 0.230 Test Acc: 0.940
Validation loss decreased (-0.891935 --> -0.939963).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0995728
	speed: 0.2624s/iter; left time: 12034.8473s
	iters: 200, epoch: 3 | loss: 0.3135092
	speed: 0.0615s/iter; left time: 2812.9771s
	iters: 300, epoch: 3 | loss: 0.3095958
	speed: 0.0608s/iter; left time: 2776.3721s
	iters: 400, epoch: 3 | loss: 0.1054571
	speed: 0.0627s/iter; left time: 2857.2815s
Epoch: 3 cost time: 29.61211657524109
Epoch: 3, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.217 Vali Acc: 0.929 Test Loss: 0.217 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1504908
	speed: 0.2720s/iter; left time: 12349.2881s
	iters: 200, epoch: 4 | loss: 0.3172922
	speed: 0.0642s/iter; left time: 2906.0362s
	iters: 300, epoch: 4 | loss: 0.1080237
	speed: 0.0602s/iter; left time: 2720.8938s
	iters: 400, epoch: 4 | loss: 0.2153705
	speed: 0.0580s/iter; left time: 2615.2300s
Epoch: 4 cost time: 28.991307020187378
Epoch: 4, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.215 Vali Acc: 0.945 Test Loss: 0.215 Test Acc: 0.945
Validation loss decreased (-0.939963 --> -0.945395).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0649624
	speed: 0.2704s/iter; left time: 12149.9217s
	iters: 200, epoch: 5 | loss: 0.0198580
	speed: 0.0618s/iter; left time: 2768.7478s
	iters: 300, epoch: 5 | loss: 0.0142506
	speed: 0.0636s/iter; left time: 2843.4014s
	iters: 400, epoch: 5 | loss: 0.3786069
	speed: 0.0676s/iter; left time: 3015.1109s
Epoch: 5 cost time: 30.188454627990723
Epoch: 5, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.945395 --> -0.954830).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0373350
	speed: 0.2600s/iter; left time: 11558.1483s
	iters: 200, epoch: 6 | loss: 0.0456164
	speed: 0.0604s/iter; left time: 2678.8179s
	iters: 300, epoch: 6 | loss: 0.0420770
	speed: 0.0605s/iter; left time: 2679.1388s
	iters: 400, epoch: 6 | loss: 0.2053754
	speed: 0.0601s/iter; left time: 2651.9547s
Epoch: 6 cost time: 28.672553777694702
Epoch: 6, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
Validation loss decreased (-0.954830 --> -0.955115).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0641322
	speed: 0.2691s/iter; left time: 11838.2598s
	iters: 200, epoch: 7 | loss: 0.8218164
	speed: 0.0614s/iter; left time: 2696.6876s
	iters: 300, epoch: 7 | loss: 0.1434211
	speed: 0.0643s/iter; left time: 2817.2946s
	iters: 400, epoch: 7 | loss: 0.0120351
	speed: 0.0612s/iter; left time: 2672.8588s
Epoch: 7 cost time: 29.39717674255371
Epoch: 7, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.955115 --> -0.961691).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0477158
	speed: 0.2674s/iter; left time: 11636.5366s
	iters: 200, epoch: 8 | loss: 0.2562058
	speed: 0.0631s/iter; left time: 2739.2091s
	iters: 300, epoch: 8 | loss: 0.0090833
	speed: 0.0633s/iter; left time: 2740.2208s
	iters: 400, epoch: 8 | loss: 0.0261174
	speed: 0.0622s/iter; left time: 2687.2987s
Epoch: 8 cost time: 29.471174001693726
Epoch: 8, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0313415
	speed: 0.2615s/iter; left time: 11258.4569s
	iters: 200, epoch: 9 | loss: 0.0129427
	speed: 0.0625s/iter; left time: 2683.7195s
	iters: 300, epoch: 9 | loss: 0.1740060
	speed: 0.0623s/iter; left time: 2671.6134s
	iters: 400, epoch: 9 | loss: 0.0802836
	speed: 0.0606s/iter; left time: 2588.9468s
Epoch: 9 cost time: 28.82800316810608
Epoch: 9, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0632985
	speed: 0.2883s/iter; left time: 12274.7267s
	iters: 200, epoch: 10 | loss: 0.2917785
	speed: 0.0630s/iter; left time: 2675.3056s
	iters: 300, epoch: 10 | loss: 0.0531502
	speed: 0.0641s/iter; left time: 2718.2511s
	iters: 400, epoch: 10 | loss: 0.0129617
	speed: 0.0639s/iter; left time: 2700.1670s
Epoch: 10 cost time: 30.44855833053589
Epoch: 10, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.961691 --> -0.963406).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0289172
	speed: 0.2717s/iter; left time: 11442.1192s
	iters: 200, epoch: 11 | loss: 0.0853881
	speed: 0.0569s/iter; left time: 2390.6606s
	iters: 300, epoch: 11 | loss: 0.0903313
	speed: 0.0608s/iter; left time: 2549.6639s
	iters: 400, epoch: 11 | loss: 0.0075991
	speed: 0.0630s/iter; left time: 2635.6807s
Epoch: 11 cost time: 28.923247814178467
Epoch: 11, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.963406 --> -0.968266).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0055702
	speed: 0.2826s/iter; left time: 11769.4464s
	iters: 200, epoch: 12 | loss: 0.0720528
	speed: 0.0565s/iter; left time: 2348.6589s
	iters: 300, epoch: 12 | loss: 0.1619451
	speed: 0.0588s/iter; left time: 2438.7881s
	iters: 400, epoch: 12 | loss: 0.1695410
	speed: 0.0593s/iter; left time: 2451.2340s
Epoch: 12 cost time: 28.21343731880188
Epoch: 12, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0073805
	speed: 0.2610s/iter; left time: 10747.1966s
	iters: 200, epoch: 13 | loss: 0.0169976
	speed: 0.0615s/iter; left time: 2527.4239s
	iters: 300, epoch: 13 | loss: 0.0038964
	speed: 0.0605s/iter; left time: 2478.3264s
	iters: 400, epoch: 13 | loss: 0.0764340
	speed: 0.0652s/iter; left time: 2665.2955s
Epoch: 13 cost time: 29.04041814804077
Epoch: 13, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
Validation loss decreased (-0.968266 --> -0.971697).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0353851
	speed: 0.2646s/iter; left time: 10770.0088s
	iters: 200, epoch: 14 | loss: 0.0107828
	speed: 0.0576s/iter; left time: 2337.8636s
	iters: 300, epoch: 14 | loss: 0.1517450
	speed: 0.0625s/iter; left time: 2530.0724s
	iters: 400, epoch: 14 | loss: 0.0723041
	speed: 0.0620s/iter; left time: 2503.8929s
Epoch: 14 cost time: 28.622808694839478
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0880730
	speed: 0.2693s/iter; left time: 10833.6237s
	iters: 200, epoch: 15 | loss: 0.0849173
	speed: 0.0610s/iter; left time: 2447.6011s
	iters: 300, epoch: 15 | loss: 0.0904414
	speed: 0.0591s/iter; left time: 2364.3958s
	iters: 400, epoch: 15 | loss: 0.0148206
	speed: 0.0584s/iter; left time: 2332.8724s
Epoch: 15 cost time: 28.164144039154053
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0030799
	speed: 0.2595s/iter; left time: 10318.8248s
	iters: 200, epoch: 16 | loss: 0.0022564
	speed: 0.0586s/iter; left time: 2323.6097s
	iters: 300, epoch: 16 | loss: 0.0250586
	speed: 0.0584s/iter; left time: 2310.3678s
	iters: 400, epoch: 16 | loss: 0.1186805
	speed: 0.0579s/iter; left time: 2286.0041s
Epoch: 16 cost time: 27.59920382499695
Epoch: 16, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0032198
	speed: 0.2767s/iter; left time: 10873.7388s
	iters: 200, epoch: 17 | loss: 0.0016991
	speed: 0.0607s/iter; left time: 2379.8240s
	iters: 300, epoch: 17 | loss: 0.0023086
	speed: 0.0593s/iter; left time: 2318.8880s
	iters: 400, epoch: 17 | loss: 0.2863190
	speed: 0.0626s/iter; left time: 2441.2242s
Epoch: 17 cost time: 29.593514442443848
Epoch: 17, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0057386
	speed: 0.2738s/iter; left time: 10631.4820s
	iters: 200, epoch: 18 | loss: 0.0012041
	speed: 0.0620s/iter; left time: 2401.7602s
	iters: 300, epoch: 18 | loss: 0.0516994
	speed: 0.0587s/iter; left time: 2267.8193s
	iters: 400, epoch: 18 | loss: 0.0007232
	speed: 0.0571s/iter; left time: 2198.1704s
Epoch: 18 cost time: 28.59089469909668
Epoch: 18, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.221 Vali Acc: 0.962 Test Loss: 0.221 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1136449
	speed: 0.2592s/iter; left time: 9942.9126s
	iters: 200, epoch: 19 | loss: 0.0086254
	speed: 0.0617s/iter; left time: 2362.3493s
	iters: 300, epoch: 19 | loss: 0.0092098
	speed: 0.0622s/iter; left time: 2373.6135s
	iters: 400, epoch: 19 | loss: 0.0028844
	speed: 0.0619s/iter; left time: 2354.8572s
Epoch: 19 cost time: 29.339921474456787
Epoch: 19, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0365317
	speed: 0.2887s/iter; left time: 10938.4421s
	iters: 200, epoch: 20 | loss: 0.0075221
	speed: 0.0653s/iter; left time: 2466.8514s
	iters: 300, epoch: 20 | loss: 0.0047243
	speed: 0.0641s/iter; left time: 2415.9542s
	iters: 400, epoch: 20 | loss: 0.0035014
	speed: 0.0657s/iter; left time: 2469.8407s
Epoch: 20 cost time: 30.76072597503662
Epoch: 20, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0033339
	speed: 0.2844s/iter; left time: 10641.7323s
	iters: 200, epoch: 21 | loss: 0.0563023
	speed: 0.0662s/iter; left time: 2470.9855s
	iters: 300, epoch: 21 | loss: 0.0029339
	speed: 0.0622s/iter; left time: 2316.6593s
	iters: 400, epoch: 21 | loss: 0.0115517
	speed: 0.0630s/iter; left time: 2336.8680s
Epoch: 21 cost time: 29.9395432472229
Epoch: 21, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0017188
	speed: 0.2816s/iter; left time: 10406.0609s
	iters: 200, epoch: 22 | loss: 0.0046733
	speed: 0.0635s/iter; left time: 2340.6802s
	iters: 300, epoch: 22 | loss: 0.0083842
	speed: 0.0664s/iter; left time: 2439.3458s
	iters: 400, epoch: 22 | loss: 0.1097210
	speed: 0.0614s/iter; left time: 2251.7134s
Epoch: 22 cost time: 29.882568836212158
Epoch: 22, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.262 Vali Acc: 0.954 Test Loss: 0.262 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0250095
	speed: 0.2680s/iter; left time: 9778.4387s
	iters: 200, epoch: 23 | loss: 0.0072718
	speed: 0.0609s/iter; left time: 2215.4711s
	iters: 300, epoch: 23 | loss: 0.0773467
	speed: 0.0595s/iter; left time: 2159.4670s
	iters: 400, epoch: 23 | loss: 0.0030361
	speed: 0.0589s/iter; left time: 2130.2625s
Epoch: 23 cost time: 28.873193979263306
Epoch: 23, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9716981132075472
model parameter : 589978
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4510080
	speed: 0.0725s/iter; left time: 3395.0047s
	iters: 200, epoch: 1 | loss: 0.6831109
	speed: 0.0601s/iter; left time: 2808.1526s
	iters: 300, epoch: 1 | loss: 0.5631920
	speed: 0.0599s/iter; left time: 2790.6706s
	iters: 400, epoch: 1 | loss: 0.3986463
	speed: 0.0640s/iter; left time: 2973.8394s
Epoch: 1 cost time: 29.838315725326538
Epoch: 1, Steps: 469 | Train Loss: 0.908 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
Validation loss decreased (inf --> -0.847623).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0731560
	speed: 0.2580s/iter; left time: 11951.5780s
	iters: 200, epoch: 2 | loss: 0.3881623
	speed: 0.0623s/iter; left time: 2882.3684s
	iters: 300, epoch: 2 | loss: 0.4460607
	speed: 0.0656s/iter; left time: 3024.7485s
	iters: 400, epoch: 2 | loss: 0.4804281
	speed: 0.0617s/iter; left time: 2840.7730s
Epoch: 2 cost time: 30.001887321472168
Epoch: 2, Steps: 469 | Train Loss: 0.201 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.847623 --> -0.947968).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2882717
	speed: 0.2692s/iter; left time: 12347.9284s
	iters: 200, epoch: 3 | loss: 0.0543669
	speed: 0.0628s/iter; left time: 2872.9574s
	iters: 300, epoch: 3 | loss: 0.0345211
	speed: 0.0596s/iter; left time: 2721.1774s
	iters: 400, epoch: 3 | loss: 0.0353036
	speed: 0.0609s/iter; left time: 2774.2595s
Epoch: 3 cost time: 29.07632541656494
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0213978
	speed: 0.2648s/iter; left time: 12018.7672s
	iters: 200, epoch: 4 | loss: 0.1954408
	speed: 0.0614s/iter; left time: 2781.2608s
	iters: 300, epoch: 4 | loss: 0.0536785
	speed: 0.0580s/iter; left time: 2622.5157s
	iters: 400, epoch: 4 | loss: 0.0754477
	speed: 0.0601s/iter; left time: 2710.9467s
Epoch: 4 cost time: 28.617589712142944
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.274 Vali Acc: 0.929 Test Loss: 0.274 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1869413
	speed: 0.2652s/iter; left time: 11914.6613s
	iters: 200, epoch: 5 | loss: 0.0743541
	speed: 0.0592s/iter; left time: 2651.8084s
	iters: 300, epoch: 5 | loss: 0.0814219
	speed: 0.0639s/iter; left time: 2857.5895s
	iters: 400, epoch: 5 | loss: 0.0276075
	speed: 0.0608s/iter; left time: 2711.3571s
Epoch: 5 cost time: 28.842313528060913
Epoch: 5, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
Validation loss decreased (-0.947968 --> -0.954544).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0836032
	speed: 0.2609s/iter; left time: 11598.6287s
	iters: 200, epoch: 6 | loss: 0.0065067
	speed: 0.0646s/iter; left time: 2865.5165s
	iters: 300, epoch: 6 | loss: 0.5810568
	speed: 0.0614s/iter; left time: 2716.7357s
	iters: 400, epoch: 6 | loss: 0.0316049
	speed: 0.0594s/iter; left time: 2622.3808s
Epoch: 6 cost time: 29.393555402755737
Epoch: 6, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0142914
	speed: 0.2720s/iter; left time: 11963.4623s
	iters: 200, epoch: 7 | loss: 0.0055193
	speed: 0.0592s/iter; left time: 2596.5238s
	iters: 300, epoch: 7 | loss: 0.2576557
	speed: 0.0647s/iter; left time: 2831.0659s
	iters: 400, epoch: 7 | loss: 0.0031769
	speed: 0.0641s/iter; left time: 2801.7527s
Epoch: 7 cost time: 29.695216178894043
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.954544 --> -0.963406).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0033759
	speed: 0.2733s/iter; left time: 11893.1353s
	iters: 200, epoch: 8 | loss: 0.0050903
	speed: 0.0602s/iter; left time: 2615.4818s
	iters: 300, epoch: 8 | loss: 0.0026671
	speed: 0.0609s/iter; left time: 2639.1195s
	iters: 400, epoch: 8 | loss: 0.0042805
	speed: 0.0682s/iter; left time: 2947.0006s
Epoch: 8 cost time: 29.74475598335266
Epoch: 8, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0386453
	speed: 0.2894s/iter; left time: 12457.3458s
	iters: 200, epoch: 9 | loss: 0.0023282
	speed: 0.0652s/iter; left time: 2799.8177s
	iters: 300, epoch: 9 | loss: 0.3481187
	speed: 0.0615s/iter; left time: 2637.2126s
	iters: 400, epoch: 9 | loss: 0.3046478
	speed: 0.0569s/iter; left time: 2431.2819s
Epoch: 9 cost time: 29.44970941543579
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.210 Vali Acc: 0.945 Test Loss: 0.210 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2443725
	speed: 0.2625s/iter; left time: 11176.6252s
	iters: 200, epoch: 10 | loss: 0.4822394
	speed: 0.0606s/iter; left time: 2576.0515s
	iters: 300, epoch: 10 | loss: 0.0660613
	speed: 0.0598s/iter; left time: 2535.3821s
	iters: 400, epoch: 10 | loss: 0.1157537
	speed: 0.0612s/iter; left time: 2586.2148s
Epoch: 10 cost time: 28.638964653015137
Epoch: 10, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0089595
	speed: 0.2618s/iter; left time: 11023.7709s
	iters: 200, epoch: 11 | loss: 0.3307918
	speed: 0.0609s/iter; left time: 2556.5786s
	iters: 300, epoch: 11 | loss: 0.0016832
	speed: 0.0621s/iter; left time: 2604.7669s
	iters: 400, epoch: 11 | loss: 0.0256770
	speed: 0.0638s/iter; left time: 2666.1021s
Epoch: 11 cost time: 28.845597505569458
Epoch: 11, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3974887
	speed: 0.2667s/iter; left time: 11107.7852s
	iters: 200, epoch: 12 | loss: 0.0038723
	speed: 0.0601s/iter; left time: 2498.6517s
	iters: 300, epoch: 12 | loss: 0.0047192
	speed: 0.0609s/iter; left time: 2522.0354s
	iters: 400, epoch: 12 | loss: 0.0188371
	speed: 0.0589s/iter; left time: 2435.3876s
Epoch: 12 cost time: 28.599995613098145
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0139565
	speed: 0.2574s/iter; left time: 10599.7669s
	iters: 200, epoch: 13 | loss: 0.0043489
	speed: 0.0601s/iter; left time: 2467.2339s
	iters: 300, epoch: 13 | loss: 0.0067942
	speed: 0.0621s/iter; left time: 2543.4059s
	iters: 400, epoch: 13 | loss: 0.0737245
	speed: 0.0606s/iter; left time: 2477.7453s
Epoch: 13 cost time: 28.696614503860474
Epoch: 13, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5691289
	speed: 0.2576s/iter; left time: 10485.5983s
	iters: 200, epoch: 14 | loss: 0.1238705
	speed: 0.0601s/iter; left time: 2439.0608s
	iters: 300, epoch: 14 | loss: 0.0129911
	speed: 0.0582s/iter; left time: 2355.9569s
	iters: 400, epoch: 14 | loss: 0.0783355
	speed: 0.0607s/iter; left time: 2451.6648s
Epoch: 14 cost time: 28.669625997543335
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.963406 --> -0.974270).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0043790
	speed: 0.2614s/iter; left time: 10517.7777s
	iters: 200, epoch: 15 | loss: 0.0339325
	speed: 0.0566s/iter; left time: 2270.8273s
	iters: 300, epoch: 15 | loss: 0.0097474
	speed: 0.0634s/iter; left time: 2537.3072s
	iters: 400, epoch: 15 | loss: 0.1307659
	speed: 0.0638s/iter; left time: 2548.0142s
Epoch: 15 cost time: 28.836583375930786
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0022546
	speed: 0.2706s/iter; left time: 10760.7139s
	iters: 200, epoch: 16 | loss: 0.0429744
	speed: 0.0628s/iter; left time: 2492.2522s
	iters: 300, epoch: 16 | loss: 0.0055361
	speed: 0.0576s/iter; left time: 2278.8100s
	iters: 400, epoch: 16 | loss: 0.0010390
	speed: 0.0586s/iter; left time: 2312.8017s
Epoch: 16 cost time: 28.75914692878723
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0013661
	speed: 0.2712s/iter; left time: 10655.8659s
	iters: 200, epoch: 17 | loss: 0.0056590
	speed: 0.0571s/iter; left time: 2239.7588s
	iters: 300, epoch: 17 | loss: 0.0012556
	speed: 0.0560s/iter; left time: 2190.7023s
	iters: 400, epoch: 17 | loss: 0.0007962
	speed: 0.0596s/iter; left time: 2322.2950s
Epoch: 17 cost time: 27.718820095062256
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0018778
	speed: 0.2788s/iter; left time: 10826.1054s
	iters: 200, epoch: 18 | loss: 0.0592322
	speed: 0.0671s/iter; left time: 2600.3343s
	iters: 300, epoch: 18 | loss: 0.0023165
	speed: 0.0619s/iter; left time: 2389.5324s
	iters: 400, epoch: 18 | loss: 0.3499884
	speed: 0.0613s/iter; left time: 2362.5200s
Epoch: 18 cost time: 30.561553478240967
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0451064
	speed: 0.2848s/iter; left time: 10926.4126s
	iters: 200, epoch: 19 | loss: 0.0014124
	speed: 0.0707s/iter; left time: 2703.2716s
	iters: 300, epoch: 19 | loss: 0.0016368
	speed: 0.0649s/iter; left time: 2477.0979s
	iters: 400, epoch: 19 | loss: 0.0014845
	speed: 0.0627s/iter; left time: 2386.3298s
Epoch: 19 cost time: 31.493380308151245
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0176225
	speed: 0.2845s/iter; left time: 10780.5582s
	iters: 200, epoch: 20 | loss: 0.0011747
	speed: 0.0645s/iter; left time: 2439.1122s
	iters: 300, epoch: 20 | loss: 0.0202294
	speed: 0.0617s/iter; left time: 2325.9294s
	iters: 400, epoch: 20 | loss: 0.0128656
	speed: 0.0617s/iter; left time: 2319.4085s
Epoch: 20 cost time: 29.965517282485962
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0025459
	speed: 0.2792s/iter; left time: 10448.4244s
	iters: 200, epoch: 21 | loss: 0.3645651
	speed: 0.0624s/iter; left time: 2330.2823s
	iters: 300, epoch: 21 | loss: 0.0604088
	speed: 0.0626s/iter; left time: 2330.4402s
	iters: 400, epoch: 21 | loss: 0.0271614
	speed: 0.0664s/iter; left time: 2465.5372s
Epoch: 21 cost time: 30.49829387664795
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975127).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3375501
	speed: 0.2605s/iter; left time: 9627.8284s
	iters: 200, epoch: 22 | loss: 0.0043673
	speed: 0.0582s/iter; left time: 2145.1696s
	iters: 300, epoch: 22 | loss: 0.0030533
	speed: 0.0638s/iter; left time: 2344.2291s
	iters: 400, epoch: 22 | loss: 0.0052200
	speed: 0.0599s/iter; left time: 2194.3048s
Epoch: 22 cost time: 28.600958347320557
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1657289
	speed: 0.2666s/iter; left time: 9727.9824s
	iters: 200, epoch: 23 | loss: 0.0012083
	speed: 0.0622s/iter; left time: 2264.5197s
	iters: 300, epoch: 23 | loss: 0.0091447
	speed: 0.0609s/iter; left time: 2208.2240s
	iters: 400, epoch: 23 | loss: 0.0025741
	speed: 0.0666s/iter; left time: 2407.9905s
Epoch: 23 cost time: 30.238555431365967
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0011596
	speed: 0.2675s/iter; left time: 9632.9095s
	iters: 200, epoch: 24 | loss: 0.2295392
	speed: 0.0587s/iter; left time: 2107.6600s
	iters: 300, epoch: 24 | loss: 0.0020968
	speed: 0.0554s/iter; left time: 1985.2495s
	iters: 400, epoch: 24 | loss: 0.0016875
	speed: 0.0583s/iter; left time: 2083.3155s
Epoch: 24 cost time: 27.484626531600952
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0197423
	speed: 0.2640s/iter; left time: 9384.4855s
	iters: 200, epoch: 25 | loss: 0.0028740
	speed: 0.0603s/iter; left time: 2138.6948s
	iters: 300, epoch: 25 | loss: 0.0011768
	speed: 0.0613s/iter; left time: 2165.5313s
	iters: 400, epoch: 25 | loss: 0.0008387
	speed: 0.0619s/iter; left time: 2180.0712s
Epoch: 25 cost time: 28.81435537338257
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0066596
	speed: 0.2595s/iter; left time: 9101.6528s
	iters: 200, epoch: 26 | loss: 0.0036920
	speed: 0.0573s/iter; left time: 2004.4902s
	iters: 300, epoch: 26 | loss: 0.0012520
	speed: 0.0568s/iter; left time: 1980.2377s
	iters: 400, epoch: 26 | loss: 0.0010855
	speed: 0.0588s/iter; left time: 2045.4319s
Epoch: 26 cost time: 27.697492837905884
Epoch: 26, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0020525
	speed: 0.2645s/iter; left time: 9153.4156s
	iters: 200, epoch: 27 | loss: 0.0051908
	speed: 0.0581s/iter; left time: 2005.3839s
	iters: 300, epoch: 27 | loss: 0.0007655
	speed: 0.0589s/iter; left time: 2025.0936s
	iters: 400, epoch: 27 | loss: 0.0043051
	speed: 0.0625s/iter; left time: 2143.9687s
Epoch: 27 cost time: 28.33237648010254
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0005283
	speed: 0.2676s/iter; left time: 9134.4299s
	iters: 200, epoch: 28 | loss: 0.0290183
	speed: 0.0621s/iter; left time: 2113.6637s
	iters: 300, epoch: 28 | loss: 0.0060970
	speed: 0.0587s/iter; left time: 1990.8719s
	iters: 400, epoch: 28 | loss: 0.0027393
	speed: 0.0583s/iter; left time: 1973.9229s
Epoch: 28 cost time: 28.393420934677124
Epoch: 28, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.179 Vali Acc: 0.966 Test Loss: 0.179 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0011695
	speed: 0.2582s/iter; left time: 8691.7429s
	iters: 200, epoch: 29 | loss: 0.0394755
	speed: 0.0564s/iter; left time: 1893.4330s
	iters: 300, epoch: 29 | loss: 0.5187400
	speed: 0.0574s/iter; left time: 1919.7766s
	iters: 400, epoch: 29 | loss: 0.0317991
	speed: 0.0644s/iter; left time: 2147.9750s
Epoch: 29 cost time: 28.137932300567627
Epoch: 29, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.975127 --> -0.976843).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0004917
	speed: 0.2819s/iter; left time: 9358.2275s
	iters: 200, epoch: 30 | loss: 0.0279464
	speed: 0.0636s/iter; left time: 2103.6861s
	iters: 300, epoch: 30 | loss: 0.0038154
	speed: 0.0640s/iter; left time: 2112.0270s
	iters: 400, epoch: 30 | loss: 0.4638078
	speed: 0.0640s/iter; left time: 2104.4413s
Epoch: 30 cost time: 30.270366668701172
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.178 Vali Acc: 0.966 Test Loss: 0.178 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0270772
	speed: 0.2879s/iter; left time: 9422.1855s
	iters: 200, epoch: 31 | loss: 0.0458162
	speed: 0.0602s/iter; left time: 1964.3005s
	iters: 300, epoch: 31 | loss: 0.0013242
	speed: 0.0581s/iter; left time: 1890.2709s
	iters: 400, epoch: 31 | loss: 0.0010427
	speed: 0.0646s/iter; left time: 2094.5107s
Epoch: 31 cost time: 29.68478226661682
Epoch: 31, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0007324
	speed: 0.2905s/iter; left time: 9372.3773s
	iters: 200, epoch: 32 | loss: 0.0149606
	speed: 0.0615s/iter; left time: 1977.5298s
	iters: 300, epoch: 32 | loss: 0.0175457
	speed: 0.0636s/iter; left time: 2037.5455s
	iters: 400, epoch: 32 | loss: 0.0013161
	speed: 0.0601s/iter; left time: 1922.4338s
Epoch: 32 cost time: 28.92142653465271
Epoch: 32, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0460475
	speed: 0.2641s/iter; left time: 8396.2207s
	iters: 200, epoch: 33 | loss: 0.0015323
	speed: 0.0624s/iter; left time: 1978.2738s
	iters: 300, epoch: 33 | loss: 0.0013728
	speed: 0.0593s/iter; left time: 1874.8422s
	iters: 400, epoch: 33 | loss: 0.0021575
	speed: 0.0579s/iter; left time: 1822.1152s
Epoch: 33 cost time: 28.59816861152649
Epoch: 33, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0012625
	speed: 0.2642s/iter; left time: 8277.1879s
	iters: 200, epoch: 34 | loss: 0.0005506
	speed: 0.0593s/iter; left time: 1850.3313s
	iters: 300, epoch: 34 | loss: 0.0016450
	speed: 0.0642s/iter; left time: 1997.5057s
	iters: 400, epoch: 34 | loss: 0.0032119
	speed: 0.0620s/iter; left time: 1922.5817s
Epoch: 34 cost time: 29.186193466186523
Epoch: 34, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0614740
	speed: 0.2634s/iter; left time: 8125.9478s
	iters: 200, epoch: 35 | loss: 0.0044350
	speed: 0.0595s/iter; left time: 1830.3596s
	iters: 300, epoch: 35 | loss: 0.0019417
	speed: 0.0605s/iter; left time: 1853.1515s
	iters: 400, epoch: 35 | loss: 0.0017729
	speed: 0.0613s/iter; left time: 1874.4294s
Epoch: 35 cost time: 28.902388095855713
Epoch: 35, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.1149882
	speed: 0.2565s/iter; left time: 7792.7322s
	iters: 200, epoch: 36 | loss: 0.0010302
	speed: 0.0546s/iter; left time: 1654.8440s
	iters: 300, epoch: 36 | loss: 0.0005598
	speed: 0.0567s/iter; left time: 1710.3516s
	iters: 400, epoch: 36 | loss: 0.0019209
	speed: 0.0573s/iter; left time: 1722.5770s
Epoch: 36 cost time: 26.958386659622192
Epoch: 36, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0022021
	speed: 0.2660s/iter; left time: 7958.8308s
	iters: 200, epoch: 37 | loss: 0.0004217
	speed: 0.0608s/iter; left time: 1811.7241s
	iters: 300, epoch: 37 | loss: 0.0101200
	speed: 0.0576s/iter; left time: 1712.9717s
	iters: 400, epoch: 37 | loss: 0.1227001
	speed: 0.0571s/iter; left time: 1691.9661s
Epoch: 37 cost time: 28.707523107528687
Epoch: 37, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0112149
	speed: 0.2731s/iter; left time: 8043.4549s
	iters: 200, epoch: 38 | loss: 0.0007946
	speed: 0.0560s/iter; left time: 1643.7720s
	iters: 300, epoch: 38 | loss: 0.0094450
	speed: 0.0574s/iter; left time: 1678.6657s
	iters: 400, epoch: 38 | loss: 0.0027511
	speed: 0.0567s/iter; left time: 1654.0274s
Epoch: 38 cost time: 27.12951683998108
Epoch: 38, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0072170
	speed: 0.2551s/iter; left time: 7391.5753s
	iters: 200, epoch: 39 | loss: 0.0024849
	speed: 0.0578s/iter; left time: 1668.9517s
	iters: 300, epoch: 39 | loss: 0.0048957
	speed: 0.0603s/iter; left time: 1735.4364s
	iters: 400, epoch: 39 | loss: 0.0658278
	speed: 0.0609s/iter; left time: 1745.5760s
Epoch: 39 cost time: 28.28911304473877
Epoch: 39, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 357306
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3529352
	speed: 0.0748s/iter; left time: 3498.7548s
	iters: 200, epoch: 1 | loss: 0.9735873
	speed: 0.0570s/iter; left time: 2660.6075s
	iters: 300, epoch: 1 | loss: 0.2157342
	speed: 0.0583s/iter; left time: 2718.2123s
	iters: 400, epoch: 1 | loss: 0.3334494
	speed: 0.0594s/iter; left time: 2764.4420s
Epoch: 1 cost time: 29.047354221343994
Epoch: 1, Steps: 469 | Train Loss: 0.873 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
Validation loss decreased (inf --> -0.870207).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1740989
	speed: 0.2845s/iter; left time: 13183.2778s
	iters: 200, epoch: 2 | loss: 0.1247350
	speed: 0.0680s/iter; left time: 3142.5970s
	iters: 300, epoch: 2 | loss: 0.1159512
	speed: 0.0650s/iter; left time: 2999.5775s
	iters: 400, epoch: 2 | loss: 0.1440115
	speed: 0.0642s/iter; left time: 2954.7947s
Epoch: 2 cost time: 31.30236506462097
Epoch: 2, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.870207 --> -0.951971).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0316776
	speed: 0.2875s/iter; left time: 13184.4988s
	iters: 200, epoch: 3 | loss: 0.2307296
	speed: 0.0594s/iter; left time: 2716.2791s
	iters: 300, epoch: 3 | loss: 0.0779477
	speed: 0.0577s/iter; left time: 2636.3147s
	iters: 400, epoch: 3 | loss: 0.1179143
	speed: 0.0559s/iter; left time: 2546.5483s
Epoch: 3 cost time: 27.829307794570923
Epoch: 3, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.275 Vali Acc: 0.924 Test Loss: 0.275 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1250805
	speed: 0.2687s/iter; left time: 12198.2937s
	iters: 200, epoch: 4 | loss: 0.0139655
	speed: 0.0606s/iter; left time: 2747.0594s
	iters: 300, epoch: 4 | loss: 0.0962380
	speed: 0.0632s/iter; left time: 2855.2965s
	iters: 400, epoch: 4 | loss: 0.0091939
	speed: 0.0658s/iter; left time: 2967.6265s
Epoch: 4 cost time: 29.531237840652466
Epoch: 4, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.153 Vali Acc: 0.961 Test Loss: 0.153 Test Acc: 0.961
Validation loss decreased (-0.951971 --> -0.961405).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0249527
	speed: 0.2653s/iter; left time: 11916.8096s
	iters: 200, epoch: 5 | loss: 0.0139956
	speed: 0.0634s/iter; left time: 2841.8891s
	iters: 300, epoch: 5 | loss: 0.0619177
	speed: 0.0615s/iter; left time: 2749.1071s
	iters: 400, epoch: 5 | loss: 0.7026115
	speed: 0.0640s/iter; left time: 2857.0883s
Epoch: 5 cost time: 29.826104164123535
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3603216
	speed: 0.2515s/iter; left time: 11181.3082s
	iters: 200, epoch: 6 | loss: 1.1806642
	speed: 0.0608s/iter; left time: 2695.4092s
	iters: 300, epoch: 6 | loss: 0.1989903
	speed: 0.0590s/iter; left time: 2611.3779s
	iters: 400, epoch: 6 | loss: 0.2149610
	speed: 0.0594s/iter; left time: 2622.1199s
Epoch: 6 cost time: 28.164109706878662
Epoch: 6, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.961405 --> -0.967695).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3090473
	speed: 0.2704s/iter; left time: 11894.3684s
	iters: 200, epoch: 7 | loss: 0.0478070
	speed: 0.0605s/iter; left time: 2653.7831s
	iters: 300, epoch: 7 | loss: 0.0731689
	speed: 0.0595s/iter; left time: 2605.4881s
	iters: 400, epoch: 7 | loss: 0.0177969
	speed: 0.0639s/iter; left time: 2791.2308s
Epoch: 7 cost time: 28.80432677268982
Epoch: 7, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0859593
	speed: 0.2685s/iter; left time: 11685.5365s
	iters: 200, epoch: 8 | loss: 0.0085598
	speed: 0.0585s/iter; left time: 2539.0484s
	iters: 300, epoch: 8 | loss: 0.7312021
	speed: 0.0585s/iter; left time: 2533.2149s
	iters: 400, epoch: 8 | loss: 0.0069680
	speed: 0.0586s/iter; left time: 2532.0302s
Epoch: 8 cost time: 27.85982370376587
Epoch: 8, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0604473
	speed: 0.2596s/iter; left time: 11176.5836s
	iters: 200, epoch: 9 | loss: 0.0770712
	speed: 0.0582s/iter; left time: 2499.1676s
	iters: 300, epoch: 9 | loss: 0.0056119
	speed: 0.0579s/iter; left time: 2482.8837s
	iters: 400, epoch: 9 | loss: 0.0385289
	speed: 0.0580s/iter; left time: 2480.0149s
Epoch: 9 cost time: 27.49265193939209
Epoch: 9, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.967695 --> -0.970839).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0060444
	speed: 0.2605s/iter; left time: 11090.2551s
	iters: 200, epoch: 10 | loss: 0.0434382
	speed: 0.0575s/iter; left time: 2441.7698s
	iters: 300, epoch: 10 | loss: 0.2094743
	speed: 0.0587s/iter; left time: 2485.9559s
	iters: 400, epoch: 10 | loss: 0.0066646
	speed: 0.0596s/iter; left time: 2520.5864s
Epoch: 10 cost time: 28.087313175201416
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0103496
	speed: 0.2616s/iter; left time: 11015.7201s
	iters: 200, epoch: 11 | loss: 0.0026460
	speed: 0.0613s/iter; left time: 2575.7254s
	iters: 300, epoch: 11 | loss: 0.0018493
	speed: 0.0663s/iter; left time: 2778.2082s
	iters: 400, epoch: 11 | loss: 0.0042313
	speed: 0.0623s/iter; left time: 2604.0753s
Epoch: 11 cost time: 29.702913999557495
Epoch: 11, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0023006
	speed: 0.2867s/iter; left time: 11940.2696s
	iters: 200, epoch: 12 | loss: 0.0082085
	speed: 0.0594s/iter; left time: 2465.6238s
	iters: 300, epoch: 12 | loss: 0.0030217
	speed: 0.0612s/iter; left time: 2534.3409s
	iters: 400, epoch: 12 | loss: 0.1142605
	speed: 0.0577s/iter; left time: 2386.2473s
Epoch: 12 cost time: 28.73867654800415
Epoch: 12, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0132247
	speed: 0.2766s/iter; left time: 11386.6327s
	iters: 200, epoch: 13 | loss: 0.0149417
	speed: 0.0608s/iter; left time: 2496.0482s
	iters: 300, epoch: 13 | loss: 0.0552749
	speed: 0.0607s/iter; left time: 2485.4477s
	iters: 400, epoch: 13 | loss: 0.1881624
	speed: 0.0607s/iter; left time: 2482.8843s
Epoch: 13 cost time: 28.925052165985107
Epoch: 13, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0402815
	speed: 0.2751s/iter; left time: 11197.2350s
	iters: 200, epoch: 14 | loss: 0.1382663
	speed: 0.0586s/iter; left time: 2380.7038s
	iters: 300, epoch: 14 | loss: 0.0611811
	speed: 0.0596s/iter; left time: 2414.0022s
	iters: 400, epoch: 14 | loss: 0.0282712
	speed: 0.0597s/iter; left time: 2412.7978s
Epoch: 14 cost time: 28.824265480041504
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0043681
	speed: 0.2787s/iter; left time: 11213.8006s
	iters: 200, epoch: 15 | loss: 0.0030132
	speed: 0.0655s/iter; left time: 2628.6401s
	iters: 300, epoch: 15 | loss: 0.2047630
	speed: 0.0585s/iter; left time: 2340.0898s
	iters: 400, epoch: 15 | loss: 0.0069213
	speed: 0.0579s/iter; left time: 2311.3258s
Epoch: 15 cost time: 28.733532190322876
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0060695
	speed: 0.2468s/iter; left time: 9815.0190s
	iters: 200, epoch: 16 | loss: 0.0065785
	speed: 0.0582s/iter; left time: 2310.2447s
	iters: 300, epoch: 16 | loss: 0.0136232
	speed: 0.0623s/iter; left time: 2466.1311s
	iters: 400, epoch: 16 | loss: 0.0113503
	speed: 0.0625s/iter; left time: 2467.9056s
Epoch: 16 cost time: 28.2759370803833
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0284820
	speed: 0.2622s/iter; left time: 10303.2465s
	iters: 200, epoch: 17 | loss: 0.0018379
	speed: 0.0596s/iter; left time: 2335.0582s
	iters: 300, epoch: 17 | loss: 0.0519983
	speed: 0.0614s/iter; left time: 2399.1006s
	iters: 400, epoch: 17 | loss: 0.0030458
	speed: 0.0631s/iter; left time: 2460.6049s
Epoch: 17 cost time: 29.346575021743774
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0364663
	speed: 0.2582s/iter; left time: 10026.5088s
	iters: 200, epoch: 18 | loss: 0.0024032
	speed: 0.0530s/iter; left time: 2051.6690s
	iters: 300, epoch: 18 | loss: 0.0176996
	speed: 0.0548s/iter; left time: 2116.0436s
	iters: 400, epoch: 18 | loss: 0.0214373
	speed: 0.0614s/iter; left time: 2366.8771s
Epoch: 18 cost time: 26.9834246635437
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0012936
	speed: 0.2498s/iter; left time: 9581.2190s
	iters: 200, epoch: 19 | loss: 0.0199572
	speed: 0.0614s/iter; left time: 2350.6903s
	iters: 300, epoch: 19 | loss: 0.0307417
	speed: 0.0591s/iter; left time: 2254.9639s
	iters: 400, epoch: 19 | loss: 0.0026869
	speed: 0.0586s/iter; left time: 2230.7436s
Epoch: 19 cost time: 27.97767162322998
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9708404802744426
model parameter : 357210
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1310683
	speed: 0.0799s/iter; left time: 3739.5635s
	iters: 200, epoch: 1 | loss: 0.7472198
	speed: 0.0631s/iter; left time: 2947.8523s
	iters: 300, epoch: 1 | loss: 0.2717116
	speed: 0.0635s/iter; left time: 2959.0502s
	iters: 400, epoch: 1 | loss: 0.3018239
	speed: 0.0653s/iter; left time: 3034.3064s
Epoch: 1 cost time: 31.489083528518677
Epoch: 1, Steps: 469 | Train Loss: 0.858 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
Validation loss decreased (inf --> -0.906801).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4043559
	speed: 0.2921s/iter; left time: 13532.2920s
	iters: 200, epoch: 2 | loss: 0.2210668
	speed: 0.0632s/iter; left time: 2920.8001s
	iters: 300, epoch: 2 | loss: 0.4619847
	speed: 0.0629s/iter; left time: 2900.1528s
	iters: 400, epoch: 2 | loss: 0.0486108
	speed: 0.0629s/iter; left time: 2894.5751s
Epoch: 2 cost time: 30.301934242248535
Epoch: 2, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.906801 --> -0.936533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1596250
	speed: 0.2807s/iter; left time: 12871.5072s
	iters: 200, epoch: 3 | loss: 0.1194168
	speed: 0.0662s/iter; left time: 3031.4516s
	iters: 300, epoch: 3 | loss: 0.0405268
	speed: 0.0663s/iter; left time: 3026.3179s
	iters: 400, epoch: 3 | loss: 0.0632463
	speed: 0.0674s/iter; left time: 3070.5168s
Epoch: 3 cost time: 31.761950969696045
Epoch: 3, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.936533 --> -0.937105).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1675218
	speed: 0.2912s/iter; left time: 13220.1910s
	iters: 200, epoch: 4 | loss: 0.1224242
	speed: 0.0664s/iter; left time: 3007.8320s
	iters: 300, epoch: 4 | loss: 0.0166823
	speed: 0.0642s/iter; left time: 2899.5229s
	iters: 400, epoch: 4 | loss: 0.3712423
	speed: 0.0621s/iter; left time: 2798.4303s
Epoch: 4 cost time: 30.547694206237793
Epoch: 4, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.937105 --> -0.948540).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3543407
	speed: 0.2757s/iter; left time: 12384.4752s
	iters: 200, epoch: 5 | loss: 0.3559691
	speed: 0.0636s/iter; left time: 2852.8516s
	iters: 300, epoch: 5 | loss: 0.1032305
	speed: 0.0593s/iter; left time: 2652.0850s
	iters: 400, epoch: 5 | loss: 0.0401160
	speed: 0.0626s/iter; left time: 2793.0834s
Epoch: 5 cost time: 29.77506136894226
Epoch: 5, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3554017
	speed: 0.2713s/iter; left time: 12061.7464s
	iters: 200, epoch: 6 | loss: 0.0774983
	speed: 0.0602s/iter; left time: 2669.4084s
	iters: 300, epoch: 6 | loss: 0.0306743
	speed: 0.0586s/iter; left time: 2594.5028s
	iters: 400, epoch: 6 | loss: 0.0134515
	speed: 0.0588s/iter; left time: 2595.0034s
Epoch: 6 cost time: 28.315394639968872
Epoch: 6, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0897937
	speed: 0.2767s/iter; left time: 12169.1328s
	iters: 200, epoch: 7 | loss: 0.0399596
	speed: 0.0638s/iter; left time: 2800.8898s
	iters: 300, epoch: 7 | loss: 0.0611526
	speed: 0.0619s/iter; left time: 2711.8843s
	iters: 400, epoch: 7 | loss: 0.0027279
	speed: 0.0619s/iter; left time: 2705.8523s
Epoch: 7 cost time: 29.712055683135986
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0079544
	speed: 0.2719s/iter; left time: 11832.3591s
	iters: 200, epoch: 8 | loss: 0.0019441
	speed: 0.0599s/iter; left time: 2599.7813s
	iters: 300, epoch: 8 | loss: 0.1510942
	speed: 0.0599s/iter; left time: 2593.2073s
	iters: 400, epoch: 8 | loss: 0.0159497
	speed: 0.0565s/iter; left time: 2440.8160s
Epoch: 8 cost time: 28.541718244552612
Epoch: 8, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
Validation loss decreased (-0.948540 --> -0.959975).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0207561
	speed: 0.2611s/iter; left time: 11241.4784s
	iters: 200, epoch: 9 | loss: 0.1377584
	speed: 0.0659s/iter; left time: 2830.0928s
	iters: 300, epoch: 9 | loss: 0.0153408
	speed: 0.0621s/iter; left time: 2660.3895s
	iters: 400, epoch: 9 | loss: 0.0188386
	speed: 0.0595s/iter; left time: 2541.7373s
Epoch: 9 cost time: 29.52455425262451
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.959975 --> -0.961691).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0018357
	speed: 0.2753s/iter; left time: 11723.2914s
	iters: 200, epoch: 10 | loss: 0.0054812
	speed: 0.0624s/iter; left time: 2650.4588s
	iters: 300, epoch: 10 | loss: 0.4519396
	speed: 0.0621s/iter; left time: 2632.8658s
	iters: 400, epoch: 10 | loss: 0.0099415
	speed: 0.0621s/iter; left time: 2623.9661s
Epoch: 10 cost time: 29.324121952056885
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0066194
	speed: 0.2600s/iter; left time: 10950.4474s
	iters: 200, epoch: 11 | loss: 0.0933261
	speed: 0.0598s/iter; left time: 2510.7314s
	iters: 300, epoch: 11 | loss: 0.0660826
	speed: 0.0622s/iter; left time: 2606.7017s
	iters: 400, epoch: 11 | loss: 0.0068395
	speed: 0.0633s/iter; left time: 2648.5345s
Epoch: 11 cost time: 29.093960285186768
Epoch: 11, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0037772
	speed: 0.2732s/iter; left time: 11378.0654s
	iters: 200, epoch: 12 | loss: 0.2542748
	speed: 0.0727s/iter; left time: 3022.1583s
	iters: 300, epoch: 12 | loss: 0.0045007
	speed: 0.0645s/iter; left time: 2673.6091s
	iters: 400, epoch: 12 | loss: 0.1103787
	speed: 0.0614s/iter; left time: 2537.2295s
Epoch: 12 cost time: 31.188904285430908
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.961691 --> -0.966837).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2221551
	speed: 0.2929s/iter; left time: 12058.1768s
	iters: 200, epoch: 13 | loss: 0.0049065
	speed: 0.0602s/iter; left time: 2472.8350s
	iters: 300, epoch: 13 | loss: 0.0009776
	speed: 0.0609s/iter; left time: 2496.5962s
	iters: 400, epoch: 13 | loss: 0.0015060
	speed: 0.0604s/iter; left time: 2468.0678s
Epoch: 13 cost time: 29.38883113861084
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966837 --> -0.966837).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0425213
	speed: 0.2788s/iter; left time: 11346.3969s
	iters: 200, epoch: 14 | loss: 0.0409377
	speed: 0.0650s/iter; left time: 2638.9636s
	iters: 300, epoch: 14 | loss: 0.0576685
	speed: 0.0620s/iter; left time: 2513.2512s
	iters: 400, epoch: 14 | loss: 0.0099306
	speed: 0.0628s/iter; left time: 2535.4552s
Epoch: 14 cost time: 30.131805181503296
Epoch: 14, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.966837 --> -0.968266).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0055951
	speed: 0.2721s/iter; left time: 10947.2398s
	iters: 200, epoch: 15 | loss: 0.0174983
	speed: 0.0574s/iter; left time: 2304.7698s
	iters: 300, epoch: 15 | loss: 0.2900708
	speed: 0.0608s/iter; left time: 2432.8491s
	iters: 400, epoch: 15 | loss: 0.0880330
	speed: 0.0596s/iter; left time: 2379.3104s
Epoch: 15 cost time: 28.1039457321167
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.325 Vali Acc: 0.935 Test Loss: 0.325 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3045439
	speed: 0.2650s/iter; left time: 10536.7363s
	iters: 200, epoch: 16 | loss: 0.0040066
	speed: 0.0597s/iter; left time: 2368.8372s
	iters: 300, epoch: 16 | loss: 0.0046937
	speed: 0.0572s/iter; left time: 2261.2107s
	iters: 400, epoch: 16 | loss: 0.0024366
	speed: 0.0600s/iter; left time: 2368.2142s
Epoch: 16 cost time: 27.98974895477295
Epoch: 16, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0101972
	speed: 0.2664s/iter; left time: 10468.0216s
	iters: 200, epoch: 17 | loss: 0.4359746
	speed: 0.0593s/iter; left time: 2324.5591s
	iters: 300, epoch: 17 | loss: 0.0022253
	speed: 0.0573s/iter; left time: 2239.3043s
	iters: 400, epoch: 17 | loss: 0.5944189
	speed: 0.0584s/iter; left time: 2278.4895s
Epoch: 17 cost time: 27.963317155838013
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2966816
	speed: 0.2646s/iter; left time: 10273.9874s
	iters: 200, epoch: 18 | loss: 0.2328958
	speed: 0.0586s/iter; left time: 2270.4591s
	iters: 300, epoch: 18 | loss: 0.0142476
	speed: 0.0603s/iter; left time: 2328.9249s
	iters: 400, epoch: 18 | loss: 0.0022880
	speed: 0.0604s/iter; left time: 2326.2332s
Epoch: 18 cost time: 28.342020988464355
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0057592
	speed: 0.2666s/iter; left time: 10227.0005s
	iters: 200, epoch: 19 | loss: 0.0750909
	speed: 0.0592s/iter; left time: 2265.1701s
	iters: 300, epoch: 19 | loss: 0.0009185
	speed: 0.0560s/iter; left time: 2138.5586s
	iters: 400, epoch: 19 | loss: 0.0085400
	speed: 0.0599s/iter; left time: 2281.4204s
Epoch: 19 cost time: 28.21978735923767
Epoch: 19, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
Validation loss decreased (-0.968266 --> -0.968838).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0015933
	speed: 0.2570s/iter; left time: 9736.8622s
	iters: 200, epoch: 20 | loss: 0.0033655
	speed: 0.0591s/iter; left time: 2233.1009s
	iters: 300, epoch: 20 | loss: 0.0490775
	speed: 0.0527s/iter; left time: 1987.2039s
	iters: 400, epoch: 20 | loss: 0.0024882
	speed: 0.0525s/iter; left time: 1972.3310s
Epoch: 20 cost time: 26.517247200012207
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0252701
	speed: 0.2708s/iter; left time: 10132.2810s
	iters: 200, epoch: 21 | loss: 0.0032683
	speed: 0.0628s/iter; left time: 2344.5509s
	iters: 300, epoch: 21 | loss: 0.0006913
	speed: 0.0613s/iter; left time: 2282.6494s
	iters: 400, epoch: 21 | loss: 0.0050004
	speed: 0.0612s/iter; left time: 2269.9595s
Epoch: 21 cost time: 29.155555486679077
Epoch: 21, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0022318
	speed: 0.2515s/iter; left time: 9292.6180s
	iters: 200, epoch: 22 | loss: 0.0009394
	speed: 0.0626s/iter; left time: 2307.8284s
	iters: 300, epoch: 22 | loss: 0.0024579
	speed: 0.0657s/iter; left time: 2413.3243s
	iters: 400, epoch: 22 | loss: 0.0017172
	speed: 0.0632s/iter; left time: 2314.7198s
Epoch: 22 cost time: 29.962953567504883
Epoch: 22, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.953 Test Loss: 0.250 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.2700035
	speed: 0.2773s/iter; left time: 10115.6130s
	iters: 200, epoch: 23 | loss: 0.0238306
	speed: 0.0589s/iter; left time: 2143.9515s
	iters: 300, epoch: 23 | loss: 0.0009727
	speed: 0.0583s/iter; left time: 2116.1849s
	iters: 400, epoch: 23 | loss: 0.0007366
	speed: 0.0603s/iter; left time: 2180.8471s
Epoch: 23 cost time: 28.507402658462524
Epoch: 23, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0070644
	speed: 0.2806s/iter; left time: 10105.3042s
	iters: 200, epoch: 24 | loss: 0.0129487
	speed: 0.0611s/iter; left time: 2194.1051s
	iters: 300, epoch: 24 | loss: 0.0059537
	speed: 0.0648s/iter; left time: 2321.7119s
	iters: 400, epoch: 24 | loss: 0.0037100
	speed: 0.0679s/iter; left time: 2424.8644s
Epoch: 24 cost time: 30.824406147003174
Epoch: 24, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.241 Vali Acc: 0.961 Test Loss: 0.241 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0022107
	speed: 0.2788s/iter; left time: 9910.4949s
	iters: 200, epoch: 25 | loss: 0.0321132
	speed: 0.0607s/iter; left time: 2151.5493s
	iters: 300, epoch: 25 | loss: 0.2163350
	speed: 0.0595s/iter; left time: 2102.1681s
	iters: 400, epoch: 25 | loss: 0.0223182
	speed: 0.0554s/iter; left time: 1953.5924s
Epoch: 25 cost time: 28.146671056747437
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0034864
	speed: 0.2656s/iter; left time: 9316.2587s
	iters: 200, epoch: 26 | loss: 0.0118766
	speed: 0.0613s/iter; left time: 2143.4704s
	iters: 300, epoch: 26 | loss: 0.0223553
	speed: 0.0595s/iter; left time: 2076.0705s
	iters: 400, epoch: 26 | loss: 0.0308483
	speed: 0.0605s/iter; left time: 2104.4912s
Epoch: 26 cost time: 29.350276231765747
Epoch: 26, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.962 Test Loss: 0.214 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0022542
	speed: 0.2644s/iter; left time: 9149.2530s
	iters: 200, epoch: 27 | loss: 0.0009348
	speed: 0.0606s/iter; left time: 2090.3313s
	iters: 300, epoch: 27 | loss: 0.0059039
	speed: 0.0612s/iter; left time: 2105.2782s
	iters: 400, epoch: 27 | loss: 0.0028118
	speed: 0.0583s/iter; left time: 1998.6630s
Epoch: 27 cost time: 28.54572582244873
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0006000
	speed: 0.2553s/iter; left time: 8714.6810s
	iters: 200, epoch: 28 | loss: 0.0029932
	speed: 0.0618s/iter; left time: 2102.3440s
	iters: 300, epoch: 28 | loss: 0.0043315
	speed: 0.0643s/iter; left time: 2181.8714s
	iters: 400, epoch: 28 | loss: 0.0010355
	speed: 0.0629s/iter; left time: 2130.0929s
Epoch: 28 cost time: 29.37446427345276
Epoch: 28, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0012547
	speed: 0.2612s/iter; left time: 8796.0113s
	iters: 200, epoch: 29 | loss: 0.4574470
	speed: 0.0605s/iter; left time: 2029.4693s
	iters: 300, epoch: 29 | loss: 0.0111353
	speed: 0.0571s/iter; left time: 1909.7444s
	iters: 400, epoch: 29 | loss: 0.0393246
	speed: 0.0598s/iter; left time: 1995.8632s
Epoch: 29 cost time: 28.291831016540527
Epoch: 29, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.968839336763865
model parameter : 357114
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3779196
	speed: 0.0740s/iter; left time: 3465.0175s
	iters: 200, epoch: 1 | loss: 0.5994806
	speed: 0.0606s/iter; left time: 2829.7151s
	iters: 300, epoch: 1 | loss: 0.4784340
	speed: 0.0599s/iter; left time: 2793.3366s
	iters: 400, epoch: 1 | loss: 0.4257489
	speed: 0.0604s/iter; left time: 2808.4943s
Epoch: 1 cost time: 29.804665327072144
Epoch: 1, Steps: 469 | Train Loss: 0.853 Vali Loss: 0.347 Vali Acc: 0.888 Test Loss: 0.347 Test Acc: 0.888
Validation loss decreased (inf --> -0.888218).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7892380
	speed: 0.2561s/iter; left time: 11867.2560s
	iters: 200, epoch: 2 | loss: 0.2696025
	speed: 0.0603s/iter; left time: 2786.1620s
	iters: 300, epoch: 2 | loss: 0.4405701
	speed: 0.0584s/iter; left time: 2693.3559s
	iters: 400, epoch: 2 | loss: 0.3038120
	speed: 0.0589s/iter; left time: 2709.7280s
Epoch: 2 cost time: 28.34788227081299
Epoch: 2, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.183 Vali Acc: 0.940 Test Loss: 0.183 Test Acc: 0.940
Validation loss decreased (-0.888218 --> -0.940250).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1798893
	speed: 0.2543s/iter; left time: 11663.1449s
	iters: 200, epoch: 3 | loss: 0.0730560
	speed: 0.0634s/iter; left time: 2902.6617s
	iters: 300, epoch: 3 | loss: 0.1684456
	speed: 0.0623s/iter; left time: 2842.8522s
	iters: 400, epoch: 3 | loss: 0.0581958
	speed: 0.0615s/iter; left time: 2802.9597s
Epoch: 3 cost time: 29.492663621902466
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.940250 --> -0.947683).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0345169
	speed: 0.2811s/iter; left time: 12760.1609s
	iters: 200, epoch: 4 | loss: 0.0324246
	speed: 0.0634s/iter; left time: 2870.8834s
	iters: 300, epoch: 4 | loss: 0.1862011
	speed: 0.0651s/iter; left time: 2941.6945s
	iters: 400, epoch: 4 | loss: 0.0171959
	speed: 0.0646s/iter; left time: 2913.2645s
Epoch: 4 cost time: 30.368612051010132
Epoch: 4, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.947683 --> -0.951399).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1199196
	speed: 0.2797s/iter; left time: 12564.2074s
	iters: 200, epoch: 5 | loss: 0.0597053
	speed: 0.0626s/iter; left time: 2804.1474s
	iters: 300, epoch: 5 | loss: 0.0531086
	speed: 0.0636s/iter; left time: 2845.6840s
	iters: 400, epoch: 5 | loss: 0.8568569
	speed: 0.0640s/iter; left time: 2855.5870s
Epoch: 5 cost time: 29.730896711349487
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1999444
	speed: 0.2676s/iter; left time: 11894.4520s
	iters: 200, epoch: 6 | loss: 0.3422736
	speed: 0.0560s/iter; left time: 2484.5503s
	iters: 300, epoch: 6 | loss: 0.0125912
	speed: 0.0608s/iter; left time: 2690.0557s
	iters: 400, epoch: 6 | loss: 0.1234741
	speed: 0.0597s/iter; left time: 2636.7352s
Epoch: 6 cost time: 27.774515867233276
Epoch: 6, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0289625
	speed: 0.2538s/iter; left time: 11164.0387s
	iters: 200, epoch: 7 | loss: 0.0039833
	speed: 0.0588s/iter; left time: 2579.7770s
	iters: 300, epoch: 7 | loss: 0.1745916
	speed: 0.0588s/iter; left time: 2574.1467s
	iters: 400, epoch: 7 | loss: 0.0153027
	speed: 0.0599s/iter; left time: 2617.1851s
Epoch: 7 cost time: 27.960692882537842
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.951399 --> -0.970839).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0570213
	speed: 0.2437s/iter; left time: 10604.9822s
	iters: 200, epoch: 8 | loss: 0.0541228
	speed: 0.0589s/iter; left time: 2557.6016s
	iters: 300, epoch: 8 | loss: 0.0314801
	speed: 0.0582s/iter; left time: 2520.3536s
	iters: 400, epoch: 8 | loss: 0.0380021
	speed: 0.0629s/iter; left time: 2716.5714s
Epoch: 8 cost time: 28.15224051475525
Epoch: 8, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.970839 --> -0.973698).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0072060
	speed: 0.2493s/iter; left time: 10733.2666s
	iters: 200, epoch: 9 | loss: 0.0037825
	speed: 0.0568s/iter; left time: 2437.6168s
	iters: 300, epoch: 9 | loss: 0.0535750
	speed: 0.0579s/iter; left time: 2478.8596s
	iters: 400, epoch: 9 | loss: 0.2703813
	speed: 0.0581s/iter; left time: 2485.0294s
Epoch: 9 cost time: 27.38073229789734
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0023659
	speed: 0.2386s/iter; left time: 10161.5134s
	iters: 200, epoch: 10 | loss: 0.0065122
	speed: 0.0577s/iter; left time: 2449.7656s
	iters: 300, epoch: 10 | loss: 0.3645980
	speed: 0.0583s/iter; left time: 2472.4294s
	iters: 400, epoch: 10 | loss: 0.0047183
	speed: 0.0574s/iter; left time: 2425.8426s
Epoch: 10 cost time: 27.581483125686646
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0327169
	speed: 0.2578s/iter; left time: 10856.3973s
	iters: 200, epoch: 11 | loss: 0.0057789
	speed: 0.0588s/iter; left time: 2471.8184s
	iters: 300, epoch: 11 | loss: 0.0029011
	speed: 0.0558s/iter; left time: 2339.2246s
	iters: 400, epoch: 11 | loss: 0.0546201
	speed: 0.0584s/iter; left time: 2443.3023s
Epoch: 11 cost time: 27.906787633895874
Epoch: 11, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0042894
	speed: 0.2443s/iter; left time: 10172.8811s
	iters: 200, epoch: 12 | loss: 0.0374555
	speed: 0.0625s/iter; left time: 2597.3944s
	iters: 300, epoch: 12 | loss: 0.0166508
	speed: 0.0651s/iter; left time: 2698.2390s
	iters: 400, epoch: 12 | loss: 0.0539118
	speed: 0.0609s/iter; left time: 2518.0314s
Epoch: 12 cost time: 29.2689790725708
Epoch: 12, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0064334
	speed: 0.2560s/iter; left time: 10540.1577s
	iters: 200, epoch: 13 | loss: 0.0082154
	speed: 0.0598s/iter; left time: 2455.0717s
	iters: 300, epoch: 13 | loss: 0.3356800
	speed: 0.0614s/iter; left time: 2514.5205s
	iters: 400, epoch: 13 | loss: 0.0090204
	speed: 0.0618s/iter; left time: 2526.9808s
Epoch: 13 cost time: 29.538986921310425
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2002541
	speed: 0.2727s/iter; left time: 11100.7470s
	iters: 200, epoch: 14 | loss: 0.0565413
	speed: 0.0620s/iter; left time: 2519.3790s
	iters: 300, epoch: 14 | loss: 0.0155132
	speed: 0.0638s/iter; left time: 2584.6589s
	iters: 400, epoch: 14 | loss: 0.0088357
	speed: 0.0666s/iter; left time: 2690.7292s
Epoch: 14 cost time: 29.928303480148315
Epoch: 14, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.974842).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0026900
	speed: 0.2789s/iter; left time: 11223.2939s
	iters: 200, epoch: 15 | loss: 0.0238181
	speed: 0.0610s/iter; left time: 2448.5200s
	iters: 300, epoch: 15 | loss: 0.0650162
	speed: 0.0615s/iter; left time: 2461.4665s
	iters: 400, epoch: 15 | loss: 0.0022631
	speed: 0.0614s/iter; left time: 2453.1642s
Epoch: 15 cost time: 29.737189531326294
Epoch: 15, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0260503
	speed: 0.2553s/iter; left time: 10153.2233s
	iters: 200, epoch: 16 | loss: 0.0019992
	speed: 0.0581s/iter; left time: 2304.3075s
	iters: 300, epoch: 16 | loss: 0.0030063
	speed: 0.0608s/iter; left time: 2404.2506s
	iters: 400, epoch: 16 | loss: 0.0180992
	speed: 0.0590s/iter; left time: 2329.9505s
Epoch: 16 cost time: 27.9336576461792
Epoch: 16, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.954 Test Loss: 0.228 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0059524
	speed: 0.2487s/iter; left time: 9772.9664s
	iters: 200, epoch: 17 | loss: 0.1780834
	speed: 0.0551s/iter; left time: 2160.6526s
	iters: 300, epoch: 17 | loss: 0.0029424
	speed: 0.0564s/iter; left time: 2205.4873s
	iters: 400, epoch: 17 | loss: 0.1509744
	speed: 0.0597s/iter; left time: 2329.4757s
Epoch: 17 cost time: 27.32331418991089
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0253813
	speed: 0.2513s/iter; left time: 9756.3210s
	iters: 200, epoch: 18 | loss: 0.0125379
	speed: 0.0553s/iter; left time: 2142.3254s
	iters: 300, epoch: 18 | loss: 0.0079357
	speed: 0.0579s/iter; left time: 2235.7423s
	iters: 400, epoch: 18 | loss: 0.0200800
	speed: 0.0565s/iter; left time: 2176.1712s
Epoch: 18 cost time: 27.066280841827393
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0061716
	speed: 0.2486s/iter; left time: 9534.4054s
	iters: 200, epoch: 19 | loss: 0.0012932
	speed: 0.0564s/iter; left time: 2157.0302s
	iters: 300, epoch: 19 | loss: 0.0011089
	speed: 0.0563s/iter; left time: 2149.3125s
	iters: 400, epoch: 19 | loss: 0.0015482
	speed: 0.0586s/iter; left time: 2229.4627s
Epoch: 19 cost time: 27.343522310256958
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0021298
	speed: 0.2496s/iter; left time: 9456.5776s
	iters: 200, epoch: 20 | loss: 0.0045009
	speed: 0.0583s/iter; left time: 2203.4844s
	iters: 300, epoch: 20 | loss: 0.1023437
	speed: 0.0570s/iter; left time: 2148.8921s
	iters: 400, epoch: 20 | loss: 0.0534222
	speed: 0.0543s/iter; left time: 2039.4735s
Epoch: 20 cost time: 26.58642554283142
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0015995
	speed: 0.2460s/iter; left time: 9206.4037s
	iters: 200, epoch: 21 | loss: 0.0024742
	speed: 0.0565s/iter; left time: 2108.0396s
	iters: 300, epoch: 21 | loss: 0.1020820
	speed: 0.0549s/iter; left time: 2045.0142s
	iters: 400, epoch: 21 | loss: 0.0136125
	speed: 0.0574s/iter; left time: 2131.1707s
Epoch: 21 cost time: 26.59218144416809
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0013748
	speed: 0.2467s/iter; left time: 9117.0258s
	iters: 200, epoch: 22 | loss: 0.0014842
	speed: 0.0562s/iter; left time: 2072.4865s
	iters: 300, epoch: 22 | loss: 0.5253038
	speed: 0.0553s/iter; left time: 2032.9385s
	iters: 400, epoch: 22 | loss: 0.0164848
	speed: 0.0547s/iter; left time: 2004.8045s
Epoch: 22 cost time: 26.485243320465088
Epoch: 22, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0008765
	speed: 0.2549s/iter; left time: 9298.5459s
	iters: 200, epoch: 23 | loss: 0.0048520
	speed: 0.0569s/iter; left time: 2068.8683s
	iters: 300, epoch: 23 | loss: 0.0201271
	speed: 0.0532s/iter; left time: 1929.5922s
	iters: 400, epoch: 23 | loss: 0.0054996
	speed: 0.0556s/iter; left time: 2012.6312s
Epoch: 23 cost time: 26.90054154396057
Epoch: 23, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0175866
	speed: 0.2720s/iter; left time: 9794.0367s
	iters: 200, epoch: 24 | loss: 0.0122607
	speed: 0.0581s/iter; left time: 2087.5918s
	iters: 300, epoch: 24 | loss: 0.0046710
	speed: 0.0584s/iter; left time: 2089.8272s
	iters: 400, epoch: 24 | loss: 0.0011557
	speed: 0.0596s/iter; left time: 2129.4548s
Epoch: 24 cost time: 28.18967342376709
Epoch: 24, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 357018
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3890369
	speed: 0.0736s/iter; left time: 3444.9683s
	iters: 200, epoch: 1 | loss: 1.1770936
	speed: 0.0626s/iter; left time: 2925.1369s
	iters: 300, epoch: 1 | loss: 0.5959982
	speed: 0.0624s/iter; left time: 2908.3473s
	iters: 400, epoch: 1 | loss: 0.2943683
	speed: 0.0586s/iter; left time: 2723.8091s
Epoch: 1 cost time: 30.00748109817505
Epoch: 1, Steps: 469 | Train Loss: 0.964 Vali Loss: 0.451 Vali Acc: 0.866 Test Loss: 0.451 Test Acc: 0.866
Validation loss decreased (inf --> -0.866205).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6304933
	speed: 0.2540s/iter; left time: 11768.3449s
	iters: 200, epoch: 2 | loss: 0.2476723
	speed: 0.0561s/iter; left time: 2591.7640s
	iters: 300, epoch: 2 | loss: 0.1407030
	speed: 0.0597s/iter; left time: 2752.1394s
	iters: 400, epoch: 2 | loss: 0.5105606
	speed: 0.0578s/iter; left time: 2660.5221s
Epoch: 2 cost time: 27.30904197692871
Epoch: 2, Steps: 469 | Train Loss: 0.223 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.866205 --> -0.932531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0820526
	speed: 0.2556s/iter; left time: 11722.5658s
	iters: 200, epoch: 3 | loss: 0.5108274
	speed: 0.0553s/iter; left time: 2529.3113s
	iters: 300, epoch: 3 | loss: 0.4664377
	speed: 0.0561s/iter; left time: 2563.2324s
	iters: 400, epoch: 3 | loss: 0.1778743
	speed: 0.0558s/iter; left time: 2540.8959s
Epoch: 3 cost time: 26.79222559928894
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.932531 --> -0.961691).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1966010
	speed: 0.2506s/iter; left time: 11376.4642s
	iters: 200, epoch: 4 | loss: 0.0707637
	speed: 0.0549s/iter; left time: 2486.6383s
	iters: 300, epoch: 4 | loss: 0.0401577
	speed: 0.0555s/iter; left time: 2507.7621s
	iters: 400, epoch: 4 | loss: 0.0066570
	speed: 0.0583s/iter; left time: 2628.0892s
Epoch: 4 cost time: 27.234634160995483
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3021901
	speed: 0.2531s/iter; left time: 11369.6522s
	iters: 200, epoch: 5 | loss: 0.1276212
	speed: 0.0587s/iter; left time: 2632.9682s
	iters: 300, epoch: 5 | loss: 0.0701811
	speed: 0.0572s/iter; left time: 2559.1427s
	iters: 400, epoch: 5 | loss: 0.3340389
	speed: 0.0590s/iter; left time: 2633.9780s
Epoch: 5 cost time: 27.75787854194641
Epoch: 5, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0150618
	speed: 0.2546s/iter; left time: 11320.3248s
	iters: 200, epoch: 6 | loss: 0.0899938
	speed: 0.0609s/iter; left time: 2702.9687s
	iters: 300, epoch: 6 | loss: 0.0661871
	speed: 0.0579s/iter; left time: 2564.6309s
	iters: 400, epoch: 6 | loss: 0.1353123
	speed: 0.0569s/iter; left time: 2514.1102s
Epoch: 6 cost time: 27.704680919647217
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1048603
	speed: 0.2575s/iter; left time: 11326.9950s
	iters: 200, epoch: 7 | loss: 0.0050473
	speed: 0.0557s/iter; left time: 2446.1694s
	iters: 300, epoch: 7 | loss: 0.1898705
	speed: 0.0562s/iter; left time: 2460.4040s
	iters: 400, epoch: 7 | loss: 0.0041903
	speed: 0.0576s/iter; left time: 2514.3295s
Epoch: 7 cost time: 27.35212540626526
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0038736
	speed: 0.2573s/iter; left time: 11198.0632s
	iters: 200, epoch: 8 | loss: 0.0475839
	speed: 0.0606s/iter; left time: 2632.7015s
	iters: 300, epoch: 8 | loss: 0.0706199
	speed: 0.0566s/iter; left time: 2453.7678s
	iters: 400, epoch: 8 | loss: 0.0086227
	speed: 0.0558s/iter; left time: 2413.6308s
Epoch: 8 cost time: 27.324117422103882
Epoch: 8, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.961691 --> -0.967123).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0443882
	speed: 0.2523s/iter; left time: 10862.7783s
	iters: 200, epoch: 9 | loss: 0.0477289
	speed: 0.0586s/iter; left time: 2518.6752s
	iters: 300, epoch: 9 | loss: 0.0025288
	speed: 0.0577s/iter; left time: 2474.0868s
	iters: 400, epoch: 9 | loss: 0.0252513
	speed: 0.0612s/iter; left time: 2618.2417s
Epoch: 9 cost time: 28.060072898864746
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2175983
	speed: 0.2752s/iter; left time: 11717.8513s
	iters: 200, epoch: 10 | loss: 0.0048104
	speed: 0.0605s/iter; left time: 2568.9604s
	iters: 300, epoch: 10 | loss: 0.0233916
	speed: 0.0596s/iter; left time: 2524.6917s
	iters: 400, epoch: 10 | loss: 0.0735238
	speed: 0.0610s/iter; left time: 2581.0697s
Epoch: 10 cost time: 28.922148942947388
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0230883
	speed: 0.2740s/iter; left time: 11539.0360s
	iters: 200, epoch: 11 | loss: 0.1554276
	speed: 0.0593s/iter; left time: 2489.2546s
	iters: 300, epoch: 11 | loss: 0.0086858
	speed: 0.0610s/iter; left time: 2558.4487s
	iters: 400, epoch: 11 | loss: 0.0022662
	speed: 0.0610s/iter; left time: 2548.6717s
Epoch: 11 cost time: 28.855355739593506
Epoch: 11, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0070145
	speed: 0.2748s/iter; left time: 11444.2422s
	iters: 200, epoch: 12 | loss: 0.0010354
	speed: 0.0574s/iter; left time: 2385.4419s
	iters: 300, epoch: 12 | loss: 0.0735665
	speed: 0.0574s/iter; left time: 2377.1038s
	iters: 400, epoch: 12 | loss: 0.0362267
	speed: 0.0567s/iter; left time: 2344.1627s
Epoch: 12 cost time: 27.708921909332275
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0134910
	speed: 0.2545s/iter; left time: 10479.6104s
	iters: 200, epoch: 13 | loss: 0.4157941
	speed: 0.0573s/iter; left time: 2353.0734s
	iters: 300, epoch: 13 | loss: 0.0031568
	speed: 0.0587s/iter; left time: 2405.8700s
	iters: 400, epoch: 13 | loss: 0.0017093
	speed: 0.0571s/iter; left time: 2333.2514s
Epoch: 13 cost time: 27.51012086868286
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.967123 --> -0.972840).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0038929
	speed: 0.2515s/iter; left time: 10237.4612s
	iters: 200, epoch: 14 | loss: 0.0027763
	speed: 0.0625s/iter; left time: 2536.7912s
	iters: 300, epoch: 14 | loss: 0.0875593
	speed: 0.0568s/iter; left time: 2299.3724s
	iters: 400, epoch: 14 | loss: 0.0170732
	speed: 0.0578s/iter; left time: 2333.7164s
Epoch: 14 cost time: 27.984928607940674
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0021666
	speed: 0.2525s/iter; left time: 10159.7761s
	iters: 200, epoch: 15 | loss: 0.0018136
	speed: 0.0593s/iter; left time: 2378.4618s
	iters: 300, epoch: 15 | loss: 0.4426973
	speed: 0.0592s/iter; left time: 2368.3121s
	iters: 400, epoch: 15 | loss: 0.0129754
	speed: 0.0567s/iter; left time: 2263.4008s
Epoch: 15 cost time: 27.376213312149048
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.975413).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0759356
	speed: 0.2547s/iter; left time: 10127.9188s
	iters: 200, epoch: 16 | loss: 0.0051989
	speed: 0.0568s/iter; left time: 2251.4256s
	iters: 300, epoch: 16 | loss: 0.0027246
	speed: 0.0581s/iter; left time: 2299.0592s
	iters: 400, epoch: 16 | loss: 0.0039366
	speed: 0.0579s/iter; left time: 2284.5412s
Epoch: 16 cost time: 27.50186514854431
Epoch: 16, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0043638
	speed: 0.2298s/iter; left time: 9028.5215s
	iters: 200, epoch: 17 | loss: 0.0012364
	speed: 0.0612s/iter; left time: 2398.1096s
	iters: 300, epoch: 17 | loss: 0.2357375
	speed: 0.0588s/iter; left time: 2298.8843s
	iters: 400, epoch: 17 | loss: 0.0280455
	speed: 0.0573s/iter; left time: 2233.9386s
Epoch: 17 cost time: 27.96777033805847
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0036018
	speed: 0.2533s/iter; left time: 9836.4205s
	iters: 200, epoch: 18 | loss: 0.0093689
	speed: 0.0567s/iter; left time: 2196.3059s
	iters: 300, epoch: 18 | loss: 0.0035367
	speed: 0.0592s/iter; left time: 2285.0731s
	iters: 400, epoch: 18 | loss: 0.0125833
	speed: 0.0584s/iter; left time: 2248.5846s
Epoch: 18 cost time: 27.78057885169983
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0020463
	speed: 0.2591s/iter; left time: 9937.8262s
	iters: 200, epoch: 19 | loss: 0.0080259
	speed: 0.0580s/iter; left time: 2218.5690s
	iters: 300, epoch: 19 | loss: 0.0015070
	speed: 0.0626s/iter; left time: 2388.6821s
	iters: 400, epoch: 19 | loss: 0.1228648
	speed: 0.0584s/iter; left time: 2221.7393s
Epoch: 19 cost time: 28.424779891967773
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0080505
	speed: 0.2624s/iter; left time: 9942.0120s
	iters: 200, epoch: 20 | loss: 0.0013064
	speed: 0.0596s/iter; left time: 2252.7810s
	iters: 300, epoch: 20 | loss: 0.0492856
	speed: 0.0606s/iter; left time: 2283.8955s
	iters: 400, epoch: 20 | loss: 0.0021058
	speed: 0.0612s/iter; left time: 2300.8988s
Epoch: 20 cost time: 28.794177055358887
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0010989
	speed: 0.2849s/iter; left time: 10659.9658s
	iters: 200, epoch: 21 | loss: 0.0019598
	speed: 0.0616s/iter; left time: 2299.5129s
	iters: 300, epoch: 21 | loss: 0.0082643
	speed: 0.0630s/iter; left time: 2343.2786s
	iters: 400, epoch: 21 | loss: 0.0004597
	speed: 0.0664s/iter; left time: 2463.9502s
Epoch: 21 cost time: 29.958183765411377
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1415019
	speed: 0.2839s/iter; left time: 10490.1382s
	iters: 200, epoch: 22 | loss: 0.0011373
	speed: 0.0623s/iter; left time: 2294.6782s
	iters: 300, epoch: 22 | loss: 0.0005997
	speed: 0.0608s/iter; left time: 2234.8237s
	iters: 400, epoch: 22 | loss: 0.0022197
	speed: 0.0590s/iter; left time: 2162.1461s
Epoch: 22 cost time: 28.65535593032837
Epoch: 22, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0218915
	speed: 0.2699s/iter; left time: 9846.5197s
	iters: 200, epoch: 23 | loss: 0.0357367
	speed: 0.0611s/iter; left time: 2222.8597s
	iters: 300, epoch: 23 | loss: 0.0017952
	speed: 0.0604s/iter; left time: 2191.7390s
	iters: 400, epoch: 23 | loss: 0.0492802
	speed: 0.0588s/iter; left time: 2126.3644s
Epoch: 23 cost time: 28.68949246406555
Epoch: 23, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0032031
	speed: 0.2547s/iter; left time: 9172.6677s
	iters: 200, epoch: 24 | loss: 0.0005276
	speed: 0.0605s/iter; left time: 2173.1718s
	iters: 300, epoch: 24 | loss: 0.0008843
	speed: 0.0597s/iter; left time: 2139.7391s
	iters: 400, epoch: 24 | loss: 0.0050097
	speed: 0.0571s/iter; left time: 2038.7596s
Epoch: 24 cost time: 27.72042155265808
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0020358
	speed: 0.2536s/iter; left time: 9014.1103s
	iters: 200, epoch: 25 | loss: 0.0059369
	speed: 0.0593s/iter; left time: 2101.4201s
	iters: 300, epoch: 25 | loss: 0.0195888
	speed: 0.0618s/iter; left time: 2185.1348s
	iters: 400, epoch: 25 | loss: 0.0012917
	speed: 0.0597s/iter; left time: 2104.5563s
Epoch: 25 cost time: 28.285117626190186
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 240826
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6108140
	speed: 0.0768s/iter; left time: 3595.2865s
	iters: 200, epoch: 1 | loss: 0.7787324
	speed: 0.0567s/iter; left time: 2648.3088s
	iters: 300, epoch: 1 | loss: 0.3682724
	speed: 0.0570s/iter; left time: 2656.6220s
	iters: 400, epoch: 1 | loss: 0.4675431
	speed: 0.0588s/iter; left time: 2732.0983s
Epoch: 1 cost time: 28.998042345046997
Epoch: 1, Steps: 469 | Train Loss: 0.978 Vali Loss: 0.411 Vali Acc: 0.857 Test Loss: 0.411 Test Acc: 0.857
Validation loss decreased (inf --> -0.857343).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2544545
	speed: 0.2464s/iter; left time: 11417.0896s
	iters: 200, epoch: 2 | loss: 0.1121710
	speed: 0.0621s/iter; left time: 2869.2450s
	iters: 300, epoch: 2 | loss: 0.0900532
	speed: 0.0615s/iter; left time: 2837.8161s
	iters: 400, epoch: 2 | loss: 0.1314623
	speed: 0.0578s/iter; left time: 2659.4638s
Epoch: 2 cost time: 28.355677127838135
Epoch: 2, Steps: 469 | Train Loss: 0.220 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.857343 --> -0.940821).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0402678
	speed: 0.2592s/iter; left time: 11886.8520s
	iters: 200, epoch: 3 | loss: 0.2360494
	speed: 0.0521s/iter; left time: 2386.3770s
	iters: 300, epoch: 3 | loss: 0.2247506
	speed: 0.0488s/iter; left time: 2230.1766s
	iters: 400, epoch: 3 | loss: 0.2198455
	speed: 0.0519s/iter; left time: 2362.9863s
Epoch: 3 cost time: 25.906617879867554
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1360818
	speed: 0.2499s/iter; left time: 11344.9421s
	iters: 200, epoch: 4 | loss: 0.0057558
	speed: 0.0604s/iter; left time: 2733.6050s
	iters: 300, epoch: 4 | loss: 0.0984459
	speed: 0.0592s/iter; left time: 2673.9749s
	iters: 400, epoch: 4 | loss: 0.1203946
	speed: 0.0592s/iter; left time: 2671.1500s
Epoch: 4 cost time: 27.928663969039917
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.940821 --> -0.951971).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4641851
	speed: 0.2548s/iter; left time: 11447.2905s
	iters: 200, epoch: 5 | loss: 0.0103938
	speed: 0.0596s/iter; left time: 2670.5426s
	iters: 300, epoch: 5 | loss: 0.0056456
	speed: 0.0593s/iter; left time: 2653.6598s
	iters: 400, epoch: 5 | loss: 0.0160063
	speed: 0.0600s/iter; left time: 2678.1395s
Epoch: 5 cost time: 28.805545330047607
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951971 --> -0.952257).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0068543
	speed: 0.2734s/iter; left time: 12156.4541s
	iters: 200, epoch: 6 | loss: 0.0240909
	speed: 0.0630s/iter; left time: 2795.5831s
	iters: 300, epoch: 6 | loss: 0.0917055
	speed: 0.0687s/iter; left time: 3038.6548s
	iters: 400, epoch: 6 | loss: 0.0032865
	speed: 0.0628s/iter; left time: 2773.1535s
Epoch: 6 cost time: 30.363631010055542
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.952257 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0139371
	speed: 0.2772s/iter; left time: 12191.2277s
	iters: 200, epoch: 7 | loss: 0.0035846
	speed: 0.0593s/iter; left time: 2603.0940s
	iters: 300, epoch: 7 | loss: 0.0115708
	speed: 0.0615s/iter; left time: 2694.5319s
	iters: 400, epoch: 7 | loss: 0.0091506
	speed: 0.0614s/iter; left time: 2682.4875s
Epoch: 7 cost time: 29.106770515441895
Epoch: 7, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0098433
	speed: 0.2634s/iter; left time: 11462.6542s
	iters: 200, epoch: 8 | loss: 0.0393740
	speed: 0.0591s/iter; left time: 2565.5023s
	iters: 300, epoch: 8 | loss: 0.0088055
	speed: 0.0562s/iter; left time: 2433.6237s
	iters: 400, epoch: 8 | loss: 0.0028006
	speed: 0.0574s/iter; left time: 2479.6078s
Epoch: 8 cost time: 27.346259832382202
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2238927
	speed: 0.2511s/iter; left time: 10808.6237s
	iters: 200, epoch: 9 | loss: 0.0016849
	speed: 0.0646s/iter; left time: 2776.4098s
	iters: 300, epoch: 9 | loss: 0.0093303
	speed: 0.0616s/iter; left time: 2640.1614s
	iters: 400, epoch: 9 | loss: 0.0066811
	speed: 0.0588s/iter; left time: 2513.1381s
Epoch: 9 cost time: 28.460453033447266
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.943 Test Loss: 0.264 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0145600
	speed: 0.2482s/iter; left time: 10568.4621s
	iters: 200, epoch: 10 | loss: 0.0122347
	speed: 0.0586s/iter; left time: 2487.4976s
	iters: 300, epoch: 10 | loss: 0.4960889
	speed: 0.0608s/iter; left time: 2574.5963s
	iters: 400, epoch: 10 | loss: 0.0023997
	speed: 0.0605s/iter; left time: 2556.7646s
Epoch: 10 cost time: 28.38823127746582
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0320529
	speed: 0.2465s/iter; left time: 10381.2680s
	iters: 200, epoch: 11 | loss: 0.2166909
	speed: 0.0564s/iter; left time: 2370.0660s
	iters: 300, epoch: 11 | loss: 0.2126858
	speed: 0.0568s/iter; left time: 2381.0696s
	iters: 400, epoch: 11 | loss: 0.0051496
	speed: 0.0588s/iter; left time: 2456.5841s
Epoch: 11 cost time: 27.517009019851685
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0036083
	speed: 0.2671s/iter; left time: 11122.3107s
	iters: 200, epoch: 12 | loss: 0.0031225
	speed: 0.0638s/iter; left time: 2651.3343s
	iters: 300, epoch: 12 | loss: 0.0049063
	speed: 0.0567s/iter; left time: 2349.2802s
	iters: 400, epoch: 12 | loss: 0.3694754
	speed: 0.0562s/iter; left time: 2323.0436s
Epoch: 12 cost time: 28.82625389099121
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.963406 --> -0.971125).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0063663
	speed: 0.2573s/iter; left time: 10593.5059s
	iters: 200, epoch: 13 | loss: 0.0088738
	speed: 0.0628s/iter; left time: 2581.0271s
	iters: 300, epoch: 13 | loss: 0.0116701
	speed: 0.0589s/iter; left time: 2412.1371s
	iters: 400, epoch: 13 | loss: 0.0044022
	speed: 0.0570s/iter; left time: 2329.4706s
Epoch: 13 cost time: 28.312986373901367
Epoch: 13, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0923371
	speed: 0.2561s/iter; left time: 10423.4484s
	iters: 200, epoch: 14 | loss: 0.0508996
	speed: 0.0596s/iter; left time: 2419.9259s
	iters: 300, epoch: 14 | loss: 0.0347458
	speed: 0.0592s/iter; left time: 2397.3776s
	iters: 400, epoch: 14 | loss: 0.2695015
	speed: 0.0621s/iter; left time: 2508.7166s
Epoch: 14 cost time: 28.53979182243347
Epoch: 14, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0112942
	speed: 0.2636s/iter; left time: 10605.2803s
	iters: 200, epoch: 15 | loss: 0.2808967
	speed: 0.0680s/iter; left time: 2730.6995s
	iters: 300, epoch: 15 | loss: 0.0083211
	speed: 0.0645s/iter; left time: 2583.8219s
	iters: 400, epoch: 15 | loss: 0.0945157
	speed: 0.0628s/iter; left time: 2508.2159s
Epoch: 15 cost time: 30.740251779556274
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.975128).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0103596
	speed: 0.2808s/iter; left time: 11165.1026s
	iters: 200, epoch: 16 | loss: 0.3161027
	speed: 0.0670s/iter; left time: 2656.3947s
	iters: 300, epoch: 16 | loss: 0.0013598
	speed: 0.0647s/iter; left time: 2560.2517s
	iters: 400, epoch: 16 | loss: 0.3483115
	speed: 0.0674s/iter; left time: 2659.4739s
Epoch: 16 cost time: 30.941375017166138
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1432773
	speed: 0.2747s/iter; left time: 10793.7195s
	iters: 200, epoch: 17 | loss: 0.0106781
	speed: 0.0638s/iter; left time: 2500.2074s
	iters: 300, epoch: 17 | loss: 0.2154141
	speed: 0.0660s/iter; left time: 2580.2510s
	iters: 400, epoch: 17 | loss: 0.0007047
	speed: 0.0639s/iter; left time: 2490.3912s
Epoch: 17 cost time: 30.36255145072937
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0222662
	speed: 0.2690s/iter; left time: 10445.8322s
	iters: 200, epoch: 18 | loss: 0.0165468
	speed: 0.0639s/iter; left time: 2475.8638s
	iters: 300, epoch: 18 | loss: 0.0045209
	speed: 0.0660s/iter; left time: 2547.6893s
	iters: 400, epoch: 18 | loss: 0.0037624
	speed: 0.0597s/iter; left time: 2298.4561s
Epoch: 18 cost time: 29.796294689178467
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0102835
	speed: 0.2566s/iter; left time: 9844.6364s
	iters: 200, epoch: 19 | loss: 0.0021910
	speed: 0.0583s/iter; left time: 2230.5907s
	iters: 300, epoch: 19 | loss: 0.0051703
	speed: 0.0557s/iter; left time: 2124.1154s
	iters: 400, epoch: 19 | loss: 0.0249049
	speed: 0.0567s/iter; left time: 2156.4125s
Epoch: 19 cost time: 27.55719232559204
Epoch: 19, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.961 Test Loss: 0.206 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0036862
	speed: 0.2479s/iter; left time: 9393.6875s
	iters: 200, epoch: 20 | loss: 0.1293070
	speed: 0.0645s/iter; left time: 2436.0246s
	iters: 300, epoch: 20 | loss: 0.0029474
	speed: 0.0587s/iter; left time: 2212.7105s
	iters: 400, epoch: 20 | loss: 0.0013129
	speed: 0.0588s/iter; left time: 2210.3036s
Epoch: 20 cost time: 28.56193232536316
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0051669
	speed: 0.2596s/iter; left time: 9715.0320s
	iters: 200, epoch: 21 | loss: 0.2860211
	speed: 0.0623s/iter; left time: 2323.2750s
	iters: 300, epoch: 21 | loss: 0.0058628
	speed: 0.0595s/iter; left time: 2213.1612s
	iters: 400, epoch: 21 | loss: 0.0029754
	speed: 0.0568s/iter; left time: 2107.1251s
Epoch: 21 cost time: 28.19548988342285
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1045505
	speed: 0.2561s/iter; left time: 9462.1097s
	iters: 200, epoch: 22 | loss: 0.0434825
	speed: 0.0568s/iter; left time: 2092.3622s
	iters: 300, epoch: 22 | loss: 0.0072048
	speed: 0.0570s/iter; left time: 2096.1856s
	iters: 400, epoch: 22 | loss: 0.0035422
	speed: 0.0576s/iter; left time: 2109.3371s
Epoch: 22 cost time: 28.006227254867554
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0059496
	speed: 0.2532s/iter; left time: 9237.6898s
	iters: 200, epoch: 23 | loss: 0.0006947
	speed: 0.0594s/iter; left time: 2160.9271s
	iters: 300, epoch: 23 | loss: 0.0093925
	speed: 0.0567s/iter; left time: 2057.7031s
	iters: 400, epoch: 23 | loss: 0.0017545
	speed: 0.0557s/iter; left time: 2014.3674s
Epoch: 23 cost time: 27.30411195755005
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0907726
	speed: 0.2490s/iter; left time: 8968.2577s
	iters: 200, epoch: 24 | loss: 0.0053451
	speed: 0.0575s/iter; left time: 2063.4498s
	iters: 300, epoch: 24 | loss: 0.0018435
	speed: 0.0581s/iter; left time: 2081.2375s
	iters: 400, epoch: 24 | loss: 0.0016794
	speed: 0.0579s/iter; left time: 2068.9679s
Epoch: 24 cost time: 27.45342183113098
Epoch: 24, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0011584
	speed: 0.2709s/iter; left time: 9630.3809s
	iters: 200, epoch: 25 | loss: 0.0152437
	speed: 0.0623s/iter; left time: 2208.1452s
	iters: 300, epoch: 25 | loss: 0.0007497
	speed: 0.0596s/iter; left time: 2106.0780s
	iters: 400, epoch: 25 | loss: 0.0011698
	speed: 0.0589s/iter; left time: 2075.0820s
Epoch: 25 cost time: 29.15561318397522
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.975128 --> -0.976271).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1643471
	speed: 0.2529s/iter; left time: 8869.3648s
	iters: 200, epoch: 26 | loss: 0.0012808
	speed: 0.0606s/iter; left time: 2118.5088s
	iters: 300, epoch: 26 | loss: 0.0025867
	speed: 0.0591s/iter; left time: 2062.0931s
	iters: 400, epoch: 26 | loss: 0.0015220
	speed: 0.0593s/iter; left time: 2062.0890s
Epoch: 26 cost time: 28.434082984924316
Epoch: 26, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0029237
	speed: 0.2742s/iter; left time: 9488.0642s
	iters: 200, epoch: 27 | loss: 0.0016912
	speed: 0.0603s/iter; left time: 2081.4276s
	iters: 300, epoch: 27 | loss: 0.0009987
	speed: 0.0600s/iter; left time: 2062.9399s
	iters: 400, epoch: 27 | loss: 0.0064208
	speed: 0.0571s/iter; left time: 1959.3045s
Epoch: 27 cost time: 28.652493476867676
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0333716
	speed: 0.2583s/iter; left time: 8817.5113s
	iters: 200, epoch: 28 | loss: 0.0664869
	speed: 0.0588s/iter; left time: 2001.5201s
	iters: 300, epoch: 28 | loss: 0.0042639
	speed: 0.0591s/iter; left time: 2005.8377s
	iters: 400, epoch: 28 | loss: 0.0003312
	speed: 0.0555s/iter; left time: 1879.4992s
Epoch: 28 cost time: 27.49021053314209
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0026470
	speed: 0.2516s/iter; left time: 8470.2397s
	iters: 200, epoch: 29 | loss: 0.0018282
	speed: 0.0594s/iter; left time: 1994.6038s
	iters: 300, epoch: 29 | loss: 0.2241120
	speed: 0.0563s/iter; left time: 1885.6125s
	iters: 400, epoch: 29 | loss: 0.0051862
	speed: 0.0584s/iter; left time: 1949.8503s
Epoch: 29 cost time: 28.238922834396362
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0007384
	speed: 0.2644s/iter; left time: 8778.8980s
	iters: 200, epoch: 30 | loss: 0.0016954
	speed: 0.0639s/iter; left time: 2116.0426s
	iters: 300, epoch: 30 | loss: 0.0016061
	speed: 0.0590s/iter; left time: 1947.7239s
	iters: 400, epoch: 30 | loss: 0.0031896
	speed: 0.0541s/iter; left time: 1780.3904s
Epoch: 30 cost time: 28.161234855651855
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0215931
	speed: 0.2496s/iter; left time: 8171.2265s
	iters: 200, epoch: 31 | loss: 0.0027207
	speed: 0.0568s/iter; left time: 1854.3313s
	iters: 300, epoch: 31 | loss: 0.0064185
	speed: 0.0564s/iter; left time: 1835.1175s
	iters: 400, epoch: 31 | loss: 0.0036782
	speed: 0.0586s/iter; left time: 1899.5709s
Epoch: 31 cost time: 27.233607053756714
Epoch: 31, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0083205
	speed: 0.2403s/iter; left time: 7752.4028s
	iters: 200, epoch: 32 | loss: 0.0008023
	speed: 0.0587s/iter; left time: 1887.6610s
	iters: 300, epoch: 32 | loss: 0.0008518
	speed: 0.0596s/iter; left time: 1911.4728s
	iters: 400, epoch: 32 | loss: 0.0010645
	speed: 0.0613s/iter; left time: 1959.0200s
Epoch: 32 cost time: 28.224398612976074
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0002918
	speed: 0.2594s/iter; left time: 8245.5546s
	iters: 200, epoch: 33 | loss: 0.1683699
	speed: 0.0611s/iter; left time: 1936.7679s
	iters: 300, epoch: 33 | loss: 0.0451442
	speed: 0.0597s/iter; left time: 1885.2932s
	iters: 400, epoch: 33 | loss: 0.0004599
	speed: 0.0586s/iter; left time: 1844.7735s
Epoch: 33 cost time: 28.601731777191162
Epoch: 33, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2468603
	speed: 0.2526s/iter; left time: 7911.4977s
	iters: 200, epoch: 34 | loss: 0.0002811
	speed: 0.0601s/iter; left time: 1875.7838s
	iters: 300, epoch: 34 | loss: 0.0003805
	speed: 0.0576s/iter; left time: 1793.7597s
	iters: 400, epoch: 34 | loss: 0.0044880
	speed: 0.0592s/iter; left time: 1835.5373s
Epoch: 34 cost time: 27.78815269470215
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0025697
	speed: 0.2718s/iter; left time: 8387.0000s
	iters: 200, epoch: 35 | loss: 0.0042949
	speed: 0.0595s/iter; left time: 1829.5172s
	iters: 300, epoch: 35 | loss: 0.0902487
	speed: 0.0602s/iter; left time: 1845.5666s
	iters: 400, epoch: 35 | loss: 0.0960338
	speed: 0.0655s/iter; left time: 2001.8156s
Epoch: 35 cost time: 29.29473114013672
Epoch: 35, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 240730
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3388674
	speed: 0.0767s/iter; left time: 3589.3627s
	iters: 200, epoch: 1 | loss: 0.7070657
	speed: 0.0612s/iter; left time: 2859.1242s
	iters: 300, epoch: 1 | loss: 0.8468528
	speed: 0.0597s/iter; left time: 2782.9782s
	iters: 400, epoch: 1 | loss: 0.4172583
	speed: 0.0614s/iter; left time: 2857.4541s
Epoch: 1 cost time: 30.178380012512207
Epoch: 1, Steps: 469 | Train Loss: 0.944 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
Validation loss decreased (inf --> -0.872494).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2358451
	speed: 0.2661s/iter; left time: 12327.1008s
	iters: 200, epoch: 2 | loss: 0.1130092
	speed: 0.0566s/iter; left time: 2614.5762s
	iters: 300, epoch: 2 | loss: 0.4075632
	speed: 0.0572s/iter; left time: 2637.9672s
	iters: 400, epoch: 2 | loss: 0.0529057
	speed: 0.0510s/iter; left time: 2345.5140s
Epoch: 2 cost time: 26.217991828918457
Epoch: 2, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
Validation loss decreased (-0.872494 --> -0.918808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0448220
	speed: 0.2533s/iter; left time: 11618.1018s
	iters: 200, epoch: 3 | loss: 0.1366480
	speed: 0.0585s/iter; left time: 2674.8725s
	iters: 300, epoch: 3 | loss: 0.3030371
	speed: 0.0574s/iter; left time: 2620.9937s
	iters: 400, epoch: 3 | loss: 0.0689295
	speed: 0.0587s/iter; left time: 2672.9067s
Epoch: 3 cost time: 27.336352586746216
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (-0.918808 --> -0.950256).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0109908
	speed: 0.2505s/iter; left time: 11369.7400s
	iters: 200, epoch: 4 | loss: 0.0095777
	speed: 0.0558s/iter; left time: 2528.0579s
	iters: 300, epoch: 4 | loss: 0.0171155
	speed: 0.0570s/iter; left time: 2578.2636s
	iters: 400, epoch: 4 | loss: 0.0132518
	speed: 0.0603s/iter; left time: 2718.1132s
Epoch: 4 cost time: 28.03974938392639
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.950256 --> -0.953686).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0986929
	speed: 0.2601s/iter; left time: 11684.1902s
	iters: 200, epoch: 5 | loss: 0.0129454
	speed: 0.0572s/iter; left time: 2565.4752s
	iters: 300, epoch: 5 | loss: 0.0078828
	speed: 0.0587s/iter; left time: 2624.7652s
	iters: 400, epoch: 5 | loss: 0.0933113
	speed: 0.0574s/iter; left time: 2562.9857s
Epoch: 5 cost time: 27.825345993041992
Epoch: 5, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
Validation loss decreased (-0.953686 --> -0.955687).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0388842
	speed: 0.2562s/iter; left time: 11387.8724s
	iters: 200, epoch: 6 | loss: 0.0305260
	speed: 0.0590s/iter; left time: 2615.7011s
	iters: 300, epoch: 6 | loss: 0.0086732
	speed: 0.0589s/iter; left time: 2608.4663s
	iters: 400, epoch: 6 | loss: 0.0934660
	speed: 0.0541s/iter; left time: 2387.0706s
Epoch: 6 cost time: 26.903303623199463
Epoch: 6, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.955687 --> -0.958546).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0783891
	speed: 0.2347s/iter; left time: 10324.6645s
	iters: 200, epoch: 7 | loss: 0.0139618
	speed: 0.0617s/iter; left time: 2709.7043s
	iters: 300, epoch: 7 | loss: 0.0287622
	speed: 0.0584s/iter; left time: 2556.1486s
	iters: 400, epoch: 7 | loss: 0.0850825
	speed: 0.0610s/iter; left time: 2666.8388s
Epoch: 7 cost time: 28.280425310134888
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0296976
	speed: 0.2563s/iter; left time: 11151.7824s
	iters: 200, epoch: 8 | loss: 0.1577062
	speed: 0.0567s/iter; left time: 2463.4162s
	iters: 300, epoch: 8 | loss: 0.1133462
	speed: 0.0556s/iter; left time: 2409.8989s
	iters: 400, epoch: 8 | loss: 0.0076110
	speed: 0.0593s/iter; left time: 2564.3344s
Epoch: 8 cost time: 27.298815965652466
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.958546 --> -0.964264).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3336017
	speed: 0.2548s/iter; left time: 10968.1898s
	iters: 200, epoch: 9 | loss: 0.0793867
	speed: 0.0585s/iter; left time: 2510.7849s
	iters: 300, epoch: 9 | loss: 0.0107495
	speed: 0.0610s/iter; left time: 2614.3868s
	iters: 400, epoch: 9 | loss: 0.0661429
	speed: 0.0615s/iter; left time: 2630.5814s
Epoch: 9 cost time: 28.528031587600708
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3690856
	speed: 0.2678s/iter; left time: 11402.3279s
	iters: 200, epoch: 10 | loss: 0.0632368
	speed: 0.0595s/iter; left time: 2527.8043s
	iters: 300, epoch: 10 | loss: 0.0114190
	speed: 0.0612s/iter; left time: 2595.6879s
	iters: 400, epoch: 10 | loss: 0.0144268
	speed: 0.0587s/iter; left time: 2483.1595s
Epoch: 10 cost time: 28.330040216445923
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0368040
	speed: 0.2763s/iter; left time: 11636.5764s
	iters: 200, epoch: 11 | loss: 0.0032859
	speed: 0.0625s/iter; left time: 2625.3436s
	iters: 300, epoch: 11 | loss: 0.0190331
	speed: 0.0603s/iter; left time: 2527.6674s
	iters: 400, epoch: 11 | loss: 0.0123470
	speed: 0.0615s/iter; left time: 2571.1831s
Epoch: 11 cost time: 29.33635711669922
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2838095
	speed: 0.2499s/iter; left time: 10406.5303s
	iters: 200, epoch: 12 | loss: 0.2741374
	speed: 0.0575s/iter; left time: 2389.3676s
	iters: 300, epoch: 12 | loss: 0.0632649
	speed: 0.0562s/iter; left time: 2328.4304s
	iters: 400, epoch: 12 | loss: 0.0345506
	speed: 0.0548s/iter; left time: 2266.1527s
Epoch: 12 cost time: 27.20248794555664
Epoch: 12, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3398933
	speed: 0.2387s/iter; left time: 9826.9312s
	iters: 200, epoch: 13 | loss: 0.0096919
	speed: 0.0580s/iter; left time: 2383.9389s
	iters: 300, epoch: 13 | loss: 0.2010168
	speed: 0.0590s/iter; left time: 2418.6366s
	iters: 400, epoch: 13 | loss: 0.0397693
	speed: 0.0572s/iter; left time: 2339.0408s
Epoch: 13 cost time: 27.293413877487183
Epoch: 13, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0158277
	speed: 0.2494s/iter; left time: 10152.7260s
	iters: 200, epoch: 14 | loss: 0.0065065
	speed: 0.0561s/iter; left time: 2275.9439s
	iters: 300, epoch: 14 | loss: 0.0167582
	speed: 0.0590s/iter; left time: 2390.9275s
	iters: 400, epoch: 14 | loss: 0.0037938
	speed: 0.0580s/iter; left time: 2344.8683s
Epoch: 14 cost time: 27.40878939628601
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0068660
	speed: 0.2463s/iter; left time: 9907.9639s
	iters: 200, epoch: 15 | loss: 0.0175739
	speed: 0.0538s/iter; left time: 2158.7927s
	iters: 300, epoch: 15 | loss: 0.0058359
	speed: 0.0545s/iter; left time: 2182.3135s
	iters: 400, epoch: 15 | loss: 0.0044632
	speed: 0.0571s/iter; left time: 2279.3213s
Epoch: 15 cost time: 26.396028757095337
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.964264 --> -0.973698).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0026845
	speed: 0.2549s/iter; left time: 10134.4970s
	iters: 200, epoch: 16 | loss: 0.0016956
	speed: 0.0607s/iter; left time: 2408.1042s
	iters: 300, epoch: 16 | loss: 0.0064534
	speed: 0.0609s/iter; left time: 2408.2290s
	iters: 400, epoch: 16 | loss: 0.0559580
	speed: 0.0621s/iter; left time: 2451.5098s
Epoch: 16 cost time: 29.501452922821045
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1750684
	speed: 0.2633s/iter; left time: 10348.5351s
	iters: 200, epoch: 17 | loss: 0.0030198
	speed: 0.0600s/iter; left time: 2353.6702s
	iters: 300, epoch: 17 | loss: 0.0009140
	speed: 0.0560s/iter; left time: 2188.0312s
	iters: 400, epoch: 17 | loss: 0.1378841
	speed: 0.0576s/iter; left time: 2246.4081s
Epoch: 17 cost time: 28.18149709701538
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0020646
	speed: 0.2678s/iter; left time: 10396.5802s
	iters: 200, epoch: 18 | loss: 0.0026155
	speed: 0.0628s/iter; left time: 2431.2328s
	iters: 300, epoch: 18 | loss: 0.0006149
	speed: 0.0613s/iter; left time: 2367.4147s
	iters: 400, epoch: 18 | loss: 0.0023992
	speed: 0.0585s/iter; left time: 2254.5611s
Epoch: 18 cost time: 29.349940061569214
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0024907
	speed: 0.2830s/iter; left time: 10856.7305s
	iters: 200, epoch: 19 | loss: 0.0106900
	speed: 0.0623s/iter; left time: 2382.3942s
	iters: 300, epoch: 19 | loss: 0.0019220
	speed: 0.0616s/iter; left time: 2349.0554s
	iters: 400, epoch: 19 | loss: 0.0037036
	speed: 0.0620s/iter; left time: 2359.1815s
Epoch: 19 cost time: 29.47080111503601
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0098801
	speed: 0.2816s/iter; left time: 10668.8780s
	iters: 200, epoch: 20 | loss: 0.0066975
	speed: 0.0646s/iter; left time: 2439.4631s
	iters: 300, epoch: 20 | loss: 0.0012460
	speed: 0.0655s/iter; left time: 2470.1096s
	iters: 400, epoch: 20 | loss: 0.0049951
	speed: 0.0640s/iter; left time: 2407.1367s
Epoch: 20 cost time: 30.898111820220947
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4031084
	speed: 0.2796s/iter; left time: 10463.4015s
	iters: 200, epoch: 21 | loss: 0.0810888
	speed: 0.0627s/iter; left time: 2340.1249s
	iters: 300, epoch: 21 | loss: 0.0679528
	speed: 0.0617s/iter; left time: 2297.4570s
	iters: 400, epoch: 21 | loss: 0.0015169
	speed: 0.0595s/iter; left time: 2208.1030s
Epoch: 21 cost time: 29.2679123878479
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0065271
	speed: 0.2486s/iter; left time: 9186.5053s
	iters: 200, epoch: 22 | loss: 0.0009607
	speed: 0.0617s/iter; left time: 2273.0691s
	iters: 300, epoch: 22 | loss: 0.0068887
	speed: 0.0590s/iter; left time: 2167.5924s
	iters: 400, epoch: 22 | loss: 0.0029864
	speed: 0.0622s/iter; left time: 2278.5875s
Epoch: 22 cost time: 28.892608642578125
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0041560
	speed: 0.2515s/iter; left time: 9173.6528s
	iters: 200, epoch: 23 | loss: 0.0120397
	speed: 0.0597s/iter; left time: 2170.3319s
	iters: 300, epoch: 23 | loss: 0.0522717
	speed: 0.0585s/iter; left time: 2123.4267s
	iters: 400, epoch: 23 | loss: 0.0070890
	speed: 0.0593s/iter; left time: 2146.8037s
Epoch: 23 cost time: 27.84675693511963
Epoch: 23, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0461868
	speed: 0.2539s/iter; left time: 9143.3477s
	iters: 200, epoch: 24 | loss: 0.0009904
	speed: 0.0579s/iter; left time: 2078.3873s
	iters: 300, epoch: 24 | loss: 0.0720790
	speed: 0.0563s/iter; left time: 2016.9691s
	iters: 400, epoch: 24 | loss: 0.0033538
	speed: 0.0599s/iter; left time: 2138.3412s
Epoch: 24 cost time: 27.161536931991577
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0015596
	speed: 0.2321s/iter; left time: 8249.1565s
	iters: 200, epoch: 25 | loss: 0.0542916
	speed: 0.0555s/iter; left time: 1965.7636s
	iters: 300, epoch: 25 | loss: 0.0069846
	speed: 0.0539s/iter; left time: 1904.9224s
	iters: 400, epoch: 25 | loss: 0.0032847
	speed: 0.0541s/iter; left time: 1906.5299s
Epoch: 25 cost time: 26.83026671409607
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9736992567181246
model parameter : 240634
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4685789
	speed: 0.0734s/iter; left time: 3435.3459s
	iters: 200, epoch: 1 | loss: 0.8281102
	speed: 0.0593s/iter; left time: 2770.7863s
	iters: 300, epoch: 1 | loss: 0.5113117
	speed: 0.0605s/iter; left time: 2821.0421s
	iters: 400, epoch: 1 | loss: 0.2463238
	speed: 0.0618s/iter; left time: 2874.9386s
Epoch: 1 cost time: 29.668572425842285
Epoch: 1, Steps: 469 | Train Loss: 0.932 Vali Loss: 0.383 Vali Acc: 0.890 Test Loss: 0.383 Test Acc: 0.890
Validation loss decreased (inf --> -0.889647).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2843640
	speed: 0.2532s/iter; left time: 11731.2613s
	iters: 200, epoch: 2 | loss: 0.0534330
	speed: 0.0642s/iter; left time: 2970.2268s
	iters: 300, epoch: 2 | loss: 0.2991486
	speed: 0.0571s/iter; left time: 2634.2892s
	iters: 400, epoch: 2 | loss: 0.4495659
	speed: 0.0600s/iter; left time: 2760.8653s
Epoch: 2 cost time: 28.813913106918335
Epoch: 2, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
Validation loss decreased (-0.889647 --> -0.925384).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1273681
	speed: 0.2823s/iter; left time: 12949.1607s
	iters: 200, epoch: 3 | loss: 0.0651518
	speed: 0.0627s/iter; left time: 2867.9285s
	iters: 300, epoch: 3 | loss: 0.1090521
	speed: 0.0651s/iter; left time: 2974.1512s
	iters: 400, epoch: 3 | loss: 0.0215560
	speed: 0.0577s/iter; left time: 2631.1391s
Epoch: 3 cost time: 29.465312719345093
Epoch: 3, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.925384 --> -0.937105).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0623684
	speed: 0.2470s/iter; left time: 11214.0647s
	iters: 200, epoch: 4 | loss: 0.0546408
	speed: 0.0689s/iter; left time: 3119.7033s
	iters: 300, epoch: 4 | loss: 0.5270510
	speed: 0.0634s/iter; left time: 2866.0674s
	iters: 400, epoch: 4 | loss: 0.0774017
	speed: 0.0619s/iter; left time: 2791.6144s
Epoch: 4 cost time: 30.591527462005615
Epoch: 4, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
Validation loss decreased (-0.937105 --> -0.942537).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0157229
	speed: 0.2733s/iter; left time: 12280.0151s
	iters: 200, epoch: 5 | loss: 0.0200262
	speed: 0.0610s/iter; left time: 2735.9070s
	iters: 300, epoch: 5 | loss: 0.1969665
	speed: 0.0601s/iter; left time: 2688.8034s
	iters: 400, epoch: 5 | loss: 0.0121571
	speed: 0.0559s/iter; left time: 2494.1555s
Epoch: 5 cost time: 28.25655460357666
Epoch: 5, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
Validation loss decreased (-0.942537 --> -0.957975).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0137845
	speed: 0.2450s/iter; left time: 10890.2179s
	iters: 200, epoch: 6 | loss: 0.0422585
	speed: 0.0642s/iter; left time: 2845.6929s
	iters: 300, epoch: 6 | loss: 0.3422816
	speed: 0.0611s/iter; left time: 2704.0210s
	iters: 400, epoch: 6 | loss: 0.0087841
	speed: 0.0612s/iter; left time: 2701.5459s
Epoch: 6 cost time: 29.124853372573853
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
Validation loss decreased (-0.957975 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0098345
	speed: 0.2564s/iter; left time: 11280.1963s
	iters: 200, epoch: 7 | loss: 0.0500609
	speed: 0.0566s/iter; left time: 2485.5334s
	iters: 300, epoch: 7 | loss: 0.0400894
	speed: 0.0549s/iter; left time: 2404.8064s
	iters: 400, epoch: 7 | loss: 0.3027765
	speed: 0.0562s/iter; left time: 2457.1923s
Epoch: 7 cost time: 27.36061978340149
Epoch: 7, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.963406 --> -0.967409).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0341765
	speed: 0.2488s/iter; left time: 10827.5314s
	iters: 200, epoch: 8 | loss: 0.0161111
	speed: 0.0592s/iter; left time: 2569.7353s
	iters: 300, epoch: 8 | loss: 0.0588084
	speed: 0.0578s/iter; left time: 2503.4523s
	iters: 400, epoch: 8 | loss: 0.0014375
	speed: 0.0581s/iter; left time: 2511.0798s
Epoch: 8 cost time: 27.734359979629517
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.967409 --> -0.971697).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0175914
	speed: 0.2563s/iter; left time: 11032.8464s
	iters: 200, epoch: 9 | loss: 0.1455759
	speed: 0.0610s/iter; left time: 2618.1587s
	iters: 300, epoch: 9 | loss: 0.0095666
	speed: 0.0604s/iter; left time: 2589.2052s
	iters: 400, epoch: 9 | loss: 0.4177187
	speed: 0.0557s/iter; left time: 2383.1103s
Epoch: 9 cost time: 28.070923328399658
Epoch: 9, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0075255
	speed: 0.2446s/iter; left time: 10415.7223s
	iters: 200, epoch: 10 | loss: 0.3559631
	speed: 0.0557s/iter; left time: 2365.1025s
	iters: 300, epoch: 10 | loss: 0.3548814
	speed: 0.0575s/iter; left time: 2435.4096s
	iters: 400, epoch: 10 | loss: 0.0045333
	speed: 0.0567s/iter; left time: 2399.3629s
Epoch: 10 cost time: 26.681604385375977
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0133477
	speed: 0.2469s/iter; left time: 10397.1638s
	iters: 200, epoch: 11 | loss: 0.0044804
	speed: 0.0575s/iter; left time: 2415.5634s
	iters: 300, epoch: 11 | loss: 0.0024621
	speed: 0.0577s/iter; left time: 2418.3396s
	iters: 400, epoch: 11 | loss: 0.0096997
	speed: 0.0590s/iter; left time: 2468.5983s
Epoch: 11 cost time: 27.447136163711548
Epoch: 11, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972841).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0178486
	speed: 0.2504s/iter; left time: 10426.3556s
	iters: 200, epoch: 12 | loss: 0.0093753
	speed: 0.0554s/iter; left time: 2302.7608s
	iters: 300, epoch: 12 | loss: 0.0061352
	speed: 0.0586s/iter; left time: 2429.5801s
	iters: 400, epoch: 12 | loss: 0.0151413
	speed: 0.0584s/iter; left time: 2415.1869s
Epoch: 12 cost time: 27.619545459747314
Epoch: 12, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0260251
	speed: 0.2609s/iter; left time: 10743.6656s
	iters: 200, epoch: 13 | loss: 0.0531375
	speed: 0.0611s/iter; left time: 2509.8521s
	iters: 300, epoch: 13 | loss: 0.0950695
	speed: 0.0608s/iter; left time: 2490.3363s
	iters: 400, epoch: 13 | loss: 0.0033619
	speed: 0.0612s/iter; left time: 2499.6840s
Epoch: 13 cost time: 29.095492601394653
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.972841 --> -0.975414).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0032904
	speed: 0.2831s/iter; left time: 11523.1865s
	iters: 200, epoch: 14 | loss: 0.0048081
	speed: 0.0607s/iter; left time: 2465.1818s
	iters: 300, epoch: 14 | loss: 0.0152739
	speed: 0.0599s/iter; left time: 2425.9632s
	iters: 400, epoch: 14 | loss: 0.0133786
	speed: 0.0610s/iter; left time: 2464.7203s
Epoch: 14 cost time: 28.75889563560486
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0352021
	speed: 0.2593s/iter; left time: 10433.8156s
	iters: 200, epoch: 15 | loss: 0.0049588
	speed: 0.0593s/iter; left time: 2381.7094s
	iters: 300, epoch: 15 | loss: 0.0138963
	speed: 0.0594s/iter; left time: 2376.3457s
	iters: 400, epoch: 15 | loss: 0.0962448
	speed: 0.0556s/iter; left time: 2219.3170s
Epoch: 15 cost time: 27.481223106384277
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0214481
	speed: 0.2474s/iter; left time: 9837.5823s
	iters: 200, epoch: 16 | loss: 0.0018016
	speed: 0.0569s/iter; left time: 2255.9809s
	iters: 300, epoch: 16 | loss: 0.0014090
	speed: 0.0572s/iter; left time: 2264.0838s
	iters: 400, epoch: 16 | loss: 0.0690899
	speed: 0.0562s/iter; left time: 2217.1660s
Epoch: 16 cost time: 26.870672464370728
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.240 Vali Acc: 0.949 Test Loss: 0.240 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0037752
	speed: 0.2412s/iter; left time: 9479.4772s
	iters: 200, epoch: 17 | loss: 0.0011572
	speed: 0.0550s/iter; left time: 2157.0704s
	iters: 300, epoch: 17 | loss: 0.0037000
	speed: 0.0562s/iter; left time: 2196.1595s
	iters: 400, epoch: 17 | loss: 0.0040011
	speed: 0.0559s/iter; left time: 2178.9599s
Epoch: 17 cost time: 26.864102602005005
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.947 Test Loss: 0.182 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0077350
	speed: 0.2534s/iter; left time: 9838.0016s
	iters: 200, epoch: 18 | loss: 0.3045228
	speed: 0.0575s/iter; left time: 2226.6096s
	iters: 300, epoch: 18 | loss: 0.0107310
	speed: 0.0600s/iter; left time: 2319.2209s
	iters: 400, epoch: 18 | loss: 0.0508767
	speed: 0.0570s/iter; left time: 2197.4530s
Epoch: 18 cost time: 27.749059677124023
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0020980
	speed: 0.2535s/iter; left time: 9723.4009s
	iters: 200, epoch: 19 | loss: 0.0641775
	speed: 0.0564s/iter; left time: 2157.8048s
	iters: 300, epoch: 19 | loss: 0.0283274
	speed: 0.0561s/iter; left time: 2141.2479s
	iters: 400, epoch: 19 | loss: 0.0016931
	speed: 0.0520s/iter; left time: 1979.0394s
Epoch: 19 cost time: 26.384084939956665
Epoch: 19, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0223700
	speed: 0.2159s/iter; left time: 8180.8789s
	iters: 200, epoch: 20 | loss: 0.0017596
	speed: 0.0590s/iter; left time: 2231.0961s
	iters: 300, epoch: 20 | loss: 0.1742582
	speed: 0.0568s/iter; left time: 2140.1786s
	iters: 400, epoch: 20 | loss: 0.0006887
	speed: 0.0553s/iter; left time: 2078.9676s
Epoch: 20 cost time: 27.241304397583008
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0039798
	speed: 0.2487s/iter; left time: 9308.3986s
	iters: 200, epoch: 21 | loss: 0.0031476
	speed: 0.0591s/iter; left time: 2206.6764s
	iters: 300, epoch: 21 | loss: 0.0012722
	speed: 0.0559s/iter; left time: 2080.6323s
	iters: 400, epoch: 21 | loss: 0.0008392
	speed: 0.0567s/iter; left time: 2106.5729s
Epoch: 21 cost time: 27.272200345993042
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1011136
	speed: 0.2495s/iter; left time: 9221.2053s
	iters: 200, epoch: 22 | loss: 0.0155931
	speed: 0.0585s/iter; left time: 2156.3042s
	iters: 300, epoch: 22 | loss: 0.0043458
	speed: 0.0559s/iter; left time: 2055.9709s
	iters: 400, epoch: 22 | loss: 0.0059329
	speed: 0.0580s/iter; left time: 2126.2593s
Epoch: 22 cost time: 28.009379625320435
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0016604
	speed: 0.2719s/iter; left time: 9920.6574s
	iters: 200, epoch: 23 | loss: 0.0012941
	speed: 0.0643s/iter; left time: 2339.2972s
	iters: 300, epoch: 23 | loss: 0.0006268
	speed: 0.0621s/iter; left time: 2251.8388s
	iters: 400, epoch: 23 | loss: 0.0005185
	speed: 0.0580s/iter; left time: 2100.0888s
Epoch: 23 cost time: 28.60955047607422
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 240538
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3883682
	speed: 0.0824s/iter; left time: 3855.9239s
	iters: 200, epoch: 1 | loss: 0.7950499
	speed: 0.0618s/iter; left time: 2884.0218s
	iters: 300, epoch: 1 | loss: 0.4590807
	speed: 0.0618s/iter; left time: 2881.7275s
	iters: 400, epoch: 1 | loss: 0.2025016
	speed: 0.0632s/iter; left time: 2938.2960s
Epoch: 1 cost time: 30.894426584243774
Epoch: 1, Steps: 469 | Train Loss: 0.965 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
Validation loss decreased (inf --> -0.907372).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1773261
	speed: 0.2543s/iter; left time: 11781.2023s
	iters: 200, epoch: 2 | loss: 0.2037534
	speed: 0.0606s/iter; left time: 2800.2774s
	iters: 300, epoch: 2 | loss: 0.1775873
	speed: 0.0615s/iter; left time: 2838.5819s
	iters: 400, epoch: 2 | loss: 0.1103069
	speed: 0.0588s/iter; left time: 2705.7914s
Epoch: 2 cost time: 28.591769456863403
Epoch: 2, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.195 Vali Acc: 0.945 Test Loss: 0.195 Test Acc: 0.945
Validation loss decreased (-0.907372 --> -0.944538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1200103
	speed: 0.2620s/iter; left time: 12017.2112s
	iters: 200, epoch: 3 | loss: 0.1441299
	speed: 0.0552s/iter; left time: 2527.6325s
	iters: 300, epoch: 3 | loss: 0.0449187
	speed: 0.0559s/iter; left time: 2550.6877s
	iters: 400, epoch: 3 | loss: 0.1300160
	speed: 0.0571s/iter; left time: 2601.1479s
Epoch: 3 cost time: 26.95245337486267
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1121678
	speed: 0.2495s/iter; left time: 11326.8903s
	iters: 200, epoch: 4 | loss: 0.0121102
	speed: 0.0610s/iter; left time: 2764.0888s
	iters: 300, epoch: 4 | loss: 0.0352965
	speed: 0.0604s/iter; left time: 2729.4204s
	iters: 400, epoch: 4 | loss: 0.0324545
	speed: 0.0607s/iter; left time: 2735.5870s
Epoch: 4 cost time: 28.740012884140015
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
Validation loss decreased (-0.944538 --> -0.959976).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1189119
	speed: 0.2587s/iter; left time: 11621.4839s
	iters: 200, epoch: 5 | loss: 0.0333985
	speed: 0.0555s/iter; left time: 2486.1263s
	iters: 300, epoch: 5 | loss: 0.0104062
	speed: 0.0564s/iter; left time: 2524.7076s
	iters: 400, epoch: 5 | loss: 0.1489532
	speed: 0.0576s/iter; left time: 2570.0766s
Epoch: 5 cost time: 26.865713596343994
Epoch: 5, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.959976 --> -0.961977).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0293987
	speed: 0.2467s/iter; left time: 10965.7886s
	iters: 200, epoch: 6 | loss: 0.2698419
	speed: 0.0564s/iter; left time: 2503.2766s
	iters: 300, epoch: 6 | loss: 0.0265121
	speed: 0.0555s/iter; left time: 2457.6034s
	iters: 400, epoch: 6 | loss: 0.0165472
	speed: 0.0575s/iter; left time: 2537.8362s
Epoch: 6 cost time: 27.113621950149536
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.961977 --> -0.969410).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1149561
	speed: 0.2552s/iter; left time: 11225.2425s
	iters: 200, epoch: 7 | loss: 0.3808320
	speed: 0.0548s/iter; left time: 2403.3634s
	iters: 300, epoch: 7 | loss: 0.0092615
	speed: 0.0573s/iter; left time: 2508.1832s
	iters: 400, epoch: 7 | loss: 0.0051989
	speed: 0.0561s/iter; left time: 2450.5202s
Epoch: 7 cost time: 26.805296897888184
Epoch: 7, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0094238
	speed: 0.2471s/iter; left time: 10753.7638s
	iters: 200, epoch: 8 | loss: 0.0114045
	speed: 0.0573s/iter; left time: 2486.2024s
	iters: 300, epoch: 8 | loss: 0.0163412
	speed: 0.0563s/iter; left time: 2436.9184s
	iters: 400, epoch: 8 | loss: 0.2375612
	speed: 0.0524s/iter; left time: 2263.6223s
Epoch: 8 cost time: 26.647091150283813
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.242 Vali Acc: 0.934 Test Loss: 0.242 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0067183
	speed: 0.2593s/iter; left time: 11161.4717s
	iters: 200, epoch: 9 | loss: 0.0024742
	speed: 0.0598s/iter; left time: 2569.8157s
	iters: 300, epoch: 9 | loss: 0.5874048
	speed: 0.0598s/iter; left time: 2562.0465s
	iters: 400, epoch: 9 | loss: 0.0058202
	speed: 0.0596s/iter; left time: 2548.9853s
Epoch: 9 cost time: 28.859413623809814
Epoch: 9, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0106355
	speed: 0.2772s/iter; left time: 11802.5891s
	iters: 200, epoch: 10 | loss: 0.0053210
	speed: 0.0584s/iter; left time: 2479.7484s
	iters: 300, epoch: 10 | loss: 0.0424429
	speed: 0.0598s/iter; left time: 2532.6244s
	iters: 400, epoch: 10 | loss: 0.0034458
	speed: 0.0597s/iter; left time: 2523.0234s
Epoch: 10 cost time: 28.407735109329224
Epoch: 10, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0960565
	speed: 0.2717s/iter; left time: 11441.3902s
	iters: 200, epoch: 11 | loss: 0.0493256
	speed: 0.0606s/iter; left time: 2546.2958s
	iters: 300, epoch: 11 | loss: 0.0558780
	speed: 0.0555s/iter; left time: 2324.9488s
	iters: 400, epoch: 11 | loss: 0.0198894
	speed: 0.0544s/iter; left time: 2273.8107s
Epoch: 11 cost time: 27.4803364276886
Epoch: 11, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.3355382
	speed: 0.2428s/iter; left time: 10112.1427s
	iters: 200, epoch: 12 | loss: 0.0234686
	speed: 0.0551s/iter; left time: 2288.5821s
	iters: 300, epoch: 12 | loss: 0.2273705
	speed: 0.0581s/iter; left time: 2406.3268s
	iters: 400, epoch: 12 | loss: 0.0322311
	speed: 0.0567s/iter; left time: 2343.0852s
Epoch: 12 cost time: 27.047444343566895
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.969982).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0028840
	speed: 0.2542s/iter; left time: 10467.5863s
	iters: 200, epoch: 13 | loss: 0.0028819
	speed: 0.0608s/iter; left time: 2498.1467s
	iters: 300, epoch: 13 | loss: 0.0133081
	speed: 0.0572s/iter; left time: 2345.5779s
	iters: 400, epoch: 13 | loss: 0.0021679
	speed: 0.0620s/iter; left time: 2533.0881s
Epoch: 13 cost time: 28.424748182296753
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0471556
	speed: 0.2449s/iter; left time: 9970.3503s
	iters: 200, epoch: 14 | loss: 0.0563350
	speed: 0.0588s/iter; left time: 2389.4344s
	iters: 300, epoch: 14 | loss: 0.0138892
	speed: 0.0546s/iter; left time: 2212.7146s
	iters: 400, epoch: 14 | loss: 0.2189109
	speed: 0.0557s/iter; left time: 2250.0097s
Epoch: 14 cost time: 27.006175994873047
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0208174
	speed: 0.2487s/iter; left time: 10005.3101s
	iters: 200, epoch: 15 | loss: 0.0077053
	speed: 0.0635s/iter; left time: 2546.7714s
	iters: 300, epoch: 15 | loss: 0.0028915
	speed: 0.0589s/iter; left time: 2356.1444s
	iters: 400, epoch: 15 | loss: 0.0017344
	speed: 0.0568s/iter; left time: 2266.4721s
Epoch: 15 cost time: 28.361650705337524
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0087077
	speed: 0.2562s/iter; left time: 10187.1652s
	iters: 200, epoch: 16 | loss: 0.0101798
	speed: 0.0615s/iter; left time: 2439.4833s
	iters: 300, epoch: 16 | loss: 0.0006496
	speed: 0.0567s/iter; left time: 2243.3894s
	iters: 400, epoch: 16 | loss: 0.2544374
	speed: 0.0546s/iter; left time: 2154.4679s
Epoch: 16 cost time: 27.7069149017334
Epoch: 16, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0009653
	speed: 0.2417s/iter; left time: 9499.0926s
	iters: 200, epoch: 17 | loss: 0.2002445
	speed: 0.0587s/iter; left time: 2301.8306s
	iters: 300, epoch: 17 | loss: 0.0040113
	speed: 0.0603s/iter; left time: 2355.9561s
	iters: 400, epoch: 17 | loss: 0.0028001
	speed: 0.0585s/iter; left time: 2282.9492s
Epoch: 17 cost time: 27.755032777786255
Epoch: 17, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0192563
	speed: 0.2652s/iter; left time: 10295.4947s
	iters: 200, epoch: 18 | loss: 0.0002704
	speed: 0.0607s/iter; left time: 2351.6464s
	iters: 300, epoch: 18 | loss: 0.0008015
	speed: 0.0632s/iter; left time: 2440.9061s
	iters: 400, epoch: 18 | loss: 0.0005720
	speed: 0.0596s/iter; left time: 2295.7275s
Epoch: 18 cost time: 29.31180763244629
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.969982 --> -0.975699).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0025710
	speed: 0.2606s/iter; left time: 9996.6176s
	iters: 200, epoch: 19 | loss: 0.1228908
	speed: 0.0606s/iter; left time: 2318.1728s
	iters: 300, epoch: 19 | loss: 0.0004348
	speed: 0.0639s/iter; left time: 2438.1750s
	iters: 400, epoch: 19 | loss: 0.0049473
	speed: 0.0614s/iter; left time: 2336.2194s
Epoch: 19 cost time: 29.337993144989014
Epoch: 19, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0040321
	speed: 0.2824s/iter; left time: 10700.0917s
	iters: 200, epoch: 20 | loss: 0.0563300
	speed: 0.0592s/iter; left time: 2237.6487s
	iters: 300, epoch: 20 | loss: 0.0012526
	speed: 0.0593s/iter; left time: 2235.5033s
	iters: 400, epoch: 20 | loss: 0.0016820
	speed: 0.0594s/iter; left time: 2233.0547s
Epoch: 20 cost time: 28.659380197525024
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.177 Vali Acc: 0.961 Test Loss: 0.177 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0045617
	speed: 0.2609s/iter; left time: 9763.6798s
	iters: 200, epoch: 21 | loss: 0.0045409
	speed: 0.0562s/iter; left time: 2098.2263s
	iters: 300, epoch: 21 | loss: 0.0007829
	speed: 0.0573s/iter; left time: 2132.9589s
	iters: 400, epoch: 21 | loss: 0.0018155
	speed: 0.0568s/iter; left time: 2109.9026s
Epoch: 21 cost time: 27.40394401550293
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1003696
	speed: 0.2499s/iter; left time: 9235.2067s
	iters: 200, epoch: 22 | loss: 0.0110194
	speed: 0.0585s/iter; left time: 2154.0166s
	iters: 300, epoch: 22 | loss: 0.0094492
	speed: 0.0582s/iter; left time: 2140.2828s
	iters: 400, epoch: 22 | loss: 0.0013589
	speed: 0.0584s/iter; left time: 2139.0903s
Epoch: 22 cost time: 28.110520601272583
Epoch: 22, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0017741
	speed: 0.2538s/iter; left time: 9258.2685s
	iters: 200, epoch: 23 | loss: 0.0017749
	speed: 0.0571s/iter; left time: 2078.0697s
	iters: 300, epoch: 23 | loss: 0.0018334
	speed: 0.0568s/iter; left time: 2062.2228s
	iters: 400, epoch: 23 | loss: 0.0124282
	speed: 0.0555s/iter; left time: 2007.2028s
Epoch: 23 cost time: 27.413806200027466
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0002084
	speed: 0.2525s/iter; left time: 9094.7854s
	iters: 200, epoch: 24 | loss: 0.0022838
	speed: 0.0600s/iter; left time: 2154.4597s
	iters: 300, epoch: 24 | loss: 0.0004165
	speed: 0.0592s/iter; left time: 2118.5532s
	iters: 400, epoch: 24 | loss: 0.0728622
	speed: 0.0589s/iter; left time: 2103.5665s
Epoch: 24 cost time: 28.399812698364258
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0025254
	speed: 0.2498s/iter; left time: 8878.8454s
	iters: 200, epoch: 25 | loss: 0.0033123
	speed: 0.0589s/iter; left time: 2087.8414s
	iters: 300, epoch: 25 | loss: 0.1618549
	speed: 0.0609s/iter; left time: 2153.2648s
	iters: 400, epoch: 25 | loss: 0.0048520
	speed: 0.0591s/iter; left time: 2084.2160s
Epoch: 25 cost time: 29.12106680870056
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0620519
	speed: 0.2559s/iter; left time: 8976.4493s
	iters: 200, epoch: 26 | loss: 0.0021110
	speed: 0.0607s/iter; left time: 2124.6407s
	iters: 300, epoch: 26 | loss: 0.0007733
	speed: 0.0591s/iter; left time: 2060.3836s
	iters: 400, epoch: 26 | loss: 0.0008961
	speed: 0.0586s/iter; left time: 2037.6160s
Epoch: 26 cost time: 28.314635753631592
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0051019
	speed: 0.2593s/iter; left time: 8973.9224s
	iters: 200, epoch: 27 | loss: 0.0051631
	speed: 0.0614s/iter; left time: 2117.6398s
	iters: 300, epoch: 27 | loss: 0.0032900
	speed: 0.0629s/iter; left time: 2164.7772s
	iters: 400, epoch: 27 | loss: 0.0176387
	speed: 0.0596s/iter; left time: 2044.7996s
Epoch: 27 cost time: 28.78782606124878
Epoch: 27, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0074413
	speed: 0.2637s/iter; left time: 9003.1586s
	iters: 200, epoch: 28 | loss: 0.0011940
	speed: 0.0591s/iter; left time: 2010.9578s
	iters: 300, epoch: 28 | loss: 0.0022896
	speed: 0.0624s/iter; left time: 2118.8323s
	iters: 400, epoch: 28 | loss: 0.1775665
	speed: 0.0626s/iter; left time: 2117.2732s
Epoch: 28 cost time: 28.760004997253418
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9757004002287021
model parameter : 182586
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7993090
	speed: 0.0818s/iter; left time: 3829.6946s
	iters: 200, epoch: 1 | loss: 0.7693458
	speed: 0.0602s/iter; left time: 2809.4233s
	iters: 300, epoch: 1 | loss: 0.5296040
	speed: 0.0610s/iter; left time: 2844.4433s
	iters: 400, epoch: 1 | loss: 0.4724985
	speed: 0.0557s/iter; left time: 2592.1179s
Epoch: 1 cost time: 29.55084204673767
Epoch: 1, Steps: 469 | Train Loss: 1.020 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
Validation loss decreased (inf --> -0.871636).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2087087
	speed: 0.2343s/iter; left time: 10854.5788s
	iters: 200, epoch: 2 | loss: 0.3717756
	speed: 0.0585s/iter; left time: 2706.4355s
	iters: 300, epoch: 2 | loss: 0.1952864
	speed: 0.0573s/iter; left time: 2641.6434s
	iters: 400, epoch: 2 | loss: 0.1471332
	speed: 0.0617s/iter; left time: 2838.5338s
Epoch: 2 cost time: 28.162461757659912
Epoch: 2, Steps: 469 | Train Loss: 0.242 Vali Loss: 0.273 Vali Acc: 0.918 Test Loss: 0.273 Test Acc: 0.918
Validation loss decreased (-0.871636 --> -0.918236).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1328353
	speed: 0.2499s/iter; left time: 11459.8926s
	iters: 200, epoch: 3 | loss: 0.0568877
	speed: 0.0599s/iter; left time: 2742.5399s
	iters: 300, epoch: 3 | loss: 0.0714519
	speed: 0.0595s/iter; left time: 2716.7974s
	iters: 400, epoch: 3 | loss: 0.3868308
	speed: 0.0580s/iter; left time: 2640.6348s
Epoch: 3 cost time: 28.049237966537476
Epoch: 3, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.918236 --> -0.954544).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0079978
	speed: 0.2427s/iter; left time: 11015.6614s
	iters: 200, epoch: 4 | loss: 0.0371005
	speed: 0.0579s/iter; left time: 2620.7931s
	iters: 300, epoch: 4 | loss: 0.0724785
	speed: 0.0593s/iter; left time: 2681.0447s
	iters: 400, epoch: 4 | loss: 0.2727583
	speed: 0.0597s/iter; left time: 2691.6274s
Epoch: 4 cost time: 28.031810522079468
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2463640
	speed: 0.2488s/iter; left time: 11179.3296s
	iters: 200, epoch: 5 | loss: 0.0628880
	speed: 0.0565s/iter; left time: 2530.6497s
	iters: 300, epoch: 5 | loss: 0.0713310
	speed: 0.0599s/iter; left time: 2679.4843s
	iters: 400, epoch: 5 | loss: 0.0094630
	speed: 0.0603s/iter; left time: 2690.1407s
Epoch: 5 cost time: 27.910969018936157
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.954544 --> -0.963692).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0799187
	speed: 0.2416s/iter; left time: 10742.0136s
	iters: 200, epoch: 6 | loss: 0.0111923
	speed: 0.0559s/iter; left time: 2481.1083s
	iters: 300, epoch: 6 | loss: 0.1749600
	speed: 0.0612s/iter; left time: 2710.5832s
	iters: 400, epoch: 6 | loss: 0.0181715
	speed: 0.0614s/iter; left time: 2711.2827s
Epoch: 6 cost time: 28.11088752746582
Epoch: 6, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.963692 --> -0.970839).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0466778
	speed: 0.2459s/iter; left time: 10817.5043s
	iters: 200, epoch: 7 | loss: 0.0035589
	speed: 0.0609s/iter; left time: 2671.2074s
	iters: 300, epoch: 7 | loss: 0.0275092
	speed: 0.0617s/iter; left time: 2703.0915s
	iters: 400, epoch: 7 | loss: 0.0644583
	speed: 0.0617s/iter; left time: 2694.3391s
Epoch: 7 cost time: 29.222007513046265
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0359207
	speed: 0.2600s/iter; left time: 11315.2096s
	iters: 200, epoch: 8 | loss: 0.0023246
	speed: 0.0606s/iter; left time: 2629.4440s
	iters: 300, epoch: 8 | loss: 0.0562530
	speed: 0.0623s/iter; left time: 2699.9551s
	iters: 400, epoch: 8 | loss: 0.0055453
	speed: 0.0641s/iter; left time: 2768.1366s
Epoch: 8 cost time: 29.40968132019043
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.227 Vali Acc: 0.947 Test Loss: 0.227 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0197712
	speed: 0.2662s/iter; left time: 11459.5408s
	iters: 200, epoch: 9 | loss: 0.0054065
	speed: 0.0606s/iter; left time: 2603.0823s
	iters: 300, epoch: 9 | loss: 0.0029288
	speed: 0.0631s/iter; left time: 2705.4304s
	iters: 400, epoch: 9 | loss: 0.0464379
	speed: 0.0638s/iter; left time: 2728.0031s
Epoch: 9 cost time: 29.48038673400879
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0077431
	speed: 0.2570s/iter; left time: 10944.3346s
	iters: 200, epoch: 10 | loss: 0.0204377
	speed: 0.0580s/iter; left time: 2462.2942s
	iters: 300, epoch: 10 | loss: 0.1629091
	speed: 0.0553s/iter; left time: 2342.6485s
	iters: 400, epoch: 10 | loss: 0.1284224
	speed: 0.0551s/iter; left time: 2330.5953s
Epoch: 10 cost time: 26.88859796524048
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0237767
	speed: 0.2301s/iter; left time: 9690.6463s
	iters: 200, epoch: 11 | loss: 0.0247610
	speed: 0.0601s/iter; left time: 2526.5256s
	iters: 300, epoch: 11 | loss: 0.0011597
	speed: 0.0570s/iter; left time: 2388.3038s
	iters: 400, epoch: 11 | loss: 0.1013577
	speed: 0.0566s/iter; left time: 2365.7157s
Epoch: 11 cost time: 28.08016300201416
Epoch: 11, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0550455
	speed: 0.2515s/iter; left time: 10473.6147s
	iters: 200, epoch: 12 | loss: 0.0703399
	speed: 0.0585s/iter; left time: 2430.7826s
	iters: 300, epoch: 12 | loss: 0.0029945
	speed: 0.0546s/iter; left time: 2262.2029s
	iters: 400, epoch: 12 | loss: 0.2163720
	speed: 0.0551s/iter; left time: 2278.5403s
Epoch: 12 cost time: 26.734204530715942
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.970839 --> -0.971697).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0190594
	speed: 0.2382s/iter; left time: 9808.7601s
	iters: 200, epoch: 13 | loss: 0.0247340
	speed: 0.0574s/iter; left time: 2358.8972s
	iters: 300, epoch: 13 | loss: 0.0018261
	speed: 0.0561s/iter; left time: 2298.4056s
	iters: 400, epoch: 13 | loss: 0.0009081
	speed: 0.0536s/iter; left time: 2191.6676s
Epoch: 13 cost time: 26.431654453277588
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0521487
	speed: 0.2439s/iter; left time: 9927.5192s
	iters: 200, epoch: 14 | loss: 0.0043979
	speed: 0.0550s/iter; left time: 2233.9902s
	iters: 300, epoch: 14 | loss: 0.0035326
	speed: 0.0562s/iter; left time: 2277.2189s
	iters: 400, epoch: 14 | loss: 0.0013629
	speed: 0.0560s/iter; left time: 2264.0015s
Epoch: 14 cost time: 26.510710954666138
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1788553
	speed: 0.2473s/iter; left time: 9950.1955s
	iters: 200, epoch: 15 | loss: 0.0105462
	speed: 0.0585s/iter; left time: 2347.7329s
	iters: 300, epoch: 15 | loss: 0.0009439
	speed: 0.0571s/iter; left time: 2284.1382s
	iters: 400, epoch: 15 | loss: 0.4623868
	speed: 0.0563s/iter; left time: 2250.0680s
Epoch: 15 cost time: 27.61126399040222
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0997726
	speed: 0.2441s/iter; left time: 9705.2815s
	iters: 200, epoch: 16 | loss: 0.0040360
	speed: 0.0589s/iter; left time: 2335.4659s
	iters: 300, epoch: 16 | loss: 0.0199460
	speed: 0.0598s/iter; left time: 2367.2288s
	iters: 400, epoch: 16 | loss: 0.0935130
	speed: 0.0596s/iter; left time: 2352.4463s
Epoch: 16 cost time: 28.254217863082886
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0169513
	speed: 0.2644s/iter; left time: 10391.5216s
	iters: 200, epoch: 17 | loss: 0.0015569
	speed: 0.0625s/iter; left time: 2450.1843s
	iters: 300, epoch: 17 | loss: 0.0018634
	speed: 0.0677s/iter; left time: 2644.9352s
	iters: 400, epoch: 17 | loss: 0.0030632
	speed: 0.0641s/iter; left time: 2501.6394s
Epoch: 17 cost time: 30.081554412841797
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0106309
	speed: 0.2554s/iter; left time: 9915.9339s
	iters: 200, epoch: 18 | loss: 0.0016559
	speed: 0.0587s/iter; left time: 2273.8146s
	iters: 300, epoch: 18 | loss: 0.0018795
	speed: 0.0600s/iter; left time: 2315.7663s
	iters: 400, epoch: 18 | loss: 0.0134357
	speed: 0.0603s/iter; left time: 2324.0400s
Epoch: 18 cost time: 28.37471890449524
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0028489
	speed: 0.2557s/iter; left time: 9807.0012s
	iters: 200, epoch: 19 | loss: 0.1192207
	speed: 0.0556s/iter; left time: 2129.0778s
	iters: 300, epoch: 19 | loss: 0.0019908
	speed: 0.0576s/iter; left time: 2198.5188s
	iters: 400, epoch: 19 | loss: 0.0036756
	speed: 0.0587s/iter; left time: 2235.2857s
Epoch: 19 cost time: 27.206873655319214
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0144661
	speed: 0.2414s/iter; left time: 9146.0747s
	iters: 200, epoch: 20 | loss: 0.0012321
	speed: 0.0578s/iter; left time: 2184.6451s
	iters: 300, epoch: 20 | loss: 0.0740536
	speed: 0.0597s/iter; left time: 2250.2743s
	iters: 400, epoch: 20 | loss: 0.0961699
	speed: 0.0606s/iter; left time: 2276.0934s
Epoch: 20 cost time: 28.180828332901
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972840).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0049143
	speed: 0.2412s/iter; left time: 9024.2642s
	iters: 200, epoch: 21 | loss: 0.0051165
	speed: 0.0576s/iter; left time: 2149.2187s
	iters: 300, epoch: 21 | loss: 0.0020740
	speed: 0.0589s/iter; left time: 2191.4245s
	iters: 400, epoch: 21 | loss: 0.0015143
	speed: 0.0593s/iter; left time: 2201.2505s
Epoch: 21 cost time: 27.340989589691162
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002911
	speed: 0.2430s/iter; left time: 8981.1400s
	iters: 200, epoch: 22 | loss: 0.0047998
	speed: 0.0598s/iter; left time: 2205.5206s
	iters: 300, epoch: 22 | loss: 0.0020430
	speed: 0.0583s/iter; left time: 2143.1577s
	iters: 400, epoch: 22 | loss: 0.0018057
	speed: 0.0615s/iter; left time: 2252.6603s
Epoch: 22 cost time: 28.354092836380005
Epoch: 22, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0020871
	speed: 0.2394s/iter; left time: 8732.3514s
	iters: 200, epoch: 23 | loss: 0.0015364
	speed: 0.0598s/iter; left time: 2174.0456s
	iters: 300, epoch: 23 | loss: 0.0280855
	speed: 0.0589s/iter; left time: 2136.4949s
	iters: 400, epoch: 23 | loss: 0.0020742
	speed: 0.0601s/iter; left time: 2173.3055s
Epoch: 23 cost time: 27.995851755142212
Epoch: 23, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0042265
	speed: 0.2483s/iter; left time: 8943.1202s
	iters: 200, epoch: 24 | loss: 0.0013145
	speed: 0.0596s/iter; left time: 2138.8638s
	iters: 300, epoch: 24 | loss: 0.2065660
	speed: 0.0599s/iter; left time: 2145.7822s
	iters: 400, epoch: 24 | loss: 0.0696863
	speed: 0.0532s/iter; left time: 1899.7700s
Epoch: 24 cost time: 26.76569175720215
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.980560).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0086026
	speed: 0.2199s/iter; left time: 7815.8884s
	iters: 200, epoch: 25 | loss: 0.0164964
	speed: 0.0580s/iter; left time: 2056.9338s
	iters: 300, epoch: 25 | loss: 0.0010052
	speed: 0.0600s/iter; left time: 2120.7763s
	iters: 400, epoch: 25 | loss: 0.0004028
	speed: 0.0608s/iter; left time: 2143.7812s
Epoch: 25 cost time: 27.943942070007324
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0013475
	speed: 0.2598s/iter; left time: 9112.6832s
	iters: 200, epoch: 26 | loss: 0.0017388
	speed: 0.0592s/iter; left time: 2070.9737s
	iters: 300, epoch: 26 | loss: 0.0043834
	speed: 0.0613s/iter; left time: 2138.6142s
	iters: 400, epoch: 26 | loss: 0.1035647
	speed: 0.0636s/iter; left time: 2210.0782s
Epoch: 26 cost time: 29.139934539794922
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1725005
	speed: 0.2589s/iter; left time: 8959.2456s
	iters: 200, epoch: 27 | loss: 0.0113829
	speed: 0.0643s/iter; left time: 2220.5214s
	iters: 300, epoch: 27 | loss: 0.0011275
	speed: 0.0598s/iter; left time: 2056.1281s
	iters: 400, epoch: 27 | loss: 0.0397870
	speed: 0.0600s/iter; left time: 2057.8643s
Epoch: 27 cost time: 29.025968551635742
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0007109
	speed: 0.2644s/iter; left time: 9027.7885s
	iters: 200, epoch: 28 | loss: 0.0022680
	speed: 0.0568s/iter; left time: 1934.5235s
	iters: 300, epoch: 28 | loss: 0.0086934
	speed: 0.0593s/iter; left time: 2012.4093s
	iters: 400, epoch: 28 | loss: 0.0240408
	speed: 0.0601s/iter; left time: 2032.0747s
Epoch: 28 cost time: 28.110157012939453
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0042551
	speed: 0.2535s/iter; left time: 8534.2518s
	iters: 200, epoch: 29 | loss: 0.2554749
	speed: 0.0549s/iter; left time: 1844.4552s
	iters: 300, epoch: 29 | loss: 0.0016362
	speed: 0.0578s/iter; left time: 1935.6940s
	iters: 400, epoch: 29 | loss: 0.0023648
	speed: 0.0572s/iter; left time: 1909.8630s
Epoch: 29 cost time: 27.645456314086914
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.1161834
	speed: 0.2429s/iter; left time: 8065.5404s
	iters: 200, epoch: 30 | loss: 0.0027304
	speed: 0.0574s/iter; left time: 1899.3556s
	iters: 300, epoch: 30 | loss: 0.0023845
	speed: 0.0568s/iter; left time: 1873.0925s
	iters: 400, epoch: 30 | loss: 0.0007234
	speed: 0.0578s/iter; left time: 1900.8717s
Epoch: 30 cost time: 27.353437900543213
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0033594
	speed: 0.2417s/iter; left time: 7911.3215s
	iters: 200, epoch: 31 | loss: 0.0267849
	speed: 0.0557s/iter; left time: 1818.8692s
	iters: 300, epoch: 31 | loss: 0.0023999
	speed: 0.0585s/iter; left time: 1903.9590s
	iters: 400, epoch: 31 | loss: 0.0012891
	speed: 0.0580s/iter; left time: 1880.8958s
Epoch: 31 cost time: 27.255008220672607
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0016940
	speed: 0.2472s/iter; left time: 7975.0263s
	iters: 200, epoch: 32 | loss: 0.0988560
	speed: 0.0566s/iter; left time: 1819.9623s
	iters: 300, epoch: 32 | loss: 0.0015680
	speed: 0.0580s/iter; left time: 1860.9413s
	iters: 400, epoch: 32 | loss: 0.0074492
	speed: 0.0579s/iter; left time: 1849.4986s
Epoch: 32 cost time: 27.657639980316162
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0008797
	speed: 0.2160s/iter; left time: 6866.9371s
	iters: 200, epoch: 33 | loss: 0.0023200
	speed: 0.0549s/iter; left time: 1738.5926s
	iters: 300, epoch: 33 | loss: 0.0001907
	speed: 0.0552s/iter; left time: 1743.7313s
	iters: 400, epoch: 33 | loss: 0.0027075
	speed: 0.0574s/iter; left time: 1808.4706s
Epoch: 33 cost time: 27.287907123565674
Epoch: 33, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0215073
	speed: 0.2568s/iter; left time: 8043.5992s
	iters: 200, epoch: 34 | loss: 0.0020934
	speed: 0.0560s/iter; left time: 1747.5913s
	iters: 300, epoch: 34 | loss: 0.0032404
	speed: 0.0525s/iter; left time: 1633.1007s
	iters: 400, epoch: 34 | loss: 0.0004754
	speed: 0.0558s/iter; left time: 1731.6668s
Epoch: 34 cost time: 27.0884370803833
Epoch: 34, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 182490
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4219352
	speed: 0.0771s/iter; left time: 3609.4979s
	iters: 200, epoch: 1 | loss: 0.7029110
	speed: 0.0603s/iter; left time: 2814.3115s
	iters: 300, epoch: 1 | loss: 0.5519284
	speed: 0.0602s/iter; left time: 2804.2507s
	iters: 400, epoch: 1 | loss: 0.3922411
	speed: 0.0575s/iter; left time: 2673.4168s
Epoch: 1 cost time: 29.808268547058105
Epoch: 1, Steps: 469 | Train Loss: 1.041 Vali Loss: 0.428 Vali Acc: 0.882 Test Loss: 0.428 Test Acc: 0.882
Validation loss decreased (inf --> -0.882214).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2780763
	speed: 0.2699s/iter; left time: 12503.5715s
	iters: 200, epoch: 2 | loss: 0.4622779
	speed: 0.0623s/iter; left time: 2878.0541s
	iters: 300, epoch: 2 | loss: 0.3146897
	speed: 0.0610s/iter; left time: 2813.3910s
	iters: 400, epoch: 2 | loss: 0.2174614
	speed: 0.0581s/iter; left time: 2673.6592s
Epoch: 2 cost time: 28.62401843070984
Epoch: 2, Steps: 469 | Train Loss: 0.247 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
Validation loss decreased (-0.882214 --> -0.926527).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0606399
	speed: 0.2417s/iter; left time: 11086.9519s
	iters: 200, epoch: 3 | loss: 0.0478766
	speed: 0.0565s/iter; left time: 2586.8992s
	iters: 300, epoch: 3 | loss: 0.0909460
	speed: 0.0577s/iter; left time: 2635.6039s
	iters: 400, epoch: 3 | loss: 0.0656221
	speed: 0.0590s/iter; left time: 2689.5118s
Epoch: 3 cost time: 27.256556510925293
Epoch: 3, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.926527 --> -0.936819).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0396824
	speed: 0.2486s/iter; left time: 11285.2212s
	iters: 200, epoch: 4 | loss: 0.0606175
	speed: 0.0569s/iter; left time: 2575.7549s
	iters: 300, epoch: 4 | loss: 0.0061850
	speed: 0.0555s/iter; left time: 2507.0407s
	iters: 400, epoch: 4 | loss: 0.2439380
	speed: 0.0538s/iter; left time: 2423.8456s
Epoch: 4 cost time: 26.650526523590088
Epoch: 4, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.239 Vali Acc: 0.947 Test Loss: 0.239 Test Acc: 0.947
Validation loss decreased (-0.936819 --> -0.946824).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1238132
	speed: 0.2399s/iter; left time: 10775.9472s
	iters: 200, epoch: 5 | loss: 0.0046994
	speed: 0.0586s/iter; left time: 2628.6924s
	iters: 300, epoch: 5 | loss: 0.0491497
	speed: 0.0609s/iter; left time: 2724.6957s
	iters: 400, epoch: 5 | loss: 0.0120373
	speed: 0.0598s/iter; left time: 2670.0934s
Epoch: 5 cost time: 27.968409538269043
Epoch: 5, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0130431
	speed: 0.2502s/iter; left time: 11121.0519s
	iters: 200, epoch: 6 | loss: 0.0742582
	speed: 0.0558s/iter; left time: 2476.3573s
	iters: 300, epoch: 6 | loss: 0.0076706
	speed: 0.0572s/iter; left time: 2530.1296s
	iters: 400, epoch: 6 | loss: 0.0491950
	speed: 0.0614s/iter; left time: 2711.1457s
Epoch: 6 cost time: 27.666215419769287
Epoch: 6, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.946824 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0151157
	speed: 0.2453s/iter; left time: 10788.9256s
	iters: 200, epoch: 7 | loss: 0.0035851
	speed: 0.0548s/iter; left time: 2405.6513s
	iters: 300, epoch: 7 | loss: 0.0263440
	speed: 0.0581s/iter; left time: 2544.0406s
	iters: 400, epoch: 7 | loss: 0.0215040
	speed: 0.0635s/iter; left time: 2775.9492s
Epoch: 7 cost time: 27.449049949645996
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0055894
	speed: 0.2457s/iter; left time: 10690.3746s
	iters: 200, epoch: 8 | loss: 0.4143875
	speed: 0.0606s/iter; left time: 2630.5468s
	iters: 300, epoch: 8 | loss: 0.0513089
	speed: 0.0605s/iter; left time: 2620.1099s
	iters: 400, epoch: 8 | loss: 0.0138689
	speed: 0.0594s/iter; left time: 2566.4307s
Epoch: 8 cost time: 28.34066939353943
Epoch: 8, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.963406 --> -0.974842).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1827150
	speed: 0.2393s/iter; left time: 10299.9932s
	iters: 200, epoch: 9 | loss: 0.0293851
	speed: 0.0620s/iter; left time: 2661.9320s
	iters: 300, epoch: 9 | loss: 0.0158159
	speed: 0.0569s/iter; left time: 2439.3381s
	iters: 400, epoch: 9 | loss: 0.0253787
	speed: 0.0588s/iter; left time: 2514.0508s
Epoch: 9 cost time: 28.002440214157104
Epoch: 9, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0039415
	speed: 0.2596s/iter; left time: 11053.0626s
	iters: 200, epoch: 10 | loss: 0.0081296
	speed: 0.0598s/iter; left time: 2541.4111s
	iters: 300, epoch: 10 | loss: 0.0109686
	speed: 0.0595s/iter; left time: 2520.4117s
	iters: 400, epoch: 10 | loss: 0.0050023
	speed: 0.0597s/iter; left time: 2525.7996s
Epoch: 10 cost time: 28.975764751434326
Epoch: 10, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2708616
	speed: 0.2585s/iter; left time: 10886.0966s
	iters: 200, epoch: 11 | loss: 0.0023732
	speed: 0.0610s/iter; left time: 2563.7924s
	iters: 300, epoch: 11 | loss: 0.0068747
	speed: 0.0596s/iter; left time: 2497.2176s
	iters: 400, epoch: 11 | loss: 0.0095565
	speed: 0.0577s/iter; left time: 2413.0116s
Epoch: 11 cost time: 28.163586854934692
Epoch: 11, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0095412
	speed: 0.2339s/iter; left time: 9741.7086s
	iters: 200, epoch: 12 | loss: 0.0069087
	speed: 0.0551s/iter; left time: 2290.6290s
	iters: 300, epoch: 12 | loss: 0.0024707
	speed: 0.0539s/iter; left time: 2234.7340s
	iters: 400, epoch: 12 | loss: 0.0036167
	speed: 0.0552s/iter; left time: 2282.7611s
Epoch: 12 cost time: 25.902958154678345
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0085076
	speed: 0.2405s/iter; left time: 9902.7153s
	iters: 200, epoch: 13 | loss: 0.1489752
	speed: 0.0571s/iter; left time: 2345.6586s
	iters: 300, epoch: 13 | loss: 0.0129423
	speed: 0.0534s/iter; left time: 2187.8328s
	iters: 400, epoch: 13 | loss: 0.0012854
	speed: 0.0512s/iter; left time: 2091.2183s
Epoch: 13 cost time: 26.20100688934326
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0019743
	speed: 0.2409s/iter; left time: 9806.2247s
	iters: 200, epoch: 14 | loss: 0.0319947
	speed: 0.0601s/iter; left time: 2441.3597s
	iters: 300, epoch: 14 | loss: 0.0011783
	speed: 0.0587s/iter; left time: 2376.8713s
	iters: 400, epoch: 14 | loss: 0.0326818
	speed: 0.0602s/iter; left time: 2433.0544s
Epoch: 14 cost time: 28.06702470779419
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1944530
	speed: 0.2423s/iter; left time: 9747.4141s
	iters: 200, epoch: 15 | loss: 0.0084924
	speed: 0.0593s/iter; left time: 2379.8772s
	iters: 300, epoch: 15 | loss: 0.0317684
	speed: 0.0606s/iter; left time: 2426.4138s
	iters: 400, epoch: 15 | loss: 0.0529157
	speed: 0.0576s/iter; left time: 2301.7259s
Epoch: 15 cost time: 27.580496072769165
Epoch: 15, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0006925
	speed: 0.2476s/iter; left time: 9847.0870s
	iters: 200, epoch: 16 | loss: 0.0101969
	speed: 0.0553s/iter; left time: 2192.4546s
	iters: 300, epoch: 16 | loss: 0.0620029
	speed: 0.0565s/iter; left time: 2235.2476s
	iters: 400, epoch: 16 | loss: 0.3165987
	speed: 0.0530s/iter; left time: 2093.1413s
Epoch: 16 cost time: 26.315484523773193
Epoch: 16, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0091333
	speed: 0.2439s/iter; left time: 9585.5865s
	iters: 200, epoch: 17 | loss: 0.0042464
	speed: 0.0575s/iter; left time: 2252.1433s
	iters: 300, epoch: 17 | loss: 0.0041000
	speed: 0.0596s/iter; left time: 2328.3447s
	iters: 400, epoch: 17 | loss: 0.0088433
	speed: 0.0522s/iter; left time: 2036.8329s
Epoch: 17 cost time: 26.973376274108887
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0097307
	speed: 0.2439s/iter; left time: 9470.4961s
	iters: 200, epoch: 18 | loss: 0.0491922
	speed: 0.0569s/iter; left time: 2205.2035s
	iters: 300, epoch: 18 | loss: 0.0004133
	speed: 0.0569s/iter; left time: 2198.7390s
	iters: 400, epoch: 18 | loss: 0.0059847
	speed: 0.0621s/iter; left time: 2392.7506s
Epoch: 18 cost time: 28.225683212280273
Epoch: 18, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 182394
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5303754
	speed: 0.0735s/iter; left time: 3438.4873s
	iters: 200, epoch: 1 | loss: 0.9968500
	speed: 0.0575s/iter; left time: 2687.4962s
	iters: 300, epoch: 1 | loss: 0.6386448
	speed: 0.0571s/iter; left time: 2659.5956s
	iters: 400, epoch: 1 | loss: 0.3937569
	speed: 0.0575s/iter; left time: 2671.5441s
Epoch: 1 cost time: 28.42420530319214
Epoch: 1, Steps: 469 | Train Loss: 1.049 Vali Loss: 0.464 Vali Acc: 0.876 Test Loss: 0.464 Test Acc: 0.876
Validation loss decreased (inf --> -0.875639).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1429559
	speed: 0.2474s/iter; left time: 11460.3691s
	iters: 200, epoch: 2 | loss: 0.3495223
	speed: 0.0544s/iter; left time: 2512.9186s
	iters: 300, epoch: 2 | loss: 0.2949024
	speed: 0.0590s/iter; left time: 2720.1455s
	iters: 400, epoch: 2 | loss: 0.2897716
	speed: 0.0575s/iter; left time: 2648.4130s
Epoch: 2 cost time: 26.439789533615112
Epoch: 2, Steps: 469 | Train Loss: 0.246 Vali Loss: 0.267 Vali Acc: 0.914 Test Loss: 0.267 Test Acc: 0.914
Validation loss decreased (-0.875639 --> -0.913662).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1155308
	speed: 0.2405s/iter; left time: 11029.3818s
	iters: 200, epoch: 3 | loss: 0.1915104
	speed: 0.0594s/iter; left time: 2719.0426s
	iters: 300, epoch: 3 | loss: 0.1842412
	speed: 0.0595s/iter; left time: 2717.4053s
	iters: 400, epoch: 3 | loss: 0.0392756
	speed: 0.0622s/iter; left time: 2834.8954s
Epoch: 3 cost time: 27.774102687835693
Epoch: 3, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.913662 --> -0.942537).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1521781
	speed: 0.2300s/iter; left time: 10438.5677s
	iters: 200, epoch: 4 | loss: 0.2976440
	speed: 0.0554s/iter; left time: 2508.6615s
	iters: 300, epoch: 4 | loss: 0.2698739
	speed: 0.0574s/iter; left time: 2595.4870s
	iters: 400, epoch: 4 | loss: 0.0760792
	speed: 0.0560s/iter; left time: 2524.4315s
Epoch: 4 cost time: 26.493293523788452
Epoch: 4, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.220 Vali Acc: 0.934 Test Loss: 0.220 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0092245
	speed: 0.2432s/iter; left time: 10923.7954s
	iters: 200, epoch: 5 | loss: 0.1581570
	speed: 0.0575s/iter; left time: 2576.2743s
	iters: 300, epoch: 5 | loss: 0.0114287
	speed: 0.0606s/iter; left time: 2709.9304s
	iters: 400, epoch: 5 | loss: 0.0214225
	speed: 0.0523s/iter; left time: 2334.2353s
Epoch: 5 cost time: 26.675121307373047
Epoch: 5, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.249 Vali Acc: 0.929 Test Loss: 0.249 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0496536
	speed: 0.2273s/iter; left time: 10103.2639s
	iters: 200, epoch: 6 | loss: 0.1155963
	speed: 0.0537s/iter; left time: 2381.1789s
	iters: 300, epoch: 6 | loss: 0.0052086
	speed: 0.0554s/iter; left time: 2453.4173s
	iters: 400, epoch: 6 | loss: 0.0280019
	speed: 0.0540s/iter; left time: 2386.0509s
Epoch: 6 cost time: 25.848089456558228
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
Validation loss decreased (-0.942537 --> -0.962549).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1008201
	speed: 0.2387s/iter; left time: 10498.2989s
	iters: 200, epoch: 7 | loss: 0.0101007
	speed: 0.0532s/iter; left time: 2336.8331s
	iters: 300, epoch: 7 | loss: 0.0112658
	speed: 0.0554s/iter; left time: 2424.0045s
	iters: 400, epoch: 7 | loss: 0.1297157
	speed: 0.0567s/iter; left time: 2478.4262s
Epoch: 7 cost time: 26.518324851989746
Epoch: 7, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.962549 --> -0.967409).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0054033
	speed: 0.2388s/iter; left time: 10394.1686s
	iters: 200, epoch: 8 | loss: 0.0040156
	speed: 0.0545s/iter; left time: 2366.7746s
	iters: 300, epoch: 8 | loss: 0.1895073
	speed: 0.0547s/iter; left time: 2370.2769s
	iters: 400, epoch: 8 | loss: 0.1009008
	speed: 0.0544s/iter; left time: 2350.8824s
Epoch: 8 cost time: 26.256317615509033
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0054766
	speed: 0.2684s/iter; left time: 11556.0954s
	iters: 200, epoch: 9 | loss: 0.0040969
	speed: 0.0594s/iter; left time: 2549.1769s
	iters: 300, epoch: 9 | loss: 0.0227637
	speed: 0.0589s/iter; left time: 2525.7755s
	iters: 400, epoch: 9 | loss: 0.0340217
	speed: 0.0559s/iter; left time: 2389.4343s
Epoch: 9 cost time: 28.185025453567505
Epoch: 9, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0746599
	speed: 0.2547s/iter; left time: 10846.8605s
	iters: 200, epoch: 10 | loss: 0.2778116
	speed: 0.0624s/iter; left time: 2651.8144s
	iters: 300, epoch: 10 | loss: 0.0343714
	speed: 0.0566s/iter; left time: 2399.9329s
	iters: 400, epoch: 10 | loss: 0.0039574
	speed: 0.0571s/iter; left time: 2416.2938s
Epoch: 10 cost time: 27.875731468200684
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0142240
	speed: 0.2570s/iter; left time: 10822.9323s
	iters: 200, epoch: 11 | loss: 0.0108550
	speed: 0.0591s/iter; left time: 2482.3961s
	iters: 300, epoch: 11 | loss: 0.0103788
	speed: 0.0570s/iter; left time: 2386.9115s
	iters: 400, epoch: 11 | loss: 0.0064990
	speed: 0.0573s/iter; left time: 2395.2807s
Epoch: 11 cost time: 27.11498737335205
Epoch: 11, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0112728
	speed: 0.2359s/iter; left time: 9822.1265s
	iters: 200, epoch: 12 | loss: 0.0093114
	speed: 0.0552s/iter; left time: 2292.5101s
	iters: 300, epoch: 12 | loss: 0.0032250
	speed: 0.0588s/iter; left time: 2435.5833s
	iters: 400, epoch: 12 | loss: 0.0066546
	speed: 0.0581s/iter; left time: 2403.7188s
Epoch: 12 cost time: 26.73075532913208
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0911087
	speed: 0.2334s/iter; left time: 9611.0953s
	iters: 200, epoch: 13 | loss: 0.0076866
	speed: 0.0578s/iter; left time: 2374.1660s
	iters: 300, epoch: 13 | loss: 0.1338877
	speed: 0.0548s/iter; left time: 2245.2109s
	iters: 400, epoch: 13 | loss: 0.2495952
	speed: 0.0556s/iter; left time: 2271.6079s
Epoch: 13 cost time: 26.248013257980347
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0409290
	speed: 0.2331s/iter; left time: 9487.0524s
	iters: 200, epoch: 14 | loss: 0.0169039
	speed: 0.0555s/iter; left time: 2251.6759s
	iters: 300, epoch: 14 | loss: 0.0522436
	speed: 0.0541s/iter; left time: 2190.7974s
	iters: 400, epoch: 14 | loss: 0.2202462
	speed: 0.0550s/iter; left time: 2221.9576s
Epoch: 14 cost time: 26.253423929214478
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.968838).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0201673
	speed: 0.2383s/iter; left time: 9589.6889s
	iters: 200, epoch: 15 | loss: 0.0507265
	speed: 0.0575s/iter; left time: 2308.3866s
	iters: 300, epoch: 15 | loss: 0.0242878
	speed: 0.0552s/iter; left time: 2209.1880s
	iters: 400, epoch: 15 | loss: 0.0008231
	speed: 0.0552s/iter; left time: 2204.2648s
Epoch: 15 cost time: 26.815807104110718
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969124).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0021755
	speed: 0.2460s/iter; left time: 9781.7721s
	iters: 200, epoch: 16 | loss: 0.0277688
	speed: 0.0564s/iter; left time: 2237.5077s
	iters: 300, epoch: 16 | loss: 0.0014432
	speed: 0.0527s/iter; left time: 2084.3105s
	iters: 400, epoch: 16 | loss: 0.0052505
	speed: 0.0547s/iter; left time: 2157.2952s
Epoch: 16 cost time: 26.233792543411255
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0059658
	speed: 0.2412s/iter; left time: 9476.9183s
	iters: 200, epoch: 17 | loss: 0.0010900
	speed: 0.0516s/iter; left time: 2023.9826s
	iters: 300, epoch: 17 | loss: 0.0051834
	speed: 0.0534s/iter; left time: 2089.7305s
	iters: 400, epoch: 17 | loss: 0.0080009
	speed: 0.0530s/iter; left time: 2066.0135s
Epoch: 17 cost time: 25.35467839241028
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.210 Vali Acc: 0.955 Test Loss: 0.210 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0119570
	speed: 0.2309s/iter; left time: 8964.3590s
	iters: 200, epoch: 18 | loss: 0.0034695
	speed: 0.0564s/iter; left time: 2184.4869s
	iters: 300, epoch: 18 | loss: 0.0014587
	speed: 0.0578s/iter; left time: 2233.3263s
	iters: 400, epoch: 18 | loss: 0.0016508
	speed: 0.0586s/iter; left time: 2256.2638s
Epoch: 18 cost time: 27.074851989746094
Epoch: 18, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971125).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0032056
	speed: 0.2554s/iter; left time: 9797.9070s
	iters: 200, epoch: 19 | loss: 0.0015088
	speed: 0.0578s/iter; left time: 2213.1089s
	iters: 300, epoch: 19 | loss: 0.0059455
	speed: 0.0558s/iter; left time: 2128.6597s
	iters: 400, epoch: 19 | loss: 0.0057759
	speed: 0.0570s/iter; left time: 2168.6533s
Epoch: 19 cost time: 26.999601364135742
Epoch: 19, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0016020
	speed: 0.2551s/iter; left time: 9664.4243s
	iters: 200, epoch: 20 | loss: 0.0022789
	speed: 0.0592s/iter; left time: 2236.0165s
	iters: 300, epoch: 20 | loss: 0.0031677
	speed: 0.0611s/iter; left time: 2302.3936s
	iters: 400, epoch: 20 | loss: 0.0021806
	speed: 0.0567s/iter; left time: 2131.7195s
Epoch: 20 cost time: 27.810466289520264
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.974556).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0059011
	speed: 0.2159s/iter; left time: 8078.3738s
	iters: 200, epoch: 21 | loss: 0.0144814
	speed: 0.0558s/iter; left time: 2080.7407s
	iters: 300, epoch: 21 | loss: 0.0071752
	speed: 0.0573s/iter; left time: 2133.5394s
	iters: 400, epoch: 21 | loss: 0.2338402
	speed: 0.0558s/iter; left time: 2070.8410s
Epoch: 21 cost time: 26.106459617614746
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2395873
	speed: 0.2333s/iter; left time: 8622.6498s
	iters: 200, epoch: 22 | loss: 0.0026644
	speed: 0.0539s/iter; left time: 1987.1688s
	iters: 300, epoch: 22 | loss: 0.0189090
	speed: 0.0554s/iter; left time: 2034.9546s
	iters: 400, epoch: 22 | loss: 0.0016578
	speed: 0.0560s/iter; left time: 2052.1719s
Epoch: 22 cost time: 26.512686729431152
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0645287
	speed: 0.2442s/iter; left time: 8907.8843s
	iters: 200, epoch: 23 | loss: 0.0014423
	speed: 0.0549s/iter; left time: 1998.8929s
	iters: 300, epoch: 23 | loss: 0.0005334
	speed: 0.0561s/iter; left time: 2037.1332s
	iters: 400, epoch: 23 | loss: 0.0189638
	speed: 0.0575s/iter; left time: 2079.4503s
Epoch: 23 cost time: 27.041287660598755
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0034789
	speed: 0.2348s/iter; left time: 8456.0552s
	iters: 200, epoch: 24 | loss: 0.0026292
	speed: 0.0540s/iter; left time: 1939.4531s
	iters: 300, epoch: 24 | loss: 0.0016709
	speed: 0.0525s/iter; left time: 1881.7706s
	iters: 400, epoch: 24 | loss: 0.0013187
	speed: 0.0531s/iter; left time: 1895.2227s
Epoch: 24 cost time: 25.55123543739319
Epoch: 24, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0033221
	speed: 0.2342s/iter; left time: 8324.1204s
	iters: 200, epoch: 25 | loss: 0.0035860
	speed: 0.0551s/iter; left time: 1953.9654s
	iters: 300, epoch: 25 | loss: 0.0035230
	speed: 0.0554s/iter; left time: 1958.8105s
	iters: 400, epoch: 25 | loss: 0.0025797
	speed: 0.0575s/iter; left time: 2024.9739s
Epoch: 25 cost time: 26.697770595550537
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0095183
	speed: 0.2437s/iter; left time: 8546.6360s
	iters: 200, epoch: 26 | loss: 0.1860797
	speed: 0.0565s/iter; left time: 1977.6609s
	iters: 300, epoch: 26 | loss: 0.0012785
	speed: 0.0543s/iter; left time: 1894.4894s
	iters: 400, epoch: 26 | loss: 0.0073030
	speed: 0.0557s/iter; left time: 1938.5321s
Epoch: 26 cost time: 26.822117567062378
Epoch: 26, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0171681
	speed: 0.2276s/iter; left time: 7876.5018s
	iters: 200, epoch: 27 | loss: 0.0019636
	speed: 0.0548s/iter; left time: 1892.3185s
	iters: 300, epoch: 27 | loss: 0.0006140
	speed: 0.0549s/iter; left time: 1889.3380s
	iters: 400, epoch: 27 | loss: 0.0181140
	speed: 0.0555s/iter; left time: 1902.9157s
Epoch: 27 cost time: 26.53562331199646
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.974842).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0021435
	speed: 0.2573s/iter; left time: 8783.5520s
	iters: 200, epoch: 28 | loss: 0.0009285
	speed: 0.0601s/iter; left time: 2046.6633s
	iters: 300, epoch: 28 | loss: 0.0202700
	speed: 0.0600s/iter; left time: 2035.9186s
	iters: 400, epoch: 28 | loss: 0.0376127
	speed: 0.0624s/iter; left time: 2112.1086s
Epoch: 28 cost time: 28.539801359176636
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.977415).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.1510012
	speed: 0.2535s/iter; left time: 8535.5193s
	iters: 200, epoch: 29 | loss: 0.0010696
	speed: 0.0618s/iter; left time: 2075.8371s
	iters: 300, epoch: 29 | loss: 0.0366178
	speed: 0.0605s/iter; left time: 2024.5124s
	iters: 400, epoch: 29 | loss: 0.0364018
	speed: 0.0570s/iter; left time: 1901.0268s
Epoch: 29 cost time: 28.26810884475708
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0294922
	speed: 0.2463s/iter; left time: 8176.0400s
	iters: 200, epoch: 30 | loss: 0.0057869
	speed: 0.0557s/iter; left time: 1844.9715s
	iters: 300, epoch: 30 | loss: 0.0046482
	speed: 0.0563s/iter; left time: 1859.0007s
	iters: 400, epoch: 30 | loss: 0.0007313
	speed: 0.0572s/iter; left time: 1882.8353s
Epoch: 30 cost time: 26.645444869995117
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0068232
	speed: 0.2389s/iter; left time: 7819.3733s
	iters: 200, epoch: 31 | loss: 0.0033956
	speed: 0.0584s/iter; left time: 1904.4075s
	iters: 300, epoch: 31 | loss: 0.0014651
	speed: 0.0564s/iter; left time: 1833.1671s
	iters: 400, epoch: 31 | loss: 0.0066800
	speed: 0.0534s/iter; left time: 1730.9641s
Epoch: 31 cost time: 26.71031904220581
Epoch: 31, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0206132
	speed: 0.2092s/iter; left time: 6749.4615s
	iters: 200, epoch: 32 | loss: 0.0034845
	speed: 0.0546s/iter; left time: 1754.5431s
	iters: 300, epoch: 32 | loss: 0.0005078
	speed: 0.0543s/iter; left time: 1739.8565s
	iters: 400, epoch: 32 | loss: 0.0001432
	speed: 0.0550s/iter; left time: 1758.6028s
Epoch: 32 cost time: 25.639710426330566
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0010918
	speed: 0.2427s/iter; left time: 7716.4927s
	iters: 200, epoch: 33 | loss: 0.0017940
	speed: 0.0539s/iter; left time: 1707.3963s
	iters: 300, epoch: 33 | loss: 0.0004756
	speed: 0.0537s/iter; left time: 1697.4350s
	iters: 400, epoch: 33 | loss: 0.0045609
	speed: 0.0564s/iter; left time: 1775.8505s
Epoch: 33 cost time: 26.060601472854614
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0050775
	speed: 0.2416s/iter; left time: 7569.1011s
	iters: 200, epoch: 34 | loss: 0.0003450
	speed: 0.0543s/iter; left time: 1695.8134s
	iters: 300, epoch: 34 | loss: 0.0174654
	speed: 0.0547s/iter; left time: 1702.0537s
	iters: 400, epoch: 34 | loss: 0.0014540
	speed: 0.0535s/iter; left time: 1659.4230s
Epoch: 34 cost time: 25.671008586883545
Epoch: 34, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0021190
	speed: 0.2412s/iter; left time: 7442.9188s
	iters: 200, epoch: 35 | loss: 0.0604086
	speed: 0.0553s/iter; left time: 1700.4774s
	iters: 300, epoch: 35 | loss: 0.0011818
	speed: 0.0551s/iter; left time: 1690.3765s
	iters: 400, epoch: 35 | loss: 0.0038906
	speed: 0.0561s/iter; left time: 1714.9407s
Epoch: 35 cost time: 26.445034503936768
Epoch: 35, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0766782
	speed: 0.2466s/iter; left time: 7493.8567s
	iters: 200, epoch: 36 | loss: 0.0017124
	speed: 0.0533s/iter; left time: 1615.0053s
	iters: 300, epoch: 36 | loss: 0.0027052
	speed: 0.0542s/iter; left time: 1635.7343s
	iters: 400, epoch: 36 | loss: 0.0006765
	speed: 0.0588s/iter; left time: 1769.4628s
Epoch: 36 cost time: 26.53627061843872
Epoch: 36, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0005804
	speed: 0.2556s/iter; left time: 7646.5477s
	iters: 200, epoch: 37 | loss: 0.0005051
	speed: 0.0557s/iter; left time: 1660.6011s
	iters: 300, epoch: 37 | loss: 0.0042729
	speed: 0.0588s/iter; left time: 1746.6240s
	iters: 400, epoch: 37 | loss: 0.0009429
	speed: 0.0638s/iter; left time: 1889.2916s
Epoch: 37 cost time: 28.421359300613403
Epoch: 37, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0003930
	speed: 0.2679s/iter; left time: 7890.5242s
	iters: 200, epoch: 38 | loss: 0.0017436
	speed: 0.0597s/iter; left time: 1752.1437s
	iters: 300, epoch: 38 | loss: 0.0040984
	speed: 0.0578s/iter; left time: 1690.9211s
	iters: 400, epoch: 38 | loss: 0.0005175
	speed: 0.0593s/iter; left time: 1729.4067s
Epoch: 38 cost time: 28.027443885803223
Epoch: 38, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 182298
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1853959
	speed: 0.0569s/iter; left time: 2663.1964s
	iters: 200, epoch: 1 | loss: 0.7287902
	speed: 0.0445s/iter; left time: 2078.1278s
	iters: 300, epoch: 1 | loss: 0.1290666
	speed: 0.0429s/iter; left time: 1997.1911s
	iters: 400, epoch: 1 | loss: 0.2682702
	speed: 0.0411s/iter; left time: 1913.3079s
Epoch: 1 cost time: 21.34312105178833
Epoch: 1, Steps: 469 | Train Loss: 0.444 Vali Loss: 0.268 Vali Acc: 0.923 Test Loss: 0.268 Test Acc: 0.923
Validation loss decreased (inf --> -0.922524).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3728218
	speed: 0.1756s/iter; left time: 8136.5765s
	iters: 200, epoch: 2 | loss: 0.1422932
	speed: 0.0416s/iter; left time: 1924.2962s
	iters: 300, epoch: 2 | loss: 0.2394997
	speed: 0.0425s/iter; left time: 1960.7859s
	iters: 400, epoch: 2 | loss: 0.0858530
	speed: 0.0421s/iter; left time: 1940.1357s
Epoch: 2 cost time: 20.170352697372437
Epoch: 2, Steps: 469 | Train Loss: 0.211 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2412107
	speed: 0.2034s/iter; left time: 9326.7873s
	iters: 200, epoch: 3 | loss: 0.0792753
	speed: 0.0464s/iter; left time: 2121.8107s
	iters: 300, epoch: 3 | loss: 0.0313225
	speed: 0.0425s/iter; left time: 1941.0101s
	iters: 400, epoch: 3 | loss: 0.1243889
	speed: 0.0418s/iter; left time: 1903.8881s
Epoch: 3 cost time: 20.7412166595459
Epoch: 3, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.922524 --> -0.932816).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0255571
	speed: 0.2141s/iter; left time: 9718.3567s
	iters: 200, epoch: 4 | loss: 0.2463673
	speed: 0.0437s/iter; left time: 1977.9041s
	iters: 300, epoch: 4 | loss: 0.0287833
	speed: 0.0420s/iter; left time: 1899.7385s
	iters: 400, epoch: 4 | loss: 0.0319995
	speed: 0.0421s/iter; left time: 1897.1903s
Epoch: 4 cost time: 20.458696603775024
Epoch: 4, Steps: 469 | Train Loss: 0.193 Vali Loss: 0.459 Vali Acc: 0.876 Test Loss: 0.459 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2371401
	speed: 0.2029s/iter; left time: 9115.2885s
	iters: 200, epoch: 5 | loss: 0.9133021
	speed: 0.0452s/iter; left time: 2025.1501s
	iters: 300, epoch: 5 | loss: 0.5332790
	speed: 0.0450s/iter; left time: 2011.1099s
	iters: 400, epoch: 5 | loss: 0.0492676
	speed: 0.0422s/iter; left time: 1881.2939s
Epoch: 5 cost time: 20.60725688934326
Epoch: 5, Steps: 469 | Train Loss: 0.444 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5958243
	speed: 0.2013s/iter; left time: 8948.1847s
	iters: 200, epoch: 6 | loss: 0.2430744
	speed: 0.0433s/iter; left time: 1919.1260s
	iters: 300, epoch: 6 | loss: 0.3113943
	speed: 0.0447s/iter; left time: 1977.3779s
	iters: 400, epoch: 6 | loss: 0.5249950
	speed: 0.0437s/iter; left time: 1927.7783s
Epoch: 6 cost time: 20.63505458831787
Epoch: 6, Steps: 469 | Train Loss: 0.482 Vali Loss: 0.875 Vali Acc: 0.714 Test Loss: 0.875 Test Acc: 0.714
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6596501
	speed: 0.2029s/iter; left time: 8926.0427s
	iters: 200, epoch: 7 | loss: 0.4526802
	speed: 0.0461s/iter; left time: 2024.3323s
	iters: 300, epoch: 7 | loss: 0.8075680
	speed: 0.0462s/iter; left time: 2023.0271s
	iters: 400, epoch: 7 | loss: 1.1194644
	speed: 0.0433s/iter; left time: 1891.5694s
Epoch: 7 cost time: 21.312795400619507
Epoch: 7, Steps: 469 | Train Loss: 0.498 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8939465
	speed: 0.1762s/iter; left time: 7667.3928s
	iters: 200, epoch: 8 | loss: 0.7499192
	speed: 0.0419s/iter; left time: 1817.0553s
	iters: 300, epoch: 8 | loss: 0.9415042
	speed: 0.0445s/iter; left time: 1929.6245s
	iters: 400, epoch: 8 | loss: 0.9283196
	speed: 0.0434s/iter; left time: 1877.2801s
Epoch: 8 cost time: 20.57321310043335
Epoch: 8, Steps: 469 | Train Loss: 0.741 Vali Loss: 1.367 Vali Acc: 0.618 Test Loss: 1.367 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.1090145
	speed: 0.2185s/iter; left time: 9407.1933s
	iters: 200, epoch: 9 | loss: 0.8554747
	speed: 0.0426s/iter; left time: 1828.5155s
	iters: 300, epoch: 9 | loss: 0.9877337
	speed: 0.0449s/iter; left time: 1922.7853s
	iters: 400, epoch: 9 | loss: 0.6425218
	speed: 0.0449s/iter; left time: 1921.1951s
Epoch: 9 cost time: 21.40968918800354
Epoch: 9, Steps: 469 | Train Loss: 1.031 Vali Loss: 0.766 Vali Acc: 0.745 Test Loss: 0.766 Test Acc: 0.745
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2201467
	speed: 0.2223s/iter; left time: 9464.6840s
	iters: 200, epoch: 10 | loss: 0.2865541
	speed: 0.0457s/iter; left time: 1941.6612s
	iters: 300, epoch: 10 | loss: 0.3897337
	speed: 0.0455s/iter; left time: 1929.6532s
	iters: 400, epoch: 10 | loss: 0.6327438
	speed: 0.0431s/iter; left time: 1820.7098s
Epoch: 10 cost time: 21.31548810005188
Epoch: 10, Steps: 469 | Train Loss: 0.684 Vali Loss: 0.649 Vali Acc: 0.782 Test Loss: 0.649 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.5021942
	speed: 0.2259s/iter; left time: 9514.5076s
	iters: 200, epoch: 11 | loss: 0.9131810
	speed: 0.0452s/iter; left time: 1896.8255s
	iters: 300, epoch: 11 | loss: 0.7959405
	speed: 0.0447s/iter; left time: 1873.4333s
	iters: 400, epoch: 11 | loss: 0.3574528
	speed: 0.0456s/iter; left time: 1906.3875s
Epoch: 11 cost time: 21.48809266090393
Epoch: 11, Steps: 469 | Train Loss: 0.724 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5554519
	speed: 0.2210s/iter; left time: 9202.3029s
	iters: 200, epoch: 12 | loss: 0.7640937
	speed: 0.0461s/iter; left time: 1915.6864s
	iters: 300, epoch: 12 | loss: 0.6970141
	speed: 0.0454s/iter; left time: 1881.9784s
	iters: 400, epoch: 12 | loss: 0.5378267
	speed: 0.0451s/iter; left time: 1864.8636s
Epoch: 12 cost time: 21.524062156677246
Epoch: 12, Steps: 469 | Train Loss: 0.628 Vali Loss: 0.690 Vali Acc: 0.786 Test Loss: 0.690 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.5821761
	speed: 0.2075s/iter; left time: 8544.8628s
	iters: 200, epoch: 13 | loss: 1.1589785
	speed: 0.0406s/iter; left time: 1665.9258s
	iters: 300, epoch: 13 | loss: 1.2979734
	speed: 0.0451s/iter; left time: 1846.9467s
	iters: 400, epoch: 13 | loss: 0.7272539
	speed: 0.0448s/iter; left time: 1829.7426s
Epoch: 13 cost time: 20.844191074371338
Epoch: 13, Steps: 469 | Train Loss: 0.662 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9328187535734705
model parameter : 7927086
model size : 35.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4077264
	speed: 0.0553s/iter; left time: 2587.6314s
	iters: 200, epoch: 1 | loss: 0.4176111
	speed: 0.0415s/iter; left time: 1938.0432s
	iters: 300, epoch: 1 | loss: 0.1158891
	speed: 0.0419s/iter; left time: 1951.7617s
	iters: 400, epoch: 1 | loss: 0.3235202
	speed: 0.0429s/iter; left time: 1997.0304s
Epoch: 1 cost time: 20.972659826278687
Epoch: 1, Steps: 469 | Train Loss: 0.441 Vali Loss: 0.289 Vali Acc: 0.927 Test Loss: 0.289 Test Acc: 0.927
Validation loss decreased (inf --> -0.926527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7236661
	speed: 0.2069s/iter; left time: 9584.3557s
	iters: 200, epoch: 2 | loss: 0.2294143
	speed: 0.0421s/iter; left time: 1944.8988s
	iters: 300, epoch: 2 | loss: 0.2682220
	speed: 0.0415s/iter; left time: 1916.1514s
	iters: 400, epoch: 2 | loss: 0.0979184
	speed: 0.0416s/iter; left time: 1913.9224s
Epoch: 2 cost time: 20.627545833587646
Epoch: 2, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
Validation loss decreased (-0.926527 --> -0.951398).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3550872
	speed: 0.2105s/iter; left time: 9653.9873s
	iters: 200, epoch: 3 | loss: 0.1348872
	speed: 0.0431s/iter; left time: 1973.1447s
	iters: 300, epoch: 3 | loss: 0.1780618
	speed: 0.0418s/iter; left time: 1909.2179s
	iters: 400, epoch: 3 | loss: 0.0155626
	speed: 0.0416s/iter; left time: 1897.0995s
Epoch: 3 cost time: 20.204723834991455
Epoch: 3, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.350 Vali Acc: 0.898 Test Loss: 0.350 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0103635
	speed: 0.1972s/iter; left time: 8950.1170s
	iters: 200, epoch: 4 | loss: 0.0325422
	speed: 0.0421s/iter; left time: 1907.4014s
	iters: 300, epoch: 4 | loss: 0.3109322
	speed: 0.0443s/iter; left time: 2001.2457s
	iters: 400, epoch: 4 | loss: 0.4751118
	speed: 0.0403s/iter; left time: 1816.9483s
Epoch: 4 cost time: 20.24940037727356
Epoch: 4, Steps: 469 | Train Loss: 0.238 Vali Loss: 0.377 Vali Acc: 0.882 Test Loss: 0.377 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3099779
	speed: 0.2002s/iter; left time: 8992.3664s
	iters: 200, epoch: 5 | loss: 0.1648215
	speed: 0.0446s/iter; left time: 2001.0910s
	iters: 300, epoch: 5 | loss: 0.1575348
	speed: 0.0443s/iter; left time: 1979.2468s
	iters: 400, epoch: 5 | loss: 0.2651610
	speed: 0.0445s/iter; left time: 1984.0689s
Epoch: 5 cost time: 20.988133907318115
Epoch: 5, Steps: 469 | Train Loss: 0.470 Vali Loss: 0.835 Vali Acc: 0.773 Test Loss: 0.835 Test Acc: 0.773
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7146125
	speed: 0.1869s/iter; left time: 8308.7202s
	iters: 200, epoch: 6 | loss: 0.3806510
	speed: 0.0383s/iter; left time: 1698.3507s
	iters: 300, epoch: 6 | loss: 0.2210225
	speed: 0.0402s/iter; left time: 1778.8144s
	iters: 400, epoch: 6 | loss: 0.1497729
	speed: 0.0433s/iter; left time: 1912.2690s
Epoch: 6 cost time: 19.622212648391724
Epoch: 6, Steps: 469 | Train Loss: 0.452 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7979568
	speed: 0.1948s/iter; left time: 8569.9675s
	iters: 200, epoch: 7 | loss: 0.2026884
	speed: 0.0447s/iter; left time: 1962.1159s
	iters: 300, epoch: 7 | loss: 0.1849403
	speed: 0.0436s/iter; left time: 1909.8027s
	iters: 400, epoch: 7 | loss: 0.3864746
	speed: 0.0425s/iter; left time: 1854.5727s
Epoch: 7 cost time: 20.844452619552612
Epoch: 7, Steps: 469 | Train Loss: 0.378 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.5825657
	speed: 0.2059s/iter; left time: 8960.5640s
	iters: 200, epoch: 8 | loss: 0.7005776
	speed: 0.0457s/iter; left time: 1984.9561s
	iters: 300, epoch: 8 | loss: 0.1418464
	speed: 0.0447s/iter; left time: 1934.3737s
	iters: 400, epoch: 8 | loss: 0.2434704
	speed: 0.0451s/iter; left time: 1947.6280s
Epoch: 8 cost time: 21.401917457580566
Epoch: 8, Steps: 469 | Train Loss: 0.407 Vali Loss: 0.535 Vali Acc: 0.837 Test Loss: 0.535 Test Acc: 0.837
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8013946
	speed: 0.2172s/iter; left time: 9350.9321s
	iters: 200, epoch: 9 | loss: 0.6561291
	speed: 0.0422s/iter; left time: 1813.5876s
	iters: 300, epoch: 9 | loss: 0.9727612
	speed: 0.0395s/iter; left time: 1691.3976s
	iters: 400, epoch: 9 | loss: 0.1154745
	speed: 0.0406s/iter; left time: 1737.0412s
Epoch: 9 cost time: 19.677058219909668
Epoch: 9, Steps: 469 | Train Loss: 0.375 Vali Loss: 0.565 Vali Acc: 0.864 Test Loss: 0.565 Test Acc: 0.864
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5897729
	speed: 0.1988s/iter; left time: 8466.9595s
	iters: 200, epoch: 10 | loss: 0.0629020
	speed: 0.0472s/iter; left time: 2006.9521s
	iters: 300, epoch: 10 | loss: 0.5652610
	speed: 0.0452s/iter; left time: 1915.7401s
	iters: 400, epoch: 10 | loss: 0.4050295
	speed: 0.0453s/iter; left time: 1915.9290s
Epoch: 10 cost time: 21.584325075149536
Epoch: 10, Steps: 469 | Train Loss: 0.294 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1808833
	speed: 0.2162s/iter; left time: 9103.8333s
	iters: 200, epoch: 11 | loss: 0.4057218
	speed: 0.0447s/iter; left time: 1879.8097s
	iters: 300, epoch: 11 | loss: 0.2971291
	speed: 0.0405s/iter; left time: 1699.1369s
	iters: 400, epoch: 11 | loss: 0.3464430
	speed: 0.0445s/iter; left time: 1859.6998s
Epoch: 11 cost time: 20.80706238746643
Epoch: 11, Steps: 469 | Train Loss: 0.361 Vali Loss: 0.556 Vali Acc: 0.865 Test Loss: 0.556 Test Acc: 0.865
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.5608475
	speed: 0.2023s/iter; left time: 8424.1318s
	iters: 200, epoch: 12 | loss: 0.2402276
	speed: 0.0419s/iter; left time: 1741.8766s
	iters: 300, epoch: 12 | loss: 0.3238877
	speed: 0.0402s/iter; left time: 1665.1939s
	iters: 400, epoch: 12 | loss: 0.4381006
	speed: 0.0427s/iter; left time: 1767.3210s
Epoch: 12 cost time: 20.00655961036682
Epoch: 12, Steps: 469 | Train Loss: 0.346 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9514008004574043
model parameter : 7926574
model size : 35.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1912287
	speed: 0.0641s/iter; left time: 3000.3486s
	iters: 200, epoch: 1 | loss: 0.4217162
	speed: 0.0462s/iter; left time: 2157.8256s
	iters: 300, epoch: 1 | loss: 0.1491586
	speed: 0.0445s/iter; left time: 2073.1240s
	iters: 400, epoch: 1 | loss: 0.4235264
	speed: 0.0451s/iter; left time: 2097.7034s
Epoch: 1 cost time: 23.159674882888794
Epoch: 1, Steps: 469 | Train Loss: 0.433 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
Validation loss decreased (inf --> -0.924812).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7195960
	speed: 0.2064s/iter; left time: 9563.9244s
	iters: 200, epoch: 2 | loss: 0.2041489
	speed: 0.0426s/iter; left time: 1967.6471s
	iters: 300, epoch: 2 | loss: 0.3924163
	speed: 0.0453s/iter; left time: 2088.8282s
	iters: 400, epoch: 2 | loss: 0.0351495
	speed: 0.0441s/iter; left time: 2030.6348s
Epoch: 2 cost time: 20.809265613555908
Epoch: 2, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.322 Vali Acc: 0.909 Test Loss: 0.322 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2206048
	speed: 0.2204s/iter; left time: 10107.3010s
	iters: 200, epoch: 3 | loss: 0.1008037
	speed: 0.0453s/iter; left time: 2073.6463s
	iters: 300, epoch: 3 | loss: 0.6529546
	speed: 0.0450s/iter; left time: 2056.3269s
	iters: 400, epoch: 3 | loss: 0.0312337
	speed: 0.0426s/iter; left time: 1941.8949s
Epoch: 3 cost time: 21.455736875534058
Epoch: 3, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.355 Vali Acc: 0.891 Test Loss: 0.355 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2293420
	speed: 0.2069s/iter; left time: 9393.9619s
	iters: 200, epoch: 4 | loss: 0.3417203
	speed: 0.0446s/iter; left time: 2021.3803s
	iters: 300, epoch: 4 | loss: 1.1470622
	speed: 0.0447s/iter; left time: 2018.8441s
	iters: 400, epoch: 4 | loss: 0.1714516
	speed: 0.0429s/iter; left time: 1936.6844s
Epoch: 4 cost time: 20.87992215156555
Epoch: 4, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.246 Vali Acc: 0.929 Test Loss: 0.246 Test Acc: 0.929
Validation loss decreased (-0.924812 --> -0.929100).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4897080
	speed: 0.2195s/iter; left time: 9862.1579s
	iters: 200, epoch: 5 | loss: 0.2745677
	speed: 0.0435s/iter; left time: 1949.5939s
	iters: 300, epoch: 5 | loss: 0.0736636
	speed: 0.0428s/iter; left time: 1913.3015s
	iters: 400, epoch: 5 | loss: 0.0649053
	speed: 0.0431s/iter; left time: 1922.9672s
Epoch: 5 cost time: 20.99286413192749
Epoch: 5, Steps: 469 | Train Loss: 0.297 Vali Loss: 0.613 Vali Acc: 0.808 Test Loss: 0.613 Test Acc: 0.808
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5323176
	speed: 0.2123s/iter; left time: 9438.2831s
	iters: 200, epoch: 6 | loss: 0.0140112
	speed: 0.0427s/iter; left time: 1894.5632s
	iters: 300, epoch: 6 | loss: 0.3429940
	speed: 0.0416s/iter; left time: 1840.7420s
	iters: 400, epoch: 6 | loss: 0.5570119
	speed: 0.0440s/iter; left time: 1940.8288s
Epoch: 6 cost time: 20.679131269454956
Epoch: 6, Steps: 469 | Train Loss: 0.291 Vali Loss: 0.431 Vali Acc: 0.888 Test Loss: 0.431 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5151293
	speed: 0.2240s/iter; left time: 9851.4422s
	iters: 200, epoch: 7 | loss: 0.0334392
	speed: 0.0476s/iter; left time: 2090.8468s
	iters: 300, epoch: 7 | loss: 0.0458455
	speed: 0.0483s/iter; left time: 2114.0462s
	iters: 400, epoch: 7 | loss: 0.2183400
	speed: 0.0469s/iter; left time: 2050.8253s
Epoch: 7 cost time: 22.804208278656006
Epoch: 7, Steps: 469 | Train Loss: 0.255 Vali Loss: 0.348 Vali Acc: 0.905 Test Loss: 0.348 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0261076
	speed: 0.2310s/iter; left time: 10052.7126s
	iters: 200, epoch: 8 | loss: 0.1017240
	speed: 0.0493s/iter; left time: 2139.1669s
	iters: 300, epoch: 8 | loss: 0.0963966
	speed: 0.0445s/iter; left time: 1927.0924s
	iters: 400, epoch: 8 | loss: 0.1580482
	speed: 0.0451s/iter; left time: 1948.1317s
Epoch: 8 cost time: 22.081709384918213
Epoch: 8, Steps: 469 | Train Loss: 0.272 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4495601
	speed: 0.2261s/iter; left time: 9731.4829s
	iters: 200, epoch: 9 | loss: 0.3715194
	speed: 0.0474s/iter; left time: 2037.8635s
	iters: 300, epoch: 9 | loss: 0.1338305
	speed: 0.0474s/iter; left time: 2029.9805s
	iters: 400, epoch: 9 | loss: 1.1367307
	speed: 0.0433s/iter; left time: 1849.3411s
Epoch: 9 cost time: 22.180291891098022
Epoch: 9, Steps: 469 | Train Loss: 0.395 Vali Loss: 0.443 Vali Acc: 0.878 Test Loss: 0.443 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0485089
	speed: 0.2064s/iter; left time: 8787.3790s
	iters: 200, epoch: 10 | loss: 0.1027226
	speed: 0.0417s/iter; left time: 1773.3226s
	iters: 300, epoch: 10 | loss: 0.0642518
	speed: 0.0404s/iter; left time: 1713.5262s
	iters: 400, epoch: 10 | loss: 0.1455347
	speed: 0.0423s/iter; left time: 1787.0315s
Epoch: 10 cost time: 20.22526454925537
Epoch: 10, Steps: 469 | Train Loss: 0.350 Vali Loss: 0.330 Vali Acc: 0.905 Test Loss: 0.330 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1630593
	speed: 0.2034s/iter; left time: 8567.2587s
	iters: 200, epoch: 11 | loss: 0.0803569
	speed: 0.0450s/iter; left time: 1888.8319s
	iters: 300, epoch: 11 | loss: 0.1687413
	speed: 0.0430s/iter; left time: 1802.8672s
	iters: 400, epoch: 11 | loss: 0.0086701
	speed: 0.0432s/iter; left time: 1805.8922s
Epoch: 11 cost time: 20.835617303848267
Epoch: 11, Steps: 469 | Train Loss: 0.241 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0816881
	speed: 0.1924s/iter; left time: 8011.0044s
	iters: 200, epoch: 12 | loss: 0.1825503
	speed: 0.0419s/iter; left time: 1742.2107s
	iters: 300, epoch: 12 | loss: 0.0530797
	speed: 0.0439s/iter; left time: 1820.5271s
	iters: 400, epoch: 12 | loss: 0.0970892
	speed: 0.0451s/iter; left time: 1862.9099s
Epoch: 12 cost time: 20.783331871032715
Epoch: 12, Steps: 469 | Train Loss: 0.282 Vali Loss: 0.479 Vali Acc: 0.871 Test Loss: 0.479 Test Acc: 0.871
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3293350
	speed: 0.2008s/iter; left time: 8267.5560s
	iters: 200, epoch: 13 | loss: 0.0325139
	speed: 0.0433s/iter; left time: 1779.2502s
	iters: 300, epoch: 13 | loss: 0.1345002
	speed: 0.0406s/iter; left time: 1664.0409s
	iters: 400, epoch: 13 | loss: 0.0143405
	speed: 0.0430s/iter; left time: 1758.2518s
Epoch: 13 cost time: 20.30231761932373
Epoch: 13, Steps: 469 | Train Loss: 0.221 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0287260
	speed: 0.2005s/iter; left time: 8161.7286s
	iters: 200, epoch: 14 | loss: 0.0145876
	speed: 0.0430s/iter; left time: 1746.1189s
	iters: 300, epoch: 14 | loss: 0.0469957
	speed: 0.0442s/iter; left time: 1788.5503s
	iters: 400, epoch: 14 | loss: 0.2722635
	speed: 0.0428s/iter; left time: 1729.9437s
Epoch: 14 cost time: 20.999972581863403
Epoch: 14, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.727 Vali Acc: 0.834 Test Loss: 0.727 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9291023441966838
model parameter : 7926062
model size : 35.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5249293
	speed: 0.0597s/iter; left time: 2795.4547s
	iters: 200, epoch: 1 | loss: 0.3983105
	speed: 0.0398s/iter; left time: 1860.0755s
	iters: 300, epoch: 1 | loss: 0.4009089
	speed: 0.0396s/iter; left time: 1845.3888s
	iters: 400, epoch: 1 | loss: 0.0142999
	speed: 0.0423s/iter; left time: 1967.3797s
Epoch: 1 cost time: 21.05439805984497
Epoch: 1, Steps: 469 | Train Loss: 0.431 Vali Loss: 0.363 Vali Acc: 0.876 Test Loss: 0.363 Test Acc: 0.876
Validation loss decreased (inf --> -0.875640).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1684175
	speed: 0.1950s/iter; left time: 9036.1690s
	iters: 200, epoch: 2 | loss: 0.3962600
	speed: 0.0436s/iter; left time: 2016.4089s
	iters: 300, epoch: 2 | loss: 0.1158596
	speed: 0.0424s/iter; left time: 1954.6854s
	iters: 400, epoch: 2 | loss: 0.3251788
	speed: 0.0412s/iter; left time: 1898.4650s
Epoch: 2 cost time: 20.256465435028076
Epoch: 2, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.374 Vali Acc: 0.880 Test Loss: 0.374 Test Acc: 0.880
Validation loss decreased (-0.875640 --> -0.880214).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0152495
	speed: 0.1961s/iter; left time: 8993.0812s
	iters: 200, epoch: 3 | loss: 0.1824349
	speed: 0.0465s/iter; left time: 2125.8913s
	iters: 300, epoch: 3 | loss: 0.1564048
	speed: 0.0447s/iter; left time: 2041.2845s
	iters: 400, epoch: 3 | loss: 0.2776538
	speed: 0.0455s/iter; left time: 2073.5362s
Epoch: 3 cost time: 21.430259704589844
Epoch: 3, Steps: 469 | Train Loss: 0.198 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3932307
	speed: 0.2187s/iter; left time: 9927.7763s
	iters: 200, epoch: 4 | loss: 0.4020465
	speed: 0.0456s/iter; left time: 2066.0713s
	iters: 300, epoch: 4 | loss: 0.1127466
	speed: 0.0455s/iter; left time: 2055.3447s
	iters: 400, epoch: 4 | loss: 0.0627361
	speed: 0.0459s/iter; left time: 2070.9674s
Epoch: 4 cost time: 21.71739387512207
Epoch: 4, Steps: 469 | Train Loss: 0.205 Vali Loss: 0.239 Vali Acc: 0.927 Test Loss: 0.239 Test Acc: 0.927
Validation loss decreased (-0.880214 --> -0.926813).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1386655
	speed: 0.2322s/iter; left time: 10433.7639s
	iters: 200, epoch: 5 | loss: 0.0160067
	speed: 0.0520s/iter; left time: 2332.6630s
	iters: 300, epoch: 5 | loss: 0.5078872
	speed: 0.0476s/iter; left time: 2127.3605s
	iters: 400, epoch: 5 | loss: 0.0324956
	speed: 0.0468s/iter; left time: 2089.6055s
Epoch: 5 cost time: 22.665637731552124
Epoch: 5, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6117305
	speed: 0.2167s/iter; left time: 9632.1869s
	iters: 200, epoch: 6 | loss: 0.3698502
	speed: 0.0443s/iter; left time: 1966.1274s
	iters: 300, epoch: 6 | loss: 0.4620436
	speed: 0.0445s/iter; left time: 1970.8586s
	iters: 400, epoch: 6 | loss: 0.1306006
	speed: 0.0457s/iter; left time: 2019.1796s
Epoch: 6 cost time: 21.774511337280273
Epoch: 6, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1466246
	speed: 0.1930s/iter; left time: 8488.3092s
	iters: 200, epoch: 7 | loss: 0.0566504
	speed: 0.0436s/iter; left time: 1915.2542s
	iters: 300, epoch: 7 | loss: 0.0383147
	speed: 0.0445s/iter; left time: 1949.5273s
	iters: 400, epoch: 7 | loss: 0.2255637
	speed: 0.0420s/iter; left time: 1833.7664s
Epoch: 7 cost time: 20.605135917663574
Epoch: 7, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.286 Vali Acc: 0.923 Test Loss: 0.286 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4227034
	speed: 0.2122s/iter; left time: 9233.0177s
	iters: 200, epoch: 8 | loss: 0.0943131
	speed: 0.0424s/iter; left time: 1842.7821s
	iters: 300, epoch: 8 | loss: 0.0801770
	speed: 0.0439s/iter; left time: 1900.6994s
	iters: 400, epoch: 8 | loss: 0.2202528
	speed: 0.0418s/iter; left time: 1805.4251s
Epoch: 8 cost time: 20.735257387161255
Epoch: 8, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
Validation loss decreased (-0.926813 --> -0.937962).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4374668
	speed: 0.2105s/iter; left time: 9062.3839s
	iters: 200, epoch: 9 | loss: 0.0429530
	speed: 0.0441s/iter; left time: 1893.2765s
	iters: 300, epoch: 9 | loss: 0.1411255
	speed: 0.0415s/iter; left time: 1778.4236s
	iters: 400, epoch: 9 | loss: 0.2584665
	speed: 0.0402s/iter; left time: 1716.9350s
Epoch: 9 cost time: 20.17931866645813
Epoch: 9, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3346034
	speed: 0.1659s/iter; left time: 7063.8985s
	iters: 200, epoch: 10 | loss: 0.1094802
	speed: 0.0447s/iter; left time: 1900.9726s
	iters: 300, epoch: 10 | loss: 0.0055808
	speed: 0.0443s/iter; left time: 1876.8183s
	iters: 400, epoch: 10 | loss: 0.0319099
	speed: 0.0450s/iter; left time: 1904.5958s
Epoch: 10 cost time: 21.09738779067993
Epoch: 10, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.272 Vali Acc: 0.921 Test Loss: 0.272 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0148128
	speed: 0.2207s/iter; left time: 9292.5545s
	iters: 200, epoch: 11 | loss: 0.2001685
	speed: 0.0437s/iter; left time: 1836.3944s
	iters: 300, epoch: 11 | loss: 0.0919033
	speed: 0.0443s/iter; left time: 1855.5335s
	iters: 400, epoch: 11 | loss: 0.0315163
	speed: 0.0459s/iter; left time: 1918.3289s
Epoch: 11 cost time: 21.308619737625122
Epoch: 11, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0152738
	speed: 0.2134s/iter; left time: 8885.0134s
	iters: 200, epoch: 12 | loss: 0.0256899
	speed: 0.0429s/iter; left time: 1782.7283s
	iters: 300, epoch: 12 | loss: 0.1607658
	speed: 0.0438s/iter; left time: 1815.9931s
	iters: 400, epoch: 12 | loss: 0.4189315
	speed: 0.0430s/iter; left time: 1778.2709s
Epoch: 12 cost time: 21.225101232528687
Epoch: 12, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.937962 --> -0.945967).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4412200
	speed: 0.2089s/iter; left time: 8599.3135s
	iters: 200, epoch: 13 | loss: 0.0721172
	speed: 0.0428s/iter; left time: 1757.7364s
	iters: 300, epoch: 13 | loss: 0.0533295
	speed: 0.0439s/iter; left time: 1799.1789s
	iters: 400, epoch: 13 | loss: 0.0141464
	speed: 0.0453s/iter; left time: 1849.6919s
Epoch: 13 cost time: 20.734578371047974
Epoch: 13, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.237 Vali Acc: 0.947 Test Loss: 0.237 Test Acc: 0.947
Validation loss decreased (-0.945967 --> -0.946824).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0049124
	speed: 0.2124s/iter; left time: 8644.3096s
	iters: 200, epoch: 14 | loss: 0.2893402
	speed: 0.0448s/iter; left time: 1818.6098s
	iters: 300, epoch: 14 | loss: 0.0073838
	speed: 0.0475s/iter; left time: 1922.7997s
	iters: 400, epoch: 14 | loss: 0.2307708
	speed: 0.0431s/iter; left time: 1742.5813s
Epoch: 14 cost time: 21.31922674179077
Epoch: 14, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0195460
	speed: 0.2182s/iter; left time: 8779.6719s
	iters: 200, epoch: 15 | loss: 0.0026429
	speed: 0.0462s/iter; left time: 1854.9108s
	iters: 300, epoch: 15 | loss: 0.0041447
	speed: 0.0448s/iter; left time: 1792.9556s
	iters: 400, epoch: 15 | loss: 0.0734877
	speed: 0.0441s/iter; left time: 1760.9284s
Epoch: 15 cost time: 21.61191749572754
Epoch: 15, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0062843
	speed: 0.2394s/iter; left time: 9521.9498s
	iters: 200, epoch: 16 | loss: 0.0104082
	speed: 0.0487s/iter; left time: 1932.8758s
	iters: 300, epoch: 16 | loss: 0.0042114
	speed: 0.0465s/iter; left time: 1840.2878s
	iters: 400, epoch: 16 | loss: 0.0041593
	speed: 0.0436s/iter; left time: 1719.7006s
Epoch: 16 cost time: 22.12741208076477
Epoch: 16, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7908623
	speed: 0.2164s/iter; left time: 8504.4406s
	iters: 200, epoch: 17 | loss: 0.1805813
	speed: 0.0440s/iter; left time: 1725.9336s
	iters: 300, epoch: 17 | loss: 0.7495379
	speed: 0.0459s/iter; left time: 1796.4467s
	iters: 400, epoch: 17 | loss: 0.0290138
	speed: 0.0465s/iter; left time: 1815.0202s
Epoch: 17 cost time: 21.87522602081299
Epoch: 17, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.934 Test Loss: 0.265 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0582124
	speed: 0.2351s/iter; left time: 9129.7068s
	iters: 200, epoch: 18 | loss: 0.1208010
	speed: 0.0441s/iter; left time: 1708.0041s
	iters: 300, epoch: 18 | loss: 0.0102457
	speed: 0.0433s/iter; left time: 1672.0726s
	iters: 400, epoch: 18 | loss: 0.0209545
	speed: 0.0430s/iter; left time: 1655.0400s
Epoch: 18 cost time: 21.01810574531555
Epoch: 18, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
Validation loss decreased (-0.946824 --> -0.952828).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0086505
	speed: 0.2120s/iter; left time: 8131.5742s
	iters: 200, epoch: 19 | loss: 0.0112703
	speed: 0.0435s/iter; left time: 1664.1641s
	iters: 300, epoch: 19 | loss: 0.0343143
	speed: 0.0437s/iter; left time: 1665.7907s
	iters: 400, epoch: 19 | loss: 0.0496477
	speed: 0.0414s/iter; left time: 1574.4996s
Epoch: 19 cost time: 20.800235748291016
Epoch: 19, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.941 Test Loss: 0.275 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0217375
	speed: 0.2110s/iter; left time: 7994.7009s
	iters: 200, epoch: 20 | loss: 0.0226363
	speed: 0.0476s/iter; left time: 1799.9877s
	iters: 300, epoch: 20 | loss: 0.0026143
	speed: 0.0462s/iter; left time: 1742.6777s
	iters: 400, epoch: 20 | loss: 0.0052453
	speed: 0.0442s/iter; left time: 1662.9486s
Epoch: 20 cost time: 21.780471563339233
Epoch: 20, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.223 Vali Acc: 0.955 Test Loss: 0.223 Test Acc: 0.955
Validation loss decreased (-0.952828 --> -0.955401).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0123904
	speed: 0.2113s/iter; left time: 7908.6302s
	iters: 200, epoch: 21 | loss: 0.0176626
	speed: 0.0438s/iter; left time: 1634.1065s
	iters: 300, epoch: 21 | loss: 0.0128276
	speed: 0.0451s/iter; left time: 1678.8443s
	iters: 400, epoch: 21 | loss: 0.0413389
	speed: 0.0402s/iter; left time: 1492.5173s
Epoch: 21 cost time: 20.679022312164307
Epoch: 21, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.955401 --> -0.963406).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0760839
	speed: 0.2188s/iter; left time: 8086.6862s
	iters: 200, epoch: 22 | loss: 0.0034589
	speed: 0.0412s/iter; left time: 1517.4056s
	iters: 300, epoch: 22 | loss: 0.5866674
	speed: 0.0429s/iter; left time: 1574.9040s
	iters: 400, epoch: 22 | loss: 0.2732171
	speed: 0.0423s/iter; left time: 1548.5860s
Epoch: 22 cost time: 20.322656393051147
Epoch: 22, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0845888
	speed: 0.2006s/iter; left time: 7319.4697s
	iters: 200, epoch: 23 | loss: 0.2082645
	speed: 0.0453s/iter; left time: 1647.8015s
	iters: 300, epoch: 23 | loss: 0.0680579
	speed: 0.0445s/iter; left time: 1615.3243s
	iters: 400, epoch: 23 | loss: 0.0121078
	speed: 0.0429s/iter; left time: 1553.6405s
Epoch: 23 cost time: 21.14599061012268
Epoch: 23, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4152490
	speed: 0.2157s/iter; left time: 7767.9360s
	iters: 200, epoch: 24 | loss: 0.0114422
	speed: 0.0448s/iter; left time: 1609.3458s
	iters: 300, epoch: 24 | loss: 0.7552242
	speed: 0.0486s/iter; left time: 1741.2034s
	iters: 400, epoch: 24 | loss: 0.0303286
	speed: 0.0441s/iter; left time: 1575.6345s
Epoch: 24 cost time: 21.715332508087158
Epoch: 24, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.237 Vali Acc: 0.955 Test Loss: 0.237 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0047180
	speed: 0.2041s/iter; left time: 7253.0659s
	iters: 200, epoch: 25 | loss: 0.1578093
	speed: 0.0443s/iter; left time: 1569.4136s
	iters: 300, epoch: 25 | loss: 0.1009614
	speed: 0.0467s/iter; left time: 1649.2917s
	iters: 400, epoch: 25 | loss: 0.0905382
	speed: 0.0455s/iter; left time: 1602.6974s
Epoch: 25 cost time: 21.244534730911255
Epoch: 25, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0059733
	speed: 0.2141s/iter; left time: 7510.2823s
	iters: 200, epoch: 26 | loss: 0.1370779
	speed: 0.0436s/iter; left time: 1526.3435s
	iters: 300, epoch: 26 | loss: 0.0562160
	speed: 0.0453s/iter; left time: 1580.9013s
	iters: 400, epoch: 26 | loss: 0.0010314
	speed: 0.0419s/iter; left time: 1457.0116s
Epoch: 26 cost time: 21.05545401573181
Epoch: 26, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2617652
	speed: 0.2065s/iter; left time: 7147.5701s
	iters: 200, epoch: 27 | loss: 0.1260784
	speed: 0.0439s/iter; left time: 1515.3292s
	iters: 300, epoch: 27 | loss: 0.0011740
	speed: 0.0437s/iter; left time: 1503.1626s
	iters: 400, epoch: 27 | loss: 0.0149822
	speed: 0.0443s/iter; left time: 1518.5922s
Epoch: 27 cost time: 20.860776901245117
Epoch: 27, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0028680
	speed: 0.2148s/iter; left time: 7333.1351s
	iters: 200, epoch: 28 | loss: 0.3391907
	speed: 0.0480s/iter; left time: 1632.3274s
	iters: 300, epoch: 28 | loss: 0.0311033
	speed: 0.0453s/iter; left time: 1536.2738s
	iters: 400, epoch: 28 | loss: 0.0177152
	speed: 0.0445s/iter; left time: 1504.7467s
Epoch: 28 cost time: 21.719685316085815
Epoch: 28, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.3427465
	speed: 0.2243s/iter; left time: 7551.0017s
	iters: 200, epoch: 29 | loss: 0.0085740
	speed: 0.0476s/iter; left time: 1598.7421s
	iters: 300, epoch: 29 | loss: 0.0451593
	speed: 0.0480s/iter; left time: 1604.9230s
	iters: 400, epoch: 29 | loss: 0.2156969
	speed: 0.0461s/iter; left time: 1538.7316s
Epoch: 29 cost time: 22.269468069076538
Epoch: 29, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963406 --> -0.967123).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0021248
	speed: 0.2339s/iter; left time: 7764.3250s
	iters: 200, epoch: 30 | loss: 0.0016363
	speed: 0.0474s/iter; left time: 1569.7091s
	iters: 300, epoch: 30 | loss: 0.0012920
	speed: 0.0473s/iter; left time: 1562.1627s
	iters: 400, epoch: 30 | loss: 0.0024843
	speed: 0.0500s/iter; left time: 1646.5154s
Epoch: 30 cost time: 22.920570850372314
Epoch: 30, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0241588
	speed: 0.2364s/iter; left time: 7736.7757s
	iters: 200, epoch: 31 | loss: 0.0004338
	speed: 0.0488s/iter; left time: 1590.9291s
	iters: 300, epoch: 31 | loss: 0.1637132
	speed: 0.0464s/iter; left time: 1508.4395s
	iters: 400, epoch: 31 | loss: 0.0015146
	speed: 0.0466s/iter; left time: 1511.5784s
Epoch: 31 cost time: 22.374741792678833
Epoch: 31, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0046027
	speed: 0.2249s/iter; left time: 7254.1116s
	iters: 200, epoch: 32 | loss: 0.0028429
	speed: 0.0434s/iter; left time: 1394.8608s
	iters: 300, epoch: 32 | loss: 0.1687727
	speed: 0.0435s/iter; left time: 1393.9607s
	iters: 400, epoch: 32 | loss: 0.0269037
	speed: 0.0420s/iter; left time: 1343.2633s
Epoch: 32 cost time: 20.64789056777954
Epoch: 32, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0018181
	speed: 0.2141s/iter; left time: 6806.3723s
	iters: 200, epoch: 33 | loss: 0.0120554
	speed: 0.0488s/iter; left time: 1547.6167s
	iters: 300, epoch: 33 | loss: 0.0078543
	speed: 0.0477s/iter; left time: 1506.2021s
	iters: 400, epoch: 33 | loss: 0.0318531
	speed: 0.0423s/iter; left time: 1332.3316s
Epoch: 33 cost time: 21.993999242782593
Epoch: 33, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.256 Vali Acc: 0.943 Test Loss: 0.256 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0064727
	speed: 0.2084s/iter; left time: 6529.0702s
	iters: 200, epoch: 34 | loss: 0.0050516
	speed: 0.0374s/iter; left time: 1166.3607s
	iters: 300, epoch: 34 | loss: 0.0245829
	speed: 0.0377s/iter; left time: 1174.3516s
	iters: 400, epoch: 34 | loss: 0.0029478
	speed: 0.0398s/iter; left time: 1233.5529s
Epoch: 34 cost time: 19.124403953552246
Epoch: 34, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.967123 --> -0.968838).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0810932
	speed: 0.2140s/iter; left time: 6603.2623s
	iters: 200, epoch: 35 | loss: 0.0028737
	speed: 0.0430s/iter; left time: 1323.3064s
	iters: 300, epoch: 35 | loss: 0.0961192
	speed: 0.0429s/iter; left time: 1314.5806s
	iters: 400, epoch: 35 | loss: 0.0020309
	speed: 0.0408s/iter; left time: 1247.6735s
Epoch: 35 cost time: 20.56809639930725
Epoch: 35, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0612852
	speed: 0.2080s/iter; left time: 6321.4610s
	iters: 200, epoch: 36 | loss: 0.0008157
	speed: 0.0416s/iter; left time: 1258.8696s
	iters: 300, epoch: 36 | loss: 0.0020564
	speed: 0.0415s/iter; left time: 1252.3157s
	iters: 400, epoch: 36 | loss: 0.0001927
	speed: 0.0407s/iter; left time: 1223.6713s
Epoch: 36 cost time: 20.082369804382324
Epoch: 36, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.953 Test Loss: 0.231 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0109748
	speed: 0.2080s/iter; left time: 6221.6059s
	iters: 200, epoch: 37 | loss: 0.0192458
	speed: 0.0449s/iter; left time: 1339.9557s
	iters: 300, epoch: 37 | loss: 0.0048313
	speed: 0.0450s/iter; left time: 1336.8563s
	iters: 400, epoch: 37 | loss: 0.0035643
	speed: 0.0418s/iter; left time: 1236.7891s
Epoch: 37 cost time: 20.790571451187134
Epoch: 37, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.271 Vali Acc: 0.945 Test Loss: 0.271 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0063226
	speed: 0.2131s/iter; left time: 6274.6038s
	iters: 200, epoch: 38 | loss: 0.0076495
	speed: 0.0415s/iter; left time: 1217.5431s
	iters: 300, epoch: 38 | loss: 0.0437638
	speed: 0.0405s/iter; left time: 1183.9167s
	iters: 400, epoch: 38 | loss: 0.0006213
	speed: 0.0426s/iter; left time: 1242.3510s
Epoch: 38 cost time: 20.27782940864563
Epoch: 38, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.253 Vali Acc: 0.936 Test Loss: 0.253 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0426952
	speed: 0.2142s/iter; left time: 6206.3395s
	iters: 200, epoch: 39 | loss: 0.1475032
	speed: 0.0417s/iter; left time: 1203.9185s
	iters: 300, epoch: 39 | loss: 0.0052876
	speed: 0.0438s/iter; left time: 1261.2772s
	iters: 400, epoch: 39 | loss: 0.0025947
	speed: 0.0416s/iter; left time: 1192.4465s
Epoch: 39 cost time: 20.20607280731201
Epoch: 39, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0041667
	speed: 0.2041s/iter; left time: 5818.0540s
	iters: 200, epoch: 40 | loss: 0.0685939
	speed: 0.0432s/iter; left time: 1227.3345s
	iters: 300, epoch: 40 | loss: 0.0039141
	speed: 0.0441s/iter; left time: 1248.8977s
	iters: 400, epoch: 40 | loss: 0.0000631
	speed: 0.0434s/iter; left time: 1223.6751s
Epoch: 40 cost time: 20.68240523338318
Epoch: 40, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
Validation loss decreased (-0.968838 --> -0.971983).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0010120
	speed: 0.2233s/iter; left time: 6261.9981s
	iters: 200, epoch: 41 | loss: 0.0127122
	speed: 0.0458s/iter; left time: 1280.2464s
	iters: 300, epoch: 41 | loss: 0.1044058
	speed: 0.0431s/iter; left time: 1199.0278s
	iters: 400, epoch: 41 | loss: 0.0015414
	speed: 0.0448s/iter; left time: 1242.0493s
Epoch: 41 cost time: 21.21609139442444
Epoch: 41, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.2049087
	speed: 0.2231s/iter; left time: 6152.4966s
	iters: 200, epoch: 42 | loss: 0.0010721
	speed: 0.0454s/iter; left time: 1248.4538s
	iters: 300, epoch: 42 | loss: 0.0057649
	speed: 0.0450s/iter; left time: 1230.7135s
	iters: 400, epoch: 42 | loss: 0.0029447
	speed: 0.0443s/iter; left time: 1208.1232s
Epoch: 42 cost time: 21.331215381622314
Epoch: 42, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.217 Vali Acc: 0.965 Test Loss: 0.217 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.2403198
	speed: 0.2252s/iter; left time: 6104.0647s
	iters: 200, epoch: 43 | loss: 0.4306482
	speed: 0.0459s/iter; left time: 1239.8283s
	iters: 300, epoch: 43 | loss: 0.0009242
	speed: 0.0445s/iter; left time: 1196.2689s
	iters: 400, epoch: 43 | loss: 0.0399903
	speed: 0.0436s/iter; left time: 1168.0121s
Epoch: 43 cost time: 21.286471605300903
Epoch: 43, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0064460
	speed: 0.2290s/iter; left time: 6099.4348s
	iters: 200, epoch: 44 | loss: 0.0002248
	speed: 0.0447s/iter; left time: 1185.4626s
	iters: 300, epoch: 44 | loss: 0.1753053
	speed: 0.0438s/iter; left time: 1158.1573s
	iters: 400, epoch: 44 | loss: 0.0022554
	speed: 0.0437s/iter; left time: 1151.8703s
Epoch: 44 cost time: 20.80999445915222
Epoch: 44, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0026116
	speed: 0.2161s/iter; left time: 5654.8828s
	iters: 200, epoch: 45 | loss: 0.1106596
	speed: 0.0418s/iter; left time: 1090.4952s
	iters: 300, epoch: 45 | loss: 0.0314636
	speed: 0.0408s/iter; left time: 1059.7162s
	iters: 400, epoch: 45 | loss: 0.1674614
	speed: 0.0432s/iter; left time: 1118.0361s
Epoch: 45 cost time: 20.310266256332397
Epoch: 45, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0089243
	speed: 0.2140s/iter; left time: 5498.8404s
	iters: 200, epoch: 46 | loss: 0.0345808
	speed: 0.0444s/iter; left time: 1137.5531s
	iters: 300, epoch: 46 | loss: 0.0010179
	speed: 0.0445s/iter; left time: 1134.0004s
	iters: 400, epoch: 46 | loss: 0.2091573
	speed: 0.0441s/iter; left time: 1120.2837s
Epoch: 46 cost time: 20.520795106887817
Epoch: 46, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0102620
	speed: 0.2013s/iter; left time: 5078.9592s
	iters: 200, epoch: 47 | loss: 0.0128384
	speed: 0.0427s/iter; left time: 1072.7224s
	iters: 300, epoch: 47 | loss: 0.0247304
	speed: 0.0409s/iter; left time: 1024.6515s
	iters: 400, epoch: 47 | loss: 0.0108019
	speed: 0.0406s/iter; left time: 1011.6772s
Epoch: 47 cost time: 20.101306676864624
Epoch: 47, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0424006
	speed: 0.2078s/iter; left time: 5144.3463s
	iters: 200, epoch: 48 | loss: 0.0584279
	speed: 0.0437s/iter; left time: 1076.9249s
	iters: 300, epoch: 48 | loss: 0.0003985
	speed: 0.0414s/iter; left time: 1015.8819s
	iters: 400, epoch: 48 | loss: 0.0401860
	speed: 0.0411s/iter; left time: 1004.9979s
Epoch: 48 cost time: 19.81479811668396
Epoch: 48, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0908193
	speed: 0.2086s/iter; left time: 5067.1010s
	iters: 200, epoch: 49 | loss: 0.0006082
	speed: 0.0419s/iter; left time: 1014.2030s
	iters: 300, epoch: 49 | loss: 0.0002694
	speed: 0.0402s/iter; left time: 968.9629s
	iters: 400, epoch: 49 | loss: 0.1204058
	speed: 0.0425s/iter; left time: 1020.1627s
Epoch: 49 cost time: 20.063884258270264
Epoch: 49, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.203 Vali Acc: 0.954 Test Loss: 0.203 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0001347
	speed: 0.2120s/iter; left time: 5050.9482s
	iters: 200, epoch: 50 | loss: 0.0003399
	speed: 0.0417s/iter; left time: 990.0885s
	iters: 300, epoch: 50 | loss: 0.0062028
	speed: 0.0426s/iter; left time: 1005.1752s
	iters: 400, epoch: 50 | loss: 0.0022572
	speed: 0.0430s/iter; left time: 1011.7554s
Epoch: 50 cost time: 20.394883155822754
Epoch: 50, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 7925550
model size : 35.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2484743
	speed: 0.0576s/iter; left time: 2696.4297s
	iters: 200, epoch: 1 | loss: 0.1460042
	speed: 0.0422s/iter; left time: 1970.1410s
	iters: 300, epoch: 1 | loss: 0.1320377
	speed: 0.0426s/iter; left time: 1986.8594s
	iters: 400, epoch: 1 | loss: 0.1247763
	speed: 0.0429s/iter; left time: 1997.0970s
Epoch: 1 cost time: 21.734840393066406
Epoch: 1, Steps: 469 | Train Loss: 0.438 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
Validation loss decreased (inf --> -0.884216).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2146913
	speed: 0.2102s/iter; left time: 9737.6820s
	iters: 200, epoch: 2 | loss: 0.2828167
	speed: 0.0446s/iter; left time: 2063.1168s
	iters: 300, epoch: 2 | loss: 0.0287735
	speed: 0.0449s/iter; left time: 2070.1415s
	iters: 400, epoch: 2 | loss: 0.1318383
	speed: 0.0415s/iter; left time: 1910.5007s
Epoch: 2 cost time: 21.126458883285522
Epoch: 2, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.383 Vali Acc: 0.897 Test Loss: 0.383 Test Acc: 0.897
Validation loss decreased (-0.884216 --> -0.897366).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2720527
	speed: 0.2131s/iter; left time: 9771.6224s
	iters: 200, epoch: 3 | loss: 0.2196285
	speed: 0.0435s/iter; left time: 1989.5047s
	iters: 300, epoch: 3 | loss: 0.0348536
	speed: 0.0454s/iter; left time: 2071.9084s
	iters: 400, epoch: 3 | loss: 0.2791476
	speed: 0.0451s/iter; left time: 2055.9921s
Epoch: 3 cost time: 21.060911893844604
Epoch: 3, Steps: 469 | Train Loss: 0.199 Vali Loss: 0.276 Vali Acc: 0.914 Test Loss: 0.276 Test Acc: 0.914
Validation loss decreased (-0.897366 --> -0.913662).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2293084
	speed: 0.2137s/iter; left time: 9700.6406s
	iters: 200, epoch: 4 | loss: 0.0803504
	speed: 0.0445s/iter; left time: 2013.5663s
	iters: 300, epoch: 4 | loss: 0.1410793
	speed: 0.0442s/iter; left time: 1998.0518s
	iters: 400, epoch: 4 | loss: 0.0883651
	speed: 0.0473s/iter; left time: 2132.4882s
Epoch: 4 cost time: 21.54724931716919
Epoch: 4, Steps: 469 | Train Loss: 0.201 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.913662 --> -0.937105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5382060
	speed: 0.2318s/iter; left time: 10415.4596s
	iters: 200, epoch: 5 | loss: 0.0930338
	speed: 0.0449s/iter; left time: 2011.1558s
	iters: 300, epoch: 5 | loss: 0.1637694
	speed: 0.0453s/iter; left time: 2024.9271s
	iters: 400, epoch: 5 | loss: 0.4177952
	speed: 0.0486s/iter; left time: 2169.2650s
Epoch: 5 cost time: 21.922799348831177
Epoch: 5, Steps: 469 | Train Loss: 0.412 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2073031
	speed: 0.2313s/iter; left time: 10282.2977s
	iters: 200, epoch: 6 | loss: 0.2430303
	speed: 0.0465s/iter; left time: 2061.4005s
	iters: 300, epoch: 6 | loss: 0.2408254
	speed: 0.0471s/iter; left time: 2083.3000s
	iters: 400, epoch: 6 | loss: 1.0487909
	speed: 0.0429s/iter; left time: 1893.9401s
Epoch: 6 cost time: 21.72892117500305
Epoch: 6, Steps: 469 | Train Loss: 0.440 Vali Loss: 0.555 Vali Acc: 0.832 Test Loss: 0.555 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7744017
	speed: 0.2173s/iter; left time: 9556.8995s
	iters: 200, epoch: 7 | loss: 0.4409330
	speed: 0.0459s/iter; left time: 2012.4434s
	iters: 300, epoch: 7 | loss: 0.2301631
	speed: 0.0438s/iter; left time: 1916.9106s
	iters: 400, epoch: 7 | loss: 0.2866282
	speed: 0.0456s/iter; left time: 1992.7108s
Epoch: 7 cost time: 21.876930952072144
Epoch: 7, Steps: 469 | Train Loss: 0.416 Vali Loss: 0.639 Vali Acc: 0.802 Test Loss: 0.639 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2618569
	speed: 0.2167s/iter; left time: 9431.7411s
	iters: 200, epoch: 8 | loss: 0.4487295
	speed: 0.0445s/iter; left time: 1933.6231s
	iters: 300, epoch: 8 | loss: 0.1148140
	speed: 0.0431s/iter; left time: 1868.9543s
	iters: 400, epoch: 8 | loss: 0.2031818
	speed: 0.0443s/iter; left time: 1915.1355s
Epoch: 8 cost time: 21.094103813171387
Epoch: 8, Steps: 469 | Train Loss: 0.388 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1578648
	speed: 0.2167s/iter; left time: 9327.6388s
	iters: 200, epoch: 9 | loss: 0.8271583
	speed: 0.0436s/iter; left time: 1870.9328s
	iters: 300, epoch: 9 | loss: 0.2933708
	speed: 0.0436s/iter; left time: 1867.9025s
	iters: 400, epoch: 9 | loss: 0.4952963
	speed: 0.0431s/iter; left time: 1841.8315s
Epoch: 9 cost time: 20.663683652877808
Epoch: 9, Steps: 469 | Train Loss: 0.378 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2242532
	speed: 0.2092s/iter; left time: 8906.2640s
	iters: 200, epoch: 10 | loss: 0.1067983
	speed: 0.0468s/iter; left time: 1989.8074s
	iters: 300, epoch: 10 | loss: 0.2230147
	speed: 0.0442s/iter; left time: 1872.6946s
	iters: 400, epoch: 10 | loss: 0.2362350
	speed: 0.0434s/iter; left time: 1836.8435s
Epoch: 10 cost time: 21.233147144317627
Epoch: 10, Steps: 469 | Train Loss: 0.335 Vali Loss: 0.523 Vali Acc: 0.873 Test Loss: 0.523 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3292301
	speed: 0.1955s/iter; left time: 8233.6150s
	iters: 200, epoch: 11 | loss: 0.2826290
	speed: 0.0419s/iter; left time: 1758.1759s
	iters: 300, epoch: 11 | loss: 0.3462652
	speed: 0.0442s/iter; left time: 1854.1108s
	iters: 400, epoch: 11 | loss: 0.6002094
	speed: 0.0408s/iter; left time: 1707.5243s
Epoch: 11 cost time: 20.03361678123474
Epoch: 11, Steps: 469 | Train Loss: 0.330 Vali Loss: 0.438 Vali Acc: 0.864 Test Loss: 0.438 Test Acc: 0.864
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2163308
	speed: 0.2176s/iter; left time: 9062.6572s
	iters: 200, epoch: 12 | loss: 0.3499382
	speed: 0.0437s/iter; left time: 1814.6081s
	iters: 300, epoch: 12 | loss: 0.2212612
	speed: 0.0426s/iter; left time: 1766.2634s
	iters: 400, epoch: 12 | loss: 0.5831203
	speed: 0.0446s/iter; left time: 1844.5818s
Epoch: 12 cost time: 20.916646480560303
Epoch: 12, Steps: 469 | Train Loss: 0.296 Vali Loss: 0.455 Vali Acc: 0.885 Test Loss: 0.455 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.2116650
	speed: 0.2118s/iter; left time: 8720.5151s
	iters: 200, epoch: 13 | loss: 0.7008892
	speed: 0.0452s/iter; left time: 1857.0695s
	iters: 300, epoch: 13 | loss: 0.3532484
	speed: 0.0477s/iter; left time: 1955.0590s
	iters: 400, epoch: 13 | loss: 0.1731035
	speed: 0.0456s/iter; left time: 1863.2638s
Epoch: 13 cost time: 21.466498374938965
Epoch: 13, Steps: 469 | Train Loss: 0.298 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1738451
	speed: 0.2123s/iter; left time: 8640.2878s
	iters: 200, epoch: 14 | loss: 0.8300232
	speed: 0.0424s/iter; left time: 1722.8141s
	iters: 300, epoch: 14 | loss: 0.1780600
	speed: 0.0435s/iter; left time: 1759.9281s
	iters: 400, epoch: 14 | loss: 0.7829489
	speed: 0.0435s/iter; left time: 1758.4168s
Epoch: 14 cost time: 20.742461681365967
Epoch: 14, Steps: 469 | Train Loss: 0.379 Vali Loss: 0.352 Vali Acc: 0.888 Test Loss: 0.352 Test Acc: 0.888
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9371069182389937
model parameter : 6613806
model size : 30.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3479971
	speed: 0.0575s/iter; left time: 2691.8119s
	iters: 200, epoch: 1 | loss: 0.4061713
	speed: 0.0448s/iter; left time: 2090.9360s
	iters: 300, epoch: 1 | loss: 0.1023261
	speed: 0.0425s/iter; left time: 1978.4793s
	iters: 400, epoch: 1 | loss: 0.0639559
	speed: 0.0444s/iter; left time: 2066.5077s
Epoch: 1 cost time: 22.044191360473633
Epoch: 1, Steps: 469 | Train Loss: 0.448 Vali Loss: 0.355 Vali Acc: 0.876 Test Loss: 0.355 Test Acc: 0.876
Validation loss decreased (inf --> -0.875640).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1047495
	speed: 0.2093s/iter; left time: 9699.0144s
	iters: 200, epoch: 2 | loss: 0.1270719
	speed: 0.0450s/iter; left time: 2081.7142s
	iters: 300, epoch: 2 | loss: 0.4931427
	speed: 0.0451s/iter; left time: 2078.7406s
	iters: 400, epoch: 2 | loss: 0.0461044
	speed: 0.0427s/iter; left time: 1966.4263s
Epoch: 2 cost time: 21.11353349685669
Epoch: 2, Steps: 469 | Train Loss: 0.189 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (-0.875640 --> -0.934532).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2163602
	speed: 0.2247s/iter; left time: 10305.8582s
	iters: 200, epoch: 3 | loss: 0.1568691
	speed: 0.0449s/iter; left time: 2054.7492s
	iters: 300, epoch: 3 | loss: 0.0734439
	speed: 0.0465s/iter; left time: 2124.0725s
	iters: 400, epoch: 3 | loss: 0.0565684
	speed: 0.0464s/iter; left time: 2113.6695s
Epoch: 3 cost time: 21.53581476211548
Epoch: 3, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.934532 --> -0.943108).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1026725
	speed: 0.2196s/iter; left time: 9967.1972s
	iters: 200, epoch: 4 | loss: 0.0101117
	speed: 0.0459s/iter; left time: 2077.9040s
	iters: 300, epoch: 4 | loss: 0.0682010
	speed: 0.0443s/iter; left time: 2001.0025s
	iters: 400, epoch: 4 | loss: 0.0370669
	speed: 0.0447s/iter; left time: 2017.4668s
Epoch: 4 cost time: 21.52902317047119
Epoch: 4, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0608035
	speed: 0.2229s/iter; left time: 10015.6137s
	iters: 200, epoch: 5 | loss: 0.0923167
	speed: 0.0439s/iter; left time: 1967.4018s
	iters: 300, epoch: 5 | loss: 0.6699448
	speed: 0.0457s/iter; left time: 2042.5194s
	iters: 400, epoch: 5 | loss: 0.5552247
	speed: 0.0462s/iter; left time: 2060.9598s
Epoch: 5 cost time: 21.470595359802246
Epoch: 5, Steps: 469 | Train Loss: 0.288 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3476278
	speed: 0.2105s/iter; left time: 9359.9062s
	iters: 200, epoch: 6 | loss: 0.0538019
	speed: 0.0428s/iter; left time: 1899.8821s
	iters: 300, epoch: 6 | loss: 0.3883415
	speed: 0.0447s/iter; left time: 1978.7927s
	iters: 400, epoch: 6 | loss: 1.3751184
	speed: 0.0431s/iter; left time: 1902.5864s
Epoch: 6 cost time: 20.641496658325195
Epoch: 6, Steps: 469 | Train Loss: 0.492 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4807960
	speed: 0.2091s/iter; left time: 9197.2002s
	iters: 200, epoch: 7 | loss: 0.7243340
	speed: 0.0453s/iter; left time: 1989.1996s
	iters: 300, epoch: 7 | loss: 1.5272781
	speed: 0.0435s/iter; left time: 1905.6818s
	iters: 400, epoch: 7 | loss: 0.1468637
	speed: 0.0422s/iter; left time: 1844.2176s
Epoch: 7 cost time: 20.928725481033325
Epoch: 7, Steps: 469 | Train Loss: 0.495 Vali Loss: 0.664 Vali Acc: 0.807 Test Loss: 0.664 Test Acc: 0.807
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1276578
	speed: 0.2095s/iter; left time: 9117.0848s
	iters: 200, epoch: 8 | loss: 0.5001621
	speed: 0.0440s/iter; left time: 1910.2972s
	iters: 300, epoch: 8 | loss: 0.1121237
	speed: 0.0480s/iter; left time: 2077.1408s
	iters: 400, epoch: 8 | loss: 0.0681828
	speed: 0.0450s/iter; left time: 1944.6129s
Epoch: 8 cost time: 21.527883291244507
Epoch: 8, Steps: 469 | Train Loss: 0.411 Vali Loss: 0.662 Vali Acc: 0.787 Test Loss: 0.662 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2558310
	speed: 0.2019s/iter; left time: 8693.0379s
	iters: 200, epoch: 9 | loss: 0.3345412
	speed: 0.0462s/iter; left time: 1982.7729s
	iters: 300, epoch: 9 | loss: 1.1730171
	speed: 0.0430s/iter; left time: 1840.8886s
	iters: 400, epoch: 9 | loss: 1.0988858
	speed: 0.0437s/iter; left time: 1870.0242s
Epoch: 9 cost time: 20.931544065475464
Epoch: 9, Steps: 469 | Train Loss: 0.393 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1830642
	speed: 0.2005s/iter; left time: 8538.4848s
	iters: 200, epoch: 10 | loss: 0.0574119
	speed: 0.0425s/iter; left time: 1803.2911s
	iters: 300, epoch: 10 | loss: 0.2326471
	speed: 0.0431s/iter; left time: 1825.6046s
	iters: 400, epoch: 10 | loss: 0.3529779
	speed: 0.0460s/iter; left time: 1944.5150s
Epoch: 10 cost time: 20.76488995552063
Epoch: 10, Steps: 469 | Train Loss: 0.315 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6419008
	speed: 0.2035s/iter; left time: 8569.6825s
	iters: 200, epoch: 11 | loss: 0.4711519
	speed: 0.0427s/iter; left time: 1794.7969s
	iters: 300, epoch: 11 | loss: 0.3762423
	speed: 0.0430s/iter; left time: 1800.1998s
	iters: 400, epoch: 11 | loss: 0.1860625
	speed: 0.0443s/iter; left time: 1854.1130s
Epoch: 11 cost time: 20.584386110305786
Epoch: 11, Steps: 469 | Train Loss: 0.323 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4380603
	speed: 0.2007s/iter; left time: 8356.0951s
	iters: 200, epoch: 12 | loss: 0.1696008
	speed: 0.0419s/iter; left time: 1739.8953s
	iters: 300, epoch: 12 | loss: 0.0654323
	speed: 0.0422s/iter; left time: 1750.8852s
	iters: 400, epoch: 12 | loss: 0.7018437
	speed: 0.0413s/iter; left time: 1705.8102s
Epoch: 12 cost time: 19.539117336273193
Epoch: 12, Steps: 469 | Train Loss: 0.300 Vali Loss: 0.427 Vali Acc: 0.854 Test Loss: 0.427 Test Acc: 0.854
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0496737
	speed: 0.2045s/iter; left time: 8420.0539s
	iters: 200, epoch: 13 | loss: 0.3865236
	speed: 0.0448s/iter; left time: 1839.8729s
	iters: 300, epoch: 13 | loss: 0.3491682
	speed: 0.0455s/iter; left time: 1864.0021s
	iters: 400, epoch: 13 | loss: 0.1405069
	speed: 0.0444s/iter; left time: 1814.5791s
Epoch: 13 cost time: 21.299747705459595
Epoch: 13, Steps: 469 | Train Loss: 0.236 Vali Loss: 0.281 Vali Acc: 0.921 Test Loss: 0.281 Test Acc: 0.921
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9431103487707261
model parameter : 6613294
model size : 30.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6798165
	speed: 0.0575s/iter; left time: 2692.7076s
	iters: 200, epoch: 1 | loss: 0.2258953
	speed: 0.0433s/iter; left time: 2022.6941s
	iters: 300, epoch: 1 | loss: 0.5234407
	speed: 0.0413s/iter; left time: 1922.3371s
	iters: 400, epoch: 1 | loss: 0.1333345
	speed: 0.0415s/iter; left time: 1929.2605s
Epoch: 1 cost time: 21.441347360610962
Epoch: 1, Steps: 469 | Train Loss: 0.427 Vali Loss: 0.475 Vali Acc: 0.839 Test Loss: 0.475 Test Acc: 0.839
Validation loss decreased (inf --> -0.839332).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3016280
	speed: 0.2026s/iter; left time: 9387.7110s
	iters: 200, epoch: 2 | loss: 0.0982029
	speed: 0.0509s/iter; left time: 2354.1673s
	iters: 300, epoch: 2 | loss: 0.0390192
	speed: 0.0420s/iter; left time: 1939.3707s
	iters: 400, epoch: 2 | loss: 0.4015135
	speed: 0.0418s/iter; left time: 1923.8302s
Epoch: 2 cost time: 21.106865167617798
Epoch: 2, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.839332 --> -0.917093).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1471084
	speed: 0.2038s/iter; left time: 9347.2322s
	iters: 200, epoch: 3 | loss: 0.4550822
	speed: 0.0444s/iter; left time: 2031.1735s
	iters: 300, epoch: 3 | loss: 0.0084298
	speed: 0.0442s/iter; left time: 2018.3542s
	iters: 400, epoch: 3 | loss: 0.0313192
	speed: 0.0464s/iter; left time: 2113.9402s
Epoch: 3 cost time: 21.600775003433228
Epoch: 3, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
Validation loss decreased (-0.917093 --> -0.932245).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3783700
	speed: 0.2323s/iter; left time: 10543.1288s
	iters: 200, epoch: 4 | loss: 0.2322401
	speed: 0.0479s/iter; left time: 2169.6610s
	iters: 300, epoch: 4 | loss: 0.1997910
	speed: 0.0473s/iter; left time: 2136.0887s
	iters: 400, epoch: 4 | loss: 0.0476941
	speed: 0.0461s/iter; left time: 2081.0316s
Epoch: 4 cost time: 22.23628330230713
Epoch: 4, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.297 Vali Acc: 0.909 Test Loss: 0.297 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0421878
	speed: 0.2222s/iter; left time: 9982.1827s
	iters: 200, epoch: 5 | loss: 0.2828377
	speed: 0.0452s/iter; left time: 2028.0400s
	iters: 300, epoch: 5 | loss: 0.0552628
	speed: 0.0439s/iter; left time: 1964.4826s
	iters: 400, epoch: 5 | loss: 0.0333688
	speed: 0.0425s/iter; left time: 1897.5410s
Epoch: 5 cost time: 21.024243116378784
Epoch: 5, Steps: 469 | Train Loss: 0.259 Vali Loss: 0.379 Vali Acc: 0.905 Test Loss: 0.379 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1338134
	speed: 0.2052s/iter; left time: 9121.1385s
	iters: 200, epoch: 6 | loss: 0.2474391
	speed: 0.0456s/iter; left time: 2020.6799s
	iters: 300, epoch: 6 | loss: 0.1009495
	speed: 0.0469s/iter; left time: 2077.6470s
	iters: 400, epoch: 6 | loss: 0.7817271
	speed: 0.0464s/iter; left time: 2046.8903s
Epoch: 6 cost time: 21.789855480194092
Epoch: 6, Steps: 469 | Train Loss: 0.399 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1112143
	speed: 0.2057s/iter; left time: 9046.0129s
	iters: 200, epoch: 7 | loss: 0.4823040
	speed: 0.0441s/iter; left time: 1936.0562s
	iters: 300, epoch: 7 | loss: 0.1430915
	speed: 0.0454s/iter; left time: 1985.9399s
	iters: 400, epoch: 7 | loss: 0.0762465
	speed: 0.0432s/iter; left time: 1886.1100s
Epoch: 7 cost time: 21.38749361038208
Epoch: 7, Steps: 469 | Train Loss: 0.420 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2602778
	speed: 0.2035s/iter; left time: 8856.3344s
	iters: 200, epoch: 8 | loss: 0.3999177
	speed: 0.0454s/iter; left time: 1970.6831s
	iters: 300, epoch: 8 | loss: 0.0217673
	speed: 0.0445s/iter; left time: 1927.9257s
	iters: 400, epoch: 8 | loss: 0.0629113
	speed: 0.0438s/iter; left time: 1894.8052s
Epoch: 8 cost time: 21.270392894744873
Epoch: 8, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.436 Vali Acc: 0.878 Test Loss: 0.436 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0364904
	speed: 0.2066s/iter; left time: 8894.5263s
	iters: 200, epoch: 9 | loss: 0.1017899
	speed: 0.0454s/iter; left time: 1951.1271s
	iters: 300, epoch: 9 | loss: 0.0765356
	speed: 0.0448s/iter; left time: 1918.0639s
	iters: 400, epoch: 9 | loss: 0.5243191
	speed: 0.0426s/iter; left time: 1822.9741s
Epoch: 9 cost time: 21.041171550750732
Epoch: 9, Steps: 469 | Train Loss: 0.322 Vali Loss: 0.396 Vali Acc: 0.899 Test Loss: 0.396 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7434182
	speed: 0.2073s/iter; left time: 8826.5564s
	iters: 200, epoch: 10 | loss: 0.0122913
	speed: 0.0448s/iter; left time: 1903.1644s
	iters: 300, epoch: 10 | loss: 0.2120103
	speed: 0.0478s/iter; left time: 2024.5022s
	iters: 400, epoch: 10 | loss: 0.3636233
	speed: 0.0466s/iter; left time: 1971.5860s
Epoch: 10 cost time: 21.56174397468567
Epoch: 10, Steps: 469 | Train Loss: 0.278 Vali Loss: 0.453 Vali Acc: 0.881 Test Loss: 0.453 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4846748
	speed: 0.2029s/iter; left time: 8545.1167s
	iters: 200, epoch: 11 | loss: 1.2857895
	speed: 0.0454s/iter; left time: 1905.9567s
	iters: 300, epoch: 11 | loss: 0.9768428
	speed: 0.0449s/iter; left time: 1881.2078s
	iters: 400, epoch: 11 | loss: 0.3299176
	speed: 0.0434s/iter; left time: 1816.0706s
Epoch: 11 cost time: 21.42912268638611
Epoch: 11, Steps: 469 | Train Loss: 0.273 Vali Loss: 0.336 Vali Acc: 0.905 Test Loss: 0.336 Test Acc: 0.905
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2186611
	speed: 0.2117s/iter; left time: 8814.9633s
	iters: 200, epoch: 12 | loss: 0.1567757
	speed: 0.0450s/iter; left time: 1871.0496s
	iters: 300, epoch: 12 | loss: 0.1035504
	speed: 0.0434s/iter; left time: 1797.9860s
	iters: 400, epoch: 12 | loss: 0.3303091
	speed: 0.0466s/iter; left time: 1928.4398s
Epoch: 12 cost time: 21.47388792037964
Epoch: 12, Steps: 469 | Train Loss: 0.261 Vali Loss: 0.539 Vali Acc: 0.860 Test Loss: 0.539 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1458636
	speed: 0.2032s/iter; left time: 8364.8579s
	iters: 200, epoch: 13 | loss: 0.2137749
	speed: 0.0447s/iter; left time: 1836.4078s
	iters: 300, epoch: 13 | loss: 0.0513767
	speed: 0.0449s/iter; left time: 1840.2218s
	iters: 400, epoch: 13 | loss: 0.2446431
	speed: 0.0444s/iter; left time: 1813.2539s
Epoch: 13 cost time: 21.15959405899048
Epoch: 13, Steps: 469 | Train Loss: 0.258 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9322469982847341
model parameter : 6612782
model size : 30.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5160661
	speed: 0.0543s/iter; left time: 2539.2096s
	iters: 200, epoch: 1 | loss: 0.6632462
	speed: 0.0414s/iter; left time: 1932.9443s
	iters: 300, epoch: 1 | loss: 0.2317610
	speed: 0.0415s/iter; left time: 1933.2436s
	iters: 400, epoch: 1 | loss: 0.1904160
	speed: 0.0434s/iter; left time: 2018.0672s
Epoch: 1 cost time: 21.156803369522095
Epoch: 1, Steps: 469 | Train Loss: 0.452 Vali Loss: 0.276 Vali Acc: 0.916 Test Loss: 0.276 Test Acc: 0.916
Validation loss decreased (inf --> -0.915949).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2247614
	speed: 0.2209s/iter; left time: 10233.8237s
	iters: 200, epoch: 2 | loss: 0.9842204
	speed: 0.0447s/iter; left time: 2066.1176s
	iters: 300, epoch: 2 | loss: 0.0428761
	speed: 0.0447s/iter; left time: 2060.7817s
	iters: 400, epoch: 2 | loss: 0.6169851
	speed: 0.0446s/iter; left time: 2051.8808s
Epoch: 2 cost time: 21.25740623474121
Epoch: 2, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.416 Vali Acc: 0.886 Test Loss: 0.416 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2236079
	speed: 0.2171s/iter; left time: 9954.7850s
	iters: 200, epoch: 3 | loss: 0.3213853
	speed: 0.0434s/iter; left time: 1987.2744s
	iters: 300, epoch: 3 | loss: 0.0822725
	speed: 0.0437s/iter; left time: 1996.0092s
	iters: 400, epoch: 3 | loss: 0.0155866
	speed: 0.0430s/iter; left time: 1959.0316s
Epoch: 3 cost time: 20.67798089981079
Epoch: 3, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.283 Vali Acc: 0.923 Test Loss: 0.283 Test Acc: 0.923
Validation loss decreased (-0.915949 --> -0.923382).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4183601
	speed: 0.2103s/iter; left time: 9544.9333s
	iters: 200, epoch: 4 | loss: 0.0146777
	speed: 0.0427s/iter; left time: 1936.1532s
	iters: 300, epoch: 4 | loss: 0.1639496
	speed: 0.0448s/iter; left time: 2026.4361s
	iters: 400, epoch: 4 | loss: 0.1022224
	speed: 0.0430s/iter; left time: 1937.1637s
Epoch: 4 cost time: 20.469823122024536
Epoch: 4, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3924551
	speed: 0.2181s/iter; left time: 9798.4046s
	iters: 200, epoch: 5 | loss: 0.0770728
	speed: 0.0434s/iter; left time: 1944.2833s
	iters: 300, epoch: 5 | loss: 0.1566610
	speed: 0.0441s/iter; left time: 1971.0387s
	iters: 400, epoch: 5 | loss: 0.1506507
	speed: 0.0428s/iter; left time: 1910.5977s
Epoch: 5 cost time: 20.656736850738525
Epoch: 5, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.923382 --> -0.930243).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5439541
	speed: 0.2045s/iter; left time: 9091.7315s
	iters: 200, epoch: 6 | loss: 0.3175229
	speed: 0.0432s/iter; left time: 1914.1286s
	iters: 300, epoch: 6 | loss: 0.0210080
	speed: 0.0435s/iter; left time: 1925.0639s
	iters: 400, epoch: 6 | loss: 0.3292575
	speed: 0.0434s/iter; left time: 1914.2825s
Epoch: 6 cost time: 20.346453428268433
Epoch: 6, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.930243 --> -0.944251).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1239708
	speed: 0.2089s/iter; left time: 9187.8432s
	iters: 200, epoch: 7 | loss: 0.1464805
	speed: 0.0442s/iter; left time: 1941.0221s
	iters: 300, epoch: 7 | loss: 0.2057935
	speed: 0.0448s/iter; left time: 1962.2503s
	iters: 400, epoch: 7 | loss: 0.2062682
	speed: 0.0448s/iter; left time: 1956.2313s
Epoch: 7 cost time: 21.356508016586304
Epoch: 7, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.366 Vali Acc: 0.887 Test Loss: 0.366 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0044160
	speed: 0.2076s/iter; left time: 9034.6978s
	iters: 200, epoch: 8 | loss: 0.0865688
	speed: 0.0454s/iter; left time: 1973.2183s
	iters: 300, epoch: 8 | loss: 0.0053506
	speed: 0.0462s/iter; left time: 1999.6812s
	iters: 400, epoch: 8 | loss: 0.0399280
	speed: 0.0441s/iter; left time: 1905.2869s
Epoch: 8 cost time: 21.37148690223694
Epoch: 8, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0034647
	speed: 0.1976s/iter; left time: 8508.0643s
	iters: 200, epoch: 9 | loss: 0.1428866
	speed: 0.0438s/iter; left time: 1880.7305s
	iters: 300, epoch: 9 | loss: 0.0076858
	speed: 0.0421s/iter; left time: 1805.9416s
	iters: 400, epoch: 9 | loss: 0.0473960
	speed: 0.0420s/iter; left time: 1795.9783s
Epoch: 9 cost time: 20.504894971847534
Epoch: 9, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
Validation loss decreased (-0.944251 --> -0.953400).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0067813
	speed: 0.2084s/iter; left time: 8874.1104s
	iters: 200, epoch: 10 | loss: 0.1302218
	speed: 0.0444s/iter; left time: 1886.0959s
	iters: 300, epoch: 10 | loss: 0.0040001
	speed: 0.0444s/iter; left time: 1883.3111s
	iters: 400, epoch: 10 | loss: 0.2400663
	speed: 0.0438s/iter; left time: 1852.5947s
Epoch: 10 cost time: 20.9574031829834
Epoch: 10, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0830288
	speed: 0.2024s/iter; left time: 8522.9225s
	iters: 200, epoch: 11 | loss: 0.0525708
	speed: 0.0424s/iter; left time: 1781.0028s
	iters: 300, epoch: 11 | loss: 0.0123304
	speed: 0.0440s/iter; left time: 1844.6579s
	iters: 400, epoch: 11 | loss: 0.1783078
	speed: 0.0440s/iter; left time: 1840.6533s
Epoch: 11 cost time: 20.810645818710327
Epoch: 11, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.223 Vali Acc: 0.945 Test Loss: 0.223 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0051349
	speed: 0.1959s/iter; left time: 8158.8463s
	iters: 200, epoch: 12 | loss: 0.0107919
	speed: 0.0437s/iter; left time: 1816.6905s
	iters: 300, epoch: 12 | loss: 0.0586588
	speed: 0.0417s/iter; left time: 1726.1284s
	iters: 400, epoch: 12 | loss: 0.4101427
	speed: 0.0415s/iter; left time: 1715.2106s
Epoch: 12 cost time: 20.07090950012207
Epoch: 12, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.381 Vali Acc: 0.905 Test Loss: 0.381 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1552048
	speed: 0.1977s/iter; left time: 8140.9525s
	iters: 200, epoch: 13 | loss: 0.0136323
	speed: 0.0435s/iter; left time: 1785.0762s
	iters: 300, epoch: 13 | loss: 0.0091253
	speed: 0.0452s/iter; left time: 1850.0370s
	iters: 400, epoch: 13 | loss: 0.1897341
	speed: 0.0445s/iter; left time: 1818.1488s
Epoch: 13 cost time: 20.701085567474365
Epoch: 13, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.268 Vali Acc: 0.929 Test Loss: 0.268 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0053077
	speed: 0.2063s/iter; left time: 8399.0257s
	iters: 200, epoch: 14 | loss: 0.0072691
	speed: 0.0423s/iter; left time: 1717.4154s
	iters: 300, epoch: 14 | loss: 0.0822102
	speed: 0.0427s/iter; left time: 1729.8445s
	iters: 400, epoch: 14 | loss: 0.2784217
	speed: 0.0427s/iter; left time: 1723.6488s
Epoch: 14 cost time: 20.347582817077637
Epoch: 14, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1598830
	speed: 0.2055s/iter; left time: 8266.4971s
	iters: 200, epoch: 15 | loss: 0.0201245
	speed: 0.0425s/iter; left time: 1706.4132s
	iters: 300, epoch: 15 | loss: 0.0336341
	speed: 0.0443s/iter; left time: 1771.8584s
	iters: 400, epoch: 15 | loss: 0.0713440
	speed: 0.0438s/iter; left time: 1749.9876s
Epoch: 15 cost time: 20.674290418624878
Epoch: 15, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0254821
	speed: 0.2143s/iter; left time: 8520.6449s
	iters: 200, epoch: 16 | loss: 0.2114599
	speed: 0.0456s/iter; left time: 1808.7448s
	iters: 300, epoch: 16 | loss: 0.2498432
	speed: 0.0440s/iter; left time: 1739.9513s
	iters: 400, epoch: 16 | loss: 0.0424408
	speed: 0.0436s/iter; left time: 1719.0717s
Epoch: 16 cost time: 21.056774616241455
Epoch: 16, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3397487
	speed: 0.2173s/iter; left time: 8538.5205s
	iters: 200, epoch: 17 | loss: 0.0014496
	speed: 0.0433s/iter; left time: 1697.3345s
	iters: 300, epoch: 17 | loss: 0.8506746
	speed: 0.0451s/iter; left time: 1762.6556s
	iters: 400, epoch: 17 | loss: 0.0028312
	speed: 0.0451s/iter; left time: 1757.0344s
Epoch: 17 cost time: 21.262094020843506
Epoch: 17, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.323 Vali Acc: 0.921 Test Loss: 0.323 Test Acc: 0.921
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2865615
	speed: 0.2253s/iter; left time: 8748.6793s
	iters: 200, epoch: 18 | loss: 0.0017917
	speed: 0.0432s/iter; left time: 1674.7070s
	iters: 300, epoch: 18 | loss: 0.2219221
	speed: 0.0448s/iter; left time: 1729.8135s
	iters: 400, epoch: 18 | loss: 0.0511866
	speed: 0.0453s/iter; left time: 1745.7076s
Epoch: 18 cost time: 21.254089832305908
Epoch: 18, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.328 Vali Acc: 0.932 Test Loss: 0.328 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0199449
	speed: 0.2050s/iter; left time: 7862.9111s
	iters: 200, epoch: 19 | loss: 0.0638420
	speed: 0.0426s/iter; left time: 1631.6076s
	iters: 300, epoch: 19 | loss: 0.2725618
	speed: 0.0443s/iter; left time: 1692.0810s
	iters: 400, epoch: 19 | loss: 0.0089455
	speed: 0.0431s/iter; left time: 1639.9228s
Epoch: 19 cost time: 20.583261013031006
Epoch: 19, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9534019439679817
model parameter : 6612270
model size : 30.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4028010
	speed: 0.0580s/iter; left time: 2713.9667s
	iters: 200, epoch: 1 | loss: 0.3961823
	speed: 0.0427s/iter; left time: 1993.2799s
	iters: 300, epoch: 1 | loss: 0.1409519
	speed: 0.0441s/iter; left time: 2053.8994s
	iters: 400, epoch: 1 | loss: 0.3844638
	speed: 0.0465s/iter; left time: 2162.6407s
Epoch: 1 cost time: 22.119508743286133
Epoch: 1, Steps: 469 | Train Loss: 0.444 Vali Loss: 0.326 Vali Acc: 0.910 Test Loss: 0.326 Test Acc: 0.910
Validation loss decreased (inf --> -0.910231).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1209824
	speed: 0.2114s/iter; left time: 9792.6332s
	iters: 200, epoch: 2 | loss: 0.1505055
	speed: 0.0420s/iter; left time: 1943.0850s
	iters: 300, epoch: 2 | loss: 0.1869737
	speed: 0.0426s/iter; left time: 1966.4005s
	iters: 400, epoch: 2 | loss: 0.0860120
	speed: 0.0426s/iter; left time: 1962.7630s
Epoch: 2 cost time: 20.146621227264404
Epoch: 2, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
Validation loss decreased (-0.910231 --> -0.915377).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0360429
	speed: 0.1851s/iter; left time: 8488.0738s
	iters: 200, epoch: 3 | loss: 0.0307983
	speed: 0.0341s/iter; left time: 1558.6249s
	iters: 300, epoch: 3 | loss: 0.0319074
	speed: 0.0333s/iter; left time: 1520.4352s
	iters: 400, epoch: 3 | loss: 0.0832896
	speed: 0.0386s/iter; left time: 1759.9353s
Epoch: 3 cost time: 17.552119970321655
Epoch: 3, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.915377 --> -0.943394).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1852608
	speed: 0.1994s/iter; left time: 9049.3150s
	iters: 200, epoch: 4 | loss: 0.7576963
	speed: 0.0434s/iter; left time: 1967.7346s
	iters: 300, epoch: 4 | loss: 0.2543140
	speed: 0.0435s/iter; left time: 1964.5074s
	iters: 400, epoch: 4 | loss: 0.0452419
	speed: 0.0427s/iter; left time: 1923.5488s
Epoch: 4 cost time: 20.65651297569275
Epoch: 4, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2665209
	speed: 0.2077s/iter; left time: 9329.9835s
	iters: 200, epoch: 5 | loss: 0.0406419
	speed: 0.0419s/iter; left time: 1879.3681s
	iters: 300, epoch: 5 | loss: 0.0331611
	speed: 0.0415s/iter; left time: 1855.9870s
	iters: 400, epoch: 5 | loss: 0.1040561
	speed: 0.0443s/iter; left time: 1974.9051s
Epoch: 5 cost time: 20.321443557739258
Epoch: 5, Steps: 469 | Train Loss: 0.276 Vali Loss: 0.406 Vali Acc: 0.885 Test Loss: 0.406 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5507463
	speed: 0.2038s/iter; left time: 9058.6573s
	iters: 200, epoch: 6 | loss: 0.0150647
	speed: 0.0426s/iter; left time: 1891.3191s
	iters: 300, epoch: 6 | loss: 0.0458063
	speed: 0.0428s/iter; left time: 1894.3941s
	iters: 400, epoch: 6 | loss: 0.4667331
	speed: 0.0412s/iter; left time: 1819.6942s
Epoch: 6 cost time: 20.366467714309692
Epoch: 6, Steps: 469 | Train Loss: 0.292 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0195046
	speed: 0.2026s/iter; left time: 8910.5798s
	iters: 200, epoch: 7 | loss: 1.3094386
	speed: 0.0442s/iter; left time: 1941.0186s
	iters: 300, epoch: 7 | loss: 0.6320699
	speed: 0.0421s/iter; left time: 1842.2967s
	iters: 400, epoch: 7 | loss: 0.1573384
	speed: 0.0413s/iter; left time: 1802.0935s
Epoch: 7 cost time: 20.21161651611328
Epoch: 7, Steps: 469 | Train Loss: 0.310 Vali Loss: 0.368 Vali Acc: 0.887 Test Loss: 0.368 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8063267
	speed: 0.2067s/iter; left time: 8996.9688s
	iters: 200, epoch: 8 | loss: 0.2346269
	speed: 0.0446s/iter; left time: 1938.2271s
	iters: 300, epoch: 8 | loss: 0.1572252
	speed: 0.0455s/iter; left time: 1970.0478s
	iters: 400, epoch: 8 | loss: 0.1276051
	speed: 0.0435s/iter; left time: 1881.6194s
Epoch: 8 cost time: 21.281134366989136
Epoch: 8, Steps: 469 | Train Loss: 0.283 Vali Loss: 0.762 Vali Acc: 0.810 Test Loss: 0.762 Test Acc: 0.810
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0828214
	speed: 0.2242s/iter; left time: 9649.7964s
	iters: 200, epoch: 9 | loss: 0.6119310
	speed: 0.0445s/iter; left time: 1910.6508s
	iters: 300, epoch: 9 | loss: 0.5547822
	speed: 0.0457s/iter; left time: 1959.8519s
	iters: 400, epoch: 9 | loss: 0.8275488
	speed: 0.0445s/iter; left time: 1901.8654s
Epoch: 9 cost time: 21.415080070495605
Epoch: 9, Steps: 469 | Train Loss: 0.369 Vali Loss: 0.791 Vali Acc: 0.786 Test Loss: 0.791 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7427910
	speed: 0.2199s/iter; left time: 9362.6146s
	iters: 200, epoch: 10 | loss: 0.0830602
	speed: 0.0430s/iter; left time: 1826.1015s
	iters: 300, epoch: 10 | loss: 0.0445927
	speed: 0.0450s/iter; left time: 1908.3596s
	iters: 400, epoch: 10 | loss: 0.3480021
	speed: 0.0451s/iter; left time: 1906.2684s
Epoch: 10 cost time: 21.325544118881226
Epoch: 10, Steps: 469 | Train Loss: 0.333 Vali Loss: 0.515 Vali Acc: 0.859 Test Loss: 0.515 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3098188
	speed: 0.2174s/iter; left time: 9153.3468s
	iters: 200, epoch: 11 | loss: 0.6860203
	speed: 0.0449s/iter; left time: 1886.5273s
	iters: 300, epoch: 11 | loss: 0.1528224
	speed: 0.0446s/iter; left time: 1868.2838s
	iters: 400, epoch: 11 | loss: 0.4781966
	speed: 0.0434s/iter; left time: 1815.7703s
Epoch: 11 cost time: 21.064746379852295
Epoch: 11, Steps: 469 | Train Loss: 0.328 Vali Loss: 0.713 Vali Acc: 0.852 Test Loss: 0.713 Test Acc: 0.852
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1489973
	speed: 0.2028s/iter; left time: 8446.6742s
	iters: 200, epoch: 12 | loss: 0.1310593
	speed: 0.0450s/iter; left time: 1867.6953s
	iters: 300, epoch: 12 | loss: 0.5184073
	speed: 0.0460s/iter; left time: 1906.1743s
	iters: 400, epoch: 12 | loss: 0.2000670
	speed: 0.0456s/iter; left time: 1887.0830s
Epoch: 12 cost time: 21.477951765060425
Epoch: 12, Steps: 469 | Train Loss: 0.269 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.3976708
	speed: 0.2056s/iter; left time: 8467.0026s
	iters: 200, epoch: 13 | loss: 0.7500151
	speed: 0.0448s/iter; left time: 1838.0656s
	iters: 300, epoch: 13 | loss: 0.5347142
	speed: 0.0449s/iter; left time: 1841.3562s
	iters: 400, epoch: 13 | loss: 0.4050985
	speed: 0.0446s/iter; left time: 1823.5545s
Epoch: 13 cost time: 21.401867151260376
Epoch: 13, Steps: 469 | Train Loss: 0.342 Vali Loss: 0.467 Vali Acc: 0.860 Test Loss: 0.467 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9433962264150944
model parameter : 5957166
model size : 27.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4845329
	speed: 0.0568s/iter; left time: 2656.1908s
	iters: 200, epoch: 1 | loss: 0.3393255
	speed: 0.0428s/iter; left time: 1997.6636s
	iters: 300, epoch: 1 | loss: 0.2251896
	speed: 0.0444s/iter; left time: 2067.9158s
	iters: 400, epoch: 1 | loss: 0.1632306
	speed: 0.0463s/iter; left time: 2153.1395s
Epoch: 1 cost time: 22.305360555648804
Epoch: 1, Steps: 469 | Train Loss: 0.435 Vali Loss: 0.306 Vali Acc: 0.912 Test Loss: 0.306 Test Acc: 0.912
Validation loss decreased (inf --> -0.912233).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2900515
	speed: 0.2056s/iter; left time: 9526.6701s
	iters: 200, epoch: 2 | loss: 0.0675040
	speed: 0.0431s/iter; left time: 1993.9063s
	iters: 300, epoch: 2 | loss: 0.0724061
	speed: 0.0427s/iter; left time: 1967.7075s
	iters: 400, epoch: 2 | loss: 0.1242312
	speed: 0.0440s/iter; left time: 2027.2021s
Epoch: 2 cost time: 20.573312044143677
Epoch: 2, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.328 Vali Acc: 0.916 Test Loss: 0.328 Test Acc: 0.916
Validation loss decreased (-0.912233 --> -0.915949).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0332675
	speed: 0.2112s/iter; left time: 9687.3538s
	iters: 200, epoch: 3 | loss: 0.0190321
	speed: 0.0423s/iter; left time: 1934.9032s
	iters: 300, epoch: 3 | loss: 0.0193175
	speed: 0.0427s/iter; left time: 1948.5215s
	iters: 400, epoch: 3 | loss: 0.8466380
	speed: 0.0439s/iter; left time: 2001.9750s
Epoch: 3 cost time: 20.53598713874817
Epoch: 3, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.915949 --> -0.943394).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0668240
	speed: 0.2070s/iter; left time: 9396.3214s
	iters: 200, epoch: 4 | loss: 0.1352365
	speed: 0.0427s/iter; left time: 1931.8321s
	iters: 300, epoch: 4 | loss: 0.7996734
	speed: 0.0438s/iter; left time: 1980.6137s
	iters: 400, epoch: 4 | loss: 0.3985488
	speed: 0.0440s/iter; left time: 1983.3504s
Epoch: 4 cost time: 20.977624893188477
Epoch: 4, Steps: 469 | Train Loss: 0.189 Vali Loss: 0.257 Vali Acc: 0.921 Test Loss: 0.257 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1403164
	speed: 0.2063s/iter; left time: 9267.7773s
	iters: 200, epoch: 5 | loss: 0.1810057
	speed: 0.0426s/iter; left time: 1911.5293s
	iters: 300, epoch: 5 | loss: 0.3209214
	speed: 0.0434s/iter; left time: 1942.6913s
	iters: 400, epoch: 5 | loss: 0.0416398
	speed: 0.0427s/iter; left time: 1903.8572s
Epoch: 5 cost time: 20.602803468704224
Epoch: 5, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8314700
	speed: 0.2128s/iter; left time: 9461.6776s
	iters: 200, epoch: 6 | loss: 0.2253467
	speed: 0.0440s/iter; left time: 1950.2148s
	iters: 300, epoch: 6 | loss: 0.2539131
	speed: 0.0437s/iter; left time: 1932.3986s
	iters: 400, epoch: 6 | loss: 0.4724783
	speed: 0.0426s/iter; left time: 1881.6162s
Epoch: 6 cost time: 20.642532348632812
Epoch: 6, Steps: 469 | Train Loss: 0.288 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4433933
	speed: 0.2075s/iter; left time: 9129.3589s
	iters: 200, epoch: 7 | loss: 0.6733752
	speed: 0.0443s/iter; left time: 1945.5989s
	iters: 300, epoch: 7 | loss: 0.9036413
	speed: 0.0441s/iter; left time: 1932.2732s
	iters: 400, epoch: 7 | loss: 0.0362678
	speed: 0.0436s/iter; left time: 1905.2092s
Epoch: 7 cost time: 21.258503675460815
Epoch: 7, Steps: 469 | Train Loss: 0.363 Vali Loss: 0.453 Vali Acc: 0.882 Test Loss: 0.453 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2594867
	speed: 0.2316s/iter; left time: 10078.0088s
	iters: 200, epoch: 8 | loss: 0.0739529
	speed: 0.0460s/iter; left time: 1995.5314s
	iters: 300, epoch: 8 | loss: 0.1641470
	speed: 0.0459s/iter; left time: 1987.4909s
	iters: 400, epoch: 8 | loss: 0.3950501
	speed: 0.0442s/iter; left time: 1908.9272s
Epoch: 8 cost time: 21.555018424987793
Epoch: 8, Steps: 469 | Train Loss: 0.269 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5877276
	speed: 0.2151s/iter; left time: 9259.8610s
	iters: 200, epoch: 9 | loss: 0.0624162
	speed: 0.0443s/iter; left time: 1902.2923s
	iters: 300, epoch: 9 | loss: 0.0829511
	speed: 0.0452s/iter; left time: 1938.8962s
	iters: 400, epoch: 9 | loss: 0.3773465
	speed: 0.0451s/iter; left time: 1928.9168s
Epoch: 9 cost time: 21.580363988876343
Epoch: 9, Steps: 469 | Train Loss: 0.329 Vali Loss: 0.395 Vali Acc: 0.869 Test Loss: 0.395 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1184845
	speed: 0.2251s/iter; left time: 9583.9988s
	iters: 200, epoch: 10 | loss: 0.2434519
	speed: 0.0451s/iter; left time: 1915.2442s
	iters: 300, epoch: 10 | loss: 0.5018091
	speed: 0.0475s/iter; left time: 2012.3535s
	iters: 400, epoch: 10 | loss: 0.8488023
	speed: 0.0476s/iter; left time: 2012.7589s
Epoch: 10 cost time: 22.38229775428772
Epoch: 10, Steps: 469 | Train Loss: 0.284 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.943394 --> -0.943679).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0618653
	speed: 0.2093s/iter; left time: 8815.8171s
	iters: 200, epoch: 11 | loss: 0.1729239
	speed: 0.0425s/iter; left time: 1784.7561s
	iters: 300, epoch: 11 | loss: 0.0541629
	speed: 0.0422s/iter; left time: 1770.7188s
	iters: 400, epoch: 11 | loss: 0.1692979
	speed: 0.0422s/iter; left time: 1762.9031s
Epoch: 11 cost time: 20.54753303527832
Epoch: 11, Steps: 469 | Train Loss: 0.298 Vali Loss: 0.386 Vali Acc: 0.872 Test Loss: 0.386 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0535049
	speed: 0.2019s/iter; left time: 8405.9307s
	iters: 200, epoch: 12 | loss: 0.5024402
	speed: 0.0443s/iter; left time: 1839.7085s
	iters: 300, epoch: 12 | loss: 0.7870249
	speed: 0.0430s/iter; left time: 1783.1758s
	iters: 400, epoch: 12 | loss: 0.8101240
	speed: 0.0440s/iter; left time: 1818.7048s
Epoch: 12 cost time: 20.935065507888794
Epoch: 12, Steps: 469 | Train Loss: 0.273 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0114750
	speed: 0.2024s/iter; left time: 8331.5851s
	iters: 200, epoch: 13 | loss: 0.0785723
	speed: 0.0435s/iter; left time: 1785.9333s
	iters: 300, epoch: 13 | loss: 0.0607975
	speed: 0.0439s/iter; left time: 1797.9090s
	iters: 400, epoch: 13 | loss: 0.0438811
	speed: 0.0429s/iter; left time: 1753.9053s
Epoch: 13 cost time: 20.611724376678467
Epoch: 13, Steps: 469 | Train Loss: 0.226 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.3684294
	speed: 0.1986s/iter; left time: 8082.0100s
	iters: 200, epoch: 14 | loss: 0.1329539
	speed: 0.0430s/iter; left time: 1746.0409s
	iters: 300, epoch: 14 | loss: 0.1850941
	speed: 0.0417s/iter; left time: 1687.7017s
	iters: 400, epoch: 14 | loss: 0.0890570
	speed: 0.0427s/iter; left time: 1726.8689s
Epoch: 14 cost time: 20.322473526000977
Epoch: 14, Steps: 469 | Train Loss: 0.244 Vali Loss: 0.413 Vali Acc: 0.883 Test Loss: 0.413 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0363197
	speed: 0.2005s/iter; left time: 8066.7226s
	iters: 200, epoch: 15 | loss: 0.1504492
	speed: 0.0440s/iter; left time: 1766.7859s
	iters: 300, epoch: 15 | loss: 0.0906262
	speed: 0.0435s/iter; left time: 1739.8079s
	iters: 400, epoch: 15 | loss: 0.2254552
	speed: 0.0450s/iter; left time: 1797.2421s
Epoch: 15 cost time: 21.208951234817505
Epoch: 15, Steps: 469 | Train Loss: 0.270 Vali Loss: 0.328 Vali Acc: 0.905 Test Loss: 0.328 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1986611
	speed: 0.2060s/iter; left time: 8192.1319s
	iters: 200, epoch: 16 | loss: 0.0346918
	speed: 0.0425s/iter; left time: 1685.3983s
	iters: 300, epoch: 16 | loss: 0.5815582
	speed: 0.0422s/iter; left time: 1671.4517s
	iters: 400, epoch: 16 | loss: 0.0137095
	speed: 0.0431s/iter; left time: 1700.3408s
Epoch: 16 cost time: 20.331023931503296
Epoch: 16, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2889398
	speed: 0.2018s/iter; left time: 7929.6130s
	iters: 200, epoch: 17 | loss: 0.1762795
	speed: 0.0428s/iter; left time: 1677.8236s
	iters: 300, epoch: 17 | loss: 0.1320186
	speed: 0.0445s/iter; left time: 1740.8476s
	iters: 400, epoch: 17 | loss: 0.0377060
	speed: 0.0438s/iter; left time: 1709.5584s
Epoch: 17 cost time: 20.658164262771606
Epoch: 17, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0642308
	speed: 0.2079s/iter; left time: 8071.9977s
	iters: 200, epoch: 18 | loss: 0.5905194
	speed: 0.0431s/iter; left time: 1670.8408s
	iters: 300, epoch: 18 | loss: 0.3825518
	speed: 0.0455s/iter; left time: 1758.5871s
	iters: 400, epoch: 18 | loss: 0.1460163
	speed: 0.0429s/iter; left time: 1652.0675s
Epoch: 18 cost time: 20.8960862159729
Epoch: 18, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0678606
	speed: 0.2019s/iter; left time: 7743.5228s
	iters: 200, epoch: 19 | loss: 0.5053393
	speed: 0.0430s/iter; left time: 1644.0853s
	iters: 300, epoch: 19 | loss: 0.0541890
	speed: 0.0425s/iter; left time: 1620.0520s
	iters: 400, epoch: 19 | loss: 0.3180900
	speed: 0.0431s/iter; left time: 1640.8524s
Epoch: 19 cost time: 20.52267813682556
Epoch: 19, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0174776
	speed: 0.2060s/iter; left time: 7803.9219s
	iters: 200, epoch: 20 | loss: 0.1950999
	speed: 0.0417s/iter; left time: 1575.4227s
	iters: 300, epoch: 20 | loss: 0.0815907
	speed: 0.0459s/iter; left time: 1730.0726s
	iters: 400, epoch: 20 | loss: 0.2046785
	speed: 0.0440s/iter; left time: 1655.5443s
Epoch: 20 cost time: 20.49936556816101
Epoch: 20, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9436821040594625
model parameter : 5956654
model size : 27.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4418642
	speed: 0.0608s/iter; left time: 2843.7555s
	iters: 200, epoch: 1 | loss: 0.1725292
	speed: 0.0473s/iter; left time: 2209.7754s
	iters: 300, epoch: 1 | loss: 0.2228493
	speed: 0.0464s/iter; left time: 2164.0154s
	iters: 400, epoch: 1 | loss: 0.0243582
	speed: 0.0443s/iter; left time: 2061.4129s
Epoch: 1 cost time: 23.02141571044922
Epoch: 1, Steps: 469 | Train Loss: 0.443 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (inf --> -0.902513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2386684
	speed: 0.2279s/iter; left time: 10560.0681s
	iters: 200, epoch: 2 | loss: 0.1629096
	speed: 0.0453s/iter; left time: 2094.7057s
	iters: 300, epoch: 2 | loss: 0.0374563
	speed: 0.0455s/iter; left time: 2100.3579s
	iters: 400, epoch: 2 | loss: 0.2978105
	speed: 0.0473s/iter; left time: 2177.2164s
Epoch: 2 cost time: 21.85822105407715
Epoch: 2, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3116715
	speed: 0.2260s/iter; left time: 10365.7804s
	iters: 200, epoch: 3 | loss: 0.3638679
	speed: 0.0430s/iter; left time: 1968.0402s
	iters: 300, epoch: 3 | loss: 0.0224353
	speed: 0.0429s/iter; left time: 1957.5653s
	iters: 400, epoch: 3 | loss: 0.3141494
	speed: 0.0448s/iter; left time: 2041.2574s
Epoch: 3 cost time: 20.717861652374268
Epoch: 3, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.902513 --> -0.925098).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1729184
	speed: 0.2148s/iter; left time: 9749.7598s
	iters: 200, epoch: 4 | loss: 0.0220715
	speed: 0.0426s/iter; left time: 1930.1896s
	iters: 300, epoch: 4 | loss: 0.0136588
	speed: 0.0437s/iter; left time: 1976.9895s
	iters: 400, epoch: 4 | loss: 0.0907974
	speed: 0.0434s/iter; left time: 1958.0964s
Epoch: 4 cost time: 20.83341908454895
Epoch: 4, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.363 Vali Acc: 0.885 Test Loss: 0.363 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1113164
	speed: 0.2012s/iter; left time: 9039.5841s
	iters: 200, epoch: 5 | loss: 0.4613262
	speed: 0.0446s/iter; left time: 2000.8294s
	iters: 300, epoch: 5 | loss: 0.2551941
	speed: 0.0435s/iter; left time: 1946.9463s
	iters: 400, epoch: 5 | loss: 0.1128657
	speed: 0.0444s/iter; left time: 1981.8074s
Epoch: 5 cost time: 21.035478115081787
Epoch: 5, Steps: 469 | Train Loss: 0.245 Vali Loss: 0.477 Vali Acc: 0.871 Test Loss: 0.477 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2999133
	speed: 0.2048s/iter; left time: 9105.0377s
	iters: 200, epoch: 6 | loss: 0.9222115
	speed: 0.0416s/iter; left time: 1846.4708s
	iters: 300, epoch: 6 | loss: 0.7001485
	speed: 0.0417s/iter; left time: 1844.5192s
	iters: 400, epoch: 6 | loss: 0.1536825
	speed: 0.0416s/iter; left time: 1834.7099s
Epoch: 6 cost time: 20.450143098831177
Epoch: 6, Steps: 469 | Train Loss: 0.307 Vali Loss: 0.405 Vali Acc: 0.907 Test Loss: 0.405 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0234057
	speed: 0.1983s/iter; left time: 8724.5395s
	iters: 200, epoch: 7 | loss: 0.2424467
	speed: 0.0465s/iter; left time: 2040.7852s
	iters: 300, epoch: 7 | loss: 0.5223210
	speed: 0.0438s/iter; left time: 1917.5617s
	iters: 400, epoch: 7 | loss: 0.2215916
	speed: 0.0441s/iter; left time: 1927.8243s
Epoch: 7 cost time: 21.197015285491943
Epoch: 7, Steps: 469 | Train Loss: 0.274 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1662347
	speed: 0.2120s/iter; left time: 9225.9165s
	iters: 200, epoch: 8 | loss: 0.3703294
	speed: 0.0444s/iter; left time: 1925.8674s
	iters: 300, epoch: 8 | loss: 0.3954443
	speed: 0.0427s/iter; left time: 1851.5658s
	iters: 400, epoch: 8 | loss: 0.4820805
	speed: 0.0440s/iter; left time: 1900.7273s
Epoch: 8 cost time: 20.78671956062317
Epoch: 8, Steps: 469 | Train Loss: 0.255 Vali Loss: 0.291 Vali Acc: 0.929 Test Loss: 0.291 Test Acc: 0.929
Validation loss decreased (-0.925098 --> -0.928814).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0083006
	speed: 0.2128s/iter; left time: 9161.4842s
	iters: 200, epoch: 9 | loss: 0.6992195
	speed: 0.0446s/iter; left time: 1915.1985s
	iters: 300, epoch: 9 | loss: 0.1461422
	speed: 0.0424s/iter; left time: 1815.5477s
	iters: 400, epoch: 9 | loss: 0.4874209
	speed: 0.0454s/iter; left time: 1939.5180s
Epoch: 9 cost time: 21.07409429550171
Epoch: 9, Steps: 469 | Train Loss: 0.271 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2102181
	speed: 0.2081s/iter; left time: 8860.0768s
	iters: 200, epoch: 10 | loss: 0.4369617
	speed: 0.0436s/iter; left time: 1850.6541s
	iters: 300, epoch: 10 | loss: 0.2613662
	speed: 0.0474s/iter; left time: 2009.5701s
	iters: 400, epoch: 10 | loss: 0.0140071
	speed: 0.0451s/iter; left time: 1906.9993s
Epoch: 10 cost time: 21.379652976989746
Epoch: 10, Steps: 469 | Train Loss: 0.298 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4538154
	speed: 0.2019s/iter; left time: 8500.6733s
	iters: 200, epoch: 11 | loss: 0.1355083
	speed: 0.0438s/iter; left time: 1841.3761s
	iters: 300, epoch: 11 | loss: 0.1086604
	speed: 0.0426s/iter; left time: 1786.8367s
	iters: 400, epoch: 11 | loss: 0.0890897
	speed: 0.0419s/iter; left time: 1751.9486s
Epoch: 11 cost time: 20.417231559753418
Epoch: 11, Steps: 469 | Train Loss: 0.255 Vali Loss: 0.498 Vali Acc: 0.857 Test Loss: 0.498 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1872197
	speed: 0.2009s/iter; left time: 8367.9065s
	iters: 200, epoch: 12 | loss: 0.4380684
	speed: 0.0447s/iter; left time: 1855.7080s
	iters: 300, epoch: 12 | loss: 0.0474722
	speed: 0.0434s/iter; left time: 1796.9922s
	iters: 400, epoch: 12 | loss: 0.3374971
	speed: 0.0445s/iter; left time: 1840.4100s
Epoch: 12 cost time: 20.978537559509277
Epoch: 12, Steps: 469 | Train Loss: 0.233 Vali Loss: 0.409 Vali Acc: 0.897 Test Loss: 0.409 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0213747
	speed: 0.2200s/iter; left time: 9060.0415s
	iters: 200, epoch: 13 | loss: 0.4971012
	speed: 0.0459s/iter; left time: 1886.3931s
	iters: 300, epoch: 13 | loss: 0.4680462
	speed: 0.0451s/iter; left time: 1847.4546s
	iters: 400, epoch: 13 | loss: 1.0191157
	speed: 0.0441s/iter; left time: 1801.1457s
Epoch: 13 cost time: 21.998507738113403
Epoch: 13, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2358420
	speed: 0.2287s/iter; left time: 9308.9412s
	iters: 200, epoch: 14 | loss: 0.0169336
	speed: 0.0467s/iter; left time: 1896.6801s
	iters: 300, epoch: 14 | loss: 0.0844597
	speed: 0.0483s/iter; left time: 1957.0215s
	iters: 400, epoch: 14 | loss: 0.3762223
	speed: 0.0452s/iter; left time: 1828.1423s
Epoch: 14 cost time: 21.938920259475708
Epoch: 14, Steps: 469 | Train Loss: 0.233 Vali Loss: 0.369 Vali Acc: 0.919 Test Loss: 0.369 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0891535
	speed: 0.2188s/iter; left time: 8803.8089s
	iters: 200, epoch: 15 | loss: 0.3489943
	speed: 0.0486s/iter; left time: 1949.1899s
	iters: 300, epoch: 15 | loss: 0.0617302
	speed: 0.0491s/iter; left time: 1964.0343s
	iters: 400, epoch: 15 | loss: 0.5974523
	speed: 0.0458s/iter; left time: 1827.7451s
Epoch: 15 cost time: 22.476774215698242
Epoch: 15, Steps: 469 | Train Loss: 0.209 Vali Loss: 0.421 Vali Acc: 0.895 Test Loss: 0.421 Test Acc: 0.895
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0447740
	speed: 0.2064s/iter; left time: 8206.5424s
	iters: 200, epoch: 16 | loss: 0.2227463
	speed: 0.0430s/iter; left time: 1704.2658s
	iters: 300, epoch: 16 | loss: 0.1032845
	speed: 0.0429s/iter; left time: 1698.6611s
	iters: 400, epoch: 16 | loss: 0.6781434
	speed: 0.0434s/iter; left time: 1714.3417s
Epoch: 16 cost time: 20.56254005432129
Epoch: 16, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.432 Vali Acc: 0.901 Test Loss: 0.432 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1669661
	speed: 0.2002s/iter; left time: 7867.7445s
	iters: 200, epoch: 17 | loss: 0.1471477
	speed: 0.0429s/iter; left time: 1682.1352s
	iters: 300, epoch: 17 | loss: 0.7439866
	speed: 0.0446s/iter; left time: 1741.9733s
	iters: 400, epoch: 17 | loss: 0.2576614
	speed: 0.0414s/iter; left time: 1614.7077s
Epoch: 17 cost time: 20.571105241775513
Epoch: 17, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
Validation loss decreased (-0.928814 --> -0.935389).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0734348
	speed: 0.2146s/iter; left time: 8331.2382s
	iters: 200, epoch: 18 | loss: 0.3053548
	speed: 0.0443s/iter; left time: 1714.6503s
	iters: 300, epoch: 18 | loss: 0.0198304
	speed: 0.0434s/iter; left time: 1675.0348s
	iters: 400, epoch: 18 | loss: 0.0406249
	speed: 0.0443s/iter; left time: 1705.5625s
Epoch: 18 cost time: 20.74870729446411
Epoch: 18, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0070982
	speed: 0.2100s/iter; left time: 8056.0030s
	iters: 200, epoch: 19 | loss: 0.2097159
	speed: 0.0465s/iter; left time: 1777.3668s
	iters: 300, epoch: 19 | loss: 0.4046505
	speed: 0.0463s/iter; left time: 1767.3940s
	iters: 400, epoch: 19 | loss: 0.2658438
	speed: 0.0438s/iter; left time: 1667.4083s
Epoch: 19 cost time: 21.7013680934906
Epoch: 19, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.350 Vali Acc: 0.913 Test Loss: 0.350 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0444941
	speed: 0.1974s/iter; left time: 7478.0953s
	iters: 200, epoch: 20 | loss: 0.0077439
	speed: 0.0429s/iter; left time: 1621.7306s
	iters: 300, epoch: 20 | loss: 0.0154655
	speed: 0.0429s/iter; left time: 1616.8533s
	iters: 400, epoch: 20 | loss: 0.0162840
	speed: 0.0439s/iter; left time: 1650.5320s
Epoch: 20 cost time: 20.43991708755493
Epoch: 20, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.257 Vali Acc: 0.936 Test Loss: 0.257 Test Acc: 0.936
Validation loss decreased (-0.935389 --> -0.935961).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0950947
	speed: 0.2069s/iter; left time: 7743.6182s
	iters: 200, epoch: 21 | loss: 0.1069425
	speed: 0.0431s/iter; left time: 1610.0733s
	iters: 300, epoch: 21 | loss: 0.0090370
	speed: 0.0428s/iter; left time: 1593.0418s
	iters: 400, epoch: 21 | loss: 0.0206082
	speed: 0.0433s/iter; left time: 1608.4791s
Epoch: 21 cost time: 20.7805118560791
Epoch: 21, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0583360
	speed: 0.2068s/iter; left time: 7641.1925s
	iters: 200, epoch: 22 | loss: 0.0535218
	speed: 0.0412s/iter; left time: 1518.6057s
	iters: 300, epoch: 22 | loss: 0.5393168
	speed: 0.0432s/iter; left time: 1587.5296s
	iters: 400, epoch: 22 | loss: 0.5630692
	speed: 0.0431s/iter; left time: 1581.4976s
Epoch: 22 cost time: 20.339030981063843
Epoch: 22, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.935961 --> -0.946253).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0383059
	speed: 0.2096s/iter; left time: 7647.4020s
	iters: 200, epoch: 23 | loss: 0.1464498
	speed: 0.0426s/iter; left time: 1548.8868s
	iters: 300, epoch: 23 | loss: 0.4178120
	speed: 0.0431s/iter; left time: 1564.2695s
	iters: 400, epoch: 23 | loss: 0.4260284
	speed: 0.0414s/iter; left time: 1497.3370s
Epoch: 23 cost time: 20.29732847213745
Epoch: 23, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6789187
	speed: 0.2071s/iter; left time: 7457.1922s
	iters: 200, epoch: 24 | loss: 0.0170050
	speed: 0.0454s/iter; left time: 1631.6829s
	iters: 300, epoch: 24 | loss: 0.1004956
	speed: 0.0456s/iter; left time: 1634.4414s
	iters: 400, epoch: 24 | loss: 0.0293294
	speed: 0.0436s/iter; left time: 1556.6649s
Epoch: 24 cost time: 20.945554733276367
Epoch: 24, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1805380
	speed: 0.1862s/iter; left time: 6618.6176s
	iters: 200, epoch: 25 | loss: 0.0625260
	speed: 0.0426s/iter; left time: 1510.3179s
	iters: 300, epoch: 25 | loss: 0.0053141
	speed: 0.0446s/iter; left time: 1577.1579s
	iters: 400, epoch: 25 | loss: 0.5354921
	speed: 0.0463s/iter; left time: 1632.0029s
Epoch: 25 cost time: 20.97020149230957
Epoch: 25, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.340 Vali Acc: 0.909 Test Loss: 0.340 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0908905
	speed: 0.2254s/iter; left time: 7905.4580s
	iters: 200, epoch: 26 | loss: 0.0116737
	speed: 0.0401s/iter; left time: 1402.6817s
	iters: 300, epoch: 26 | loss: 0.1739704
	speed: 0.0397s/iter; left time: 1383.8592s
	iters: 400, epoch: 26 | loss: 0.1098283
	speed: 0.0376s/iter; left time: 1307.9602s
Epoch: 26 cost time: 19.479469776153564
Epoch: 26, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.346 Vali Acc: 0.909 Test Loss: 0.346 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0548835
	speed: 0.2042s/iter; left time: 7066.2758s
	iters: 200, epoch: 27 | loss: 0.1428501
	speed: 0.0432s/iter; left time: 1490.1970s
	iters: 300, epoch: 27 | loss: 0.0467257
	speed: 0.0443s/iter; left time: 1525.0891s
	iters: 400, epoch: 27 | loss: 0.0161092
	speed: 0.0452s/iter; left time: 1549.2442s
Epoch: 27 cost time: 21.232612371444702
Epoch: 27, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0148744
	speed: 0.2296s/iter; left time: 7837.7133s
	iters: 200, epoch: 28 | loss: 0.0130151
	speed: 0.0454s/iter; left time: 1544.0242s
	iters: 300, epoch: 28 | loss: 0.0066573
	speed: 0.0419s/iter; left time: 1423.5231s
	iters: 400, epoch: 28 | loss: 0.0645844
	speed: 0.0421s/iter; left time: 1424.8159s
Epoch: 28 cost time: 20.96253228187561
Epoch: 28, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.5046426
	speed: 0.2081s/iter; left time: 7005.1414s
	iters: 200, epoch: 29 | loss: 0.1210172
	speed: 0.0450s/iter; left time: 1510.0050s
	iters: 300, epoch: 29 | loss: 0.0044561
	speed: 0.0492s/iter; left time: 1647.5111s
	iters: 400, epoch: 29 | loss: 0.1519689
	speed: 0.0437s/iter; left time: 1457.5232s
Epoch: 29 cost time: 21.649059057235718
Epoch: 29, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.281 Vali Acc: 0.932 Test Loss: 0.281 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.2992499
	speed: 0.2042s/iter; left time: 6780.8618s
	iters: 200, epoch: 30 | loss: 0.0138957
	speed: 0.0444s/iter; left time: 1470.5209s
	iters: 300, epoch: 30 | loss: 0.0187071
	speed: 0.0432s/iter; left time: 1426.2057s
	iters: 400, epoch: 30 | loss: 0.0290992
	speed: 0.0422s/iter; left time: 1387.2686s
Epoch: 30 cost time: 20.79078507423401
Epoch: 30, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.946253 --> -0.953972).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0321530
	speed: 0.2090s/iter; left time: 6842.2607s
	iters: 200, epoch: 31 | loss: 0.4237695
	speed: 0.0428s/iter; left time: 1396.5507s
	iters: 300, epoch: 31 | loss: 0.0019149
	speed: 0.0423s/iter; left time: 1375.6004s
	iters: 400, epoch: 31 | loss: 0.2651656
	speed: 0.0447s/iter; left time: 1450.0537s
Epoch: 31 cost time: 20.493269681930542
Epoch: 31, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.284 Vali Acc: 0.929 Test Loss: 0.284 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.1823866
	speed: 0.2044s/iter; left time: 6593.3075s
	iters: 200, epoch: 32 | loss: 0.0552577
	speed: 0.0415s/iter; left time: 1333.2459s
	iters: 300, epoch: 32 | loss: 0.0434824
	speed: 0.0446s/iter; left time: 1430.1958s
	iters: 400, epoch: 32 | loss: 0.0057027
	speed: 0.0445s/iter; left time: 1421.1396s
Epoch: 32 cost time: 20.97621774673462
Epoch: 32, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0586790
	speed: 0.2064s/iter; left time: 6561.0998s
	iters: 200, epoch: 33 | loss: 0.0658634
	speed: 0.0414s/iter; left time: 1313.3488s
	iters: 300, epoch: 33 | loss: 0.4504144
	speed: 0.0427s/iter; left time: 1349.0600s
	iters: 400, epoch: 33 | loss: 0.0394059
	speed: 0.0448s/iter; left time: 1411.7666s
Epoch: 33 cost time: 20.27581262588501
Epoch: 33, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.312 Vali Acc: 0.927 Test Loss: 0.312 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.2314892
	speed: 0.2030s/iter; left time: 6358.0009s
	iters: 200, epoch: 34 | loss: 0.2385050
	speed: 0.0448s/iter; left time: 1397.5633s
	iters: 300, epoch: 34 | loss: 0.1222638
	speed: 0.0433s/iter; left time: 1346.6427s
	iters: 400, epoch: 34 | loss: 0.0162631
	speed: 0.0438s/iter; left time: 1359.1680s
Epoch: 34 cost time: 20.99619698524475
Epoch: 34, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.2454112
	speed: 0.1998s/iter; left time: 6165.3775s
	iters: 200, epoch: 35 | loss: 0.6205499
	speed: 0.0432s/iter; left time: 1328.1669s
	iters: 300, epoch: 35 | loss: 0.2160984
	speed: 0.0412s/iter; left time: 1262.4388s
	iters: 400, epoch: 35 | loss: 0.1223910
	speed: 0.0449s/iter; left time: 1373.1330s
Epoch: 35 cost time: 20.47533416748047
Epoch: 35, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.2304166
	speed: 0.2031s/iter; left time: 6171.5764s
	iters: 200, epoch: 36 | loss: 0.1102452
	speed: 0.0448s/iter; left time: 1358.2638s
	iters: 300, epoch: 36 | loss: 0.0409032
	speed: 0.0434s/iter; left time: 1309.3513s
	iters: 400, epoch: 36 | loss: 0.0268214
	speed: 0.0445s/iter; left time: 1339.5055s
Epoch: 36 cost time: 20.899532318115234
Epoch: 36, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.241 Vali Acc: 0.945 Test Loss: 0.241 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0176363
	speed: 0.2017s/iter; left time: 6033.2227s
	iters: 200, epoch: 37 | loss: 0.0042644
	speed: 0.0444s/iter; left time: 1323.1371s
	iters: 300, epoch: 37 | loss: 0.1836924
	speed: 0.0441s/iter; left time: 1311.2755s
	iters: 400, epoch: 37 | loss: 0.0048455
	speed: 0.0444s/iter; left time: 1316.4320s
Epoch: 37 cost time: 21.22763752937317
Epoch: 37, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.271 Vali Acc: 0.952 Test Loss: 0.271 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0121887
	speed: 0.2218s/iter; left time: 6531.5391s
	iters: 200, epoch: 38 | loss: 0.0317214
	speed: 0.0462s/iter; left time: 1356.5118s
	iters: 300, epoch: 38 | loss: 0.1058603
	speed: 0.0468s/iter; left time: 1368.6384s
	iters: 400, epoch: 38 | loss: 0.0138100
	speed: 0.0461s/iter; left time: 1342.4782s
Epoch: 38 cost time: 22.233619928359985
Epoch: 38, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.953972 --> -0.956831).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.6257361
	speed: 0.2359s/iter; left time: 6837.1742s
	iters: 200, epoch: 39 | loss: 0.2156744
	speed: 0.0474s/iter; left time: 1367.5184s
	iters: 300, epoch: 39 | loss: 0.0102537
	speed: 0.0460s/iter; left time: 1322.8241s
	iters: 400, epoch: 39 | loss: 0.0053019
	speed: 0.0484s/iter; left time: 1386.9643s
Epoch: 39 cost time: 22.671690702438354
Epoch: 39, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0124584
	speed: 0.2269s/iter; left time: 6467.9361s
	iters: 200, epoch: 40 | loss: 0.0622331
	speed: 0.0477s/iter; left time: 1356.1184s
	iters: 300, epoch: 40 | loss: 0.1126944
	speed: 0.0453s/iter; left time: 1283.6319s
	iters: 400, epoch: 40 | loss: 0.1688512
	speed: 0.0470s/iter; left time: 1325.7493s
Epoch: 40 cost time: 22.27893853187561
Epoch: 40, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.4959693
	speed: 0.2233s/iter; left time: 6262.5114s
	iters: 200, epoch: 41 | loss: 0.4649222
	speed: 0.0444s/iter; left time: 1239.2594s
	iters: 300, epoch: 41 | loss: 0.0075927
	speed: 0.0464s/iter; left time: 1291.3725s
	iters: 400, epoch: 41 | loss: 0.0254194
	speed: 0.0448s/iter; left time: 1243.4724s
Epoch: 41 cost time: 21.088453769683838
Epoch: 41, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0226206
	speed: 0.1709s/iter; left time: 4712.1173s
	iters: 200, epoch: 42 | loss: 0.1390419
	speed: 0.0450s/iter; left time: 1237.2375s
	iters: 300, epoch: 42 | loss: 0.0090813
	speed: 0.0440s/iter; left time: 1204.7576s
	iters: 400, epoch: 42 | loss: 0.1302870
	speed: 0.0459s/iter; left time: 1250.8933s
Epoch: 42 cost time: 21.041067600250244
Epoch: 42, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0542102
	speed: 0.2100s/iter; left time: 5690.6112s
	iters: 200, epoch: 43 | loss: 0.0064549
	speed: 0.0464s/iter; left time: 1253.7253s
	iters: 300, epoch: 43 | loss: 0.0435650
	speed: 0.0450s/iter; left time: 1209.6448s
	iters: 400, epoch: 43 | loss: 0.0072758
	speed: 0.0459s/iter; left time: 1230.9172s
Epoch: 43 cost time: 21.587753772735596
Epoch: 43, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0582945
	speed: 0.2071s/iter; left time: 5516.6277s
	iters: 200, epoch: 44 | loss: 0.0039137
	speed: 0.0453s/iter; left time: 1200.8134s
	iters: 300, epoch: 44 | loss: 0.0028408
	speed: 0.0450s/iter; left time: 1188.4912s
	iters: 400, epoch: 44 | loss: 0.3545771
	speed: 0.0438s/iter; left time: 1152.3387s
Epoch: 44 cost time: 21.261696100234985
Epoch: 44, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0245967
	speed: 0.2099s/iter; left time: 5491.4310s
	iters: 200, epoch: 45 | loss: 0.0043600
	speed: 0.0440s/iter; left time: 1146.8900s
	iters: 300, epoch: 45 | loss: 0.0881922
	speed: 0.0455s/iter; left time: 1181.4529s
	iters: 400, epoch: 45 | loss: 0.0201814
	speed: 0.0459s/iter; left time: 1186.1768s
Epoch: 45 cost time: 21.28459668159485
Epoch: 45, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.1802785
	speed: 0.1982s/iter; left time: 5092.8275s
	iters: 200, epoch: 46 | loss: 0.0034395
	speed: 0.0454s/iter; left time: 1161.3346s
	iters: 300, epoch: 46 | loss: 0.0650881
	speed: 0.0450s/iter; left time: 1146.5695s
	iters: 400, epoch: 46 | loss: 0.0111711
	speed: 0.0452s/iter; left time: 1148.3416s
Epoch: 46 cost time: 21.313586950302124
Epoch: 46, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.259 Vali Acc: 0.943 Test Loss: 0.259 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.1063248
	speed: 0.2075s/iter; left time: 5233.4808s
	iters: 200, epoch: 47 | loss: 0.4868559
	speed: 0.0469s/iter; left time: 1177.6772s
	iters: 300, epoch: 47 | loss: 0.0101984
	speed: 0.0459s/iter; left time: 1147.9203s
	iters: 400, epoch: 47 | loss: 0.0032406
	speed: 0.0496s/iter; left time: 1237.2017s
Epoch: 47 cost time: 22.448514223098755
Epoch: 47, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.6940071
	speed: 0.2065s/iter; left time: 5113.1499s
	iters: 200, epoch: 48 | loss: 0.1909481
	speed: 0.0424s/iter; left time: 1045.3683s
	iters: 300, epoch: 48 | loss: 0.0251382
	speed: 0.0444s/iter; left time: 1090.6433s
	iters: 400, epoch: 48 | loss: 0.0180774
	speed: 0.0435s/iter; left time: 1064.1226s
Epoch: 48 cost time: 20.873690605163574
Epoch: 48, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9568324757004002
model parameter : 5956142
model size : 27.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2833503
	speed: 0.0600s/iter; left time: 2810.1676s
	iters: 200, epoch: 1 | loss: 0.2290656
	speed: 0.0397s/iter; left time: 1854.6944s
	iters: 300, epoch: 1 | loss: 0.4568903
	speed: 0.0432s/iter; left time: 2014.6894s
	iters: 400, epoch: 1 | loss: 0.2382083
	speed: 0.0400s/iter; left time: 1858.5027s
Epoch: 1 cost time: 21.170708656311035
Epoch: 1, Steps: 469 | Train Loss: 0.448 Vali Loss: 0.334 Vali Acc: 0.890 Test Loss: 0.334 Test Acc: 0.890
Validation loss decreased (inf --> -0.889934).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2168568
	speed: 0.2105s/iter; left time: 9753.0393s
	iters: 200, epoch: 2 | loss: 0.2572662
	speed: 0.0454s/iter; left time: 2100.8538s
	iters: 300, epoch: 2 | loss: 0.0740760
	speed: 0.0455s/iter; left time: 2101.2307s
	iters: 400, epoch: 2 | loss: 0.1504878
	speed: 0.0469s/iter; left time: 2158.2220s
Epoch: 2 cost time: 21.570482969284058
Epoch: 2, Steps: 469 | Train Loss: 0.191 Vali Loss: 0.237 Vali Acc: 0.945 Test Loss: 0.237 Test Acc: 0.945
Validation loss decreased (-0.889934 --> -0.944537).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0951685
	speed: 0.2225s/iter; left time: 10205.7399s
	iters: 200, epoch: 3 | loss: 0.2318392
	speed: 0.0432s/iter; left time: 1975.9123s
	iters: 300, epoch: 3 | loss: 0.0638894
	speed: 0.0415s/iter; left time: 1896.2668s
	iters: 400, epoch: 3 | loss: 0.1993937
	speed: 0.0455s/iter; left time: 2072.2356s
Epoch: 3 cost time: 21.065017461776733
Epoch: 3, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.300 Vali Acc: 0.923 Test Loss: 0.300 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0551781
	speed: 0.2211s/iter; left time: 10036.6114s
	iters: 200, epoch: 4 | loss: 0.3987987
	speed: 0.0450s/iter; left time: 2038.7423s
	iters: 300, epoch: 4 | loss: 0.0244531
	speed: 0.0446s/iter; left time: 2014.4735s
	iters: 400, epoch: 4 | loss: 0.0334042
	speed: 0.0440s/iter; left time: 1982.8757s
Epoch: 4 cost time: 21.00669264793396
Epoch: 4, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0172481
	speed: 0.2149s/iter; left time: 9652.6626s
	iters: 200, epoch: 5 | loss: 0.0292565
	speed: 0.0426s/iter; left time: 1909.2910s
	iters: 300, epoch: 5 | loss: 0.1708708
	speed: 0.0436s/iter; left time: 1948.3630s
	iters: 400, epoch: 5 | loss: 0.1793546
	speed: 0.0430s/iter; left time: 1920.8789s
Epoch: 5 cost time: 20.432191133499146
Epoch: 5, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1848133
	speed: 0.1965s/iter; left time: 8736.4827s
	iters: 200, epoch: 6 | loss: 0.0067731
	speed: 0.0432s/iter; left time: 1914.7071s
	iters: 300, epoch: 6 | loss: 0.1047330
	speed: 0.0430s/iter; left time: 1901.8324s
	iters: 400, epoch: 6 | loss: 0.0130648
	speed: 0.0430s/iter; left time: 1899.7597s
Epoch: 6 cost time: 20.220807313919067
Epoch: 6, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.285 Vali Acc: 0.927 Test Loss: 0.285 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3908766
	speed: 0.1988s/iter; left time: 8746.0990s
	iters: 200, epoch: 7 | loss: 0.0721781
	speed: 0.0391s/iter; left time: 1715.8094s
	iters: 300, epoch: 7 | loss: 0.0119706
	speed: 0.0417s/iter; left time: 1823.8048s
	iters: 400, epoch: 7 | loss: 0.0104727
	speed: 0.0431s/iter; left time: 1884.9080s
Epoch: 7 cost time: 19.89829730987549
Epoch: 7, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.944537 --> -0.950541).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0229706
	speed: 0.1948s/iter; left time: 8479.2049s
	iters: 200, epoch: 8 | loss: 0.2532902
	speed: 0.0419s/iter; left time: 1820.8219s
	iters: 300, epoch: 8 | loss: 0.0362003
	speed: 0.0406s/iter; left time: 1758.5868s
	iters: 400, epoch: 8 | loss: 0.8069617
	speed: 0.0401s/iter; left time: 1732.3259s
Epoch: 8 cost time: 19.223512887954712
Epoch: 8, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2217007
	speed: 0.1914s/iter; left time: 8239.7453s
	iters: 200, epoch: 9 | loss: 0.0069610
	speed: 0.0381s/iter; left time: 1637.9790s
	iters: 300, epoch: 9 | loss: 0.0133803
	speed: 0.0389s/iter; left time: 1664.7503s
	iters: 400, epoch: 9 | loss: 0.2103396
	speed: 0.0356s/iter; left time: 1520.2695s
Epoch: 9 cost time: 18.148850679397583
Epoch: 9, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.275 Vali Acc: 0.932 Test Loss: 0.275 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3554015
	speed: 0.1687s/iter; left time: 7181.8058s
	iters: 200, epoch: 10 | loss: 0.0205439
	speed: 0.0422s/iter; left time: 1790.8047s
	iters: 300, epoch: 10 | loss: 0.0027546
	speed: 0.0435s/iter; left time: 1842.9435s
	iters: 400, epoch: 10 | loss: 0.0010552
	speed: 0.0394s/iter; left time: 1667.1299s
Epoch: 10 cost time: 19.772671461105347
Epoch: 10, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.950541 --> -0.961691).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0964159
	speed: 0.1973s/iter; left time: 8306.5124s
	iters: 200, epoch: 11 | loss: 0.0283925
	speed: 0.0435s/iter; left time: 1827.2878s
	iters: 300, epoch: 11 | loss: 0.1328232
	speed: 0.0428s/iter; left time: 1794.3256s
	iters: 400, epoch: 11 | loss: 0.0955637
	speed: 0.0457s/iter; left time: 1909.7309s
Epoch: 11 cost time: 20.83678674697876
Epoch: 11, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.390 Vali Acc: 0.899 Test Loss: 0.390 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0139525
	speed: 0.1959s/iter; left time: 8157.8587s
	iters: 200, epoch: 12 | loss: 0.0363900
	speed: 0.0410s/iter; left time: 1702.1182s
	iters: 300, epoch: 12 | loss: 0.0623006
	speed: 0.0419s/iter; left time: 1736.4791s
	iters: 400, epoch: 12 | loss: 0.0361896
	speed: 0.0413s/iter; left time: 1707.6637s
Epoch: 12 cost time: 19.556267499923706
Epoch: 12, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0085083
	speed: 0.1999s/iter; left time: 8231.4979s
	iters: 200, epoch: 13 | loss: 0.0082513
	speed: 0.0419s/iter; left time: 1720.2892s
	iters: 300, epoch: 13 | loss: 0.2192789
	speed: 0.0433s/iter; left time: 1775.3139s
	iters: 400, epoch: 13 | loss: 0.0232287
	speed: 0.0432s/iter; left time: 1765.7501s
Epoch: 13 cost time: 20.783488512039185
Epoch: 13, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.622 Vali Acc: 0.881 Test Loss: 0.622 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1532274
	speed: 0.2188s/iter; left time: 8906.5354s
	iters: 200, epoch: 14 | loss: 0.0088714
	speed: 0.0445s/iter; left time: 1805.4708s
	iters: 300, epoch: 14 | loss: 0.0061337
	speed: 0.0415s/iter; left time: 1679.5281s
	iters: 400, epoch: 14 | loss: 0.0788388
	speed: 0.0449s/iter; left time: 1814.4426s
Epoch: 14 cost time: 20.97633123397827
Epoch: 14, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.210 Vali Acc: 0.945 Test Loss: 0.210 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0660619
	speed: 0.2170s/iter; left time: 8730.5305s
	iters: 200, epoch: 15 | loss: 0.1794596
	speed: 0.0424s/iter; left time: 1703.5719s
	iters: 300, epoch: 15 | loss: 0.1244551
	speed: 0.0403s/iter; left time: 1612.8790s
	iters: 400, epoch: 15 | loss: 0.2359358
	speed: 0.0433s/iter; left time: 1728.4660s
Epoch: 15 cost time: 20.407607078552246
Epoch: 15, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.961691 --> -0.962834).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0095305
	speed: 0.2177s/iter; left time: 8658.5227s
	iters: 200, epoch: 16 | loss: 0.1390266
	speed: 0.0406s/iter; left time: 1609.4725s
	iters: 300, epoch: 16 | loss: 0.0785859
	speed: 0.0433s/iter; left time: 1712.1442s
	iters: 400, epoch: 16 | loss: 0.0037587
	speed: 0.0455s/iter; left time: 1795.2889s
Epoch: 16 cost time: 20.707651615142822
Epoch: 16, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0172170
	speed: 0.2110s/iter; left time: 8290.4622s
	iters: 200, epoch: 17 | loss: 0.0810579
	speed: 0.0429s/iter; left time: 1681.9188s
	iters: 300, epoch: 17 | loss: 0.0203364
	speed: 0.0429s/iter; left time: 1679.0754s
	iters: 400, epoch: 17 | loss: 0.0411059
	speed: 0.0412s/iter; left time: 1604.9198s
Epoch: 17 cost time: 20.071377754211426
Epoch: 17, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.281 Vali Acc: 0.929 Test Loss: 0.281 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0151362
	speed: 0.1905s/iter; left time: 7396.8181s
	iters: 200, epoch: 18 | loss: 0.0069302
	speed: 0.0429s/iter; left time: 1661.7316s
	iters: 300, epoch: 18 | loss: 0.0148262
	speed: 0.0426s/iter; left time: 1647.0007s
	iters: 400, epoch: 18 | loss: 0.1118946
	speed: 0.0434s/iter; left time: 1673.0980s
Epoch: 18 cost time: 20.094774961471558
Epoch: 18, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0042612
	speed: 0.1959s/iter; left time: 7513.4483s
	iters: 200, epoch: 19 | loss: 0.0154683
	speed: 0.0453s/iter; left time: 1733.4249s
	iters: 300, epoch: 19 | loss: 0.0460578
	speed: 0.0442s/iter; left time: 1687.3022s
	iters: 400, epoch: 19 | loss: 0.0126960
	speed: 0.0399s/iter; left time: 1517.6657s
Epoch: 19 cost time: 20.80692744255066
Epoch: 19, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0375294
	speed: 0.1990s/iter; left time: 7539.7699s
	iters: 200, epoch: 20 | loss: 0.0023732
	speed: 0.0393s/iter; left time: 1484.1503s
	iters: 300, epoch: 20 | loss: 0.1576183
	speed: 0.0402s/iter; left time: 1516.5461s
	iters: 400, epoch: 20 | loss: 0.1642013
	speed: 0.0402s/iter; left time: 1511.8825s
Epoch: 20 cost time: 19.01746916770935
Epoch: 20, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0294621
	speed: 0.1828s/iter; left time: 6838.9203s
	iters: 200, epoch: 21 | loss: 0.0034087
	speed: 0.0411s/iter; left time: 1535.6538s
	iters: 300, epoch: 21 | loss: 0.0063074
	speed: 0.0411s/iter; left time: 1530.2972s
	iters: 400, epoch: 21 | loss: 0.0340839
	speed: 0.0390s/iter; left time: 1446.8515s
Epoch: 21 cost time: 19.173831701278687
Epoch: 21, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0112264
	speed: 0.1865s/iter; left time: 6891.8550s
	iters: 200, epoch: 22 | loss: 0.0296720
	speed: 0.0418s/iter; left time: 1539.2000s
	iters: 300, epoch: 22 | loss: 0.0197603
	speed: 0.0437s/iter; left time: 1607.0289s
	iters: 400, epoch: 22 | loss: 0.3362429
	speed: 0.0414s/iter; left time: 1516.0396s
Epoch: 22 cost time: 20.221324682235718
Epoch: 22, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.411 Vali Acc: 0.909 Test Loss: 0.411 Test Acc: 0.909
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0253374
	speed: 0.1856s/iter; left time: 6772.7724s
	iters: 200, epoch: 23 | loss: 0.0321323
	speed: 0.0407s/iter; left time: 1480.4435s
	iters: 300, epoch: 23 | loss: 0.0010871
	speed: 0.0405s/iter; left time: 1469.1925s
	iters: 400, epoch: 23 | loss: 0.1166010
	speed: 0.0404s/iter; left time: 1460.8424s
Epoch: 23 cost time: 19.426113843917847
Epoch: 23, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0130581
	speed: 0.1903s/iter; left time: 6855.0349s
	iters: 200, epoch: 24 | loss: 0.0604951
	speed: 0.0396s/iter; left time: 1420.8710s
	iters: 300, epoch: 24 | loss: 0.0399353
	speed: 0.0407s/iter; left time: 1459.3452s
	iters: 400, epoch: 24 | loss: 0.0121403
	speed: 0.0407s/iter; left time: 1453.0345s
Epoch: 24 cost time: 19.367709398269653
Epoch: 24, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0237735
	speed: 0.1853s/iter; left time: 6586.9382s
	iters: 200, epoch: 25 | loss: 0.0013527
	speed: 0.0402s/iter; left time: 1424.0760s
	iters: 300, epoch: 25 | loss: 0.0674982
	speed: 0.0393s/iter; left time: 1389.7157s
	iters: 400, epoch: 25 | loss: 0.5284469
	speed: 0.0398s/iter; left time: 1402.4186s
Epoch: 25 cost time: 19.02448844909668
Epoch: 25, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9628359062321327
model parameter : 5955630
model size : 27.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5203621
	speed: 0.0552s/iter; left time: 2583.2486s
	iters: 200, epoch: 1 | loss: 0.3137893
	speed: 0.0425s/iter; left time: 1983.1382s
	iters: 300, epoch: 1 | loss: 0.7421999
	speed: 0.0452s/iter; left time: 2104.6526s
	iters: 400, epoch: 1 | loss: 0.2791636
	speed: 0.0445s/iter; left time: 2068.9729s
Epoch: 1 cost time: 21.550777673721313
Epoch: 1, Steps: 469 | Train Loss: 0.466 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
Validation loss decreased (inf --> -0.911089).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4174911
	speed: 0.2201s/iter; left time: 10197.9893s
	iters: 200, epoch: 2 | loss: 0.1316491
	speed: 0.0454s/iter; left time: 2100.6310s
	iters: 300, epoch: 2 | loss: 0.1046253
	speed: 0.0481s/iter; left time: 2219.7438s
	iters: 400, epoch: 2 | loss: 0.0612674
	speed: 0.0468s/iter; left time: 2155.5455s
Epoch: 2 cost time: 22.148192882537842
Epoch: 2, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
Validation loss decreased (-0.911089 --> -0.925097).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0424334
	speed: 0.2127s/iter; left time: 9754.3741s
	iters: 200, epoch: 3 | loss: 0.1186590
	speed: 0.0462s/iter; left time: 2113.2486s
	iters: 300, epoch: 3 | loss: 0.0485446
	speed: 0.0427s/iter; left time: 1950.9186s
	iters: 400, epoch: 3 | loss: 0.2277963
	speed: 0.0422s/iter; left time: 1922.6054s
Epoch: 3 cost time: 21.179612398147583
Epoch: 3, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
Validation loss decreased (-0.925097 --> -0.928242).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0855587
	speed: 0.2121s/iter; left time: 9627.2216s
	iters: 200, epoch: 4 | loss: 0.0264415
	speed: 0.0414s/iter; left time: 1874.7299s
	iters: 300, epoch: 4 | loss: 0.2572021
	speed: 0.0440s/iter; left time: 1986.9447s
	iters: 400, epoch: 4 | loss: 0.2197395
	speed: 0.0427s/iter; left time: 1923.4775s
Epoch: 4 cost time: 20.69461417198181
Epoch: 4, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.395 Vali Acc: 0.876 Test Loss: 0.395 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0424498
	speed: 0.1941s/iter; left time: 8717.9587s
	iters: 200, epoch: 5 | loss: 0.5820073
	speed: 0.0453s/iter; left time: 2030.6115s
	iters: 300, epoch: 5 | loss: 0.5011765
	speed: 0.0421s/iter; left time: 1882.7470s
	iters: 400, epoch: 5 | loss: 0.1175459
	speed: 0.0432s/iter; left time: 1926.6404s
Epoch: 5 cost time: 20.643162727355957
Epoch: 5, Steps: 469 | Train Loss: 0.236 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2676612
	speed: 0.1921s/iter; left time: 8541.4169s
	iters: 200, epoch: 6 | loss: 0.5285000
	speed: 0.0455s/iter; left time: 2019.6372s
	iters: 300, epoch: 6 | loss: 0.1720295
	speed: 0.0419s/iter; left time: 1852.6937s
	iters: 400, epoch: 6 | loss: 0.4906190
	speed: 0.0431s/iter; left time: 1905.2403s
Epoch: 6 cost time: 20.92676854133606
Epoch: 6, Steps: 469 | Train Loss: 0.327 Vali Loss: 0.527 Vali Acc: 0.860 Test Loss: 0.527 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2845048
	speed: 0.2013s/iter; left time: 8855.5230s
	iters: 200, epoch: 7 | loss: 0.0343563
	speed: 0.0436s/iter; left time: 1913.3610s
	iters: 300, epoch: 7 | loss: 0.0526219
	speed: 0.0423s/iter; left time: 1854.1637s
	iters: 400, epoch: 7 | loss: 0.5150863
	speed: 0.0438s/iter; left time: 1915.3447s
Epoch: 7 cost time: 20.63753604888916
Epoch: 7, Steps: 469 | Train Loss: 0.353 Vali Loss: 0.400 Vali Acc: 0.876 Test Loss: 0.400 Test Acc: 0.876
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2421941
	speed: 0.1968s/iter; left time: 8563.9732s
	iters: 200, epoch: 8 | loss: 0.1756906
	speed: 0.0442s/iter; left time: 1918.6934s
	iters: 300, epoch: 8 | loss: 0.1208507
	speed: 0.0428s/iter; left time: 1855.9388s
	iters: 400, epoch: 8 | loss: 0.1957062
	speed: 0.0425s/iter; left time: 1835.7299s
Epoch: 8 cost time: 20.65756869316101
Epoch: 8, Steps: 469 | Train Loss: 0.365 Vali Loss: 0.728 Vali Acc: 0.780 Test Loss: 0.728 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4268813
	speed: 0.1922s/iter; left time: 8274.7186s
	iters: 200, epoch: 9 | loss: 0.0760824
	speed: 0.0425s/iter; left time: 1825.7333s
	iters: 300, epoch: 9 | loss: 0.3244884
	speed: 0.0436s/iter; left time: 1868.2845s
	iters: 400, epoch: 9 | loss: 0.5451674
	speed: 0.0414s/iter; left time: 1769.7629s
Epoch: 9 cost time: 20.210538864135742
Epoch: 9, Steps: 469 | Train Loss: 0.287 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2960921
	speed: 0.1953s/iter; left time: 8317.3248s
	iters: 200, epoch: 10 | loss: 0.1269745
	speed: 0.0434s/iter; left time: 1843.7747s
	iters: 300, epoch: 10 | loss: 0.5641887
	speed: 0.0370s/iter; left time: 1567.2774s
	iters: 400, epoch: 10 | loss: 0.5078893
	speed: 0.0378s/iter; left time: 1599.1852s
Epoch: 10 cost time: 18.879507064819336
Epoch: 10, Steps: 469 | Train Loss: 0.305 Vali Loss: 0.524 Vali Acc: 0.879 Test Loss: 0.524 Test Acc: 0.879
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1651198
	speed: 0.1611s/iter; left time: 6785.6093s
	iters: 200, epoch: 11 | loss: 0.2007893
	speed: 0.0429s/iter; left time: 1800.5395s
	iters: 300, epoch: 11 | loss: 0.7806468
	speed: 0.0424s/iter; left time: 1776.9119s
	iters: 400, epoch: 11 | loss: 0.1469852
	speed: 0.0427s/iter; left time: 1787.1230s
Epoch: 11 cost time: 20.604870796203613
Epoch: 11, Steps: 469 | Train Loss: 0.327 Vali Loss: 0.461 Vali Acc: 0.858 Test Loss: 0.461 Test Acc: 0.858
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1618649
	speed: 0.1923s/iter; left time: 8007.9150s
	iters: 200, epoch: 12 | loss: 0.3091132
	speed: 0.0421s/iter; left time: 1748.6293s
	iters: 300, epoch: 12 | loss: 0.1029422
	speed: 0.0426s/iter; left time: 1764.5101s
	iters: 400, epoch: 12 | loss: 1.1673812
	speed: 0.0436s/iter; left time: 1803.9654s
Epoch: 12 cost time: 20.403232097625732
Epoch: 12, Steps: 469 | Train Loss: 0.285 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0658740
	speed: 0.2208s/iter; left time: 9091.7801s
	iters: 200, epoch: 13 | loss: 0.3332926
	speed: 0.0476s/iter; left time: 1954.4536s
	iters: 300, epoch: 13 | loss: 0.0319381
	speed: 0.0457s/iter; left time: 1872.6810s
	iters: 400, epoch: 13 | loss: 0.0273592
	speed: 0.0414s/iter; left time: 1690.3088s
Epoch: 13 cost time: 21.61306095123291
Epoch: 13, Steps: 469 | Train Loss: 0.247 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9282447112635792
model parameter : 5628846
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3214727
	speed: 0.0557s/iter; left time: 2604.8931s
	iters: 200, epoch: 1 | loss: 0.3439545
	speed: 0.0429s/iter; left time: 2005.2122s
	iters: 300, epoch: 1 | loss: 0.1247042
	speed: 0.0433s/iter; left time: 2018.1954s
	iters: 400, epoch: 1 | loss: 0.1670315
	speed: 0.0423s/iter; left time: 1966.8220s
Epoch: 1 cost time: 21.25630784034729
Epoch: 1, Steps: 469 | Train Loss: 0.452 Vali Loss: 0.271 Vali Acc: 0.901 Test Loss: 0.271 Test Acc: 0.901
Validation loss decreased (inf --> -0.901369).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3890241
	speed: 0.2067s/iter; left time: 9575.6923s
	iters: 200, epoch: 2 | loss: 0.0312094
	speed: 0.0418s/iter; left time: 1934.1323s
	iters: 300, epoch: 2 | loss: 0.0733501
	speed: 0.0417s/iter; left time: 1924.7943s
	iters: 400, epoch: 2 | loss: 0.2115919
	speed: 0.0409s/iter; left time: 1883.8548s
Epoch: 2 cost time: 19.949634552001953
Epoch: 2, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.901369 --> -0.930244).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1511714
	speed: 0.1913s/iter; left time: 8773.7307s
	iters: 200, epoch: 3 | loss: 0.4052254
	speed: 0.0398s/iter; left time: 1823.6496s
	iters: 300, epoch: 3 | loss: 0.0655423
	speed: 0.0379s/iter; left time: 1731.2911s
	iters: 400, epoch: 3 | loss: 0.1389577
	speed: 0.0401s/iter; left time: 1826.4508s
Epoch: 3 cost time: 18.80368733406067
Epoch: 3, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6008275
	speed: 0.1847s/iter; left time: 8383.5140s
	iters: 200, epoch: 4 | loss: 0.0217341
	speed: 0.0400s/iter; left time: 1809.9119s
	iters: 300, epoch: 4 | loss: 0.7520690
	speed: 0.0401s/iter; left time: 1811.1755s
	iters: 400, epoch: 4 | loss: 0.0043254
	speed: 0.0409s/iter; left time: 1844.2903s
Epoch: 4 cost time: 19.256256580352783
Epoch: 4, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0466061
	speed: 0.1970s/iter; left time: 8850.8212s
	iters: 200, epoch: 5 | loss: 0.1856294
	speed: 0.0379s/iter; left time: 1700.8908s
	iters: 300, epoch: 5 | loss: 0.4349252
	speed: 0.0427s/iter; left time: 1908.1565s
	iters: 400, epoch: 5 | loss: 0.3784268
	speed: 0.0401s/iter; left time: 1790.7996s
Epoch: 5 cost time: 19.25991725921631
Epoch: 5, Steps: 469 | Train Loss: 0.197 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.930244 --> -0.934817).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1007340
	speed: 0.1684s/iter; left time: 7485.5638s
	iters: 200, epoch: 6 | loss: 0.4885452
	speed: 0.0414s/iter; left time: 1837.0915s
	iters: 300, epoch: 6 | loss: 0.1979272
	speed: 0.0424s/iter; left time: 1877.1349s
	iters: 400, epoch: 6 | loss: 0.0530750
	speed: 0.0415s/iter; left time: 1834.5176s
Epoch: 6 cost time: 19.42294192314148
Epoch: 6, Steps: 469 | Train Loss: 0.261 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2029844
	speed: 0.1815s/iter; left time: 7982.1573s
	iters: 200, epoch: 7 | loss: 0.5373423
	speed: 0.0403s/iter; left time: 1770.5067s
	iters: 300, epoch: 7 | loss: 0.2805580
	speed: 0.0404s/iter; left time: 1769.6394s
	iters: 400, epoch: 7 | loss: 0.8562459
	speed: 0.0400s/iter; left time: 1745.3028s
Epoch: 7 cost time: 18.89958095550537
Epoch: 7, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.425 Vali Acc: 0.879 Test Loss: 0.425 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6059963
	speed: 0.1894s/iter; left time: 8240.5079s
	iters: 200, epoch: 8 | loss: 0.1965262
	speed: 0.0426s/iter; left time: 1851.5297s
	iters: 300, epoch: 8 | loss: 0.0385574
	speed: 0.0402s/iter; left time: 1743.2611s
	iters: 400, epoch: 8 | loss: 0.1667531
	speed: 0.0419s/iter; left time: 1810.9924s
Epoch: 8 cost time: 19.95460343360901
Epoch: 8, Steps: 469 | Train Loss: 0.344 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4501423
	speed: 0.1966s/iter; left time: 8464.0552s
	iters: 200, epoch: 9 | loss: 0.5387130
	speed: 0.0399s/iter; left time: 1713.9946s
	iters: 300, epoch: 9 | loss: 0.2221535
	speed: 0.0395s/iter; left time: 1692.0041s
	iters: 400, epoch: 9 | loss: 0.1274551
	speed: 0.0406s/iter; left time: 1735.1087s
Epoch: 9 cost time: 19.199654817581177
Epoch: 9, Steps: 469 | Train Loss: 0.252 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4630586
	speed: 0.1891s/iter; left time: 8050.0764s
	iters: 200, epoch: 10 | loss: 0.1679529
	speed: 0.0403s/iter; left time: 1710.3469s
	iters: 300, epoch: 10 | loss: 0.0142855
	speed: 0.0402s/iter; left time: 1702.6586s
	iters: 400, epoch: 10 | loss: 0.4000572
	speed: 0.0415s/iter; left time: 1752.9283s
Epoch: 10 cost time: 19.693200826644897
Epoch: 10, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.275 Vali Acc: 0.927 Test Loss: 0.275 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2822975
	speed: 0.1898s/iter; left time: 7992.3591s
	iters: 200, epoch: 11 | loss: 0.0661954
	speed: 0.0431s/iter; left time: 1812.1291s
	iters: 300, epoch: 11 | loss: 0.0798255
	speed: 0.0444s/iter; left time: 1862.4529s
	iters: 400, epoch: 11 | loss: 0.0366466
	speed: 0.0438s/iter; left time: 1831.3764s
Epoch: 11 cost time: 20.369776010513306
Epoch: 11, Steps: 469 | Train Loss: 0.247 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4374555
	speed: 0.2044s/iter; left time: 8512.4312s
	iters: 200, epoch: 12 | loss: 0.0594939
	speed: 0.0442s/iter; left time: 1835.9105s
	iters: 300, epoch: 12 | loss: 0.1447126
	speed: 0.0444s/iter; left time: 1839.2307s
	iters: 400, epoch: 12 | loss: 0.4993368
	speed: 0.0447s/iter; left time: 1848.5792s
Epoch: 12 cost time: 20.75766396522522
Epoch: 12, Steps: 469 | Train Loss: 0.232 Vali Loss: 0.412 Vali Acc: 0.903 Test Loss: 0.412 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3491141
	speed: 0.2008s/iter; left time: 8268.8633s
	iters: 200, epoch: 13 | loss: 0.0293904
	speed: 0.0444s/iter; left time: 1824.5775s
	iters: 300, epoch: 13 | loss: 0.0234500
	speed: 0.0451s/iter; left time: 1846.5340s
	iters: 400, epoch: 13 | loss: 0.2446095
	speed: 0.0436s/iter; left time: 1780.1300s
Epoch: 13 cost time: 20.72290802001953
Epoch: 13, Steps: 469 | Train Loss: 0.274 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0402413
	speed: 0.1987s/iter; left time: 8089.1421s
	iters: 200, epoch: 14 | loss: 0.4626217
	speed: 0.0442s/iter; left time: 1796.6568s
	iters: 300, epoch: 14 | loss: 0.2090773
	speed: 0.0441s/iter; left time: 1784.2295s
	iters: 400, epoch: 14 | loss: 0.4887891
	speed: 0.0421s/iter; left time: 1702.0873s
Epoch: 14 cost time: 20.793964624404907
Epoch: 14, Steps: 469 | Train Loss: 0.201 Vali Loss: 0.406 Vali Acc: 0.890 Test Loss: 0.406 Test Acc: 0.890
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0983132
	speed: 0.1761s/iter; left time: 7086.4130s
	iters: 200, epoch: 15 | loss: 0.1330076
	speed: 0.0356s/iter; left time: 1428.6471s
	iters: 300, epoch: 15 | loss: 0.0343396
	speed: 0.0351s/iter; left time: 1404.9626s
	iters: 400, epoch: 15 | loss: 0.0248605
	speed: 0.0355s/iter; left time: 1417.1190s
Epoch: 15 cost time: 16.956289768218994
Epoch: 15, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.314 Vali Acc: 0.918 Test Loss: 0.314 Test Acc: 0.918
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.934819897084048
model parameter : 5628334
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5409734
	speed: 0.0566s/iter; left time: 2651.0110s
	iters: 200, epoch: 1 | loss: 0.2266815
	speed: 0.0419s/iter; left time: 1956.1468s
	iters: 300, epoch: 1 | loss: 0.3904963
	speed: 0.0431s/iter; left time: 2007.4101s
	iters: 400, epoch: 1 | loss: 0.3866439
	speed: 0.0423s/iter; left time: 1965.1203s
Epoch: 1 cost time: 21.337781190872192
Epoch: 1, Steps: 469 | Train Loss: 0.438 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
Validation loss decreased (inf --> -0.883930).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0210173
	speed: 0.1954s/iter; left time: 9051.3841s
	iters: 200, epoch: 2 | loss: 0.3623272
	speed: 0.0462s/iter; left time: 2133.6895s
	iters: 300, epoch: 2 | loss: 0.0700686
	speed: 0.0410s/iter; left time: 1892.3216s
	iters: 400, epoch: 2 | loss: 0.0085422
	speed: 0.0425s/iter; left time: 1954.3303s
Epoch: 2 cost time: 20.74539804458618
Epoch: 2, Steps: 469 | Train Loss: 0.196 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.883930 --> -0.903084).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0417191
	speed: 0.2018s/iter; left time: 9253.4316s
	iters: 200, epoch: 3 | loss: 0.1026617
	speed: 0.0416s/iter; left time: 1902.8144s
	iters: 300, epoch: 3 | loss: 0.0106155
	speed: 0.0427s/iter; left time: 1950.6122s
	iters: 400, epoch: 3 | loss: 0.1155123
	speed: 0.0412s/iter; left time: 1875.1007s
Epoch: 3 cost time: 19.994677782058716
Epoch: 3, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.903084 --> -0.915377).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0121779
	speed: 0.2020s/iter; left time: 9170.4597s
	iters: 200, epoch: 4 | loss: 1.1749383
	speed: 0.0410s/iter; left time: 1857.6742s
	iters: 300, epoch: 4 | loss: 0.1027650
	speed: 0.0430s/iter; left time: 1943.1750s
	iters: 400, epoch: 4 | loss: 0.1502402
	speed: 0.0414s/iter; left time: 1868.5026s
Epoch: 4 cost time: 20.082260131835938
Epoch: 4, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2091820
	speed: 0.1923s/iter; left time: 8640.9712s
	iters: 200, epoch: 5 | loss: 0.2628417
	speed: 0.0439s/iter; left time: 1968.8495s
	iters: 300, epoch: 5 | loss: 0.1636514
	speed: 0.0424s/iter; left time: 1894.7012s
	iters: 400, epoch: 5 | loss: 0.0803682
	speed: 0.0434s/iter; left time: 1938.2071s
Epoch: 5 cost time: 20.515332221984863
Epoch: 5, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.420 Vali Acc: 0.872 Test Loss: 0.420 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0181033
	speed: 0.1969s/iter; left time: 8752.4684s
	iters: 200, epoch: 6 | loss: 0.2394272
	speed: 0.0422s/iter; left time: 1872.2642s
	iters: 300, epoch: 6 | loss: 1.5299578
	speed: 0.0440s/iter; left time: 1945.9776s
	iters: 400, epoch: 6 | loss: 0.4773267
	speed: 0.0411s/iter; left time: 1813.9005s
Epoch: 6 cost time: 20.250922679901123
Epoch: 6, Steps: 469 | Train Loss: 0.267 Vali Loss: 0.411 Vali Acc: 0.885 Test Loss: 0.411 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1513382
	speed: 0.1807s/iter; left time: 7949.2483s
	iters: 200, epoch: 7 | loss: 0.9636166
	speed: 0.0436s/iter; left time: 1913.9328s
	iters: 300, epoch: 7 | loss: 0.1605275
	speed: 0.0431s/iter; left time: 1887.2487s
	iters: 400, epoch: 7 | loss: 0.0215260
	speed: 0.0415s/iter; left time: 1813.3793s
Epoch: 7 cost time: 20.34438180923462
Epoch: 7, Steps: 469 | Train Loss: 0.256 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
Validation loss decreased (-0.915377 --> -0.926241).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0445876
	speed: 0.2306s/iter; left time: 10036.2934s
	iters: 200, epoch: 8 | loss: 0.1501505
	speed: 0.0437s/iter; left time: 1898.4294s
	iters: 300, epoch: 8 | loss: 0.2100814
	speed: 0.0447s/iter; left time: 1937.4367s
	iters: 400, epoch: 8 | loss: 0.1736998
	speed: 0.0447s/iter; left time: 1931.2090s
Epoch: 8 cost time: 21.496272325515747
Epoch: 8, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.457 Vali Acc: 0.884 Test Loss: 0.457 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1042991
	speed: 0.2227s/iter; left time: 9589.0056s
	iters: 200, epoch: 9 | loss: 0.0257118
	speed: 0.0442s/iter; left time: 1896.2130s
	iters: 300, epoch: 9 | loss: 0.1358320
	speed: 0.0444s/iter; left time: 1901.0018s
	iters: 400, epoch: 9 | loss: 0.1316623
	speed: 0.0470s/iter; left time: 2008.2383s
Epoch: 9 cost time: 21.593233346939087
Epoch: 9, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.336 Vali Acc: 0.907 Test Loss: 0.336 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0718977
	speed: 0.2153s/iter; left time: 9165.4485s
	iters: 200, epoch: 10 | loss: 0.2430225
	speed: 0.0465s/iter; left time: 1973.4127s
	iters: 300, epoch: 10 | loss: 0.5442487
	speed: 0.0440s/iter; left time: 1862.6634s
	iters: 400, epoch: 10 | loss: 0.0719770
	speed: 0.0447s/iter; left time: 1889.7537s
Epoch: 10 cost time: 21.411078691482544
Epoch: 10, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3662003
	speed: 0.1940s/iter; left time: 8169.6916s
	iters: 200, epoch: 11 | loss: 0.1335724
	speed: 0.0439s/iter; left time: 1844.0595s
	iters: 300, epoch: 11 | loss: 0.3194404
	speed: 0.0468s/iter; left time: 1959.6250s
	iters: 400, epoch: 11 | loss: 0.1020582
	speed: 0.0446s/iter; left time: 1866.4460s
Epoch: 11 cost time: 21.365007638931274
Epoch: 11, Steps: 469 | Train Loss: 0.230 Vali Loss: 0.389 Vali Acc: 0.901 Test Loss: 0.389 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2546656
	speed: 0.1963s/iter; left time: 8172.7782s
	iters: 200, epoch: 12 | loss: 0.2161799
	speed: 0.0421s/iter; left time: 1748.5596s
	iters: 300, epoch: 12 | loss: 0.1460630
	speed: 0.0411s/iter; left time: 1703.8339s
	iters: 400, epoch: 12 | loss: 0.0580132
	speed: 0.0424s/iter; left time: 1753.9405s
Epoch: 12 cost time: 20.122942209243774
Epoch: 12, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.8554094
	speed: 0.2015s/iter; left time: 8294.9294s
	iters: 200, epoch: 13 | loss: 0.4481754
	speed: 0.0414s/iter; left time: 1699.8612s
	iters: 300, epoch: 13 | loss: 0.5788093
	speed: 0.0417s/iter; left time: 1707.9209s
	iters: 400, epoch: 13 | loss: 0.2555425
	speed: 0.0413s/iter; left time: 1689.8332s
Epoch: 13 cost time: 20.237980365753174
Epoch: 13, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.926241 --> -0.941107).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1463777
	speed: 0.2114s/iter; left time: 8603.2933s
	iters: 200, epoch: 14 | loss: 0.0552104
	speed: 0.0427s/iter; left time: 1733.6093s
	iters: 300, epoch: 14 | loss: 0.1729317
	speed: 0.0408s/iter; left time: 1653.5742s
	iters: 400, epoch: 14 | loss: 0.0321803
	speed: 0.0410s/iter; left time: 1655.8131s
Epoch: 14 cost time: 20.052486658096313
Epoch: 14, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
Validation loss decreased (-0.941107 --> -0.943394).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0092788
	speed: 0.1927s/iter; left time: 7752.9702s
	iters: 200, epoch: 15 | loss: 0.2496425
	speed: 0.0423s/iter; left time: 1697.1656s
	iters: 300, epoch: 15 | loss: 0.2719080
	speed: 0.0419s/iter; left time: 1675.7995s
	iters: 400, epoch: 15 | loss: 0.0920813
	speed: 0.0417s/iter; left time: 1665.0773s
Epoch: 15 cost time: 19.967801094055176
Epoch: 15, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.306 Vali Acc: 0.923 Test Loss: 0.306 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1766786
	speed: 0.1892s/iter; left time: 7521.9450s
	iters: 200, epoch: 16 | loss: 0.0684701
	speed: 0.0429s/iter; left time: 1699.8586s
	iters: 300, epoch: 16 | loss: 0.0757653
	speed: 0.0428s/iter; left time: 1695.0801s
	iters: 400, epoch: 16 | loss: 0.0137725
	speed: 0.0410s/iter; left time: 1616.8782s
Epoch: 16 cost time: 20.382639408111572
Epoch: 16, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.239 Vali Acc: 0.940 Test Loss: 0.239 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4974024
	speed: 0.1915s/iter; left time: 7527.2813s
	iters: 200, epoch: 17 | loss: 0.3778380
	speed: 0.0409s/iter; left time: 1601.5106s
	iters: 300, epoch: 17 | loss: 0.0415931
	speed: 0.0406s/iter; left time: 1588.5508s
	iters: 400, epoch: 17 | loss: 0.1684608
	speed: 0.0392s/iter; left time: 1528.7504s
Epoch: 17 cost time: 19.37261128425598
Epoch: 17, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0051254
	speed: 0.1913s/iter; left time: 7426.6061s
	iters: 200, epoch: 18 | loss: 0.0334466
	speed: 0.0399s/iter; left time: 1546.5662s
	iters: 300, epoch: 18 | loss: 0.0358293
	speed: 0.0398s/iter; left time: 1538.0401s
	iters: 400, epoch: 18 | loss: 0.0100850
	speed: 0.0394s/iter; left time: 1518.7538s
Epoch: 18 cost time: 19.300293922424316
Epoch: 18, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.233 Vali Acc: 0.934 Test Loss: 0.233 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1627832
	speed: 0.1961s/iter; left time: 7520.9171s
	iters: 200, epoch: 19 | loss: 0.0776487
	speed: 0.0403s/iter; left time: 1542.3646s
	iters: 300, epoch: 19 | loss: 0.0233499
	speed: 0.0393s/iter; left time: 1497.7926s
	iters: 400, epoch: 19 | loss: 0.0825796
	speed: 0.0422s/iter; left time: 1604.5324s
Epoch: 19 cost time: 19.36140537261963
Epoch: 19, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0102100
	speed: 0.1594s/iter; left time: 6039.8278s
	iters: 200, epoch: 20 | loss: 0.0121882
	speed: 0.0412s/iter; left time: 1558.5752s
	iters: 300, epoch: 20 | loss: 0.0257632
	speed: 0.0424s/iter; left time: 1599.0968s
	iters: 400, epoch: 20 | loss: 0.0962862
	speed: 0.0430s/iter; left time: 1616.9614s
Epoch: 20 cost time: 19.837823629379272
Epoch: 20, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.943394 --> -0.950255).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0082387
	speed: 0.2158s/iter; left time: 8075.3322s
	iters: 200, epoch: 21 | loss: 0.0013107
	speed: 0.0443s/iter; left time: 1654.6237s
	iters: 300, epoch: 21 | loss: 0.0473868
	speed: 0.0430s/iter; left time: 1600.0165s
	iters: 400, epoch: 21 | loss: 0.0756847
	speed: 0.0441s/iter; left time: 1637.9882s
Epoch: 21 cost time: 20.645881414413452
Epoch: 21, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.309 Vali Acc: 0.918 Test Loss: 0.309 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1077615
	speed: 0.2028s/iter; left time: 7492.9742s
	iters: 200, epoch: 22 | loss: 0.0059838
	speed: 0.0413s/iter; left time: 1521.2522s
	iters: 300, epoch: 22 | loss: 0.1666071
	speed: 0.0437s/iter; left time: 1606.0304s
	iters: 400, epoch: 22 | loss: 0.0377012
	speed: 0.0442s/iter; left time: 1621.1717s
Epoch: 22 cost time: 20.809826612472534
Epoch: 22, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.1487597
	speed: 0.1899s/iter; left time: 6927.2634s
	iters: 200, epoch: 23 | loss: 0.3691302
	speed: 0.0420s/iter; left time: 1527.4091s
	iters: 300, epoch: 23 | loss: 0.4668516
	speed: 0.0430s/iter; left time: 1560.4510s
	iters: 400, epoch: 23 | loss: 0.0906653
	speed: 0.0410s/iter; left time: 1483.8174s
Epoch: 23 cost time: 19.83444333076477
Epoch: 23, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.289 Vali Acc: 0.927 Test Loss: 0.289 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0993461
	speed: 0.1861s/iter; left time: 6701.9533s
	iters: 200, epoch: 24 | loss: 0.0226302
	speed: 0.0397s/iter; left time: 1424.3194s
	iters: 300, epoch: 24 | loss: 0.1596970
	speed: 0.0410s/iter; left time: 1468.6824s
	iters: 400, epoch: 24 | loss: 0.0032913
	speed: 0.0415s/iter; left time: 1481.7268s
Epoch: 24 cost time: 19.54789710044861
Epoch: 24, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0076834
	speed: 0.1909s/iter; left time: 6786.5227s
	iters: 200, epoch: 25 | loss: 0.7381147
	speed: 0.0412s/iter; left time: 1460.4175s
	iters: 300, epoch: 25 | loss: 0.0152450
	speed: 0.0408s/iter; left time: 1443.7223s
	iters: 400, epoch: 25 | loss: 0.1408554
	speed: 0.0403s/iter; left time: 1421.0437s
Epoch: 25 cost time: 19.115471363067627
Epoch: 25, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
Validation loss decreased (-0.950255 --> -0.952542).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0404066
	speed: 0.1940s/iter; left time: 6805.3709s
	iters: 200, epoch: 26 | loss: 0.0844329
	speed: 0.0405s/iter; left time: 1416.8040s
	iters: 300, epoch: 26 | loss: 0.1128165
	speed: 0.0426s/iter; left time: 1486.7181s
	iters: 400, epoch: 26 | loss: 0.0724476
	speed: 0.0417s/iter; left time: 1449.2289s
Epoch: 26 cost time: 19.94996666908264
Epoch: 26, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.276 Vali Acc: 0.938 Test Loss: 0.276 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0281761
	speed: 0.1966s/iter; left time: 6804.3592s
	iters: 200, epoch: 27 | loss: 0.0511862
	speed: 0.0411s/iter; left time: 1417.5624s
	iters: 300, epoch: 27 | loss: 0.1615431
	speed: 0.0441s/iter; left time: 1517.6978s
	iters: 400, epoch: 27 | loss: 0.3972873
	speed: 0.0448s/iter; left time: 1538.2091s
Epoch: 27 cost time: 20.430793523788452
Epoch: 27, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
Validation loss decreased (-0.952542 --> -0.955401).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0387625
	speed: 0.1955s/iter; left time: 6673.5748s
	iters: 200, epoch: 28 | loss: 0.0477557
	speed: 0.0426s/iter; left time: 1449.3041s
	iters: 300, epoch: 28 | loss: 0.1202274
	speed: 0.0446s/iter; left time: 1514.8883s
	iters: 400, epoch: 28 | loss: 0.0057755
	speed: 0.0428s/iter; left time: 1447.1908s
Epoch: 28 cost time: 20.272881984710693
Epoch: 28, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.265 Vali Acc: 0.940 Test Loss: 0.265 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.1093718
	speed: 0.1916s/iter; left time: 6450.2670s
	iters: 200, epoch: 29 | loss: 0.4476966
	speed: 0.0429s/iter; left time: 1440.8647s
	iters: 300, epoch: 29 | loss: 0.3336917
	speed: 0.0446s/iter; left time: 1493.1790s
	iters: 400, epoch: 29 | loss: 0.0104523
	speed: 0.0453s/iter; left time: 1512.8086s
Epoch: 29 cost time: 20.759772777557373
Epoch: 29, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0312308
	speed: 0.1981s/iter; left time: 6577.2960s
	iters: 200, epoch: 30 | loss: 0.1647007
	speed: 0.0426s/iter; left time: 1409.5735s
	iters: 300, epoch: 30 | loss: 0.0613087
	speed: 0.0398s/iter; left time: 1312.5129s
	iters: 400, epoch: 30 | loss: 0.0391537
	speed: 0.0410s/iter; left time: 1347.7617s
Epoch: 30 cost time: 19.861488103866577
Epoch: 30, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.3274077
	speed: 0.2044s/iter; left time: 6691.2375s
	iters: 200, epoch: 31 | loss: 0.2546428
	speed: 0.0418s/iter; left time: 1363.2307s
	iters: 300, epoch: 31 | loss: 0.0155450
	speed: 0.0405s/iter; left time: 1317.4137s
	iters: 400, epoch: 31 | loss: 0.0276941
	speed: 0.0403s/iter; left time: 1305.8317s
Epoch: 31 cost time: 19.593830347061157
Epoch: 31, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.261 Vali Acc: 0.939 Test Loss: 0.261 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0671702
	speed: 0.2135s/iter; left time: 6889.1137s
	iters: 200, epoch: 32 | loss: 0.0025067
	speed: 0.0448s/iter; left time: 1442.3141s
	iters: 300, epoch: 32 | loss: 0.1810437
	speed: 0.0459s/iter; left time: 1471.3556s
	iters: 400, epoch: 32 | loss: 0.2436395
	speed: 0.0448s/iter; left time: 1432.6885s
Epoch: 32 cost time: 21.499938249588013
Epoch: 32, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.244 Vali Acc: 0.940 Test Loss: 0.244 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0058709
	speed: 0.2172s/iter; left time: 6904.8337s
	iters: 200, epoch: 33 | loss: 0.1282451
	speed: 0.0429s/iter; left time: 1360.9080s
	iters: 300, epoch: 33 | loss: 0.2654682
	speed: 0.0447s/iter; left time: 1412.4776s
	iters: 400, epoch: 33 | loss: 0.0732352
	speed: 0.0448s/iter; left time: 1411.6552s
Epoch: 33 cost time: 20.998944759368896
Epoch: 33, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.299 Vali Acc: 0.923 Test Loss: 0.299 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.1135401
	speed: 0.2164s/iter; left time: 6778.2637s
	iters: 200, epoch: 34 | loss: 0.0151698
	speed: 0.0399s/iter; left time: 1247.2363s
	iters: 300, epoch: 34 | loss: 0.2927769
	speed: 0.0426s/iter; left time: 1324.4635s
	iters: 400, epoch: 34 | loss: 0.0133096
	speed: 0.0438s/iter; left time: 1360.1787s
Epoch: 34 cost time: 20.73365354537964
Epoch: 34, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
Validation loss decreased (-0.955401 --> -0.960261).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.2719733
	speed: 0.2023s/iter; left time: 6240.4252s
	iters: 200, epoch: 35 | loss: 0.0846128
	speed: 0.0409s/iter; left time: 1258.7359s
	iters: 300, epoch: 35 | loss: 0.0136767
	speed: 0.0412s/iter; left time: 1262.7401s
	iters: 400, epoch: 35 | loss: 0.0303687
	speed: 0.0428s/iter; left time: 1308.0752s
Epoch: 35 cost time: 19.778908491134644
Epoch: 35, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0515858
	speed: 0.1913s/iter; left time: 5813.0684s
	iters: 200, epoch: 36 | loss: 0.0202495
	speed: 0.0400s/iter; left time: 1212.5877s
	iters: 300, epoch: 36 | loss: 0.1863497
	speed: 0.0443s/iter; left time: 1338.6139s
	iters: 400, epoch: 36 | loss: 0.0548723
	speed: 0.0416s/iter; left time: 1252.2641s
Epoch: 36 cost time: 20.01441478729248
Epoch: 36, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.341 Vali Acc: 0.934 Test Loss: 0.341 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0688413
	speed: 0.1923s/iter; left time: 5751.6185s
	iters: 200, epoch: 37 | loss: 0.0206772
	speed: 0.0427s/iter; left time: 1273.4618s
	iters: 300, epoch: 37 | loss: 0.0357640
	speed: 0.0407s/iter; left time: 1209.9256s
	iters: 400, epoch: 37 | loss: 0.1899011
	speed: 0.0408s/iter; left time: 1208.6050s
Epoch: 37 cost time: 19.826395750045776
Epoch: 37, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0103057
	speed: 0.1986s/iter; left time: 5847.4424s
	iters: 200, epoch: 38 | loss: 0.0021849
	speed: 0.0424s/iter; left time: 1245.5558s
	iters: 300, epoch: 38 | loss: 0.1094783
	speed: 0.0420s/iter; left time: 1228.7916s
	iters: 400, epoch: 38 | loss: 0.0296248
	speed: 0.0405s/iter; left time: 1179.2923s
Epoch: 38 cost time: 20.119184732437134
Epoch: 38, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0018464
	speed: 0.1956s/iter; left time: 5667.5868s
	iters: 200, epoch: 39 | loss: 0.0972309
	speed: 0.0432s/iter; left time: 1247.4072s
	iters: 300, epoch: 39 | loss: 0.0831839
	speed: 0.0419s/iter; left time: 1205.7651s
	iters: 400, epoch: 39 | loss: 0.0835942
	speed: 0.0426s/iter; left time: 1222.3337s
Epoch: 39 cost time: 20.42098116874695
Epoch: 39, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.243 Vali Acc: 0.936 Test Loss: 0.243 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.2195827
	speed: 0.1964s/iter; left time: 5599.8699s
	iters: 200, epoch: 40 | loss: 0.3311621
	speed: 0.0419s/iter; left time: 1189.6365s
	iters: 300, epoch: 40 | loss: 0.2590155
	speed: 0.0414s/iter; left time: 1171.1786s
	iters: 400, epoch: 40 | loss: 0.0886869
	speed: 0.0433s/iter; left time: 1221.4566s
Epoch: 40 cost time: 20.099637746810913
Epoch: 40, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.218 Vali Acc: 0.945 Test Loss: 0.218 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0084550
	speed: 0.1936s/iter; left time: 5429.3788s
	iters: 200, epoch: 41 | loss: 0.0037347
	speed: 0.0443s/iter; left time: 1236.6716s
	iters: 300, epoch: 41 | loss: 0.0054597
	speed: 0.0432s/iter; left time: 1203.1541s
	iters: 400, epoch: 41 | loss: 0.0073906
	speed: 0.0444s/iter; left time: 1232.3678s
Epoch: 41 cost time: 20.78818917274475
Epoch: 41, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.215 Vali Acc: 0.940 Test Loss: 0.215 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0190854
	speed: 0.1923s/iter; left time: 5300.8843s
	iters: 200, epoch: 42 | loss: 0.1402165
	speed: 0.0437s/iter; left time: 1200.6960s
	iters: 300, epoch: 42 | loss: 0.1775225
	speed: 0.0424s/iter; left time: 1161.5208s
	iters: 400, epoch: 42 | loss: 0.0619906
	speed: 0.0412s/iter; left time: 1124.1059s
Epoch: 42 cost time: 20.353859901428223
Epoch: 42, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0688142
	speed: 0.1920s/iter; left time: 5202.6367s
	iters: 200, epoch: 43 | loss: 0.0979183
	speed: 0.0400s/iter; left time: 1079.8425s
	iters: 300, epoch: 43 | loss: 0.2148208
	speed: 0.0422s/iter; left time: 1135.2555s
	iters: 400, epoch: 43 | loss: 0.0132125
	speed: 0.0426s/iter; left time: 1141.3576s
Epoch: 43 cost time: 20.008862733840942
Epoch: 43, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.203 Vali Acc: 0.955 Test Loss: 0.203 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.1837018
	speed: 0.2094s/iter; left time: 5577.7477s
	iters: 200, epoch: 44 | loss: 0.2331272
	speed: 0.0436s/iter; left time: 1156.1358s
	iters: 300, epoch: 44 | loss: 0.0028523
	speed: 0.0442s/iter; left time: 1168.6886s
	iters: 400, epoch: 44 | loss: 0.0062003
	speed: 0.0462s/iter; left time: 1216.2377s
Epoch: 44 cost time: 21.19794201850891
Epoch: 44, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.289 Vali Acc: 0.929 Test Loss: 0.289 Test Acc: 0.929
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9602630074328188
model parameter : 5627822
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2698793
	speed: 0.0595s/iter; left time: 2785.1769s
	iters: 200, epoch: 1 | loss: 0.1393067
	speed: 0.0418s/iter; left time: 1953.2074s
	iters: 300, epoch: 1 | loss: 0.1502337
	speed: 0.0423s/iter; left time: 1969.5575s
	iters: 400, epoch: 1 | loss: 0.0654489
	speed: 0.0420s/iter; left time: 1951.4030s
Epoch: 1 cost time: 21.473606824874878
Epoch: 1, Steps: 469 | Train Loss: 0.447 Vali Loss: 0.367 Vali Acc: 0.897 Test Loss: 0.367 Test Acc: 0.897
Validation loss decreased (inf --> -0.897366).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1449498
	speed: 0.2174s/iter; left time: 10071.4669s
	iters: 200, epoch: 2 | loss: 0.0378343
	speed: 0.0430s/iter; left time: 1986.8995s
	iters: 300, epoch: 2 | loss: 0.1026916
	speed: 0.0416s/iter; left time: 1920.6206s
	iters: 400, epoch: 2 | loss: 0.1807261
	speed: 0.0438s/iter; left time: 2014.9395s
Epoch: 2 cost time: 20.47485899925232
Epoch: 2, Steps: 469 | Train Loss: 0.189 Vali Loss: 0.251 Vali Acc: 0.921 Test Loss: 0.251 Test Acc: 0.921
Validation loss decreased (-0.897366 --> -0.920809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4710765
	speed: 0.1930s/iter; left time: 8851.8141s
	iters: 200, epoch: 3 | loss: 0.1172528
	speed: 0.0392s/iter; left time: 1795.3166s
	iters: 300, epoch: 3 | loss: 0.2907030
	speed: 0.0414s/iter; left time: 1890.8387s
	iters: 400, epoch: 3 | loss: 0.4748103
	speed: 0.0408s/iter; left time: 1859.9310s
Epoch: 3 cost time: 19.426928758621216
Epoch: 3, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.920809 --> -0.930243).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4427846
	speed: 0.1924s/iter; left time: 8734.7561s
	iters: 200, epoch: 4 | loss: 0.2824580
	speed: 0.0409s/iter; left time: 1854.4823s
	iters: 300, epoch: 4 | loss: 0.1594137
	speed: 0.0414s/iter; left time: 1871.7316s
	iters: 400, epoch: 4 | loss: 0.2101862
	speed: 0.0393s/iter; left time: 1770.2919s
Epoch: 4 cost time: 19.47242259979248
Epoch: 4, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.377 Vali Acc: 0.873 Test Loss: 0.377 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4452525
	speed: 0.1829s/iter; left time: 8218.3067s
	iters: 200, epoch: 5 | loss: 0.7220486
	speed: 0.0371s/iter; left time: 1662.9642s
	iters: 300, epoch: 5 | loss: 0.2171337
	speed: 0.0357s/iter; left time: 1597.7139s
	iters: 400, epoch: 5 | loss: 0.0639401
	speed: 0.0353s/iter; left time: 1574.2594s
Epoch: 5 cost time: 17.43903160095215
Epoch: 5, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.930243 --> -0.935389).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0650178
	speed: 0.1729s/iter; left time: 7686.5771s
	iters: 200, epoch: 6 | loss: 0.0641669
	speed: 0.0404s/iter; left time: 1792.6281s
	iters: 300, epoch: 6 | loss: 0.4716283
	speed: 0.0391s/iter; left time: 1728.3966s
	iters: 400, epoch: 6 | loss: 0.0086898
	speed: 0.0408s/iter; left time: 1802.3321s
Epoch: 6 cost time: 19.43033480644226
Epoch: 6, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.935389 --> -0.941679).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0214974
	speed: 0.1827s/iter; left time: 8038.1970s
	iters: 200, epoch: 7 | loss: 0.0291448
	speed: 0.0395s/iter; left time: 1731.7238s
	iters: 300, epoch: 7 | loss: 0.0596133
	speed: 0.0400s/iter; left time: 1751.3585s
	iters: 400, epoch: 7 | loss: 0.0098829
	speed: 0.0415s/iter; left time: 1813.4634s
Epoch: 7 cost time: 19.21588969230652
Epoch: 7, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1959955
	speed: 0.1960s/iter; left time: 8529.3339s
	iters: 200, epoch: 8 | loss: 0.0890901
	speed: 0.0413s/iter; left time: 1793.4224s
	iters: 300, epoch: 8 | loss: 0.1001545
	speed: 0.0410s/iter; left time: 1775.0530s
	iters: 400, epoch: 8 | loss: 0.0225976
	speed: 0.0380s/iter; left time: 1641.7343s
Epoch: 8 cost time: 19.40245795249939
Epoch: 8, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.345 Vali Acc: 0.920 Test Loss: 0.345 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0464324
	speed: 0.1951s/iter; left time: 8399.9011s
	iters: 200, epoch: 9 | loss: 0.1507615
	speed: 0.0400s/iter; left time: 1719.9596s
	iters: 300, epoch: 9 | loss: 0.0364072
	speed: 0.0418s/iter; left time: 1793.1794s
	iters: 400, epoch: 9 | loss: 0.0898013
	speed: 0.0432s/iter; left time: 1848.2138s
Epoch: 9 cost time: 19.730849504470825
Epoch: 9, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.941679 --> -0.962263).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0625626
	speed: 0.1917s/iter; left time: 8162.0844s
	iters: 200, epoch: 10 | loss: 0.0841236
	speed: 0.0405s/iter; left time: 1722.5072s
	iters: 300, epoch: 10 | loss: 0.2652090
	speed: 0.0420s/iter; left time: 1778.2915s
	iters: 400, epoch: 10 | loss: 0.2586412
	speed: 0.0426s/iter; left time: 1800.6457s
Epoch: 10 cost time: 20.019434213638306
Epoch: 10, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.283 Vali Acc: 0.924 Test Loss: 0.283 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0431864
	speed: 0.2000s/iter; left time: 8423.0562s
	iters: 200, epoch: 11 | loss: 0.0458050
	speed: 0.0431s/iter; left time: 1812.5049s
	iters: 300, epoch: 11 | loss: 0.0793578
	speed: 0.0447s/iter; left time: 1872.0399s
	iters: 400, epoch: 11 | loss: 0.0824610
	speed: 0.0414s/iter; left time: 1730.8348s
Epoch: 11 cost time: 20.641382932662964
Epoch: 11, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2748471
	speed: 0.2169s/iter; left time: 9032.7853s
	iters: 200, epoch: 12 | loss: 0.1001584
	speed: 0.0469s/iter; left time: 1948.5537s
	iters: 300, epoch: 12 | loss: 0.1450449
	speed: 0.0435s/iter; left time: 1803.7166s
	iters: 400, epoch: 12 | loss: 0.0046107
	speed: 0.0459s/iter; left time: 1896.1305s
Epoch: 12 cost time: 21.53441047668457
Epoch: 12, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.323 Vali Acc: 0.923 Test Loss: 0.323 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0710987
	speed: 0.2182s/iter; left time: 8983.8520s
	iters: 200, epoch: 13 | loss: 0.0131139
	speed: 0.0423s/iter; left time: 1736.8209s
	iters: 300, epoch: 13 | loss: 0.0039814
	speed: 0.0448s/iter; left time: 1836.5171s
	iters: 400, epoch: 13 | loss: 0.0297153
	speed: 0.0438s/iter; left time: 1788.8473s
Epoch: 13 cost time: 20.787241220474243
Epoch: 13, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.375 Vali Acc: 0.901 Test Loss: 0.375 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1858712
	speed: 0.2148s/iter; left time: 8743.0941s
	iters: 200, epoch: 14 | loss: 0.1700576
	speed: 0.0445s/iter; left time: 1805.8449s
	iters: 300, epoch: 14 | loss: 0.0323471
	speed: 0.0460s/iter; left time: 1864.6430s
	iters: 400, epoch: 14 | loss: 0.0232952
	speed: 0.0473s/iter; left time: 1912.1020s
Epoch: 14 cost time: 21.951740503311157
Epoch: 14, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0237673
	speed: 0.2068s/iter; left time: 8322.2188s
	iters: 200, epoch: 15 | loss: 0.0308973
	speed: 0.0427s/iter; left time: 1712.7026s
	iters: 300, epoch: 15 | loss: 0.0295553
	speed: 0.0423s/iter; left time: 1691.7980s
	iters: 400, epoch: 15 | loss: 0.0146842
	speed: 0.0435s/iter; left time: 1736.0229s
Epoch: 15 cost time: 20.352914333343506
Epoch: 15, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0689249
	speed: 0.1725s/iter; left time: 6858.5097s
	iters: 200, epoch: 16 | loss: 0.2101628
	speed: 0.0425s/iter; left time: 1684.2473s
	iters: 300, epoch: 16 | loss: 0.0559113
	speed: 0.0401s/iter; left time: 1585.6410s
	iters: 400, epoch: 16 | loss: 0.0993736
	speed: 0.0407s/iter; left time: 1605.0525s
Epoch: 16 cost time: 19.32945442199707
Epoch: 16, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.292 Vali Acc: 0.932 Test Loss: 0.292 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0106763
	speed: 0.1809s/iter; left time: 7108.7872s
	iters: 200, epoch: 17 | loss: 0.2302379
	speed: 0.0424s/iter; left time: 1661.5932s
	iters: 300, epoch: 17 | loss: 0.1384266
	speed: 0.0409s/iter; left time: 1600.6555s
	iters: 400, epoch: 17 | loss: 0.0827098
	speed: 0.0421s/iter; left time: 1642.6752s
Epoch: 17 cost time: 19.78699541091919
Epoch: 17, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0151248
	speed: 0.1925s/iter; left time: 7473.7624s
	iters: 200, epoch: 18 | loss: 0.0016706
	speed: 0.0410s/iter; left time: 1589.6385s
	iters: 300, epoch: 18 | loss: 0.1860855
	speed: 0.0399s/iter; left time: 1540.4269s
	iters: 400, epoch: 18 | loss: 0.1718695
	speed: 0.0413s/iter; left time: 1593.0352s
Epoch: 18 cost time: 19.432141542434692
Epoch: 18, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0054066
	speed: 0.1899s/iter; left time: 7286.1313s
	iters: 200, epoch: 19 | loss: 0.0003773
	speed: 0.0395s/iter; left time: 1512.9391s
	iters: 300, epoch: 19 | loss: 0.0218069
	speed: 0.0418s/iter; left time: 1596.5790s
	iters: 400, epoch: 19 | loss: 0.0245043
	speed: 0.0418s/iter; left time: 1591.2014s
Epoch: 19 cost time: 19.45237374305725
Epoch: 19, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.223 Vali Acc: 0.945 Test Loss: 0.223 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9622641509433962
model parameter : 5627310
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6599796
	speed: 0.0548s/iter; left time: 2565.6818s
	iters: 200, epoch: 1 | loss: 0.2022474
	speed: 0.0388s/iter; left time: 1809.9791s
	iters: 300, epoch: 1 | loss: 0.3754926
	speed: 0.0406s/iter; left time: 1892.2750s
	iters: 400, epoch: 1 | loss: 0.0563906
	speed: 0.0408s/iter; left time: 1898.8829s
Epoch: 1 cost time: 20.260292768478394
Epoch: 1, Steps: 469 | Train Loss: 0.494 Vali Loss: 0.242 Vali Acc: 0.929 Test Loss: 0.242 Test Acc: 0.929
Validation loss decreased (inf --> -0.929100).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1911218
	speed: 0.1904s/iter; left time: 8822.3038s
	iters: 200, epoch: 2 | loss: 0.0440549
	speed: 0.0396s/iter; left time: 1831.5891s
	iters: 300, epoch: 2 | loss: 0.0323222
	speed: 0.0414s/iter; left time: 1908.0573s
	iters: 400, epoch: 2 | loss: 0.1639274
	speed: 0.0400s/iter; left time: 1841.7389s
Epoch: 2 cost time: 19.273680925369263
Epoch: 2, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2238099
	speed: 0.1836s/iter; left time: 8421.4853s
	iters: 200, epoch: 3 | loss: 0.0836527
	speed: 0.0383s/iter; left time: 1750.7724s
	iters: 300, epoch: 3 | loss: 0.0081124
	speed: 0.0386s/iter; left time: 1761.7586s
	iters: 400, epoch: 3 | loss: 0.2896251
	speed: 0.0406s/iter; left time: 1848.3189s
Epoch: 3 cost time: 18.84830093383789
Epoch: 3, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.929100 --> -0.951113).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3023280
	speed: 0.1930s/iter; left time: 8759.0105s
	iters: 200, epoch: 4 | loss: 0.0559141
	speed: 0.0407s/iter; left time: 1844.8425s
	iters: 300, epoch: 4 | loss: 0.0663032
	speed: 0.0397s/iter; left time: 1795.8129s
	iters: 400, epoch: 4 | loss: 0.2572663
	speed: 0.0412s/iter; left time: 1855.8975s
Epoch: 4 cost time: 19.356709957122803
Epoch: 4, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1241538
	speed: 0.1942s/iter; left time: 8724.6669s
	iters: 200, epoch: 5 | loss: 0.0321898
	speed: 0.0433s/iter; left time: 1942.3962s
	iters: 300, epoch: 5 | loss: 0.0284558
	speed: 0.0412s/iter; left time: 1843.1132s
	iters: 400, epoch: 5 | loss: 0.0544235
	speed: 0.0420s/iter; left time: 1875.3509s
Epoch: 5 cost time: 20.068572282791138
Epoch: 5, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.951113 --> -0.963978).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0909605
	speed: 0.2019s/iter; left time: 8976.1883s
	iters: 200, epoch: 6 | loss: 0.2602437
	speed: 0.0439s/iter; left time: 1946.6503s
	iters: 300, epoch: 6 | loss: 0.0669604
	speed: 0.0440s/iter; left time: 1948.2610s
	iters: 400, epoch: 6 | loss: 0.0135143
	speed: 0.0438s/iter; left time: 1932.4048s
Epoch: 6 cost time: 20.881096839904785
Epoch: 6, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1249249
	speed: 0.2067s/iter; left time: 9093.2864s
	iters: 200, epoch: 7 | loss: 0.0049630
	speed: 0.0446s/iter; left time: 1955.9311s
	iters: 300, epoch: 7 | loss: 0.0835435
	speed: 0.0447s/iter; left time: 1956.8521s
	iters: 400, epoch: 7 | loss: 0.0241407
	speed: 0.0453s/iter; left time: 1979.3476s
Epoch: 7 cost time: 21.053560256958008
Epoch: 7, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4056897
	speed: 0.2104s/iter; left time: 9158.0147s
	iters: 200, epoch: 8 | loss: 0.0117652
	speed: 0.0420s/iter; left time: 1822.8934s
	iters: 300, epoch: 8 | loss: 0.0248574
	speed: 0.0438s/iter; left time: 1899.1588s
	iters: 400, epoch: 8 | loss: 0.1339421
	speed: 0.0443s/iter; left time: 1915.3597s
Epoch: 8 cost time: 20.6294207572937
Epoch: 8, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.262 Vali Acc: 0.938 Test Loss: 0.262 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0178959
	speed: 0.1970s/iter; left time: 8478.8179s
	iters: 200, epoch: 9 | loss: 0.0210859
	speed: 0.0416s/iter; left time: 1785.2784s
	iters: 300, epoch: 9 | loss: 0.0325743
	speed: 0.0410s/iter; left time: 1758.3782s
	iters: 400, epoch: 9 | loss: 0.0191885
	speed: 0.0432s/iter; left time: 1846.4498s
Epoch: 9 cost time: 19.887040615081787
Epoch: 9, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0145428
	speed: 0.1951s/iter; left time: 8305.6110s
	iters: 200, epoch: 10 | loss: 0.3203079
	speed: 0.0394s/iter; left time: 1675.7220s
	iters: 300, epoch: 10 | loss: 0.0107514
	speed: 0.0412s/iter; left time: 1745.8522s
	iters: 400, epoch: 10 | loss: 0.4862530
	speed: 0.0422s/iter; left time: 1786.1433s
Epoch: 10 cost time: 19.67958903312683
Epoch: 10, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0308681
	speed: 0.1870s/iter; left time: 7873.1293s
	iters: 200, epoch: 11 | loss: 0.0116757
	speed: 0.0393s/iter; left time: 1649.1895s
	iters: 300, epoch: 11 | loss: 0.2214351
	speed: 0.0359s/iter; left time: 1505.4482s
	iters: 400, epoch: 11 | loss: 0.0068526
	speed: 0.0372s/iter; left time: 1554.8573s
Epoch: 11 cost time: 17.66516661643982
Epoch: 11, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2133842
	speed: 0.1414s/iter; left time: 5887.9980s
	iters: 200, epoch: 12 | loss: 0.1067156
	speed: 0.0416s/iter; left time: 1728.5595s
	iters: 300, epoch: 12 | loss: 0.0279084
	speed: 0.0404s/iter; left time: 1672.8678s
	iters: 400, epoch: 12 | loss: 0.0482791
	speed: 0.0402s/iter; left time: 1660.1775s
Epoch: 12 cost time: 19.033679485321045
Epoch: 12, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0147603
	speed: 0.1766s/iter; left time: 7270.7575s
	iters: 200, epoch: 13 | loss: 0.1050594
	speed: 0.0446s/iter; left time: 1833.0242s
	iters: 300, epoch: 13 | loss: 0.3642843
	speed: 0.0450s/iter; left time: 1843.8026s
	iters: 400, epoch: 13 | loss: 0.0556448
	speed: 0.0443s/iter; left time: 1812.0987s
Epoch: 13 cost time: 21.093595504760742
Epoch: 13, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.364 Vali Acc: 0.907 Test Loss: 0.364 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0043333
	speed: 0.1886s/iter; left time: 7674.8251s
	iters: 200, epoch: 14 | loss: 0.0042765
	speed: 0.0406s/iter; left time: 1650.0231s
	iters: 300, epoch: 14 | loss: 0.1664334
	speed: 0.0406s/iter; left time: 1643.0445s
	iters: 400, epoch: 14 | loss: 0.1011631
	speed: 0.0405s/iter; left time: 1637.2795s
Epoch: 14 cost time: 19.411288261413574
Epoch: 14, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1535751
	speed: 0.1870s/iter; left time: 7524.8345s
	iters: 200, epoch: 15 | loss: 0.2273013
	speed: 0.0392s/iter; left time: 1573.8359s
	iters: 300, epoch: 15 | loss: 0.0057187
	speed: 0.0394s/iter; left time: 1576.3913s
	iters: 400, epoch: 15 | loss: 0.0087784
	speed: 0.0398s/iter; left time: 1590.0260s
Epoch: 15 cost time: 19.103849411010742
Epoch: 15, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9639794168096055
model parameter : 2655406
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5287378
	speed: 0.0583s/iter; left time: 2729.2570s
	iters: 200, epoch: 1 | loss: 0.1072061
	speed: 0.0456s/iter; left time: 2127.5203s
	iters: 300, epoch: 1 | loss: 0.1268054
	speed: 0.0442s/iter; left time: 2058.3440s
	iters: 400, epoch: 1 | loss: 0.1803476
	speed: 0.0437s/iter; left time: 2031.0963s
Epoch: 1 cost time: 22.346710205078125
Epoch: 1, Steps: 469 | Train Loss: 0.487 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
Validation loss decreased (inf --> -0.924812).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0208829
	speed: 0.2178s/iter; left time: 10092.0735s
	iters: 200, epoch: 2 | loss: 0.0158685
	speed: 0.0433s/iter; left time: 2000.2610s
	iters: 300, epoch: 2 | loss: 0.3428927
	speed: 0.0425s/iter; left time: 1959.5323s
	iters: 400, epoch: 2 | loss: 0.0132542
	speed: 0.0421s/iter; left time: 1935.7012s
Epoch: 2 cost time: 20.757461071014404
Epoch: 2, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.924812 --> -0.957117).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0330643
	speed: 0.2210s/iter; left time: 10137.8149s
	iters: 200, epoch: 3 | loss: 0.0324516
	speed: 0.0444s/iter; left time: 2034.1043s
	iters: 300, epoch: 3 | loss: 0.0532020
	speed: 0.0445s/iter; left time: 2034.2722s
	iters: 400, epoch: 3 | loss: 0.2484093
	speed: 0.0454s/iter; left time: 2069.3285s
Epoch: 3 cost time: 21.436304569244385
Epoch: 3, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1730744
	speed: 0.1987s/iter; left time: 9018.3327s
	iters: 200, epoch: 4 | loss: 0.1918367
	speed: 0.0413s/iter; left time: 1872.5209s
	iters: 300, epoch: 4 | loss: 0.0141735
	speed: 0.0419s/iter; left time: 1892.4888s
	iters: 400, epoch: 4 | loss: 0.2289065
	speed: 0.0417s/iter; left time: 1881.2197s
Epoch: 4 cost time: 19.921275854110718
Epoch: 4, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0343287
	speed: 0.1954s/iter; left time: 8778.6134s
	iters: 200, epoch: 5 | loss: 0.1620120
	speed: 0.0431s/iter; left time: 1931.6679s
	iters: 300, epoch: 5 | loss: 0.0165385
	speed: 0.0429s/iter; left time: 1919.4854s
	iters: 400, epoch: 5 | loss: 0.1842888
	speed: 0.0419s/iter; left time: 1869.4114s
Epoch: 5 cost time: 20.329957008361816
Epoch: 5, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0146530
	speed: 0.1885s/iter; left time: 8379.0965s
	iters: 200, epoch: 6 | loss: 0.2771380
	speed: 0.0433s/iter; left time: 1918.8721s
	iters: 300, epoch: 6 | loss: 0.2629550
	speed: 0.0412s/iter; left time: 1823.5071s
	iters: 400, epoch: 6 | loss: 0.0355154
	speed: 0.0420s/iter; left time: 1854.5557s
Epoch: 6 cost time: 19.96289086341858
Epoch: 6, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (-0.957117 --> -0.960833).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0735849
	speed: 0.1931s/iter; left time: 8493.6003s
	iters: 200, epoch: 7 | loss: 0.0237433
	speed: 0.0397s/iter; left time: 1742.9074s
	iters: 300, epoch: 7 | loss: 0.0090073
	speed: 0.0422s/iter; left time: 1848.0410s
	iters: 400, epoch: 7 | loss: 0.0360514
	speed: 0.0423s/iter; left time: 1846.1020s
Epoch: 7 cost time: 19.908469676971436
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0078273
	speed: 0.1982s/iter; left time: 8627.2020s
	iters: 200, epoch: 8 | loss: 0.2676232
	speed: 0.0431s/iter; left time: 1869.6765s
	iters: 300, epoch: 8 | loss: 0.0250288
	speed: 0.0420s/iter; left time: 1819.3500s
	iters: 400, epoch: 8 | loss: 0.0028986
	speed: 0.0439s/iter; left time: 1899.0999s
Epoch: 8 cost time: 20.405784368515015
Epoch: 8, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.216 Vali Acc: 0.940 Test Loss: 0.216 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0411026
	speed: 0.1964s/iter; left time: 8456.8987s
	iters: 200, epoch: 9 | loss: 0.0584107
	speed: 0.0426s/iter; left time: 1829.2496s
	iters: 300, epoch: 9 | loss: 0.4592442
	speed: 0.0433s/iter; left time: 1857.3780s
	iters: 400, epoch: 9 | loss: 0.0111252
	speed: 0.0423s/iter; left time: 1809.2668s
Epoch: 9 cost time: 20.38886785507202
Epoch: 9, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.243 Vali Acc: 0.936 Test Loss: 0.243 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3444064
	speed: 0.1815s/iter; left time: 7728.0337s
	iters: 200, epoch: 10 | loss: 0.1013315
	speed: 0.0424s/iter; left time: 1801.5648s
	iters: 300, epoch: 10 | loss: 0.0025234
	speed: 0.0408s/iter; left time: 1729.0893s
	iters: 400, epoch: 10 | loss: 0.0048318
	speed: 0.0392s/iter; left time: 1658.3874s
Epoch: 10 cost time: 19.242812633514404
Epoch: 10, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0027661
	speed: 0.1873s/iter; left time: 7886.0948s
	iters: 200, epoch: 11 | loss: 0.0850629
	speed: 0.0419s/iter; left time: 1758.8953s
	iters: 300, epoch: 11 | loss: 0.2403340
	speed: 0.0416s/iter; left time: 1743.6649s
	iters: 400, epoch: 11 | loss: 0.0179926
	speed: 0.0401s/iter; left time: 1676.1201s
Epoch: 11 cost time: 19.763872623443604
Epoch: 11, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.299 Vali Acc: 0.934 Test Loss: 0.299 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0238785
	speed: 0.1947s/iter; left time: 8109.1745s
	iters: 200, epoch: 12 | loss: 0.0020727
	speed: 0.0417s/iter; left time: 1733.0865s
	iters: 300, epoch: 12 | loss: 0.1709816
	speed: 0.0413s/iter; left time: 1712.8226s
	iters: 400, epoch: 12 | loss: 0.0021768
	speed: 0.0430s/iter; left time: 1776.3852s
Epoch: 12 cost time: 20.320759773254395
Epoch: 12, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0069391
	speed: 0.2062s/iter; left time: 8490.0648s
	iters: 200, epoch: 13 | loss: 0.0017154
	speed: 0.0435s/iter; left time: 1788.0155s
	iters: 300, epoch: 13 | loss: 0.1374926
	speed: 0.0421s/iter; left time: 1723.7028s
	iters: 400, epoch: 13 | loss: 0.0099373
	speed: 0.0437s/iter; left time: 1785.0426s
Epoch: 13 cost time: 20.290884733200073
Epoch: 13, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0037230
	speed: 0.2105s/iter; left time: 8569.3428s
	iters: 200, epoch: 14 | loss: 0.9236315
	speed: 0.0452s/iter; left time: 1835.4497s
	iters: 300, epoch: 14 | loss: 0.0024991
	speed: 0.0441s/iter; left time: 1784.5996s
	iters: 400, epoch: 14 | loss: 0.3061613
	speed: 0.0430s/iter; left time: 1737.7386s
Epoch: 14 cost time: 21.134335041046143
Epoch: 14, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0053222
	speed: 0.2079s/iter; left time: 8364.7778s
	iters: 200, epoch: 15 | loss: 0.4290729
	speed: 0.0432s/iter; left time: 1733.3311s
	iters: 300, epoch: 15 | loss: 0.0111378
	speed: 0.0393s/iter; left time: 1573.5086s
	iters: 400, epoch: 15 | loss: 0.0280713
	speed: 0.0408s/iter; left time: 1627.5465s
Epoch: 15 cost time: 19.740986824035645
Epoch: 15, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.250 Vali Acc: 0.932 Test Loss: 0.250 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2423908
	speed: 0.1880s/iter; left time: 7477.7185s
	iters: 200, epoch: 16 | loss: 0.0085756
	speed: 0.0391s/iter; left time: 1552.8375s
	iters: 300, epoch: 16 | loss: 0.0082258
	speed: 0.0416s/iter; left time: 1645.7606s
	iters: 400, epoch: 16 | loss: 0.0128665
	speed: 0.0431s/iter; left time: 1700.5800s
Epoch: 16 cost time: 19.861216068267822
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9608347627215552
model parameter : 2655150
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4263489
	speed: 0.0515s/iter; left time: 2410.5154s
	iters: 200, epoch: 1 | loss: 0.1945281
	speed: 0.0377s/iter; left time: 1762.0719s
	iters: 300, epoch: 1 | loss: 0.0644495
	speed: 0.0397s/iter; left time: 1848.6340s
	iters: 400, epoch: 1 | loss: 0.1277966
	speed: 0.0372s/iter; left time: 1730.6585s
Epoch: 1 cost time: 19.22099757194519
Epoch: 1, Steps: 469 | Train Loss: 0.499 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
Validation loss decreased (inf --> -0.919666).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1497337
	speed: 0.1658s/iter; left time: 7682.5332s
	iters: 200, epoch: 2 | loss: 0.0270255
	speed: 0.0394s/iter; left time: 1821.5711s
	iters: 300, epoch: 2 | loss: 0.0484109
	speed: 0.0378s/iter; left time: 1742.6110s
	iters: 400, epoch: 2 | loss: 0.0512118
	speed: 0.0378s/iter; left time: 1738.7986s
Epoch: 2 cost time: 18.36099624633789
Epoch: 2, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.919666 --> -0.922239).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2106533
	speed: 0.1693s/iter; left time: 7764.4152s
	iters: 200, epoch: 3 | loss: 0.0794249
	speed: 0.0375s/iter; left time: 1716.6985s
	iters: 300, epoch: 3 | loss: 0.5961422
	speed: 0.0364s/iter; left time: 1660.5698s
	iters: 400, epoch: 3 | loss: 0.0240328
	speed: 0.0400s/iter; left time: 1821.6863s
Epoch: 3 cost time: 18.254827737808228
Epoch: 3, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.282 Vali Acc: 0.921 Test Loss: 0.282 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0469559
	speed: 0.1694s/iter; left time: 7689.1983s
	iters: 200, epoch: 4 | loss: 0.1707196
	speed: 0.0397s/iter; left time: 1795.9984s
	iters: 300, epoch: 4 | loss: 0.0991788
	speed: 0.0390s/iter; left time: 1762.0029s
	iters: 400, epoch: 4 | loss: 0.1236604
	speed: 0.0404s/iter; left time: 1824.0156s
Epoch: 4 cost time: 18.97480082511902
Epoch: 4, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.922239 --> -0.949398).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0227453
	speed: 0.1749s/iter; left time: 7856.2598s
	iters: 200, epoch: 5 | loss: 0.0110342
	speed: 0.0404s/iter; left time: 1810.0995s
	iters: 300, epoch: 5 | loss: 0.2358426
	speed: 0.0402s/iter; left time: 1796.8547s
	iters: 400, epoch: 5 | loss: 0.1609218
	speed: 0.0379s/iter; left time: 1691.7691s
Epoch: 5 cost time: 18.38344693183899
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.239 Vali Acc: 0.947 Test Loss: 0.239 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0273906
	speed: 0.1519s/iter; left time: 6753.8123s
	iters: 200, epoch: 6 | loss: 0.0564568
	speed: 0.0395s/iter; left time: 1749.8692s
	iters: 300, epoch: 6 | loss: 0.2832489
	speed: 0.0389s/iter; left time: 1722.2654s
	iters: 400, epoch: 6 | loss: 0.0095455
	speed: 0.0373s/iter; left time: 1647.8582s
Epoch: 6 cost time: 18.38388466835022
Epoch: 6, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0514527
	speed: 0.1738s/iter; left time: 7643.1273s
	iters: 200, epoch: 7 | loss: 0.0203283
	speed: 0.0391s/iter; left time: 1715.9778s
	iters: 300, epoch: 7 | loss: 0.2448186
	speed: 0.0390s/iter; left time: 1709.0912s
	iters: 400, epoch: 7 | loss: 0.0797938
	speed: 0.0407s/iter; left time: 1775.9126s
Epoch: 7 cost time: 18.993101119995117
Epoch: 7, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0125054
	speed: 0.1919s/iter; left time: 8348.9340s
	iters: 200, epoch: 8 | loss: 0.0291808
	speed: 0.0428s/iter; left time: 1858.5196s
	iters: 300, epoch: 8 | loss: 0.0041632
	speed: 0.0408s/iter; left time: 1768.4953s
	iters: 400, epoch: 8 | loss: 0.0065874
	speed: 0.0404s/iter; left time: 1746.9080s
Epoch: 8 cost time: 19.5116024017334
Epoch: 8, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.949398 --> -0.951971).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1793058
	speed: 0.1880s/iter; left time: 8091.3467s
	iters: 200, epoch: 9 | loss: 0.0135678
	speed: 0.0420s/iter; left time: 1803.6371s
	iters: 300, epoch: 9 | loss: 0.0406266
	speed: 0.0408s/iter; left time: 1749.8703s
	iters: 400, epoch: 9 | loss: 0.4730341
	speed: 0.0406s/iter; left time: 1736.7116s
Epoch: 9 cost time: 19.378106594085693
Epoch: 9, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0294153
	speed: 0.1786s/iter; left time: 7603.7599s
	iters: 200, epoch: 10 | loss: 0.0038269
	speed: 0.0387s/iter; left time: 1645.9253s
	iters: 300, epoch: 10 | loss: 0.0288993
	speed: 0.0376s/iter; left time: 1593.2756s
	iters: 400, epoch: 10 | loss: 0.0719058
	speed: 0.0375s/iter; left time: 1585.3136s
Epoch: 10 cost time: 18.457669734954834
Epoch: 10, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.248 Vali Acc: 0.939 Test Loss: 0.248 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0018106
	speed: 0.1727s/iter; left time: 7273.5737s
	iters: 200, epoch: 11 | loss: 0.2283139
	speed: 0.0395s/iter; left time: 1658.3486s
	iters: 300, epoch: 11 | loss: 0.4500819
	speed: 0.0387s/iter; left time: 1622.6488s
	iters: 400, epoch: 11 | loss: 0.0453929
	speed: 0.0374s/iter; left time: 1564.9534s
Epoch: 11 cost time: 18.46747636795044
Epoch: 11, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0914559
	speed: 0.1714s/iter; left time: 7138.8333s
	iters: 200, epoch: 12 | loss: 0.0229946
	speed: 0.0366s/iter; left time: 1521.6728s
	iters: 300, epoch: 12 | loss: 0.0200303
	speed: 0.0385s/iter; left time: 1596.6140s
	iters: 400, epoch: 12 | loss: 0.1119847
	speed: 0.0392s/iter; left time: 1620.9389s
Epoch: 12 cost time: 18.37088441848755
Epoch: 12, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0311714
	speed: 0.1655s/iter; left time: 6816.1141s
	iters: 200, epoch: 13 | loss: 0.0222189
	speed: 0.0385s/iter; left time: 1582.1645s
	iters: 300, epoch: 13 | loss: 0.0946268
	speed: 0.0391s/iter; left time: 1600.5195s
	iters: 400, epoch: 13 | loss: 0.0014087
	speed: 0.0369s/iter; left time: 1509.3672s
Epoch: 13 cost time: 18.21970820426941
Epoch: 13, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0280056
	speed: 0.1497s/iter; left time: 6094.8369s
	iters: 200, epoch: 14 | loss: 0.0228145
	speed: 0.0348s/iter; left time: 1413.3041s
	iters: 300, epoch: 14 | loss: 0.1600222
	speed: 0.0348s/iter; left time: 1407.8469s
	iters: 400, epoch: 14 | loss: 0.3943514
	speed: 0.0349s/iter; left time: 1408.3556s
Epoch: 14 cost time: 16.779897451400757
Epoch: 14, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.951971 --> -0.964264).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0082408
	speed: 0.1541s/iter; left time: 6201.3992s
	iters: 200, epoch: 15 | loss: 0.0058925
	speed: 0.0357s/iter; left time: 1434.5405s
	iters: 300, epoch: 15 | loss: 0.0110722
	speed: 0.0369s/iter; left time: 1477.5875s
	iters: 400, epoch: 15 | loss: 0.0011298
	speed: 0.0379s/iter; left time: 1513.3370s
Epoch: 15 cost time: 17.807721853256226
Epoch: 15, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.226 Vali Acc: 0.951 Test Loss: 0.226 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4759424
	speed: 0.1704s/iter; left time: 6777.8361s
	iters: 200, epoch: 16 | loss: 0.0685542
	speed: 0.0388s/iter; left time: 1538.4322s
	iters: 300, epoch: 16 | loss: 0.0069058
	speed: 0.0378s/iter; left time: 1494.5667s
	iters: 400, epoch: 16 | loss: 0.0062289
	speed: 0.0379s/iter; left time: 1494.6211s
Epoch: 16 cost time: 18.147120237350464
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0023067
	speed: 0.1652s/iter; left time: 6492.3830s
	iters: 200, epoch: 17 | loss: 0.0066056
	speed: 0.0358s/iter; left time: 1402.1230s
	iters: 300, epoch: 17 | loss: 0.0066429
	speed: 0.0375s/iter; left time: 1465.8722s
	iters: 400, epoch: 17 | loss: 0.0512402
	speed: 0.0388s/iter; left time: 1512.0120s
Epoch: 17 cost time: 18.18420100212097
Epoch: 17, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2682857
	speed: 0.1759s/iter; left time: 6830.5048s
	iters: 200, epoch: 18 | loss: 0.0015776
	speed: 0.0412s/iter; left time: 1594.9366s
	iters: 300, epoch: 18 | loss: 0.0287084
	speed: 0.0416s/iter; left time: 1607.0173s
	iters: 400, epoch: 18 | loss: 0.1554647
	speed: 0.0396s/iter; left time: 1527.2213s
Epoch: 18 cost time: 19.71979594230652
Epoch: 18, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.945 Test Loss: 0.265 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0029457
	speed: 0.1907s/iter; left time: 7314.2155s
	iters: 200, epoch: 19 | loss: 0.0115485
	speed: 0.0410s/iter; left time: 1567.5359s
	iters: 300, epoch: 19 | loss: 0.0230217
	speed: 0.0386s/iter; left time: 1471.6943s
	iters: 400, epoch: 19 | loss: 0.2658365
	speed: 0.0396s/iter; left time: 1506.6822s
Epoch: 19 cost time: 19.12597918510437
Epoch: 19, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0034330
	speed: 0.1863s/iter; left time: 7057.8415s
	iters: 200, epoch: 20 | loss: 0.4244100
	speed: 0.0394s/iter; left time: 1487.9660s
	iters: 300, epoch: 20 | loss: 0.0156175
	speed: 0.0388s/iter; left time: 1462.2509s
	iters: 400, epoch: 20 | loss: 0.0015404
	speed: 0.0399s/iter; left time: 1499.1220s
Epoch: 20 cost time: 18.82668447494507
Epoch: 20, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2424291
	speed: 0.1719s/iter; left time: 6433.2851s
	iters: 200, epoch: 21 | loss: 0.0887353
	speed: 0.0372s/iter; left time: 1389.5663s
	iters: 300, epoch: 21 | loss: 0.0035594
	speed: 0.0416s/iter; left time: 1547.2552s
	iters: 400, epoch: 21 | loss: 0.0903565
	speed: 0.0388s/iter; left time: 1441.5203s
Epoch: 21 cost time: 18.658692836761475
Epoch: 21, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.225 Vali Acc: 0.940 Test Loss: 0.225 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0203366
	speed: 0.1644s/iter; left time: 6076.5057s
	iters: 200, epoch: 22 | loss: 0.0422024
	speed: 0.0396s/iter; left time: 1457.7982s
	iters: 300, epoch: 22 | loss: 0.0681972
	speed: 0.0395s/iter; left time: 1451.2225s
	iters: 400, epoch: 22 | loss: 0.0029412
	speed: 0.0381s/iter; left time: 1397.4236s
Epoch: 22 cost time: 18.436812162399292
Epoch: 22, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.964264 --> -0.966551).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1036305
	speed: 0.1652s/iter; left time: 6025.6969s
	iters: 200, epoch: 23 | loss: 0.1837193
	speed: 0.0391s/iter; left time: 1422.9104s
	iters: 300, epoch: 23 | loss: 0.1823817
	speed: 0.0373s/iter; left time: 1353.7620s
	iters: 400, epoch: 23 | loss: 0.1597423
	speed: 0.0378s/iter; left time: 1366.6789s
Epoch: 23 cost time: 18.0190532207489
Epoch: 23, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0018228
	speed: 0.1696s/iter; left time: 6108.1938s
	iters: 200, epoch: 24 | loss: 0.0029288
	speed: 0.0373s/iter; left time: 1338.4018s
	iters: 300, epoch: 24 | loss: 0.0916409
	speed: 0.0367s/iter; left time: 1313.2589s
	iters: 400, epoch: 24 | loss: 0.0085001
	speed: 0.0385s/iter; left time: 1373.2834s
Epoch: 24 cost time: 17.98042607307434
Epoch: 24, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.263 Vali Acc: 0.949 Test Loss: 0.263 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0228516
	speed: 0.1755s/iter; left time: 6239.3486s
	iters: 200, epoch: 25 | loss: 0.0907451
	speed: 0.0385s/iter; left time: 1365.4238s
	iters: 300, epoch: 25 | loss: 0.1439163
	speed: 0.0383s/iter; left time: 1353.9396s
	iters: 400, epoch: 25 | loss: 0.2388889
	speed: 0.0391s/iter; left time: 1378.7936s
Epoch: 25 cost time: 18.409579277038574
Epoch: 25, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.5165817
	speed: 0.1532s/iter; left time: 5374.4342s
	iters: 200, epoch: 26 | loss: 0.0146884
	speed: 0.0394s/iter; left time: 1377.8232s
	iters: 300, epoch: 26 | loss: 0.0043088
	speed: 0.0384s/iter; left time: 1337.8787s
	iters: 400, epoch: 26 | loss: 0.0253362
	speed: 0.0393s/iter; left time: 1366.7490s
Epoch: 26 cost time: 18.351595640182495
Epoch: 26, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0113989
	speed: 0.1574s/iter; left time: 5447.6535s
	iters: 200, epoch: 27 | loss: 0.0080611
	speed: 0.0379s/iter; left time: 1309.5334s
	iters: 300, epoch: 27 | loss: 0.0286664
	speed: 0.0380s/iter; left time: 1305.8930s
	iters: 400, epoch: 27 | loss: 0.0016316
	speed: 0.0397s/iter; left time: 1363.6028s
Epoch: 27 cost time: 18.483588218688965
Epoch: 27, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0042151
	speed: 0.1710s/iter; left time: 5838.2767s
	iters: 200, epoch: 28 | loss: 0.0093690
	speed: 0.0383s/iter; left time: 1302.0488s
	iters: 300, epoch: 28 | loss: 0.0190749
	speed: 0.0387s/iter; left time: 1312.4865s
	iters: 400, epoch: 28 | loss: 0.2916256
	speed: 0.0408s/iter; left time: 1379.2933s
Epoch: 28 cost time: 18.345133543014526
Epoch: 28, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0409603
	speed: 0.1837s/iter; left time: 6183.4398s
	iters: 200, epoch: 29 | loss: 0.0040806
	speed: 0.0410s/iter; left time: 1376.5526s
	iters: 300, epoch: 29 | loss: 0.0019952
	speed: 0.0411s/iter; left time: 1374.1145s
	iters: 400, epoch: 29 | loss: 0.0067763
	speed: 0.0410s/iter; left time: 1368.1041s
Epoch: 29 cost time: 19.460343837738037
Epoch: 29, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0004727
	speed: 0.1870s/iter; left time: 6207.3966s
	iters: 200, epoch: 30 | loss: 0.0405309
	speed: 0.0418s/iter; left time: 1384.7506s
	iters: 300, epoch: 30 | loss: 0.0100400
	speed: 0.0410s/iter; left time: 1353.8324s
	iters: 400, epoch: 30 | loss: 0.0009891
	speed: 0.0396s/iter; left time: 1301.7062s
Epoch: 30 cost time: 19.384928226470947
Epoch: 30, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0111410
	speed: 0.1918s/iter; left time: 6277.8063s
	iters: 200, epoch: 31 | loss: 0.0079376
	speed: 0.0418s/iter; left time: 1364.4691s
	iters: 300, epoch: 31 | loss: 0.2749903
	speed: 0.0411s/iter; left time: 1336.7111s
	iters: 400, epoch: 31 | loss: 0.0012682
	speed: 0.0400s/iter; left time: 1297.1328s
Epoch: 31 cost time: 19.5014591217041
Epoch: 31, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0076130
	speed: 0.1779s/iter; left time: 5739.7695s
	iters: 200, epoch: 32 | loss: 0.0075344
	speed: 0.0382s/iter; left time: 1227.4227s
	iters: 300, epoch: 32 | loss: 0.0025520
	speed: 0.0380s/iter; left time: 1218.9006s
	iters: 400, epoch: 32 | loss: 0.0028145
	speed: 0.0394s/iter; left time: 1260.4086s
Epoch: 32 cost time: 18.78692078590393
Epoch: 32, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.296 Vali Acc: 0.940 Test Loss: 0.296 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9665523156089194
model parameter : 2654894
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5679492
	speed: 0.0508s/iter; left time: 2379.3540s
	iters: 200, epoch: 1 | loss: 0.2883799
	speed: 0.0380s/iter; left time: 1772.3372s
	iters: 300, epoch: 1 | loss: 0.0429322
	speed: 0.0362s/iter; left time: 1686.0849s
	iters: 400, epoch: 1 | loss: 0.1070190
	speed: 0.0388s/iter; left time: 1802.0747s
Epoch: 1 cost time: 19.055252075195312
Epoch: 1, Steps: 469 | Train Loss: 0.491 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
Validation loss decreased (inf --> -0.906229).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2940006
	speed: 0.1617s/iter; left time: 7493.0821s
	iters: 200, epoch: 2 | loss: 0.0863164
	speed: 0.0351s/iter; left time: 1620.9479s
	iters: 300, epoch: 2 | loss: 0.2959407
	speed: 0.0313s/iter; left time: 1443.1788s
	iters: 400, epoch: 2 | loss: 0.1433891
	speed: 0.0310s/iter; left time: 1428.4379s
Epoch: 2 cost time: 15.38953971862793
Epoch: 2, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.304 Vali Acc: 0.916 Test Loss: 0.304 Test Acc: 0.916
Validation loss decreased (-0.906229 --> -0.915949).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4079288
	speed: 0.1085s/iter; left time: 4976.2523s
	iters: 200, epoch: 3 | loss: 0.2267605
	speed: 0.0381s/iter; left time: 1742.0181s
	iters: 300, epoch: 3 | loss: 0.0725760
	speed: 0.0390s/iter; left time: 1779.9089s
	iters: 400, epoch: 3 | loss: 0.4416947
	speed: 0.0399s/iter; left time: 1816.8393s
Epoch: 3 cost time: 17.559117078781128
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
Validation loss decreased (-0.915949 --> -0.939964).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0794570
	speed: 0.1666s/iter; left time: 7564.2893s
	iters: 200, epoch: 4 | loss: 0.0155191
	speed: 0.0376s/iter; left time: 1702.3270s
	iters: 300, epoch: 4 | loss: 0.1489804
	speed: 0.0383s/iter; left time: 1730.3548s
	iters: 400, epoch: 4 | loss: 0.4041410
	speed: 0.0372s/iter; left time: 1679.0423s
Epoch: 4 cost time: 17.849185943603516
Epoch: 4, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.298 Vali Acc: 0.912 Test Loss: 0.298 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0239794
	speed: 0.1680s/iter; left time: 7547.5280s
	iters: 200, epoch: 5 | loss: 0.0088934
	speed: 0.0377s/iter; left time: 1690.5181s
	iters: 300, epoch: 5 | loss: 0.0547845
	speed: 0.0374s/iter; left time: 1671.2731s
	iters: 400, epoch: 5 | loss: 0.0379330
	speed: 0.0356s/iter; left time: 1587.9837s
Epoch: 5 cost time: 17.93109965324402
Epoch: 5, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.276 Vali Acc: 0.929 Test Loss: 0.276 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0115130
	speed: 0.1798s/iter; left time: 7993.4694s
	iters: 200, epoch: 6 | loss: 0.1295994
	speed: 0.0378s/iter; left time: 1677.2549s
	iters: 300, epoch: 6 | loss: 0.0035770
	speed: 0.0356s/iter; left time: 1575.4456s
	iters: 400, epoch: 6 | loss: 0.0388145
	speed: 0.0373s/iter; left time: 1647.7449s
Epoch: 6 cost time: 17.872318506240845
Epoch: 6, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
Validation loss decreased (-0.939964 --> -0.961405).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0476051
	speed: 0.1791s/iter; left time: 7876.6483s
	iters: 200, epoch: 7 | loss: 0.1850199
	speed: 0.0375s/iter; left time: 1646.0510s
	iters: 300, epoch: 7 | loss: 0.1859385
	speed: 0.0388s/iter; left time: 1697.2118s
	iters: 400, epoch: 7 | loss: 0.0054863
	speed: 0.0405s/iter; left time: 1770.3529s
Epoch: 7 cost time: 18.68070411682129
Epoch: 7, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.379 Vali Acc: 0.897 Test Loss: 0.379 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0451830
	speed: 0.1850s/iter; left time: 8050.8041s
	iters: 200, epoch: 8 | loss: 0.5373713
	speed: 0.0403s/iter; left time: 1749.7098s
	iters: 300, epoch: 8 | loss: 0.0853804
	speed: 0.0402s/iter; left time: 1739.8487s
	iters: 400, epoch: 8 | loss: 0.1236612
	speed: 0.0396s/iter; left time: 1712.2404s
Epoch: 8 cost time: 19.3934965133667
Epoch: 8, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1242243
	speed: 0.1837s/iter; left time: 7910.1233s
	iters: 200, epoch: 9 | loss: 0.0432338
	speed: 0.0393s/iter; left time: 1686.2004s
	iters: 300, epoch: 9 | loss: 0.0018771
	speed: 0.0404s/iter; left time: 1729.9307s
	iters: 400, epoch: 9 | loss: 0.1362255
	speed: 0.0396s/iter; left time: 1691.2904s
Epoch: 9 cost time: 19.084585666656494
Epoch: 9, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0522347
	speed: 0.1740s/iter; left time: 7410.5042s
	iters: 200, epoch: 10 | loss: 0.0603542
	speed: 0.0384s/iter; left time: 1629.1482s
	iters: 300, epoch: 10 | loss: 0.0034562
	speed: 0.0376s/iter; left time: 1594.9498s
	iters: 400, epoch: 10 | loss: 0.0481634
	speed: 0.0351s/iter; left time: 1484.6256s
Epoch: 10 cost time: 17.888877391815186
Epoch: 10, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3884224
	speed: 0.1680s/iter; left time: 7075.4605s
	iters: 200, epoch: 11 | loss: 0.0110111
	speed: 0.0373s/iter; left time: 1568.3421s
	iters: 300, epoch: 11 | loss: 0.0248628
	speed: 0.0368s/iter; left time: 1540.6608s
	iters: 400, epoch: 11 | loss: 0.1494956
	speed: 0.0385s/iter; left time: 1610.2180s
Epoch: 11 cost time: 17.971375226974487
Epoch: 11, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.961405 --> -0.973412).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1344447
	speed: 0.1715s/iter; left time: 7142.7569s
	iters: 200, epoch: 12 | loss: 0.0021321
	speed: 0.0361s/iter; left time: 1501.6534s
	iters: 300, epoch: 12 | loss: 0.4889559
	speed: 0.0367s/iter; left time: 1522.2767s
	iters: 400, epoch: 12 | loss: 0.0126873
	speed: 0.0376s/iter; left time: 1554.5650s
Epoch: 12 cost time: 17.67031192779541
Epoch: 12, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0104603
	speed: 0.1578s/iter; left time: 6497.5199s
	iters: 200, epoch: 13 | loss: 0.0164134
	speed: 0.0370s/iter; left time: 1521.3969s
	iters: 300, epoch: 13 | loss: 0.0122812
	speed: 0.0374s/iter; left time: 1533.2304s
	iters: 400, epoch: 13 | loss: 0.0059016
	speed: 0.0362s/iter; left time: 1479.1367s
Epoch: 13 cost time: 17.689247131347656
Epoch: 13, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0014617
	speed: 0.1660s/iter; left time: 6756.0980s
	iters: 200, epoch: 14 | loss: 0.0811809
	speed: 0.0382s/iter; left time: 1550.0981s
	iters: 300, epoch: 14 | loss: 0.0275067
	speed: 0.0376s/iter; left time: 1522.1181s
	iters: 400, epoch: 14 | loss: 0.0006185
	speed: 0.0351s/iter; left time: 1420.1944s
Epoch: 14 cost time: 17.58169960975647
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0090428
	speed: 0.1670s/iter; left time: 6717.7171s
	iters: 200, epoch: 15 | loss: 0.0019692
	speed: 0.0379s/iter; left time: 1522.8218s
	iters: 300, epoch: 15 | loss: 0.0252027
	speed: 0.0374s/iter; left time: 1496.4132s
	iters: 400, epoch: 15 | loss: 0.1376466
	speed: 0.0387s/iter; left time: 1545.5768s
Epoch: 15 cost time: 18.1423180103302
Epoch: 15, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0158505
	speed: 0.1743s/iter; left time: 6930.3270s
	iters: 200, epoch: 16 | loss: 0.0325074
	speed: 0.0397s/iter; left time: 1575.4701s
	iters: 300, epoch: 16 | loss: 0.0270070
	speed: 0.0417s/iter; left time: 1651.4096s
	iters: 400, epoch: 16 | loss: 0.0218418
	speed: 0.0405s/iter; left time: 1599.3699s
Epoch: 16 cost time: 19.212469816207886
Epoch: 16, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0035971
	speed: 0.1777s/iter; left time: 6981.5672s
	iters: 200, epoch: 17 | loss: 0.7988610
	speed: 0.0387s/iter; left time: 1516.5573s
	iters: 300, epoch: 17 | loss: 0.0101036
	speed: 0.0371s/iter; left time: 1449.4684s
	iters: 400, epoch: 17 | loss: 0.1494633
	speed: 0.0390s/iter; left time: 1521.4750s
Epoch: 17 cost time: 18.19097638130188
Epoch: 17, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0270430
	speed: 0.1754s/iter; left time: 6809.7963s
	iters: 200, epoch: 18 | loss: 0.0360680
	speed: 0.0402s/iter; left time: 1556.7344s
	iters: 300, epoch: 18 | loss: 0.1032242
	speed: 0.0417s/iter; left time: 1609.0314s
	iters: 400, epoch: 18 | loss: 0.0062499
	speed: 0.0388s/iter; left time: 1493.5469s
Epoch: 18 cost time: 19.17052388191223
Epoch: 18, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2702411
	speed: 0.1920s/iter; left time: 7364.3635s
	iters: 200, epoch: 19 | loss: 0.3673188
	speed: 0.0393s/iter; left time: 1502.2746s
	iters: 300, epoch: 19 | loss: 0.1081029
	speed: 0.0391s/iter; left time: 1493.7272s
	iters: 400, epoch: 19 | loss: 0.1176716
	speed: 0.0389s/iter; left time: 1480.3253s
Epoch: 19 cost time: 18.896700382232666
Epoch: 19, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.234 Vali Acc: 0.943 Test Loss: 0.234 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0044704
	speed: 0.1809s/iter; left time: 6855.4614s
	iters: 200, epoch: 20 | loss: 0.1085876
	speed: 0.0424s/iter; left time: 1602.7851s
	iters: 300, epoch: 20 | loss: 0.0096058
	speed: 0.0405s/iter; left time: 1528.1098s
	iters: 400, epoch: 20 | loss: 0.0167547
	speed: 0.0402s/iter; left time: 1510.2729s
Epoch: 20 cost time: 19.207838773727417
Epoch: 20, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0051946
	speed: 0.1764s/iter; left time: 6600.1287s
	iters: 200, epoch: 21 | loss: 0.0012656
	speed: 0.0391s/iter; left time: 1460.9657s
	iters: 300, epoch: 21 | loss: 0.0014379
	speed: 0.0377s/iter; left time: 1402.5086s
	iters: 400, epoch: 21 | loss: 0.0051450
	speed: 0.0365s/iter; left time: 1355.8001s
Epoch: 21 cost time: 18.073128938674927
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9734133790737565
model parameter : 2654638
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7142060
	speed: 0.0447s/iter; left time: 2093.5210s
	iters: 200, epoch: 1 | loss: 0.3618585
	speed: 0.0306s/iter; left time: 1427.2758s
	iters: 300, epoch: 1 | loss: 0.1622478
	speed: 0.0313s/iter; left time: 1456.9038s
	iters: 400, epoch: 1 | loss: 0.1579938
	speed: 0.0329s/iter; left time: 1527.9281s
Epoch: 1 cost time: 16.300439596176147
Epoch: 1, Steps: 469 | Train Loss: 0.517 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
Validation loss decreased (inf --> -0.913090).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2328083
	speed: 0.1652s/iter; left time: 7656.2933s
	iters: 200, epoch: 2 | loss: 0.1695399
	speed: 0.0389s/iter; left time: 1799.4472s
	iters: 300, epoch: 2 | loss: 0.1350145
	speed: 0.0392s/iter; left time: 1810.5722s
	iters: 400, epoch: 2 | loss: 0.1147545
	speed: 0.0376s/iter; left time: 1732.3007s
Epoch: 2 cost time: 18.786097049713135
Epoch: 2, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.380 Vali Acc: 0.869 Test Loss: 0.380 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3155090
	speed: 0.1672s/iter; left time: 7669.8682s
	iters: 200, epoch: 3 | loss: 0.3817499
	speed: 0.0380s/iter; left time: 1737.2107s
	iters: 300, epoch: 3 | loss: 0.2317627
	speed: 0.0376s/iter; left time: 1719.0611s
	iters: 400, epoch: 3 | loss: 0.0140631
	speed: 0.0409s/iter; left time: 1864.0693s
Epoch: 3 cost time: 18.49239206314087
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
Validation loss decreased (-0.913090 --> -0.954829).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2479854
	speed: 0.1669s/iter; left time: 7578.4356s
	iters: 200, epoch: 4 | loss: 0.0377648
	speed: 0.0391s/iter; left time: 1770.7770s
	iters: 300, epoch: 4 | loss: 0.1624216
	speed: 0.0384s/iter; left time: 1733.5827s
	iters: 400, epoch: 4 | loss: 0.0688668
	speed: 0.0397s/iter; left time: 1788.8838s
Epoch: 4 cost time: 18.330756902694702
Epoch: 4, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.481 Vali Acc: 0.907 Test Loss: 0.481 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0025958
	speed: 0.1635s/iter; left time: 7347.1181s
	iters: 200, epoch: 5 | loss: 0.0841084
	speed: 0.0372s/iter; left time: 1669.4810s
	iters: 300, epoch: 5 | loss: 0.1894202
	speed: 0.0377s/iter; left time: 1684.7515s
	iters: 400, epoch: 5 | loss: 0.0084355
	speed: 0.0390s/iter; left time: 1740.6401s
Epoch: 5 cost time: 18.253139972686768
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.344 Vali Acc: 0.918 Test Loss: 0.344 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0250670
	speed: 0.1676s/iter; left time: 7450.5211s
	iters: 200, epoch: 6 | loss: 0.1793387
	speed: 0.0370s/iter; left time: 1642.5521s
	iters: 300, epoch: 6 | loss: 0.0190417
	speed: 0.0373s/iter; left time: 1652.4330s
	iters: 400, epoch: 6 | loss: 0.1366214
	speed: 0.0363s/iter; left time: 1602.4510s
Epoch: 6 cost time: 17.690375566482544
Epoch: 6, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0082840
	speed: 0.1775s/iter; left time: 7806.6209s
	iters: 200, epoch: 7 | loss: 0.0203995
	speed: 0.0381s/iter; left time: 1671.2257s
	iters: 300, epoch: 7 | loss: 0.1851694
	speed: 0.0412s/iter; left time: 1804.0475s
	iters: 400, epoch: 7 | loss: 0.0402882
	speed: 0.0407s/iter; left time: 1777.4653s
Epoch: 7 cost time: 19.237836837768555
Epoch: 7, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.954829 --> -0.962549).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6057442
	speed: 0.1874s/iter; left time: 8153.7323s
	iters: 200, epoch: 8 | loss: 0.0354369
	speed: 0.0415s/iter; left time: 1801.8699s
	iters: 300, epoch: 8 | loss: 0.0390163
	speed: 0.0400s/iter; left time: 1732.4511s
	iters: 400, epoch: 8 | loss: 0.3025271
	speed: 0.0379s/iter; left time: 1637.0302s
Epoch: 8 cost time: 19.069964170455933
Epoch: 8, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0210943
	speed: 0.1894s/iter; left time: 8153.4725s
	iters: 200, epoch: 9 | loss: 0.0036270
	speed: 0.0405s/iter; left time: 1739.9618s
	iters: 300, epoch: 9 | loss: 0.0084895
	speed: 0.0401s/iter; left time: 1716.2483s
	iters: 400, epoch: 9 | loss: 0.1717361
	speed: 0.0393s/iter; left time: 1678.8970s
Epoch: 9 cost time: 19.055233001708984
Epoch: 9, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0210101
	speed: 0.1815s/iter; left time: 7726.8399s
	iters: 200, epoch: 10 | loss: 0.0080388
	speed: 0.0386s/iter; left time: 1640.6842s
	iters: 300, epoch: 10 | loss: 0.0114429
	speed: 0.0364s/iter; left time: 1542.4301s
	iters: 400, epoch: 10 | loss: 0.0016467
	speed: 0.0392s/iter; left time: 1659.0621s
Epoch: 10 cost time: 18.335439205169678
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0082102
	speed: 0.1738s/iter; left time: 7318.3030s
	iters: 200, epoch: 11 | loss: 0.4921790
	speed: 0.0401s/iter; left time: 1686.5570s
	iters: 300, epoch: 11 | loss: 0.2638113
	speed: 0.0397s/iter; left time: 1663.5027s
	iters: 400, epoch: 11 | loss: 0.1464134
	speed: 0.0386s/iter; left time: 1615.8302s
Epoch: 11 cost time: 18.871395587921143
Epoch: 11, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0681178
	speed: 0.1724s/iter; left time: 7177.2039s
	iters: 200, epoch: 12 | loss: 0.0248350
	speed: 0.0383s/iter; left time: 1590.7745s
	iters: 300, epoch: 12 | loss: 0.3722216
	speed: 0.0381s/iter; left time: 1577.0130s
	iters: 400, epoch: 12 | loss: 0.0102349
	speed: 0.0393s/iter; left time: 1623.0355s
Epoch: 12 cost time: 18.474113702774048
Epoch: 12, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0255576
	speed: 0.1709s/iter; left time: 7035.0919s
	iters: 200, epoch: 13 | loss: 0.0183237
	speed: 0.0378s/iter; left time: 1552.9776s
	iters: 300, epoch: 13 | loss: 0.0034251
	speed: 0.0386s/iter; left time: 1581.3553s
	iters: 400, epoch: 13 | loss: 0.0568540
	speed: 0.0389s/iter; left time: 1589.8833s
Epoch: 13 cost time: 18.230626106262207
Epoch: 13, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.962549 --> -0.966265).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0915973
	speed: 0.1743s/iter; left time: 7093.2374s
	iters: 200, epoch: 14 | loss: 0.0042827
	speed: 0.0384s/iter; left time: 1560.9311s
	iters: 300, epoch: 14 | loss: 0.1492793
	speed: 0.0395s/iter; left time: 1598.3751s
	iters: 400, epoch: 14 | loss: 0.0024963
	speed: 0.0383s/iter; left time: 1547.4003s
Epoch: 14 cost time: 18.53245997428894
Epoch: 14, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0017870
	speed: 0.1661s/iter; left time: 6683.3304s
	iters: 200, epoch: 15 | loss: 0.0183997
	speed: 0.0417s/iter; left time: 1674.1916s
	iters: 300, epoch: 15 | loss: 0.0498305
	speed: 0.0397s/iter; left time: 1587.4843s
	iters: 400, epoch: 15 | loss: 0.0469787
	speed: 0.0398s/iter; left time: 1591.4039s
Epoch: 15 cost time: 19.23627519607544
Epoch: 15, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0044573
	speed: 0.1805s/iter; left time: 7176.6768s
	iters: 200, epoch: 16 | loss: 0.0422001
	speed: 0.0390s/iter; left time: 1548.0214s
	iters: 300, epoch: 16 | loss: 0.0021666
	speed: 0.0401s/iter; left time: 1585.5434s
	iters: 400, epoch: 16 | loss: 0.0052288
	speed: 0.0390s/iter; left time: 1538.7022s
Epoch: 16 cost time: 18.85472345352173
Epoch: 16, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0672320
	speed: 0.1721s/iter; left time: 6762.2569s
	iters: 200, epoch: 17 | loss: 0.0050906
	speed: 0.0374s/iter; left time: 1466.4576s
	iters: 300, epoch: 17 | loss: 0.0010533
	speed: 0.0411s/iter; left time: 1605.2729s
	iters: 400, epoch: 17 | loss: 0.0466171
	speed: 0.0403s/iter; left time: 1572.3254s
Epoch: 17 cost time: 18.75816249847412
Epoch: 17, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.966551).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0123501
	speed: 0.1778s/iter; left time: 6902.7126s
	iters: 200, epoch: 18 | loss: 0.2455768
	speed: 0.0409s/iter; left time: 1585.0797s
	iters: 300, epoch: 18 | loss: 0.1268208
	speed: 0.0421s/iter; left time: 1627.6169s
	iters: 400, epoch: 18 | loss: 0.0021342
	speed: 0.0405s/iter; left time: 1562.0445s
Epoch: 18 cost time: 19.626453638076782
Epoch: 18, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0092135
	speed: 0.1856s/iter; left time: 7120.1071s
	iters: 200, epoch: 19 | loss: 0.0007830
	speed: 0.0398s/iter; left time: 1522.5025s
	iters: 300, epoch: 19 | loss: 0.3410588
	speed: 0.0406s/iter; left time: 1548.9266s
	iters: 400, epoch: 19 | loss: 0.0470141
	speed: 0.0396s/iter; left time: 1507.9213s
Epoch: 19 cost time: 19.26897168159485
Epoch: 19, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.230 Vali Acc: 0.940 Test Loss: 0.230 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0023813
	speed: 0.1901s/iter; left time: 7204.0533s
	iters: 200, epoch: 20 | loss: 0.0012716
	speed: 0.0405s/iter; left time: 1531.5700s
	iters: 300, epoch: 20 | loss: 0.0079687
	speed: 0.0410s/iter; left time: 1545.6693s
	iters: 400, epoch: 20 | loss: 0.0314808
	speed: 0.0417s/iter; left time: 1568.7567s
Epoch: 20 cost time: 19.383755207061768
Epoch: 20, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0024155
	speed: 0.1773s/iter; left time: 6634.2690s
	iters: 200, epoch: 21 | loss: 0.2473338
	speed: 0.0411s/iter; left time: 1533.3657s
	iters: 300, epoch: 21 | loss: 0.0266420
	speed: 0.0391s/iter; left time: 1454.4855s
	iters: 400, epoch: 21 | loss: 0.0118518
	speed: 0.0378s/iter; left time: 1404.4528s
Epoch: 21 cost time: 18.665399074554443
Epoch: 21, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0306317
	speed: 0.1665s/iter; left time: 6153.7606s
	iters: 200, epoch: 22 | loss: 0.0349083
	speed: 0.0392s/iter; left time: 1443.3532s
	iters: 300, epoch: 22 | loss: 0.0752464
	speed: 0.0384s/iter; left time: 1411.2422s
	iters: 400, epoch: 22 | loss: 0.0021872
	speed: 0.0369s/iter; left time: 1351.0351s
Epoch: 22 cost time: 18.267776489257812
Epoch: 22, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0009975
	speed: 0.1680s/iter; left time: 6130.4361s
	iters: 200, epoch: 23 | loss: 0.2284643
	speed: 0.0383s/iter; left time: 1392.9306s
	iters: 300, epoch: 23 | loss: 0.0591915
	speed: 0.0349s/iter; left time: 1264.8075s
	iters: 400, epoch: 23 | loss: 0.0226420
	speed: 0.0394s/iter; left time: 1427.0370s
Epoch: 23 cost time: 18.42410135269165
Epoch: 23, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0023570
	speed: 0.1686s/iter; left time: 6071.5108s
	iters: 200, epoch: 24 | loss: 0.1027476
	speed: 0.0375s/iter; left time: 1346.8874s
	iters: 300, epoch: 24 | loss: 0.0166361
	speed: 0.0376s/iter; left time: 1345.8966s
	iters: 400, epoch: 24 | loss: 0.0115484
	speed: 0.0395s/iter; left time: 1410.6230s
Epoch: 24 cost time: 18.247045755386353
Epoch: 24, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0194965
	speed: 0.1677s/iter; left time: 5960.1691s
	iters: 200, epoch: 25 | loss: 0.0279456
	speed: 0.0391s/iter; left time: 1386.6080s
	iters: 300, epoch: 25 | loss: 0.1037541
	speed: 0.0378s/iter; left time: 1335.1248s
	iters: 400, epoch: 25 | loss: 0.0026624
	speed: 0.0376s/iter; left time: 1325.6411s
Epoch: 25 cost time: 18.340226650238037
Epoch: 25, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0039452
	speed: 0.1735s/iter; left time: 6085.1594s
	iters: 200, epoch: 26 | loss: 0.4417180
	speed: 0.0383s/iter; left time: 1340.8430s
	iters: 300, epoch: 26 | loss: 0.1142427
	speed: 0.0391s/iter; left time: 1365.1100s
	iters: 400, epoch: 26 | loss: 0.0145547
	speed: 0.0385s/iter; left time: 1337.6659s
Epoch: 26 cost time: 18.317404747009277
Epoch: 26, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0052621
	speed: 0.1693s/iter; left time: 5859.6905s
	iters: 200, epoch: 27 | loss: 0.0031323
	speed: 0.0375s/iter; left time: 1294.6541s
	iters: 300, epoch: 27 | loss: 0.0450019
	speed: 0.0410s/iter; left time: 1411.3549s
	iters: 400, epoch: 27 | loss: 0.0307393
	speed: 0.0390s/iter; left time: 1337.8727s
Epoch: 27 cost time: 18.743606090545654
Epoch: 27, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.212 Vali Acc: 0.955 Test Loss: 0.212 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9665523156089194
model parameter : 1997486
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5637565
	speed: 0.0525s/iter; left time: 2458.2738s
	iters: 200, epoch: 1 | loss: 0.4938846
	speed: 0.0403s/iter; left time: 1881.2106s
	iters: 300, epoch: 1 | loss: 0.1201248
	speed: 0.0403s/iter; left time: 1877.3351s
	iters: 400, epoch: 1 | loss: 0.0438595
	speed: 0.0395s/iter; left time: 1837.9499s
Epoch: 1 cost time: 20.00035071372986
Epoch: 1, Steps: 469 | Train Loss: 0.508 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
Validation loss decreased (inf --> -0.915377).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1099855
	speed: 0.1839s/iter; left time: 8520.2667s
	iters: 200, epoch: 2 | loss: 0.1129388
	speed: 0.0424s/iter; left time: 1959.0146s
	iters: 300, epoch: 2 | loss: 0.0709538
	speed: 0.0413s/iter; left time: 1903.6849s
	iters: 400, epoch: 2 | loss: 0.0629934
	speed: 0.0408s/iter; left time: 1879.8823s
Epoch: 2 cost time: 19.76756978034973
Epoch: 2, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.258 Vali Acc: 0.912 Test Loss: 0.258 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0329936
	speed: 0.1899s/iter; left time: 8709.7660s
	iters: 200, epoch: 3 | loss: 0.0628873
	speed: 0.0398s/iter; left time: 1820.8891s
	iters: 300, epoch: 3 | loss: 0.0501564
	speed: 0.0409s/iter; left time: 1867.1537s
	iters: 400, epoch: 3 | loss: 0.2044168
	speed: 0.0377s/iter; left time: 1718.9357s
Epoch: 3 cost time: 18.994724988937378
Epoch: 3, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.915377 --> -0.945682).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0982799
	speed: 0.1537s/iter; left time: 6975.3295s
	iters: 200, epoch: 4 | loss: 0.3406909
	speed: 0.0365s/iter; left time: 1655.3355s
	iters: 300, epoch: 4 | loss: 0.0253433
	speed: 0.0374s/iter; left time: 1690.6554s
	iters: 400, epoch: 4 | loss: 0.0100622
	speed: 0.0393s/iter; left time: 1772.0107s
Epoch: 4 cost time: 17.948096752166748
Epoch: 4, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0597157
	speed: 0.1653s/iter; left time: 7424.0644s
	iters: 200, epoch: 5 | loss: 0.0144106
	speed: 0.0397s/iter; left time: 1778.0181s
	iters: 300, epoch: 5 | loss: 0.0800157
	speed: 0.0382s/iter; left time: 1706.6902s
	iters: 400, epoch: 5 | loss: 0.1444099
	speed: 0.0378s/iter; left time: 1688.3256s
Epoch: 5 cost time: 18.28795289993286
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.945682 --> -0.950541).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1298236
	speed: 0.1735s/iter; left time: 7713.6575s
	iters: 200, epoch: 6 | loss: 0.1158807
	speed: 0.0368s/iter; left time: 1632.4662s
	iters: 300, epoch: 6 | loss: 0.0145977
	speed: 0.0387s/iter; left time: 1711.6495s
	iters: 400, epoch: 6 | loss: 0.4550396
	speed: 0.0385s/iter; left time: 1698.1104s
Epoch: 6 cost time: 18.204641580581665
Epoch: 6, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.220 Vali Acc: 0.934 Test Loss: 0.220 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0059536
	speed: 0.1687s/iter; left time: 7420.2031s
	iters: 200, epoch: 7 | loss: 0.3415954
	speed: 0.0363s/iter; left time: 1592.5298s
	iters: 300, epoch: 7 | loss: 0.0223719
	speed: 0.0374s/iter; left time: 1636.9339s
	iters: 400, epoch: 7 | loss: 0.1591672
	speed: 0.0367s/iter; left time: 1605.1886s
Epoch: 7 cost time: 17.812336206436157
Epoch: 7, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0044926
	speed: 0.1668s/iter; left time: 7259.7758s
	iters: 200, epoch: 8 | loss: 0.0062727
	speed: 0.0372s/iter; left time: 1616.4946s
	iters: 300, epoch: 8 | loss: 0.0113691
	speed: 0.0373s/iter; left time: 1616.4826s
	iters: 400, epoch: 8 | loss: 0.0705663
	speed: 0.0378s/iter; left time: 1634.6280s
Epoch: 8 cost time: 17.764240741729736
Epoch: 8, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.227 Vali Acc: 0.934 Test Loss: 0.227 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1710634
	speed: 0.1693s/iter; left time: 7287.3644s
	iters: 200, epoch: 9 | loss: 0.0232714
	speed: 0.0374s/iter; left time: 1608.2554s
	iters: 300, epoch: 9 | loss: 0.0044260
	speed: 0.0376s/iter; left time: 1610.1151s
	iters: 400, epoch: 9 | loss: 0.0780524
	speed: 0.0371s/iter; left time: 1584.9936s
Epoch: 9 cost time: 18.194941997528076
Epoch: 9, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.227 Vali Acc: 0.939 Test Loss: 0.227 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0014869
	speed: 0.1662s/iter; left time: 7077.6992s
	iters: 200, epoch: 10 | loss: 0.6976752
	speed: 0.0379s/iter; left time: 1607.9750s
	iters: 300, epoch: 10 | loss: 0.0168451
	speed: 0.0383s/iter; left time: 1624.2693s
	iters: 400, epoch: 10 | loss: 0.1862520
	speed: 0.0378s/iter; left time: 1598.9188s
Epoch: 10 cost time: 17.951520442962646
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3843268
	speed: 0.1682s/iter; left time: 7082.9076s
	iters: 200, epoch: 11 | loss: 0.0092694
	speed: 0.0379s/iter; left time: 1593.1731s
	iters: 300, epoch: 11 | loss: 0.0130404
	speed: 0.0379s/iter; left time: 1588.2110s
	iters: 400, epoch: 11 | loss: 0.3416811
	speed: 0.0383s/iter; left time: 1600.4231s
Epoch: 11 cost time: 18.05001997947693
Epoch: 11, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.950541 --> -0.957117).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0062821
	speed: 0.1680s/iter; left time: 6996.6745s
	iters: 200, epoch: 12 | loss: 0.0768528
	speed: 0.0404s/iter; left time: 1676.9714s
	iters: 300, epoch: 12 | loss: 0.0159241
	speed: 0.0419s/iter; left time: 1736.3425s
	iters: 400, epoch: 12 | loss: 0.1164850
	speed: 0.0392s/iter; left time: 1619.1150s
Epoch: 12 cost time: 19.06267023086548
Epoch: 12, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0516167
	speed: 0.1862s/iter; left time: 7665.0302s
	iters: 200, epoch: 13 | loss: 0.0266648
	speed: 0.0397s/iter; left time: 1629.9875s
	iters: 300, epoch: 13 | loss: 0.0189071
	speed: 0.0389s/iter; left time: 1591.9166s
	iters: 400, epoch: 13 | loss: 0.0552703
	speed: 0.0402s/iter; left time: 1641.6094s
Epoch: 13 cost time: 18.92485475540161
Epoch: 13, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1847603
	speed: 0.1925s/iter; left time: 7836.3240s
	iters: 200, epoch: 14 | loss: 0.0012125
	speed: 0.0415s/iter; left time: 1685.5303s
	iters: 300, epoch: 14 | loss: 0.0715519
	speed: 0.0418s/iter; left time: 1693.2839s
	iters: 400, epoch: 14 | loss: 0.0203119
	speed: 0.0404s/iter; left time: 1632.2783s
Epoch: 14 cost time: 19.608468294143677
Epoch: 14, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
Validation loss decreased (-0.957117 --> -0.962834).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0057373
	speed: 0.1940s/iter; left time: 7806.1622s
	iters: 200, epoch: 15 | loss: 0.0766084
	speed: 0.0420s/iter; left time: 1686.4575s
	iters: 300, epoch: 15 | loss: 0.0282522
	speed: 0.0409s/iter; left time: 1635.9362s
	iters: 400, epoch: 15 | loss: 0.4064308
	speed: 0.0410s/iter; left time: 1638.0543s
Epoch: 15 cost time: 19.854374885559082
Epoch: 15, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2439812
	speed: 0.1788s/iter; left time: 7110.7088s
	iters: 200, epoch: 16 | loss: 0.0031117
	speed: 0.0387s/iter; left time: 1536.4876s
	iters: 300, epoch: 16 | loss: 0.0372276
	speed: 0.0405s/iter; left time: 1602.4216s
	iters: 400, epoch: 16 | loss: 0.0033287
	speed: 0.0400s/iter; left time: 1579.3447s
Epoch: 16 cost time: 19.03100848197937
Epoch: 16, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.962834 --> -0.972841).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0307575
	speed: 0.1719s/iter; left time: 6754.5734s
	iters: 200, epoch: 17 | loss: 0.0162448
	speed: 0.0369s/iter; left time: 1446.5949s
	iters: 300, epoch: 17 | loss: 0.0171333
	speed: 0.0325s/iter; left time: 1268.9595s
	iters: 400, epoch: 17 | loss: 0.0020953
	speed: 0.0333s/iter; left time: 1297.9954s
Epoch: 17 cost time: 16.640380382537842
Epoch: 17, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.972841 --> -0.976843).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0032554
	speed: 0.1384s/iter; left time: 5372.5942s
	iters: 200, epoch: 18 | loss: 0.2330964
	speed: 0.0386s/iter; left time: 1495.1639s
	iters: 300, epoch: 18 | loss: 0.0009988
	speed: 0.0381s/iter; left time: 1471.8064s
	iters: 400, epoch: 18 | loss: 0.0730715
	speed: 0.0388s/iter; left time: 1493.4728s
Epoch: 18 cost time: 18.3857102394104
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0157884
	speed: 0.1755s/iter; left time: 6732.0629s
	iters: 200, epoch: 19 | loss: 0.0180606
	speed: 0.0391s/iter; left time: 1496.2670s
	iters: 300, epoch: 19 | loss: 0.0301375
	speed: 0.0385s/iter; left time: 1470.9213s
	iters: 400, epoch: 19 | loss: 0.0247585
	speed: 0.0380s/iter; left time: 1444.8472s
Epoch: 19 cost time: 18.363866329193115
Epoch: 19, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2063002
	speed: 0.1709s/iter; left time: 6473.7909s
	iters: 200, epoch: 20 | loss: 0.0049835
	speed: 0.0403s/iter; left time: 1521.2833s
	iters: 300, epoch: 20 | loss: 0.0043354
	speed: 0.0393s/iter; left time: 1481.5492s
	iters: 400, epoch: 20 | loss: 0.0823024
	speed: 0.0351s/iter; left time: 1318.8818s
Epoch: 20 cost time: 18.545217990875244
Epoch: 20, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0663529
	speed: 0.1806s/iter; left time: 6757.0060s
	iters: 200, epoch: 21 | loss: 0.0117618
	speed: 0.0381s/iter; left time: 1420.5247s
	iters: 300, epoch: 21 | loss: 0.0012646
	speed: 0.0394s/iter; left time: 1467.9449s
	iters: 400, epoch: 21 | loss: 0.0037664
	speed: 0.0384s/iter; left time: 1427.2115s
Epoch: 21 cost time: 18.487632989883423
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0194497
	speed: 0.1715s/iter; left time: 6337.7558s
	iters: 200, epoch: 22 | loss: 0.0039170
	speed: 0.0409s/iter; left time: 1507.2507s
	iters: 300, epoch: 22 | loss: 0.0048780
	speed: 0.0392s/iter; left time: 1442.1245s
	iters: 400, epoch: 22 | loss: 0.2697966
	speed: 0.0421s/iter; left time: 1543.5714s
Epoch: 22 cost time: 19.40385389328003
Epoch: 22, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0074333
	speed: 0.1865s/iter; left time: 6804.0672s
	iters: 200, epoch: 23 | loss: 0.0033840
	speed: 0.0411s/iter; left time: 1494.1455s
	iters: 300, epoch: 23 | loss: 0.0374165
	speed: 0.0430s/iter; left time: 1560.7121s
	iters: 400, epoch: 23 | loss: 0.0050611
	speed: 0.0453s/iter; left time: 1637.6637s
Epoch: 23 cost time: 20.10749650001526
Epoch: 23, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0235789
	speed: 0.2037s/iter; left time: 7334.3140s
	iters: 200, epoch: 24 | loss: 0.0014436
	speed: 0.0408s/iter; left time: 1463.7249s
	iters: 300, epoch: 24 | loss: 0.0450400
	speed: 0.0433s/iter; left time: 1549.7623s
	iters: 400, epoch: 24 | loss: 0.0030866
	speed: 0.0421s/iter; left time: 1502.1534s
Epoch: 24 cost time: 20.03978657722473
Epoch: 24, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1690879
	speed: 0.1829s/iter; left time: 6499.9197s
	iters: 200, epoch: 25 | loss: 0.0023675
	speed: 0.0404s/iter; left time: 1432.0441s
	iters: 300, epoch: 25 | loss: 0.0412712
	speed: 0.0396s/iter; left time: 1399.9359s
	iters: 400, epoch: 25 | loss: 0.2372402
	speed: 0.0391s/iter; left time: 1379.7483s
Epoch: 25 cost time: 19.122027158737183
Epoch: 25, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0018783
	speed: 0.1781s/iter; left time: 6246.4378s
	iters: 200, epoch: 26 | loss: 0.0029244
	speed: 0.0378s/iter; left time: 1322.4812s
	iters: 300, epoch: 26 | loss: 0.0010133
	speed: 0.0403s/iter; left time: 1404.4824s
	iters: 400, epoch: 26 | loss: 0.0006619
	speed: 0.0398s/iter; left time: 1384.5475s
Epoch: 26 cost time: 18.627421140670776
Epoch: 26, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0009686
	speed: 0.1645s/iter; left time: 5691.8378s
	iters: 200, epoch: 27 | loss: 0.0069136
	speed: 0.0369s/iter; left time: 1274.3764s
	iters: 300, epoch: 27 | loss: 0.0004485
	speed: 0.0368s/iter; left time: 1267.5593s
	iters: 400, epoch: 27 | loss: 0.0026366
	speed: 0.0401s/iter; left time: 1374.1260s
Epoch: 27 cost time: 18.57336711883545
Epoch: 27, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 1997230
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5980666
	speed: 0.0530s/iter; left time: 2481.0271s
	iters: 200, epoch: 1 | loss: 0.2404334
	speed: 0.0375s/iter; left time: 1750.4720s
	iters: 300, epoch: 1 | loss: 0.3656460
	speed: 0.0387s/iter; left time: 1801.3346s
	iters: 400, epoch: 1 | loss: 0.0915738
	speed: 0.0387s/iter; left time: 1797.6987s
Epoch: 1 cost time: 19.544418811798096
Epoch: 1, Steps: 469 | Train Loss: 0.522 Vali Loss: 0.248 Vali Acc: 0.918 Test Loss: 0.248 Test Acc: 0.918
Validation loss decreased (inf --> -0.917665).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0790665
	speed: 0.1700s/iter; left time: 7876.2321s
	iters: 200, epoch: 2 | loss: 0.0417701
	speed: 0.0388s/iter; left time: 1793.8259s
	iters: 300, epoch: 2 | loss: 0.0834776
	speed: 0.0372s/iter; left time: 1716.3611s
	iters: 400, epoch: 2 | loss: 0.3298213
	speed: 0.0365s/iter; left time: 1679.6444s
Epoch: 2 cost time: 17.85369610786438
Epoch: 2, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.917665 --> -0.949398).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0312954
	speed: 0.1753s/iter; left time: 8037.6199s
	iters: 200, epoch: 3 | loss: 0.0640995
	speed: 0.0391s/iter; left time: 1789.2300s
	iters: 300, epoch: 3 | loss: 0.2508064
	speed: 0.0412s/iter; left time: 1879.3866s
	iters: 400, epoch: 3 | loss: 0.0168834
	speed: 0.0411s/iter; left time: 1874.3934s
Epoch: 3 cost time: 18.78682231903076
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0429727
	speed: 0.1642s/iter; left time: 7454.2897s
	iters: 200, epoch: 4 | loss: 0.1212556
	speed: 0.0377s/iter; left time: 1707.5228s
	iters: 300, epoch: 4 | loss: 0.0332282
	speed: 0.0373s/iter; left time: 1684.6044s
	iters: 400, epoch: 4 | loss: 0.1116107
	speed: 0.0374s/iter; left time: 1688.6504s
Epoch: 4 cost time: 18.373546600341797
Epoch: 4, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.949398 --> -0.957689).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0094817
	speed: 0.1919s/iter; left time: 8619.9075s
	iters: 200, epoch: 5 | loss: 0.0394439
	speed: 0.0425s/iter; left time: 1906.7200s
	iters: 300, epoch: 5 | loss: 0.0752454
	speed: 0.0410s/iter; left time: 1834.9729s
	iters: 400, epoch: 5 | loss: 0.5018638
	speed: 0.0405s/iter; left time: 1807.8518s
Epoch: 5 cost time: 19.3665452003479
Epoch: 5, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3612772
	speed: 0.1797s/iter; left time: 7986.5686s
	iters: 200, epoch: 6 | loss: 0.0223387
	speed: 0.0423s/iter; left time: 1875.0385s
	iters: 300, epoch: 6 | loss: 0.0049558
	speed: 0.0403s/iter; left time: 1783.2551s
	iters: 400, epoch: 6 | loss: 0.0073139
	speed: 0.0385s/iter; left time: 1698.0847s
Epoch: 6 cost time: 19.267900466918945
Epoch: 6, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1521816
	speed: 0.1861s/iter; left time: 8185.2440s
	iters: 200, epoch: 7 | loss: 0.0395296
	speed: 0.0394s/iter; left time: 1729.7332s
	iters: 300, epoch: 7 | loss: 0.2599963
	speed: 0.0398s/iter; left time: 1743.6970s
	iters: 400, epoch: 7 | loss: 0.0344336
	speed: 0.0406s/iter; left time: 1771.8451s
Epoch: 7 cost time: 18.880193948745728
Epoch: 7, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0383055
	speed: 0.1644s/iter; left time: 7153.1133s
	iters: 200, epoch: 8 | loss: 0.0038882
	speed: 0.0375s/iter; left time: 1629.7343s
	iters: 300, epoch: 8 | loss: 0.0049136
	speed: 0.0372s/iter; left time: 1611.5554s
	iters: 400, epoch: 8 | loss: 0.2805533
	speed: 0.0385s/iter; left time: 1662.3202s
Epoch: 8 cost time: 18.271751403808594
Epoch: 8, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0430752
	speed: 0.1776s/iter; left time: 7646.3757s
	iters: 200, epoch: 9 | loss: 0.0436235
	speed: 0.0371s/iter; left time: 1591.4512s
	iters: 300, epoch: 9 | loss: 0.0432083
	speed: 0.0407s/iter; left time: 1744.6156s
	iters: 400, epoch: 9 | loss: 0.0978265
	speed: 0.0420s/iter; left time: 1796.1797s
Epoch: 9 cost time: 19.09453821182251
Epoch: 9, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.368 Vali Acc: 0.914 Test Loss: 0.368 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0036256
	speed: 0.1715s/iter; left time: 7300.9679s
	iters: 200, epoch: 10 | loss: 0.0113620
	speed: 0.0388s/iter; left time: 1648.6011s
	iters: 300, epoch: 10 | loss: 0.3929548
	speed: 0.0386s/iter; left time: 1634.8042s
	iters: 400, epoch: 10 | loss: 0.0081912
	speed: 0.0369s/iter; left time: 1562.2191s
Epoch: 10 cost time: 18.426465272903442
Epoch: 10, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.957689 --> -0.958546).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2429421
	speed: 0.1677s/iter; left time: 7062.1907s
	iters: 200, epoch: 11 | loss: 0.0787890
	speed: 0.0391s/iter; left time: 1644.7128s
	iters: 300, epoch: 11 | loss: 0.0619612
	speed: 0.0385s/iter; left time: 1614.8195s
	iters: 400, epoch: 11 | loss: 0.0156407
	speed: 0.0378s/iter; left time: 1581.4637s
Epoch: 11 cost time: 18.372645378112793
Epoch: 11, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.212 Vali Acc: 0.946 Test Loss: 0.212 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0014248
	speed: 0.1677s/iter; left time: 6984.8151s
	iters: 200, epoch: 12 | loss: 0.3358087
	speed: 0.0384s/iter; left time: 1593.6207s
	iters: 300, epoch: 12 | loss: 0.2550730
	speed: 0.0370s/iter; left time: 1535.1349s
	iters: 400, epoch: 12 | loss: 0.0999460
	speed: 0.0378s/iter; left time: 1561.4261s
Epoch: 12 cost time: 18.43958568572998
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (-0.958546 --> -0.963406).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0065831
	speed: 0.1698s/iter; left time: 6989.7407s
	iters: 200, epoch: 13 | loss: 0.0338910
	speed: 0.0362s/iter; left time: 1487.7813s
	iters: 300, epoch: 13 | loss: 0.2089448
	speed: 0.0399s/iter; left time: 1635.2832s
	iters: 400, epoch: 13 | loss: 0.0106520
	speed: 0.0401s/iter; left time: 1640.9545s
Epoch: 13 cost time: 18.343600034713745
Epoch: 13, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.963406 --> -0.969696).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0084694
	speed: 0.1708s/iter; left time: 6950.6280s
	iters: 200, epoch: 14 | loss: 0.3464304
	speed: 0.0378s/iter; left time: 1533.8787s
	iters: 300, epoch: 14 | loss: 0.6397653
	speed: 0.0377s/iter; left time: 1527.2593s
	iters: 400, epoch: 14 | loss: 0.1728774
	speed: 0.0376s/iter; left time: 1518.7057s
Epoch: 14 cost time: 18.10576319694519
Epoch: 14, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3586447
	speed: 0.1678s/iter; left time: 6752.2119s
	iters: 200, epoch: 15 | loss: 0.0642204
	speed: 0.0403s/iter; left time: 1616.8109s
	iters: 300, epoch: 15 | loss: 0.0804894
	speed: 0.0408s/iter; left time: 1632.7479s
	iters: 400, epoch: 15 | loss: 0.0056825
	speed: 0.0412s/iter; left time: 1647.1634s
Epoch: 15 cost time: 19.35257387161255
Epoch: 15, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0114798
	speed: 0.1898s/iter; left time: 7545.7988s
	iters: 200, epoch: 16 | loss: 0.0027756
	speed: 0.0406s/iter; left time: 1608.6506s
	iters: 300, epoch: 16 | loss: 0.0285567
	speed: 0.0414s/iter; left time: 1637.7041s
	iters: 400, epoch: 16 | loss: 0.0103891
	speed: 0.0419s/iter; left time: 1651.8413s
Epoch: 16 cost time: 19.93474578857422
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0113389
	speed: 0.1865s/iter; left time: 7328.1920s
	iters: 200, epoch: 17 | loss: 0.3007607
	speed: 0.0398s/iter; left time: 1559.6428s
	iters: 300, epoch: 17 | loss: 0.0055284
	speed: 0.0325s/iter; left time: 1270.2256s
	iters: 400, epoch: 17 | loss: 0.0162455
	speed: 0.0321s/iter; left time: 1251.2460s
Epoch: 17 cost time: 17.116758346557617
Epoch: 17, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0116764
	speed: 0.1215s/iter; left time: 4717.0298s
	iters: 200, epoch: 18 | loss: 0.0435471
	speed: 0.0376s/iter; left time: 1454.8500s
	iters: 300, epoch: 18 | loss: 0.0507403
	speed: 0.0392s/iter; left time: 1515.4840s
	iters: 400, epoch: 18 | loss: 0.0145590
	speed: 0.0391s/iter; left time: 1505.8724s
Epoch: 18 cost time: 17.772526025772095
Epoch: 18, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0012997
	speed: 0.1739s/iter; left time: 6671.3353s
	iters: 200, epoch: 19 | loss: 0.0154127
	speed: 0.0383s/iter; left time: 1467.0311s
	iters: 300, epoch: 19 | loss: 0.0062800
	speed: 0.0387s/iter; left time: 1475.8528s
	iters: 400, epoch: 19 | loss: 0.0014087
	speed: 0.0398s/iter; left time: 1516.3998s
Epoch: 19 cost time: 18.55661654472351
Epoch: 19, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0058623
	speed: 0.1692s/iter; left time: 6410.3254s
	iters: 200, epoch: 20 | loss: 0.0035488
	speed: 0.0404s/iter; left time: 1525.0337s
	iters: 300, epoch: 20 | loss: 0.0020871
	speed: 0.0384s/iter; left time: 1447.1936s
	iters: 400, epoch: 20 | loss: 0.0169263
	speed: 0.0375s/iter; left time: 1408.7394s
Epoch: 20 cost time: 18.48862648010254
Epoch: 20, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0191530
	speed: 0.1792s/iter; left time: 6706.2966s
	iters: 200, epoch: 21 | loss: 0.0026998
	speed: 0.0361s/iter; left time: 1348.2133s
	iters: 300, epoch: 21 | loss: 0.0199165
	speed: 0.0377s/iter; left time: 1404.7635s
	iters: 400, epoch: 21 | loss: 0.2120818
	speed: 0.0389s/iter; left time: 1444.8830s
Epoch: 21 cost time: 18.332830667495728
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0065557
	speed: 0.1730s/iter; left time: 6391.8085s
	iters: 200, epoch: 22 | loss: 0.0035966
	speed: 0.0380s/iter; left time: 1399.0045s
	iters: 300, epoch: 22 | loss: 0.0379921
	speed: 0.0371s/iter; left time: 1363.7965s
	iters: 400, epoch: 22 | loss: 0.0180594
	speed: 0.0370s/iter; left time: 1354.9579s
Epoch: 22 cost time: 17.989310264587402
Epoch: 22, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0025091
	speed: 0.1722s/iter; left time: 6282.3023s
	iters: 200, epoch: 23 | loss: 0.0831577
	speed: 0.0391s/iter; left time: 1421.4621s
	iters: 300, epoch: 23 | loss: 0.0053579
	speed: 0.0398s/iter; left time: 1443.8509s
	iters: 400, epoch: 23 | loss: 0.0319927
	speed: 0.0392s/iter; left time: 1418.0605s
Epoch: 23 cost time: 18.59543466567993
Epoch: 23, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9696969696969697
model parameter : 1996974
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5152456
	speed: 0.0485s/iter; left time: 2270.0936s
	iters: 200, epoch: 1 | loss: 0.3544357
	speed: 0.0386s/iter; left time: 1804.6120s
	iters: 300, epoch: 1 | loss: 0.5503104
	speed: 0.0383s/iter; left time: 1783.7725s
	iters: 400, epoch: 1 | loss: 0.1192183
	speed: 0.0376s/iter; left time: 1750.5292s
Epoch: 1 cost time: 19.158030033111572
Epoch: 1, Steps: 469 | Train Loss: 0.511 Vali Loss: 0.309 Vali Acc: 0.897 Test Loss: 0.309 Test Acc: 0.897
Validation loss decreased (inf --> -0.897081).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4809094
	speed: 0.1767s/iter; left time: 8185.6508s
	iters: 200, epoch: 2 | loss: 0.2832772
	speed: 0.0431s/iter; left time: 1992.8992s
	iters: 300, epoch: 2 | loss: 0.0428277
	speed: 0.0411s/iter; left time: 1897.0413s
	iters: 400, epoch: 2 | loss: 0.0398601
	speed: 0.0431s/iter; left time: 1982.6335s
Epoch: 2 cost time: 20.157402276992798
Epoch: 2, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
Validation loss decreased (-0.897081 --> -0.913091).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0939999
	speed: 0.1926s/iter; left time: 8830.9691s
	iters: 200, epoch: 3 | loss: 0.0643402
	speed: 0.0380s/iter; left time: 1739.5290s
	iters: 300, epoch: 3 | loss: 0.3055035
	speed: 0.0382s/iter; left time: 1742.8978s
	iters: 400, epoch: 3 | loss: 0.0403633
	speed: 0.0397s/iter; left time: 1809.9753s
Epoch: 3 cost time: 18.85717487335205
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0036458
	speed: 0.1911s/iter; left time: 8673.4757s
	iters: 200, epoch: 4 | loss: 0.0363446
	speed: 0.0398s/iter; left time: 1804.6204s
	iters: 300, epoch: 4 | loss: 0.0427261
	speed: 0.0397s/iter; left time: 1795.5902s
	iters: 400, epoch: 4 | loss: 0.0275653
	speed: 0.0387s/iter; left time: 1743.0439s
Epoch: 4 cost time: 18.913746118545532
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
Validation loss decreased (-0.913091 --> -0.939678).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0171736
	speed: 0.1729s/iter; left time: 7765.5677s
	iters: 200, epoch: 5 | loss: 0.0902384
	speed: 0.0387s/iter; left time: 1734.0590s
	iters: 300, epoch: 5 | loss: 0.2542808
	speed: 0.0391s/iter; left time: 1749.1427s
	iters: 400, epoch: 5 | loss: 0.0397788
	speed: 0.0398s/iter; left time: 1774.8188s
Epoch: 5 cost time: 18.663154363632202
Epoch: 5, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0162663
	speed: 0.1684s/iter; left time: 7486.6774s
	iters: 200, epoch: 6 | loss: 0.2446420
	speed: 0.0391s/iter; left time: 1733.4885s
	iters: 300, epoch: 6 | loss: 0.0402357
	speed: 0.0371s/iter; left time: 1643.7863s
	iters: 400, epoch: 6 | loss: 0.0082548
	speed: 0.0382s/iter; left time: 1688.1820s
Epoch: 6 cost time: 18.318521976470947
Epoch: 6, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.939678 --> -0.951971).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7385597
	speed: 0.1758s/iter; left time: 7732.9082s
	iters: 200, epoch: 7 | loss: 0.0843099
	speed: 0.0386s/iter; left time: 1693.4024s
	iters: 300, epoch: 7 | loss: 0.2372680
	speed: 0.0375s/iter; left time: 1641.2731s
	iters: 400, epoch: 7 | loss: 0.0119566
	speed: 0.0409s/iter; left time: 1788.9804s
Epoch: 7 cost time: 18.49105167388916
Epoch: 7, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0141067
	speed: 0.1669s/iter; left time: 7264.1570s
	iters: 200, epoch: 8 | loss: 0.1017061
	speed: 0.0370s/iter; left time: 1608.0617s
	iters: 300, epoch: 8 | loss: 0.0489122
	speed: 0.0361s/iter; left time: 1563.9220s
	iters: 400, epoch: 8 | loss: 0.0075521
	speed: 0.0373s/iter; left time: 1611.5626s
Epoch: 8 cost time: 17.80072283744812
Epoch: 8, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
Validation loss decreased (-0.951971 --> -0.954830).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0712863
	speed: 0.1714s/iter; left time: 7377.0349s
	iters: 200, epoch: 9 | loss: 0.0745795
	speed: 0.0368s/iter; left time: 1580.8774s
	iters: 300, epoch: 9 | loss: 0.0109761
	speed: 0.0394s/iter; left time: 1686.1825s
	iters: 400, epoch: 9 | loss: 0.0882052
	speed: 0.0376s/iter; left time: 1608.4611s
Epoch: 9 cost time: 18.18703317642212
Epoch: 9, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.954830 --> -0.962263).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0599285
	speed: 0.1645s/iter; left time: 7005.5817s
	iters: 200, epoch: 10 | loss: 0.0058638
	speed: 0.0375s/iter; left time: 1595.0964s
	iters: 300, epoch: 10 | loss: 0.0917112
	speed: 0.0386s/iter; left time: 1635.9358s
	iters: 400, epoch: 10 | loss: 0.0510812
	speed: 0.0382s/iter; left time: 1615.9079s
Epoch: 10 cost time: 18.383565425872803
Epoch: 10, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.962263 --> -0.968266).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0998855
	speed: 0.1738s/iter; left time: 7318.1336s
	iters: 200, epoch: 11 | loss: 0.1372660
	speed: 0.0399s/iter; left time: 1675.4448s
	iters: 300, epoch: 11 | loss: 0.0054712
	speed: 0.0380s/iter; left time: 1593.3788s
	iters: 400, epoch: 11 | loss: 0.0112994
	speed: 0.0375s/iter; left time: 1566.8475s
Epoch: 11 cost time: 18.243963718414307
Epoch: 11, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0400043
	speed: 0.1439s/iter; left time: 5993.9489s
	iters: 200, epoch: 12 | loss: 0.5820773
	speed: 0.0327s/iter; left time: 1358.1095s
	iters: 300, epoch: 12 | loss: 0.0520464
	speed: 0.0353s/iter; left time: 1462.6004s
	iters: 400, epoch: 12 | loss: 0.0046952
	speed: 0.0333s/iter; left time: 1378.3343s
Epoch: 12 cost time: 15.979271411895752
Epoch: 12, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0700203
	speed: 0.1836s/iter; left time: 7559.5533s
	iters: 200, epoch: 13 | loss: 0.3036237
	speed: 0.0412s/iter; left time: 1690.2337s
	iters: 300, epoch: 13 | loss: 0.0118281
	speed: 0.0411s/iter; left time: 1686.0235s
	iters: 400, epoch: 13 | loss: 0.0020990
	speed: 0.0422s/iter; left time: 1723.3614s
Epoch: 13 cost time: 19.922473907470703
Epoch: 13, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0044340
	speed: 0.1851s/iter; left time: 7533.4251s
	iters: 200, epoch: 14 | loss: 0.0034984
	speed: 0.0412s/iter; left time: 1673.1686s
	iters: 300, epoch: 14 | loss: 0.0111742
	speed: 0.0398s/iter; left time: 1613.7934s
	iters: 400, epoch: 14 | loss: 0.1439195
	speed: 0.0395s/iter; left time: 1597.0457s
Epoch: 14 cost time: 19.44608449935913
Epoch: 14, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0020366
	speed: 0.1918s/iter; left time: 7717.8572s
	iters: 200, epoch: 15 | loss: 0.0059639
	speed: 0.0388s/iter; left time: 1558.6916s
	iters: 300, epoch: 15 | loss: 0.0331265
	speed: 0.0374s/iter; left time: 1498.8051s
	iters: 400, epoch: 15 | loss: 0.0095974
	speed: 0.0384s/iter; left time: 1535.0524s
Epoch: 15 cost time: 18.310325860977173
Epoch: 15, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0080395
	speed: 0.1581s/iter; left time: 6286.2362s
	iters: 200, epoch: 16 | loss: 0.0365646
	speed: 0.0358s/iter; left time: 1420.4978s
	iters: 300, epoch: 16 | loss: 0.0026118
	speed: 0.0370s/iter; left time: 1462.1430s
	iters: 400, epoch: 16 | loss: 0.0071356
	speed: 0.0381s/iter; left time: 1503.2550s
Epoch: 16 cost time: 17.981403589248657
Epoch: 16, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0054569
	speed: 0.1577s/iter; left time: 6198.7564s
	iters: 200, epoch: 17 | loss: 0.2820315
	speed: 0.0370s/iter; left time: 1449.6591s
	iters: 300, epoch: 17 | loss: 0.0037648
	speed: 0.0372s/iter; left time: 1454.6340s
	iters: 400, epoch: 17 | loss: 0.1783559
	speed: 0.0362s/iter; left time: 1413.4588s
Epoch: 17 cost time: 17.60897183418274
Epoch: 17, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0793605
	speed: 0.1638s/iter; left time: 6358.9913s
	iters: 200, epoch: 18 | loss: 0.0966612
	speed: 0.0355s/iter; left time: 1374.9482s
	iters: 300, epoch: 18 | loss: 0.6692282
	speed: 0.0379s/iter; left time: 1463.8555s
	iters: 400, epoch: 18 | loss: 0.1388022
	speed: 0.0381s/iter; left time: 1467.2635s
Epoch: 18 cost time: 17.819538354873657
Epoch: 18, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0216989
	speed: 0.1490s/iter; left time: 5713.8577s
	iters: 200, epoch: 19 | loss: 0.0153522
	speed: 0.0367s/iter; left time: 1403.2555s
	iters: 300, epoch: 19 | loss: 0.2826158
	speed: 0.0348s/iter; left time: 1327.9005s
	iters: 400, epoch: 19 | loss: 0.0256488
	speed: 0.0338s/iter; left time: 1287.4629s
Epoch: 19 cost time: 17.208337545394897
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0545984
	speed: 0.1551s/iter; left time: 5875.1772s
	iters: 200, epoch: 20 | loss: 0.0258025
	speed: 0.0343s/iter; left time: 1295.3471s
	iters: 300, epoch: 20 | loss: 0.0054030
	speed: 0.0379s/iter; left time: 1429.9645s
	iters: 400, epoch: 20 | loss: 0.0111481
	speed: 0.0385s/iter; left time: 1446.0528s
Epoch: 20 cost time: 17.190673351287842
Epoch: 20, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
Validation loss decreased (-0.968266 --> -0.971983).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0016875
	speed: 0.1502s/iter; left time: 5621.4632s
	iters: 200, epoch: 21 | loss: 0.0013837
	speed: 0.0386s/iter; left time: 1439.8327s
	iters: 300, epoch: 21 | loss: 0.0587875
	speed: 0.0381s/iter; left time: 1419.0805s
	iters: 400, epoch: 21 | loss: 0.0724466
	speed: 0.0377s/iter; left time: 1399.1450s
Epoch: 21 cost time: 18.072126388549805
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1129147
	speed: 0.1569s/iter; left time: 5796.3992s
	iters: 200, epoch: 22 | loss: 0.0316145
	speed: 0.0369s/iter; left time: 1359.4237s
	iters: 300, epoch: 22 | loss: 0.0042583
	speed: 0.0360s/iter; left time: 1324.1546s
	iters: 400, epoch: 22 | loss: 0.0299307
	speed: 0.0385s/iter; left time: 1411.9941s
Epoch: 22 cost time: 17.876994132995605
Epoch: 22, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0065272
	speed: 0.1762s/iter; left time: 6429.6467s
	iters: 200, epoch: 23 | loss: 0.0021239
	speed: 0.0374s/iter; left time: 1360.1544s
	iters: 300, epoch: 23 | loss: 0.0034447
	speed: 0.0394s/iter; left time: 1431.2047s
	iters: 400, epoch: 23 | loss: 0.0286192
	speed: 0.0383s/iter; left time: 1385.4821s
Epoch: 23 cost time: 18.30719232559204
Epoch: 23, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0013761
	speed: 0.1735s/iter; left time: 6249.3105s
	iters: 200, epoch: 24 | loss: 0.0038803
	speed: 0.0389s/iter; left time: 1396.8389s
	iters: 300, epoch: 24 | loss: 0.0046786
	speed: 0.0375s/iter; left time: 1343.1697s
	iters: 400, epoch: 24 | loss: 0.0282443
	speed: 0.0375s/iter; left time: 1338.4936s
Epoch: 24 cost time: 18.462296724319458
Epoch: 24, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0362461
	speed: 0.1696s/iter; left time: 6028.8133s
	iters: 200, epoch: 25 | loss: 0.0216370
	speed: 0.0413s/iter; left time: 1464.7788s
	iters: 300, epoch: 25 | loss: 0.0806260
	speed: 0.0419s/iter; left time: 1482.4388s
	iters: 400, epoch: 25 | loss: 0.0649541
	speed: 0.0371s/iter; left time: 1308.2258s
Epoch: 25 cost time: 18.844789266586304
Epoch: 25, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0230342
	speed: 0.1612s/iter; left time: 5653.5691s
	iters: 200, epoch: 26 | loss: 0.3296985
	speed: 0.0362s/iter; left time: 1267.2708s
	iters: 300, epoch: 26 | loss: 0.1342363
	speed: 0.0355s/iter; left time: 1238.3275s
	iters: 400, epoch: 26 | loss: 0.0033953
	speed: 0.0320s/iter; left time: 1112.7135s
Epoch: 26 cost time: 16.434022903442383
Epoch: 26, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1954927
	speed: 0.1035s/iter; left time: 3582.5358s
	iters: 200, epoch: 27 | loss: 0.0025369
	speed: 0.0313s/iter; left time: 1078.6638s
	iters: 300, epoch: 27 | loss: 0.0020030
	speed: 0.0370s/iter; left time: 1273.2853s
	iters: 400, epoch: 27 | loss: 0.0021110
	speed: 0.0364s/iter; left time: 1247.1228s
Epoch: 27 cost time: 16.417932271957397
Epoch: 27, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0022059
	speed: 0.1584s/iter; left time: 5407.8065s
	iters: 200, epoch: 28 | loss: 0.2168892
	speed: 0.0349s/iter; left time: 1188.7593s
	iters: 300, epoch: 28 | loss: 0.0020110
	speed: 0.0356s/iter; left time: 1207.5765s
	iters: 400, epoch: 28 | loss: 0.0093332
	speed: 0.0359s/iter; left time: 1215.8321s
Epoch: 28 cost time: 17.296120643615723
Epoch: 28, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0025810
	speed: 0.1536s/iter; left time: 5172.3853s
	iters: 200, epoch: 29 | loss: 0.0184478
	speed: 0.0388s/iter; left time: 1301.8434s
	iters: 300, epoch: 29 | loss: 0.0018294
	speed: 0.0374s/iter; left time: 1252.5910s
	iters: 400, epoch: 29 | loss: 0.0155980
	speed: 0.0363s/iter; left time: 1210.1867s
Epoch: 29 cost time: 17.951079607009888
Epoch: 29, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0007732
	speed: 0.1573s/iter; left time: 5223.2250s
	iters: 200, epoch: 30 | loss: 0.0004003
	speed: 0.0378s/iter; left time: 1251.1386s
	iters: 300, epoch: 30 | loss: 0.0032204
	speed: 0.0383s/iter; left time: 1262.4432s
	iters: 400, epoch: 30 | loss: 0.0080807
	speed: 0.0368s/iter; left time: 1212.1315s
Epoch: 30 cost time: 17.851826190948486
Epoch: 30, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 1996718
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4498430
	speed: 0.0464s/iter; left time: 2173.7403s
	iters: 200, epoch: 1 | loss: 0.2065651
	speed: 0.0366s/iter; left time: 1709.8287s
	iters: 300, epoch: 1 | loss: 0.2139149
	speed: 0.0361s/iter; left time: 1682.9194s
	iters: 400, epoch: 1 | loss: 0.1014696
	speed: 0.0367s/iter; left time: 1708.7810s
Epoch: 1 cost time: 18.325788736343384
Epoch: 1, Steps: 469 | Train Loss: 0.508 Vali Loss: 0.268 Vali Acc: 0.902 Test Loss: 0.268 Test Acc: 0.902
Validation loss decreased (inf --> -0.901941).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1360784
	speed: 0.1670s/iter; left time: 7738.4819s
	iters: 200, epoch: 2 | loss: 0.0433071
	speed: 0.0386s/iter; left time: 1785.5706s
	iters: 300, epoch: 2 | loss: 0.0475301
	speed: 0.0375s/iter; left time: 1729.5352s
	iters: 400, epoch: 2 | loss: 0.0719564
	speed: 0.0360s/iter; left time: 1657.6628s
Epoch: 2 cost time: 17.979912757873535
Epoch: 2, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.901941 --> -0.945967).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1229586
	speed: 0.1742s/iter; left time: 7988.9200s
	iters: 200, epoch: 3 | loss: 0.0450081
	speed: 0.0358s/iter; left time: 1637.8622s
	iters: 300, epoch: 3 | loss: 0.0181568
	speed: 0.0390s/iter; left time: 1782.3632s
	iters: 400, epoch: 3 | loss: 0.0537616
	speed: 0.0392s/iter; left time: 1784.3616s
Epoch: 3 cost time: 18.074410915374756
Epoch: 3, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.273 Vali Acc: 0.934 Test Loss: 0.273 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0096913
	speed: 0.1696s/iter; left time: 7698.3092s
	iters: 200, epoch: 4 | loss: 0.0761703
	speed: 0.0401s/iter; left time: 1816.9973s
	iters: 300, epoch: 4 | loss: 0.1970063
	speed: 0.0376s/iter; left time: 1699.6674s
	iters: 400, epoch: 4 | loss: 0.0608266
	speed: 0.0404s/iter; left time: 1822.5845s
Epoch: 4 cost time: 18.62550687789917
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
Validation loss decreased (-0.945967 --> -0.957689).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0664803
	speed: 0.1583s/iter; left time: 7112.4990s
	iters: 200, epoch: 5 | loss: 0.3725484
	speed: 0.0353s/iter; left time: 1580.2911s
	iters: 300, epoch: 5 | loss: 0.0849009
	speed: 0.0358s/iter; left time: 1602.8785s
	iters: 400, epoch: 5 | loss: 0.0080091
	speed: 0.0368s/iter; left time: 1642.8402s
Epoch: 5 cost time: 17.210150241851807
Epoch: 5, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0069210
	speed: 0.1533s/iter; left time: 6813.0823s
	iters: 200, epoch: 6 | loss: 0.1958145
	speed: 0.0372s/iter; left time: 1650.0497s
	iters: 300, epoch: 6 | loss: 0.0104843
	speed: 0.0372s/iter; left time: 1648.3634s
	iters: 400, epoch: 6 | loss: 0.0018093
	speed: 0.0361s/iter; left time: 1593.6246s
Epoch: 6 cost time: 17.530622243881226
Epoch: 6, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0021706
	speed: 0.1576s/iter; left time: 6931.7695s
	iters: 200, epoch: 7 | loss: 0.0563294
	speed: 0.0358s/iter; left time: 1570.4674s
	iters: 300, epoch: 7 | loss: 0.0166469
	speed: 0.0357s/iter; left time: 1563.4371s
	iters: 400, epoch: 7 | loss: 0.0188744
	speed: 0.0374s/iter; left time: 1632.8536s
Epoch: 7 cost time: 17.41108751296997
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2414578
	speed: 0.1502s/iter; left time: 6538.1688s
	iters: 200, epoch: 8 | loss: 0.0063835
	speed: 0.0387s/iter; left time: 1681.2432s
	iters: 300, epoch: 8 | loss: 0.0045003
	speed: 0.0362s/iter; left time: 1568.6535s
	iters: 400, epoch: 8 | loss: 0.1010252
	speed: 0.0357s/iter; left time: 1541.5536s
Epoch: 8 cost time: 17.58132529258728
Epoch: 8, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0725612
	speed: 0.1587s/iter; left time: 6831.8158s
	iters: 200, epoch: 9 | loss: 0.0064417
	speed: 0.0378s/iter; left time: 1621.9794s
	iters: 300, epoch: 9 | loss: 0.0012752
	speed: 0.0388s/iter; left time: 1663.7816s
	iters: 400, epoch: 9 | loss: 0.0695375
	speed: 0.0345s/iter; left time: 1474.0830s
Epoch: 9 cost time: 17.52917742729187
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0662433
	speed: 0.1525s/iter; left time: 6491.3249s
	iters: 200, epoch: 10 | loss: 0.0032636
	speed: 0.0351s/iter; left time: 1492.3918s
	iters: 300, epoch: 10 | loss: 0.0602974
	speed: 0.0370s/iter; left time: 1568.8695s
	iters: 400, epoch: 10 | loss: 0.0005476
	speed: 0.0370s/iter; left time: 1566.3734s
Epoch: 10 cost time: 17.443195819854736
Epoch: 10, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.227 Vali Acc: 0.945 Test Loss: 0.227 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0122532
	speed: 0.1498s/iter; left time: 6308.4953s
	iters: 200, epoch: 11 | loss: 0.5515059
	speed: 0.0384s/iter; left time: 1613.4205s
	iters: 300, epoch: 11 | loss: 0.0105979
	speed: 0.0355s/iter; left time: 1489.8619s
	iters: 400, epoch: 11 | loss: 0.0268988
	speed: 0.0342s/iter; left time: 1430.0419s
Epoch: 11 cost time: 17.449298858642578
Epoch: 11, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0062157
	speed: 0.1571s/iter; left time: 6540.8630s
	iters: 200, epoch: 12 | loss: 0.1803861
	speed: 0.0406s/iter; left time: 1688.5604s
	iters: 300, epoch: 12 | loss: 0.3518762
	speed: 0.0392s/iter; left time: 1624.4973s
	iters: 400, epoch: 12 | loss: 0.3312710
	speed: 0.0392s/iter; left time: 1619.3271s
Epoch: 12 cost time: 18.550661087036133
Epoch: 12, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.180 Vali Acc: 0.945 Test Loss: 0.180 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0065780
	speed: 0.1752s/iter; left time: 7213.8578s
	iters: 200, epoch: 13 | loss: 0.0653448
	speed: 0.0394s/iter; left time: 1617.4798s
	iters: 300, epoch: 13 | loss: 0.0111992
	speed: 0.0371s/iter; left time: 1521.0236s
	iters: 400, epoch: 13 | loss: 0.0150257
	speed: 0.0351s/iter; left time: 1433.7157s
Epoch: 13 cost time: 17.473986387252808
Epoch: 13, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1070199
	speed: 0.1076s/iter; left time: 4380.8044s
	iters: 200, epoch: 14 | loss: 0.0105851
	speed: 0.0310s/iter; left time: 1259.0204s
	iters: 300, epoch: 14 | loss: 0.0043636
	speed: 0.0382s/iter; left time: 1547.8146s
	iters: 400, epoch: 14 | loss: 0.0034726
	speed: 0.0405s/iter; left time: 1637.0274s
Epoch: 14 cost time: 16.906622171401978
Epoch: 14, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9576901086335049
model parameter : 1668526
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5597118
	speed: 0.0518s/iter; left time: 2424.4783s
	iters: 200, epoch: 1 | loss: 0.1156352
	speed: 0.0406s/iter; left time: 1896.0033s
	iters: 300, epoch: 1 | loss: 0.1337256
	speed: 0.0383s/iter; left time: 1782.9699s
	iters: 400, epoch: 1 | loss: 0.0533247
	speed: 0.0377s/iter; left time: 1751.6097s
Epoch: 1 cost time: 19.81481385231018
Epoch: 1, Steps: 469 | Train Loss: 0.529 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (inf --> -0.934817).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2111535
	speed: 0.1691s/iter; left time: 7837.0502s
	iters: 200, epoch: 2 | loss: 0.0254431
	speed: 0.0431s/iter; left time: 1993.7077s
	iters: 300, epoch: 2 | loss: 0.0111627
	speed: 0.0412s/iter; left time: 1899.0061s
	iters: 400, epoch: 2 | loss: 0.2369274
	speed: 0.0391s/iter; left time: 1798.7175s
Epoch: 2 cost time: 19.160181283950806
Epoch: 2, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0963711
	speed: 0.1663s/iter; left time: 7626.5859s
	iters: 200, epoch: 3 | loss: 0.0164774
	speed: 0.0411s/iter; left time: 1881.2413s
	iters: 300, epoch: 3 | loss: 0.0071853
	speed: 0.0395s/iter; left time: 1805.9644s
	iters: 400, epoch: 3 | loss: 0.0100872
	speed: 0.0372s/iter; left time: 1694.0514s
Epoch: 3 cost time: 18.38936424255371
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.225 Vali Acc: 0.940 Test Loss: 0.225 Test Acc: 0.940
Validation loss decreased (-0.934817 --> -0.939678).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0266874
	speed: 0.1566s/iter; left time: 7109.1052s
	iters: 200, epoch: 4 | loss: 0.0261802
	speed: 0.0398s/iter; left time: 1803.7355s
	iters: 300, epoch: 4 | loss: 0.5223750
	speed: 0.0408s/iter; left time: 1844.8953s
	iters: 400, epoch: 4 | loss: 0.0075669
	speed: 0.0414s/iter; left time: 1865.0819s
Epoch: 4 cost time: 19.206202507019043
Epoch: 4, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4320850
	speed: 0.1681s/iter; left time: 7550.1228s
	iters: 200, epoch: 5 | loss: 0.0693117
	speed: 0.0369s/iter; left time: 1654.3587s
	iters: 300, epoch: 5 | loss: 0.0028196
	speed: 0.0378s/iter; left time: 1692.0366s
	iters: 400, epoch: 5 | loss: 0.0170022
	speed: 0.0389s/iter; left time: 1736.6180s
Epoch: 5 cost time: 18.42875051498413
Epoch: 5, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.939678 --> -0.941107).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0226090
	speed: 0.1522s/iter; left time: 6765.3802s
	iters: 200, epoch: 6 | loss: 0.0038418
	speed: 0.0411s/iter; left time: 1821.4511s
	iters: 300, epoch: 6 | loss: 0.3407553
	speed: 0.0398s/iter; left time: 1760.5533s
	iters: 400, epoch: 6 | loss: 0.0127660
	speed: 0.0401s/iter; left time: 1768.6039s
Epoch: 6 cost time: 19.018397331237793
Epoch: 6, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.941107 --> -0.962262).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0324876
	speed: 0.1638s/iter; left time: 7203.6033s
	iters: 200, epoch: 7 | loss: 0.1106769
	speed: 0.0422s/iter; left time: 1851.2697s
	iters: 300, epoch: 7 | loss: 0.0789523
	speed: 0.0424s/iter; left time: 1857.7514s
	iters: 400, epoch: 7 | loss: 0.7191232
	speed: 0.0407s/iter; left time: 1776.2445s
Epoch: 7 cost time: 19.574422597885132
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0881676
	speed: 0.1850s/iter; left time: 8051.6129s
	iters: 200, epoch: 8 | loss: 0.0233092
	speed: 0.0409s/iter; left time: 1774.0606s
	iters: 300, epoch: 8 | loss: 0.0489652
	speed: 0.0418s/iter; left time: 1808.6202s
	iters: 400, epoch: 8 | loss: 0.0168414
	speed: 0.0418s/iter; left time: 1808.1265s
Epoch: 8 cost time: 19.76253342628479
Epoch: 8, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0430790
	speed: 0.1838s/iter; left time: 7911.2790s
	iters: 200, epoch: 9 | loss: 0.0146058
	speed: 0.0415s/iter; left time: 1782.4665s
	iters: 300, epoch: 9 | loss: 0.4927342
	speed: 0.0398s/iter; left time: 1703.3349s
	iters: 400, epoch: 9 | loss: 0.0315783
	speed: 0.0421s/iter; left time: 1801.8507s
Epoch: 9 cost time: 19.687426328659058
Epoch: 9, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0174744
	speed: 0.1607s/iter; left time: 6841.9235s
	iters: 200, epoch: 10 | loss: 0.1179082
	speed: 0.0394s/iter; left time: 1672.3409s
	iters: 300, epoch: 10 | loss: 0.3551048
	speed: 0.0371s/iter; left time: 1574.1940s
	iters: 400, epoch: 10 | loss: 0.0416869
	speed: 0.0375s/iter; left time: 1584.7998s
Epoch: 10 cost time: 18.57658839225769
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0157612
	speed: 0.1612s/iter; left time: 6788.2055s
	iters: 200, epoch: 11 | loss: 0.0178539
	speed: 0.0396s/iter; left time: 1664.3781s
	iters: 300, epoch: 11 | loss: 0.1473095
	speed: 0.0397s/iter; left time: 1663.0028s
	iters: 400, epoch: 11 | loss: 0.0019291
	speed: 0.0366s/iter; left time: 1531.4902s
Epoch: 11 cost time: 18.275354146957397
Epoch: 11, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.210 Vali Acc: 0.940 Test Loss: 0.210 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0773666
	speed: 0.1610s/iter; left time: 6706.2789s
	iters: 200, epoch: 12 | loss: 0.0062696
	speed: 0.0378s/iter; left time: 1571.2934s
	iters: 300, epoch: 12 | loss: 0.0044889
	speed: 0.0389s/iter; left time: 1611.9042s
	iters: 400, epoch: 12 | loss: 0.0151087
	speed: 0.0366s/iter; left time: 1513.6341s
Epoch: 12 cost time: 18.107182025909424
Epoch: 12, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0180989
	speed: 0.1584s/iter; left time: 6521.4529s
	iters: 200, epoch: 13 | loss: 0.0507706
	speed: 0.0387s/iter; left time: 1588.4162s
	iters: 300, epoch: 13 | loss: 0.0054006
	speed: 0.0372s/iter; left time: 1524.3829s
	iters: 400, epoch: 13 | loss: 0.0218520
	speed: 0.0401s/iter; left time: 1639.5861s
Epoch: 13 cost time: 18.33682870864868
Epoch: 13, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0012571
	speed: 0.1640s/iter; left time: 6674.5766s
	iters: 200, epoch: 14 | loss: 0.1501412
	speed: 0.0385s/iter; left time: 1562.2883s
	iters: 300, epoch: 14 | loss: 0.0010941
	speed: 0.0381s/iter; left time: 1542.3012s
	iters: 400, epoch: 14 | loss: 0.2852845
	speed: 0.0367s/iter; left time: 1482.2678s
Epoch: 14 cost time: 18.201236963272095
Epoch: 14, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0431370
	speed: 0.1527s/iter; left time: 6143.7731s
	iters: 200, epoch: 15 | loss: 0.0093934
	speed: 0.0424s/iter; left time: 1703.6886s
	iters: 300, epoch: 15 | loss: 0.0590699
	speed: 0.0407s/iter; left time: 1630.6933s
	iters: 400, epoch: 15 | loss: 0.1027548
	speed: 0.0379s/iter; left time: 1514.9599s
Epoch: 15 cost time: 18.551254272460938
Epoch: 15, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0568065
	speed: 0.1280s/iter; left time: 5091.6447s
	iters: 200, epoch: 16 | loss: 0.0026363
	speed: 0.0322s/iter; left time: 1276.4428s
	iters: 300, epoch: 16 | loss: 0.0040824
	speed: 0.0332s/iter; left time: 1314.6997s
	iters: 400, epoch: 16 | loss: 0.4962772
	speed: 0.0390s/iter; left time: 1537.5140s
Epoch: 16 cost time: 17.36193084716797
Epoch: 16, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.962262 --> -0.962263).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0116487
	speed: 0.1806s/iter; left time: 7096.6823s
	iters: 200, epoch: 17 | loss: 0.1118044
	speed: 0.0447s/iter; left time: 1753.1810s
	iters: 300, epoch: 17 | loss: 0.0031839
	speed: 0.0421s/iter; left time: 1646.0160s
	iters: 400, epoch: 17 | loss: 0.0340243
	speed: 0.0399s/iter; left time: 1556.5991s
Epoch: 17 cost time: 19.49539351463318
Epoch: 17, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0109023
	speed: 0.1755s/iter; left time: 6812.3918s
	iters: 200, epoch: 18 | loss: 0.4419334
	speed: 0.0393s/iter; left time: 1523.5774s
	iters: 300, epoch: 18 | loss: 0.0003737
	speed: 0.0414s/iter; left time: 1599.6223s
	iters: 400, epoch: 18 | loss: 0.1272834
	speed: 0.0409s/iter; left time: 1577.7122s
Epoch: 18 cost time: 19.258291482925415
Epoch: 18, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.962263 --> -0.963692).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0426279
	speed: 0.1846s/iter; left time: 7081.6689s
	iters: 200, epoch: 19 | loss: 0.0016060
	speed: 0.0409s/iter; left time: 1563.5910s
	iters: 300, epoch: 19 | loss: 0.1427246
	speed: 0.0396s/iter; left time: 1512.1497s
	iters: 400, epoch: 19 | loss: 0.0019984
	speed: 0.0400s/iter; left time: 1523.0718s
Epoch: 19 cost time: 19.1808123588562
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0106138
	speed: 0.1569s/iter; left time: 5945.8214s
	iters: 200, epoch: 20 | loss: 0.1718290
	speed: 0.0382s/iter; left time: 1444.9775s
	iters: 300, epoch: 20 | loss: 0.0162208
	speed: 0.0400s/iter; left time: 1508.0549s
	iters: 400, epoch: 20 | loss: 0.0593527
	speed: 0.0389s/iter; left time: 1464.0251s
Epoch: 20 cost time: 18.73907232284546
Epoch: 20, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0032163
	speed: 0.1639s/iter; left time: 6134.7045s
	iters: 200, epoch: 21 | loss: 0.0176484
	speed: 0.0400s/iter; left time: 1493.7948s
	iters: 300, epoch: 21 | loss: 0.0767036
	speed: 0.0369s/iter; left time: 1372.3210s
	iters: 400, epoch: 21 | loss: 0.0021870
	speed: 0.0368s/iter; left time: 1366.2739s
Epoch: 21 cost time: 18.51017999649048
Epoch: 21, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1557257
	speed: 0.1603s/iter; left time: 5924.5770s
	iters: 200, epoch: 22 | loss: 0.1617322
	speed: 0.0399s/iter; left time: 1471.5245s
	iters: 300, epoch: 22 | loss: 0.0554658
	speed: 0.0386s/iter; left time: 1419.7264s
	iters: 400, epoch: 22 | loss: 0.0057584
	speed: 0.0394s/iter; left time: 1443.7256s
Epoch: 22 cost time: 18.80888342857361
Epoch: 22, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0472106
	speed: 0.1684s/iter; left time: 6145.4929s
	iters: 200, epoch: 23 | loss: 0.0096588
	speed: 0.0370s/iter; left time: 1346.2781s
	iters: 300, epoch: 23 | loss: 0.1669557
	speed: 0.0386s/iter; left time: 1399.5475s
	iters: 400, epoch: 23 | loss: 0.0287780
	speed: 0.0378s/iter; left time: 1367.4062s
Epoch: 23 cost time: 18.20517873764038
Epoch: 23, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0058880
	speed: 0.1629s/iter; left time: 5866.0148s
	iters: 200, epoch: 24 | loss: 0.0564691
	speed: 0.0377s/iter; left time: 1353.3314s
	iters: 300, epoch: 24 | loss: 0.0029633
	speed: 0.0389s/iter; left time: 1391.4081s
	iters: 400, epoch: 24 | loss: 0.0097699
	speed: 0.0386s/iter; left time: 1380.0763s
Epoch: 24 cost time: 18.27601456642151
Epoch: 24, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0067463
	speed: 0.1619s/iter; left time: 5753.0111s
	iters: 200, epoch: 25 | loss: 0.0074844
	speed: 0.0385s/iter; left time: 1365.6652s
	iters: 300, epoch: 25 | loss: 0.0121599
	speed: 0.0397s/iter; left time: 1402.1255s
	iters: 400, epoch: 25 | loss: 0.0083467
	speed: 0.0387s/iter; left time: 1362.6335s
Epoch: 25 cost time: 18.637272834777832
Epoch: 25, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0594298
	speed: 0.1570s/iter; left time: 5507.0219s
	iters: 200, epoch: 26 | loss: 0.0068429
	speed: 0.0391s/iter; left time: 1366.0638s
	iters: 300, epoch: 26 | loss: 0.2059411
	speed: 0.0374s/iter; left time: 1305.6111s
	iters: 400, epoch: 26 | loss: 0.0020955
	speed: 0.0409s/iter; left time: 1421.4445s
Epoch: 26 cost time: 18.723799467086792
Epoch: 26, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.963692 --> -0.971125).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0921948
	speed: 0.1864s/iter; left time: 6450.8623s
	iters: 200, epoch: 27 | loss: 0.0163314
	speed: 0.0446s/iter; left time: 1538.2574s
	iters: 300, epoch: 27 | loss: 0.0153443
	speed: 0.0430s/iter; left time: 1478.6034s
	iters: 400, epoch: 27 | loss: 0.3771546
	speed: 0.0428s/iter; left time: 1470.0315s
Epoch: 27 cost time: 20.430628776550293
Epoch: 27, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0620781
	speed: 0.1833s/iter; left time: 6258.6081s
	iters: 200, epoch: 28 | loss: 0.0696137
	speed: 0.0414s/iter; left time: 1408.7384s
	iters: 300, epoch: 28 | loss: 0.0055170
	speed: 0.0422s/iter; left time: 1432.0224s
	iters: 400, epoch: 28 | loss: 0.0787739
	speed: 0.0429s/iter; left time: 1453.2059s
Epoch: 28 cost time: 19.99153161048889
Epoch: 28, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0072208
	speed: 0.1764s/iter; left time: 5938.1350s
	iters: 200, epoch: 29 | loss: 0.0131948
	speed: 0.0374s/iter; left time: 1255.3064s
	iters: 300, epoch: 29 | loss: 0.0004875
	speed: 0.0386s/iter; left time: 1291.2945s
	iters: 400, epoch: 29 | loss: 0.0310455
	speed: 0.0417s/iter; left time: 1390.7163s
Epoch: 29 cost time: 18.822290658950806
Epoch: 29, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.1097947
	speed: 0.1588s/iter; left time: 5272.4429s
	iters: 200, epoch: 30 | loss: 0.0060967
	speed: 0.0401s/iter; left time: 1327.2284s
	iters: 300, epoch: 30 | loss: 0.0076685
	speed: 0.0366s/iter; left time: 1209.1248s
	iters: 400, epoch: 30 | loss: 0.0039372
	speed: 0.0379s/iter; left time: 1245.5753s
Epoch: 30 cost time: 18.645559310913086
Epoch: 30, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0026873
	speed: 0.1667s/iter; left time: 5454.7200s
	iters: 200, epoch: 31 | loss: 0.2204623
	speed: 0.0411s/iter; left time: 1342.5982s
	iters: 300, epoch: 31 | loss: 0.0707484
	speed: 0.0393s/iter; left time: 1279.4159s
	iters: 400, epoch: 31 | loss: 0.2004097
	speed: 0.0385s/iter; left time: 1247.5233s
Epoch: 31 cost time: 18.86038875579834
Epoch: 31, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0371989
	speed: 0.1635s/iter; left time: 5275.0961s
	iters: 200, epoch: 32 | loss: 0.0158883
	speed: 0.0376s/iter; left time: 1209.6195s
	iters: 300, epoch: 32 | loss: 0.0024357
	speed: 0.0423s/iter; left time: 1355.9194s
	iters: 400, epoch: 32 | loss: 0.0439773
	speed: 0.0403s/iter; left time: 1286.5626s
Epoch: 32 cost time: 18.796775102615356
Epoch: 32, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0016776
	speed: 0.1691s/iter; left time: 5375.5821s
	iters: 200, epoch: 33 | loss: 0.0549908
	speed: 0.0389s/iter; left time: 1232.7193s
	iters: 300, epoch: 33 | loss: 0.0099672
	speed: 0.0389s/iter; left time: 1229.1620s
	iters: 400, epoch: 33 | loss: 0.0299252
	speed: 0.0393s/iter; left time: 1237.1309s
Epoch: 33 cost time: 18.730829000473022
Epoch: 33, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0023900
	speed: 0.1638s/iter; left time: 5131.7930s
	iters: 200, epoch: 34 | loss: 0.0644390
	speed: 0.0347s/iter; left time: 1082.8019s
	iters: 300, epoch: 34 | loss: 0.0271239
	speed: 0.0367s/iter; left time: 1142.4484s
	iters: 400, epoch: 34 | loss: 0.0059403
	speed: 0.0387s/iter; left time: 1199.6873s
Epoch: 34 cost time: 17.867836713790894
Epoch: 34, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0015342
	speed: 0.1520s/iter; left time: 4690.1700s
	iters: 200, epoch: 35 | loss: 0.0051079
	speed: 0.0397s/iter; left time: 1220.0566s
	iters: 300, epoch: 35 | loss: 0.0171938
	speed: 0.0395s/iter; left time: 1209.9168s
	iters: 400, epoch: 35 | loss: 0.0118883
	speed: 0.0384s/iter; left time: 1172.6794s
Epoch: 35 cost time: 18.707571744918823
Epoch: 35, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0137517
	speed: 0.1676s/iter; left time: 5094.1665s
	iters: 200, epoch: 36 | loss: 0.0600185
	speed: 0.0432s/iter; left time: 1307.8229s
	iters: 300, epoch: 36 | loss: 0.0040141
	speed: 0.0420s/iter; left time: 1267.9688s
	iters: 400, epoch: 36 | loss: 0.0343504
	speed: 0.0424s/iter; left time: 1276.3537s
Epoch: 36 cost time: 19.86141061782837
Epoch: 36, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9711263579188107
model parameter : 1668270
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7880009
	speed: 0.0524s/iter; left time: 2454.6582s
	iters: 200, epoch: 1 | loss: 0.1158736
	speed: 0.0417s/iter; left time: 1947.5475s
	iters: 300, epoch: 1 | loss: 0.2924170
	speed: 0.0433s/iter; left time: 2017.0263s
	iters: 400, epoch: 1 | loss: 0.0988793
	speed: 0.0408s/iter; left time: 1895.0679s
Epoch: 1 cost time: 20.636840343475342
Epoch: 1, Steps: 469 | Train Loss: 0.540 Vali Loss: 0.303 Vali Acc: 0.893 Test Loss: 0.303 Test Acc: 0.893
Validation loss decreased (inf --> -0.892793).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0288188
	speed: 0.1772s/iter; left time: 8211.1420s
	iters: 200, epoch: 2 | loss: 0.1507339
	speed: 0.0395s/iter; left time: 1826.7220s
	iters: 300, epoch: 2 | loss: 0.1810390
	speed: 0.0351s/iter; left time: 1617.6421s
	iters: 400, epoch: 2 | loss: 0.0327474
	speed: 0.0363s/iter; left time: 1669.3165s
Epoch: 2 cost time: 18.288208484649658
Epoch: 2, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.892793 --> -0.925098).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1801165
	speed: 0.1560s/iter; left time: 7152.8204s
	iters: 200, epoch: 3 | loss: 0.3009159
	speed: 0.0402s/iter; left time: 1839.0257s
	iters: 300, epoch: 3 | loss: 0.0577795
	speed: 0.0400s/iter; left time: 1827.9769s
	iters: 400, epoch: 3 | loss: 0.3991222
	speed: 0.0382s/iter; left time: 1738.6387s
Epoch: 3 cost time: 18.48493242263794
Epoch: 3, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
Validation loss decreased (-0.925098 --> -0.936247).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2872303
	speed: 0.1667s/iter; left time: 7566.0419s
	iters: 200, epoch: 4 | loss: 0.0118911
	speed: 0.0383s/iter; left time: 1734.9223s
	iters: 300, epoch: 4 | loss: 0.0052979
	speed: 0.0387s/iter; left time: 1746.9288s
	iters: 400, epoch: 4 | loss: 0.1296292
	speed: 0.0390s/iter; left time: 1757.8112s
Epoch: 4 cost time: 18.439889907836914
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.224 Vali Acc: 0.929 Test Loss: 0.224 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1912410
	speed: 0.1522s/iter; left time: 6837.8365s
	iters: 200, epoch: 5 | loss: 0.0025846
	speed: 0.0367s/iter; left time: 1645.6863s
	iters: 300, epoch: 5 | loss: 0.0055119
	speed: 0.0381s/iter; left time: 1705.7655s
	iters: 400, epoch: 5 | loss: 0.0260556
	speed: 0.0380s/iter; left time: 1694.2229s
Epoch: 5 cost time: 18.135714292526245
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.936247 --> -0.936819).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0052432
	speed: 0.1666s/iter; left time: 7406.9884s
	iters: 200, epoch: 6 | loss: 0.2038356
	speed: 0.0370s/iter; left time: 1642.4315s
	iters: 300, epoch: 6 | loss: 0.1053175
	speed: 0.0389s/iter; left time: 1721.8040s
	iters: 400, epoch: 6 | loss: 0.1391786
	speed: 0.0376s/iter; left time: 1660.2717s
Epoch: 6 cost time: 18.3659245967865
Epoch: 6, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.936819 --> -0.970268).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0048643
	speed: 0.1589s/iter; left time: 6991.1924s
	iters: 200, epoch: 7 | loss: 0.0060189
	speed: 0.0383s/iter; left time: 1680.7657s
	iters: 300, epoch: 7 | loss: 0.1480231
	speed: 0.0408s/iter; left time: 1786.7545s
	iters: 400, epoch: 7 | loss: 0.0077174
	speed: 0.0399s/iter; left time: 1743.5270s
Epoch: 7 cost time: 18.929442644119263
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.167 Vali Acc: 0.947 Test Loss: 0.167 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0083161
	speed: 0.1660s/iter; left time: 7225.4274s
	iters: 200, epoch: 8 | loss: 0.0122367
	speed: 0.0382s/iter; left time: 1660.6113s
	iters: 300, epoch: 8 | loss: 0.0741600
	speed: 0.0387s/iter; left time: 1678.4068s
	iters: 400, epoch: 8 | loss: 0.0614549
	speed: 0.0367s/iter; left time: 1586.9989s
Epoch: 8 cost time: 17.89310097694397
Epoch: 8, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0031385
	speed: 0.1537s/iter; left time: 6614.7058s
	iters: 200, epoch: 9 | loss: 0.0146466
	speed: 0.0365s/iter; left time: 1565.8881s
	iters: 300, epoch: 9 | loss: 0.5684235
	speed: 0.0363s/iter; left time: 1553.7371s
	iters: 400, epoch: 9 | loss: 0.0078918
	speed: 0.0408s/iter; left time: 1742.3408s
Epoch: 9 cost time: 18.523993968963623
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0022497
	speed: 0.1748s/iter; left time: 7442.0124s
	iters: 200, epoch: 10 | loss: 0.0593715
	speed: 0.0404s/iter; left time: 1715.0660s
	iters: 300, epoch: 10 | loss: 0.0039404
	speed: 0.0394s/iter; left time: 1670.3834s
	iters: 400, epoch: 10 | loss: 0.5400040
	speed: 0.0392s/iter; left time: 1657.4730s
Epoch: 10 cost time: 19.099851846694946
Epoch: 10, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0016679
	speed: 0.1802s/iter; left time: 7589.4456s
	iters: 200, epoch: 11 | loss: 0.0040054
	speed: 0.0437s/iter; left time: 1836.9450s
	iters: 300, epoch: 11 | loss: 0.0644179
	speed: 0.0416s/iter; left time: 1744.8738s
	iters: 400, epoch: 11 | loss: 0.0057240
	speed: 0.0414s/iter; left time: 1732.4564s
Epoch: 11 cost time: 19.598953008651733
Epoch: 11, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.227 Vali Acc: 0.951 Test Loss: 0.227 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0002538
	speed: 0.1744s/iter; left time: 7260.8291s
	iters: 200, epoch: 12 | loss: 0.0725458
	speed: 0.0371s/iter; left time: 1541.9473s
	iters: 300, epoch: 12 | loss: 0.2031976
	speed: 0.0397s/iter; left time: 1646.2586s
	iters: 400, epoch: 12 | loss: 0.0084743
	speed: 0.0406s/iter; left time: 1678.3016s
Epoch: 12 cost time: 18.951788902282715
Epoch: 12, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.397 Vali Acc: 0.920 Test Loss: 0.397 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1765550
	speed: 0.1747s/iter; left time: 7191.0675s
	iters: 200, epoch: 13 | loss: 0.0041885
	speed: 0.0409s/iter; left time: 1681.3198s
	iters: 300, epoch: 13 | loss: 0.0099685
	speed: 0.0393s/iter; left time: 1612.2175s
	iters: 400, epoch: 13 | loss: 0.1659470
	speed: 0.0351s/iter; left time: 1434.5456s
Epoch: 13 cost time: 18.60364866256714
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0933294
	speed: 0.1518s/iter; left time: 6177.1740s
	iters: 200, epoch: 14 | loss: 0.0021573
	speed: 0.0388s/iter; left time: 1575.5930s
	iters: 300, epoch: 14 | loss: 0.0165586
	speed: 0.0388s/iter; left time: 1569.9163s
	iters: 400, epoch: 14 | loss: 0.0117711
	speed: 0.0388s/iter; left time: 1566.6855s
Epoch: 14 cost time: 18.275348901748657
Epoch: 14, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0030937
	speed: 0.1660s/iter; left time: 6680.1987s
	iters: 200, epoch: 15 | loss: 0.0022066
	speed: 0.0389s/iter; left time: 1560.4152s
	iters: 300, epoch: 15 | loss: 0.1230241
	speed: 0.0384s/iter; left time: 1539.1426s
	iters: 400, epoch: 15 | loss: 0.0435581
	speed: 0.0376s/iter; left time: 1502.6243s
Epoch: 15 cost time: 18.197583198547363
Epoch: 15, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3064214
	speed: 0.1528s/iter; left time: 6077.6907s
	iters: 200, epoch: 16 | loss: 0.0086909
	speed: 0.0376s/iter; left time: 1489.7798s
	iters: 300, epoch: 16 | loss: 0.1586289
	speed: 0.0359s/iter; left time: 1422.1010s
	iters: 400, epoch: 16 | loss: 0.1961613
	speed: 0.0402s/iter; left time: 1585.4671s
Epoch: 16 cost time: 18.239798307418823
Epoch: 16, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 1668014
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7638530
	speed: 0.0525s/iter; left time: 2456.1995s
	iters: 200, epoch: 1 | loss: 0.2706489
	speed: 0.0366s/iter; left time: 1708.5654s
	iters: 300, epoch: 1 | loss: 0.5921891
	speed: 0.0363s/iter; left time: 1691.7188s
	iters: 400, epoch: 1 | loss: 0.1790637
	speed: 0.0366s/iter; left time: 1699.9790s
Epoch: 1 cost time: 18.75261378288269
Epoch: 1, Steps: 469 | Train Loss: 0.545 Vali Loss: 0.283 Vali Acc: 0.910 Test Loss: 0.283 Test Acc: 0.910
Validation loss decreased (inf --> -0.910232).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1196097
	speed: 0.1538s/iter; left time: 7124.9957s
	iters: 200, epoch: 2 | loss: 0.0480246
	speed: 0.0387s/iter; left time: 1790.2361s
	iters: 300, epoch: 2 | loss: 0.0412760
	speed: 0.0391s/iter; left time: 1802.3687s
	iters: 400, epoch: 2 | loss: 0.1087685
	speed: 0.0364s/iter; left time: 1675.5404s
Epoch: 2 cost time: 18.000535011291504
Epoch: 2, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.376 Vali Acc: 0.894 Test Loss: 0.376 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1578449
	speed: 0.1535s/iter; left time: 7041.7671s
	iters: 200, epoch: 3 | loss: 0.2703287
	speed: 0.0372s/iter; left time: 1702.1280s
	iters: 300, epoch: 3 | loss: 0.2607049
	speed: 0.0343s/iter; left time: 1565.7614s
	iters: 400, epoch: 3 | loss: 0.1376844
	speed: 0.0388s/iter; left time: 1766.6090s
Epoch: 3 cost time: 17.47324275970459
Epoch: 3, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.910232 --> -0.961691).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0161514
	speed: 0.1412s/iter; left time: 6411.1609s
	iters: 200, epoch: 4 | loss: 0.0074002
	speed: 0.0396s/iter; left time: 1791.4101s
	iters: 300, epoch: 4 | loss: 0.0027072
	speed: 0.0377s/iter; left time: 1705.0971s
	iters: 400, epoch: 4 | loss: 0.4188309
	speed: 0.0380s/iter; left time: 1713.4552s
Epoch: 4 cost time: 18.00456190109253
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.961691 --> -0.962834).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0432753
	speed: 0.1791s/iter; left time: 8045.4512s
	iters: 200, epoch: 5 | loss: 0.0250096
	speed: 0.0370s/iter; left time: 1656.7592s
	iters: 300, epoch: 5 | loss: 0.0871978
	speed: 0.0405s/iter; left time: 1811.3468s
	iters: 400, epoch: 5 | loss: 0.0092811
	speed: 0.0406s/iter; left time: 1812.4428s
Epoch: 5 cost time: 18.69089126586914
Epoch: 5, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2788448
	speed: 0.1711s/iter; left time: 7608.2657s
	iters: 200, epoch: 6 | loss: 0.3568777
	speed: 0.0394s/iter; left time: 1746.9167s
	iters: 300, epoch: 6 | loss: 0.0037610
	speed: 0.0390s/iter; left time: 1725.4915s
	iters: 400, epoch: 6 | loss: 0.0153673
	speed: 0.0356s/iter; left time: 1574.1023s
Epoch: 6 cost time: 18.479487419128418
Epoch: 6, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0850851
	speed: 0.1744s/iter; left time: 7670.6610s
	iters: 200, epoch: 7 | loss: 0.0343402
	speed: 0.0400s/iter; left time: 1754.0702s
	iters: 300, epoch: 7 | loss: 0.0169499
	speed: 0.0397s/iter; left time: 1739.9498s
	iters: 400, epoch: 7 | loss: 0.1017618
	speed: 0.0372s/iter; left time: 1623.6847s
Epoch: 7 cost time: 18.292561769485474
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0222132
	speed: 0.1573s/iter; left time: 6845.0210s
	iters: 200, epoch: 8 | loss: 0.0220220
	speed: 0.0353s/iter; left time: 1533.9999s
	iters: 300, epoch: 8 | loss: 0.3114793
	speed: 0.0348s/iter; left time: 1505.3057s
	iters: 400, epoch: 8 | loss: 0.4116322
	speed: 0.0373s/iter; left time: 1611.2613s
Epoch: 8 cost time: 17.550740718841553
Epoch: 8, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.962834 --> -0.969696).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1226257
	speed: 0.1478s/iter; left time: 6363.5474s
	iters: 200, epoch: 9 | loss: 0.1139444
	speed: 0.0377s/iter; left time: 1621.2784s
	iters: 300, epoch: 9 | loss: 0.0162474
	speed: 0.0359s/iter; left time: 1540.1801s
	iters: 400, epoch: 9 | loss: 0.0026925
	speed: 0.0359s/iter; left time: 1536.5799s
Epoch: 9 cost time: 17.4582257270813
Epoch: 9, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0053184
	speed: 0.1623s/iter; left time: 6911.0746s
	iters: 200, epoch: 10 | loss: 0.1873276
	speed: 0.0373s/iter; left time: 1582.7935s
	iters: 300, epoch: 10 | loss: 0.0005702
	speed: 0.0374s/iter; left time: 1585.9553s
	iters: 400, epoch: 10 | loss: 0.1489944
	speed: 0.0354s/iter; left time: 1498.7958s
Epoch: 10 cost time: 17.558542490005493
Epoch: 10, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2034521
	speed: 0.1433s/iter; left time: 6033.4108s
	iters: 200, epoch: 11 | loss: 0.1052380
	speed: 0.0339s/iter; left time: 1424.1473s
	iters: 300, epoch: 11 | loss: 0.0383874
	speed: 0.0334s/iter; left time: 1399.1357s
	iters: 400, epoch: 11 | loss: 0.0138147
	speed: 0.0351s/iter; left time: 1469.2732s
Epoch: 11 cost time: 16.646707773208618
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.934 Test Loss: 0.225 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0136326
	speed: 0.1380s/iter; left time: 5745.8057s
	iters: 200, epoch: 12 | loss: 0.0028636
	speed: 0.0361s/iter; left time: 1498.1397s
	iters: 300, epoch: 12 | loss: 0.2281939
	speed: 0.0354s/iter; left time: 1466.1073s
	iters: 400, epoch: 12 | loss: 0.0028384
	speed: 0.0329s/iter; left time: 1359.1035s
Epoch: 12 cost time: 16.39561414718628
Epoch: 12, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0596434
	speed: 0.1631s/iter; left time: 6713.4370s
	iters: 200, epoch: 13 | loss: 0.0004878
	speed: 0.0347s/iter; left time: 1424.2252s
	iters: 300, epoch: 13 | loss: 0.1805785
	speed: 0.0379s/iter; left time: 1552.3018s
	iters: 400, epoch: 13 | loss: 0.0110198
	speed: 0.0378s/iter; left time: 1543.1197s
Epoch: 13 cost time: 17.45371723175049
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0115494
	speed: 0.1578s/iter; left time: 6421.2928s
	iters: 200, epoch: 14 | loss: 0.0564288
	speed: 0.0343s/iter; left time: 1392.4994s
	iters: 300, epoch: 14 | loss: 0.0219084
	speed: 0.0327s/iter; left time: 1325.3038s
	iters: 400, epoch: 14 | loss: 0.0656936
	speed: 0.0368s/iter; left time: 1487.1728s
Epoch: 14 cost time: 17.300735235214233
Epoch: 14, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0079804
	speed: 0.1678s/iter; left time: 6752.4808s
	iters: 200, epoch: 15 | loss: 0.0042701
	speed: 0.0397s/iter; left time: 1593.1750s
	iters: 300, epoch: 15 | loss: 0.1192354
	speed: 0.0382s/iter; left time: 1528.5257s
	iters: 400, epoch: 15 | loss: 0.0036836
	speed: 0.0367s/iter; left time: 1466.1818s
Epoch: 15 cost time: 18.109696865081787
Epoch: 15, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1122330
	speed: 0.1741s/iter; left time: 6921.5140s
	iters: 200, epoch: 16 | loss: 0.0262946
	speed: 0.0373s/iter; left time: 1480.8604s
	iters: 300, epoch: 16 | loss: 0.1046535
	speed: 0.0397s/iter; left time: 1570.4369s
	iters: 400, epoch: 16 | loss: 0.0409125
	speed: 0.0378s/iter; left time: 1491.2386s
Epoch: 16 cost time: 18.34582018852234
Epoch: 16, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0408745
	speed: 0.1503s/iter; left time: 5907.0974s
	iters: 200, epoch: 17 | loss: 0.0032888
	speed: 0.0294s/iter; left time: 1152.1069s
	iters: 300, epoch: 17 | loss: 0.0154216
	speed: 0.0315s/iter; left time: 1229.6390s
	iters: 400, epoch: 17 | loss: 0.0125072
	speed: 0.0311s/iter; left time: 1214.0986s
Epoch: 17 cost time: 15.167827606201172
Epoch: 17, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2105622
	speed: 0.1341s/iter; left time: 5206.6973s
	iters: 200, epoch: 18 | loss: 0.0116016
	speed: 0.0361s/iter; left time: 1399.7858s
	iters: 300, epoch: 18 | loss: 0.0136510
	speed: 0.0346s/iter; left time: 1337.2701s
	iters: 400, epoch: 18 | loss: 0.1869460
	speed: 0.0355s/iter; left time: 1365.9038s
Epoch: 18 cost time: 17.371345043182373
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9696969696969697
model parameter : 1667758
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0195993
	speed: 0.0485s/iter; left time: 2272.0039s
	iters: 200, epoch: 1 | loss: 0.1898860
	speed: 0.0374s/iter; left time: 1748.8205s
	iters: 300, epoch: 1 | loss: 0.1259246
	speed: 0.0392s/iter; left time: 1826.8279s
	iters: 400, epoch: 1 | loss: 0.3517341
	speed: 0.0360s/iter; left time: 1675.5073s
Epoch: 1 cost time: 18.678811073303223
Epoch: 1, Steps: 469 | Train Loss: 0.554 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (inf --> -0.945967).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2522460
	speed: 0.1547s/iter; left time: 7167.5126s
	iters: 200, epoch: 2 | loss: 0.8007558
	speed: 0.0381s/iter; left time: 1761.0908s
	iters: 300, epoch: 2 | loss: 0.0553426
	speed: 0.0369s/iter; left time: 1700.3998s
	iters: 400, epoch: 2 | loss: 0.0276663
	speed: 0.0375s/iter; left time: 1724.5652s
Epoch: 2 cost time: 17.80115556716919
Epoch: 2, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1914770
	speed: 0.1558s/iter; left time: 7143.1660s
	iters: 200, epoch: 3 | loss: 0.2986844
	speed: 0.0378s/iter; left time: 1730.2711s
	iters: 300, epoch: 3 | loss: 0.0112726
	speed: 0.0382s/iter; left time: 1743.0378s
	iters: 400, epoch: 3 | loss: 0.0273656
	speed: 0.0377s/iter; left time: 1719.3190s
Epoch: 3 cost time: 18.065475702285767
Epoch: 3, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.945967 --> -0.951399).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0138855
	speed: 0.1577s/iter; left time: 7157.0287s
	iters: 200, epoch: 4 | loss: 0.0282557
	speed: 0.0364s/iter; left time: 1650.1586s
	iters: 300, epoch: 4 | loss: 0.2401439
	speed: 0.0358s/iter; left time: 1618.1234s
	iters: 400, epoch: 4 | loss: 0.0510414
	speed: 0.0383s/iter; left time: 1728.0266s
Epoch: 4 cost time: 17.93014907836914
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.951399 --> -0.956831).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5380591
	speed: 0.1529s/iter; left time: 6871.1043s
	iters: 200, epoch: 5 | loss: 0.0062821
	speed: 0.0383s/iter; left time: 1716.2088s
	iters: 300, epoch: 5 | loss: 0.1364984
	speed: 0.0374s/iter; left time: 1674.8264s
	iters: 400, epoch: 5 | loss: 0.0234300
	speed: 0.0371s/iter; left time: 1654.4526s
Epoch: 5 cost time: 18.214508295059204
Epoch: 5, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.203 Vali Acc: 0.942 Test Loss: 0.203 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0145359
	speed: 0.1682s/iter; left time: 7477.4732s
	iters: 200, epoch: 6 | loss: 0.0718181
	speed: 0.0417s/iter; left time: 1851.7584s
	iters: 300, epoch: 6 | loss: 0.0159790
	speed: 0.0420s/iter; left time: 1858.6920s
	iters: 400, epoch: 6 | loss: 0.0774099
	speed: 0.0388s/iter; left time: 1713.3567s
Epoch: 6 cost time: 19.202924251556396
Epoch: 6, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0155191
	speed: 0.1802s/iter; left time: 7928.0768s
	iters: 200, epoch: 7 | loss: 0.0160301
	speed: 0.0367s/iter; left time: 1612.8401s
	iters: 300, epoch: 7 | loss: 0.0890618
	speed: 0.0391s/iter; left time: 1713.9566s
	iters: 400, epoch: 7 | loss: 0.0283417
	speed: 0.0418s/iter; left time: 1825.9527s
Epoch: 7 cost time: 18.87809681892395
Epoch: 7, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4664109
	speed: 0.1787s/iter; left time: 7777.9196s
	iters: 200, epoch: 8 | loss: 0.0130178
	speed: 0.0379s/iter; left time: 1645.9532s
	iters: 300, epoch: 8 | loss: 0.0027949
	speed: 0.0397s/iter; left time: 1720.7602s
	iters: 400, epoch: 8 | loss: 0.0088604
	speed: 0.0396s/iter; left time: 1710.5574s
Epoch: 8 cost time: 18.905316591262817
Epoch: 8, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0208055
	speed: 0.1617s/iter; left time: 6961.8714s
	iters: 200, epoch: 9 | loss: 0.0037134
	speed: 0.0398s/iter; left time: 1709.6337s
	iters: 300, epoch: 9 | loss: 0.0741580
	speed: 0.0381s/iter; left time: 1632.5611s
	iters: 400, epoch: 9 | loss: 0.0012070
	speed: 0.0404s/iter; left time: 1725.5043s
Epoch: 9 cost time: 18.65973162651062
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0155302
	speed: 0.1620s/iter; left time: 6899.9718s
	iters: 200, epoch: 10 | loss: 0.0188344
	speed: 0.0394s/iter; left time: 1675.7896s
	iters: 300, epoch: 10 | loss: 0.1395985
	speed: 0.0392s/iter; left time: 1663.0111s
	iters: 400, epoch: 10 | loss: 0.0098222
	speed: 0.0371s/iter; left time: 1566.9060s
Epoch: 10 cost time: 18.37474012374878
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0219084
	speed: 0.1613s/iter; left time: 6790.4704s
	iters: 200, epoch: 11 | loss: 0.2276504
	speed: 0.0360s/iter; left time: 1512.5650s
	iters: 300, epoch: 11 | loss: 0.0121606
	speed: 0.0359s/iter; left time: 1502.6426s
	iters: 400, epoch: 11 | loss: 0.0014768
	speed: 0.0395s/iter; left time: 1652.4369s
Epoch: 11 cost time: 17.517444610595703
Epoch: 11, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2596914
	speed: 0.1519s/iter; left time: 6325.9953s
	iters: 200, epoch: 12 | loss: 0.0106336
	speed: 0.0369s/iter; left time: 1532.5419s
	iters: 300, epoch: 12 | loss: 0.1407081
	speed: 0.0371s/iter; left time: 1536.8186s
	iters: 400, epoch: 12 | loss: 0.0040686
	speed: 0.0382s/iter; left time: 1578.8857s
Epoch: 12 cost time: 17.949796199798584
Epoch: 12, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (-0.956831 --> -0.961405).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0193177
	speed: 0.1555s/iter; left time: 6401.5170s
	iters: 200, epoch: 13 | loss: 0.1081529
	speed: 0.0333s/iter; left time: 1366.8300s
	iters: 300, epoch: 13 | loss: 0.0100989
	speed: 0.0303s/iter; left time: 1241.6868s
	iters: 400, epoch: 13 | loss: 0.0015045
	speed: 0.0318s/iter; left time: 1300.1619s
Epoch: 13 cost time: 15.656643629074097
Epoch: 13, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.927 Test Loss: 0.284 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0248724
	speed: 0.1434s/iter; left time: 5836.2649s
	iters: 200, epoch: 14 | loss: 0.0560712
	speed: 0.0371s/iter; left time: 1504.9276s
	iters: 300, epoch: 14 | loss: 0.3275546
	speed: 0.0372s/iter; left time: 1506.7850s
	iters: 400, epoch: 14 | loss: 0.0979975
	speed: 0.0380s/iter; left time: 1533.3494s
Epoch: 14 cost time: 17.801602602005005
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.316 Vali Acc: 0.936 Test Loss: 0.316 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6557273
	speed: 0.1587s/iter; left time: 6386.5783s
	iters: 200, epoch: 15 | loss: 0.0056181
	speed: 0.0384s/iter; left time: 1540.5911s
	iters: 300, epoch: 15 | loss: 0.0417383
	speed: 0.0397s/iter; left time: 1588.8469s
	iters: 400, epoch: 15 | loss: 0.0040431
	speed: 0.0363s/iter; left time: 1450.1243s
Epoch: 15 cost time: 18.58799648284912
Epoch: 15, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0188787
	speed: 0.1801s/iter; left time: 7160.0868s
	iters: 200, epoch: 16 | loss: 0.0082008
	speed: 0.0416s/iter; left time: 1650.1295s
	iters: 300, epoch: 16 | loss: 0.6339176
	speed: 0.0412s/iter; left time: 1628.9011s
	iters: 400, epoch: 16 | loss: 0.1379122
	speed: 0.0386s/iter; left time: 1523.1216s
Epoch: 16 cost time: 18.9830584526062
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.961405 --> -0.964550).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0074771
	speed: 0.1805s/iter; left time: 7091.3915s
	iters: 200, epoch: 17 | loss: 0.0046094
	speed: 0.0405s/iter; left time: 1586.7472s
	iters: 300, epoch: 17 | loss: 0.0093573
	speed: 0.0405s/iter; left time: 1583.2527s
	iters: 400, epoch: 17 | loss: 0.1076170
	speed: 0.0388s/iter; left time: 1513.7906s
Epoch: 17 cost time: 18.81176781654358
Epoch: 17, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0336909
	speed: 0.1803s/iter; left time: 7002.2240s
	iters: 200, epoch: 18 | loss: 0.2592529
	speed: 0.0366s/iter; left time: 1416.2423s
	iters: 300, epoch: 18 | loss: 0.0492571
	speed: 0.0348s/iter; left time: 1344.9989s
	iters: 400, epoch: 18 | loss: 0.0151326
	speed: 0.0370s/iter; left time: 1424.1701s
Epoch: 18 cost time: 17.535860538482666
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.236 Vali Acc: 0.956 Test Loss: 0.236 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0100998
	speed: 0.1600s/iter; left time: 6137.5913s
	iters: 200, epoch: 19 | loss: 0.0199144
	speed: 0.0400s/iter; left time: 1531.6567s
	iters: 300, epoch: 19 | loss: 0.1790969
	speed: 0.0370s/iter; left time: 1411.2515s
	iters: 400, epoch: 19 | loss: 0.0198347
	speed: 0.0374s/iter; left time: 1423.7344s
Epoch: 19 cost time: 18.021417140960693
Epoch: 19, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0873552
	speed: 0.1547s/iter; left time: 5861.0246s
	iters: 200, epoch: 20 | loss: 0.0333327
	speed: 0.0373s/iter; left time: 1407.8504s
	iters: 300, epoch: 20 | loss: 0.0111366
	speed: 0.0364s/iter; left time: 1372.3154s
	iters: 400, epoch: 20 | loss: 0.2689781
	speed: 0.0355s/iter; left time: 1336.0034s
Epoch: 20 cost time: 17.604819536209106
Epoch: 20, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0034225
	speed: 0.1590s/iter; left time: 5948.5412s
	iters: 200, epoch: 21 | loss: 0.1737905
	speed: 0.0373s/iter; left time: 1392.1645s
	iters: 300, epoch: 21 | loss: 0.0098092
	speed: 0.0376s/iter; left time: 1400.5603s
	iters: 400, epoch: 21 | loss: 0.0021443
	speed: 0.0378s/iter; left time: 1401.3859s
Epoch: 21 cost time: 18.023943185806274
Epoch: 21, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
Validation loss decreased (-0.964550 --> -0.965979).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0791254
	speed: 0.1614s/iter; left time: 5963.7807s
	iters: 200, epoch: 22 | loss: 0.0134018
	speed: 0.0376s/iter; left time: 1386.1936s
	iters: 300, epoch: 22 | loss: 0.7085394
	speed: 0.0383s/iter; left time: 1407.9274s
	iters: 400, epoch: 22 | loss: 0.0029471
	speed: 0.0350s/iter; left time: 1284.2560s
Epoch: 22 cost time: 17.57551622390747
Epoch: 22, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0237264
	speed: 0.1509s/iter; left time: 5507.1012s
	iters: 200, epoch: 23 | loss: 0.0012889
	speed: 0.0345s/iter; left time: 1254.6458s
	iters: 300, epoch: 23 | loss: 0.0133599
	speed: 0.0405s/iter; left time: 1471.0094s
	iters: 400, epoch: 23 | loss: 0.1496720
	speed: 0.0385s/iter; left time: 1393.1780s
Epoch: 23 cost time: 17.6481831073761
Epoch: 23, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2734785
	speed: 0.1644s/iter; left time: 5920.6344s
	iters: 200, epoch: 24 | loss: 0.0772441
	speed: 0.0361s/iter; left time: 1294.8773s
	iters: 300, epoch: 24 | loss: 0.0066081
	speed: 0.0376s/iter; left time: 1347.0575s
	iters: 400, epoch: 24 | loss: 0.0062807
	speed: 0.0383s/iter; left time: 1368.4020s
Epoch: 24 cost time: 17.972805976867676
Epoch: 24, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0396545
	speed: 0.1581s/iter; left time: 5621.1835s
	iters: 200, epoch: 25 | loss: 0.0015210
	speed: 0.0411s/iter; left time: 1456.4142s
	iters: 300, epoch: 25 | loss: 0.0080192
	speed: 0.0392s/iter; left time: 1383.9388s
	iters: 400, epoch: 25 | loss: 0.0666515
	speed: 0.0383s/iter; left time: 1349.2935s
Epoch: 25 cost time: 18.601428747177124
Epoch: 25, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0058111
	speed: 0.1748s/iter; left time: 6131.7604s
	iters: 200, epoch: 26 | loss: 0.4308477
	speed: 0.0409s/iter; left time: 1430.1213s
	iters: 300, epoch: 26 | loss: 0.1839288
	speed: 0.0398s/iter; left time: 1389.6093s
	iters: 400, epoch: 26 | loss: 0.0236723
	speed: 0.0389s/iter; left time: 1354.2823s
Epoch: 26 cost time: 18.766942501068115
Epoch: 26, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0143581
	speed: 0.1854s/iter; left time: 6414.5505s
	iters: 200, epoch: 27 | loss: 0.0255326
	speed: 0.0374s/iter; left time: 1292.0410s
	iters: 300, epoch: 27 | loss: 0.1432154
	speed: 0.0397s/iter; left time: 1366.1855s
	iters: 400, epoch: 27 | loss: 0.0043787
	speed: 0.0406s/iter; left time: 1393.2677s
Epoch: 27 cost time: 18.884857654571533
Epoch: 27, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0028250
	speed: 0.1551s/iter; left time: 5295.8651s
	iters: 200, epoch: 28 | loss: 0.0158132
	speed: 0.0368s/iter; left time: 1252.6863s
	iters: 300, epoch: 28 | loss: 0.0043847
	speed: 0.0362s/iter; left time: 1229.8919s
	iters: 400, epoch: 28 | loss: 0.0519817
	speed: 0.0386s/iter; left time: 1304.5975s
Epoch: 28 cost time: 18.07009267807007
Epoch: 28, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0117989
	speed: 0.1595s/iter; left time: 5371.3711s
	iters: 200, epoch: 29 | loss: 0.0062615
	speed: 0.0335s/iter; left time: 1125.1799s
	iters: 300, epoch: 29 | loss: 0.1605410
	speed: 0.0291s/iter; left time: 974.0122s
	iters: 400, epoch: 29 | loss: 0.2331429
	speed: 0.0292s/iter; left time: 972.7446s
Epoch: 29 cost time: 14.79387092590332
Epoch: 29, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.965979 --> -0.971411).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0056260
	speed: 0.1225s/iter; left time: 4065.4908s
	iters: 200, epoch: 30 | loss: 0.0014730
	speed: 0.0385s/iter; left time: 1273.3449s
	iters: 300, epoch: 30 | loss: 0.0007817
	speed: 0.0400s/iter; left time: 1320.1968s
	iters: 400, epoch: 30 | loss: 0.0032305
	speed: 0.0385s/iter; left time: 1266.7346s
Epoch: 30 cost time: 18.68325448036194
Epoch: 30, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.1650278
	speed: 0.1569s/iter; left time: 5135.2992s
	iters: 200, epoch: 31 | loss: 0.0269082
	speed: 0.0381s/iter; left time: 1244.3395s
	iters: 300, epoch: 31 | loss: 0.0951221
	speed: 0.0375s/iter; left time: 1219.7444s
	iters: 400, epoch: 31 | loss: 0.0206233
	speed: 0.0381s/iter; left time: 1236.8541s
Epoch: 31 cost time: 17.710225343704224
Epoch: 31, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0385051
	speed: 0.1580s/iter; left time: 5097.6513s
	iters: 200, epoch: 32 | loss: 0.0089325
	speed: 0.0345s/iter; left time: 1110.1949s
	iters: 300, epoch: 32 | loss: 0.6454632
	speed: 0.0383s/iter; left time: 1227.7188s
	iters: 400, epoch: 32 | loss: 0.0556166
	speed: 0.0377s/iter; left time: 1204.0341s
Epoch: 32 cost time: 17.76951265335083
Epoch: 32, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.284 Vali Acc: 0.940 Test Loss: 0.284 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0182165
	speed: 0.1645s/iter; left time: 5229.4070s
	iters: 200, epoch: 33 | loss: 0.0454213
	speed: 0.0378s/iter; left time: 1197.6172s
	iters: 300, epoch: 33 | loss: 0.0063967
	speed: 0.0395s/iter; left time: 1249.3619s
	iters: 400, epoch: 33 | loss: 0.1965961
	speed: 0.0383s/iter; left time: 1207.2953s
Epoch: 33 cost time: 18.211543083190918
Epoch: 33, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0163255
	speed: 0.1538s/iter; left time: 4817.1932s
	iters: 200, epoch: 34 | loss: 0.0456997
	speed: 0.0398s/iter; left time: 1241.8192s
	iters: 300, epoch: 34 | loss: 0.0771117
	speed: 0.0374s/iter; left time: 1164.2690s
	iters: 400, epoch: 34 | loss: 0.0066121
	speed: 0.0404s/iter; left time: 1254.6948s
Epoch: 34 cost time: 18.99974513053894
Epoch: 34, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0242777
	speed: 0.1850s/iter; left time: 5709.5049s
	iters: 200, epoch: 35 | loss: 0.0156924
	speed: 0.0409s/iter; left time: 1256.6191s
	iters: 300, epoch: 35 | loss: 0.0095009
	speed: 0.0390s/iter; left time: 1195.5390s
	iters: 400, epoch: 35 | loss: 0.0110072
	speed: 0.0377s/iter; left time: 1152.7237s
Epoch: 35 cost time: 18.722750663757324
Epoch: 35, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0532067
	speed: 0.1792s/iter; left time: 5446.0299s
	iters: 200, epoch: 36 | loss: 0.0588938
	speed: 0.0387s/iter; left time: 1173.1953s
	iters: 300, epoch: 36 | loss: 0.0007756
	speed: 0.0412s/iter; left time: 1244.9688s
	iters: 400, epoch: 36 | loss: 0.0174507
	speed: 0.0393s/iter; left time: 1181.6025s
Epoch: 36 cost time: 18.729989767074585
Epoch: 36, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971983).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0176954
	speed: 0.1677s/iter; left time: 5017.7947s
	iters: 200, epoch: 37 | loss: 0.0042946
	speed: 0.0367s/iter; left time: 1095.0050s
	iters: 300, epoch: 37 | loss: 0.0452867
	speed: 0.0367s/iter; left time: 1089.6190s
	iters: 400, epoch: 37 | loss: 0.2041131
	speed: 0.0381s/iter; left time: 1128.5765s
Epoch: 37 cost time: 17.733532428741455
Epoch: 37, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0091376
	speed: 0.1568s/iter; left time: 4618.7929s
	iters: 200, epoch: 38 | loss: 0.0184710
	speed: 0.0400s/iter; left time: 1173.6447s
	iters: 300, epoch: 38 | loss: 0.2542027
	speed: 0.0412s/iter; left time: 1205.3184s
	iters: 400, epoch: 38 | loss: 0.0122525
	speed: 0.0399s/iter; left time: 1162.4762s
Epoch: 38 cost time: 19.109455108642578
Epoch: 38, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0163658
	speed: 0.1577s/iter; left time: 4569.2206s
	iters: 200, epoch: 39 | loss: 0.0265900
	speed: 0.0407s/iter; left time: 1175.0291s
	iters: 300, epoch: 39 | loss: 0.0070969
	speed: 0.0366s/iter; left time: 1052.4419s
	iters: 400, epoch: 39 | loss: 0.4845762
	speed: 0.0365s/iter; left time: 1046.2575s
Epoch: 39 cost time: 18.097020626068115
Epoch: 39, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.974556).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.1371008
	speed: 0.1604s/iter; left time: 4574.3927s
	iters: 200, epoch: 40 | loss: 0.4166933
	speed: 0.0386s/iter; left time: 1096.4436s
	iters: 300, epoch: 40 | loss: 0.0027175
	speed: 0.0378s/iter; left time: 1070.1493s
	iters: 400, epoch: 40 | loss: 0.1678746
	speed: 0.0375s/iter; left time: 1057.6663s
Epoch: 40 cost time: 17.896786212921143
Epoch: 40, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0010031
	speed: 0.1521s/iter; left time: 4263.6732s
	iters: 200, epoch: 41 | loss: 0.0242046
	speed: 0.0369s/iter; left time: 1030.3396s
	iters: 300, epoch: 41 | loss: 0.0056212
	speed: 0.0394s/iter; left time: 1095.6507s
	iters: 400, epoch: 41 | loss: 0.0138471
	speed: 0.0366s/iter; left time: 1014.1971s
Epoch: 41 cost time: 17.655678510665894
Epoch: 41, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.0553123
	speed: 0.1582s/iter; left time: 4361.3795s
	iters: 200, epoch: 42 | loss: 0.0014661
	speed: 0.0378s/iter; left time: 1039.7906s
	iters: 300, epoch: 42 | loss: 0.1951270
	speed: 0.0385s/iter; left time: 1052.8951s
	iters: 400, epoch: 42 | loss: 0.0126929
	speed: 0.0384s/iter; left time: 1048.4633s
Epoch: 42 cost time: 18.28531265258789
Epoch: 42, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0010283
	speed: 0.1559s/iter; left time: 4224.3184s
	iters: 200, epoch: 43 | loss: 0.1262611
	speed: 0.0388s/iter; left time: 1049.0102s
	iters: 300, epoch: 43 | loss: 0.0747829
	speed: 0.0363s/iter; left time: 975.9339s
	iters: 400, epoch: 43 | loss: 0.0211517
	speed: 0.0378s/iter; left time: 1013.0133s
Epoch: 43 cost time: 18.08013391494751
Epoch: 43, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.0207557
	speed: 0.1628s/iter; left time: 4335.5541s
	iters: 200, epoch: 44 | loss: 0.0014574
	speed: 0.0422s/iter; left time: 1119.8312s
	iters: 300, epoch: 44 | loss: 0.0004372
	speed: 0.0397s/iter; left time: 1048.7795s
	iters: 400, epoch: 44 | loss: 0.0055634
	speed: 0.0394s/iter; left time: 1037.7462s
Epoch: 44 cost time: 19.082898378372192
Epoch: 44, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.0068522
	speed: 0.1834s/iter; left time: 4799.0860s
	iters: 200, epoch: 45 | loss: 0.0050276
	speed: 0.0401s/iter; left time: 1044.8642s
	iters: 300, epoch: 45 | loss: 0.0013754
	speed: 0.0409s/iter; left time: 1062.6340s
	iters: 400, epoch: 45 | loss: 0.0172826
	speed: 0.0391s/iter; left time: 1011.0980s
Epoch: 45 cost time: 18.70180654525757
Epoch: 45, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.343 Vali Acc: 0.940 Test Loss: 0.343 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.0007326
	speed: 0.1728s/iter; left time: 4440.4258s
	iters: 200, epoch: 46 | loss: 0.0001435
	speed: 0.0383s/iter; left time: 981.3007s
	iters: 300, epoch: 46 | loss: 0.0040046
	speed: 0.0387s/iter; left time: 986.2142s
	iters: 400, epoch: 46 | loss: 0.1208533
	speed: 0.0408s/iter; left time: 1037.3549s
Epoch: 46 cost time: 18.50002956390381
Epoch: 46, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.219 Vali Acc: 0.961 Test Loss: 0.219 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.0064942
	speed: 0.1618s/iter; left time: 4080.8268s
	iters: 200, epoch: 47 | loss: 0.0043251
	speed: 0.0367s/iter; left time: 921.1560s
	iters: 300, epoch: 47 | loss: 0.0022328
	speed: 0.0361s/iter; left time: 903.8675s
	iters: 400, epoch: 47 | loss: 0.0016106
	speed: 0.0366s/iter; left time: 911.8175s
Epoch: 47 cost time: 17.731767892837524
Epoch: 47, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.0004808
	speed: 0.1501s/iter; left time: 3716.2904s
	iters: 200, epoch: 48 | loss: 0.0224869
	speed: 0.0377s/iter; left time: 930.1875s
	iters: 300, epoch: 48 | loss: 0.0212664
	speed: 0.0352s/iter; left time: 864.9800s
	iters: 400, epoch: 48 | loss: 0.0083414
	speed: 0.0355s/iter; left time: 868.4089s
Epoch: 48 cost time: 16.827415466308594
Epoch: 48, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.0191483
	speed: 0.1518s/iter; left time: 3687.1204s
	iters: 200, epoch: 49 | loss: 0.0334902
	speed: 0.0383s/iter; left time: 927.5360s
	iters: 300, epoch: 49 | loss: 0.0002557
	speed: 0.0378s/iter; left time: 911.2640s
	iters: 400, epoch: 49 | loss: 0.0109710
	speed: 0.0362s/iter; left time: 868.1020s
Epoch: 49 cost time: 17.5434672832489
Epoch: 49, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.953 Test Loss: 0.254 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 1504046
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6147808
	speed: 0.0518s/iter; left time: 2426.4729s
	iters: 200, epoch: 1 | loss: 0.2393314
	speed: 0.0359s/iter; left time: 1674.8331s
	iters: 300, epoch: 1 | loss: 0.5179516
	speed: 0.0406s/iter; left time: 1894.2453s
	iters: 400, epoch: 1 | loss: 0.1330347
	speed: 0.0388s/iter; left time: 1804.6580s
Epoch: 1 cost time: 19.260451793670654
Epoch: 1, Steps: 469 | Train Loss: 0.595 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
Validation loss decreased (inf --> -0.919380).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0463386
	speed: 0.1572s/iter; left time: 7283.1610s
	iters: 200, epoch: 2 | loss: 0.1569553
	speed: 0.0376s/iter; left time: 1740.5455s
	iters: 300, epoch: 2 | loss: 0.1201717
	speed: 0.0352s/iter; left time: 1622.3320s
	iters: 400, epoch: 2 | loss: 0.0181722
	speed: 0.0369s/iter; left time: 1700.7829s
Epoch: 2 cost time: 18.040300607681274
Epoch: 2, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.199 Vali Acc: 0.940 Test Loss: 0.199 Test Acc: 0.940
Validation loss decreased (-0.919380 --> -0.939678).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0342067
	speed: 0.1554s/iter; left time: 7127.4295s
	iters: 200, epoch: 3 | loss: 0.1736434
	speed: 0.0391s/iter; left time: 1789.7785s
	iters: 300, epoch: 3 | loss: 0.0761726
	speed: 0.0368s/iter; left time: 1682.5306s
	iters: 400, epoch: 3 | loss: 0.0251874
	speed: 0.0354s/iter; left time: 1613.4381s
Epoch: 3 cost time: 18.17475199699402
Epoch: 3, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.939678 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0166586
	speed: 0.1528s/iter; left time: 6935.1739s
	iters: 200, epoch: 4 | loss: 0.0117731
	speed: 0.0406s/iter; left time: 1837.2498s
	iters: 300, epoch: 4 | loss: 0.0311355
	speed: 0.0409s/iter; left time: 1850.3285s
	iters: 400, epoch: 4 | loss: 0.0491022
	speed: 0.0389s/iter; left time: 1754.9054s
Epoch: 4 cost time: 18.761008501052856
Epoch: 4, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0318276
	speed: 0.1458s/iter; left time: 6550.0141s
	iters: 200, epoch: 5 | loss: 0.0073031
	speed: 0.0332s/iter; left time: 1488.2661s
	iters: 300, epoch: 5 | loss: 0.1158671
	speed: 0.0343s/iter; left time: 1536.0034s
	iters: 400, epoch: 5 | loss: 0.0114208
	speed: 0.0317s/iter; left time: 1413.5505s
Epoch: 5 cost time: 16.71018147468567
Epoch: 5, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
Validation loss decreased (-0.957117 --> -0.960833).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0747002
	speed: 0.1813s/iter; left time: 8057.8123s
	iters: 200, epoch: 6 | loss: 0.0644080
	speed: 0.0413s/iter; left time: 1832.8636s
	iters: 300, epoch: 6 | loss: 0.0512397
	speed: 0.0418s/iter; left time: 1848.8839s
	iters: 400, epoch: 6 | loss: 0.0507295
	speed: 0.0408s/iter; left time: 1801.7083s
Epoch: 6 cost time: 19.456294536590576
Epoch: 6, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0318643
	speed: 0.1691s/iter; left time: 7437.7856s
	iters: 200, epoch: 7 | loss: 0.4062562
	speed: 0.0358s/iter; left time: 1571.8808s
	iters: 300, epoch: 7 | loss: 0.0053360
	speed: 0.0384s/iter; left time: 1680.7647s
	iters: 400, epoch: 7 | loss: 0.0666655
	speed: 0.0386s/iter; left time: 1686.2887s
Epoch: 7 cost time: 17.59982419013977
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0955489
	speed: 0.1451s/iter; left time: 6313.0849s
	iters: 200, epoch: 8 | loss: 0.0071783
	speed: 0.0374s/iter; left time: 1623.0882s
	iters: 300, epoch: 8 | loss: 0.5121550
	speed: 0.0335s/iter; left time: 1452.7844s
	iters: 400, epoch: 8 | loss: 0.0397506
	speed: 0.0381s/iter; left time: 1644.5648s
Epoch: 8 cost time: 17.289244890213013
Epoch: 8, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.960833 --> -0.963692).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0562790
	speed: 0.1524s/iter; left time: 6560.9074s
	iters: 200, epoch: 9 | loss: 0.4023033
	speed: 0.0380s/iter; left time: 1633.7624s
	iters: 300, epoch: 9 | loss: 0.0026991
	speed: 0.0365s/iter; left time: 1564.3603s
	iters: 400, epoch: 9 | loss: 0.1300930
	speed: 0.0377s/iter; left time: 1611.0943s
Epoch: 9 cost time: 17.89066457748413
Epoch: 9, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.963692 --> -0.967409).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4524708
	speed: 0.1560s/iter; left time: 6641.1390s
	iters: 200, epoch: 10 | loss: 0.0017444
	speed: 0.0398s/iter; left time: 1691.8396s
	iters: 300, epoch: 10 | loss: 0.1782412
	speed: 0.0391s/iter; left time: 1657.6953s
	iters: 400, epoch: 10 | loss: 0.2059674
	speed: 0.0368s/iter; left time: 1554.3633s
Epoch: 10 cost time: 18.050480365753174
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0629927
	speed: 0.1606s/iter; left time: 6761.1824s
	iters: 200, epoch: 11 | loss: 0.0218245
	speed: 0.0354s/iter; left time: 1487.2222s
	iters: 300, epoch: 11 | loss: 0.0511452
	speed: 0.0382s/iter; left time: 1598.9638s
	iters: 400, epoch: 11 | loss: 0.4795516
	speed: 0.0373s/iter; left time: 1559.4697s
Epoch: 11 cost time: 17.78937339782715
Epoch: 11, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3650849
	speed: 0.1657s/iter; left time: 6899.7541s
	iters: 200, epoch: 12 | loss: 0.0028010
	speed: 0.0382s/iter; left time: 1586.7619s
	iters: 300, epoch: 12 | loss: 0.0042611
	speed: 0.0392s/iter; left time: 1622.5186s
	iters: 400, epoch: 12 | loss: 0.0034995
	speed: 0.0372s/iter; left time: 1536.4081s
Epoch: 12 cost time: 18.09648084640503
Epoch: 12, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.220 Vali Acc: 0.945 Test Loss: 0.220 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0090796
	speed: 0.1539s/iter; left time: 6337.2014s
	iters: 200, epoch: 13 | loss: 0.0107797
	speed: 0.0375s/iter; left time: 1540.2349s
	iters: 300, epoch: 13 | loss: 0.0297393
	speed: 0.0361s/iter; left time: 1477.7300s
	iters: 400, epoch: 13 | loss: 0.0032445
	speed: 0.0393s/iter; left time: 1605.7366s
Epoch: 13 cost time: 17.89885663986206
Epoch: 13, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2437741
	speed: 0.1624s/iter; left time: 6611.6607s
	iters: 200, epoch: 14 | loss: 0.0177409
	speed: 0.0403s/iter; left time: 1635.3659s
	iters: 300, epoch: 14 | loss: 0.0062125
	speed: 0.0389s/iter; left time: 1575.2400s
	iters: 400, epoch: 14 | loss: 0.0282510
	speed: 0.0401s/iter; left time: 1621.0152s
Epoch: 14 cost time: 19.06566047668457
Epoch: 14, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0032954
	speed: 0.1731s/iter; left time: 6966.3174s
	iters: 200, epoch: 15 | loss: 0.0106940
	speed: 0.0406s/iter; left time: 1630.6692s
	iters: 300, epoch: 15 | loss: 0.0014359
	speed: 0.0382s/iter; left time: 1527.3966s
	iters: 400, epoch: 15 | loss: 0.0982964
	speed: 0.0412s/iter; left time: 1645.4350s
Epoch: 15 cost time: 19.106600046157837
Epoch: 15, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0093387
	speed: 0.1780s/iter; left time: 7076.6159s
	iters: 200, epoch: 16 | loss: 0.0073067
	speed: 0.0401s/iter; left time: 1591.7219s
	iters: 300, epoch: 16 | loss: 0.0364948
	speed: 0.0401s/iter; left time: 1586.9865s
	iters: 400, epoch: 16 | loss: 0.0031219
	speed: 0.0394s/iter; left time: 1554.6932s
Epoch: 16 cost time: 18.928242683410645
Epoch: 16, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.4660776
	speed: 0.1598s/iter; left time: 6277.8412s
	iters: 200, epoch: 17 | loss: 0.0151093
	speed: 0.0382s/iter; left time: 1497.9299s
	iters: 300, epoch: 17 | loss: 0.0064237
	speed: 0.0377s/iter; left time: 1472.6169s
	iters: 400, epoch: 17 | loss: 0.0019032
	speed: 0.0389s/iter; left time: 1518.5287s
Epoch: 17 cost time: 17.93807888031006
Epoch: 17, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2742708
	speed: 0.1432s/iter; left time: 5559.9323s
	iters: 200, epoch: 18 | loss: 0.0879438
	speed: 0.0336s/iter; left time: 1301.1875s
	iters: 300, epoch: 18 | loss: 0.0018115
	speed: 0.0350s/iter; left time: 1350.6997s
	iters: 400, epoch: 18 | loss: 0.0084845
	speed: 0.0313s/iter; left time: 1207.1322s
Epoch: 18 cost time: 15.909916400909424
Epoch: 18, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0266898
	speed: 0.1474s/iter; left time: 5654.2720s
	iters: 200, epoch: 19 | loss: 0.1296798
	speed: 0.0381s/iter; left time: 1457.7737s
	iters: 300, epoch: 19 | loss: 0.0007726
	speed: 0.0402s/iter; left time: 1533.0131s
	iters: 400, epoch: 19 | loss: 0.0186854
	speed: 0.0381s/iter; left time: 1451.3842s
Epoch: 19 cost time: 18.308123350143433
Epoch: 19, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.967409 --> -0.967695).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0035722
	speed: 0.1587s/iter; left time: 6013.2413s
	iters: 200, epoch: 20 | loss: 0.0019137
	speed: 0.0360s/iter; left time: 1359.9744s
	iters: 300, epoch: 20 | loss: 0.0004454
	speed: 0.0378s/iter; left time: 1426.2059s
	iters: 400, epoch: 20 | loss: 0.0236554
	speed: 0.0381s/iter; left time: 1433.5855s
Epoch: 20 cost time: 17.81937003135681
Epoch: 20, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.333 Vali Acc: 0.929 Test Loss: 0.333 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0046498
	speed: 0.1539s/iter; left time: 5760.0628s
	iters: 200, epoch: 21 | loss: 0.1897902
	speed: 0.0378s/iter; left time: 1412.3272s
	iters: 300, epoch: 21 | loss: 0.0020974
	speed: 0.0344s/iter; left time: 1280.1927s
	iters: 400, epoch: 21 | loss: 0.0648822
	speed: 0.0363s/iter; left time: 1347.9259s
Epoch: 21 cost time: 17.642544984817505
Epoch: 21, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0123897
	speed: 0.1567s/iter; left time: 5789.6971s
	iters: 200, epoch: 22 | loss: 0.0026871
	speed: 0.0382s/iter; left time: 1407.8674s
	iters: 300, epoch: 22 | loss: 0.0052998
	speed: 0.0375s/iter; left time: 1377.8261s
	iters: 400, epoch: 22 | loss: 0.1340295
	speed: 0.0360s/iter; left time: 1320.4978s
Epoch: 22 cost time: 17.955729722976685
Epoch: 22, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.967695 --> -0.970267).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1671088
	speed: 0.1594s/iter; left time: 5815.3511s
	iters: 200, epoch: 23 | loss: 0.0376809
	speed: 0.0393s/iter; left time: 1428.7297s
	iters: 300, epoch: 23 | loss: 0.1492728
	speed: 0.0387s/iter; left time: 1405.9523s
	iters: 400, epoch: 23 | loss: 0.1985948
	speed: 0.0407s/iter; left time: 1472.9897s
Epoch: 23 cost time: 18.469518661499023
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0037419
	speed: 0.1760s/iter; left time: 6337.9574s
	iters: 200, epoch: 24 | loss: 0.0439380
	speed: 0.0384s/iter; left time: 1378.3455s
	iters: 300, epoch: 24 | loss: 0.0093620
	speed: 0.0389s/iter; left time: 1391.9394s
	iters: 400, epoch: 24 | loss: 0.0295966
	speed: 0.0403s/iter; left time: 1437.6820s
Epoch: 24 cost time: 18.712730169296265
Epoch: 24, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.187 Vali Acc: 0.947 Test Loss: 0.187 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0004277
	speed: 0.1811s/iter; left time: 6438.8398s
	iters: 200, epoch: 25 | loss: 0.0310177
	speed: 0.0392s/iter; left time: 1389.0927s
	iters: 300, epoch: 25 | loss: 0.1474691
	speed: 0.0415s/iter; left time: 1465.6249s
	iters: 400, epoch: 25 | loss: 0.1827895
	speed: 0.0421s/iter; left time: 1482.9527s
Epoch: 25 cost time: 19.476628303527832
Epoch: 25, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.243 Vali Acc: 0.940 Test Loss: 0.243 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0948641
	speed: 0.1717s/iter; left time: 6021.5658s
	iters: 200, epoch: 26 | loss: 0.0018344
	speed: 0.0366s/iter; left time: 1279.0904s
	iters: 300, epoch: 26 | loss: 0.0252103
	speed: 0.0360s/iter; left time: 1256.3618s
	iters: 400, epoch: 26 | loss: 0.0037183
	speed: 0.0391s/iter; left time: 1361.2617s
Epoch: 26 cost time: 18.031225204467773
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0041163
	speed: 0.1532s/iter; left time: 5300.5755s
	iters: 200, epoch: 27 | loss: 0.0811424
	speed: 0.0373s/iter; left time: 1287.3346s
	iters: 300, epoch: 27 | loss: 0.0077901
	speed: 0.0370s/iter; left time: 1273.3132s
	iters: 400, epoch: 27 | loss: 0.7443722
	speed: 0.0367s/iter; left time: 1258.2694s
Epoch: 27 cost time: 17.56588578224182
Epoch: 27, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.3417336
	speed: 0.1544s/iter; left time: 5272.0424s
	iters: 200, epoch: 28 | loss: 0.0054754
	speed: 0.0397s/iter; left time: 1349.7042s
	iters: 300, epoch: 28 | loss: 0.0167573
	speed: 0.0371s/iter; left time: 1259.8119s
	iters: 400, epoch: 28 | loss: 0.0250834
	speed: 0.0379s/iter; left time: 1282.8975s
Epoch: 28 cost time: 18.020352125167847
Epoch: 28, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0010237
	speed: 0.1601s/iter; left time: 5392.0661s
	iters: 200, epoch: 29 | loss: 0.0101042
	speed: 0.0387s/iter; left time: 1299.0573s
	iters: 300, epoch: 29 | loss: 0.0102284
	speed: 0.0373s/iter; left time: 1249.3748s
	iters: 400, epoch: 29 | loss: 0.0905232
	speed: 0.0368s/iter; left time: 1226.8903s
Epoch: 29 cost time: 17.850626945495605
Epoch: 29, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0009163
	speed: 0.1578s/iter; left time: 5239.7279s
	iters: 200, epoch: 30 | loss: 0.0002238
	speed: 0.0376s/iter; left time: 1245.3956s
	iters: 300, epoch: 30 | loss: 0.0018581
	speed: 0.0381s/iter; left time: 1258.1809s
	iters: 400, epoch: 30 | loss: 0.0014251
	speed: 0.0384s/iter; left time: 1263.6858s
Epoch: 30 cost time: 18.12078022956848
Epoch: 30, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.1092909
	speed: 0.1579s/iter; left time: 5168.5419s
	iters: 200, epoch: 31 | loss: 0.0012916
	speed: 0.0362s/iter; left time: 1181.5935s
	iters: 300, epoch: 31 | loss: 1.2308702
	speed: 0.0389s/iter; left time: 1264.8057s
	iters: 400, epoch: 31 | loss: 0.1013669
	speed: 0.0351s/iter; left time: 1138.0354s
Epoch: 31 cost time: 17.4657039642334
Epoch: 31, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0039471
	speed: 0.1307s/iter; left time: 4217.3746s
	iters: 200, epoch: 32 | loss: 0.0344106
	speed: 0.0301s/iter; left time: 968.7848s
	iters: 300, epoch: 32 | loss: 0.3032026
	speed: 0.0323s/iter; left time: 1035.8200s
	iters: 400, epoch: 32 | loss: 0.5450578
	speed: 0.0320s/iter; left time: 1024.3629s
Epoch: 32 cost time: 15.481245040893555
Epoch: 32, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 1503790
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7209848
	speed: 0.0504s/iter; left time: 2358.2386s
	iters: 200, epoch: 1 | loss: 0.5012927
	speed: 0.0393s/iter; left time: 1834.5149s
	iters: 300, epoch: 1 | loss: 0.4447630
	speed: 0.0414s/iter; left time: 1928.3122s
	iters: 400, epoch: 1 | loss: 0.0674317
	speed: 0.0379s/iter; left time: 1760.2340s
Epoch: 1 cost time: 19.527456521987915
Epoch: 1, Steps: 469 | Train Loss: 0.543 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
Validation loss decreased (inf --> -0.929672).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0991799
	speed: 0.1730s/iter; left time: 8017.2088s
	iters: 200, epoch: 2 | loss: 0.1621245
	speed: 0.0402s/iter; left time: 1859.5293s
	iters: 300, epoch: 2 | loss: 0.0239646
	speed: 0.0400s/iter; left time: 1846.5326s
	iters: 400, epoch: 2 | loss: 0.2692724
	speed: 0.0401s/iter; left time: 1845.3049s
Epoch: 2 cost time: 19.26038694381714
Epoch: 2, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.929672 --> -0.934818).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0917660
	speed: 0.1711s/iter; left time: 7848.7794s
	iters: 200, epoch: 3 | loss: 0.0526252
	speed: 0.0424s/iter; left time: 1941.9699s
	iters: 300, epoch: 3 | loss: 0.1878868
	speed: 0.0403s/iter; left time: 1839.9959s
	iters: 400, epoch: 3 | loss: 0.0627061
	speed: 0.0422s/iter; left time: 1921.6920s
Epoch: 3 cost time: 19.89408826828003
Epoch: 3, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.269 Vali Acc: 0.927 Test Loss: 0.269 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0513746
	speed: 0.1675s/iter; left time: 7604.3140s
	iters: 200, epoch: 4 | loss: 0.0183833
	speed: 0.0380s/iter; left time: 1720.0962s
	iters: 300, epoch: 4 | loss: 0.0380293
	speed: 0.0343s/iter; left time: 1550.8110s
	iters: 400, epoch: 4 | loss: 0.1185890
	speed: 0.0344s/iter; left time: 1550.1661s
Epoch: 4 cost time: 17.29044198989868
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.934818 --> -0.950255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0093521
	speed: 0.1579s/iter; left time: 7093.0896s
	iters: 200, epoch: 5 | loss: 0.1904471
	speed: 0.0380s/iter; left time: 1701.9623s
	iters: 300, epoch: 5 | loss: 0.0026057
	speed: 0.0377s/iter; left time: 1686.4167s
	iters: 400, epoch: 5 | loss: 0.0261515
	speed: 0.0362s/iter; left time: 1614.3277s
Epoch: 5 cost time: 17.971423864364624
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0076332
	speed: 0.1443s/iter; left time: 6414.8551s
	iters: 200, epoch: 6 | loss: 0.2654040
	speed: 0.0365s/iter; left time: 1618.3255s
	iters: 300, epoch: 6 | loss: 0.1248369
	speed: 0.0392s/iter; left time: 1734.9536s
	iters: 400, epoch: 6 | loss: 0.1263398
	speed: 0.0364s/iter; left time: 1606.1398s
Epoch: 6 cost time: 17.22693705558777
Epoch: 6, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.326 Vali Acc: 0.912 Test Loss: 0.326 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0115886
	speed: 0.1615s/iter; left time: 7103.5674s
	iters: 200, epoch: 7 | loss: 0.0162636
	speed: 0.0373s/iter; left time: 1635.3420s
	iters: 300, epoch: 7 | loss: 0.0444024
	speed: 0.0365s/iter; left time: 1596.1008s
	iters: 400, epoch: 7 | loss: 0.0008698
	speed: 0.0352s/iter; left time: 1539.9280s
Epoch: 7 cost time: 17.38027834892273
Epoch: 7, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0356017
	speed: 0.1537s/iter; left time: 6686.9355s
	iters: 200, epoch: 8 | loss: 0.1138361
	speed: 0.0379s/iter; left time: 1646.5915s
	iters: 300, epoch: 8 | loss: 0.0216566
	speed: 0.0379s/iter; left time: 1641.9571s
	iters: 400, epoch: 8 | loss: 0.1596784
	speed: 0.0360s/iter; left time: 1556.6809s
Epoch: 8 cost time: 17.815975189208984
Epoch: 8, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0407987
	speed: 0.1579s/iter; left time: 6799.1493s
	iters: 200, epoch: 9 | loss: 0.2033726
	speed: 0.0369s/iter; left time: 1583.9263s
	iters: 300, epoch: 9 | loss: 0.0318818
	speed: 0.0376s/iter; left time: 1611.4874s
	iters: 400, epoch: 9 | loss: 0.0477432
	speed: 0.0372s/iter; left time: 1591.8813s
Epoch: 9 cost time: 17.60181999206543
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.950255 --> -0.951113).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4161938
	speed: 0.1625s/iter; left time: 6918.4982s
	iters: 200, epoch: 10 | loss: 0.0252520
	speed: 0.0373s/iter; left time: 1584.8501s
	iters: 300, epoch: 10 | loss: 0.0211307
	speed: 0.0410s/iter; left time: 1738.0566s
	iters: 400, epoch: 10 | loss: 0.0169252
	speed: 0.0404s/iter; left time: 1706.7469s
Epoch: 10 cost time: 18.797398328781128
Epoch: 10, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.951113 --> -0.957117).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0240849
	speed: 0.1523s/iter; left time: 6412.0708s
	iters: 200, epoch: 11 | loss: 0.2509912
	speed: 0.0348s/iter; left time: 1461.0988s
	iters: 300, epoch: 11 | loss: 0.0742792
	speed: 0.0372s/iter; left time: 1559.2233s
	iters: 400, epoch: 11 | loss: 0.0077545
	speed: 0.0393s/iter; left time: 1644.0623s
Epoch: 11 cost time: 17.925400495529175
Epoch: 11, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0026478
	speed: 0.1774s/iter; left time: 7387.7278s
	iters: 200, epoch: 12 | loss: 0.0196570
	speed: 0.0390s/iter; left time: 1621.4204s
	iters: 300, epoch: 12 | loss: 0.8186740
	speed: 0.0411s/iter; left time: 1704.3945s
	iters: 400, epoch: 12 | loss: 0.0083699
	speed: 0.0394s/iter; left time: 1627.4397s
Epoch: 12 cost time: 19.5080828666687
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0085930
	speed: 0.1672s/iter; left time: 6885.3089s
	iters: 200, epoch: 13 | loss: 0.0089801
	speed: 0.0408s/iter; left time: 1675.0209s
	iters: 300, epoch: 13 | loss: 0.4049416
	speed: 0.0418s/iter; left time: 1710.9086s
	iters: 400, epoch: 13 | loss: 0.1508583
	speed: 0.0426s/iter; left time: 1741.7244s
Epoch: 13 cost time: 19.834394693374634
Epoch: 13, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.957117 --> -0.963406).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0248959
	speed: 0.1728s/iter; left time: 7033.6685s
	iters: 200, epoch: 14 | loss: 0.0046368
	speed: 0.0415s/iter; left time: 1685.4274s
	iters: 300, epoch: 14 | loss: 0.1479510
	speed: 0.0396s/iter; left time: 1602.2431s
	iters: 400, epoch: 14 | loss: 0.0110142
	speed: 0.0351s/iter; left time: 1417.3999s
Epoch: 14 cost time: 18.40293788909912
Epoch: 14, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.963406 --> -0.971983).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0085558
	speed: 0.1511s/iter; left time: 6078.6437s
	iters: 200, epoch: 15 | loss: 0.0283569
	speed: 0.0405s/iter; left time: 1626.3921s
	iters: 300, epoch: 15 | loss: 0.1295265
	speed: 0.0409s/iter; left time: 1635.4621s
	iters: 400, epoch: 15 | loss: 0.2776172
	speed: 0.0408s/iter; left time: 1628.3776s
Epoch: 15 cost time: 19.04682683944702
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1027270
	speed: 0.1570s/iter; left time: 6242.4154s
	iters: 200, epoch: 16 | loss: 0.3956554
	speed: 0.0384s/iter; left time: 1522.2636s
	iters: 300, epoch: 16 | loss: 0.0146634
	speed: 0.0386s/iter; left time: 1528.6115s
	iters: 400, epoch: 16 | loss: 0.0012102
	speed: 0.0388s/iter; left time: 1529.6070s
Epoch: 16 cost time: 18.09736943244934
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1319584
	speed: 0.1573s/iter; left time: 6181.3633s
	iters: 200, epoch: 17 | loss: 0.0044920
	speed: 0.0399s/iter; left time: 1562.1855s
	iters: 300, epoch: 17 | loss: 0.0013166
	speed: 0.0424s/iter; left time: 1656.7607s
	iters: 400, epoch: 17 | loss: 0.0642406
	speed: 0.0376s/iter; left time: 1467.3481s
Epoch: 17 cost time: 18.59186625480652
Epoch: 17, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0005930
	speed: 0.1619s/iter; left time: 6286.4294s
	iters: 200, epoch: 18 | loss: 0.0108693
	speed: 0.0380s/iter; left time: 1472.3519s
	iters: 300, epoch: 18 | loss: 0.0156510
	speed: 0.0392s/iter; left time: 1513.3452s
	iters: 400, epoch: 18 | loss: 0.0048615
	speed: 0.0373s/iter; left time: 1435.7087s
Epoch: 18 cost time: 17.984195232391357
Epoch: 18, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0043177
	speed: 0.1549s/iter; left time: 5942.4678s
	iters: 200, epoch: 19 | loss: 0.0115731
	speed: 0.0343s/iter; left time: 1314.1139s
	iters: 300, epoch: 19 | loss: 0.0489716
	speed: 0.0313s/iter; left time: 1195.8279s
	iters: 400, epoch: 19 | loss: 0.0104355
	speed: 0.0312s/iter; left time: 1187.4668s
Epoch: 19 cost time: 16.15463376045227
Epoch: 19, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0362167
	speed: 0.1119s/iter; left time: 4239.7985s
	iters: 200, epoch: 20 | loss: 0.0032544
	speed: 0.0374s/iter; left time: 1413.6643s
	iters: 300, epoch: 20 | loss: 0.0039325
	speed: 0.0365s/iter; left time: 1377.4880s
	iters: 400, epoch: 20 | loss: 0.4947756
	speed: 0.0353s/iter; left time: 1328.3316s
Epoch: 20 cost time: 17.055619478225708
Epoch: 20, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.261 Vali Acc: 0.942 Test Loss: 0.261 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1556619
	speed: 0.1566s/iter; left time: 5860.4686s
	iters: 200, epoch: 21 | loss: 0.0100856
	speed: 0.0393s/iter; left time: 1466.0192s
	iters: 300, epoch: 21 | loss: 0.0011739
	speed: 0.0403s/iter; left time: 1500.2082s
	iters: 400, epoch: 21 | loss: 0.0866538
	speed: 0.0392s/iter; left time: 1455.4003s
Epoch: 21 cost time: 18.6513512134552
Epoch: 21, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1736186
	speed: 0.1723s/iter; left time: 6366.7708s
	iters: 200, epoch: 22 | loss: 0.0084044
	speed: 0.0386s/iter; left time: 1422.9838s
	iters: 300, epoch: 22 | loss: 0.0188115
	speed: 0.0385s/iter; left time: 1416.3964s
	iters: 400, epoch: 22 | loss: 0.0194508
	speed: 0.0411s/iter; left time: 1506.9492s
Epoch: 22 cost time: 18.73189401626587
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0285492
	speed: 0.1695s/iter; left time: 6185.4480s
	iters: 200, epoch: 23 | loss: 0.0066824
	speed: 0.0396s/iter; left time: 1441.3686s
	iters: 300, epoch: 23 | loss: 0.0882104
	speed: 0.0412s/iter; left time: 1495.9378s
	iters: 400, epoch: 23 | loss: 0.0371026
	speed: 0.0400s/iter; left time: 1447.7703s
Epoch: 23 cost time: 19.065221548080444
Epoch: 23, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0148063
	speed: 0.1579s/iter; left time: 5685.7588s
	iters: 200, epoch: 24 | loss: 0.0532664
	speed: 0.0377s/iter; left time: 1355.5737s
	iters: 300, epoch: 24 | loss: 0.0146607
	speed: 0.0376s/iter; left time: 1348.0608s
	iters: 400, epoch: 24 | loss: 0.0856850
	speed: 0.0348s/iter; left time: 1241.9782s
Epoch: 24 cost time: 17.867043495178223
Epoch: 24, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 1503534
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8156063
	speed: 0.0463s/iter; left time: 2168.7536s
	iters: 200, epoch: 1 | loss: 0.2170265
	speed: 0.0381s/iter; left time: 1779.3562s
	iters: 300, epoch: 1 | loss: 0.1865946
	speed: 0.0362s/iter; left time: 1686.6216s
	iters: 400, epoch: 1 | loss: 0.2906515
	speed: 0.0351s/iter; left time: 1631.9810s
Epoch: 1 cost time: 18.006909132003784
Epoch: 1, Steps: 469 | Train Loss: 0.580 Vali Loss: 0.244 Vali Acc: 0.929 Test Loss: 0.244 Test Acc: 0.929
Validation loss decreased (inf --> -0.928528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1400574
	speed: 0.1572s/iter; left time: 7281.2113s
	iters: 200, epoch: 2 | loss: 0.0826432
	speed: 0.0391s/iter; left time: 1805.7476s
	iters: 300, epoch: 2 | loss: 0.0989517
	speed: 0.0392s/iter; left time: 1807.0526s
	iters: 400, epoch: 2 | loss: 0.0645409
	speed: 0.0366s/iter; left time: 1682.5757s
Epoch: 2 cost time: 17.81853485107422
Epoch: 2, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
Validation loss decreased (-0.928528 --> -0.937962).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2074251
	speed: 0.1502s/iter; left time: 6886.4585s
	iters: 200, epoch: 3 | loss: 0.0056592
	speed: 0.0384s/iter; left time: 1758.9953s
	iters: 300, epoch: 3 | loss: 0.1538408
	speed: 0.0372s/iter; left time: 1699.6794s
	iters: 400, epoch: 3 | loss: 0.0360614
	speed: 0.0371s/iter; left time: 1689.8348s
Epoch: 3 cost time: 17.618968725204468
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.937962 --> -0.941393).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0126146
	speed: 0.1522s/iter; left time: 6906.9222s
	iters: 200, epoch: 4 | loss: 0.1095081
	speed: 0.0386s/iter; left time: 1747.6437s
	iters: 300, epoch: 4 | loss: 0.0931777
	speed: 0.0377s/iter; left time: 1705.6387s
	iters: 400, epoch: 4 | loss: 0.2662597
	speed: 0.0391s/iter; left time: 1765.3279s
Epoch: 4 cost time: 17.725061655044556
Epoch: 4, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.941393 --> -0.950541).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2643050
	speed: 0.1558s/iter; left time: 6999.5587s
	iters: 200, epoch: 5 | loss: 0.0203286
	speed: 0.0365s/iter; left time: 1636.2306s
	iters: 300, epoch: 5 | loss: 0.0355756
	speed: 0.0374s/iter; left time: 1671.6983s
	iters: 400, epoch: 5 | loss: 0.0189689
	speed: 0.0395s/iter; left time: 1760.5391s
Epoch: 5 cost time: 17.91400933265686
Epoch: 5, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0336020
	speed: 0.1529s/iter; left time: 6797.0026s
	iters: 200, epoch: 6 | loss: 0.0247715
	speed: 0.0381s/iter; left time: 1687.8860s
	iters: 300, epoch: 6 | loss: 0.2332180
	speed: 0.0379s/iter; left time: 1675.2433s
	iters: 400, epoch: 6 | loss: 0.0071331
	speed: 0.0370s/iter; left time: 1631.7258s
Epoch: 6 cost time: 18.052780389785767
Epoch: 6, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.950541 --> -0.950541).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0023045
	speed: 0.1692s/iter; left time: 7442.5193s
	iters: 200, epoch: 7 | loss: 0.0625550
	speed: 0.0390s/iter; left time: 1710.3080s
	iters: 300, epoch: 7 | loss: 0.0107725
	speed: 0.0388s/iter; left time: 1700.6478s
	iters: 400, epoch: 7 | loss: 0.0539619
	speed: 0.0390s/iter; left time: 1703.3532s
Epoch: 7 cost time: 18.601638078689575
Epoch: 7, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.222 Vali Acc: 0.938 Test Loss: 0.222 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0196421
	speed: 0.1721s/iter; left time: 7487.5691s
	iters: 200, epoch: 8 | loss: 0.0016680
	speed: 0.0416s/iter; left time: 1805.7460s
	iters: 300, epoch: 8 | loss: 0.0511319
	speed: 0.0409s/iter; left time: 1771.2368s
	iters: 400, epoch: 8 | loss: 0.0419626
	speed: 0.0389s/iter; left time: 1682.4072s
Epoch: 8 cost time: 19.065613985061646
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.950541 --> -0.959118).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0166749
	speed: 0.1724s/iter; left time: 7422.1421s
	iters: 200, epoch: 9 | loss: 0.0165080
	speed: 0.0379s/iter; left time: 1626.5589s
	iters: 300, epoch: 9 | loss: 0.0035400
	speed: 0.0394s/iter; left time: 1688.5940s
	iters: 400, epoch: 9 | loss: 0.0029937
	speed: 0.0381s/iter; left time: 1627.8811s
Epoch: 9 cost time: 17.7134747505188
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6763886
	speed: 0.1628s/iter; left time: 6933.1801s
	iters: 200, epoch: 10 | loss: 0.0018521
	speed: 0.0371s/iter; left time: 1578.1155s
	iters: 300, epoch: 10 | loss: 0.0043080
	speed: 0.0385s/iter; left time: 1632.9511s
	iters: 400, epoch: 10 | loss: 0.2515381
	speed: 0.0377s/iter; left time: 1595.8064s
Epoch: 10 cost time: 17.908126831054688
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.959118 --> -0.963120).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0028070
	speed: 0.1554s/iter; left time: 6543.8913s
	iters: 200, epoch: 11 | loss: 0.1511475
	speed: 0.0341s/iter; left time: 1432.8707s
	iters: 300, epoch: 11 | loss: 0.0911734
	speed: 0.0329s/iter; left time: 1379.4142s
	iters: 400, epoch: 11 | loss: 0.1643875
	speed: 0.0293s/iter; left time: 1224.5313s
Epoch: 11 cost time: 15.397708177566528
Epoch: 11, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (-0.963120 --> -0.963692).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0525745
	speed: 0.1041s/iter; left time: 4333.4083s
	iters: 200, epoch: 12 | loss: 0.0145116
	speed: 0.0367s/iter; left time: 1524.1584s
	iters: 300, epoch: 12 | loss: 0.0209883
	speed: 0.0384s/iter; left time: 1589.4344s
	iters: 400, epoch: 12 | loss: 0.0382345
	speed: 0.0373s/iter; left time: 1541.3594s
Epoch: 12 cost time: 17.252174377441406
Epoch: 12, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.330 Vali Acc: 0.916 Test Loss: 0.330 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0040707
	speed: 0.1590s/iter; left time: 6544.4609s
	iters: 200, epoch: 13 | loss: 0.0069610
	speed: 0.0355s/iter; left time: 1459.4594s
	iters: 300, epoch: 13 | loss: 0.0053587
	speed: 0.0361s/iter; left time: 1479.3273s
	iters: 400, epoch: 13 | loss: 0.0160385
	speed: 0.0373s/iter; left time: 1523.0383s
Epoch: 13 cost time: 17.464343309402466
Epoch: 13, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0051373
	speed: 0.1491s/iter; left time: 6066.9986s
	iters: 200, epoch: 14 | loss: 0.0496543
	speed: 0.0391s/iter; left time: 1587.6000s
	iters: 300, epoch: 14 | loss: 0.0214364
	speed: 0.0372s/iter; left time: 1507.6429s
	iters: 400, epoch: 14 | loss: 0.0061039
	speed: 0.0400s/iter; left time: 1614.3188s
Epoch: 14 cost time: 18.246952533721924
Epoch: 14, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0014126
	speed: 0.1586s/iter; left time: 6381.0810s
	iters: 200, epoch: 15 | loss: 0.1904485
	speed: 0.0362s/iter; left time: 1453.7523s
	iters: 300, epoch: 15 | loss: 0.0051513
	speed: 0.0343s/iter; left time: 1374.3300s
	iters: 400, epoch: 15 | loss: 0.0138890
	speed: 0.0369s/iter; left time: 1471.8885s
Epoch: 15 cost time: 17.50045156478882
Epoch: 15, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.963692 --> -0.967122).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0387285
	speed: 0.1691s/iter; left time: 6724.4875s
	iters: 200, epoch: 16 | loss: 0.0054487
	speed: 0.0421s/iter; left time: 1671.4964s
	iters: 300, epoch: 16 | loss: 0.0016008
	speed: 0.0386s/iter; left time: 1527.9996s
	iters: 400, epoch: 16 | loss: 0.0109900
	speed: 0.0394s/iter; left time: 1553.8555s
Epoch: 16 cost time: 19.000603437423706
Epoch: 16, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0103881
	speed: 0.1718s/iter; left time: 6749.6068s
	iters: 200, epoch: 17 | loss: 0.7195525
	speed: 0.0407s/iter; left time: 1595.8261s
	iters: 300, epoch: 17 | loss: 0.0024269
	speed: 0.0380s/iter; left time: 1487.5629s
	iters: 400, epoch: 17 | loss: 0.2158820
	speed: 0.0379s/iter; left time: 1477.1785s
Epoch: 17 cost time: 18.380879402160645
Epoch: 17, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.924 Test Loss: 0.285 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0119662
	speed: 0.1712s/iter; left time: 6647.5745s
	iters: 200, epoch: 18 | loss: 0.1075075
	speed: 0.0406s/iter; left time: 1572.1593s
	iters: 300, epoch: 18 | loss: 0.0008165
	speed: 0.0401s/iter; left time: 1547.5361s
	iters: 400, epoch: 18 | loss: 0.0041247
	speed: 0.0391s/iter; left time: 1507.3608s
Epoch: 18 cost time: 18.829289197921753
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0430159
	speed: 0.1561s/iter; left time: 5987.2354s
	iters: 200, epoch: 19 | loss: 0.0030469
	speed: 0.0361s/iter; left time: 1380.8104s
	iters: 300, epoch: 19 | loss: 0.0045436
	speed: 0.0379s/iter; left time: 1444.4296s
	iters: 400, epoch: 19 | loss: 0.0085507
	speed: 0.0367s/iter; left time: 1395.5980s
Epoch: 19 cost time: 17.630688905715942
Epoch: 19, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0029789
	speed: 0.1594s/iter; left time: 6040.3121s
	iters: 200, epoch: 20 | loss: 0.0535267
	speed: 0.0359s/iter; left time: 1355.8718s
	iters: 300, epoch: 20 | loss: 0.0051481
	speed: 0.0365s/iter; left time: 1375.0158s
	iters: 400, epoch: 20 | loss: 0.0007752
	speed: 0.0376s/iter; left time: 1412.4414s
Epoch: 20 cost time: 17.63985013961792
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967122 --> -0.967695).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0619360
	speed: 0.1608s/iter; left time: 6018.9682s
	iters: 200, epoch: 21 | loss: 0.0230040
	speed: 0.0368s/iter; left time: 1374.8005s
	iters: 300, epoch: 21 | loss: 0.0292455
	speed: 0.0372s/iter; left time: 1385.8873s
	iters: 400, epoch: 21 | loss: 0.0808049
	speed: 0.0382s/iter; left time: 1417.3983s
Epoch: 21 cost time: 17.943983793258667
Epoch: 21, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.967695 --> -0.968266).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0105033
	speed: 0.1590s/iter; left time: 5875.3253s
	iters: 200, epoch: 22 | loss: 0.0023861
	speed: 0.0375s/iter; left time: 1381.3542s
	iters: 300, epoch: 22 | loss: 0.1396819
	speed: 0.0372s/iter; left time: 1367.6696s
	iters: 400, epoch: 22 | loss: 0.0158451
	speed: 0.0383s/iter; left time: 1404.4601s
Epoch: 22 cost time: 18.073134899139404
Epoch: 22, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0184636
	speed: 0.1472s/iter; left time: 5369.1962s
	iters: 200, epoch: 23 | loss: 0.0058221
	speed: 0.0382s/iter; left time: 1390.3462s
	iters: 300, epoch: 23 | loss: 0.0134836
	speed: 0.0378s/iter; left time: 1370.9324s
	iters: 400, epoch: 23 | loss: 0.0329150
	speed: 0.0351s/iter; left time: 1270.9916s
Epoch: 23 cost time: 17.7338285446167
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.286 Vali Acc: 0.949 Test Loss: 0.286 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1939852
	speed: 0.1551s/iter; left time: 5587.0532s
	iters: 200, epoch: 24 | loss: 0.0070661
	speed: 0.0368s/iter; left time: 1321.0980s
	iters: 300, epoch: 24 | loss: 0.0733110
	speed: 0.0373s/iter; left time: 1334.6483s
	iters: 400, epoch: 24 | loss: 0.0128821
	speed: 0.0325s/iter; left time: 1161.3245s
Epoch: 24 cost time: 17.34829330444336
Epoch: 24, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0024541
	speed: 0.1517s/iter; left time: 5393.4676s
	iters: 200, epoch: 25 | loss: 0.0993775
	speed: 0.0375s/iter; left time: 1327.8445s
	iters: 300, epoch: 25 | loss: 0.0007982
	speed: 0.0361s/iter; left time: 1276.7059s
	iters: 400, epoch: 25 | loss: 0.0017010
	speed: 0.0379s/iter; left time: 1336.8295s
Epoch: 25 cost time: 17.788246393203735
Epoch: 25, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0603344
	speed: 0.1771s/iter; left time: 6213.3372s
	iters: 200, epoch: 26 | loss: 0.0695910
	speed: 0.0398s/iter; left time: 1392.8739s
	iters: 300, epoch: 26 | loss: 0.0441250
	speed: 0.0393s/iter; left time: 1370.8474s
	iters: 400, epoch: 26 | loss: 0.0016559
	speed: 0.0373s/iter; left time: 1298.0329s
Epoch: 26 cost time: 18.29158115386963
Epoch: 26, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0040236
	speed: 0.1679s/iter; left time: 5810.2444s
	iters: 200, epoch: 27 | loss: 0.1202389
	speed: 0.0361s/iter; left time: 1247.0373s
	iters: 300, epoch: 27 | loss: 0.0058321
	speed: 0.0382s/iter; left time: 1313.3552s
	iters: 400, epoch: 27 | loss: 0.3018761
	speed: 0.0385s/iter; left time: 1321.6109s
Epoch: 27 cost time: 17.9240243434906
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0211452
	speed: 0.1711s/iter; left time: 5841.1300s
	iters: 200, epoch: 28 | loss: 0.0071988
	speed: 0.0375s/iter; left time: 1275.4771s
	iters: 300, epoch: 28 | loss: 0.0330266
	speed: 0.0353s/iter; left time: 1196.4022s
	iters: 400, epoch: 28 | loss: 0.0053309
	speed: 0.0364s/iter; left time: 1231.3099s
Epoch: 28 cost time: 17.68288516998291
Epoch: 28, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0264709
	speed: 0.1563s/iter; left time: 5262.5587s
	iters: 200, epoch: 29 | loss: 0.0186153
	speed: 0.0347s/iter; left time: 1165.6363s
	iters: 300, epoch: 29 | loss: 0.0033199
	speed: 0.0362s/iter; left time: 1212.6320s
	iters: 400, epoch: 29 | loss: 0.1607594
	speed: 0.0347s/iter; left time: 1157.8788s
Epoch: 29 cost time: 16.837016582489014
Epoch: 29, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0142575
	speed: 0.1315s/iter; left time: 4366.8214s
	iters: 200, epoch: 30 | loss: 0.0316465
	speed: 0.0334s/iter; left time: 1104.2797s
	iters: 300, epoch: 30 | loss: 0.0129304
	speed: 0.0352s/iter; left time: 1160.5247s
	iters: 400, epoch: 30 | loss: 0.0236069
	speed: 0.0338s/iter; left time: 1112.6026s
Epoch: 30 cost time: 16.490251064300537
Epoch: 30, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0241703
	speed: 0.1503s/iter; left time: 4920.9631s
	iters: 200, epoch: 31 | loss: 0.1484056
	speed: 0.0321s/iter; left time: 1048.5238s
	iters: 300, epoch: 31 | loss: 0.0518540
	speed: 0.0374s/iter; left time: 1217.4335s
	iters: 400, epoch: 31 | loss: 0.0070323
	speed: 0.0381s/iter; left time: 1234.7608s
Epoch: 31 cost time: 17.67011857032776
Epoch: 31, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9682675814751286
model parameter : 1503278
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9087853
	speed: 0.0505s/iter; left time: 2364.6553s
	iters: 200, epoch: 1 | loss: 0.4847946
	speed: 0.0336s/iter; left time: 1567.1115s
	iters: 300, epoch: 1 | loss: 0.1323184
	speed: 0.0355s/iter; left time: 1654.9296s
	iters: 400, epoch: 1 | loss: 0.1946398
	speed: 0.0401s/iter; left time: 1862.9956s
Epoch: 1 cost time: 18.40283179283142
Epoch: 1, Steps: 469 | Train Loss: 0.628 Vali Loss: 0.250 Vali Acc: 0.924 Test Loss: 0.250 Test Acc: 0.924
Validation loss decreased (inf --> -0.923668).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2186910
	speed: 0.1406s/iter; left time: 6513.9324s
	iters: 200, epoch: 2 | loss: 0.1412304
	speed: 0.0365s/iter; left time: 1689.6786s
	iters: 300, epoch: 2 | loss: 0.1997833
	speed: 0.0377s/iter; left time: 1740.2616s
	iters: 400, epoch: 2 | loss: 0.0782750
	speed: 0.0362s/iter; left time: 1664.8892s
Epoch: 2 cost time: 17.50824284553528
Epoch: 2, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.208 Vali Acc: 0.936 Test Loss: 0.208 Test Acc: 0.936
Validation loss decreased (-0.923668 --> -0.936247).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0141570
	speed: 0.1625s/iter; left time: 7452.0112s
	iters: 200, epoch: 3 | loss: 0.1892234
	speed: 0.0382s/iter; left time: 1747.6199s
	iters: 300, epoch: 3 | loss: 0.0451443
	speed: 0.0394s/iter; left time: 1799.6129s
	iters: 400, epoch: 3 | loss: 0.0175761
	speed: 0.0369s/iter; left time: 1680.0956s
Epoch: 3 cost time: 18.437646865844727
Epoch: 3, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.290 Vali Acc: 0.918 Test Loss: 0.290 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0169439
	speed: 0.1671s/iter; left time: 7587.5005s
	iters: 200, epoch: 4 | loss: 0.0341828
	speed: 0.0408s/iter; left time: 1847.9650s
	iters: 300, epoch: 4 | loss: 0.0071894
	speed: 0.0399s/iter; left time: 1805.1592s
	iters: 400, epoch: 4 | loss: 0.0139470
	speed: 0.0398s/iter; left time: 1794.7336s
Epoch: 4 cost time: 18.833890914916992
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
Validation loss decreased (-0.936247 --> -0.953400).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0359775
	speed: 0.1797s/iter; left time: 8071.8071s
	iters: 200, epoch: 5 | loss: 0.0018536
	speed: 0.0399s/iter; left time: 1789.7209s
	iters: 300, epoch: 5 | loss: 0.0159670
	speed: 0.0389s/iter; left time: 1739.1189s
	iters: 400, epoch: 5 | loss: 0.2989756
	speed: 0.0377s/iter; left time: 1683.6371s
Epoch: 5 cost time: 18.631192445755005
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0702429
	speed: 0.1745s/iter; left time: 7756.8708s
	iters: 200, epoch: 6 | loss: 0.3308173
	speed: 0.0391s/iter; left time: 1733.9791s
	iters: 300, epoch: 6 | loss: 0.0169730
	speed: 0.0394s/iter; left time: 1744.2027s
	iters: 400, epoch: 6 | loss: 0.0349030
	speed: 0.0383s/iter; left time: 1690.8565s
Epoch: 6 cost time: 18.710434913635254
Epoch: 6, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0173932
	speed: 0.1646s/iter; left time: 7238.6433s
	iters: 200, epoch: 7 | loss: 0.0018016
	speed: 0.0375s/iter; left time: 1647.0371s
	iters: 300, epoch: 7 | loss: 0.1383493
	speed: 0.0394s/iter; left time: 1723.2434s
	iters: 400, epoch: 7 | loss: 0.1184229
	speed: 0.0377s/iter; left time: 1647.1561s
Epoch: 7 cost time: 18.121814966201782
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0061186
	speed: 0.1615s/iter; left time: 7030.2840s
	iters: 200, epoch: 8 | loss: 0.0151078
	speed: 0.0397s/iter; left time: 1724.5942s
	iters: 300, epoch: 8 | loss: 0.0722801
	speed: 0.0389s/iter; left time: 1685.9149s
	iters: 400, epoch: 8 | loss: 0.0080390
	speed: 0.0348s/iter; left time: 1502.8701s
Epoch: 8 cost time: 17.76794147491455
Epoch: 8, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.953400 --> -0.953972).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2176268
	speed: 0.1552s/iter; left time: 6679.2624s
	iters: 200, epoch: 9 | loss: 0.0044768
	speed: 0.0362s/iter; left time: 1556.8839s
	iters: 300, epoch: 9 | loss: 0.0037989
	speed: 0.0381s/iter; left time: 1632.0024s
	iters: 400, epoch: 9 | loss: 0.0136836
	speed: 0.0364s/iter; left time: 1555.5993s
Epoch: 9 cost time: 17.769178867340088
Epoch: 9, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.953972 --> -0.966837).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0096584
	speed: 0.1579s/iter; left time: 6724.6588s
	iters: 200, epoch: 10 | loss: 0.0069033
	speed: 0.0361s/iter; left time: 1534.0775s
	iters: 300, epoch: 10 | loss: 0.0295457
	speed: 0.0364s/iter; left time: 1544.6275s
	iters: 400, epoch: 10 | loss: 0.0198661
	speed: 0.0363s/iter; left time: 1535.9651s
Epoch: 10 cost time: 17.45763373374939
Epoch: 10, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0256459
	speed: 0.1592s/iter; left time: 6705.6457s
	iters: 200, epoch: 11 | loss: 0.5988441
	speed: 0.0372s/iter; left time: 1563.9509s
	iters: 300, epoch: 11 | loss: 0.0081228
	speed: 0.0354s/iter; left time: 1482.4350s
	iters: 400, epoch: 11 | loss: 0.0582937
	speed: 0.0322s/iter; left time: 1344.3856s
Epoch: 11 cost time: 16.94312024116516
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1985141
	speed: 0.1207s/iter; left time: 5025.5403s
	iters: 200, epoch: 12 | loss: 0.0185888
	speed: 0.0347s/iter; left time: 1442.4311s
	iters: 300, epoch: 12 | loss: 0.0046626
	speed: 0.0361s/iter; left time: 1497.3191s
	iters: 400, epoch: 12 | loss: 0.0036262
	speed: 0.0349s/iter; left time: 1442.5038s
Epoch: 12 cost time: 16.64638924598694
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.299 Vali Acc: 0.928 Test Loss: 0.299 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0340102
	speed: 0.1677s/iter; left time: 6904.3378s
	iters: 200, epoch: 13 | loss: 0.0346662
	speed: 0.0375s/iter; left time: 1542.2557s
	iters: 300, epoch: 13 | loss: 0.1386260
	speed: 0.0403s/iter; left time: 1649.5307s
	iters: 400, epoch: 13 | loss: 0.0097142
	speed: 0.0384s/iter; left time: 1569.6536s
Epoch: 13 cost time: 18.342084407806396
Epoch: 13, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0111376
	speed: 0.1737s/iter; left time: 7069.4141s
	iters: 200, epoch: 14 | loss: 0.0982548
	speed: 0.0390s/iter; left time: 1582.8559s
	iters: 300, epoch: 14 | loss: 0.5468825
	speed: 0.0377s/iter; left time: 1528.2778s
	iters: 400, epoch: 14 | loss: 0.0107569
	speed: 0.0383s/iter; left time: 1546.3319s
Epoch: 14 cost time: 18.43716287612915
Epoch: 14, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0179758
	speed: 0.1682s/iter; left time: 6766.7984s
	iters: 200, epoch: 15 | loss: 0.0129700
	speed: 0.0381s/iter; left time: 1528.5392s
	iters: 300, epoch: 15 | loss: 0.1952354
	speed: 0.0383s/iter; left time: 1534.0580s
	iters: 400, epoch: 15 | loss: 0.0163907
	speed: 0.0368s/iter; left time: 1471.1357s
Epoch: 15 cost time: 17.968878030776978
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0487867
	speed: 0.1556s/iter; left time: 6186.8255s
	iters: 200, epoch: 16 | loss: 0.0005317
	speed: 0.0374s/iter; left time: 1483.9409s
	iters: 300, epoch: 16 | loss: 0.0878351
	speed: 0.0376s/iter; left time: 1486.8846s
	iters: 400, epoch: 16 | loss: 0.0018575
	speed: 0.0355s/iter; left time: 1400.6057s
Epoch: 16 cost time: 17.419772148132324
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.233 Vali Acc: 0.940 Test Loss: 0.233 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0038037
	speed: 0.1402s/iter; left time: 5508.2563s
	iters: 200, epoch: 17 | loss: 0.0352427
	speed: 0.0350s/iter; left time: 1371.2886s
	iters: 300, epoch: 17 | loss: 0.0671416
	speed: 0.0356s/iter; left time: 1393.3740s
	iters: 400, epoch: 17 | loss: 0.0232126
	speed: 0.0381s/iter; left time: 1484.7241s
Epoch: 17 cost time: 16.941509008407593
Epoch: 17, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.239 Vali Acc: 0.936 Test Loss: 0.239 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0019429
	speed: 0.1512s/iter; left time: 5871.3847s
	iters: 200, epoch: 18 | loss: 0.0044570
	speed: 0.0384s/iter; left time: 1487.7122s
	iters: 300, epoch: 18 | loss: 0.1117512
	speed: 0.0376s/iter; left time: 1454.0091s
	iters: 400, epoch: 18 | loss: 0.0048117
	speed: 0.0383s/iter; left time: 1476.0539s
Epoch: 18 cost time: 18.23676037788391
Epoch: 18, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0026400
	speed: 0.1593s/iter; left time: 6109.3060s
	iters: 200, epoch: 19 | loss: 0.0108413
	speed: 0.0342s/iter; left time: 1308.2821s
	iters: 300, epoch: 19 | loss: 0.0933469
	speed: 0.0370s/iter; left time: 1413.5129s
	iters: 400, epoch: 19 | loss: 0.0028770
	speed: 0.0361s/iter; left time: 1372.6951s
Epoch: 19 cost time: 16.945408821105957
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.257 Vali Acc: 0.952 Test Loss: 0.257 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 1002606
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7623762
	speed: 0.0505s/iter; left time: 2363.7307s
	iters: 200, epoch: 1 | loss: 0.3330947
	speed: 0.0382s/iter; left time: 1782.9924s
	iters: 300, epoch: 1 | loss: 0.2808160
	speed: 0.0381s/iter; left time: 1777.8147s
	iters: 400, epoch: 1 | loss: 0.2362689
	speed: 0.0370s/iter; left time: 1720.4896s
Epoch: 1 cost time: 19.148683786392212
Epoch: 1, Steps: 469 | Train Loss: 0.639 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
Validation loss decreased (inf --> -0.921667).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1086886
	speed: 0.1582s/iter; left time: 7330.6883s
	iters: 200, epoch: 2 | loss: 0.0408122
	speed: 0.0376s/iter; left time: 1739.6749s
	iters: 300, epoch: 2 | loss: 0.0453955
	speed: 0.0367s/iter; left time: 1691.6348s
	iters: 400, epoch: 2 | loss: 0.0780769
	speed: 0.0352s/iter; left time: 1619.9625s
Epoch: 2 cost time: 17.50491952896118
Epoch: 2, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.921667 --> -0.925955).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1498953
	speed: 0.1675s/iter; left time: 7684.3138s
	iters: 200, epoch: 3 | loss: 0.0808241
	speed: 0.0389s/iter; left time: 1780.9245s
	iters: 300, epoch: 3 | loss: 0.1372585
	speed: 0.0402s/iter; left time: 1837.5063s
	iters: 400, epoch: 3 | loss: 0.1746094
	speed: 0.0392s/iter; left time: 1788.0007s
Epoch: 3 cost time: 18.63438081741333
Epoch: 3, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
Validation loss decreased (-0.925955 --> -0.932245).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0220239
	speed: 0.1739s/iter; left time: 7891.8237s
	iters: 200, epoch: 4 | loss: 0.0222664
	speed: 0.0388s/iter; left time: 1756.4201s
	iters: 300, epoch: 4 | loss: 0.0206709
	speed: 0.0426s/iter; left time: 1924.0453s
	iters: 400, epoch: 4 | loss: 0.0055480
	speed: 0.0397s/iter; left time: 1788.8879s
Epoch: 4 cost time: 19.052781105041504
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
Validation loss decreased (-0.932245 --> -0.952543).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0153595
	speed: 0.1706s/iter; left time: 7665.3095s
	iters: 200, epoch: 5 | loss: 0.1095382
	speed: 0.0382s/iter; left time: 1711.3128s
	iters: 300, epoch: 5 | loss: 0.0283957
	speed: 0.0410s/iter; left time: 1833.1387s
	iters: 400, epoch: 5 | loss: 0.0129033
	speed: 0.0378s/iter; left time: 1684.7215s
Epoch: 5 cost time: 18.410030603408813
Epoch: 5, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.952543 --> -0.953686).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2585608
	speed: 0.1643s/iter; left time: 7303.8465s
	iters: 200, epoch: 6 | loss: 0.0044317
	speed: 0.0370s/iter; left time: 1641.7255s
	iters: 300, epoch: 6 | loss: 0.0414401
	speed: 0.0382s/iter; left time: 1690.7271s
	iters: 400, epoch: 6 | loss: 0.0359230
	speed: 0.0385s/iter; left time: 1701.7874s
Epoch: 6 cost time: 18.214359760284424
Epoch: 6, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0851918
	speed: 0.1513s/iter; left time: 6653.0478s
	iters: 200, epoch: 7 | loss: 0.1165031
	speed: 0.0352s/iter; left time: 1544.7124s
	iters: 300, epoch: 7 | loss: 0.0086826
	speed: 0.0389s/iter; left time: 1705.3026s
	iters: 400, epoch: 7 | loss: 0.3656701
	speed: 0.0367s/iter; left time: 1602.4824s
Epoch: 7 cost time: 17.79787254333496
Epoch: 7, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1140561
	speed: 0.1590s/iter; left time: 6918.7025s
	iters: 200, epoch: 8 | loss: 0.0500412
	speed: 0.0369s/iter; left time: 1604.2901s
	iters: 300, epoch: 8 | loss: 0.0097343
	speed: 0.0370s/iter; left time: 1602.8015s
	iters: 400, epoch: 8 | loss: 0.3023243
	speed: 0.0363s/iter; left time: 1570.9172s
Epoch: 8 cost time: 17.755027055740356
Epoch: 8, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.953686 --> -0.964550).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0250687
	speed: 0.1592s/iter; left time: 6852.2526s
	iters: 200, epoch: 9 | loss: 0.3617590
	speed: 0.0351s/iter; left time: 1508.0882s
	iters: 300, epoch: 9 | loss: 0.0736710
	speed: 0.0340s/iter; left time: 1455.4542s
	iters: 400, epoch: 9 | loss: 0.2560098
	speed: 0.0331s/iter; left time: 1415.8764s
Epoch: 9 cost time: 16.448031425476074
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.220 Vali Acc: 0.945 Test Loss: 0.220 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0167115
	speed: 0.1311s/iter; left time: 5580.6130s
	iters: 200, epoch: 10 | loss: 0.0112377
	speed: 0.0380s/iter; left time: 1615.6289s
	iters: 300, epoch: 10 | loss: 0.0072863
	speed: 0.0367s/iter; left time: 1554.7103s
	iters: 400, epoch: 10 | loss: 0.2962761
	speed: 0.0399s/iter; left time: 1687.8405s
Epoch: 10 cost time: 18.244135856628418
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0029392
	speed: 0.1641s/iter; left time: 6909.8568s
	iters: 200, epoch: 11 | loss: 0.0077244
	speed: 0.0351s/iter; left time: 1473.4939s
	iters: 300, epoch: 11 | loss: 0.0038277
	speed: 0.0371s/iter; left time: 1555.5886s
	iters: 400, epoch: 11 | loss: 0.0021137
	speed: 0.0372s/iter; left time: 1555.5160s
Epoch: 11 cost time: 17.509002447128296
Epoch: 11, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.964550 --> -0.974842).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1148394
	speed: 0.1661s/iter; left time: 6918.1097s
	iters: 200, epoch: 12 | loss: 0.0248338
	speed: 0.0382s/iter; left time: 1586.6341s
	iters: 300, epoch: 12 | loss: 0.0030544
	speed: 0.0392s/iter; left time: 1624.8581s
	iters: 400, epoch: 12 | loss: 0.0214212
	speed: 0.0398s/iter; left time: 1644.1486s
Epoch: 12 cost time: 18.45792818069458
Epoch: 12, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0067387
	speed: 0.1666s/iter; left time: 6858.1282s
	iters: 200, epoch: 13 | loss: 0.0044750
	speed: 0.0381s/iter; left time: 1563.5642s
	iters: 300, epoch: 13 | loss: 0.0112326
	speed: 0.0391s/iter; left time: 1601.0465s
	iters: 400, epoch: 13 | loss: 0.0064624
	speed: 0.0390s/iter; left time: 1594.5453s
Epoch: 13 cost time: 18.40385150909424
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0046302
	speed: 0.1730s/iter; left time: 7043.6622s
	iters: 200, epoch: 14 | loss: 0.0023335
	speed: 0.0390s/iter; left time: 1583.4706s
	iters: 300, epoch: 14 | loss: 0.0041848
	speed: 0.0386s/iter; left time: 1561.6628s
	iters: 400, epoch: 14 | loss: 0.0026229
	speed: 0.0362s/iter; left time: 1464.6267s
Epoch: 14 cost time: 18.191470623016357
Epoch: 14, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2439974
	speed: 0.1502s/iter; left time: 6043.6555s
	iters: 200, epoch: 15 | loss: 0.0868160
	speed: 0.0368s/iter; left time: 1477.7253s
	iters: 300, epoch: 15 | loss: 0.1104152
	speed: 0.0389s/iter; left time: 1558.7070s
	iters: 400, epoch: 15 | loss: 0.3448716
	speed: 0.0377s/iter; left time: 1507.2250s
Epoch: 15 cost time: 17.50845170021057
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.278 Vali Acc: 0.942 Test Loss: 0.278 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0548420
	speed: 0.1537s/iter; left time: 6112.4473s
	iters: 200, epoch: 16 | loss: 0.0545870
	speed: 0.0374s/iter; left time: 1484.8690s
	iters: 300, epoch: 16 | loss: 0.0031150
	speed: 0.0385s/iter; left time: 1522.7127s
	iters: 400, epoch: 16 | loss: 0.0012755
	speed: 0.0355s/iter; left time: 1402.0900s
Epoch: 16 cost time: 17.409857749938965
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0863944
	speed: 0.1618s/iter; left time: 6358.7387s
	iters: 200, epoch: 17 | loss: 0.0166494
	speed: 0.0365s/iter; left time: 1430.0720s
	iters: 300, epoch: 17 | loss: 0.0021741
	speed: 0.0358s/iter; left time: 1400.1221s
	iters: 400, epoch: 17 | loss: 0.0059814
	speed: 0.0362s/iter; left time: 1411.3029s
Epoch: 17 cost time: 17.321902990341187
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3890125
	speed: 0.1506s/iter; left time: 5845.6663s
	iters: 200, epoch: 18 | loss: 0.0759786
	speed: 0.0346s/iter; left time: 1341.6710s
	iters: 300, epoch: 18 | loss: 0.1188590
	speed: 0.0371s/iter; left time: 1433.2367s
	iters: 400, epoch: 18 | loss: 0.1211315
	speed: 0.0370s/iter; left time: 1425.6103s
Epoch: 18 cost time: 17.51892638206482
Epoch: 18, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0027453
	speed: 0.1613s/iter; left time: 6185.8218s
	iters: 200, epoch: 19 | loss: 0.0103200
	speed: 0.0379s/iter; left time: 1450.8544s
	iters: 300, epoch: 19 | loss: 0.0032511
	speed: 0.0354s/iter; left time: 1351.4280s
	iters: 400, epoch: 19 | loss: 0.0008009
	speed: 0.0359s/iter; left time: 1366.7108s
Epoch: 19 cost time: 17.635667085647583
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0097655
	speed: 0.1562s/iter; left time: 5918.1038s
	iters: 200, epoch: 20 | loss: 0.0069335
	speed: 0.0360s/iter; left time: 1361.2872s
	iters: 300, epoch: 20 | loss: 0.0007593
	speed: 0.0337s/iter; left time: 1271.0740s
	iters: 400, epoch: 20 | loss: 0.2538490
	speed: 0.0374s/iter; left time: 1405.8374s
Epoch: 20 cost time: 17.211350440979004
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1734269
	speed: 0.1433s/iter; left time: 5363.5345s
	iters: 200, epoch: 21 | loss: 0.0015948
	speed: 0.0380s/iter; left time: 1416.6980s
	iters: 300, epoch: 21 | loss: 0.0040867
	speed: 0.0389s/iter; left time: 1447.5543s
	iters: 400, epoch: 21 | loss: 0.0680880
	speed: 0.0384s/iter; left time: 1423.9276s
Epoch: 21 cost time: 18.25090456008911
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 1002478
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8380560
	speed: 0.0488s/iter; left time: 2282.5080s
	iters: 200, epoch: 1 | loss: 0.3515294
	speed: 0.0370s/iter; left time: 1729.5247s
	iters: 300, epoch: 1 | loss: 0.1812060
	speed: 0.0368s/iter; left time: 1712.8206s
	iters: 400, epoch: 1 | loss: 0.1162012
	speed: 0.0392s/iter; left time: 1820.7690s
Epoch: 1 cost time: 18.85788631439209
Epoch: 1, Steps: 469 | Train Loss: 0.609 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (inf --> -0.924812).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0325498
	speed: 0.1721s/iter; left time: 7971.6313s
	iters: 200, epoch: 2 | loss: 0.6028223
	speed: 0.0389s/iter; left time: 1800.2868s
	iters: 300, epoch: 2 | loss: 0.0320966
	speed: 0.0365s/iter; left time: 1685.2973s
	iters: 400, epoch: 2 | loss: 0.0508273
	speed: 0.0299s/iter; left time: 1378.0560s
Epoch: 2 cost time: 16.556899785995483
Epoch: 2, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.924812 --> -0.940535).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0271338
	speed: 0.1122s/iter; left time: 5145.3598s
	iters: 200, epoch: 3 | loss: 0.1409395
	speed: 0.0318s/iter; left time: 1455.6101s
	iters: 300, epoch: 3 | loss: 0.0167856
	speed: 0.0366s/iter; left time: 1669.5923s
	iters: 400, epoch: 3 | loss: 0.0937335
	speed: 0.0365s/iter; left time: 1662.4032s
Epoch: 3 cost time: 15.825678586959839
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.232 Vali Acc: 0.945 Test Loss: 0.232 Test Acc: 0.945
Validation loss decreased (-0.940535 --> -0.945395).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0668002
	speed: 0.1541s/iter; left time: 6993.4142s
	iters: 200, epoch: 4 | loss: 0.0172857
	speed: 0.0377s/iter; left time: 1708.3752s
	iters: 300, epoch: 4 | loss: 0.0851777
	speed: 0.0408s/iter; left time: 1844.4499s
	iters: 400, epoch: 4 | loss: 0.0168761
	speed: 0.0355s/iter; left time: 1598.9573s
Epoch: 4 cost time: 17.895699739456177
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.181 Vali Acc: 0.945 Test Loss: 0.181 Test Acc: 0.945
Validation loss decreased (-0.945395 --> -0.945396).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0057826
	speed: 0.1517s/iter; left time: 6813.8052s
	iters: 200, epoch: 5 | loss: 0.0251816
	speed: 0.0370s/iter; left time: 1660.2432s
	iters: 300, epoch: 5 | loss: 0.0228783
	speed: 0.0363s/iter; left time: 1625.3079s
	iters: 400, epoch: 5 | loss: 0.0159448
	speed: 0.0336s/iter; left time: 1501.2783s
Epoch: 5 cost time: 16.75656247138977
Epoch: 5, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0075477
	speed: 0.1446s/iter; left time: 6429.1453s
	iters: 200, epoch: 6 | loss: 0.0124283
	speed: 0.0351s/iter; left time: 1554.9895s
	iters: 300, epoch: 6 | loss: 0.0626898
	speed: 0.0364s/iter; left time: 1610.0016s
	iters: 400, epoch: 6 | loss: 0.0176766
	speed: 0.0359s/iter; left time: 1585.1577s
Epoch: 6 cost time: 17.353557348251343
Epoch: 6, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.202 Vali Acc: 0.947 Test Loss: 0.202 Test Acc: 0.947
Validation loss decreased (-0.945396 --> -0.947396).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0229404
	speed: 0.1548s/iter; left time: 6811.0228s
	iters: 200, epoch: 7 | loss: 0.0025315
	speed: 0.0362s/iter; left time: 1588.4353s
	iters: 300, epoch: 7 | loss: 0.0042395
	speed: 0.0386s/iter; left time: 1688.2661s
	iters: 400, epoch: 7 | loss: 0.3363523
	speed: 0.0339s/iter; left time: 1480.1915s
Epoch: 7 cost time: 17.68305492401123
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.947396 --> -0.951399).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0277303
	speed: 0.1527s/iter; left time: 6644.4734s
	iters: 200, epoch: 8 | loss: 0.2355969
	speed: 0.0367s/iter; left time: 1593.0288s
	iters: 300, epoch: 8 | loss: 0.0754694
	speed: 0.0371s/iter; left time: 1606.6029s
	iters: 400, epoch: 8 | loss: 0.0341631
	speed: 0.0360s/iter; left time: 1557.2127s
Epoch: 8 cost time: 17.621233701705933
Epoch: 8, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.306 Vali Acc: 0.921 Test Loss: 0.306 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0077745
	speed: 0.1560s/iter; left time: 6717.0383s
	iters: 200, epoch: 9 | loss: 0.0120362
	speed: 0.0394s/iter; left time: 1692.9882s
	iters: 300, epoch: 9 | loss: 0.0084970
	speed: 0.0393s/iter; left time: 1684.5575s
	iters: 400, epoch: 9 | loss: 0.6739985
	speed: 0.0400s/iter; left time: 1710.2616s
Epoch: 9 cost time: 18.60443902015686
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.951399 --> -0.965407).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0007760
	speed: 0.1750s/iter; left time: 7451.9774s
	iters: 200, epoch: 10 | loss: 0.0039424
	speed: 0.0418s/iter; left time: 1775.0089s
	iters: 300, epoch: 10 | loss: 0.0579765
	speed: 0.0377s/iter; left time: 1599.7638s
	iters: 400, epoch: 10 | loss: 0.0030107
	speed: 0.0383s/iter; left time: 1619.1686s
Epoch: 10 cost time: 18.76383876800537
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.965407 --> -0.966551).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0025733
	speed: 0.1721s/iter; left time: 7246.8558s
	iters: 200, epoch: 11 | loss: 0.3331340
	speed: 0.0392s/iter; left time: 1644.7595s
	iters: 300, epoch: 11 | loss: 0.0030174
	speed: 0.0400s/iter; left time: 1675.9290s
	iters: 400, epoch: 11 | loss: 0.0127941
	speed: 0.0390s/iter; left time: 1630.7873s
Epoch: 11 cost time: 18.78660750389099
Epoch: 11, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0026455
	speed: 0.1707s/iter; left time: 7108.6170s
	iters: 200, epoch: 12 | loss: 0.0052864
	speed: 0.0352s/iter; left time: 1462.9135s
	iters: 300, epoch: 12 | loss: 0.1947037
	speed: 0.0369s/iter; left time: 1530.6953s
	iters: 400, epoch: 12 | loss: 0.0049225
	speed: 0.0366s/iter; left time: 1513.7496s
Epoch: 12 cost time: 17.75614857673645
Epoch: 12, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.940 Test Loss: 0.246 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0081772
	speed: 0.1572s/iter; left time: 6471.3516s
	iters: 200, epoch: 13 | loss: 0.0076297
	speed: 0.0367s/iter; left time: 1507.5589s
	iters: 300, epoch: 13 | loss: 0.0048198
	speed: 0.0385s/iter; left time: 1578.8532s
	iters: 400, epoch: 13 | loss: 0.0037631
	speed: 0.0383s/iter; left time: 1567.3456s
Epoch: 13 cost time: 18.14221501350403
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0660623
	speed: 0.1525s/iter; left time: 6205.6931s
	iters: 200, epoch: 14 | loss: 0.0613730
	speed: 0.0368s/iter; left time: 1492.6992s
	iters: 300, epoch: 14 | loss: 0.0032814
	speed: 0.0369s/iter; left time: 1493.0725s
	iters: 400, epoch: 14 | loss: 0.0200197
	speed: 0.0345s/iter; left time: 1392.6260s
Epoch: 14 cost time: 17.584376573562622
Epoch: 14, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1310456
	speed: 0.1509s/iter; left time: 6070.2505s
	iters: 200, epoch: 15 | loss: 0.0115522
	speed: 0.0381s/iter; left time: 1530.2766s
	iters: 300, epoch: 15 | loss: 0.0721309
	speed: 0.0380s/iter; left time: 1519.5241s
	iters: 400, epoch: 15 | loss: 0.1367092
	speed: 0.0372s/iter; left time: 1487.0489s
Epoch: 15 cost time: 18.075080394744873
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1642405
	speed: 0.1601s/iter; left time: 6366.8567s
	iters: 200, epoch: 16 | loss: 0.0015132
	speed: 0.0357s/iter; left time: 1416.0019s
	iters: 300, epoch: 16 | loss: 0.1132716
	speed: 0.0357s/iter; left time: 1413.5414s
	iters: 400, epoch: 16 | loss: 0.0019124
	speed: 0.0385s/iter; left time: 1518.2682s
Epoch: 16 cost time: 17.585649728775024
Epoch: 16, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0182713
	speed: 0.1540s/iter; left time: 6052.5681s
	iters: 200, epoch: 17 | loss: 0.1109129
	speed: 0.0364s/iter; left time: 1425.5685s
	iters: 300, epoch: 17 | loss: 0.0261390
	speed: 0.0361s/iter; left time: 1410.4113s
	iters: 400, epoch: 17 | loss: 0.0092925
	speed: 0.0382s/iter; left time: 1491.6125s
Epoch: 17 cost time: 17.817685842514038
Epoch: 17, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0014598
	speed: 0.1569s/iter; left time: 6093.0657s
	iters: 200, epoch: 18 | loss: 0.0011487
	speed: 0.0392s/iter; left time: 1519.6791s
	iters: 300, epoch: 18 | loss: 0.1106690
	speed: 0.0368s/iter; left time: 1422.3909s
	iters: 400, epoch: 18 | loss: 0.0014892
	speed: 0.0384s/iter; left time: 1477.8118s
Epoch: 18 cost time: 18.34596586227417
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.314 Vali Acc: 0.939 Test Loss: 0.314 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0093762
	speed: 0.1668s/iter; left time: 6396.5795s
	iters: 200, epoch: 19 | loss: 0.0072435
	speed: 0.0382s/iter; left time: 1462.9851s
	iters: 300, epoch: 19 | loss: 0.0169865
	speed: 0.0379s/iter; left time: 1444.7342s
	iters: 400, epoch: 19 | loss: 0.0034083
	speed: 0.0414s/iter; left time: 1575.8317s
Epoch: 19 cost time: 18.771987676620483
Epoch: 19, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1167639
	speed: 0.1762s/iter; left time: 6674.7687s
	iters: 200, epoch: 20 | loss: 0.0099530
	speed: 0.0400s/iter; left time: 1511.9654s
	iters: 300, epoch: 20 | loss: 0.0110969
	speed: 0.0425s/iter; left time: 1601.9783s
	iters: 400, epoch: 20 | loss: 0.0008249
	speed: 0.0413s/iter; left time: 1553.8669s
Epoch: 20 cost time: 19.56637144088745
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9665523156089194
model parameter : 1002350
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0613353
	speed: 0.0484s/iter; left time: 2265.2352s
	iters: 200, epoch: 1 | loss: 0.4578453
	speed: 0.0371s/iter; left time: 1732.2407s
	iters: 300, epoch: 1 | loss: 0.2545715
	speed: 0.0383s/iter; left time: 1784.0497s
	iters: 400, epoch: 1 | loss: 0.2336136
	speed: 0.0358s/iter; left time: 1663.4080s
Epoch: 1 cost time: 18.458944082260132
Epoch: 1, Steps: 469 | Train Loss: 0.621 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (inf --> -0.919094).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4181525
	speed: 0.1518s/iter; left time: 7031.1959s
	iters: 200, epoch: 2 | loss: 0.0349921
	speed: 0.0385s/iter; left time: 1778.8334s
	iters: 300, epoch: 2 | loss: 0.1329574
	speed: 0.0366s/iter; left time: 1690.1392s
	iters: 400, epoch: 2 | loss: 0.1653431
	speed: 0.0360s/iter; left time: 1657.8028s
Epoch: 2 cost time: 17.529136896133423
Epoch: 2, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.919094 --> -0.940535).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4262216
	speed: 0.1092s/iter; left time: 5008.6135s
	iters: 200, epoch: 3 | loss: 0.1927864
	speed: 0.0324s/iter; left time: 1480.9089s
	iters: 300, epoch: 3 | loss: 0.0213285
	speed: 0.0339s/iter; left time: 1547.6559s
	iters: 400, epoch: 3 | loss: 0.2444610
	speed: 0.0346s/iter; left time: 1577.5815s
Epoch: 3 cost time: 15.987410068511963
Epoch: 3, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.940535 --> -0.954544).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0101679
	speed: 0.1507s/iter; left time: 6839.1616s
	iters: 200, epoch: 4 | loss: 0.0565698
	speed: 0.0375s/iter; left time: 1696.7267s
	iters: 300, epoch: 4 | loss: 0.0104033
	speed: 0.0360s/iter; left time: 1629.1367s
	iters: 400, epoch: 4 | loss: 0.3095434
	speed: 0.0334s/iter; left time: 1504.0464s
Epoch: 4 cost time: 17.521129369735718
Epoch: 4, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0255068
	speed: 0.1505s/iter; left time: 6760.3333s
	iters: 200, epoch: 5 | loss: 0.0181559
	speed: 0.0365s/iter; left time: 1638.3314s
	iters: 300, epoch: 5 | loss: 0.5162171
	speed: 0.0355s/iter; left time: 1585.7032s
	iters: 400, epoch: 5 | loss: 0.1002282
	speed: 0.0369s/iter; left time: 1647.1635s
Epoch: 5 cost time: 17.59906244277954
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.954544 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0289415
	speed: 0.1567s/iter; left time: 6968.0005s
	iters: 200, epoch: 6 | loss: 0.2107680
	speed: 0.0357s/iter; left time: 1583.9967s
	iters: 300, epoch: 6 | loss: 0.0957698
	speed: 0.0390s/iter; left time: 1727.0450s
	iters: 400, epoch: 6 | loss: 0.0045906
	speed: 0.0358s/iter; left time: 1580.6221s
Epoch: 6 cost time: 17.50965189933777
Epoch: 6, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0537043
	speed: 0.1458s/iter; left time: 6412.7362s
	iters: 200, epoch: 7 | loss: 0.0081360
	speed: 0.0375s/iter; left time: 1647.2120s
	iters: 300, epoch: 7 | loss: 0.1631515
	speed: 0.0377s/iter; left time: 1650.0079s
	iters: 400, epoch: 7 | loss: 0.0039436
	speed: 0.0392s/iter; left time: 1710.6784s
Epoch: 7 cost time: 18.180684328079224
Epoch: 7, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0403051
	speed: 0.1688s/iter; left time: 7345.5959s
	iters: 200, epoch: 8 | loss: 0.1246596
	speed: 0.0383s/iter; left time: 1664.3536s
	iters: 300, epoch: 8 | loss: 0.2246740
	speed: 0.0394s/iter; left time: 1706.3612s
	iters: 400, epoch: 8 | loss: 0.0314874
	speed: 0.0400s/iter; left time: 1727.6045s
Epoch: 8 cost time: 18.576191186904907
Epoch: 8, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0552996
	speed: 0.1734s/iter; left time: 7465.5366s
	iters: 200, epoch: 9 | loss: 0.1082722
	speed: 0.0387s/iter; left time: 1664.0806s
	iters: 300, epoch: 9 | loss: 0.0132294
	speed: 0.0388s/iter; left time: 1662.0969s
	iters: 400, epoch: 9 | loss: 0.0107104
	speed: 0.0384s/iter; left time: 1640.5992s
Epoch: 9 cost time: 18.54582643508911
Epoch: 9, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.196 Vali Acc: 0.947 Test Loss: 0.196 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0341415
	speed: 0.1532s/iter; left time: 6524.8998s
	iters: 200, epoch: 10 | loss: 0.5567752
	speed: 0.0344s/iter; left time: 1463.0617s
	iters: 300, epoch: 10 | loss: 0.0370939
	speed: 0.0375s/iter; left time: 1590.9233s
	iters: 400, epoch: 10 | loss: 0.0189146
	speed: 0.0361s/iter; left time: 1526.4357s
Epoch: 10 cost time: 17.10174298286438
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0034629
	speed: 0.1507s/iter; left time: 6345.4724s
	iters: 200, epoch: 11 | loss: 0.0024837
	speed: 0.0355s/iter; left time: 1493.2440s
	iters: 300, epoch: 11 | loss: 0.5437636
	speed: 0.0383s/iter; left time: 1604.3094s
	iters: 400, epoch: 11 | loss: 0.0037136
	speed: 0.0363s/iter; left time: 1516.6407s
Epoch: 11 cost time: 17.590245008468628
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0327751
	speed: 0.1539s/iter; left time: 6406.6808s
	iters: 200, epoch: 12 | loss: 0.1346806
	speed: 0.0373s/iter; left time: 1551.0037s
	iters: 300, epoch: 12 | loss: 0.3373227
	speed: 0.0377s/iter; left time: 1563.4251s
	iters: 400, epoch: 12 | loss: 0.0106350
	speed: 0.0329s/iter; left time: 1360.3997s
Epoch: 12 cost time: 17.34474754333496
Epoch: 12, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.964 Test Loss: 0.160 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0011803
	speed: 0.1403s/iter; left time: 5777.0543s
	iters: 200, epoch: 13 | loss: 0.0207541
	speed: 0.0374s/iter; left time: 1535.4063s
	iters: 300, epoch: 13 | loss: 0.1484505
	speed: 0.0364s/iter; left time: 1493.3599s
	iters: 400, epoch: 13 | loss: 0.0170552
	speed: 0.0358s/iter; left time: 1461.7729s
Epoch: 13 cost time: 17.197617769241333
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0084141
	speed: 0.1549s/iter; left time: 6305.2911s
	iters: 200, epoch: 14 | loss: 0.0338262
	speed: 0.0385s/iter; left time: 1565.0752s
	iters: 300, epoch: 14 | loss: 0.0019805
	speed: 0.0381s/iter; left time: 1543.4502s
	iters: 400, epoch: 14 | loss: 0.0328961
	speed: 0.0370s/iter; left time: 1492.9739s
Epoch: 14 cost time: 17.876882791519165
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0080280
	speed: 0.1202s/iter; left time: 4837.2232s
	iters: 200, epoch: 15 | loss: 0.0096453
	speed: 0.0321s/iter; left time: 1286.5071s
	iters: 300, epoch: 15 | loss: 0.0193009
	speed: 0.0309s/iter; left time: 1237.2260s
	iters: 400, epoch: 15 | loss: 0.0178704
	speed: 0.0344s/iter; left time: 1371.8025s
Epoch: 15 cost time: 15.741909980773926
Epoch: 15, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9685534591194969
model parameter : 1002222
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8895118
	speed: 0.0538s/iter; left time: 2518.4695s
	iters: 200, epoch: 1 | loss: 0.4477806
	speed: 0.0397s/iter; left time: 1854.2628s
	iters: 300, epoch: 1 | loss: 0.2022338
	speed: 0.0427s/iter; left time: 1989.7816s
	iters: 400, epoch: 1 | loss: 0.3128410
	speed: 0.0382s/iter; left time: 1776.7620s
Epoch: 1 cost time: 20.177584886550903
Epoch: 1, Steps: 469 | Train Loss: 0.694 Vali Loss: 0.385 Vali Acc: 0.865 Test Loss: 0.385 Test Acc: 0.865
Validation loss decreased (inf --> -0.865348).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3840311
	speed: 0.1661s/iter; left time: 7694.7137s
	iters: 200, epoch: 2 | loss: 0.0495573
	speed: 0.0413s/iter; left time: 1911.5049s
	iters: 300, epoch: 2 | loss: 0.1782887
	speed: 0.0407s/iter; left time: 1877.6978s
	iters: 400, epoch: 2 | loss: 0.1840226
	speed: 0.0389s/iter; left time: 1789.7014s
Epoch: 2 cost time: 19.147517442703247
Epoch: 2, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.865348 --> -0.937391).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0835180
	speed: 0.1707s/iter; left time: 7826.9607s
	iters: 200, epoch: 3 | loss: 0.3849103
	speed: 0.0390s/iter; left time: 1786.7991s
	iters: 300, epoch: 3 | loss: 0.0365338
	speed: 0.0382s/iter; left time: 1743.5421s
	iters: 400, epoch: 3 | loss: 0.2195570
	speed: 0.0344s/iter; left time: 1569.0161s
Epoch: 3 cost time: 17.768662691116333
Epoch: 3, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1671166
	speed: 0.1455s/iter; left time: 6603.2851s
	iters: 200, epoch: 4 | loss: 0.0522290
	speed: 0.0359s/iter; left time: 1627.8134s
	iters: 300, epoch: 4 | loss: 0.1490593
	speed: 0.0357s/iter; left time: 1614.9603s
	iters: 400, epoch: 4 | loss: 0.0434173
	speed: 0.0388s/iter; left time: 1748.7282s
Epoch: 4 cost time: 17.642611503601074
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.937391 --> -0.957688).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1109040
	speed: 0.1517s/iter; left time: 6815.9676s
	iters: 200, epoch: 5 | loss: 0.0106458
	speed: 0.0357s/iter; left time: 1598.6945s
	iters: 300, epoch: 5 | loss: 0.0108126
	speed: 0.0371s/iter; left time: 1658.5671s
	iters: 400, epoch: 5 | loss: 0.0140035
	speed: 0.0373s/iter; left time: 1662.7100s
Epoch: 5 cost time: 17.429367780685425
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1317261
	speed: 0.1511s/iter; left time: 6715.6788s
	iters: 200, epoch: 6 | loss: 0.1288506
	speed: 0.0357s/iter; left time: 1581.7878s
	iters: 300, epoch: 6 | loss: 0.0043580
	speed: 0.0386s/iter; left time: 1707.5940s
	iters: 400, epoch: 6 | loss: 0.0375584
	speed: 0.0350s/iter; left time: 1545.0223s
Epoch: 6 cost time: 17.49686026573181
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0826816
	speed: 0.1532s/iter; left time: 6739.3688s
	iters: 200, epoch: 7 | loss: 0.0703854
	speed: 0.0359s/iter; left time: 1574.3727s
	iters: 300, epoch: 7 | loss: 0.1184710
	speed: 0.0362s/iter; left time: 1583.2581s
	iters: 400, epoch: 7 | loss: 0.0036539
	speed: 0.0371s/iter; left time: 1621.2955s
Epoch: 7 cost time: 17.50179386138916
Epoch: 7, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
Validation loss decreased (-0.957688 --> -0.963692).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0105933
	speed: 0.1577s/iter; left time: 6861.0200s
	iters: 200, epoch: 8 | loss: 0.3930050
	speed: 0.0382s/iter; left time: 1658.3106s
	iters: 300, epoch: 8 | loss: 0.0132456
	speed: 0.0364s/iter; left time: 1577.1980s
	iters: 400, epoch: 8 | loss: 0.1235058
	speed: 0.0381s/iter; left time: 1646.3255s
Epoch: 8 cost time: 17.913155794143677
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0069026
	speed: 0.1590s/iter; left time: 6846.8573s
	iters: 200, epoch: 9 | loss: 0.0021494
	speed: 0.0375s/iter; left time: 1608.6264s
	iters: 300, epoch: 9 | loss: 0.0507197
	speed: 0.0362s/iter; left time: 1550.3053s
	iters: 400, epoch: 9 | loss: 0.0050119
	speed: 0.0376s/iter; left time: 1609.2821s
Epoch: 9 cost time: 17.845186710357666
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0038592
	speed: 0.1628s/iter; left time: 6933.1836s
	iters: 200, epoch: 10 | loss: 0.0070816
	speed: 0.0401s/iter; left time: 1704.5466s
	iters: 300, epoch: 10 | loss: 0.0035749
	speed: 0.0407s/iter; left time: 1726.7153s
	iters: 400, epoch: 10 | loss: 0.0168132
	speed: 0.0396s/iter; left time: 1675.8517s
Epoch: 10 cost time: 18.980736255645752
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0015968
	speed: 0.1660s/iter; left time: 6988.8297s
	iters: 200, epoch: 11 | loss: 0.0380770
	speed: 0.0383s/iter; left time: 1608.6361s
	iters: 300, epoch: 11 | loss: 0.0087650
	speed: 0.0406s/iter; left time: 1703.0087s
	iters: 400, epoch: 11 | loss: 0.0012967
	speed: 0.0404s/iter; left time: 1688.3380s
Epoch: 11 cost time: 18.85659408569336
Epoch: 11, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.194 Vali Acc: 0.947 Test Loss: 0.194 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0019991
	speed: 0.1722s/iter; left time: 7171.3449s
	iters: 200, epoch: 12 | loss: 0.0047303
	speed: 0.0386s/iter; left time: 1605.2830s
	iters: 300, epoch: 12 | loss: 0.0209656
	speed: 0.0386s/iter; left time: 1601.1274s
	iters: 400, epoch: 12 | loss: 0.0026811
	speed: 0.0373s/iter; left time: 1540.8772s
Epoch: 12 cost time: 18.32293939590454
Epoch: 12, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.963692 --> -0.975414).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0033253
	speed: 0.1462s/iter; left time: 6018.1182s
	iters: 200, epoch: 13 | loss: 0.0106877
	speed: 0.0374s/iter; left time: 1535.7998s
	iters: 300, epoch: 13 | loss: 0.0015759
	speed: 0.0367s/iter; left time: 1501.8130s
	iters: 400, epoch: 13 | loss: 0.0495698
	speed: 0.0379s/iter; left time: 1549.5942s
Epoch: 13 cost time: 17.999090433120728
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0037917
	speed: 0.1615s/iter; left time: 6573.5389s
	iters: 200, epoch: 14 | loss: 0.0026750
	speed: 0.0363s/iter; left time: 1473.3293s
	iters: 300, epoch: 14 | loss: 0.0628122
	speed: 0.0372s/iter; left time: 1508.2604s
	iters: 400, epoch: 14 | loss: 0.0219929
	speed: 0.0378s/iter; left time: 1527.6795s
Epoch: 14 cost time: 17.692771196365356
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1428599
	speed: 0.1530s/iter; left time: 6156.6026s
	iters: 200, epoch: 15 | loss: 0.0012897
	speed: 0.0375s/iter; left time: 1503.2986s
	iters: 300, epoch: 15 | loss: 0.0021184
	speed: 0.0376s/iter; left time: 1506.0215s
	iters: 400, epoch: 15 | loss: 0.0029233
	speed: 0.0376s/iter; left time: 1501.1512s
Epoch: 15 cost time: 17.762113094329834
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0012281
	speed: 0.1287s/iter; left time: 5119.7487s
	iters: 200, epoch: 16 | loss: 0.4857634
	speed: 0.0362s/iter; left time: 1437.6094s
	iters: 300, epoch: 16 | loss: 0.0012203
	speed: 0.0330s/iter; left time: 1304.0521s
	iters: 400, epoch: 16 | loss: 0.0052682
	speed: 0.0368s/iter; left time: 1451.4755s
Epoch: 16 cost time: 16.836171627044678
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0014737
	speed: 0.1449s/iter; left time: 5692.4230s
	iters: 200, epoch: 17 | loss: 0.1817720
	speed: 0.0365s/iter; left time: 1430.5191s
	iters: 300, epoch: 17 | loss: 0.0488162
	speed: 0.0376s/iter; left time: 1468.3321s
	iters: 400, epoch: 17 | loss: 0.0164680
	speed: 0.0391s/iter; left time: 1525.1704s
Epoch: 17 cost time: 18.021113634109497
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0022458
	speed: 0.1627s/iter; left time: 6315.9783s
	iters: 200, epoch: 18 | loss: 0.0066011
	speed: 0.0375s/iter; left time: 1452.9661s
	iters: 300, epoch: 18 | loss: 0.0008915
	speed: 0.0381s/iter; left time: 1473.1309s
	iters: 400, epoch: 18 | loss: 0.0044912
	speed: 0.0383s/iter; left time: 1476.3623s
Epoch: 18 cost time: 17.830962896347046
Epoch: 18, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0078053
	speed: 0.1551s/iter; left time: 5948.4256s
	iters: 200, epoch: 19 | loss: 0.0023514
	speed: 0.0374s/iter; left time: 1429.7044s
	iters: 300, epoch: 19 | loss: 0.2244460
	speed: 0.0394s/iter; left time: 1505.0196s
	iters: 400, epoch: 19 | loss: 0.0005719
	speed: 0.0386s/iter; left time: 1468.0948s
Epoch: 19 cost time: 18.36582350730896
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0023865
	speed: 0.1780s/iter; left time: 6744.9934s
	iters: 200, epoch: 20 | loss: 0.0125932
	speed: 0.0397s/iter; left time: 1500.4600s
	iters: 300, epoch: 20 | loss: 0.0046414
	speed: 0.0395s/iter; left time: 1487.1103s
	iters: 400, epoch: 20 | loss: 0.0710900
	speed: 0.0390s/iter; left time: 1464.9539s
Epoch: 20 cost time: 18.967182874679565
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0020607
	speed: 0.1644s/iter; left time: 6151.6301s
	iters: 200, epoch: 21 | loss: 0.0002841
	speed: 0.0393s/iter; left time: 1466.8540s
	iters: 300, epoch: 21 | loss: 0.0270957
	speed: 0.0389s/iter; left time: 1447.4780s
	iters: 400, epoch: 21 | loss: 0.0005791
	speed: 0.0397s/iter; left time: 1474.3585s
Epoch: 21 cost time: 18.686532020568848
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0076499
	speed: 0.1522s/iter; left time: 5623.3221s
	iters: 200, epoch: 22 | loss: 0.0274839
	speed: 0.0369s/iter; left time: 1358.3004s
	iters: 300, epoch: 22 | loss: 0.0022849
	speed: 0.0371s/iter; left time: 1362.1919s
	iters: 400, epoch: 22 | loss: 0.0318907
	speed: 0.0372s/iter; left time: 1362.4795s
Epoch: 22 cost time: 17.71936345100403
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 672366
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2493343
	speed: 0.0491s/iter; left time: 2296.1297s
	iters: 200, epoch: 1 | loss: 0.4082980
	speed: 0.0396s/iter; left time: 1851.0752s
	iters: 300, epoch: 1 | loss: 0.7635769
	speed: 0.0395s/iter; left time: 1838.6591s
	iters: 400, epoch: 1 | loss: 0.1062121
	speed: 0.0364s/iter; left time: 1693.6259s
Epoch: 1 cost time: 19.15934920310974
Epoch: 1, Steps: 469 | Train Loss: 0.691 Vali Loss: 0.291 Vali Acc: 0.912 Test Loss: 0.291 Test Acc: 0.912
Validation loss decreased (inf --> -0.912233).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2210338
	speed: 0.1588s/iter; left time: 7358.7280s
	iters: 200, epoch: 2 | loss: 0.0394308
	speed: 0.0390s/iter; left time: 1805.2998s
	iters: 300, epoch: 2 | loss: 0.0286931
	speed: 0.0390s/iter; left time: 1799.2930s
	iters: 400, epoch: 2 | loss: 0.1062550
	speed: 0.0375s/iter; left time: 1726.4102s
Epoch: 2 cost time: 18.518299102783203
Epoch: 2, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.912233 --> -0.953686).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1588806
	speed: 0.1561s/iter; left time: 7157.5437s
	iters: 200, epoch: 3 | loss: 0.0941040
	speed: 0.0380s/iter; left time: 1738.7028s
	iters: 300, epoch: 3 | loss: 0.0195109
	speed: 0.0376s/iter; left time: 1715.6945s
	iters: 400, epoch: 3 | loss: 0.2746965
	speed: 0.0394s/iter; left time: 1794.8050s
Epoch: 3 cost time: 18.26420283317566
Epoch: 3, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.213 Vali Acc: 0.936 Test Loss: 0.213 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0532490
	speed: 0.1584s/iter; left time: 7191.8509s
	iters: 200, epoch: 4 | loss: 0.0170798
	speed: 0.0380s/iter; left time: 1720.3793s
	iters: 300, epoch: 4 | loss: 0.0619039
	speed: 0.0386s/iter; left time: 1746.7002s
	iters: 400, epoch: 4 | loss: 0.1752247
	speed: 0.0387s/iter; left time: 1744.6649s
Epoch: 4 cost time: 18.389545917510986
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (-0.953686 --> -0.959690).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0140459
	speed: 0.1547s/iter; left time: 6950.0287s
	iters: 200, epoch: 5 | loss: 0.0761489
	speed: 0.0364s/iter; left time: 1629.6925s
	iters: 300, epoch: 5 | loss: 0.0073553
	speed: 0.0382s/iter; left time: 1707.3811s
	iters: 400, epoch: 5 | loss: 0.0062347
	speed: 0.0395s/iter; left time: 1762.6009s
Epoch: 5 cost time: 18.336257219314575
Epoch: 5, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0058399
	speed: 0.1695s/iter; left time: 7536.8583s
	iters: 200, epoch: 6 | loss: 0.0511576
	speed: 0.0390s/iter; left time: 1728.0077s
	iters: 300, epoch: 6 | loss: 0.6418211
	speed: 0.0400s/iter; left time: 1770.8334s
	iters: 400, epoch: 6 | loss: 0.0023501
	speed: 0.0398s/iter; left time: 1758.8719s
Epoch: 6 cost time: 18.944922924041748
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1062870
	speed: 0.1702s/iter; left time: 7488.6733s
	iters: 200, epoch: 7 | loss: 0.1468441
	speed: 0.0397s/iter; left time: 1740.6248s
	iters: 300, epoch: 7 | loss: 0.0059844
	speed: 0.0402s/iter; left time: 1760.0738s
	iters: 400, epoch: 7 | loss: 0.2911339
	speed: 0.0395s/iter; left time: 1727.3986s
Epoch: 7 cost time: 18.879929542541504
Epoch: 7, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.278 Vali Acc: 0.938 Test Loss: 0.278 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0191065
	speed: 0.1703s/iter; left time: 7413.2001s
	iters: 200, epoch: 8 | loss: 0.0025359
	speed: 0.0387s/iter; left time: 1679.1443s
	iters: 300, epoch: 8 | loss: 0.0349958
	speed: 0.0377s/iter; left time: 1631.0199s
	iters: 400, epoch: 8 | loss: 0.0780747
	speed: 0.0380s/iter; left time: 1642.1288s
Epoch: 8 cost time: 18.11393427848816
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.959690 --> -0.975413).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0248791
	speed: 0.1280s/iter; left time: 5510.4682s
	iters: 200, epoch: 9 | loss: 0.0928678
	speed: 0.0312s/iter; left time: 1340.7152s
	iters: 300, epoch: 9 | loss: 0.0052409
	speed: 0.0291s/iter; left time: 1248.5635s
	iters: 400, epoch: 9 | loss: 0.3355347
	speed: 0.0368s/iter; left time: 1571.2817s
Epoch: 9 cost time: 15.855116128921509
Epoch: 9, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0071681
	speed: 0.1601s/iter; left time: 6817.0728s
	iters: 200, epoch: 10 | loss: 0.0694503
	speed: 0.0386s/iter; left time: 1641.6179s
	iters: 300, epoch: 10 | loss: 0.1985187
	speed: 0.0379s/iter; left time: 1605.3488s
	iters: 400, epoch: 10 | loss: 0.0902648
	speed: 0.0392s/iter; left time: 1658.3737s
Epoch: 10 cost time: 18.50277304649353
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0010210
	speed: 0.1570s/iter; left time: 6612.3658s
	iters: 200, epoch: 11 | loss: 0.0175041
	speed: 0.0366s/iter; left time: 1539.2514s
	iters: 300, epoch: 11 | loss: 0.0971773
	speed: 0.0399s/iter; left time: 1674.1109s
	iters: 400, epoch: 11 | loss: 0.0336850
	speed: 0.0370s/iter; left time: 1545.8112s
Epoch: 11 cost time: 17.99526810646057
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0015419
	speed: 0.1604s/iter; left time: 6677.8862s
	iters: 200, epoch: 12 | loss: 0.0032334
	speed: 0.0400s/iter; left time: 1660.4053s
	iters: 300, epoch: 12 | loss: 0.0858381
	speed: 0.0375s/iter; left time: 1552.4438s
	iters: 400, epoch: 12 | loss: 0.0049066
	speed: 0.0381s/iter; left time: 1575.3262s
Epoch: 12 cost time: 18.371896743774414
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1323763
	speed: 0.1539s/iter; left time: 6334.7002s
	iters: 200, epoch: 13 | loss: 0.0644169
	speed: 0.0373s/iter; left time: 1531.0694s
	iters: 300, epoch: 13 | loss: 0.0022858
	speed: 0.0383s/iter; left time: 1570.6658s
	iters: 400, epoch: 13 | loss: 0.3283048
	speed: 0.0400s/iter; left time: 1634.9227s
Epoch: 13 cost time: 18.218612909317017
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.199 Vali Acc: 0.945 Test Loss: 0.199 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0117230
	speed: 0.1548s/iter; left time: 6299.2127s
	iters: 200, epoch: 14 | loss: 0.0411377
	speed: 0.0382s/iter; left time: 1551.2070s
	iters: 300, epoch: 14 | loss: 0.0178567
	speed: 0.0381s/iter; left time: 1542.9880s
	iters: 400, epoch: 14 | loss: 0.0008036
	speed: 0.0400s/iter; left time: 1614.7757s
Epoch: 14 cost time: 18.638595581054688
Epoch: 14, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.268 Vali Acc: 0.951 Test Loss: 0.268 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0410729
	speed: 0.1751s/iter; left time: 7046.3717s
	iters: 200, epoch: 15 | loss: 0.0053043
	speed: 0.0425s/iter; left time: 1707.5984s
	iters: 300, epoch: 15 | loss: 0.0016409
	speed: 0.0392s/iter; left time: 1571.3247s
	iters: 400, epoch: 15 | loss: 0.0177840
	speed: 0.0381s/iter; left time: 1521.5641s
Epoch: 15 cost time: 19.247041702270508
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0117802
	speed: 0.1691s/iter; left time: 6724.6647s
	iters: 200, epoch: 16 | loss: 0.0044793
	speed: 0.0418s/iter; left time: 1657.2348s
	iters: 300, epoch: 16 | loss: 0.1109448
	speed: 0.0390s/iter; left time: 1544.6366s
	iters: 400, epoch: 16 | loss: 0.1886058
	speed: 0.0411s/iter; left time: 1622.6273s
Epoch: 16 cost time: 19.66127324104309
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0075805
	speed: 0.1848s/iter; left time: 7262.2204s
	iters: 200, epoch: 17 | loss: 0.0086334
	speed: 0.0406s/iter; left time: 1589.4855s
	iters: 300, epoch: 17 | loss: 0.0147445
	speed: 0.0391s/iter; left time: 1530.2902s
	iters: 400, epoch: 17 | loss: 0.0354687
	speed: 0.0382s/iter; left time: 1488.3257s
Epoch: 17 cost time: 18.808714151382446
Epoch: 17, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0010161
	speed: 0.1610s/iter; left time: 6252.4149s
	iters: 200, epoch: 18 | loss: 0.0015142
	speed: 0.0383s/iter; left time: 1484.3201s
	iters: 300, epoch: 18 | loss: 0.0447389
	speed: 0.0356s/iter; left time: 1376.1971s
	iters: 400, epoch: 18 | loss: 0.0049799
	speed: 0.0350s/iter; left time: 1349.6864s
Epoch: 18 cost time: 17.786160945892334
Epoch: 18, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.955 Test Loss: 0.212 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 672238
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3545191
	speed: 0.0503s/iter; left time: 2354.0348s
	iters: 200, epoch: 1 | loss: 0.3726374
	speed: 0.0374s/iter; left time: 1746.7272s
	iters: 300, epoch: 1 | loss: 0.2266431
	speed: 0.0379s/iter; left time: 1763.9201s
	iters: 400, epoch: 1 | loss: 0.0917871
	speed: 0.0370s/iter; left time: 1719.7666s
Epoch: 1 cost time: 18.790639400482178
Epoch: 1, Steps: 469 | Train Loss: 0.691 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
Validation loss decreased (inf --> -0.913090).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4645549
	speed: 0.1661s/iter; left time: 7695.2050s
	iters: 200, epoch: 2 | loss: 0.0969047
	speed: 0.0387s/iter; left time: 1788.2356s
	iters: 300, epoch: 2 | loss: 0.0382354
	speed: 0.0364s/iter; left time: 1677.8337s
	iters: 400, epoch: 2 | loss: 0.1592135
	speed: 0.0380s/iter; left time: 1751.2962s
Epoch: 2 cost time: 18.20054841041565
Epoch: 2, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.913090 --> -0.947969).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0819637
	speed: 0.1667s/iter; left time: 7645.1336s
	iters: 200, epoch: 3 | loss: 0.1304123
	speed: 0.0392s/iter; left time: 1791.9091s
	iters: 300, epoch: 3 | loss: 0.0790223
	speed: 0.0369s/iter; left time: 1685.9505s
	iters: 400, epoch: 3 | loss: 0.0405672
	speed: 0.0386s/iter; left time: 1759.8086s
Epoch: 3 cost time: 18.26833939552307
Epoch: 3, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.947969 --> -0.961977).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0839899
	speed: 0.1557s/iter; left time: 7066.4718s
	iters: 200, epoch: 4 | loss: 0.0228120
	speed: 0.0412s/iter; left time: 1866.5031s
	iters: 300, epoch: 4 | loss: 0.0135824
	speed: 0.0400s/iter; left time: 1807.1688s
	iters: 400, epoch: 4 | loss: 0.0374162
	speed: 0.0406s/iter; left time: 1832.5803s
Epoch: 4 cost time: 18.78417444229126
Epoch: 4, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0485544
	speed: 0.1342s/iter; left time: 6029.4624s
	iters: 200, epoch: 5 | loss: 0.1375931
	speed: 0.0352s/iter; left time: 1576.1921s
	iters: 300, epoch: 5 | loss: 0.1633419
	speed: 0.0387s/iter; left time: 1732.9291s
	iters: 400, epoch: 5 | loss: 0.1060878
	speed: 0.0374s/iter; left time: 1666.9490s
Epoch: 5 cost time: 17.663349628448486
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.961977 --> -0.965694).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1106303
	speed: 0.1681s/iter; left time: 7473.1673s
	iters: 200, epoch: 6 | loss: 0.0066893
	speed: 0.0355s/iter; left time: 1576.7820s
	iters: 300, epoch: 6 | loss: 0.0069588
	speed: 0.0399s/iter; left time: 1767.5560s
	iters: 400, epoch: 6 | loss: 0.0120120
	speed: 0.0376s/iter; left time: 1661.2593s
Epoch: 6 cost time: 18.155123710632324
Epoch: 6, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0026520
	speed: 0.1676s/iter; left time: 7373.5424s
	iters: 200, epoch: 7 | loss: 0.0408308
	speed: 0.0412s/iter; left time: 1806.7605s
	iters: 300, epoch: 7 | loss: 0.0480015
	speed: 0.0394s/iter; left time: 1726.2167s
	iters: 400, epoch: 7 | loss: 0.0057662
	speed: 0.0390s/iter; left time: 1703.7778s
Epoch: 7 cost time: 18.7261164188385
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.965694 --> -0.969982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0703889
	speed: 0.1723s/iter; left time: 7498.0765s
	iters: 200, epoch: 8 | loss: 0.0162568
	speed: 0.0360s/iter; left time: 1562.5284s
	iters: 300, epoch: 8 | loss: 0.2063313
	speed: 0.0360s/iter; left time: 1558.0817s
	iters: 400, epoch: 8 | loss: 0.0105067
	speed: 0.0362s/iter; left time: 1566.0861s
Epoch: 8 cost time: 17.441217184066772
Epoch: 8, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0104197
	speed: 0.1476s/iter; left time: 6351.9532s
	iters: 200, epoch: 9 | loss: 0.0044632
	speed: 0.0356s/iter; left time: 1528.9903s
	iters: 300, epoch: 9 | loss: 0.3561509
	speed: 0.0373s/iter; left time: 1597.1426s
	iters: 400, epoch: 9 | loss: 0.0157470
	speed: 0.0368s/iter; left time: 1574.9106s
Epoch: 9 cost time: 17.49484395980835
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0170067
	speed: 0.1592s/iter; left time: 6779.4008s
	iters: 200, epoch: 10 | loss: 0.2434396
	speed: 0.0374s/iter; left time: 1586.9771s
	iters: 300, epoch: 10 | loss: 0.0039615
	speed: 0.0382s/iter; left time: 1619.7027s
	iters: 400, epoch: 10 | loss: 0.0040875
	speed: 0.0377s/iter; left time: 1594.1833s
Epoch: 10 cost time: 17.838515281677246
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0630840
	speed: 0.1422s/iter; left time: 5989.6133s
	iters: 200, epoch: 11 | loss: 0.0571847
	speed: 0.0359s/iter; left time: 1508.5466s
	iters: 300, epoch: 11 | loss: 0.0033561
	speed: 0.0348s/iter; left time: 1459.4883s
	iters: 400, epoch: 11 | loss: 0.0014293
	speed: 0.0359s/iter; left time: 1499.8992s
Epoch: 11 cost time: 17.216375827789307
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2417718
	speed: 0.1483s/iter; left time: 6177.2613s
	iters: 200, epoch: 12 | loss: 0.0044226
	speed: 0.0349s/iter; left time: 1451.2500s
	iters: 300, epoch: 12 | loss: 0.0055135
	speed: 0.0340s/iter; left time: 1409.6624s
	iters: 400, epoch: 12 | loss: 0.0327681
	speed: 0.0370s/iter; left time: 1529.6180s
Epoch: 12 cost time: 17.04460072517395
Epoch: 12, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0033650
	speed: 0.1569s/iter; left time: 6461.6976s
	iters: 200, epoch: 13 | loss: 0.0737547
	speed: 0.0345s/iter; left time: 1417.0471s
	iters: 300, epoch: 13 | loss: 0.0160248
	speed: 0.0352s/iter; left time: 1443.9197s
	iters: 400, epoch: 13 | loss: 0.0023168
	speed: 0.0337s/iter; left time: 1376.8258s
Epoch: 13 cost time: 16.548664331436157
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0098236
	speed: 0.1478s/iter; left time: 6015.1730s
	iters: 200, epoch: 14 | loss: 0.0043123
	speed: 0.0378s/iter; left time: 1534.8028s
	iters: 300, epoch: 14 | loss: 0.0017524
	speed: 0.0397s/iter; left time: 1607.5536s
	iters: 400, epoch: 14 | loss: 0.0256828
	speed: 0.0377s/iter; left time: 1521.2993s
Epoch: 14 cost time: 18.182456970214844
Epoch: 14, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0185074
	speed: 0.1706s/iter; left time: 6864.9770s
	iters: 200, epoch: 15 | loss: 0.0296150
	speed: 0.0400s/iter; left time: 1604.3385s
	iters: 300, epoch: 15 | loss: 0.4685351
	speed: 0.0382s/iter; left time: 1531.1815s
	iters: 400, epoch: 15 | loss: 0.0048253
	speed: 0.0364s/iter; left time: 1451.9960s
Epoch: 15 cost time: 18.44474220275879
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0097445
	speed: 0.1607s/iter; left time: 6388.5422s
	iters: 200, epoch: 16 | loss: 0.2048876
	speed: 0.0330s/iter; left time: 1310.8008s
	iters: 300, epoch: 16 | loss: 0.0081309
	speed: 0.0335s/iter; left time: 1324.6659s
	iters: 400, epoch: 16 | loss: 0.0104602
	speed: 0.0316s/iter; left time: 1247.1025s
Epoch: 16 cost time: 15.8960440158844
Epoch: 16, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0087777
	speed: 0.1499s/iter; left time: 5890.2148s
	iters: 200, epoch: 17 | loss: 0.0003744
	speed: 0.0352s/iter; left time: 1378.3600s
	iters: 300, epoch: 17 | loss: 0.2503937
	speed: 0.0368s/iter; left time: 1438.6832s
	iters: 400, epoch: 17 | loss: 0.0034729
	speed: 0.0371s/iter; left time: 1448.6370s
Epoch: 17 cost time: 17.44352412223816
Epoch: 17, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.252 Vali Acc: 0.955 Test Loss: 0.252 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9699828473413379
model parameter : 672110
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9365326
	speed: 0.0510s/iter; left time: 2387.4387s
	iters: 200, epoch: 1 | loss: 0.4496740
	speed: 0.0359s/iter; left time: 1676.8571s
	iters: 300, epoch: 1 | loss: 0.3022455
	speed: 0.0365s/iter; left time: 1703.0103s
	iters: 400, epoch: 1 | loss: 0.3270406
	speed: 0.0366s/iter; left time: 1700.1062s
Epoch: 1 cost time: 18.673510789871216
Epoch: 1, Steps: 469 | Train Loss: 0.694 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
Validation loss decreased (inf --> -0.914520).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0307778
	speed: 0.1471s/iter; left time: 6817.6298s
	iters: 200, epoch: 2 | loss: 0.0838451
	speed: 0.0357s/iter; left time: 1649.1894s
	iters: 300, epoch: 2 | loss: 0.2232765
	speed: 0.0354s/iter; left time: 1635.2748s
	iters: 400, epoch: 2 | loss: 0.0329141
	speed: 0.0353s/iter; left time: 1624.3236s
Epoch: 2 cost time: 16.716593503952026
Epoch: 2, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.234 Vali Acc: 0.927 Test Loss: 0.234 Test Acc: 0.927
Validation loss decreased (-0.914520 --> -0.927385).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2029664
	speed: 0.1544s/iter; left time: 7082.2250s
	iters: 200, epoch: 3 | loss: 0.0472834
	speed: 0.0363s/iter; left time: 1662.0939s
	iters: 300, epoch: 3 | loss: 0.7303781
	speed: 0.0349s/iter; left time: 1592.2911s
	iters: 400, epoch: 3 | loss: 0.1145011
	speed: 0.0365s/iter; left time: 1664.0735s
Epoch: 3 cost time: 17.209941625595093
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.206 Vali Acc: 0.936 Test Loss: 0.206 Test Acc: 0.936
Validation loss decreased (-0.927385 --> -0.936247).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0698287
	speed: 0.1618s/iter; left time: 7345.7600s
	iters: 200, epoch: 4 | loss: 0.0191517
	speed: 0.0357s/iter; left time: 1617.0990s
	iters: 300, epoch: 4 | loss: 0.0095458
	speed: 0.0375s/iter; left time: 1695.3566s
	iters: 400, epoch: 4 | loss: 0.1074040
	speed: 0.0355s/iter; left time: 1599.9837s
Epoch: 4 cost time: 17.12200117111206
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
Validation loss decreased (-0.936247 --> -0.943108).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0170312
	speed: 0.1442s/iter; left time: 6479.7365s
	iters: 200, epoch: 5 | loss: 0.0151041
	speed: 0.0347s/iter; left time: 1557.6282s
	iters: 300, epoch: 5 | loss: 0.0032568
	speed: 0.0359s/iter; left time: 1605.5369s
	iters: 400, epoch: 5 | loss: 0.0561452
	speed: 0.0344s/iter; left time: 1533.3013s
Epoch: 5 cost time: 16.79863977432251
Epoch: 5, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
Validation loss decreased (-0.943108 --> -0.953400).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0056450
	speed: 0.1549s/iter; left time: 6888.1840s
	iters: 200, epoch: 6 | loss: 0.0284700
	speed: 0.0371s/iter; left time: 1647.2557s
	iters: 300, epoch: 6 | loss: 0.0898349
	speed: 0.0379s/iter; left time: 1676.2453s
	iters: 400, epoch: 6 | loss: 0.0057608
	speed: 0.0368s/iter; left time: 1625.7456s
Epoch: 6 cost time: 17.845547199249268
Epoch: 6, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.205 Vali Acc: 0.947 Test Loss: 0.205 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1983861
	speed: 0.1604s/iter; left time: 7056.9564s
	iters: 200, epoch: 7 | loss: 0.0262740
	speed: 0.0365s/iter; left time: 1602.6336s
	iters: 300, epoch: 7 | loss: 0.0544873
	speed: 0.0364s/iter; left time: 1595.1433s
	iters: 400, epoch: 7 | loss: 0.0516282
	speed: 0.0365s/iter; left time: 1595.5108s
Epoch: 7 cost time: 17.693729639053345
Epoch: 7, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.953400 --> -0.965122).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0373824
	speed: 0.1716s/iter; left time: 7468.6619s
	iters: 200, epoch: 8 | loss: 0.1789176
	speed: 0.0394s/iter; left time: 1712.6809s
	iters: 300, epoch: 8 | loss: 0.0067973
	speed: 0.0395s/iter; left time: 1712.1976s
	iters: 400, epoch: 8 | loss: 0.0247912
	speed: 0.0389s/iter; left time: 1680.7396s
Epoch: 8 cost time: 18.83354949951172
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4094126
	speed: 0.1653s/iter; left time: 7118.0598s
	iters: 200, epoch: 9 | loss: 0.0118772
	speed: 0.0355s/iter; left time: 1524.2035s
	iters: 300, epoch: 9 | loss: 0.0016142
	speed: 0.0366s/iter; left time: 1566.4640s
	iters: 400, epoch: 9 | loss: 0.0033680
	speed: 0.0335s/iter; left time: 1432.0668s
Epoch: 9 cost time: 16.96387028694153
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
Validation loss decreased (-0.965122 --> -0.968552).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0025130
	speed: 0.1519s/iter; left time: 6467.7262s
	iters: 200, epoch: 10 | loss: 0.0303428
	speed: 0.0341s/iter; left time: 1449.0625s
	iters: 300, epoch: 10 | loss: 0.0050569
	speed: 0.0351s/iter; left time: 1489.6117s
	iters: 400, epoch: 10 | loss: 0.1097751
	speed: 0.0359s/iter; left time: 1519.0347s
Epoch: 10 cost time: 17.125576972961426
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0552679
	speed: 0.1541s/iter; left time: 6489.6950s
	iters: 200, epoch: 11 | loss: 0.0175154
	speed: 0.0386s/iter; left time: 1623.6099s
	iters: 300, epoch: 11 | loss: 0.0071744
	speed: 0.0337s/iter; left time: 1412.1667s
	iters: 400, epoch: 11 | loss: 0.0045045
	speed: 0.0349s/iter; left time: 1458.1152s
Epoch: 11 cost time: 17.106587409973145
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2794284
	speed: 0.1530s/iter; left time: 6371.9092s
	iters: 200, epoch: 12 | loss: 0.0164781
	speed: 0.0356s/iter; left time: 1477.9309s
	iters: 300, epoch: 12 | loss: 0.0084484
	speed: 0.0371s/iter; left time: 1539.0392s
	iters: 400, epoch: 12 | loss: 0.3128386
	speed: 0.0352s/iter; left time: 1455.3660s
Epoch: 12 cost time: 17.03087615966797
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0101478
	speed: 0.1387s/iter; left time: 5712.7279s
	iters: 200, epoch: 13 | loss: 0.0306093
	speed: 0.0302s/iter; left time: 1239.3860s
	iters: 300, epoch: 13 | loss: 0.0034312
	speed: 0.0306s/iter; left time: 1254.2381s
	iters: 400, epoch: 13 | loss: 0.0064917
	speed: 0.0304s/iter; left time: 1244.5784s
Epoch: 13 cost time: 14.855335235595703
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1254105
	speed: 0.1572s/iter; left time: 6397.4433s
	iters: 200, epoch: 14 | loss: 0.0100442
	speed: 0.0377s/iter; left time: 1531.5830s
	iters: 300, epoch: 14 | loss: 0.0945101
	speed: 0.0374s/iter; left time: 1516.1662s
	iters: 400, epoch: 14 | loss: 0.0025065
	speed: 0.0373s/iter; left time: 1507.5118s
Epoch: 14 cost time: 17.95344853401184
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0022919
	speed: 0.1574s/iter; left time: 6334.2135s
	iters: 200, epoch: 15 | loss: 0.1016870
	speed: 0.0381s/iter; left time: 1529.1741s
	iters: 300, epoch: 15 | loss: 0.0154488
	speed: 0.0392s/iter; left time: 1567.6343s
	iters: 400, epoch: 15 | loss: 0.0017474
	speed: 0.0377s/iter; left time: 1506.2621s
Epoch: 15 cost time: 18.018322229385376
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1958449
	speed: 0.1644s/iter; left time: 6538.4262s
	iters: 200, epoch: 16 | loss: 0.0041143
	speed: 0.0373s/iter; left time: 1479.1449s
	iters: 300, epoch: 16 | loss: 0.0498814
	speed: 0.0376s/iter; left time: 1487.8240s
	iters: 400, epoch: 16 | loss: 0.0353183
	speed: 0.0363s/iter; left time: 1433.1015s
Epoch: 16 cost time: 17.919158697128296
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970267).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2378095
	speed: 0.1723s/iter; left time: 6768.9335s
	iters: 200, epoch: 17 | loss: 0.0147869
	speed: 0.0377s/iter; left time: 1476.3853s
	iters: 300, epoch: 17 | loss: 0.0033988
	speed: 0.0388s/iter; left time: 1518.0344s
	iters: 400, epoch: 17 | loss: 0.0027473
	speed: 0.0385s/iter; left time: 1501.0957s
Epoch: 17 cost time: 18.24616575241089
Epoch: 17, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.961 Test Loss: 0.191 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1303896
	speed: 0.1623s/iter; left time: 6302.8633s
	iters: 200, epoch: 18 | loss: 0.0820286
	speed: 0.0349s/iter; left time: 1350.5770s
	iters: 300, epoch: 18 | loss: 0.0022346
	speed: 0.0351s/iter; left time: 1356.0545s
	iters: 400, epoch: 18 | loss: 0.0190498
	speed: 0.0360s/iter; left time: 1388.1144s
Epoch: 18 cost time: 16.951170206069946
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0713506
	speed: 0.1506s/iter; left time: 5776.9567s
	iters: 200, epoch: 19 | loss: 0.0626661
	speed: 0.0357s/iter; left time: 1367.0622s
	iters: 300, epoch: 19 | loss: 0.0045449
	speed: 0.0371s/iter; left time: 1416.4777s
	iters: 400, epoch: 19 | loss: 0.0012138
	speed: 0.0365s/iter; left time: 1391.0120s
Epoch: 19 cost time: 17.10149836540222
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003751
	speed: 0.1455s/iter; left time: 5512.5664s
	iters: 200, epoch: 20 | loss: 0.3994833
	speed: 0.0351s/iter; left time: 1327.0604s
	iters: 300, epoch: 20 | loss: 0.0014001
	speed: 0.0368s/iter; left time: 1388.5318s
	iters: 400, epoch: 20 | loss: 0.0767976
	speed: 0.0354s/iter; left time: 1328.8243s
Epoch: 20 cost time: 16.84914994239807
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0124981
	speed: 0.1527s/iter; left time: 5714.6620s
	iters: 200, epoch: 21 | loss: 0.0034156
	speed: 0.0360s/iter; left time: 1343.6789s
	iters: 300, epoch: 21 | loss: 0.0436236
	speed: 0.0351s/iter; left time: 1308.2144s
	iters: 400, epoch: 21 | loss: 0.0052618
	speed: 0.0341s/iter; left time: 1264.2074s
Epoch: 21 cost time: 16.904019594192505
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.954 Test Loss: 0.198 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0160730
	speed: 0.1548s/iter; left time: 5721.1784s
	iters: 200, epoch: 22 | loss: 0.0372451
	speed: 0.0368s/iter; left time: 1354.8547s
	iters: 300, epoch: 22 | loss: 0.1384189
	speed: 0.0347s/iter; left time: 1275.6860s
	iters: 400, epoch: 22 | loss: 0.0066899
	speed: 0.0378s/iter; left time: 1387.0363s
Epoch: 22 cost time: 17.52525281906128
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0085101
	speed: 0.1489s/iter; left time: 5433.9136s
	iters: 200, epoch: 23 | loss: 0.0015367
	speed: 0.0343s/iter; left time: 1249.4651s
	iters: 300, epoch: 23 | loss: 0.5212935
	speed: 0.0362s/iter; left time: 1312.1458s
	iters: 400, epoch: 23 | loss: 0.2566043
	speed: 0.0348s/iter; left time: 1260.6820s
Epoch: 23 cost time: 16.86517882347107
Epoch: 23, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1511460
	speed: 0.1593s/iter; left time: 5735.9820s
	iters: 200, epoch: 24 | loss: 0.0059384
	speed: 0.0356s/iter; left time: 1279.2921s
	iters: 300, epoch: 24 | loss: 0.8797286
	speed: 0.0354s/iter; left time: 1269.2871s
	iters: 400, epoch: 24 | loss: 0.0172516
	speed: 0.0369s/iter; left time: 1319.6170s
Epoch: 24 cost time: 17.358747720718384
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.310 Vali Acc: 0.932 Test Loss: 0.310 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0009744
	speed: 0.1590s/iter; left time: 5652.5116s
	iters: 200, epoch: 25 | loss: 0.0132217
	speed: 0.0384s/iter; left time: 1361.8785s
	iters: 300, epoch: 25 | loss: 0.0007219
	speed: 0.0374s/iter; left time: 1322.1271s
	iters: 400, epoch: 25 | loss: 0.0034339
	speed: 0.0400s/iter; left time: 1408.4862s
Epoch: 25 cost time: 18.321046590805054
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0009095
	speed: 0.1664s/iter; left time: 5837.5639s
	iters: 200, epoch: 26 | loss: 0.0191038
	speed: 0.0392s/iter; left time: 1371.6476s
	iters: 300, epoch: 26 | loss: 0.0004299
	speed: 0.0400s/iter; left time: 1394.3300s
	iters: 400, epoch: 26 | loss: 0.0004848
	speed: 0.0368s/iter; left time: 1278.8236s
Epoch: 26 cost time: 18.37919521331787
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 671982
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2923973
	speed: 0.0456s/iter; left time: 2133.8714s
	iters: 200, epoch: 1 | loss: 0.5913733
	speed: 0.0325s/iter; left time: 1517.7507s
	iters: 300, epoch: 1 | loss: 0.6066701
	speed: 0.0360s/iter; left time: 1677.7814s
	iters: 400, epoch: 1 | loss: 0.2411020
	speed: 0.0350s/iter; left time: 1625.5111s
Epoch: 1 cost time: 17.438780307769775
Epoch: 1, Steps: 469 | Train Loss: 0.735 Vali Loss: 0.274 Vali Acc: 0.907 Test Loss: 0.274 Test Acc: 0.907
Validation loss decreased (inf --> -0.907087).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1238222
	speed: 0.1452s/iter; left time: 6726.9538s
	iters: 200, epoch: 2 | loss: 0.0685524
	speed: 0.0369s/iter; left time: 1707.4121s
	iters: 300, epoch: 2 | loss: 0.2102856
	speed: 0.0348s/iter; left time: 1606.5728s
	iters: 400, epoch: 2 | loss: 0.0233488
	speed: 0.0357s/iter; left time: 1643.1692s
Epoch: 2 cost time: 17.41062092781067
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
Validation loss decreased (-0.907087 --> -0.924812).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2675477
	speed: 0.1668s/iter; left time: 7650.8426s
	iters: 200, epoch: 3 | loss: 0.0739332
	speed: 0.0380s/iter; left time: 1737.9269s
	iters: 300, epoch: 3 | loss: 0.1596069
	speed: 0.0388s/iter; left time: 1773.6729s
	iters: 400, epoch: 3 | loss: 0.0123849
	speed: 0.0370s/iter; left time: 1686.1215s
Epoch: 3 cost time: 18.06043243408203
Epoch: 3, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.175 Vali Acc: 0.945 Test Loss: 0.175 Test Acc: 0.945
Validation loss decreased (-0.924812 --> -0.944538).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0069225
	speed: 0.1433s/iter; left time: 6504.6530s
	iters: 200, epoch: 4 | loss: 0.0083126
	speed: 0.0351s/iter; left time: 1590.4498s
	iters: 300, epoch: 4 | loss: 0.0077604
	speed: 0.0364s/iter; left time: 1645.5162s
	iters: 400, epoch: 4 | loss: 0.5774577
	speed: 0.0365s/iter; left time: 1646.6584s
Epoch: 4 cost time: 17.037989616394043
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.944538 --> -0.955973).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1425838
	speed: 0.1555s/iter; left time: 6984.3716s
	iters: 200, epoch: 5 | loss: 0.0205782
	speed: 0.0370s/iter; left time: 1658.9136s
	iters: 300, epoch: 5 | loss: 0.1202703
	speed: 0.0352s/iter; left time: 1573.9727s
	iters: 400, epoch: 5 | loss: 0.0048813
	speed: 0.0361s/iter; left time: 1611.1872s
Epoch: 5 cost time: 17.306476593017578
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.955973 --> -0.959118).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0167055
	speed: 0.1529s/iter; left time: 6798.7186s
	iters: 200, epoch: 6 | loss: 0.6507174
	speed: 0.0383s/iter; left time: 1698.3515s
	iters: 300, epoch: 6 | loss: 0.0200766
	speed: 0.0360s/iter; left time: 1593.8095s
	iters: 400, epoch: 6 | loss: 0.0138528
	speed: 0.0364s/iter; left time: 1608.6434s
Epoch: 6 cost time: 17.244924783706665
Epoch: 6, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0104627
	speed: 0.1576s/iter; left time: 6932.8476s
	iters: 200, epoch: 7 | loss: 0.0245604
	speed: 0.0408s/iter; left time: 1791.9838s
	iters: 300, epoch: 7 | loss: 0.2658003
	speed: 0.0388s/iter; left time: 1701.0170s
	iters: 400, epoch: 7 | loss: 0.0126534
	speed: 0.0395s/iter; left time: 1726.0949s
Epoch: 7 cost time: 19.15503239631653
Epoch: 7, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.959118 --> -0.959404).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0444253
	speed: 0.1802s/iter; left time: 7840.2057s
	iters: 200, epoch: 8 | loss: 0.0771124
	speed: 0.0408s/iter; left time: 1770.6397s
	iters: 300, epoch: 8 | loss: 0.0137948
	speed: 0.0398s/iter; left time: 1723.9571s
	iters: 400, epoch: 8 | loss: 0.0101393
	speed: 0.0397s/iter; left time: 1716.4117s
Epoch: 8 cost time: 19.288106441497803
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0222369
	speed: 0.1722s/iter; left time: 7411.1324s
	iters: 200, epoch: 9 | loss: 0.0007724
	speed: 0.0421s/iter; left time: 1807.1972s
	iters: 300, epoch: 9 | loss: 0.0208972
	speed: 0.0388s/iter; left time: 1660.9222s
	iters: 400, epoch: 9 | loss: 0.2306794
	speed: 0.0402s/iter; left time: 1717.5222s
Epoch: 9 cost time: 19.382509469985962
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.240 Vali Acc: 0.934 Test Loss: 0.240 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0392398
	speed: 0.1622s/iter; left time: 6905.6880s
	iters: 200, epoch: 10 | loss: 0.0158426
	speed: 0.0359s/iter; left time: 1526.6987s
	iters: 300, epoch: 10 | loss: 0.0036138
	speed: 0.0368s/iter; left time: 1561.5294s
	iters: 400, epoch: 10 | loss: 0.0140295
	speed: 0.0331s/iter; left time: 1401.4687s
Epoch: 10 cost time: 16.591230392456055
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0032791
	speed: 0.1365s/iter; left time: 5748.7818s
	iters: 200, epoch: 11 | loss: 0.0814974
	speed: 0.0365s/iter; left time: 1535.1893s
	iters: 300, epoch: 11 | loss: 0.0085144
	speed: 0.0358s/iter; left time: 1498.6628s
	iters: 400, epoch: 11 | loss: 0.0050059
	speed: 0.0371s/iter; left time: 1549.6701s
Epoch: 11 cost time: 17.369800806045532
Epoch: 11, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0024301
	speed: 0.1550s/iter; left time: 6455.7232s
	iters: 200, epoch: 12 | loss: 0.0025771
	speed: 0.0375s/iter; left time: 1558.8597s
	iters: 300, epoch: 12 | loss: 0.0884832
	speed: 0.0373s/iter; left time: 1544.0742s
	iters: 400, epoch: 12 | loss: 0.0449547
	speed: 0.0350s/iter; left time: 1446.1315s
Epoch: 12 cost time: 17.622350454330444
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.959404 --> -0.970839).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0244840
	speed: 0.1463s/iter; left time: 6025.4834s
	iters: 200, epoch: 13 | loss: 0.0573388
	speed: 0.0352s/iter; left time: 1443.9846s
	iters: 300, epoch: 13 | loss: 0.0047513
	speed: 0.0351s/iter; left time: 1437.8141s
	iters: 400, epoch: 13 | loss: 0.3007144
	speed: 0.0357s/iter; left time: 1458.2119s
Epoch: 13 cost time: 16.580623865127563
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0925306
	speed: 0.1182s/iter; left time: 4812.5485s
	iters: 200, epoch: 14 | loss: 0.0072701
	speed: 0.0331s/iter; left time: 1342.6931s
	iters: 300, epoch: 14 | loss: 0.0068295
	speed: 0.0298s/iter; left time: 1207.7888s
	iters: 400, epoch: 14 | loss: 0.0070513
	speed: 0.0348s/iter; left time: 1405.3306s
Epoch: 14 cost time: 15.615742444992065
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0401492
	speed: 0.1442s/iter; left time: 5800.1929s
	iters: 200, epoch: 15 | loss: 0.1854852
	speed: 0.0347s/iter; left time: 1392.1078s
	iters: 300, epoch: 15 | loss: 0.0020967
	speed: 0.0373s/iter; left time: 1493.5399s
	iters: 400, epoch: 15 | loss: 0.5074630
	speed: 0.0375s/iter; left time: 1496.0759s
Epoch: 15 cost time: 17.292168140411377
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0025110
	speed: 0.1479s/iter; left time: 5881.3291s
	iters: 200, epoch: 16 | loss: 0.0379920
	speed: 0.0389s/iter; left time: 1543.5759s
	iters: 300, epoch: 16 | loss: 0.2154255
	speed: 0.0382s/iter; left time: 1510.5100s
	iters: 400, epoch: 16 | loss: 0.0035011
	speed: 0.0369s/iter; left time: 1456.4185s
Epoch: 16 cost time: 18.097376346588135
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0077495
	speed: 0.1641s/iter; left time: 6449.8889s
	iters: 200, epoch: 17 | loss: 0.4543023
	speed: 0.0403s/iter; left time: 1580.6073s
	iters: 300, epoch: 17 | loss: 0.2685614
	speed: 0.0405s/iter; left time: 1584.2377s
	iters: 400, epoch: 17 | loss: 0.0028436
	speed: 0.0404s/iter; left time: 1576.5382s
Epoch: 17 cost time: 19.079497575759888
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0073660
	speed: 0.1681s/iter; left time: 6528.7906s
	iters: 200, epoch: 18 | loss: 0.0027437
	speed: 0.0362s/iter; left time: 1400.2731s
	iters: 300, epoch: 18 | loss: 0.0909185
	speed: 0.0384s/iter; left time: 1482.6663s
	iters: 400, epoch: 18 | loss: 0.0033423
	speed: 0.0384s/iter; left time: 1478.6906s
Epoch: 18 cost time: 18.006739616394043
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0016898
	speed: 0.1619s/iter; left time: 6210.3611s
	iters: 200, epoch: 19 | loss: 0.0169650
	speed: 0.0376s/iter; left time: 1436.8179s
	iters: 300, epoch: 19 | loss: 0.3147481
	speed: 0.0392s/iter; left time: 1494.7365s
	iters: 400, epoch: 19 | loss: 0.0089125
	speed: 0.0382s/iter; left time: 1454.5604s
Epoch: 19 cost time: 18.591049432754517
Epoch: 19, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0576048
	speed: 0.1565s/iter; left time: 5929.3885s
	iters: 200, epoch: 20 | loss: 0.0198406
	speed: 0.0341s/iter; left time: 1287.5126s
	iters: 300, epoch: 20 | loss: 0.2727456
	speed: 0.0340s/iter; left time: 1280.1590s
	iters: 400, epoch: 20 | loss: 0.0054949
	speed: 0.0339s/iter; left time: 1274.1563s
Epoch: 20 cost time: 16.555396556854248
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0078486
	speed: 0.1546s/iter; left time: 5787.1549s
	iters: 200, epoch: 21 | loss: 0.0003630
	speed: 0.0374s/iter; left time: 1394.8553s
	iters: 300, epoch: 21 | loss: 0.0022351
	speed: 0.0347s/iter; left time: 1290.4696s
	iters: 400, epoch: 21 | loss: 0.0009016
	speed: 0.0375s/iter; left time: 1390.8388s
Epoch: 21 cost time: 17.44898557662964
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2865800
	speed: 0.1509s/iter; left time: 5576.6503s
	iters: 200, epoch: 22 | loss: 0.0016690
	speed: 0.0366s/iter; left time: 1348.8584s
	iters: 300, epoch: 22 | loss: 0.1652596
	speed: 0.0385s/iter; left time: 1416.7112s
	iters: 400, epoch: 22 | loss: 0.0019320
	speed: 0.0350s/iter; left time: 1281.9544s
Epoch: 22 cost time: 17.66591191291809
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9708404802744426
model parameter : 507246
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0107406
	speed: 0.0492s/iter; left time: 2300.7711s
	iters: 200, epoch: 1 | loss: 0.5703610
	speed: 0.0362s/iter; left time: 1691.9112s
	iters: 300, epoch: 1 | loss: 0.3065690
	speed: 0.0354s/iter; left time: 1651.5705s
	iters: 400, epoch: 1 | loss: 0.2631879
	speed: 0.0354s/iter; left time: 1648.3453s
Epoch: 1 cost time: 17.955071449279785
Epoch: 1, Steps: 469 | Train Loss: 0.711 Vali Loss: 0.327 Vali Acc: 0.896 Test Loss: 0.327 Test Acc: 0.896
Validation loss decreased (inf --> -0.895937).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0715151
	speed: 0.1475s/iter; left time: 6833.2220s
	iters: 200, epoch: 2 | loss: 0.2597304
	speed: 0.0365s/iter; left time: 1688.8191s
	iters: 300, epoch: 2 | loss: 0.1296553
	speed: 0.0357s/iter; left time: 1645.9556s
	iters: 400, epoch: 2 | loss: 0.0803655
	speed: 0.0353s/iter; left time: 1626.9686s
Epoch: 2 cost time: 17.181792736053467
Epoch: 2, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.222 Vali Acc: 0.938 Test Loss: 0.222 Test Acc: 0.938
Validation loss decreased (-0.895937 --> -0.937962).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1757860
	speed: 0.1475s/iter; left time: 6764.5494s
	iters: 200, epoch: 3 | loss: 0.1078274
	speed: 0.0349s/iter; left time: 1596.6128s
	iters: 300, epoch: 3 | loss: 0.0907401
	speed: 0.0391s/iter; left time: 1784.8853s
	iters: 400, epoch: 3 | loss: 0.0066766
	speed: 0.0359s/iter; left time: 1635.1224s
Epoch: 3 cost time: 17.23783254623413
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.937962 --> -0.951399).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0257422
	speed: 0.1521s/iter; left time: 6902.3138s
	iters: 200, epoch: 4 | loss: 0.2738891
	speed: 0.0366s/iter; left time: 1659.6519s
	iters: 300, epoch: 4 | loss: 0.0275778
	speed: 0.0362s/iter; left time: 1634.7092s
	iters: 400, epoch: 4 | loss: 0.0344490
	speed: 0.0391s/iter; left time: 1761.7581s
Epoch: 4 cost time: 17.845119953155518
Epoch: 4, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (-0.951399 --> -0.955116).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0317530
	speed: 0.1690s/iter; left time: 7590.1466s
	iters: 200, epoch: 5 | loss: 0.0147343
	speed: 0.0374s/iter; left time: 1678.3718s
	iters: 300, epoch: 5 | loss: 0.0301543
	speed: 0.0385s/iter; left time: 1721.6872s
	iters: 400, epoch: 5 | loss: 0.0467422
	speed: 0.0378s/iter; left time: 1688.8708s
Epoch: 5 cost time: 17.858622550964355
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.287 Vali Acc: 0.924 Test Loss: 0.287 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0108386
	speed: 0.1626s/iter; left time: 7226.7997s
	iters: 200, epoch: 6 | loss: 0.4400444
	speed: 0.0394s/iter; left time: 1748.2757s
	iters: 300, epoch: 6 | loss: 0.0439518
	speed: 0.0364s/iter; left time: 1608.8699s
	iters: 400, epoch: 6 | loss: 0.0017316
	speed: 0.0384s/iter; left time: 1694.4399s
Epoch: 6 cost time: 18.268308877944946
Epoch: 6, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0881234
	speed: 0.1643s/iter; left time: 7229.1720s
	iters: 200, epoch: 7 | loss: 0.0054350
	speed: 0.0367s/iter; left time: 1608.5461s
	iters: 300, epoch: 7 | loss: 0.0132661
	speed: 0.0362s/iter; left time: 1583.8217s
	iters: 400, epoch: 7 | loss: 0.0027246
	speed: 0.0341s/iter; left time: 1490.5155s
Epoch: 7 cost time: 17.338852405548096
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0591209
	speed: 0.1530s/iter; left time: 6657.9489s
	iters: 200, epoch: 8 | loss: 0.0897753
	speed: 0.0360s/iter; left time: 1561.3190s
	iters: 300, epoch: 8 | loss: 0.0020847
	speed: 0.0357s/iter; left time: 1547.2774s
	iters: 400, epoch: 8 | loss: 0.1100080
	speed: 0.0340s/iter; left time: 1467.5106s
Epoch: 8 cost time: 16.859612703323364
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.955116 --> -0.969410).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0025195
	speed: 0.1067s/iter; left time: 4592.1597s
	iters: 200, epoch: 9 | loss: 0.0030711
	speed: 0.0326s/iter; left time: 1400.5328s
	iters: 300, epoch: 9 | loss: 0.0048507
	speed: 0.0341s/iter; left time: 1461.9013s
	iters: 400, epoch: 9 | loss: 0.1488307
	speed: 0.0356s/iter; left time: 1520.4770s
Epoch: 9 cost time: 16.12521195411682
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0259453
	speed: 0.1519s/iter; left time: 6468.2137s
	iters: 200, epoch: 10 | loss: 0.0059065
	speed: 0.0347s/iter; left time: 1475.8426s
	iters: 300, epoch: 10 | loss: 0.0012423
	speed: 0.0361s/iter; left time: 1531.7502s
	iters: 400, epoch: 10 | loss: 0.0191303
	speed: 0.0344s/iter; left time: 1455.9826s
Epoch: 10 cost time: 16.915155172348022
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0102193
	speed: 0.1550s/iter; left time: 6528.0620s
	iters: 200, epoch: 11 | loss: 0.0064498
	speed: 0.0364s/iter; left time: 1527.1910s
	iters: 300, epoch: 11 | loss: 0.0560437
	speed: 0.0360s/iter; left time: 1510.7419s
	iters: 400, epoch: 11 | loss: 0.0037356
	speed: 0.0358s/iter; left time: 1498.9097s
Epoch: 11 cost time: 17.542863845825195
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0236532
	speed: 0.1601s/iter; left time: 6668.8986s
	iters: 200, epoch: 12 | loss: 0.0031844
	speed: 0.0367s/iter; left time: 1525.6262s
	iters: 300, epoch: 12 | loss: 0.2990467
	speed: 0.0351s/iter; left time: 1454.5737s
	iters: 400, epoch: 12 | loss: 0.0036288
	speed: 0.0359s/iter; left time: 1485.0942s
Epoch: 12 cost time: 17.122669219970703
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0174040
	speed: 0.1380s/iter; left time: 5683.5659s
	iters: 200, epoch: 13 | loss: 0.0156954
	speed: 0.0357s/iter; left time: 1468.2230s
	iters: 300, epoch: 13 | loss: 0.0026049
	speed: 0.0376s/iter; left time: 1539.1761s
	iters: 400, epoch: 13 | loss: 0.3100843
	speed: 0.0361s/iter; left time: 1477.4178s
Epoch: 13 cost time: 17.3057644367218
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.969696).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0024992
	speed: 0.1657s/iter; left time: 6743.0622s
	iters: 200, epoch: 14 | loss: 0.0052991
	speed: 0.0382s/iter; left time: 1552.8075s
	iters: 300, epoch: 14 | loss: 0.0997477
	speed: 0.0365s/iter; left time: 1478.1968s
	iters: 400, epoch: 14 | loss: 0.0007141
	speed: 0.0383s/iter; left time: 1547.5656s
Epoch: 14 cost time: 18.095245361328125
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1075236
	speed: 0.1551s/iter; left time: 6240.7449s
	iters: 200, epoch: 15 | loss: 0.0014111
	speed: 0.0362s/iter; left time: 1452.0205s
	iters: 300, epoch: 15 | loss: 0.0007435
	speed: 0.0370s/iter; left time: 1482.4390s
	iters: 400, epoch: 15 | loss: 0.0003771
	speed: 0.0388s/iter; left time: 1548.5777s
Epoch: 15 cost time: 17.77409815788269
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.969696 --> -0.977415).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0165683
	speed: 0.1630s/iter; left time: 6480.7323s
	iters: 200, epoch: 16 | loss: 0.0032633
	speed: 0.0354s/iter; left time: 1405.2684s
	iters: 300, epoch: 16 | loss: 0.0053895
	speed: 0.0374s/iter; left time: 1480.1146s
	iters: 400, epoch: 16 | loss: 0.0022616
	speed: 0.0358s/iter; left time: 1413.3463s
Epoch: 16 cost time: 17.378779888153076
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0009483
	speed: 0.1414s/iter; left time: 5557.8399s
	iters: 200, epoch: 17 | loss: 0.0044171
	speed: 0.0359s/iter; left time: 1406.0408s
	iters: 300, epoch: 17 | loss: 0.0183899
	speed: 0.0335s/iter; left time: 1310.1403s
	iters: 400, epoch: 17 | loss: 0.0076796
	speed: 0.0362s/iter; left time: 1413.1354s
Epoch: 17 cost time: 16.825664281845093
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0047424
	speed: 0.1519s/iter; left time: 5898.1959s
	iters: 200, epoch: 18 | loss: 0.0159462
	speed: 0.0367s/iter; left time: 1420.6974s
	iters: 300, epoch: 18 | loss: 0.0005327
	speed: 0.0369s/iter; left time: 1426.9605s
	iters: 400, epoch: 18 | loss: 0.0036051
	speed: 0.0356s/iter; left time: 1370.8373s
Epoch: 18 cost time: 17.34429669380188
Epoch: 18, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.945 Test Loss: 0.220 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0040248
	speed: 0.1492s/iter; left time: 5724.5429s
	iters: 200, epoch: 19 | loss: 0.0017935
	speed: 0.0370s/iter; left time: 1414.8390s
	iters: 300, epoch: 19 | loss: 0.0197154
	speed: 0.0383s/iter; left time: 1460.4210s
	iters: 400, epoch: 19 | loss: 0.4233316
	speed: 0.0392s/iter; left time: 1492.4976s
Epoch: 19 cost time: 18.015816688537598
Epoch: 19, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1236038
	speed: 0.1564s/iter; left time: 5925.4686s
	iters: 200, epoch: 20 | loss: 0.0006397
	speed: 0.0367s/iter; left time: 1386.7572s
	iters: 300, epoch: 20 | loss: 0.0005738
	speed: 0.0338s/iter; left time: 1273.7999s
	iters: 400, epoch: 20 | loss: 0.0065300
	speed: 0.0376s/iter; left time: 1413.4998s
Epoch: 20 cost time: 17.378134965896606
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.978272).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0046986
	speed: 0.1447s/iter; left time: 5415.5511s
	iters: 200, epoch: 21 | loss: 0.0012000
	speed: 0.0344s/iter; left time: 1285.5920s
	iters: 300, epoch: 21 | loss: 0.0010604
	speed: 0.0384s/iter; left time: 1429.7258s
	iters: 400, epoch: 21 | loss: 0.0016265
	speed: 0.0355s/iter; left time: 1318.1627s
Epoch: 21 cost time: 16.930418252944946
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0012640
	speed: 0.1523s/iter; left time: 5626.7999s
	iters: 200, epoch: 22 | loss: 0.2418657
	speed: 0.0376s/iter; left time: 1385.6183s
	iters: 300, epoch: 22 | loss: 0.0007767
	speed: 0.0346s/iter; left time: 1273.1440s
	iters: 400, epoch: 22 | loss: 0.0839365
	speed: 0.0373s/iter; left time: 1367.0845s
Epoch: 22 cost time: 17.59861731529236
Epoch: 22, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0385086
	speed: 0.1601s/iter; left time: 5839.6337s
	iters: 200, epoch: 23 | loss: 0.0006253
	speed: 0.0315s/iter; left time: 1146.8030s
	iters: 300, epoch: 23 | loss: 0.0004363
	speed: 0.0313s/iter; left time: 1133.9714s
	iters: 400, epoch: 23 | loss: 0.0424937
	speed: 0.0299s/iter; left time: 1080.3693s
Epoch: 23 cost time: 15.07806134223938
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0621052
	speed: 0.1628s/iter; left time: 5861.9949s
	iters: 200, epoch: 24 | loss: 0.0012422
	speed: 0.0400s/iter; left time: 1438.1271s
	iters: 300, epoch: 24 | loss: 0.0031382
	speed: 0.0386s/iter; left time: 1382.8562s
	iters: 400, epoch: 24 | loss: 0.0118805
	speed: 0.0387s/iter; left time: 1382.9593s
Epoch: 24 cost time: 18.84069013595581
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0036194
	speed: 0.1725s/iter; left time: 6133.2499s
	iters: 200, epoch: 25 | loss: 0.0026964
	speed: 0.0371s/iter; left time: 1316.4334s
	iters: 300, epoch: 25 | loss: 0.0057387
	speed: 0.0394s/iter; left time: 1391.8245s
	iters: 400, epoch: 25 | loss: 0.0522612
	speed: 0.0363s/iter; left time: 1280.1629s
Epoch: 25 cost time: 18.087928533554077
Epoch: 25, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0045538
	speed: 0.1453s/iter; left time: 5095.5537s
	iters: 200, epoch: 26 | loss: 0.0023436
	speed: 0.0386s/iter; left time: 1350.9076s
	iters: 300, epoch: 26 | loss: 0.0013647
	speed: 0.0362s/iter; left time: 1261.7296s
	iters: 400, epoch: 26 | loss: 0.0019554
	speed: 0.0356s/iter; left time: 1237.6564s
Epoch: 26 cost time: 17.65576934814453
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0027572
	speed: 0.1563s/iter; left time: 5407.8327s
	iters: 200, epoch: 27 | loss: 0.0263407
	speed: 0.0344s/iter; left time: 1186.0054s
	iters: 300, epoch: 27 | loss: 0.0026015
	speed: 0.0346s/iter; left time: 1192.1334s
	iters: 400, epoch: 27 | loss: 0.0032303
	speed: 0.0359s/iter; left time: 1230.8043s
Epoch: 27 cost time: 17.061110973358154
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.267 Vali Acc: 0.946 Test Loss: 0.267 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0009434
	speed: 0.1469s/iter; left time: 5013.7105s
	iters: 200, epoch: 28 | loss: 0.0136284
	speed: 0.0366s/iter; left time: 1245.8958s
	iters: 300, epoch: 28 | loss: 0.0042433
	speed: 0.0373s/iter; left time: 1266.0916s
	iters: 400, epoch: 28 | loss: 0.0004728
	speed: 0.0362s/iter; left time: 1224.6239s
Epoch: 28 cost time: 17.429261684417725
Epoch: 28, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0029015
	speed: 0.1514s/iter; left time: 5097.4231s
	iters: 200, epoch: 29 | loss: 0.0023229
	speed: 0.0352s/iter; left time: 1182.3628s
	iters: 300, epoch: 29 | loss: 0.0065830
	speed: 0.0374s/iter; left time: 1252.6207s
	iters: 400, epoch: 29 | loss: 0.0654372
	speed: 0.0372s/iter; left time: 1241.1828s
Epoch: 29 cost time: 17.570148229599
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0033212
	speed: 0.1521s/iter; left time: 5048.2305s
	iters: 200, epoch: 30 | loss: 0.0021720
	speed: 0.0378s/iter; left time: 1250.4259s
	iters: 300, epoch: 30 | loss: 0.0023936
	speed: 0.0393s/iter; left time: 1297.4552s
	iters: 400, epoch: 30 | loss: 0.0008511
	speed: 0.0393s/iter; left time: 1293.8825s
Epoch: 30 cost time: 18.438480138778687
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 507118
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0463706
	speed: 0.0517s/iter; left time: 2418.7526s
	iters: 200, epoch: 1 | loss: 0.7015551
	speed: 0.0372s/iter; left time: 1736.1023s
	iters: 300, epoch: 1 | loss: 0.2361229
	speed: 0.0379s/iter; left time: 1767.2995s
	iters: 400, epoch: 1 | loss: 0.7324716
	speed: 0.0354s/iter; left time: 1646.8551s
Epoch: 1 cost time: 18.82771062850952
Epoch: 1, Steps: 469 | Train Loss: 0.731 Vali Loss: 0.330 Vali Acc: 0.910 Test Loss: 0.330 Test Acc: 0.910
Validation loss decreased (inf --> -0.909945).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1544671
	speed: 0.1741s/iter; left time: 8067.2328s
	iters: 200, epoch: 2 | loss: 0.5695946
	speed: 0.0380s/iter; left time: 1755.6682s
	iters: 300, epoch: 2 | loss: 0.2074462
	speed: 0.0366s/iter; left time: 1687.7241s
	iters: 400, epoch: 2 | loss: 0.1823311
	speed: 0.0377s/iter; left time: 1736.8831s
Epoch: 2 cost time: 18.165142059326172
Epoch: 2, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.909945 --> -0.918522).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1781094
	speed: 0.1499s/iter; left time: 6874.4024s
	iters: 200, epoch: 3 | loss: 0.3013638
	speed: 0.0296s/iter; left time: 1355.9133s
	iters: 300, epoch: 3 | loss: 0.0218389
	speed: 0.0300s/iter; left time: 1369.4283s
	iters: 400, epoch: 3 | loss: 0.0205641
	speed: 0.0295s/iter; left time: 1346.1126s
Epoch: 3 cost time: 14.390650749206543
Epoch: 3, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.918522 --> -0.931387).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0537780
	speed: 0.1436s/iter; left time: 6520.6885s
	iters: 200, epoch: 4 | loss: 0.2012583
	speed: 0.0364s/iter; left time: 1649.8386s
	iters: 300, epoch: 4 | loss: 0.0106924
	speed: 0.0376s/iter; left time: 1700.1026s
	iters: 400, epoch: 4 | loss: 0.1040800
	speed: 0.0354s/iter; left time: 1597.6233s
Epoch: 4 cost time: 17.30216097831726
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.202 Vali Acc: 0.945 Test Loss: 0.202 Test Acc: 0.945
Validation loss decreased (-0.931387 --> -0.944538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0104392
	speed: 0.1553s/iter; left time: 6975.4711s
	iters: 200, epoch: 5 | loss: 0.3807058
	speed: 0.0345s/iter; left time: 1545.1214s
	iters: 300, epoch: 5 | loss: 0.0246766
	speed: 0.0358s/iter; left time: 1603.1592s
	iters: 400, epoch: 5 | loss: 0.0242532
	speed: 0.0351s/iter; left time: 1565.3137s
Epoch: 5 cost time: 16.874290466308594
Epoch: 5, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.944538 --> -0.951113).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0070195
	speed: 0.1403s/iter; left time: 6238.1457s
	iters: 200, epoch: 6 | loss: 0.0711055
	speed: 0.0350s/iter; left time: 1552.6988s
	iters: 300, epoch: 6 | loss: 0.0259755
	speed: 0.0359s/iter; left time: 1588.5688s
	iters: 400, epoch: 6 | loss: 0.0800001
	speed: 0.0363s/iter; left time: 1601.5915s
Epoch: 6 cost time: 16.842419147491455
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.951113 --> -0.953972).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0065369
	speed: 0.1502s/iter; left time: 6607.8142s
	iters: 200, epoch: 7 | loss: 0.0326468
	speed: 0.0351s/iter; left time: 1539.5220s
	iters: 300, epoch: 7 | loss: 0.0095370
	speed: 0.0349s/iter; left time: 1528.1219s
	iters: 400, epoch: 7 | loss: 0.0048416
	speed: 0.0339s/iter; left time: 1481.6498s
Epoch: 7 cost time: 16.696794748306274
Epoch: 7, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1172538
	speed: 0.1393s/iter; left time: 6060.3355s
	iters: 200, epoch: 8 | loss: 0.0913339
	speed: 0.0365s/iter; left time: 1583.6569s
	iters: 300, epoch: 8 | loss: 0.3581359
	speed: 0.0355s/iter; left time: 1539.6516s
	iters: 400, epoch: 8 | loss: 0.2228101
	speed: 0.0363s/iter; left time: 1570.8031s
Epoch: 8 cost time: 17.05869150161743
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1120003
	speed: 0.1503s/iter; left time: 6471.3534s
	iters: 200, epoch: 9 | loss: 0.0068545
	speed: 0.0360s/iter; left time: 1545.9448s
	iters: 300, epoch: 9 | loss: 0.1479147
	speed: 0.0366s/iter; left time: 1567.1524s
	iters: 400, epoch: 9 | loss: 0.0305443
	speed: 0.0351s/iter; left time: 1499.3062s
Epoch: 9 cost time: 16.703869104385376
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.953972 --> -0.962549).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0015734
	speed: 0.1382s/iter; left time: 5885.7407s
	iters: 200, epoch: 10 | loss: 0.0055497
	speed: 0.0357s/iter; left time: 1516.6250s
	iters: 300, epoch: 10 | loss: 0.0025574
	speed: 0.0372s/iter; left time: 1574.6965s
	iters: 400, epoch: 10 | loss: 0.0077125
	speed: 0.0368s/iter; left time: 1557.1907s
Epoch: 10 cost time: 17.49328303337097
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0098132
	speed: 0.1636s/iter; left time: 6888.0095s
	iters: 200, epoch: 11 | loss: 0.2470026
	speed: 0.0373s/iter; left time: 1567.5388s
	iters: 300, epoch: 11 | loss: 0.0560103
	speed: 0.0360s/iter; left time: 1507.0225s
	iters: 400, epoch: 11 | loss: 0.0048740
	speed: 0.0378s/iter; left time: 1580.5226s
Epoch: 11 cost time: 17.929749250411987
Epoch: 11, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1958909
	speed: 0.1661s/iter; left time: 6917.2217s
	iters: 200, epoch: 12 | loss: 0.0027924
	speed: 0.0374s/iter; left time: 1553.2001s
	iters: 300, epoch: 12 | loss: 0.0448157
	speed: 0.0375s/iter; left time: 1555.8323s
	iters: 400, epoch: 12 | loss: 0.0179004
	speed: 0.0364s/iter; left time: 1504.8209s
Epoch: 12 cost time: 17.61420965194702
Epoch: 12, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0754013
	speed: 0.1596s/iter; left time: 6572.2163s
	iters: 200, epoch: 13 | loss: 0.2451142
	speed: 0.0356s/iter; left time: 1460.2309s
	iters: 300, epoch: 13 | loss: 0.0057745
	speed: 0.0346s/iter; left time: 1417.8628s
	iters: 400, epoch: 13 | loss: 0.0056722
	speed: 0.0352s/iter; left time: 1437.6868s
Epoch: 13 cost time: 17.03250741958618
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0034095
	speed: 0.1527s/iter; left time: 6217.1793s
	iters: 200, epoch: 14 | loss: 0.0104330
	speed: 0.0335s/iter; left time: 1360.5532s
	iters: 300, epoch: 14 | loss: 0.0027911
	speed: 0.0370s/iter; left time: 1497.3301s
	iters: 400, epoch: 14 | loss: 0.0015635
	speed: 0.0337s/iter; left time: 1359.7117s
Epoch: 14 cost time: 16.513402938842773
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.962549 --> -0.964550).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0015281
	speed: 0.1375s/iter; left time: 5531.2680s
	iters: 200, epoch: 15 | loss: 0.0044034
	speed: 0.0350s/iter; left time: 1404.5782s
	iters: 300, epoch: 15 | loss: 0.0008353
	speed: 0.0341s/iter; left time: 1365.1348s
	iters: 400, epoch: 15 | loss: 0.0041797
	speed: 0.0349s/iter; left time: 1393.3945s
Epoch: 15 cost time: 16.44176435470581
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0071997
	speed: 0.1263s/iter; left time: 5022.9589s
	iters: 200, epoch: 16 | loss: 0.0213715
	speed: 0.0298s/iter; left time: 1182.2288s
	iters: 300, epoch: 16 | loss: 0.2981832
	speed: 0.0331s/iter; left time: 1310.4026s
	iters: 400, epoch: 16 | loss: 0.0015427
	speed: 0.0347s/iter; left time: 1369.0621s
Epoch: 16 cost time: 15.772771835327148
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0296577
	speed: 0.1377s/iter; left time: 5412.1364s
	iters: 200, epoch: 17 | loss: 0.0012940
	speed: 0.0306s/iter; left time: 1197.6008s
	iters: 300, epoch: 17 | loss: 0.0104433
	speed: 0.0290s/iter; left time: 1131.9672s
	iters: 400, epoch: 17 | loss: 0.0167176
	speed: 0.0274s/iter; left time: 1067.9087s
Epoch: 17 cost time: 13.85639238357544
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0016826
	speed: 0.1241s/iter; left time: 4819.6198s
	iters: 200, epoch: 18 | loss: 0.0021972
	speed: 0.0354s/iter; left time: 1371.5179s
	iters: 300, epoch: 18 | loss: 0.0018026
	speed: 0.0356s/iter; left time: 1374.3958s
	iters: 400, epoch: 18 | loss: 0.0014545
	speed: 0.0357s/iter; left time: 1375.5708s
Epoch: 18 cost time: 16.60571527481079
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.964550 --> -0.964836).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0079746
	speed: 0.1524s/iter; left time: 5844.9596s
	iters: 200, epoch: 19 | loss: 0.0007805
	speed: 0.0370s/iter; left time: 1415.1252s
	iters: 300, epoch: 19 | loss: 0.0077153
	speed: 0.0377s/iter; left time: 1437.6946s
	iters: 400, epoch: 19 | loss: 0.0021014
	speed: 0.0365s/iter; left time: 1389.8870s
Epoch: 19 cost time: 17.813862562179565
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.964836 --> -0.969982).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0028043
	speed: 0.1660s/iter; left time: 6290.3964s
	iters: 200, epoch: 20 | loss: 0.0056031
	speed: 0.0394s/iter; left time: 1487.3314s
	iters: 300, epoch: 20 | loss: 0.0406724
	speed: 0.0383s/iter; left time: 1441.9081s
	iters: 400, epoch: 20 | loss: 0.0244526
	speed: 0.0386s/iter; left time: 1449.6369s
Epoch: 20 cost time: 18.37295126914978
Epoch: 20, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0003639
	speed: 0.1678s/iter; left time: 6278.3234s
	iters: 200, epoch: 21 | loss: 0.1130297
	speed: 0.0388s/iter; left time: 1449.8573s
	iters: 300, epoch: 21 | loss: 0.0038547
	speed: 0.0402s/iter; left time: 1494.9745s
	iters: 400, epoch: 21 | loss: 0.0022984
	speed: 0.0393s/iter; left time: 1458.5937s
Epoch: 21 cost time: 18.743946313858032
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.969982 --> -0.972269).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0042308
	speed: 0.1666s/iter; left time: 6154.4124s
	iters: 200, epoch: 22 | loss: 0.0057766
	speed: 0.0379s/iter; left time: 1397.0687s
	iters: 300, epoch: 22 | loss: 0.0040211
	speed: 0.0372s/iter; left time: 1367.0133s
	iters: 400, epoch: 22 | loss: 0.0007980
	speed: 0.0370s/iter; left time: 1357.5646s
Epoch: 22 cost time: 17.76631188392639
Epoch: 22, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0062825
	speed: 0.1551s/iter; left time: 5658.4569s
	iters: 200, epoch: 23 | loss: 0.0141318
	speed: 0.0370s/iter; left time: 1346.6622s
	iters: 300, epoch: 23 | loss: 0.0018001
	speed: 0.0378s/iter; left time: 1369.9777s
	iters: 400, epoch: 23 | loss: 0.0025265
	speed: 0.0364s/iter; left time: 1315.6458s
Epoch: 23 cost time: 17.77397918701172
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0281162
	speed: 0.1516s/iter; left time: 5458.0862s
	iters: 200, epoch: 24 | loss: 0.0031061
	speed: 0.0378s/iter; left time: 1357.8877s
	iters: 300, epoch: 24 | loss: 0.0009230
	speed: 0.0357s/iter; left time: 1278.1357s
	iters: 400, epoch: 24 | loss: 0.0108196
	speed: 0.0356s/iter; left time: 1271.8007s
Epoch: 24 cost time: 17.50478434562683
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0004096
	speed: 0.1510s/iter; left time: 5367.0195s
	iters: 200, epoch: 25 | loss: 0.0008733
	speed: 0.0365s/iter; left time: 1294.2137s
	iters: 300, epoch: 25 | loss: 0.0010241
	speed: 0.0365s/iter; left time: 1288.3692s
	iters: 400, epoch: 25 | loss: 0.0167032
	speed: 0.0379s/iter; left time: 1335.6018s
Epoch: 25 cost time: 17.731002807617188
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0028506
	speed: 0.1597s/iter; left time: 5602.9441s
	iters: 200, epoch: 26 | loss: 0.0031076
	speed: 0.0373s/iter; left time: 1305.2746s
	iters: 300, epoch: 26 | loss: 0.0094065
	speed: 0.0333s/iter; left time: 1159.7236s
	iters: 400, epoch: 26 | loss: 0.0299111
	speed: 0.0369s/iter; left time: 1281.6342s
Epoch: 26 cost time: 17.1632719039917
Epoch: 26, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.175 Vali Acc: 0.966 Test Loss: 0.175 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0013533
	speed: 0.1505s/iter; left time: 5207.1743s
	iters: 200, epoch: 27 | loss: 0.0005903
	speed: 0.0351s/iter; left time: 1209.7267s
	iters: 300, epoch: 27 | loss: 0.0029477
	speed: 0.0356s/iter; left time: 1225.2513s
	iters: 400, epoch: 27 | loss: 0.0085326
	speed: 0.0376s/iter; left time: 1290.6573s
Epoch: 27 cost time: 17.510650396347046
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.1466484
	speed: 0.1454s/iter; left time: 4964.7583s
	iters: 200, epoch: 28 | loss: 0.0003259
	speed: 0.0351s/iter; left time: 1195.6723s
	iters: 300, epoch: 28 | loss: 0.0098923
	speed: 0.0356s/iter; left time: 1206.9878s
	iters: 400, epoch: 28 | loss: 0.1097377
	speed: 0.0371s/iter; left time: 1256.0647s
Epoch: 28 cost time: 17.201942920684814
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0192603
	speed: 0.1625s/iter; left time: 5472.3987s
	iters: 200, epoch: 29 | loss: 0.0063782
	speed: 0.0387s/iter; left time: 1298.6023s
	iters: 300, epoch: 29 | loss: 0.0020473
	speed: 0.0397s/iter; left time: 1328.2471s
	iters: 400, epoch: 29 | loss: 0.0027349
	speed: 0.0377s/iter; left time: 1256.5286s
Epoch: 29 cost time: 18.378907203674316
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0013918
	speed: 0.1645s/iter; left time: 5462.2459s
	iters: 200, epoch: 30 | loss: 0.0727965
	speed: 0.0359s/iter; left time: 1186.7228s
	iters: 300, epoch: 30 | loss: 0.0058778
	speed: 0.0343s/iter; left time: 1130.7905s
	iters: 400, epoch: 30 | loss: 0.0004440
	speed: 0.0353s/iter; left time: 1161.3890s
Epoch: 30 cost time: 16.642353773117065
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.972841).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0228611
	speed: 0.1162s/iter; left time: 3804.3062s
	iters: 200, epoch: 31 | loss: 0.0008988
	speed: 0.0382s/iter; left time: 1245.7379s
	iters: 300, epoch: 31 | loss: 0.0019506
	speed: 0.0380s/iter; left time: 1235.4215s
	iters: 400, epoch: 31 | loss: 0.0002826
	speed: 0.0362s/iter; left time: 1172.5431s
Epoch: 31 cost time: 17.20369029045105
Epoch: 31, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0050306
	speed: 0.1522s/iter; left time: 4908.9255s
	iters: 200, epoch: 32 | loss: 0.0001350
	speed: 0.0366s/iter; left time: 1177.4165s
	iters: 300, epoch: 32 | loss: 0.0019681
	speed: 0.0345s/iter; left time: 1105.8485s
	iters: 400, epoch: 32 | loss: 0.0370441
	speed: 0.0387s/iter; left time: 1236.6584s
Epoch: 32 cost time: 17.604510068893433
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0003620
	speed: 0.1521s/iter; left time: 4836.4246s
	iters: 200, epoch: 33 | loss: 0.0022749
	speed: 0.0385s/iter; left time: 1219.3149s
	iters: 300, epoch: 33 | loss: 0.0069386
	speed: 0.0368s/iter; left time: 1161.8017s
	iters: 400, epoch: 33 | loss: 0.0172035
	speed: 0.0363s/iter; left time: 1144.3173s
Epoch: 33 cost time: 17.63311505317688
Epoch: 33, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0008625
	speed: 0.1499s/iter; left time: 4695.1371s
	iters: 200, epoch: 34 | loss: 0.0003254
	speed: 0.0355s/iter; left time: 1109.5013s
	iters: 300, epoch: 34 | loss: 0.0251464
	speed: 0.0363s/iter; left time: 1130.0505s
	iters: 400, epoch: 34 | loss: 0.0556879
	speed: 0.0353s/iter; left time: 1096.2529s
Epoch: 34 cost time: 17.332207202911377
Epoch: 34, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0001747
	speed: 0.1505s/iter; left time: 4643.9930s
	iters: 200, epoch: 35 | loss: 0.0178346
	speed: 0.0361s/iter; left time: 1110.3905s
	iters: 300, epoch: 35 | loss: 0.0088249
	speed: 0.0359s/iter; left time: 1099.8031s
	iters: 400, epoch: 35 | loss: 0.0015918
	speed: 0.0369s/iter; left time: 1128.3093s
Epoch: 35 cost time: 17.449778079986572
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0241994
	speed: 0.1527s/iter; left time: 4640.9237s
	iters: 200, epoch: 36 | loss: 0.0031682
	speed: 0.0367s/iter; left time: 1112.9412s
	iters: 300, epoch: 36 | loss: 0.0002937
	speed: 0.0360s/iter; left time: 1085.5871s
	iters: 400, epoch: 36 | loss: 0.0570332
	speed: 0.0356s/iter; left time: 1070.7904s
Epoch: 36 cost time: 17.211101770401
Epoch: 36, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0064644
	speed: 0.1518s/iter; left time: 4541.8702s
	iters: 200, epoch: 37 | loss: 0.0000468
	speed: 0.0366s/iter; left time: 1090.9690s
	iters: 300, epoch: 37 | loss: 0.0026109
	speed: 0.0362s/iter; left time: 1076.7430s
	iters: 400, epoch: 37 | loss: 0.0001571
	speed: 0.0377s/iter; left time: 1115.1431s
Epoch: 37 cost time: 17.458141565322876
Epoch: 37, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0007664
	speed: 0.1577s/iter; left time: 4642.8856s
	iters: 200, epoch: 38 | loss: 0.0096825
	speed: 0.0386s/iter; left time: 1133.7776s
	iters: 300, epoch: 38 | loss: 0.0015430
	speed: 0.0396s/iter; left time: 1158.3106s
	iters: 400, epoch: 38 | loss: 0.0003090
	speed: 0.0377s/iter; left time: 1097.4305s
Epoch: 38 cost time: 18.65975856781006
Epoch: 38, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0217318
	speed: 0.1725s/iter; left time: 4999.6268s
	iters: 200, epoch: 39 | loss: 0.0151799
	speed: 0.0385s/iter; left time: 1111.5732s
	iters: 300, epoch: 39 | loss: 0.0018621
	speed: 0.0391s/iter; left time: 1124.4646s
	iters: 400, epoch: 39 | loss: 0.0072475
	speed: 0.0389s/iter; left time: 1116.8855s
Epoch: 39 cost time: 18.363668203353882
Epoch: 39, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.2941214
	speed: 0.1748s/iter; left time: 4983.5998s
	iters: 200, epoch: 40 | loss: 0.0014053
	speed: 0.0406s/iter; left time: 1153.3100s
	iters: 300, epoch: 40 | loss: 0.0274156
	speed: 0.0433s/iter; left time: 1225.5559s
	iters: 400, epoch: 40 | loss: 0.0074786
	speed: 0.0418s/iter; left time: 1178.0716s
Epoch: 40 cost time: 19.740122318267822
Epoch: 40, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 506990
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1434271
	speed: 0.0397s/iter; left time: 1855.7965s
	iters: 200, epoch: 1 | loss: 0.4808362
	speed: 0.0298s/iter; left time: 1391.7723s
	iters: 300, epoch: 1 | loss: 0.3147317
	speed: 0.0317s/iter; left time: 1479.2580s
	iters: 400, epoch: 1 | loss: 0.2158469
	speed: 0.0355s/iter; left time: 1651.5281s
Epoch: 1 cost time: 16.0845148563385
Epoch: 1, Steps: 469 | Train Loss: 0.721 Vali Loss: 0.352 Vali Acc: 0.888 Test Loss: 0.352 Test Acc: 0.888
Validation loss decreased (inf --> -0.887647).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0507703
	speed: 0.1475s/iter; left time: 6835.3326s
	iters: 200, epoch: 2 | loss: 0.0800107
	speed: 0.0359s/iter; left time: 1660.9437s
	iters: 300, epoch: 2 | loss: 0.2260201
	speed: 0.0342s/iter; left time: 1577.7200s
	iters: 400, epoch: 2 | loss: 0.1813180
	speed: 0.0385s/iter; left time: 1771.2534s
Epoch: 2 cost time: 17.339951753616333
Epoch: 2, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.887647 --> -0.935390).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0244151
	speed: 0.1428s/iter; left time: 6551.0607s
	iters: 200, epoch: 3 | loss: 0.5104238
	speed: 0.0336s/iter; left time: 1536.1266s
	iters: 300, epoch: 3 | loss: 0.0279005
	speed: 0.0359s/iter; left time: 1639.6700s
	iters: 400, epoch: 3 | loss: 0.0896465
	speed: 0.0348s/iter; left time: 1584.3971s
Epoch: 3 cost time: 16.674654960632324
Epoch: 3, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.288 Vali Acc: 0.918 Test Loss: 0.288 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1155374
	speed: 0.1557s/iter; left time: 7065.9517s
	iters: 200, epoch: 4 | loss: 0.0172389
	speed: 0.0348s/iter; left time: 1576.5725s
	iters: 300, epoch: 4 | loss: 0.0782997
	speed: 0.0377s/iter; left time: 1702.6406s
	iters: 400, epoch: 4 | loss: 0.0689092
	speed: 0.0366s/iter; left time: 1648.8828s
Epoch: 4 cost time: 17.186734914779663
Epoch: 4, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
Validation loss decreased (-0.935390 --> -0.937105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3224702
	speed: 0.1435s/iter; left time: 6446.7758s
	iters: 200, epoch: 5 | loss: 0.0550617
	speed: 0.0333s/iter; left time: 1494.8773s
	iters: 300, epoch: 5 | loss: 0.0599550
	speed: 0.0343s/iter; left time: 1533.3006s
	iters: 400, epoch: 5 | loss: 0.0131669
	speed: 0.0355s/iter; left time: 1585.0159s
Epoch: 5 cost time: 16.545371294021606
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.937105 --> -0.955687).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0050294
	speed: 0.1553s/iter; left time: 6905.2167s
	iters: 200, epoch: 6 | loss: 0.0090936
	speed: 0.0377s/iter; left time: 1672.7772s
	iters: 300, epoch: 6 | loss: 0.0041220
	speed: 0.0374s/iter; left time: 1654.5471s
	iters: 400, epoch: 6 | loss: 0.1203963
	speed: 0.0372s/iter; left time: 1642.5816s
Epoch: 6 cost time: 17.85277771949768
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.942 Test Loss: 0.243 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0414983
	speed: 0.1592s/iter; left time: 7000.8165s
	iters: 200, epoch: 7 | loss: 0.1783243
	speed: 0.0374s/iter; left time: 1641.1304s
	iters: 300, epoch: 7 | loss: 0.3349074
	speed: 0.0382s/iter; left time: 1672.2328s
	iters: 400, epoch: 7 | loss: 0.0312717
	speed: 0.0358s/iter; left time: 1565.7714s
Epoch: 7 cost time: 17.824938774108887
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2678927
	speed: 0.1676s/iter; left time: 7292.8708s
	iters: 200, epoch: 8 | loss: 0.0205705
	speed: 0.0369s/iter; left time: 1601.3228s
	iters: 300, epoch: 8 | loss: 0.1691284
	speed: 0.0365s/iter; left time: 1579.2183s
	iters: 400, epoch: 8 | loss: 0.0029025
	speed: 0.0378s/iter; left time: 1634.7246s
Epoch: 8 cost time: 17.97202777862549
Epoch: 8, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.955687 --> -0.956545).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0209123
	speed: 0.1638s/iter; left time: 7053.4875s
	iters: 200, epoch: 9 | loss: 0.0779970
	speed: 0.0356s/iter; left time: 1528.4512s
	iters: 300, epoch: 9 | loss: 0.0098364
	speed: 0.0368s/iter; left time: 1578.2342s
	iters: 400, epoch: 9 | loss: 0.0030467
	speed: 0.0346s/iter; left time: 1477.5270s
Epoch: 9 cost time: 17.22121524810791
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.956545 --> -0.965693).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0044511
	speed: 0.1477s/iter; left time: 6287.5099s
	iters: 200, epoch: 10 | loss: 0.0054295
	speed: 0.0334s/iter; left time: 1416.7383s
	iters: 300, epoch: 10 | loss: 0.0040675
	speed: 0.0359s/iter; left time: 1521.3955s
	iters: 400, epoch: 10 | loss: 0.0682734
	speed: 0.0355s/iter; left time: 1500.7359s
Epoch: 10 cost time: 16.606353759765625
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0827376
	speed: 0.1448s/iter; left time: 6097.9444s
	iters: 200, epoch: 11 | loss: 0.0121216
	speed: 0.0361s/iter; left time: 1514.6886s
	iters: 300, epoch: 11 | loss: 0.0135661
	speed: 0.0341s/iter; left time: 1427.6832s
	iters: 400, epoch: 11 | loss: 0.0102920
	speed: 0.0367s/iter; left time: 1534.7182s
Epoch: 11 cost time: 17.006202220916748
Epoch: 11, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0094766
	speed: 0.1442s/iter; left time: 6003.6785s
	iters: 200, epoch: 12 | loss: 0.0231379
	speed: 0.0367s/iter; left time: 1522.8371s
	iters: 300, epoch: 12 | loss: 0.0016317
	speed: 0.0353s/iter; left time: 1460.9860s
	iters: 400, epoch: 12 | loss: 0.0972069
	speed: 0.0345s/iter; left time: 1427.8281s
Epoch: 12 cost time: 16.78768515586853
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0032815
	speed: 0.1393s/iter; left time: 5734.8765s
	iters: 200, epoch: 13 | loss: 0.0073435
	speed: 0.0302s/iter; left time: 1242.0916s
	iters: 300, epoch: 13 | loss: 0.0031930
	speed: 0.0299s/iter; left time: 1226.4881s
	iters: 400, epoch: 13 | loss: 0.1468848
	speed: 0.0304s/iter; left time: 1242.3230s
Epoch: 13 cost time: 14.312924146652222
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0068502
	speed: 0.1288s/iter; left time: 5243.5767s
	iters: 200, epoch: 14 | loss: 0.0109176
	speed: 0.0370s/iter; left time: 1501.1220s
	iters: 300, epoch: 14 | loss: 0.0965978
	speed: 0.0343s/iter; left time: 1389.9810s
	iters: 400, epoch: 14 | loss: 0.0628904
	speed: 0.0360s/iter; left time: 1452.6024s
Epoch: 14 cost time: 16.51637077331543
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.966551).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0884447
	speed: 0.1452s/iter; left time: 5841.8602s
	iters: 200, epoch: 15 | loss: 0.0078353
	speed: 0.0356s/iter; left time: 1427.6004s
	iters: 300, epoch: 15 | loss: 0.1986392
	speed: 0.0367s/iter; left time: 1471.2084s
	iters: 400, epoch: 15 | loss: 0.0020441
	speed: 0.0374s/iter; left time: 1494.6740s
Epoch: 15 cost time: 17.38535237312317
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0104194
	speed: 0.1599s/iter; left time: 6358.1398s
	iters: 200, epoch: 16 | loss: 0.0015155
	speed: 0.0391s/iter; left time: 1552.5938s
	iters: 300, epoch: 16 | loss: 0.0090908
	speed: 0.0363s/iter; left time: 1434.7882s
	iters: 400, epoch: 16 | loss: 0.3404105
	speed: 0.0360s/iter; left time: 1419.9565s
Epoch: 16 cost time: 17.850342750549316
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0011206
	speed: 0.1726s/iter; left time: 6783.2403s
	iters: 200, epoch: 17 | loss: 0.0020958
	speed: 0.0379s/iter; left time: 1485.5437s
	iters: 300, epoch: 17 | loss: 0.0233670
	speed: 0.0388s/iter; left time: 1515.4721s
	iters: 400, epoch: 17 | loss: 0.2520575
	speed: 0.0369s/iter; left time: 1438.6210s
Epoch: 17 cost time: 18.152058362960815
Epoch: 17, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0088808
	speed: 0.1607s/iter; left time: 6237.9026s
	iters: 200, epoch: 18 | loss: 0.0345500
	speed: 0.0367s/iter; left time: 1422.6221s
	iters: 300, epoch: 18 | loss: 0.0486513
	speed: 0.0341s/iter; left time: 1316.6518s
	iters: 400, epoch: 18 | loss: 0.0045966
	speed: 0.0355s/iter; left time: 1369.6018s
Epoch: 18 cost time: 17.33649182319641
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0019218
	speed: 0.1562s/iter; left time: 5993.5362s
	iters: 200, epoch: 19 | loss: 0.3759459
	speed: 0.0340s/iter; left time: 1302.2135s
	iters: 300, epoch: 19 | loss: 0.1074280
	speed: 0.0376s/iter; left time: 1435.3839s
	iters: 400, epoch: 19 | loss: 0.0028158
	speed: 0.0355s/iter; left time: 1352.8453s
Epoch: 19 cost time: 17.048447132110596
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0375281
	speed: 0.1455s/iter; left time: 5512.9663s
	iters: 200, epoch: 20 | loss: 0.0002274
	speed: 0.0365s/iter; left time: 1380.4250s
	iters: 300, epoch: 20 | loss: 0.0012945
	speed: 0.0337s/iter; left time: 1269.8983s
	iters: 400, epoch: 20 | loss: 0.1343780
	speed: 0.0361s/iter; left time: 1356.0543s
Epoch: 20 cost time: 17.008328437805176
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.939 Test Loss: 0.248 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0003186
	speed: 0.1481s/iter; left time: 5542.0103s
	iters: 200, epoch: 21 | loss: 0.0253554
	speed: 0.0362s/iter; left time: 1351.0651s
	iters: 300, epoch: 21 | loss: 0.0016035
	speed: 0.0357s/iter; left time: 1326.9351s
	iters: 400, epoch: 21 | loss: 0.0038647
	speed: 0.0361s/iter; left time: 1338.8473s
Epoch: 21 cost time: 17.28267240524292
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0022123
	speed: 0.1561s/iter; left time: 5768.9976s
	iters: 200, epoch: 22 | loss: 0.0431177
	speed: 0.0343s/iter; left time: 1262.5156s
	iters: 300, epoch: 22 | loss: 0.0013359
	speed: 0.0378s/iter; left time: 1388.6355s
	iters: 400, epoch: 22 | loss: 0.0023765
	speed: 0.0334s/iter; left time: 1223.9960s
Epoch: 22 cost time: 16.782798290252686
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.966551 --> -0.970268).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0101470
	speed: 0.1516s/iter; left time: 5529.5246s
	iters: 200, epoch: 23 | loss: 0.0536263
	speed: 0.0343s/iter; left time: 1247.2612s
	iters: 300, epoch: 23 | loss: 0.0141925
	speed: 0.0355s/iter; left time: 1288.9778s
	iters: 400, epoch: 23 | loss: 0.0003204
	speed: 0.0369s/iter; left time: 1334.0523s
Epoch: 23 cost time: 17.06567645072937
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0295341
	speed: 0.1380s/iter; left time: 4971.2152s
	iters: 200, epoch: 24 | loss: 0.0158350
	speed: 0.0315s/iter; left time: 1130.4621s
	iters: 300, epoch: 24 | loss: 0.1732224
	speed: 0.0292s/iter; left time: 1044.6423s
	iters: 400, epoch: 24 | loss: 0.1108400
	speed: 0.0303s/iter; left time: 1082.1115s
Epoch: 24 cost time: 15.070646524429321
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0068719
	speed: 0.1568s/iter; left time: 5575.0173s
	iters: 200, epoch: 25 | loss: 0.0064225
	speed: 0.0373s/iter; left time: 1322.1091s
	iters: 300, epoch: 25 | loss: 0.0024677
	speed: 0.0368s/iter; left time: 1301.4919s
	iters: 400, epoch: 25 | loss: 0.0070864
	speed: 0.0378s/iter; left time: 1330.8489s
Epoch: 25 cost time: 18.0085666179657
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0032110
	speed: 0.1640s/iter; left time: 5751.3323s
	iters: 200, epoch: 26 | loss: 0.0011100
	speed: 0.0390s/iter; left time: 1365.3600s
	iters: 300, epoch: 26 | loss: 0.0130226
	speed: 0.0365s/iter; left time: 1274.4733s
	iters: 400, epoch: 26 | loss: 0.0010494
	speed: 0.0362s/iter; left time: 1260.2467s
Epoch: 26 cost time: 18.085567474365234
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0015105
	speed: 0.1560s/iter; left time: 5399.4865s
	iters: 200, epoch: 27 | loss: 0.4022107
	speed: 0.0321s/iter; left time: 1106.1683s
	iters: 300, epoch: 27 | loss: 0.0018412
	speed: 0.0356s/iter; left time: 1223.4822s
	iters: 400, epoch: 27 | loss: 0.0033331
	speed: 0.0345s/iter; left time: 1184.4828s
Epoch: 27 cost time: 16.606192588806152
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1321211
	speed: 0.1395s/iter; left time: 4762.2189s
	iters: 200, epoch: 28 | loss: 0.0011413
	speed: 0.0347s/iter; left time: 1181.7131s
	iters: 300, epoch: 28 | loss: 0.1555280
	speed: 0.0375s/iter; left time: 1272.8114s
	iters: 400, epoch: 28 | loss: 0.0140140
	speed: 0.0374s/iter; left time: 1266.3355s
Epoch: 28 cost time: 17.298051357269287
Epoch: 28, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0024147
	speed: 0.1452s/iter; left time: 4889.8332s
	iters: 200, epoch: 29 | loss: 0.3130539
	speed: 0.0371s/iter; left time: 1243.9482s
	iters: 300, epoch: 29 | loss: 0.0151682
	speed: 0.0350s/iter; left time: 1170.0972s
	iters: 400, epoch: 29 | loss: 0.0023230
	speed: 0.0324s/iter; left time: 1082.1593s
Epoch: 29 cost time: 16.82930636405945
Epoch: 29, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.970268 --> -0.974841).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0032044
	speed: 0.1457s/iter; left time: 4836.9181s
	iters: 200, epoch: 30 | loss: 0.1031527
	speed: 0.0340s/iter; left time: 1125.1818s
	iters: 300, epoch: 30 | loss: 0.0009714
	speed: 0.0346s/iter; left time: 1143.1175s
	iters: 400, epoch: 30 | loss: 0.0017983
	speed: 0.0355s/iter; left time: 1168.1463s
Epoch: 30 cost time: 16.727263927459717
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0058436
	speed: 0.1471s/iter; left time: 4815.3006s
	iters: 200, epoch: 31 | loss: 0.0008341
	speed: 0.0342s/iter; left time: 1115.6186s
	iters: 300, epoch: 31 | loss: 0.0005510
	speed: 0.0351s/iter; left time: 1140.5928s
	iters: 400, epoch: 31 | loss: 0.0047614
	speed: 0.0367s/iter; left time: 1190.8684s
Epoch: 31 cost time: 16.815223455429077
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0006476
	speed: 0.1433s/iter; left time: 4622.5993s
	iters: 200, epoch: 32 | loss: 0.0133618
	speed: 0.0362s/iter; left time: 1163.6963s
	iters: 300, epoch: 32 | loss: 0.0393485
	speed: 0.0326s/iter; left time: 1046.7892s
	iters: 400, epoch: 32 | loss: 0.0185603
	speed: 0.0354s/iter; left time: 1131.6596s
Epoch: 32 cost time: 16.747881412506104
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0020522
	speed: 0.1413s/iter; left time: 4493.3504s
	iters: 200, epoch: 33 | loss: 0.0103882
	speed: 0.0354s/iter; left time: 1122.7838s
	iters: 300, epoch: 33 | loss: 0.0067005
	speed: 0.0364s/iter; left time: 1149.3617s
	iters: 400, epoch: 33 | loss: 0.0007210
	speed: 0.0355s/iter; left time: 1119.5407s
Epoch: 33 cost time: 17.010378122329712
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0040221
	speed: 0.1542s/iter; left time: 4831.5737s
	iters: 200, epoch: 34 | loss: 0.0059262
	speed: 0.0365s/iter; left time: 1138.6119s
	iters: 300, epoch: 34 | loss: 0.2672905
	speed: 0.0390s/iter; left time: 1212.6774s
	iters: 400, epoch: 34 | loss: 0.0001476
	speed: 0.0383s/iter; left time: 1187.8880s
Epoch: 34 cost time: 17.743136882781982
Epoch: 34, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0001625
	speed: 0.1604s/iter; left time: 4948.0455s
	iters: 200, epoch: 35 | loss: 0.0007734
	speed: 0.0385s/iter; left time: 1183.1897s
	iters: 300, epoch: 35 | loss: 0.1423826
	speed: 0.0371s/iter; left time: 1137.2586s
	iters: 400, epoch: 35 | loss: 0.0007764
	speed: 0.0395s/iter; left time: 1205.8408s
Epoch: 35 cost time: 18.37188982963562
Epoch: 35, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0019179
	speed: 0.1335s/iter; left time: 4056.7536s
	iters: 200, epoch: 36 | loss: 0.0023367
	speed: 0.0292s/iter; left time: 883.6658s
	iters: 300, epoch: 36 | loss: 0.0006039
	speed: 0.0310s/iter; left time: 936.6613s
	iters: 400, epoch: 36 | loss: 0.0904122
	speed: 0.0300s/iter; left time: 903.7009s
Epoch: 36 cost time: 14.704493045806885
Epoch: 36, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0001769
	speed: 0.1418s/iter; left time: 4243.0858s
	iters: 200, epoch: 37 | loss: 0.0030204
	speed: 0.0348s/iter; left time: 1036.3998s
	iters: 300, epoch: 37 | loss: 0.0005433
	speed: 0.0346s/iter; left time: 1027.4408s
	iters: 400, epoch: 37 | loss: 0.0777230
	speed: 0.0371s/iter; left time: 1097.6116s
Epoch: 37 cost time: 16.944600105285645
Epoch: 37, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0039467
	speed: 0.1501s/iter; left time: 4419.8734s
	iters: 200, epoch: 38 | loss: 0.0004932
	speed: 0.0366s/iter; left time: 1074.4830s
	iters: 300, epoch: 38 | loss: 0.0018537
	speed: 0.0350s/iter; left time: 1023.0372s
	iters: 400, epoch: 38 | loss: 0.0000907
	speed: 0.0340s/iter; left time: 990.9649s
Epoch: 38 cost time: 17.273475646972656
Epoch: 38, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0068205
	speed: 0.1537s/iter; left time: 4453.5084s
	iters: 200, epoch: 39 | loss: 0.0002096
	speed: 0.0347s/iter; left time: 1002.4264s
	iters: 300, epoch: 39 | loss: 0.0028332
	speed: 0.0346s/iter; left time: 995.1403s
	iters: 400, epoch: 39 | loss: 0.0087353
	speed: 0.0365s/iter; left time: 1045.3598s
Epoch: 39 cost time: 17.064400672912598
Epoch: 39, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 506862
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0051130
	speed: 0.0466s/iter; left time: 2179.6650s
	iters: 200, epoch: 1 | loss: 0.6847725
	speed: 0.0374s/iter; left time: 1748.0148s
	iters: 300, epoch: 1 | loss: 0.3380533
	speed: 0.0348s/iter; left time: 1623.4852s
	iters: 400, epoch: 1 | loss: 0.4458173
	speed: 0.0358s/iter; left time: 1666.9896s
Epoch: 1 cost time: 17.96209979057312
Epoch: 1, Steps: 469 | Train Loss: 0.803 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
Validation loss decreased (inf --> -0.894222).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1658000
	speed: 0.1472s/iter; left time: 6820.8261s
	iters: 200, epoch: 2 | loss: 0.4446234
	speed: 0.0378s/iter; left time: 1749.4963s
	iters: 300, epoch: 2 | loss: 0.3965622
	speed: 0.0368s/iter; left time: 1698.2235s
	iters: 400, epoch: 2 | loss: 0.3333814
	speed: 0.0350s/iter; left time: 1612.2485s
Epoch: 2 cost time: 17.537226676940918
Epoch: 2, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.361 Vali Acc: 0.895 Test Loss: 0.361 Test Acc: 0.895
Validation loss decreased (-0.894222 --> -0.895365).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1695016
	speed: 0.1589s/iter; left time: 7286.0438s
	iters: 200, epoch: 3 | loss: 0.0731725
	speed: 0.0391s/iter; left time: 1789.7897s
	iters: 300, epoch: 3 | loss: 0.0162450
	speed: 0.0379s/iter; left time: 1732.2661s
	iters: 400, epoch: 3 | loss: 0.0443505
	speed: 0.0366s/iter; left time: 1665.9581s
Epoch: 3 cost time: 18.09393858909607
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.363 Vali Acc: 0.909 Test Loss: 0.363 Test Acc: 0.909
Validation loss decreased (-0.895365 --> -0.909087).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0237091
	speed: 0.1659s/iter; left time: 7530.6469s
	iters: 200, epoch: 4 | loss: 0.0142091
	speed: 0.0382s/iter; left time: 1730.1729s
	iters: 300, epoch: 4 | loss: 0.0877652
	speed: 0.0389s/iter; left time: 1759.9919s
	iters: 400, epoch: 4 | loss: 0.1221635
	speed: 0.0361s/iter; left time: 1627.5843s
Epoch: 4 cost time: 18.061120986938477
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.909087 --> -0.957403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0091438
	speed: 0.1616s/iter; left time: 7260.4327s
	iters: 200, epoch: 5 | loss: 0.1156070
	speed: 0.0359s/iter; left time: 1607.3752s
	iters: 300, epoch: 5 | loss: 0.0140866
	speed: 0.0389s/iter; left time: 1738.9287s
	iters: 400, epoch: 5 | loss: 0.0030090
	speed: 0.0399s/iter; left time: 1778.8487s
Epoch: 5 cost time: 18.193577766418457
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0094655
	speed: 0.1504s/iter; left time: 6684.3537s
	iters: 200, epoch: 6 | loss: 0.0469868
	speed: 0.0362s/iter; left time: 1605.4769s
	iters: 300, epoch: 6 | loss: 0.0160330
	speed: 0.0370s/iter; left time: 1638.7226s
	iters: 400, epoch: 6 | loss: 0.0044185
	speed: 0.0353s/iter; left time: 1557.7369s
Epoch: 6 cost time: 17.12113881111145
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.957403 --> -0.958546).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0095960
	speed: 0.1392s/iter; left time: 6124.7079s
	iters: 200, epoch: 7 | loss: 0.2369620
	speed: 0.0321s/iter; left time: 1409.9473s
	iters: 300, epoch: 7 | loss: 0.0229557
	speed: 0.0317s/iter; left time: 1389.7487s
	iters: 400, epoch: 7 | loss: 0.0099378
	speed: 0.0319s/iter; left time: 1394.6748s
Epoch: 7 cost time: 15.58946418762207
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.958546 --> -0.968552).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0187868
	speed: 0.1445s/iter; left time: 6288.7195s
	iters: 200, epoch: 8 | loss: 0.0210506
	speed: 0.0376s/iter; left time: 1631.6693s
	iters: 300, epoch: 8 | loss: 0.7968621
	speed: 0.0356s/iter; left time: 1541.1953s
	iters: 400, epoch: 8 | loss: 0.0218740
	speed: 0.0357s/iter; left time: 1543.0858s
Epoch: 8 cost time: 17.492634773254395
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3062005
	speed: 0.1425s/iter; left time: 6133.6581s
	iters: 200, epoch: 9 | loss: 0.0017018
	speed: 0.0375s/iter; left time: 1609.4604s
	iters: 300, epoch: 9 | loss: 0.0132060
	speed: 0.0354s/iter; left time: 1518.9142s
	iters: 400, epoch: 9 | loss: 0.0011138
	speed: 0.0336s/iter; left time: 1437.7236s
Epoch: 9 cost time: 16.79846978187561
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.973984).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0025775
	speed: 0.1463s/iter; left time: 6229.5700s
	iters: 200, epoch: 10 | loss: 0.1036690
	speed: 0.0372s/iter; left time: 1580.5784s
	iters: 300, epoch: 10 | loss: 0.0293711
	speed: 0.0328s/iter; left time: 1391.9743s
	iters: 400, epoch: 10 | loss: 0.0046848
	speed: 0.0350s/iter; left time: 1478.7637s
Epoch: 10 cost time: 16.807823181152344
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0059879
	speed: 0.1464s/iter; left time: 6165.8938s
	iters: 200, epoch: 11 | loss: 0.0267095
	speed: 0.0351s/iter; left time: 1473.4846s
	iters: 300, epoch: 11 | loss: 0.0290094
	speed: 0.0345s/iter; left time: 1444.0481s
	iters: 400, epoch: 11 | loss: 0.0361579
	speed: 0.0363s/iter; left time: 1519.6699s
Epoch: 11 cost time: 17.267075777053833
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0310452
	speed: 0.1636s/iter; left time: 6812.8368s
	iters: 200, epoch: 12 | loss: 0.1947721
	speed: 0.0379s/iter; left time: 1576.2204s
	iters: 300, epoch: 12 | loss: 0.0078743
	speed: 0.0355s/iter; left time: 1471.9671s
	iters: 400, epoch: 12 | loss: 0.0867262
	speed: 0.0376s/iter; left time: 1554.1295s
Epoch: 12 cost time: 18.02536678314209
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0602612
	speed: 0.1633s/iter; left time: 6725.3402s
	iters: 200, epoch: 13 | loss: 0.0260514
	speed: 0.0371s/iter; left time: 1522.5630s
	iters: 300, epoch: 13 | loss: 0.2244062
	speed: 0.0373s/iter; left time: 1528.1708s
	iters: 400, epoch: 13 | loss: 0.1933876
	speed: 0.0363s/iter; left time: 1483.6262s
Epoch: 13 cost time: 17.761898040771484
Epoch: 13, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0992961
	speed: 0.1584s/iter; left time: 6447.7255s
	iters: 200, epoch: 14 | loss: 0.0445217
	speed: 0.0380s/iter; left time: 1541.8856s
	iters: 300, epoch: 14 | loss: 0.0051588
	speed: 0.0351s/iter; left time: 1420.9342s
	iters: 400, epoch: 14 | loss: 0.0017743
	speed: 0.0345s/iter; left time: 1392.6863s
Epoch: 14 cost time: 17.12628483772278
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0040702
	speed: 0.1237s/iter; left time: 4976.8867s
	iters: 200, epoch: 15 | loss: 0.0018160
	speed: 0.0306s/iter; left time: 1227.4063s
	iters: 300, epoch: 15 | loss: 0.1559462
	speed: 0.0332s/iter; left time: 1329.0532s
	iters: 400, epoch: 15 | loss: 0.0007775
	speed: 0.0329s/iter; left time: 1315.4462s
Epoch: 15 cost time: 15.136977672576904
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0023619
	speed: 0.1484s/iter; left time: 5899.6922s
	iters: 200, epoch: 16 | loss: 0.0207147
	speed: 0.0360s/iter; left time: 1428.3225s
	iters: 300, epoch: 16 | loss: 0.0073254
	speed: 0.0356s/iter; left time: 1408.1592s
	iters: 400, epoch: 16 | loss: 0.0448952
	speed: 0.0350s/iter; left time: 1380.2155s
Epoch: 16 cost time: 17.020601272583008
Epoch: 16, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0442948
	speed: 0.1370s/iter; left time: 5385.3623s
	iters: 200, epoch: 17 | loss: 0.3627605
	speed: 0.0354s/iter; left time: 1385.7783s
	iters: 300, epoch: 17 | loss: 0.0017284
	speed: 0.0351s/iter; left time: 1372.3727s
	iters: 400, epoch: 17 | loss: 0.0991473
	speed: 0.0359s/iter; left time: 1401.5404s
Epoch: 17 cost time: 16.821934461593628
Epoch: 17, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0008578
	speed: 0.1490s/iter; left time: 5785.0850s
	iters: 200, epoch: 18 | loss: 0.0013265
	speed: 0.0379s/iter; left time: 1467.6099s
	iters: 300, epoch: 18 | loss: 0.0051408
	speed: 0.0357s/iter; left time: 1379.7243s
	iters: 400, epoch: 18 | loss: 0.0647236
	speed: 0.0403s/iter; left time: 1554.2419s
Epoch: 18 cost time: 18.05294156074524
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0021365
	speed: 0.1390s/iter; left time: 5333.8078s
	iters: 200, epoch: 19 | loss: 0.2062433
	speed: 0.0367s/iter; left time: 1403.0910s
	iters: 300, epoch: 19 | loss: 0.4518097
	speed: 0.0375s/iter; left time: 1430.0593s
	iters: 400, epoch: 19 | loss: 0.0064386
	speed: 0.0387s/iter; left time: 1471.3744s
Epoch: 19 cost time: 17.743618488311768
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9739851343624929
model parameter : 424686
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2845194
	speed: 0.0487s/iter; left time: 2279.4257s
	iters: 200, epoch: 1 | loss: 0.5777592
	speed: 0.0399s/iter; left time: 1863.1914s
	iters: 300, epoch: 1 | loss: 0.3524911
	speed: 0.0361s/iter; left time: 1684.1457s
	iters: 400, epoch: 1 | loss: 0.1174029
	speed: 0.0360s/iter; left time: 1671.7511s
Epoch: 1 cost time: 18.880178689956665
Epoch: 1, Steps: 469 | Train Loss: 0.781 Vali Loss: 0.324 Vali Acc: 0.905 Test Loss: 0.324 Test Acc: 0.905
Validation loss decreased (inf --> -0.904514).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0642630
	speed: 0.1632s/iter; left time: 7563.5759s
	iters: 200, epoch: 2 | loss: 0.0232876
	speed: 0.0376s/iter; left time: 1737.3338s
	iters: 300, epoch: 2 | loss: 0.0964157
	speed: 0.0371s/iter; left time: 1711.0226s
	iters: 400, epoch: 2 | loss: 0.0548416
	speed: 0.0378s/iter; left time: 1739.0156s
Epoch: 2 cost time: 17.848966598510742
Epoch: 2, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.185 Vali Acc: 0.947 Test Loss: 0.185 Test Acc: 0.947
Validation loss decreased (-0.904514 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2184148
	speed: 0.1552s/iter; left time: 7117.6027s
	iters: 200, epoch: 3 | loss: 0.0109889
	speed: 0.0369s/iter; left time: 1689.0186s
	iters: 300, epoch: 3 | loss: 0.0559884
	speed: 0.0375s/iter; left time: 1710.9329s
	iters: 400, epoch: 3 | loss: 0.2492372
	speed: 0.0347s/iter; left time: 1583.2233s
Epoch: 3 cost time: 17.271040201187134
Epoch: 3, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.134 Vali Acc: 0.958 Test Loss: 0.134 Test Acc: 0.958
Validation loss decreased (-0.946825 --> -0.958261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0083156
	speed: 0.1342s/iter; left time: 6092.2264s
	iters: 200, epoch: 4 | loss: 0.1813460
	speed: 0.0343s/iter; left time: 1553.4482s
	iters: 300, epoch: 4 | loss: 0.0060046
	speed: 0.0359s/iter; left time: 1622.2644s
	iters: 400, epoch: 4 | loss: 0.0254604
	speed: 0.0366s/iter; left time: 1651.1007s
Epoch: 4 cost time: 16.97864866256714
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0721981
	speed: 0.1480s/iter; left time: 6649.0928s
	iters: 200, epoch: 5 | loss: 0.0518992
	speed: 0.0335s/iter; left time: 1502.9032s
	iters: 300, epoch: 5 | loss: 0.0050868
	speed: 0.0350s/iter; left time: 1563.1996s
	iters: 400, epoch: 5 | loss: 0.1461881
	speed: 0.0354s/iter; left time: 1580.0039s
Epoch: 5 cost time: 16.859044790267944
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0338281
	speed: 0.1334s/iter; left time: 5931.9684s
	iters: 200, epoch: 6 | loss: 0.1910560
	speed: 0.0309s/iter; left time: 1371.1450s
	iters: 300, epoch: 6 | loss: 0.0150130
	speed: 0.0310s/iter; left time: 1369.7674s
	iters: 400, epoch: 6 | loss: 0.0348092
	speed: 0.0318s/iter; left time: 1405.8039s
Epoch: 6 cost time: 15.300900936126709
Epoch: 6, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.958261 --> -0.974842).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0176940
	speed: 0.1184s/iter; left time: 5208.6100s
	iters: 200, epoch: 7 | loss: 0.0308944
	speed: 0.0345s/iter; left time: 1515.4331s
	iters: 300, epoch: 7 | loss: 0.1991082
	speed: 0.0369s/iter; left time: 1615.1595s
	iters: 400, epoch: 7 | loss: 0.0011997
	speed: 0.0345s/iter; left time: 1508.7013s
Epoch: 7 cost time: 17.047423124313354
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0267579
	speed: 0.1425s/iter; left time: 6199.2469s
	iters: 200, epoch: 8 | loss: 0.0086983
	speed: 0.0354s/iter; left time: 1536.7864s
	iters: 300, epoch: 8 | loss: 0.0003787
	speed: 0.0358s/iter; left time: 1552.6078s
	iters: 400, epoch: 8 | loss: 0.0552042
	speed: 0.0363s/iter; left time: 1569.9939s
Epoch: 8 cost time: 17.39021921157837
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0075889
	speed: 0.1470s/iter; left time: 6327.0847s
	iters: 200, epoch: 9 | loss: 0.0348062
	speed: 0.0350s/iter; left time: 1503.7701s
	iters: 300, epoch: 9 | loss: 0.0025637
	speed: 0.0346s/iter; left time: 1482.9807s
	iters: 400, epoch: 9 | loss: 0.0177948
	speed: 0.0349s/iter; left time: 1493.6868s
Epoch: 9 cost time: 16.788785457611084
Epoch: 9, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0065452
	speed: 0.1577s/iter; left time: 6715.5690s
	iters: 200, epoch: 10 | loss: 0.0332366
	speed: 0.0376s/iter; left time: 1597.2145s
	iters: 300, epoch: 10 | loss: 0.0065377
	speed: 0.0383s/iter; left time: 1622.0925s
	iters: 400, epoch: 10 | loss: 0.1134690
	speed: 0.0367s/iter; left time: 1551.3598s
Epoch: 10 cost time: 17.832916021347046
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0007074
	speed: 0.1555s/iter; left time: 6547.5566s
	iters: 200, epoch: 11 | loss: 0.0111863
	speed: 0.0376s/iter; left time: 1581.1907s
	iters: 300, epoch: 11 | loss: 0.1199601
	speed: 0.0357s/iter; left time: 1496.7690s
	iters: 400, epoch: 11 | loss: 0.0151198
	speed: 0.0368s/iter; left time: 1538.7612s
Epoch: 11 cost time: 17.649550199508667
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2607050
	speed: 0.1567s/iter; left time: 6525.7681s
	iters: 200, epoch: 12 | loss: 0.1111964
	speed: 0.0394s/iter; left time: 1637.8748s
	iters: 300, epoch: 12 | loss: 0.0026694
	speed: 0.0354s/iter; left time: 1468.8863s
	iters: 400, epoch: 12 | loss: 0.0448300
	speed: 0.0352s/iter; left time: 1455.9614s
Epoch: 12 cost time: 17.4190411567688
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0039664
	speed: 0.1438s/iter; left time: 5919.6739s
	iters: 200, epoch: 13 | loss: 0.0033600
	speed: 0.0353s/iter; left time: 1450.5520s
	iters: 300, epoch: 13 | loss: 0.0148987
	speed: 0.0336s/iter; left time: 1377.7808s
	iters: 400, epoch: 13 | loss: 0.0029323
	speed: 0.0369s/iter; left time: 1509.0012s
Epoch: 13 cost time: 16.794239282608032
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0198404
	speed: 0.1418s/iter; left time: 5770.8022s
	iters: 200, epoch: 14 | loss: 0.0093572
	speed: 0.0354s/iter; left time: 1438.4202s
	iters: 300, epoch: 14 | loss: 0.0293386
	speed: 0.0346s/iter; left time: 1399.6437s
	iters: 400, epoch: 14 | loss: 0.1552976
	speed: 0.0346s/iter; left time: 1396.0138s
Epoch: 14 cost time: 16.69038152694702
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0003993
	speed: 0.1428s/iter; left time: 5745.8036s
	iters: 200, epoch: 15 | loss: 0.1402292
	speed: 0.0353s/iter; left time: 1416.5917s
	iters: 300, epoch: 15 | loss: 0.0020042
	speed: 0.0326s/iter; left time: 1305.8700s
	iters: 400, epoch: 15 | loss: 0.0668240
	speed: 0.0344s/iter; left time: 1372.2728s
Epoch: 15 cost time: 16.408159494400024
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0012538
	speed: 0.1351s/iter; left time: 5374.1966s
	iters: 200, epoch: 16 | loss: 0.1623423
	speed: 0.0363s/iter; left time: 1437.9909s
	iters: 300, epoch: 16 | loss: 0.0023232
	speed: 0.0349s/iter; left time: 1380.5384s
	iters: 400, epoch: 16 | loss: 0.0091199
	speed: 0.0359s/iter; left time: 1418.3724s
Epoch: 16 cost time: 17.0249605178833
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 424558
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4114259
	speed: 0.0478s/iter; left time: 2236.1153s
	iters: 200, epoch: 1 | loss: 0.7143258
	speed: 0.0363s/iter; left time: 1696.4667s
	iters: 300, epoch: 1 | loss: 0.5118406
	speed: 0.0367s/iter; left time: 1711.0750s
	iters: 400, epoch: 1 | loss: 0.5526097
	speed: 0.0357s/iter; left time: 1658.6089s
Epoch: 1 cost time: 18.016220092773438
Epoch: 1, Steps: 469 | Train Loss: 0.776 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (inf --> -0.875353).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1785732
	speed: 0.1134s/iter; left time: 5253.1784s
	iters: 200, epoch: 2 | loss: 0.2416565
	speed: 0.0320s/iter; left time: 1477.7992s
	iters: 300, epoch: 2 | loss: 0.2283921
	speed: 0.0326s/iter; left time: 1502.8683s
	iters: 400, epoch: 2 | loss: 0.3858519
	speed: 0.0380s/iter; left time: 1750.5509s
Epoch: 2 cost time: 16.611719131469727
Epoch: 2, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.875353 --> -0.940821).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0170032
	speed: 0.1582s/iter; left time: 7255.5620s
	iters: 200, epoch: 3 | loss: 0.2790382
	speed: 0.0395s/iter; left time: 1808.0871s
	iters: 300, epoch: 3 | loss: 0.0662554
	speed: 0.0393s/iter; left time: 1795.9932s
	iters: 400, epoch: 3 | loss: 0.0380930
	speed: 0.0394s/iter; left time: 1794.3054s
Epoch: 3 cost time: 18.427775144577026
Epoch: 3, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2198399
	speed: 0.1609s/iter; left time: 7303.0124s
	iters: 200, epoch: 4 | loss: 0.0150399
	speed: 0.0412s/iter; left time: 1864.9153s
	iters: 300, epoch: 4 | loss: 0.0180404
	speed: 0.0393s/iter; left time: 1775.8652s
	iters: 400, epoch: 4 | loss: 0.0176227
	speed: 0.0404s/iter; left time: 1822.7604s
Epoch: 4 cost time: 18.720762968063354
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0198319
	speed: 0.1412s/iter; left time: 6343.8889s
	iters: 200, epoch: 5 | loss: 0.3547922
	speed: 0.0368s/iter; left time: 1650.8763s
	iters: 300, epoch: 5 | loss: 0.0492127
	speed: 0.0382s/iter; left time: 1708.1373s
	iters: 400, epoch: 5 | loss: 0.0416528
	speed: 0.0364s/iter; left time: 1622.1999s
Epoch: 5 cost time: 17.314076900482178
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.940821 --> -0.958260).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0278795
	speed: 0.1488s/iter; left time: 6616.3970s
	iters: 200, epoch: 6 | loss: 0.3080494
	speed: 0.0349s/iter; left time: 1549.0273s
	iters: 300, epoch: 6 | loss: 0.0393849
	speed: 0.0380s/iter; left time: 1679.7025s
	iters: 400, epoch: 6 | loss: 0.3813514
	speed: 0.0334s/iter; left time: 1475.0178s
Epoch: 6 cost time: 17.326316833496094
Epoch: 6, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0157636
	speed: 0.1403s/iter; left time: 6172.3330s
	iters: 200, epoch: 7 | loss: 0.2894112
	speed: 0.0367s/iter; left time: 1611.8001s
	iters: 300, epoch: 7 | loss: 0.0519102
	speed: 0.0360s/iter; left time: 1578.3290s
	iters: 400, epoch: 7 | loss: 0.0266903
	speed: 0.0345s/iter; left time: 1506.9440s
Epoch: 7 cost time: 17.307531118392944
Epoch: 7, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.958260 --> -0.968552).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0048808
	speed: 0.1461s/iter; left time: 6359.7256s
	iters: 200, epoch: 8 | loss: 0.0423554
	speed: 0.0341s/iter; left time: 1482.2948s
	iters: 300, epoch: 8 | loss: 0.0149760
	speed: 0.0367s/iter; left time: 1591.7153s
	iters: 400, epoch: 8 | loss: 0.4062816
	speed: 0.0349s/iter; left time: 1506.9963s
Epoch: 8 cost time: 16.978898286819458
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0954374
	speed: 0.1416s/iter; left time: 6097.1004s
	iters: 200, epoch: 9 | loss: 0.0011480
	speed: 0.0357s/iter; left time: 1531.2741s
	iters: 300, epoch: 9 | loss: 0.0517977
	speed: 0.0366s/iter; left time: 1567.4569s
	iters: 400, epoch: 9 | loss: 0.0136913
	speed: 0.0357s/iter; left time: 1525.6987s
Epoch: 9 cost time: 17.2049720287323
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0035357
	speed: 0.1458s/iter; left time: 6206.6115s
	iters: 200, epoch: 10 | loss: 0.1275433
	speed: 0.0367s/iter; left time: 1557.4323s
	iters: 300, epoch: 10 | loss: 0.0993101
	speed: 0.0368s/iter; left time: 1560.0809s
	iters: 400, epoch: 10 | loss: 0.0145170
	speed: 0.0370s/iter; left time: 1562.4274s
Epoch: 10 cost time: 17.654388666152954
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0045191
	speed: 0.1594s/iter; left time: 6712.8613s
	iters: 200, epoch: 11 | loss: 0.1023013
	speed: 0.0375s/iter; left time: 1575.0690s
	iters: 300, epoch: 11 | loss: 0.0014812
	speed: 0.0378s/iter; left time: 1584.9451s
	iters: 400, epoch: 11 | loss: 0.3139490
	speed: 0.0383s/iter; left time: 1602.5170s
Epoch: 11 cost time: 18.030603885650635
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0075109
	speed: 0.1601s/iter; left time: 6665.7318s
	iters: 200, epoch: 12 | loss: 0.5293966
	speed: 0.0398s/iter; left time: 1652.2538s
	iters: 300, epoch: 12 | loss: 0.0061065
	speed: 0.0375s/iter; left time: 1553.5520s
	iters: 400, epoch: 12 | loss: 0.0574940
	speed: 0.0388s/iter; left time: 1603.3940s
Epoch: 12 cost time: 18.56296730041504
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0510226
	speed: 0.1542s/iter; left time: 6349.0157s
	iters: 200, epoch: 13 | loss: 0.0047193
	speed: 0.0365s/iter; left time: 1500.1389s
	iters: 300, epoch: 13 | loss: 0.0029711
	speed: 0.0364s/iter; left time: 1490.0122s
	iters: 400, epoch: 13 | loss: 0.0032311
	speed: 0.0369s/iter; left time: 1507.2217s
Epoch: 13 cost time: 17.46323800086975
Epoch: 13, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0083581
	speed: 0.1556s/iter; left time: 6333.3889s
	iters: 200, epoch: 14 | loss: 0.0423893
	speed: 0.0382s/iter; left time: 1550.7436s
	iters: 300, epoch: 14 | loss: 0.0032113
	speed: 0.0386s/iter; left time: 1563.8659s
	iters: 400, epoch: 14 | loss: 0.1019960
	speed: 0.0357s/iter; left time: 1442.4926s
Epoch: 14 cost time: 18.280667304992676
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0317402
	speed: 0.1428s/iter; left time: 5744.4511s
	iters: 200, epoch: 15 | loss: 0.0060186
	speed: 0.0361s/iter; left time: 1446.9738s
	iters: 300, epoch: 15 | loss: 0.0269263
	speed: 0.0361s/iter; left time: 1444.9751s
	iters: 400, epoch: 15 | loss: 0.3293175
	speed: 0.0349s/iter; left time: 1394.8875s
Epoch: 15 cost time: 17.094806671142578
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0270397
	speed: 0.1417s/iter; left time: 5635.9945s
	iters: 200, epoch: 16 | loss: 0.0021785
	speed: 0.0290s/iter; left time: 1150.6218s
	iters: 300, epoch: 16 | loss: 0.0041027
	speed: 0.0330s/iter; left time: 1304.3970s
	iters: 400, epoch: 16 | loss: 0.0006116
	speed: 0.0327s/iter; left time: 1288.8184s
Epoch: 16 cost time: 15.61795449256897
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0080608
	speed: 0.1396s/iter; left time: 5487.2404s
	iters: 200, epoch: 17 | loss: 0.0261077
	speed: 0.0346s/iter; left time: 1357.5849s
	iters: 300, epoch: 17 | loss: 0.0680342
	speed: 0.0367s/iter; left time: 1435.4338s
	iters: 400, epoch: 17 | loss: 0.0164647
	speed: 0.0346s/iter; left time: 1350.1910s
Epoch: 17 cost time: 16.984436988830566
Epoch: 17, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9685534591194969
model parameter : 424430
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8088431
	speed: 0.0489s/iter; left time: 2287.9748s
	iters: 200, epoch: 1 | loss: 0.5016505
	speed: 0.0401s/iter; left time: 1872.2625s
	iters: 300, epoch: 1 | loss: 0.5335430
	speed: 0.0399s/iter; left time: 1857.3385s
	iters: 400, epoch: 1 | loss: 0.1298820
	speed: 0.0402s/iter; left time: 1869.5292s
Epoch: 1 cost time: 19.673224210739136
Epoch: 1, Steps: 469 | Train Loss: 0.745 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
Validation loss decreased (inf --> -0.905943).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4424116
	speed: 0.1645s/iter; left time: 7621.2783s
	iters: 200, epoch: 2 | loss: 0.3360136
	speed: 0.0380s/iter; left time: 1758.3629s
	iters: 300, epoch: 2 | loss: 0.2468103
	speed: 0.0375s/iter; left time: 1731.7378s
	iters: 400, epoch: 2 | loss: 0.1698142
	speed: 0.0379s/iter; left time: 1746.4536s
Epoch: 2 cost time: 18.059207677841187
Epoch: 2, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.905943 --> -0.944252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0277486
	speed: 0.1584s/iter; left time: 7263.7185s
	iters: 200, epoch: 3 | loss: 0.0467428
	speed: 0.0371s/iter; left time: 1697.6499s
	iters: 300, epoch: 3 | loss: 0.0854981
	speed: 0.0396s/iter; left time: 1806.2772s
	iters: 400, epoch: 3 | loss: 0.0623732
	speed: 0.0368s/iter; left time: 1674.8573s
Epoch: 3 cost time: 18.47270894050598
Epoch: 3, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3008656
	speed: 0.1525s/iter; left time: 6920.4762s
	iters: 200, epoch: 4 | loss: 0.1297772
	speed: 0.0363s/iter; left time: 1642.7791s
	iters: 300, epoch: 4 | loss: 0.0057684
	speed: 0.0376s/iter; left time: 1697.8969s
	iters: 400, epoch: 4 | loss: 0.1632133
	speed: 0.0370s/iter; left time: 1666.3900s
Epoch: 4 cost time: 17.54863691329956
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0102815
	speed: 0.1379s/iter; left time: 6194.2657s
	iters: 200, epoch: 5 | loss: 0.0344236
	speed: 0.0387s/iter; left time: 1736.9282s
	iters: 300, epoch: 5 | loss: 0.0241305
	speed: 0.0345s/iter; left time: 1541.2891s
	iters: 400, epoch: 5 | loss: 0.0062002
	speed: 0.0380s/iter; left time: 1695.6158s
Epoch: 5 cost time: 17.327537536621094
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0115032
	speed: 0.1340s/iter; left time: 5954.9520s
	iters: 200, epoch: 6 | loss: 0.1371199
	speed: 0.0319s/iter; left time: 1413.3040s
	iters: 300, epoch: 6 | loss: 0.0112697
	speed: 0.0329s/iter; left time: 1456.4928s
	iters: 400, epoch: 6 | loss: 0.0382904
	speed: 0.0285s/iter; left time: 1257.9353s
Epoch: 6 cost time: 15.8229660987854
Epoch: 6, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
Validation loss decreased (-0.944252 --> -0.960548).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0198979
	speed: 0.1382s/iter; left time: 6077.9213s
	iters: 200, epoch: 7 | loss: 0.1464323
	speed: 0.0354s/iter; left time: 1551.7691s
	iters: 300, epoch: 7 | loss: 0.0257409
	speed: 0.0375s/iter; left time: 1640.6171s
	iters: 400, epoch: 7 | loss: 0.0166123
	speed: 0.0357s/iter; left time: 1557.5225s
Epoch: 7 cost time: 17.404455423355103
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.960548 --> -0.965408).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0451497
	speed: 0.1455s/iter; left time: 6332.7610s
	iters: 200, epoch: 8 | loss: 0.0045705
	speed: 0.0362s/iter; left time: 1572.6494s
	iters: 300, epoch: 8 | loss: 0.0035284
	speed: 0.0337s/iter; left time: 1461.0237s
	iters: 400, epoch: 8 | loss: 0.6342956
	speed: 0.0322s/iter; left time: 1391.5081s
Epoch: 8 cost time: 16.327462196350098
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0168879
	speed: 0.1324s/iter; left time: 5698.8373s
	iters: 200, epoch: 9 | loss: 0.0807226
	speed: 0.0357s/iter; left time: 1531.2913s
	iters: 300, epoch: 9 | loss: 0.0499400
	speed: 0.0362s/iter; left time: 1552.1904s
	iters: 400, epoch: 9 | loss: 0.0093729
	speed: 0.0360s/iter; left time: 1537.4319s
Epoch: 9 cost time: 17.303897619247437
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0042103
	speed: 0.1594s/iter; left time: 6789.2404s
	iters: 200, epoch: 10 | loss: 0.0404760
	speed: 0.0380s/iter; left time: 1612.6260s
	iters: 300, epoch: 10 | loss: 0.0525039
	speed: 0.0383s/iter; left time: 1624.1064s
	iters: 400, epoch: 10 | loss: 0.0020371
	speed: 0.0380s/iter; left time: 1605.6793s
Epoch: 10 cost time: 18.371944665908813
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.965408 --> -0.969410).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0079837
	speed: 0.1561s/iter; left time: 6573.4893s
	iters: 200, epoch: 11 | loss: 0.0097967
	speed: 0.0382s/iter; left time: 1603.8344s
	iters: 300, epoch: 11 | loss: 0.0182197
	speed: 0.0374s/iter; left time: 1568.8768s
	iters: 400, epoch: 11 | loss: 0.0019187
	speed: 0.0371s/iter; left time: 1549.9334s
Epoch: 11 cost time: 18.142627000808716
Epoch: 11, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0034216
	speed: 0.1600s/iter; left time: 6662.7372s
	iters: 200, epoch: 12 | loss: 0.0014456
	speed: 0.0380s/iter; left time: 1577.2152s
	iters: 300, epoch: 12 | loss: 0.0109191
	speed: 0.0386s/iter; left time: 1599.7361s
	iters: 400, epoch: 12 | loss: 0.0060400
	speed: 0.0375s/iter; left time: 1551.8057s
Epoch: 12 cost time: 18.040440320968628
Epoch: 12, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2706698
	speed: 0.1396s/iter; left time: 5745.6982s
	iters: 200, epoch: 13 | loss: 0.0036829
	speed: 0.0383s/iter; left time: 1573.7258s
	iters: 300, epoch: 13 | loss: 0.0333039
	speed: 0.0370s/iter; left time: 1514.5884s
	iters: 400, epoch: 13 | loss: 0.0300324
	speed: 0.0353s/iter; left time: 1441.6088s
Epoch: 13 cost time: 17.35286831855774
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0029682
	speed: 0.1389s/iter; left time: 5654.8219s
	iters: 200, epoch: 14 | loss: 0.0109935
	speed: 0.0365s/iter; left time: 1483.7505s
	iters: 300, epoch: 14 | loss: 0.0533927
	speed: 0.0377s/iter; left time: 1525.9288s
	iters: 400, epoch: 14 | loss: 0.0010774
	speed: 0.0365s/iter; left time: 1476.4539s
Epoch: 14 cost time: 17.422817707061768
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2599663
	speed: 0.1341s/iter; left time: 5397.1605s
	iters: 200, epoch: 15 | loss: 0.0050181
	speed: 0.0320s/iter; left time: 1282.7699s
	iters: 300, epoch: 15 | loss: 0.1487479
	speed: 0.0315s/iter; left time: 1261.3814s
	iters: 400, epoch: 15 | loss: 0.0162527
	speed: 0.0318s/iter; left time: 1269.7989s
Epoch: 15 cost time: 15.248589754104614
Epoch: 15, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.971697).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0205938
	speed: 0.1257s/iter; left time: 4999.9364s
	iters: 200, epoch: 16 | loss: 0.0040146
	speed: 0.0349s/iter; left time: 1383.2538s
	iters: 300, epoch: 16 | loss: 0.0047249
	speed: 0.0366s/iter; left time: 1449.6936s
	iters: 400, epoch: 16 | loss: 0.0764132
	speed: 0.0346s/iter; left time: 1365.8083s
Epoch: 16 cost time: 16.73087191581726
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0092997
	speed: 0.1349s/iter; left time: 5303.0643s
	iters: 200, epoch: 17 | loss: 0.0046702
	speed: 0.0375s/iter; left time: 1470.8937s
	iters: 300, epoch: 17 | loss: 0.0144955
	speed: 0.0388s/iter; left time: 1515.1806s
	iters: 400, epoch: 17 | loss: 0.0870073
	speed: 0.0371s/iter; left time: 1447.2886s
Epoch: 17 cost time: 17.747852325439453
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.277 Vali Acc: 0.934 Test Loss: 0.277 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0115841
	speed: 0.1455s/iter; left time: 5648.6542s
	iters: 200, epoch: 18 | loss: 0.0361509
	speed: 0.0395s/iter; left time: 1531.2290s
	iters: 300, epoch: 18 | loss: 0.0020907
	speed: 0.0394s/iter; left time: 1520.6140s
	iters: 400, epoch: 18 | loss: 0.3501633
	speed: 0.0384s/iter; left time: 1478.2373s
Epoch: 18 cost time: 18.435023546218872
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0323178
	speed: 0.1571s/iter; left time: 6027.3832s
	iters: 200, epoch: 19 | loss: 0.0158681
	speed: 0.0358s/iter; left time: 1370.2200s
	iters: 300, epoch: 19 | loss: 0.0182625
	speed: 0.0364s/iter; left time: 1390.6995s
	iters: 400, epoch: 19 | loss: 0.0007974
	speed: 0.0376s/iter; left time: 1429.5659s
Epoch: 19 cost time: 17.642573595046997
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0027166
	speed: 0.1628s/iter; left time: 6170.3747s
	iters: 200, epoch: 20 | loss: 0.0186873
	speed: 0.0382s/iter; left time: 1443.9255s
	iters: 300, epoch: 20 | loss: 0.0005464
	speed: 0.0378s/iter; left time: 1424.9457s
	iters: 400, epoch: 20 | loss: 0.4184326
	speed: 0.0386s/iter; left time: 1451.1411s
Epoch: 20 cost time: 18.252111196517944
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0152733
	speed: 0.1447s/iter; left time: 5415.3403s
	iters: 200, epoch: 21 | loss: 0.0047291
	speed: 0.0363s/iter; left time: 1355.6109s
	iters: 300, epoch: 21 | loss: 0.1112936
	speed: 0.0350s/iter; left time: 1302.6806s
	iters: 400, epoch: 21 | loss: 0.0018322
	speed: 0.0363s/iter; left time: 1348.1844s
Epoch: 21 cost time: 17.100462675094604
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0150300
	speed: 0.1462s/iter; left time: 5403.9365s
	iters: 200, epoch: 22 | loss: 0.0143186
	speed: 0.0359s/iter; left time: 1321.8136s
	iters: 300, epoch: 22 | loss: 0.0013834
	speed: 0.0355s/iter; left time: 1303.2400s
	iters: 400, epoch: 22 | loss: 0.0215347
	speed: 0.0356s/iter; left time: 1306.1782s
Epoch: 22 cost time: 17.398075342178345
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.971697 --> -0.976557).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0007813
	speed: 0.1488s/iter; left time: 5429.9309s
	iters: 200, epoch: 23 | loss: 0.3581857
	speed: 0.0377s/iter; left time: 1373.2981s
	iters: 300, epoch: 23 | loss: 0.0583888
	speed: 0.0352s/iter; left time: 1276.3144s
	iters: 400, epoch: 23 | loss: 0.0055649
	speed: 0.0370s/iter; left time: 1340.1914s
Epoch: 23 cost time: 17.52268648147583
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0009563
	speed: 0.1470s/iter; left time: 5294.3073s
	iters: 200, epoch: 24 | loss: 0.1215326
	speed: 0.0383s/iter; left time: 1375.4393s
	iters: 300, epoch: 24 | loss: 0.0011086
	speed: 0.0375s/iter; left time: 1341.2388s
	iters: 400, epoch: 24 | loss: 0.0352127
	speed: 0.0341s/iter; left time: 1216.0909s
Epoch: 24 cost time: 17.61377263069153
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2524776
	speed: 0.1357s/iter; left time: 4821.7283s
	iters: 200, epoch: 25 | loss: 0.0006238
	speed: 0.0357s/iter; left time: 1265.2302s
	iters: 300, epoch: 25 | loss: 0.0011470
	speed: 0.0339s/iter; left time: 1196.8742s
	iters: 400, epoch: 25 | loss: 0.0014700
	speed: 0.0365s/iter; left time: 1287.7221s
Epoch: 25 cost time: 17.02165699005127
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0013773
	speed: 0.1381s/iter; left time: 4844.8587s
	iters: 200, epoch: 26 | loss: 0.0947087
	speed: 0.0328s/iter; left time: 1148.7597s
	iters: 300, epoch: 26 | loss: 0.0033374
	speed: 0.0293s/iter; left time: 1022.5176s
	iters: 400, epoch: 26 | loss: 0.0006000
	speed: 0.0313s/iter; left time: 1088.8348s
Epoch: 26 cost time: 15.909176588058472
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.949 Test Loss: 0.238 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0044735
	speed: 0.1514s/iter; left time: 5238.7365s
	iters: 200, epoch: 27 | loss: 0.0002349
	speed: 0.0360s/iter; left time: 1241.6770s
	iters: 300, epoch: 27 | loss: 0.0007792
	speed: 0.0381s/iter; left time: 1312.5615s
	iters: 400, epoch: 27 | loss: 0.2689237
	speed: 0.0370s/iter; left time: 1268.7876s
Epoch: 27 cost time: 17.700066328048706
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0506248
	speed: 0.1571s/iter; left time: 5364.6673s
	iters: 200, epoch: 28 | loss: 0.2858698
	speed: 0.0376s/iter; left time: 1278.4609s
	iters: 300, epoch: 28 | loss: 0.0250063
	speed: 0.0391s/iter; left time: 1327.1260s
	iters: 400, epoch: 28 | loss: 0.1860974
	speed: 0.0356s/iter; left time: 1205.6249s
Epoch: 28 cost time: 17.839898109436035
Epoch: 28, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0067829
	speed: 0.1482s/iter; left time: 4988.6854s
	iters: 200, epoch: 29 | loss: 0.0025323
	speed: 0.0368s/iter; left time: 1234.6253s
	iters: 300, epoch: 29 | loss: 0.0004923
	speed: 0.0330s/iter; left time: 1105.5412s
	iters: 400, epoch: 29 | loss: 0.0008479
	speed: 0.0367s/iter; left time: 1225.6463s
Epoch: 29 cost time: 17.148675203323364
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0003555
	speed: 0.1591s/iter; left time: 5283.0688s
	iters: 200, epoch: 30 | loss: 0.0088711
	speed: 0.0372s/iter; left time: 1232.4495s
	iters: 300, epoch: 30 | loss: 0.0011072
	speed: 0.0372s/iter; left time: 1227.8737s
	iters: 400, epoch: 30 | loss: 0.1829787
	speed: 0.0357s/iter; left time: 1175.4220s
Epoch: 30 cost time: 17.472529649734497
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0031237
	speed: 0.1277s/iter; left time: 4179.4584s
	iters: 200, epoch: 31 | loss: 0.3211851
	speed: 0.0368s/iter; left time: 1201.3098s
	iters: 300, epoch: 31 | loss: 0.0025062
	speed: 0.0362s/iter; left time: 1179.0796s
	iters: 400, epoch: 31 | loss: 0.0599673
	speed: 0.0364s/iter; left time: 1179.1039s
Epoch: 31 cost time: 17.234959840774536
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0017294
	speed: 0.1460s/iter; left time: 4711.5268s
	iters: 200, epoch: 32 | loss: 0.0007638
	speed: 0.0379s/iter; left time: 1217.5811s
	iters: 300, epoch: 32 | loss: 0.0034147
	speed: 0.0353s/iter; left time: 1130.4399s
	iters: 400, epoch: 32 | loss: 0.0040830
	speed: 0.0353s/iter; left time: 1126.7586s
Epoch: 32 cost time: 17.207653760910034
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 424302
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3833487
	speed: 0.0429s/iter; left time: 2007.9631s
	iters: 200, epoch: 1 | loss: 0.5058168
	speed: 0.0338s/iter; left time: 1579.2890s
	iters: 300, epoch: 1 | loss: 0.4619408
	speed: 0.0348s/iter; left time: 1619.9357s
	iters: 400, epoch: 1 | loss: 0.2868323
	speed: 0.0327s/iter; left time: 1520.9768s
Epoch: 1 cost time: 16.90174651145935
Epoch: 1, Steps: 469 | Train Loss: 0.827 Vali Loss: 0.353 Vali Acc: 0.887 Test Loss: 0.353 Test Acc: 0.887
Validation loss decreased (inf --> -0.886503).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2160300
	speed: 0.1336s/iter; left time: 6189.5559s
	iters: 200, epoch: 2 | loss: 0.0767107
	speed: 0.0342s/iter; left time: 1583.2956s
	iters: 300, epoch: 2 | loss: 0.0991784
	speed: 0.0365s/iter; left time: 1682.8334s
	iters: 400, epoch: 2 | loss: 0.0443903
	speed: 0.0358s/iter; left time: 1649.9397s
Epoch: 2 cost time: 16.7906653881073
Epoch: 2, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (-0.886503 --> -0.943394).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2381123
	speed: 0.1520s/iter; left time: 6969.6148s
	iters: 200, epoch: 3 | loss: 0.0761079
	speed: 0.0345s/iter; left time: 1577.7127s
	iters: 300, epoch: 3 | loss: 0.0791102
	speed: 0.0356s/iter; left time: 1627.8635s
	iters: 400, epoch: 3 | loss: 0.0201243
	speed: 0.0333s/iter; left time: 1518.3210s
Epoch: 3 cost time: 16.65229606628418
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.943394 --> -0.956831).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0532652
	speed: 0.1287s/iter; left time: 5841.9576s
	iters: 200, epoch: 4 | loss: 0.4089384
	speed: 0.0343s/iter; left time: 1554.1374s
	iters: 300, epoch: 4 | loss: 0.0696175
	speed: 0.0379s/iter; left time: 1712.6504s
	iters: 400, epoch: 4 | loss: 0.0632905
	speed: 0.0382s/iter; left time: 1721.1356s
Epoch: 4 cost time: 17.47389316558838
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.956831 --> -0.964264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0253353
	speed: 0.1539s/iter; left time: 6913.8014s
	iters: 200, epoch: 5 | loss: 0.0538793
	speed: 0.0347s/iter; left time: 1555.3287s
	iters: 300, epoch: 5 | loss: 0.0096531
	speed: 0.0323s/iter; left time: 1445.1394s
	iters: 400, epoch: 5 | loss: 0.0301017
	speed: 0.0307s/iter; left time: 1369.5115s
Epoch: 5 cost time: 15.773112058639526
Epoch: 5, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.184 Vali Acc: 0.945 Test Loss: 0.184 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0198328
	speed: 0.1121s/iter; left time: 4982.3550s
	iters: 200, epoch: 6 | loss: 0.0242203
	speed: 0.0376s/iter; left time: 1666.2524s
	iters: 300, epoch: 6 | loss: 0.0642569
	speed: 0.0358s/iter; left time: 1585.5307s
	iters: 400, epoch: 6 | loss: 0.0114173
	speed: 0.0366s/iter; left time: 1618.0121s
Epoch: 6 cost time: 17.204814910888672
Epoch: 6, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1275886
	speed: 0.1546s/iter; left time: 6801.0115s
	iters: 200, epoch: 7 | loss: 0.0090821
	speed: 0.0362s/iter; left time: 1586.8129s
	iters: 300, epoch: 7 | loss: 0.0219944
	speed: 0.0350s/iter; left time: 1533.3092s
	iters: 400, epoch: 7 | loss: 0.0128382
	speed: 0.0341s/iter; left time: 1489.9606s
Epoch: 7 cost time: 17.00014328956604
Epoch: 7, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0059153
	speed: 0.1426s/iter; left time: 6207.4491s
	iters: 200, epoch: 8 | loss: 0.0832370
	speed: 0.0341s/iter; left time: 1479.8794s
	iters: 300, epoch: 8 | loss: 0.0093136
	speed: 0.0367s/iter; left time: 1590.9831s
	iters: 400, epoch: 8 | loss: 0.1331296
	speed: 0.0353s/iter; left time: 1527.6830s
Epoch: 8 cost time: 16.96002435684204
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1334569
	speed: 0.1461s/iter; left time: 6288.2735s
	iters: 200, epoch: 9 | loss: 0.0092757
	speed: 0.0349s/iter; left time: 1497.7808s
	iters: 300, epoch: 9 | loss: 0.0315065
	speed: 0.0352s/iter; left time: 1508.8305s
	iters: 400, epoch: 9 | loss: 0.2315785
	speed: 0.0349s/iter; left time: 1490.3771s
Epoch: 9 cost time: 16.627684354782104
Epoch: 9, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2096440
	speed: 0.1408s/iter; left time: 5993.7447s
	iters: 200, epoch: 10 | loss: 0.0128524
	speed: 0.0368s/iter; left time: 1562.3323s
	iters: 300, epoch: 10 | loss: 0.0450400
	speed: 0.0373s/iter; left time: 1580.2379s
	iters: 400, epoch: 10 | loss: 0.0056498
	speed: 0.0382s/iter; left time: 1616.1720s
Epoch: 10 cost time: 17.749320030212402
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0120645
	speed: 0.1507s/iter; left time: 6346.3005s
	iters: 200, epoch: 11 | loss: 0.0025149
	speed: 0.0377s/iter; left time: 1584.6736s
	iters: 300, epoch: 11 | loss: 0.0217323
	speed: 0.0391s/iter; left time: 1638.2890s
	iters: 400, epoch: 11 | loss: 0.0012557
	speed: 0.0367s/iter; left time: 1535.4856s
Epoch: 11 cost time: 18.10509419441223
Epoch: 11, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1208867
	speed: 0.1465s/iter; left time: 6100.3995s
	iters: 200, epoch: 12 | loss: 0.0038545
	speed: 0.0384s/iter; left time: 1596.8934s
	iters: 300, epoch: 12 | loss: 0.0043307
	speed: 0.0378s/iter; left time: 1566.4776s
	iters: 400, epoch: 12 | loss: 0.0008921
	speed: 0.0381s/iter; left time: 1576.2553s
Epoch: 12 cost time: 17.99335026741028
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0755425
	speed: 0.1559s/iter; left time: 6419.0899s
	iters: 200, epoch: 13 | loss: 0.0021895
	speed: 0.0391s/iter; left time: 1607.2251s
	iters: 300, epoch: 13 | loss: 0.0026858
	speed: 0.0378s/iter; left time: 1546.7664s
	iters: 400, epoch: 13 | loss: 0.0898735
	speed: 0.0367s/iter; left time: 1501.6017s
Epoch: 13 cost time: 18.30921220779419
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.964264 --> -0.971983).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1381102
	speed: 0.1558s/iter; left time: 6343.0531s
	iters: 200, epoch: 14 | loss: 0.0076634
	speed: 0.0374s/iter; left time: 1518.8852s
	iters: 300, epoch: 14 | loss: 0.0067414
	speed: 0.0385s/iter; left time: 1559.0973s
	iters: 400, epoch: 14 | loss: 0.5902919
	speed: 0.0372s/iter; left time: 1503.3113s
Epoch: 14 cost time: 18.32124614715576
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0100488
	speed: 0.1702s/iter; left time: 6848.8107s
	iters: 200, epoch: 15 | loss: 0.0017893
	speed: 0.0399s/iter; left time: 1602.6097s
	iters: 300, epoch: 15 | loss: 0.0018499
	speed: 0.0369s/iter; left time: 1476.6123s
	iters: 400, epoch: 15 | loss: 0.0040937
	speed: 0.0386s/iter; left time: 1539.5728s
Epoch: 15 cost time: 18.214300394058228
Epoch: 15, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0042943
	speed: 0.1402s/iter; left time: 5576.0954s
	iters: 200, epoch: 16 | loss: 0.0094638
	speed: 0.0380s/iter; left time: 1506.2006s
	iters: 300, epoch: 16 | loss: 0.0217342
	speed: 0.0356s/iter; left time: 1407.5093s
	iters: 400, epoch: 16 | loss: 0.0010964
	speed: 0.0365s/iter; left time: 1439.8317s
Epoch: 16 cost time: 17.640860319137573
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0094182
	speed: 0.1485s/iter; left time: 5833.6519s
	iters: 200, epoch: 17 | loss: 0.0107771
	speed: 0.0375s/iter; left time: 1468.1334s
	iters: 300, epoch: 17 | loss: 0.0075617
	speed: 0.0341s/iter; left time: 1333.6018s
	iters: 400, epoch: 17 | loss: 0.0022493
	speed: 0.0359s/iter; left time: 1400.6749s
Epoch: 17 cost time: 17.093613386154175
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.971983 --> -0.979988).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0107033
	speed: 0.1384s/iter; left time: 5373.7565s
	iters: 200, epoch: 18 | loss: 0.0182787
	speed: 0.0376s/iter; left time: 1456.5038s
	iters: 300, epoch: 18 | loss: 0.0047665
	speed: 0.0383s/iter; left time: 1479.7830s
	iters: 400, epoch: 18 | loss: 0.0254711
	speed: 0.0341s/iter; left time: 1313.3707s
Epoch: 18 cost time: 17.330911874771118
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3941674
	speed: 0.1483s/iter; left time: 5686.7991s
	iters: 200, epoch: 19 | loss: 0.0346225
	speed: 0.0378s/iter; left time: 1447.8229s
	iters: 300, epoch: 19 | loss: 0.0064265
	speed: 0.0359s/iter; left time: 1368.1749s
	iters: 400, epoch: 19 | loss: 0.0104064
	speed: 0.0363s/iter; left time: 1381.2445s
Epoch: 19 cost time: 17.25166940689087
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0241675
	speed: 0.1140s/iter; left time: 4318.5210s
	iters: 200, epoch: 20 | loss: 0.0008176
	speed: 0.0317s/iter; left time: 1197.4011s
	iters: 300, epoch: 20 | loss: 0.0017621
	speed: 0.0344s/iter; left time: 1297.7331s
	iters: 400, epoch: 20 | loss: 0.0039520
	speed: 0.0359s/iter; left time: 1348.6264s
Epoch: 20 cost time: 16.51212739944458
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.961 Test Loss: 0.195 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0412773
	speed: 0.1520s/iter; left time: 5689.3616s
	iters: 200, epoch: 21 | loss: 0.0014388
	speed: 0.0375s/iter; left time: 1397.8772s
	iters: 300, epoch: 21 | loss: 0.0040120
	speed: 0.0390s/iter; left time: 1451.3627s
	iters: 400, epoch: 21 | loss: 0.0066294
	speed: 0.0371s/iter; left time: 1377.9873s
Epoch: 21 cost time: 18.22243094444275
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0466852
	speed: 0.1633s/iter; left time: 6033.3741s
	iters: 200, epoch: 22 | loss: 0.0054220
	speed: 0.0414s/iter; left time: 1524.2392s
	iters: 300, epoch: 22 | loss: 0.0009800
	speed: 0.0382s/iter; left time: 1404.9795s
	iters: 400, epoch: 22 | loss: 0.0186086
	speed: 0.0367s/iter; left time: 1345.2107s
Epoch: 22 cost time: 18.28435492515564
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.246 Vali Acc: 0.953 Test Loss: 0.246 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0060783
	speed: 0.1607s/iter; left time: 5862.2613s
	iters: 200, epoch: 23 | loss: 0.0021676
	speed: 0.0380s/iter; left time: 1382.9880s
	iters: 300, epoch: 23 | loss: 0.0577890
	speed: 0.0384s/iter; left time: 1392.3644s
	iters: 400, epoch: 23 | loss: 0.0149203
	speed: 0.0386s/iter; left time: 1395.6155s
Epoch: 23 cost time: 18.158944368362427
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0015653
	speed: 0.1448s/iter; left time: 5214.3349s
	iters: 200, epoch: 24 | loss: 0.0010344
	speed: 0.0376s/iter; left time: 1349.9017s
	iters: 300, epoch: 24 | loss: 0.0150022
	speed: 0.0360s/iter; left time: 1287.8937s
	iters: 400, epoch: 24 | loss: 0.0615774
	speed: 0.0378s/iter; left time: 1350.4083s
Epoch: 24 cost time: 17.768120527267456
Epoch: 24, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0064018
	speed: 0.1580s/iter; left time: 5614.6298s
	iters: 200, epoch: 25 | loss: 0.0081616
	speed: 0.0368s/iter; left time: 1305.3696s
	iters: 300, epoch: 25 | loss: 0.0295201
	speed: 0.0369s/iter; left time: 1304.6878s
	iters: 400, epoch: 25 | loss: 0.0005726
	speed: 0.0342s/iter; left time: 1206.1770s
Epoch: 25 cost time: 17.51095747947693
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0006581
	speed: 0.1488s/iter; left time: 5220.0826s
	iters: 200, epoch: 26 | loss: 0.0035648
	speed: 0.0340s/iter; left time: 1190.5676s
	iters: 300, epoch: 26 | loss: 0.0026146
	speed: 0.0322s/iter; left time: 1124.7254s
	iters: 400, epoch: 26 | loss: 0.0447508
	speed: 0.0335s/iter; left time: 1165.8351s
Epoch: 26 cost time: 16.15852999687195
Epoch: 26, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0008940
	speed: 0.1344s/iter; left time: 4650.0376s
	iters: 200, epoch: 27 | loss: 0.0052050
	speed: 0.0365s/iter; left time: 1259.4484s
	iters: 300, epoch: 27 | loss: 0.0028277
	speed: 0.0360s/iter; left time: 1238.7106s
	iters: 400, epoch: 27 | loss: 0.0036140
	speed: 0.0391s/iter; left time: 1342.6362s
Epoch: 27 cost time: 17.881945848464966
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.291 Vali Acc: 0.951 Test Loss: 0.291 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 421966
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3026717
	speed: 0.0501s/iter; left time: 2346.3786s
	iters: 200, epoch: 1 | loss: 0.7217638
	speed: 0.0367s/iter; left time: 1712.6277s
	iters: 300, epoch: 1 | loss: 0.6293506
	speed: 0.0362s/iter; left time: 1686.8619s
	iters: 400, epoch: 1 | loss: 0.4829822
	speed: 0.0360s/iter; left time: 1676.2408s
Epoch: 1 cost time: 18.37400794029236
Epoch: 1, Steps: 469 | Train Loss: 0.900 Vali Loss: 0.364 Vali Acc: 0.895 Test Loss: 0.364 Test Acc: 0.895
Validation loss decreased (inf --> -0.895079).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1329607
	speed: 0.1448s/iter; left time: 6710.1057s
	iters: 200, epoch: 2 | loss: 0.6710514
	speed: 0.0367s/iter; left time: 1695.2178s
	iters: 300, epoch: 2 | loss: 0.2686136
	speed: 0.0368s/iter; left time: 1698.9033s
	iters: 400, epoch: 2 | loss: 0.0272499
	speed: 0.0377s/iter; left time: 1737.4915s
Epoch: 2 cost time: 17.553521156311035
Epoch: 2, Steps: 469 | Train Loss: 0.196 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
Validation loss decreased (-0.895079 --> -0.937963).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3211226
	speed: 0.1610s/iter; left time: 7383.9826s
	iters: 200, epoch: 3 | loss: 0.0136762
	speed: 0.0367s/iter; left time: 1680.1805s
	iters: 300, epoch: 3 | loss: 0.0635879
	speed: 0.0385s/iter; left time: 1757.4551s
	iters: 400, epoch: 3 | loss: 0.0124943
	speed: 0.0378s/iter; left time: 1722.9578s
Epoch: 3 cost time: 17.670819759368896
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.937963 --> -0.966837).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0734998
	speed: 0.1559s/iter; left time: 7076.8062s
	iters: 200, epoch: 4 | loss: 0.0206095
	speed: 0.0365s/iter; left time: 1654.6057s
	iters: 300, epoch: 4 | loss: 0.0313209
	speed: 0.0374s/iter; left time: 1688.3271s
	iters: 400, epoch: 4 | loss: 0.0191652
	speed: 0.0354s/iter; left time: 1594.9237s
Epoch: 4 cost time: 17.567063093185425
Epoch: 4, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0085638
	speed: 0.1505s/iter; left time: 6758.9814s
	iters: 200, epoch: 5 | loss: 0.0479252
	speed: 0.0373s/iter; left time: 1671.9348s
	iters: 300, epoch: 5 | loss: 0.0883526
	speed: 0.0344s/iter; left time: 1540.3319s
	iters: 400, epoch: 5 | loss: 0.1978245
	speed: 0.0350s/iter; left time: 1561.8040s
Epoch: 5 cost time: 16.89310646057129
Epoch: 5, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0108888
	speed: 0.1441s/iter; left time: 6404.5860s
	iters: 200, epoch: 6 | loss: 0.1412937
	speed: 0.0344s/iter; left time: 1523.9155s
	iters: 300, epoch: 6 | loss: 0.0124768
	speed: 0.0387s/iter; left time: 1714.0110s
	iters: 400, epoch: 6 | loss: 0.0603850
	speed: 0.0335s/iter; left time: 1479.8263s
Epoch: 6 cost time: 16.99514412879944
Epoch: 6, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0087285
	speed: 0.1485s/iter; left time: 6533.5766s
	iters: 200, epoch: 7 | loss: 0.0256121
	speed: 0.0378s/iter; left time: 1659.2510s
	iters: 300, epoch: 7 | loss: 0.0244320
	speed: 0.0365s/iter; left time: 1597.8689s
	iters: 400, epoch: 7 | loss: 0.0275512
	speed: 0.0364s/iter; left time: 1589.3395s
Epoch: 7 cost time: 17.683207750320435
Epoch: 7, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0017935
	speed: 0.1224s/iter; left time: 5327.2094s
	iters: 200, epoch: 8 | loss: 0.0057915
	speed: 0.0318s/iter; left time: 1381.8225s
	iters: 300, epoch: 8 | loss: 0.0068045
	speed: 0.0303s/iter; left time: 1313.1696s
	iters: 400, epoch: 8 | loss: 0.0042691
	speed: 0.0298s/iter; left time: 1289.7233s
Epoch: 8 cost time: 14.830196619033813
Epoch: 8, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0023168
	speed: 0.1667s/iter; left time: 7176.4313s
	iters: 200, epoch: 9 | loss: 0.0056221
	speed: 0.0352s/iter; left time: 1512.8199s
	iters: 300, epoch: 9 | loss: 0.0362666
	speed: 0.0383s/iter; left time: 1640.9935s
	iters: 400, epoch: 9 | loss: 0.0322868
	speed: 0.0376s/iter; left time: 1608.7661s
Epoch: 9 cost time: 17.773393869400024
Epoch: 9, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0083190
	speed: 0.1391s/iter; left time: 5923.7137s
	iters: 200, epoch: 10 | loss: 0.0065226
	speed: 0.0386s/iter; left time: 1641.0457s
	iters: 300, epoch: 10 | loss: 0.0099568
	speed: 0.0361s/iter; left time: 1529.8333s
	iters: 400, epoch: 10 | loss: 0.0200999
	speed: 0.0356s/iter; left time: 1504.8365s
Epoch: 10 cost time: 17.447625637054443
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0305896
	speed: 0.1657s/iter; left time: 6978.2609s
	iters: 200, epoch: 11 | loss: 0.0053876
	speed: 0.0389s/iter; left time: 1635.0603s
	iters: 300, epoch: 11 | loss: 0.0544497
	speed: 0.0367s/iter; left time: 1538.3118s
	iters: 400, epoch: 11 | loss: 0.1293352
	speed: 0.0423s/iter; left time: 1770.5174s
Epoch: 11 cost time: 18.70904517173767
Epoch: 11, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0110928
	speed: 0.1721s/iter; left time: 7165.3064s
	iters: 200, epoch: 12 | loss: 0.0227593
	speed: 0.0397s/iter; left time: 1647.8475s
	iters: 300, epoch: 12 | loss: 0.0155040
	speed: 0.0421s/iter; left time: 1743.8020s
	iters: 400, epoch: 12 | loss: 0.0479321
	speed: 0.0389s/iter; left time: 1608.5082s
Epoch: 12 cost time: 18.634559154510498
Epoch: 12, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.968838).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0129601
	speed: 0.1669s/iter; left time: 6870.0064s
	iters: 200, epoch: 13 | loss: 0.0026044
	speed: 0.0403s/iter; left time: 1654.4402s
	iters: 300, epoch: 13 | loss: 0.0108304
	speed: 0.0414s/iter; left time: 1697.7895s
	iters: 400, epoch: 13 | loss: 0.0054278
	speed: 0.0387s/iter; left time: 1583.2574s
Epoch: 13 cost time: 19.096864461898804
Epoch: 13, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0071282
	speed: 0.1585s/iter; left time: 6452.9774s
	iters: 200, epoch: 14 | loss: 0.0009775
	speed: 0.0381s/iter; left time: 1548.4406s
	iters: 300, epoch: 14 | loss: 0.4404961
	speed: 0.0375s/iter; left time: 1520.0550s
	iters: 400, epoch: 14 | loss: 0.0115503
	speed: 0.0363s/iter; left time: 1468.1454s
Epoch: 14 cost time: 17.640421152114868
Epoch: 14, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0024186
	speed: 0.1594s/iter; left time: 6411.7870s
	iters: 200, epoch: 15 | loss: 0.0117486
	speed: 0.0393s/iter; left time: 1576.0266s
	iters: 300, epoch: 15 | loss: 0.0028674
	speed: 0.0385s/iter; left time: 1539.6759s
	iters: 400, epoch: 15 | loss: 0.0062321
	speed: 0.0361s/iter; left time: 1441.2268s
Epoch: 15 cost time: 18.284339427947998
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1922107
	speed: 0.1599s/iter; left time: 6359.1672s
	iters: 200, epoch: 16 | loss: 0.0067121
	speed: 0.0393s/iter; left time: 1558.9726s
	iters: 300, epoch: 16 | loss: 0.0026630
	speed: 0.0382s/iter; left time: 1513.2459s
	iters: 400, epoch: 16 | loss: 0.0853482
	speed: 0.0370s/iter; left time: 1458.5478s
Epoch: 16 cost time: 17.65434765815735
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0010133
	speed: 0.1525s/iter; left time: 5991.7705s
	iters: 200, epoch: 17 | loss: 0.0059879
	speed: 0.0368s/iter; left time: 1444.1425s
	iters: 300, epoch: 17 | loss: 0.0977434
	speed: 0.0360s/iter; left time: 1406.2431s
	iters: 400, epoch: 17 | loss: 0.0336500
	speed: 0.0384s/iter; left time: 1495.9992s
Epoch: 17 cost time: 17.6607825756073
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.954 Test Loss: 0.236 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0062165
	speed: 0.1594s/iter; left time: 6188.5160s
	iters: 200, epoch: 18 | loss: 0.0396512
	speed: 0.0393s/iter; left time: 1523.8216s
	iters: 300, epoch: 18 | loss: 0.0187968
	speed: 0.0375s/iter; left time: 1448.1666s
	iters: 400, epoch: 18 | loss: 0.0023633
	speed: 0.0384s/iter; left time: 1478.1272s
Epoch: 18 cost time: 17.882399320602417
Epoch: 18, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1557109
	speed: 0.1486s/iter; left time: 5699.1997s
	iters: 200, epoch: 19 | loss: 0.0545273
	speed: 0.0342s/iter; left time: 1310.3597s
	iters: 300, epoch: 19 | loss: 0.0045420
	speed: 0.0372s/iter; left time: 1418.2086s
	iters: 400, epoch: 19 | loss: 0.0010178
	speed: 0.0373s/iter; left time: 1420.8441s
Epoch: 19 cost time: 17.310978412628174
Epoch: 19, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0053868
	speed: 0.1594s/iter; left time: 6038.1212s
	iters: 200, epoch: 20 | loss: 0.0042410
	speed: 0.0383s/iter; left time: 1445.6481s
	iters: 300, epoch: 20 | loss: 0.0048390
	speed: 0.0382s/iter; left time: 1438.5248s
	iters: 400, epoch: 20 | loss: 0.3236755
	speed: 0.0373s/iter; left time: 1400.5064s
Epoch: 20 cost time: 18.208455562591553
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0004341
	speed: 0.1629s/iter; left time: 6094.8517s
	iters: 200, epoch: 21 | loss: 0.0015316
	speed: 0.0390s/iter; left time: 1456.6360s
	iters: 300, epoch: 21 | loss: 0.0009265
	speed: 0.0407s/iter; left time: 1516.0728s
	iters: 400, epoch: 21 | loss: 0.0077446
	speed: 0.0404s/iter; left time: 1498.9119s
Epoch: 21 cost time: 18.851045608520508
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.193 Vali Acc: 0.961 Test Loss: 0.193 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0041197
	speed: 0.1663s/iter; left time: 6144.8874s
	iters: 200, epoch: 22 | loss: 0.0028502
	speed: 0.0385s/iter; left time: 1417.6879s
	iters: 300, epoch: 22 | loss: 0.0012864
	speed: 0.0402s/iter; left time: 1478.0216s
	iters: 400, epoch: 22 | loss: 0.0121909
	speed: 0.0386s/iter; left time: 1413.7888s
Epoch: 22 cost time: 18.6564838886261
Epoch: 22, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.968839336763865
model parameter : 421902
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2431053
	speed: 0.0513s/iter; left time: 2399.6874s
	iters: 200, epoch: 1 | loss: 0.5474479
	speed: 0.0380s/iter; left time: 1775.4429s
	iters: 300, epoch: 1 | loss: 0.4194536
	speed: 0.0378s/iter; left time: 1760.8108s
	iters: 400, epoch: 1 | loss: 0.2948561
	speed: 0.0403s/iter; left time: 1875.4370s
Epoch: 1 cost time: 19.588098526000977
Epoch: 1, Steps: 469 | Train Loss: 0.866 Vali Loss: 0.348 Vali Acc: 0.901 Test Loss: 0.348 Test Acc: 0.901
Validation loss decreased (inf --> -0.900511).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0857509
	speed: 0.1577s/iter; left time: 7306.7741s
	iters: 200, epoch: 2 | loss: 0.1614302
	speed: 0.0390s/iter; left time: 1801.3157s
	iters: 300, epoch: 2 | loss: 0.1332958
	speed: 0.0374s/iter; left time: 1725.4769s
	iters: 400, epoch: 2 | loss: 0.1869922
	speed: 0.0409s/iter; left time: 1882.0469s
Epoch: 2 cost time: 18.651938915252686
Epoch: 2, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.900511 --> -0.951113).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2825791
	speed: 0.1607s/iter; left time: 7368.6417s
	iters: 200, epoch: 3 | loss: 0.0759615
	speed: 0.0373s/iter; left time: 1705.4642s
	iters: 300, epoch: 3 | loss: 0.0703858
	speed: 0.0396s/iter; left time: 1807.5812s
	iters: 400, epoch: 3 | loss: 0.0393589
	speed: 0.0396s/iter; left time: 1804.5875s
Epoch: 3 cost time: 18.41332721710205
Epoch: 3, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2582468
	speed: 0.1555s/iter; left time: 7057.9696s
	iters: 200, epoch: 4 | loss: 0.0137476
	speed: 0.0387s/iter; left time: 1753.1000s
	iters: 300, epoch: 4 | loss: 0.2155168
	speed: 0.0377s/iter; left time: 1706.0720s
	iters: 400, epoch: 4 | loss: 0.0282074
	speed: 0.0373s/iter; left time: 1683.1558s
Epoch: 4 cost time: 18.17576766014099
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.951113 --> -0.964836).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0180052
	speed: 0.1585s/iter; left time: 7121.6677s
	iters: 200, epoch: 5 | loss: 0.0316491
	speed: 0.0376s/iter; left time: 1686.5645s
	iters: 300, epoch: 5 | loss: 0.4585986
	speed: 0.0394s/iter; left time: 1762.5757s
	iters: 400, epoch: 5 | loss: 0.0025482
	speed: 0.0387s/iter; left time: 1726.1878s
Epoch: 5 cost time: 18.295759201049805
Epoch: 5, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0161846
	speed: 0.1586s/iter; left time: 7049.1415s
	iters: 200, epoch: 6 | loss: 0.1128325
	speed: 0.0386s/iter; left time: 1711.7284s
	iters: 300, epoch: 6 | loss: 0.0960283
	speed: 0.0382s/iter; left time: 1690.4855s
	iters: 400, epoch: 6 | loss: 0.0103542
	speed: 0.0376s/iter; left time: 1658.8656s
Epoch: 6 cost time: 18.334871292114258
Epoch: 6, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.964836 --> -0.974842).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0964055
	speed: 0.1515s/iter; left time: 6663.6359s
	iters: 200, epoch: 7 | loss: 0.0043214
	speed: 0.0362s/iter; left time: 1587.1222s
	iters: 300, epoch: 7 | loss: 0.1904938
	speed: 0.0328s/iter; left time: 1438.2782s
	iters: 400, epoch: 7 | loss: 0.0120622
	speed: 0.0340s/iter; left time: 1484.8377s
Epoch: 7 cost time: 16.511568069458008
Epoch: 7, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0699177
	speed: 0.1233s/iter; left time: 5367.7839s
	iters: 200, epoch: 8 | loss: 0.2163567
	speed: 0.0416s/iter; left time: 1807.9754s
	iters: 300, epoch: 8 | loss: 0.1022248
	speed: 0.0441s/iter; left time: 1910.7178s
	iters: 400, epoch: 8 | loss: 0.0347128
	speed: 0.0413s/iter; left time: 1785.4236s
Epoch: 8 cost time: 19.75704860687256
Epoch: 8, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0584487
	speed: 0.1778s/iter; left time: 7652.3094s
	iters: 200, epoch: 9 | loss: 0.1006968
	speed: 0.0400s/iter; left time: 1718.7608s
	iters: 300, epoch: 9 | loss: 0.0025107
	speed: 0.0384s/iter; left time: 1644.9783s
	iters: 400, epoch: 9 | loss: 0.0371308
	speed: 0.0421s/iter; left time: 1800.9972s
Epoch: 9 cost time: 19.332407474517822
Epoch: 9, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0049105
	speed: 0.1753s/iter; left time: 7464.1944s
	iters: 200, epoch: 10 | loss: 0.0628199
	speed: 0.0429s/iter; left time: 1821.5361s
	iters: 300, epoch: 10 | loss: 0.0466039
	speed: 0.0427s/iter; left time: 1808.9920s
	iters: 400, epoch: 10 | loss: 0.0064739
	speed: 0.0406s/iter; left time: 1715.9717s
Epoch: 10 cost time: 19.89564824104309
Epoch: 10, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0056480
	speed: 0.1552s/iter; left time: 6533.8975s
	iters: 200, epoch: 11 | loss: 0.0051451
	speed: 0.0376s/iter; left time: 1579.9164s
	iters: 300, epoch: 11 | loss: 0.0182361
	speed: 0.0355s/iter; left time: 1488.7185s
	iters: 400, epoch: 11 | loss: 0.0029243
	speed: 0.0386s/iter; left time: 1614.7146s
Epoch: 11 cost time: 18.123579502105713
Epoch: 11, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0696293
	speed: 0.1645s/iter; left time: 6850.3451s
	iters: 200, epoch: 12 | loss: 0.0037680
	speed: 0.0394s/iter; left time: 1636.1108s
	iters: 300, epoch: 12 | loss: 0.0541718
	speed: 0.0395s/iter; left time: 1638.0526s
	iters: 400, epoch: 12 | loss: 0.0243194
	speed: 0.0389s/iter; left time: 1609.7994s
Epoch: 12 cost time: 18.533323526382446
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0054052
	speed: 0.1633s/iter; left time: 6725.1303s
	iters: 200, epoch: 13 | loss: 0.0191130
	speed: 0.0364s/iter; left time: 1493.9294s
	iters: 300, epoch: 13 | loss: 0.0113409
	speed: 0.0365s/iter; left time: 1496.6510s
	iters: 400, epoch: 13 | loss: 0.0094340
	speed: 0.0392s/iter; left time: 1602.1747s
Epoch: 13 cost time: 18.008972883224487
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0486263
	speed: 0.1593s/iter; left time: 6485.2536s
	iters: 200, epoch: 14 | loss: 0.0039858
	speed: 0.0404s/iter; left time: 1641.3957s
	iters: 300, epoch: 14 | loss: 0.0128990
	speed: 0.0392s/iter; left time: 1589.4263s
	iters: 400, epoch: 14 | loss: 0.0136668
	speed: 0.0374s/iter; left time: 1509.7367s
Epoch: 14 cost time: 18.626237869262695
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1848346
	speed: 0.1596s/iter; left time: 6420.9722s
	iters: 200, epoch: 15 | loss: 0.0158221
	speed: 0.0396s/iter; left time: 1590.9885s
	iters: 300, epoch: 15 | loss: 0.0384379
	speed: 0.0392s/iter; left time: 1569.2840s
	iters: 400, epoch: 15 | loss: 0.1138736
	speed: 0.0390s/iter; left time: 1559.3988s
Epoch: 15 cost time: 18.562304973602295
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0033403
	speed: 0.1632s/iter; left time: 6489.2316s
	iters: 200, epoch: 16 | loss: 0.1867411
	speed: 0.0366s/iter; left time: 1452.9636s
	iters: 300, epoch: 16 | loss: 0.0025582
	speed: 0.0369s/iter; left time: 1461.9108s
	iters: 400, epoch: 16 | loss: 0.0024823
	speed: 0.0382s/iter; left time: 1508.8744s
Epoch: 16 cost time: 18.024078607559204
Epoch: 16, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 421838
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4603324
	speed: 0.0465s/iter; left time: 2177.7664s
	iters: 200, epoch: 1 | loss: 0.7498990
	speed: 0.0356s/iter; left time: 1664.6741s
	iters: 300, epoch: 1 | loss: 0.4312656
	speed: 0.0395s/iter; left time: 1841.8792s
	iters: 400, epoch: 1 | loss: 0.3074739
	speed: 0.0406s/iter; left time: 1888.9982s
Epoch: 1 cost time: 19.017096281051636
Epoch: 1, Steps: 469 | Train Loss: 0.896 Vali Loss: 0.409 Vali Acc: 0.876 Test Loss: 0.409 Test Acc: 0.876
Validation loss decreased (inf --> -0.875925).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3281001
	speed: 0.1777s/iter; left time: 8231.6307s
	iters: 200, epoch: 2 | loss: 0.0664779
	speed: 0.0390s/iter; left time: 1803.6542s
	iters: 300, epoch: 2 | loss: 0.4560345
	speed: 0.0384s/iter; left time: 1773.5796s
	iters: 400, epoch: 2 | loss: 0.1479633
	speed: 0.0393s/iter; left time: 1807.6926s
Epoch: 2 cost time: 18.682395219802856
Epoch: 2, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.875925 --> -0.943966).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1806304
	speed: 0.1707s/iter; left time: 7826.9822s
	iters: 200, epoch: 3 | loss: 0.0700810
	speed: 0.0418s/iter; left time: 1911.2102s
	iters: 300, epoch: 3 | loss: 0.1505588
	speed: 0.0413s/iter; left time: 1886.4328s
	iters: 400, epoch: 3 | loss: 0.0260923
	speed: 0.0381s/iter; left time: 1737.5381s
Epoch: 3 cost time: 19.24487328529358
Epoch: 3, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.270 Vali Acc: 0.924 Test Loss: 0.270 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3237162
	speed: 0.1578s/iter; left time: 7161.6281s
	iters: 200, epoch: 4 | loss: 0.0114120
	speed: 0.0329s/iter; left time: 1489.5327s
	iters: 300, epoch: 4 | loss: 0.0077517
	speed: 0.0303s/iter; left time: 1367.8977s
	iters: 400, epoch: 4 | loss: 0.0241998
	speed: 0.0282s/iter; left time: 1272.7345s
Epoch: 4 cost time: 14.867793321609497
Epoch: 4, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.943966 --> -0.963692).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1399443
	speed: 0.1417s/iter; left time: 6366.7198s
	iters: 200, epoch: 5 | loss: 0.0704167
	speed: 0.0368s/iter; left time: 1650.2705s
	iters: 300, epoch: 5 | loss: 0.0294105
	speed: 0.0379s/iter; left time: 1694.6068s
	iters: 400, epoch: 5 | loss: 0.0043204
	speed: 0.0373s/iter; left time: 1664.6848s
Epoch: 5 cost time: 17.794936895370483
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0138192
	speed: 0.1533s/iter; left time: 6817.0618s
	iters: 200, epoch: 6 | loss: 0.0252072
	speed: 0.0375s/iter; left time: 1662.2490s
	iters: 300, epoch: 6 | loss: 0.0184248
	speed: 0.0369s/iter; left time: 1630.8560s
	iters: 400, epoch: 6 | loss: 0.1311441
	speed: 0.0394s/iter; left time: 1741.1703s
Epoch: 6 cost time: 17.47788143157959
Epoch: 6, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0292111
	speed: 0.1419s/iter; left time: 6240.6639s
	iters: 200, epoch: 7 | loss: 0.0579501
	speed: 0.0377s/iter; left time: 1652.4964s
	iters: 300, epoch: 7 | loss: 0.0176082
	speed: 0.0366s/iter; left time: 1602.7910s
	iters: 400, epoch: 7 | loss: 0.0349342
	speed: 0.0354s/iter; left time: 1546.1590s
Epoch: 7 cost time: 17.610048294067383
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0149929
	speed: 0.1601s/iter; left time: 6967.1174s
	iters: 200, epoch: 8 | loss: 0.0087535
	speed: 0.0384s/iter; left time: 1666.9016s
	iters: 300, epoch: 8 | loss: 0.0133373
	speed: 0.0388s/iter; left time: 1682.3214s
	iters: 400, epoch: 8 | loss: 0.0999761
	speed: 0.0370s/iter; left time: 1600.1253s
Epoch: 8 cost time: 17.709600925445557
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0032414
	speed: 0.1602s/iter; left time: 6894.3284s
	iters: 200, epoch: 9 | loss: 0.0077745
	speed: 0.0356s/iter; left time: 1528.9885s
	iters: 300, epoch: 9 | loss: 0.0091107
	speed: 0.0365s/iter; left time: 1564.6016s
	iters: 400, epoch: 9 | loss: 0.0124137
	speed: 0.0377s/iter; left time: 1612.0875s
Epoch: 9 cost time: 17.550299167633057
Epoch: 9, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0054616
	speed: 0.1510s/iter; left time: 6428.3811s
	iters: 200, epoch: 10 | loss: 0.0064594
	speed: 0.0369s/iter; left time: 1566.2914s
	iters: 300, epoch: 10 | loss: 0.0570767
	speed: 0.0378s/iter; left time: 1600.3536s
	iters: 400, epoch: 10 | loss: 0.0212222
	speed: 0.0356s/iter; left time: 1506.3728s
Epoch: 10 cost time: 17.587594270706177
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.963692 --> -0.970553).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0221201
	speed: 0.1560s/iter; left time: 6570.2472s
	iters: 200, epoch: 11 | loss: 0.0070671
	speed: 0.0391s/iter; left time: 1641.7160s
	iters: 300, epoch: 11 | loss: 0.0041399
	speed: 0.0383s/iter; left time: 1603.2602s
	iters: 400, epoch: 11 | loss: 0.0153202
	speed: 0.0388s/iter; left time: 1620.8674s
Epoch: 11 cost time: 18.6046142578125
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2285868
	speed: 0.1716s/iter; left time: 7145.2435s
	iters: 200, epoch: 12 | loss: 0.0201322
	speed: 0.0414s/iter; left time: 1721.1353s
	iters: 300, epoch: 12 | loss: 0.0120671
	speed: 0.0405s/iter; left time: 1677.6283s
	iters: 400, epoch: 12 | loss: 0.0216049
	speed: 0.0418s/iter; left time: 1727.5857s
Epoch: 12 cost time: 19.51403021812439
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0065916
	speed: 0.1692s/iter; left time: 6965.4466s
	iters: 200, epoch: 13 | loss: 0.0130418
	speed: 0.0392s/iter; left time: 1610.8581s
	iters: 300, epoch: 13 | loss: 0.0042504
	speed: 0.0382s/iter; left time: 1564.8963s
	iters: 400, epoch: 13 | loss: 0.0042590
	speed: 0.0409s/iter; left time: 1670.0493s
Epoch: 13 cost time: 18.83845281600952
Epoch: 13, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970553 --> -0.972555).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0130186
	speed: 0.1567s/iter; left time: 6379.0821s
	iters: 200, epoch: 14 | loss: 0.0444108
	speed: 0.0398s/iter; left time: 1615.8942s
	iters: 300, epoch: 14 | loss: 0.2300797
	speed: 0.0378s/iter; left time: 1529.0978s
	iters: 400, epoch: 14 | loss: 0.0031982
	speed: 0.0361s/iter; left time: 1458.0922s
Epoch: 14 cost time: 17.880149364471436
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.972555 --> -0.974556).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0103465
	speed: 0.1509s/iter; left time: 6071.5428s
	iters: 200, epoch: 15 | loss: 0.0009726
	speed: 0.0361s/iter; left time: 1448.2268s
	iters: 300, epoch: 15 | loss: 0.0085924
	speed: 0.0359s/iter; left time: 1435.3912s
	iters: 400, epoch: 15 | loss: 0.0016714
	speed: 0.0370s/iter; left time: 1479.4975s
Epoch: 15 cost time: 17.574756860733032
Epoch: 15, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975699).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0170372
	speed: 0.1576s/iter; left time: 6268.4898s
	iters: 200, epoch: 16 | loss: 0.0161809
	speed: 0.0389s/iter; left time: 1543.8992s
	iters: 300, epoch: 16 | loss: 0.0022780
	speed: 0.0395s/iter; left time: 1564.1274s
	iters: 400, epoch: 16 | loss: 0.0007935
	speed: 0.0356s/iter; left time: 1403.8849s
Epoch: 16 cost time: 17.661378145217896
Epoch: 16, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2119049
	speed: 0.1415s/iter; left time: 5558.7357s
	iters: 200, epoch: 17 | loss: 0.0198138
	speed: 0.0363s/iter; left time: 1423.7462s
	iters: 300, epoch: 17 | loss: 0.0255907
	speed: 0.0369s/iter; left time: 1441.9511s
	iters: 400, epoch: 17 | loss: 0.1833489
	speed: 0.0379s/iter; left time: 1479.3937s
Epoch: 17 cost time: 17.900636196136475
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.978844).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0184017
	speed: 0.1564s/iter; left time: 6073.7402s
	iters: 200, epoch: 18 | loss: 0.0081510
	speed: 0.0342s/iter; left time: 1326.2692s
	iters: 300, epoch: 18 | loss: 0.0047787
	speed: 0.0405s/iter; left time: 1562.9919s
	iters: 400, epoch: 18 | loss: 0.0204512
	speed: 0.0355s/iter; left time: 1369.0991s
Epoch: 18 cost time: 17.46710729598999
Epoch: 18, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.947 Test Loss: 0.245 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0034841
	speed: 0.1544s/iter; left time: 5920.7319s
	iters: 200, epoch: 19 | loss: 0.0016240
	speed: 0.0366s/iter; left time: 1399.0663s
	iters: 300, epoch: 19 | loss: 0.0017740
	speed: 0.0358s/iter; left time: 1366.5069s
	iters: 400, epoch: 19 | loss: 0.0057725
	speed: 0.0383s/iter; left time: 1456.8507s
Epoch: 19 cost time: 17.753456115722656
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0005599
	speed: 0.1528s/iter; left time: 5788.1665s
	iters: 200, epoch: 20 | loss: 0.0037817
	speed: 0.0374s/iter; left time: 1415.1546s
	iters: 300, epoch: 20 | loss: 0.0026172
	speed: 0.0372s/iter; left time: 1402.1096s
	iters: 400, epoch: 20 | loss: 0.0077043
	speed: 0.0375s/iter; left time: 1409.5070s
Epoch: 20 cost time: 17.88729429244995
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0011077
	speed: 0.1643s/iter; left time: 6149.4701s
	iters: 200, epoch: 21 | loss: 0.0038267
	speed: 0.0368s/iter; left time: 1372.3940s
	iters: 300, epoch: 21 | loss: 0.0019743
	speed: 0.0408s/iter; left time: 1517.2851s
	iters: 400, epoch: 21 | loss: 0.0082824
	speed: 0.0415s/iter; left time: 1541.3687s
Epoch: 21 cost time: 18.55026912689209
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.959 Test Loss: 0.233 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0193735
	speed: 0.1659s/iter; left time: 6129.3459s
	iters: 200, epoch: 22 | loss: 0.0073995
	speed: 0.0414s/iter; left time: 1524.3446s
	iters: 300, epoch: 22 | loss: 0.0020174
	speed: 0.0389s/iter; left time: 1429.2523s
	iters: 400, epoch: 22 | loss: 0.0044040
	speed: 0.0372s/iter; left time: 1364.5402s
Epoch: 22 cost time: 18.667595863342285
Epoch: 22, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0047195
	speed: 0.1726s/iter; left time: 6298.5013s
	iters: 200, epoch: 23 | loss: 0.0042825
	speed: 0.0379s/iter; left time: 1377.4135s
	iters: 300, epoch: 23 | loss: 0.0036408
	speed: 0.0416s/iter; left time: 1511.1099s
	iters: 400, epoch: 23 | loss: 0.0007816
	speed: 0.0413s/iter; left time: 1494.3463s
Epoch: 23 cost time: 19.13768196105957
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0123888
	speed: 0.1562s/iter; left time: 5625.9417s
	iters: 200, epoch: 24 | loss: 0.0169518
	speed: 0.0391s/iter; left time: 1403.9448s
	iters: 300, epoch: 24 | loss: 0.0207934
	speed: 0.0364s/iter; left time: 1303.5005s
	iters: 400, epoch: 24 | loss: 0.0280982
	speed: 0.0374s/iter; left time: 1337.0738s
Epoch: 24 cost time: 17.893373250961304
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1967396
	speed: 0.1586s/iter; left time: 5638.8045s
	iters: 200, epoch: 25 | loss: 0.0024756
	speed: 0.0385s/iter; left time: 1364.6696s
	iters: 300, epoch: 25 | loss: 0.4934028
	speed: 0.0406s/iter; left time: 1435.4748s
	iters: 400, epoch: 25 | loss: 0.0007597
	speed: 0.0382s/iter; left time: 1347.8574s
Epoch: 25 cost time: 18.189570426940918
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0037043
	speed: 0.1511s/iter; left time: 5300.2569s
	iters: 200, epoch: 26 | loss: 0.0005556
	speed: 0.0381s/iter; left time: 1332.6281s
	iters: 300, epoch: 26 | loss: 0.0004083
	speed: 0.0369s/iter; left time: 1286.1450s
	iters: 400, epoch: 26 | loss: 0.1847424
	speed: 0.0357s/iter; left time: 1242.5462s
Epoch: 26 cost time: 17.756725549697876
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0300913
	speed: 0.1528s/iter; left time: 5289.1898s
	iters: 200, epoch: 27 | loss: 0.0026393
	speed: 0.0362s/iter; left time: 1247.8468s
	iters: 300, epoch: 27 | loss: 0.0136105
	speed: 0.0371s/iter; left time: 1275.5796s
	iters: 400, epoch: 27 | loss: 0.0911105
	speed: 0.0394s/iter; left time: 1350.8070s
Epoch: 27 cost time: 17.47768545150757
Epoch: 27, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 421774
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5194185
	speed: 0.0507s/iter; left time: 2373.8652s
	iters: 200, epoch: 1 | loss: 0.5708717
	speed: 0.0431s/iter; left time: 2011.8316s
	iters: 300, epoch: 1 | loss: 0.8298319
	speed: 0.0373s/iter; left time: 1737.2707s
	iters: 400, epoch: 1 | loss: 0.3537238
	speed: 0.0381s/iter; left time: 1770.1073s
Epoch: 1 cost time: 19.363399267196655
Epoch: 1, Steps: 469 | Train Loss: 0.906 Vali Loss: 0.361 Vali Acc: 0.897 Test Loss: 0.361 Test Acc: 0.897
Validation loss decreased (inf --> -0.896795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3505054
	speed: 0.1554s/iter; left time: 7201.0854s
	iters: 200, epoch: 2 | loss: 0.1887696
	speed: 0.0375s/iter; left time: 1731.4029s
	iters: 300, epoch: 2 | loss: 0.2625684
	speed: 0.0388s/iter; left time: 1789.1395s
	iters: 400, epoch: 2 | loss: 0.0636603
	speed: 0.0361s/iter; left time: 1663.5967s
Epoch: 2 cost time: 17.826452493667603
Epoch: 2, Steps: 469 | Train Loss: 0.216 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
Validation loss decreased (-0.896795 --> -0.927671).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0473207
	speed: 0.1542s/iter; left time: 7071.6114s
	iters: 200, epoch: 3 | loss: 0.1340940
	speed: 0.0387s/iter; left time: 1771.3273s
	iters: 300, epoch: 3 | loss: 0.0426810
	speed: 0.0369s/iter; left time: 1683.1680s
	iters: 400, epoch: 3 | loss: 0.1177082
	speed: 0.0370s/iter; left time: 1688.0505s
Epoch: 3 cost time: 17.939409971237183
Epoch: 3, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
Validation loss decreased (-0.927671 --> -0.955401).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0920043
	speed: 0.1711s/iter; left time: 7765.9798s
	iters: 200, epoch: 4 | loss: 0.0151859
	speed: 0.0405s/iter; left time: 1833.7724s
	iters: 300, epoch: 4 | loss: 0.1112086
	speed: 0.0415s/iter; left time: 1873.5848s
	iters: 400, epoch: 4 | loss: 0.0298186
	speed: 0.0400s/iter; left time: 1804.9896s
Epoch: 4 cost time: 19.59828758239746
Epoch: 4, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0303796
	speed: 0.1670s/iter; left time: 7503.2732s
	iters: 200, epoch: 5 | loss: 0.0428154
	speed: 0.0408s/iter; left time: 1827.6604s
	iters: 300, epoch: 5 | loss: 0.0102547
	speed: 0.0417s/iter; left time: 1865.2655s
	iters: 400, epoch: 5 | loss: 0.0138099
	speed: 0.0398s/iter; left time: 1774.6421s
Epoch: 5 cost time: 19.0155189037323
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.955401 --> -0.963406).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0222173
	speed: 0.1742s/iter; left time: 7742.7298s
	iters: 200, epoch: 6 | loss: 0.0050470
	speed: 0.0393s/iter; left time: 1742.4124s
	iters: 300, epoch: 6 | loss: 0.0394499
	speed: 0.0388s/iter; left time: 1716.3837s
	iters: 400, epoch: 6 | loss: 0.0069611
	speed: 0.0398s/iter; left time: 1757.1402s
Epoch: 6 cost time: 18.707101106643677
Epoch: 6, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0084768
	speed: 0.1521s/iter; left time: 6689.7595s
	iters: 200, epoch: 7 | loss: 0.0249545
	speed: 0.0393s/iter; left time: 1726.4506s
	iters: 300, epoch: 7 | loss: 0.0399063
	speed: 0.0373s/iter; left time: 1633.1209s
	iters: 400, epoch: 7 | loss: 0.1602053
	speed: 0.0380s/iter; left time: 1661.3471s
Epoch: 7 cost time: 18.083452939987183
Epoch: 7, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0137332
	speed: 0.1265s/iter; left time: 5506.0729s
	iters: 200, epoch: 8 | loss: 0.0034937
	speed: 0.0305s/iter; left time: 1322.1530s
	iters: 300, epoch: 8 | loss: 0.1131321
	speed: 0.0315s/iter; left time: 1365.4232s
	iters: 400, epoch: 8 | loss: 0.0704327
	speed: 0.0323s/iter; left time: 1395.9502s
Epoch: 8 cost time: 15.969414472579956
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0026147
	speed: 0.1593s/iter; left time: 6858.3045s
	iters: 200, epoch: 9 | loss: 0.0100195
	speed: 0.0383s/iter; left time: 1644.7258s
	iters: 300, epoch: 9 | loss: 0.0024984
	speed: 0.0387s/iter; left time: 1657.1699s
	iters: 400, epoch: 9 | loss: 0.0295471
	speed: 0.0366s/iter; left time: 1563.6682s
Epoch: 9 cost time: 17.931318521499634
Epoch: 9, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.963406 --> -0.967980).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0090721
	speed: 0.1515s/iter; left time: 6452.3209s
	iters: 200, epoch: 10 | loss: 0.0265606
	speed: 0.0379s/iter; left time: 1608.2711s
	iters: 300, epoch: 10 | loss: 0.0044588
	speed: 0.0358s/iter; left time: 1516.7418s
	iters: 400, epoch: 10 | loss: 0.0086896
	speed: 0.0372s/iter; left time: 1572.1762s
Epoch: 10 cost time: 17.637224197387695
Epoch: 10, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0345608
	speed: 0.1524s/iter; left time: 6416.7814s
	iters: 200, epoch: 11 | loss: 0.0631103
	speed: 0.0386s/iter; left time: 1620.6715s
	iters: 300, epoch: 11 | loss: 0.0056202
	speed: 0.0364s/iter; left time: 1523.9366s
	iters: 400, epoch: 11 | loss: 0.0062547
	speed: 0.0385s/iter; left time: 1611.7189s
Epoch: 11 cost time: 17.634623765945435
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0063636
	speed: 0.1470s/iter; left time: 6121.3156s
	iters: 200, epoch: 12 | loss: 0.0125540
	speed: 0.0348s/iter; left time: 1445.8355s
	iters: 300, epoch: 12 | loss: 0.0775182
	speed: 0.0379s/iter; left time: 1571.1712s
	iters: 400, epoch: 12 | loss: 0.0037845
	speed: 0.0337s/iter; left time: 1392.1561s
Epoch: 12 cost time: 17.62485980987549
Epoch: 12, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.967980 --> -0.969696).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0015751
	speed: 0.1603s/iter; left time: 6599.4033s
	iters: 200, epoch: 13 | loss: 0.0414942
	speed: 0.0412s/iter; left time: 1692.5574s
	iters: 300, epoch: 13 | loss: 0.0113285
	speed: 0.0405s/iter; left time: 1660.9642s
	iters: 400, epoch: 13 | loss: 0.0030719
	speed: 0.0379s/iter; left time: 1549.1258s
Epoch: 13 cost time: 19.03033423423767
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4862606
	speed: 0.1653s/iter; left time: 6726.4036s
	iters: 200, epoch: 14 | loss: 0.2759622
	speed: 0.0406s/iter; left time: 1648.9667s
	iters: 300, epoch: 14 | loss: 0.0036888
	speed: 0.0394s/iter; left time: 1595.7458s
	iters: 400, epoch: 14 | loss: 0.3599353
	speed: 0.0400s/iter; left time: 1614.1593s
Epoch: 14 cost time: 19.163989067077637
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.972269).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2043305
	speed: 0.1794s/iter; left time: 7216.8451s
	iters: 200, epoch: 15 | loss: 0.0032641
	speed: 0.0403s/iter; left time: 1615.4958s
	iters: 300, epoch: 15 | loss: 0.0015235
	speed: 0.0413s/iter; left time: 1652.7314s
	iters: 400, epoch: 15 | loss: 0.0105069
	speed: 0.0416s/iter; left time: 1660.7083s
Epoch: 15 cost time: 19.473058223724365
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0088734
	speed: 0.1574s/iter; left time: 6258.9330s
	iters: 200, epoch: 16 | loss: 0.0206610
	speed: 0.0397s/iter; left time: 1572.7590s
	iters: 300, epoch: 16 | loss: 0.0010164
	speed: 0.0387s/iter; left time: 1530.2375s
	iters: 400, epoch: 16 | loss: 0.0007910
	speed: 0.0398s/iter; left time: 1571.7106s
Epoch: 16 cost time: 18.615779161453247
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0080494
	speed: 0.1587s/iter; left time: 6235.4436s
	iters: 200, epoch: 17 | loss: 0.0026355
	speed: 0.0397s/iter; left time: 1554.3887s
	iters: 300, epoch: 17 | loss: 0.0028989
	speed: 0.0378s/iter; left time: 1476.3748s
	iters: 400, epoch: 17 | loss: 0.0103607
	speed: 0.0376s/iter; left time: 1466.8285s
Epoch: 17 cost time: 18.044793844223022
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0074630
	speed: 0.1601s/iter; left time: 6215.8302s
	iters: 200, epoch: 18 | loss: 0.2152487
	speed: 0.0375s/iter; left time: 1451.5934s
	iters: 300, epoch: 18 | loss: 0.0026535
	speed: 0.0394s/iter; left time: 1521.6481s
	iters: 400, epoch: 18 | loss: 0.0200271
	speed: 0.0380s/iter; left time: 1462.6959s
Epoch: 18 cost time: 17.950619220733643
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0039605
	speed: 0.1527s/iter; left time: 5856.6885s
	iters: 200, epoch: 19 | loss: 0.0009388
	speed: 0.0383s/iter; left time: 1465.1671s
	iters: 300, epoch: 19 | loss: 0.0010648
	speed: 0.0358s/iter; left time: 1366.3550s
	iters: 400, epoch: 19 | loss: 0.0250225
	speed: 0.0369s/iter; left time: 1405.8583s
Epoch: 19 cost time: 17.936927318572998
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.972269 --> -0.977129).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0042513
	speed: 0.1625s/iter; left time: 6156.3801s
	iters: 200, epoch: 20 | loss: 0.0045969
	speed: 0.0352s/iter; left time: 1329.8170s
	iters: 300, epoch: 20 | loss: 0.2488329
	speed: 0.0302s/iter; left time: 1138.1540s
	iters: 400, epoch: 20 | loss: 0.0078753
	speed: 0.0306s/iter; left time: 1151.4678s
Epoch: 20 cost time: 15.840211153030396
Epoch: 20, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0003360
	speed: 0.1052s/iter; left time: 3938.1779s
	iters: 200, epoch: 21 | loss: 0.0028481
	speed: 0.0393s/iter; left time: 1465.1965s
	iters: 300, epoch: 21 | loss: 0.0015176
	speed: 0.0360s/iter; left time: 1339.8458s
	iters: 400, epoch: 21 | loss: 0.0008354
	speed: 0.0372s/iter; left time: 1380.0603s
Epoch: 21 cost time: 17.48795485496521
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977415).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0044294
	speed: 0.1620s/iter; left time: 5986.3898s
	iters: 200, epoch: 22 | loss: 0.0019462
	speed: 0.0345s/iter; left time: 1272.3551s
	iters: 300, epoch: 22 | loss: 0.0046314
	speed: 0.0364s/iter; left time: 1339.1477s
	iters: 400, epoch: 22 | loss: 0.0931627
	speed: 0.0375s/iter; left time: 1372.7468s
Epoch: 22 cost time: 17.644375324249268
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003382
	speed: 0.1709s/iter; left time: 6235.0780s
	iters: 200, epoch: 23 | loss: 0.1475422
	speed: 0.0389s/iter; left time: 1415.8357s
	iters: 300, epoch: 23 | loss: 0.0205362
	speed: 0.0408s/iter; left time: 1479.6720s
	iters: 400, epoch: 23 | loss: 0.0055611
	speed: 0.0410s/iter; left time: 1482.7878s
Epoch: 23 cost time: 19.339245796203613
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0007018
	speed: 0.1768s/iter; left time: 6368.2002s
	iters: 200, epoch: 24 | loss: 0.0008278
	speed: 0.0413s/iter; left time: 1485.0281s
	iters: 300, epoch: 24 | loss: 0.0008707
	speed: 0.0418s/iter; left time: 1497.0004s
	iters: 400, epoch: 24 | loss: 0.0030030
	speed: 0.0394s/iter; left time: 1408.8053s
Epoch: 24 cost time: 19.156572341918945
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0006145
	speed: 0.1586s/iter; left time: 5638.5238s
	iters: 200, epoch: 25 | loss: 0.0022009
	speed: 0.0376s/iter; left time: 1332.6394s
	iters: 300, epoch: 25 | loss: 0.0013666
	speed: 0.0368s/iter; left time: 1300.7945s
	iters: 400, epoch: 25 | loss: 0.0223655
	speed: 0.0366s/iter; left time: 1290.6184s
Epoch: 25 cost time: 17.913979053497314
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0010004
	speed: 0.1610s/iter; left time: 5646.4934s
	iters: 200, epoch: 26 | loss: 0.0015727
	speed: 0.0407s/iter; left time: 1424.7681s
	iters: 300, epoch: 26 | loss: 0.5959008
	speed: 0.0392s/iter; left time: 1366.7593s
	iters: 400, epoch: 26 | loss: 0.0013683
	speed: 0.0392s/iter; left time: 1362.5363s
Epoch: 26 cost time: 18.881661891937256
Epoch: 26, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0009361
	speed: 0.1581s/iter; left time: 5472.2451s
	iters: 200, epoch: 27 | loss: 0.0092284
	speed: 0.0367s/iter; left time: 1266.4608s
	iters: 300, epoch: 27 | loss: 0.0181109
	speed: 0.0405s/iter; left time: 1394.3975s
	iters: 400, epoch: 27 | loss: 0.0100942
	speed: 0.0374s/iter; left time: 1282.7105s
Epoch: 27 cost time: 18.146751642227173
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0066844
	speed: 0.1603s/iter; left time: 5472.2902s
	iters: 200, epoch: 28 | loss: 0.0050257
	speed: 0.0388s/iter; left time: 1320.6485s
	iters: 300, epoch: 28 | loss: 0.0006013
	speed: 0.0377s/iter; left time: 1279.9045s
	iters: 400, epoch: 28 | loss: 0.3290809
	speed: 0.0380s/iter; left time: 1285.8354s
Epoch: 28 cost time: 18.20952081680298
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0059756
	speed: 0.1574s/iter; left time: 5298.2268s
	iters: 200, epoch: 29 | loss: 0.0008490
	speed: 0.0379s/iter; left time: 1270.6627s
	iters: 300, epoch: 29 | loss: 0.0003595
	speed: 0.0380s/iter; left time: 1271.3003s
	iters: 400, epoch: 29 | loss: 0.0004001
	speed: 0.0380s/iter; left time: 1267.2208s
Epoch: 29 cost time: 18.281673669815063
Epoch: 29, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.979416).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0013910
	speed: 0.1587s/iter; left time: 5267.5409s
	iters: 200, epoch: 30 | loss: 0.0001332
	speed: 0.0378s/iter; left time: 1252.8332s
	iters: 300, epoch: 30 | loss: 0.0009239
	speed: 0.0381s/iter; left time: 1258.8300s
	iters: 400, epoch: 30 | loss: 0.0009067
	speed: 0.0374s/iter; left time: 1229.1281s
Epoch: 30 cost time: 17.857808828353882
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0006738
	speed: 0.1606s/iter; left time: 5256.4504s
	iters: 200, epoch: 31 | loss: 0.0496763
	speed: 0.0378s/iter; left time: 1232.6326s
	iters: 300, epoch: 31 | loss: 0.0042015
	speed: 0.0386s/iter; left time: 1255.4512s
	iters: 400, epoch: 31 | loss: 0.0005873
	speed: 0.0385s/iter; left time: 1248.3285s
Epoch: 31 cost time: 18.058917760849
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0020798
	speed: 0.1538s/iter; left time: 4962.9776s
	iters: 200, epoch: 32 | loss: 0.0035924
	speed: 0.0368s/iter; left time: 1183.4390s
	iters: 300, epoch: 32 | loss: 0.2221122
	speed: 0.0407s/iter; left time: 1306.4373s
	iters: 400, epoch: 32 | loss: 0.0135386
	speed: 0.0413s/iter; left time: 1320.6935s
Epoch: 32 cost time: 19.119755506515503
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0018826
	speed: 0.1807s/iter; left time: 5745.3498s
	iters: 200, epoch: 33 | loss: 0.0010212
	speed: 0.0408s/iter; left time: 1291.6806s
	iters: 300, epoch: 33 | loss: 0.0018667
	speed: 0.0395s/iter; left time: 1246.4978s
	iters: 400, epoch: 33 | loss: 0.0019856
	speed: 0.0384s/iter; left time: 1210.7408s
Epoch: 33 cost time: 18.99613881111145
Epoch: 33, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0247472
	speed: 0.1734s/iter; left time: 5433.0826s
	iters: 200, epoch: 34 | loss: 0.0122490
	speed: 0.0385s/iter; left time: 1202.0299s
	iters: 300, epoch: 34 | loss: 0.1604157
	speed: 0.0416s/iter; left time: 1293.5090s
	iters: 400, epoch: 34 | loss: 0.0117619
	speed: 0.0416s/iter; left time: 1291.4921s
Epoch: 34 cost time: 19.138298749923706
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0004130
	speed: 0.1686s/iter; left time: 5201.4139s
	iters: 200, epoch: 35 | loss: 0.0004243
	speed: 0.0374s/iter; left time: 1149.2660s
	iters: 300, epoch: 35 | loss: 0.0058229
	speed: 0.0371s/iter; left time: 1137.4207s
	iters: 400, epoch: 35 | loss: 0.0004415
	speed: 0.0371s/iter; left time: 1132.3309s
Epoch: 35 cost time: 17.972577333450317
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0118398
	speed: 0.1507s/iter; left time: 4579.3381s
	iters: 200, epoch: 36 | loss: 0.0011538
	speed: 0.0389s/iter; left time: 1178.2670s
	iters: 300, epoch: 36 | loss: 0.0004455
	speed: 0.0369s/iter; left time: 1113.1969s
	iters: 400, epoch: 36 | loss: 0.0011535
	speed: 0.0374s/iter; left time: 1125.9190s
Epoch: 36 cost time: 18.03989577293396
Epoch: 36, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0043059
	speed: 0.1583s/iter; left time: 4735.7372s
	iters: 200, epoch: 37 | loss: 0.0453236
	speed: 0.0378s/iter; left time: 1128.3583s
	iters: 300, epoch: 37 | loss: 0.0037446
	speed: 0.0389s/iter; left time: 1155.6243s
	iters: 400, epoch: 37 | loss: 0.0002508
	speed: 0.0379s/iter; left time: 1123.5859s
Epoch: 37 cost time: 17.83151388168335
Epoch: 37, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000980
	speed: 0.1511s/iter; left time: 4448.7258s
	iters: 200, epoch: 38 | loss: 0.0643560
	speed: 0.0385s/iter; left time: 1130.8206s
	iters: 300, epoch: 38 | loss: 0.0012620
	speed: 0.0371s/iter; left time: 1085.7986s
	iters: 400, epoch: 38 | loss: 0.0038793
	speed: 0.0364s/iter; left time: 1062.2865s
Epoch: 38 cost time: 17.99784207344055
Epoch: 38, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0025895
	speed: 0.1549s/iter; left time: 4489.4704s
	iters: 200, epoch: 39 | loss: 0.0013967
	speed: 0.0376s/iter; left time: 1086.9160s
	iters: 300, epoch: 39 | loss: 0.0006580
	speed: 0.0385s/iter; left time: 1109.0785s
	iters: 400, epoch: 39 | loss: 0.0001150
	speed: 0.0361s/iter; left time: 1035.2715s
Epoch: 39 cost time: 17.748026132583618
Epoch: 39, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 255566
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5610912
	speed: 0.0494s/iter; left time: 2312.2511s
	iters: 200, epoch: 1 | loss: 0.6016616
	speed: 0.0400s/iter; left time: 1867.8763s
	iters: 300, epoch: 1 | loss: 0.9479708
	speed: 0.0371s/iter; left time: 1730.7958s
	iters: 400, epoch: 1 | loss: 0.3551746
	speed: 0.0381s/iter; left time: 1773.2887s
Epoch: 1 cost time: 19.031124114990234
Epoch: 1, Steps: 469 | Train Loss: 0.938 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
Validation loss decreased (inf --> -0.862489).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2096370
	speed: 0.1624s/iter; left time: 7523.0356s
	iters: 200, epoch: 2 | loss: 0.3517601
	speed: 0.0366s/iter; left time: 1692.1667s
	iters: 300, epoch: 2 | loss: 0.4401337
	speed: 0.0412s/iter; left time: 1902.1178s
	iters: 400, epoch: 2 | loss: 0.2244597
	speed: 0.0422s/iter; left time: 1942.2443s
Epoch: 2 cost time: 19.00222682952881
Epoch: 2, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.862489 --> -0.942822).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0901009
	speed: 0.1591s/iter; left time: 7297.7751s
	iters: 200, epoch: 3 | loss: 0.4387035
	speed: 0.0428s/iter; left time: 1959.3743s
	iters: 300, epoch: 3 | loss: 0.1525978
	speed: 0.0399s/iter; left time: 1823.4832s
	iters: 400, epoch: 3 | loss: 0.0262139
	speed: 0.0400s/iter; left time: 1820.4273s
Epoch: 3 cost time: 19.013628721237183
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
Validation loss decreased (-0.942822 --> -0.953686).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0417916
	speed: 0.1756s/iter; left time: 7971.1482s
	iters: 200, epoch: 4 | loss: 0.0722126
	speed: 0.0378s/iter; left time: 1713.7754s
	iters: 300, epoch: 4 | loss: 0.1709077
	speed: 0.0404s/iter; left time: 1828.0300s
	iters: 400, epoch: 4 | loss: 0.4362645
	speed: 0.0402s/iter; left time: 1813.2257s
Epoch: 4 cost time: 18.595439672470093
Epoch: 4, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0109081
	speed: 0.1373s/iter; left time: 6168.8032s
	iters: 200, epoch: 5 | loss: 0.1619104
	speed: 0.0378s/iter; left time: 1692.5761s
	iters: 300, epoch: 5 | loss: 0.1152688
	speed: 0.0361s/iter; left time: 1614.8866s
	iters: 400, epoch: 5 | loss: 0.0044257
	speed: 0.0354s/iter; left time: 1578.7409s
Epoch: 5 cost time: 17.275864362716675
Epoch: 5, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.306 Vali Acc: 0.912 Test Loss: 0.306 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0206839
	speed: 0.1607s/iter; left time: 7143.3610s
	iters: 200, epoch: 6 | loss: 0.0127445
	speed: 0.0347s/iter; left time: 1540.5178s
	iters: 300, epoch: 6 | loss: 0.2626217
	speed: 0.0390s/iter; left time: 1725.2189s
	iters: 400, epoch: 6 | loss: 0.0118145
	speed: 0.0376s/iter; left time: 1661.1155s
Epoch: 6 cost time: 17.733552932739258
Epoch: 6, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.953686 --> -0.963692).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0807604
	speed: 0.1549s/iter; left time: 6814.6677s
	iters: 200, epoch: 7 | loss: 0.0310561
	speed: 0.0349s/iter; left time: 1530.9671s
	iters: 300, epoch: 7 | loss: 0.1460153
	speed: 0.0377s/iter; left time: 1650.2511s
	iters: 400, epoch: 7 | loss: 0.0066619
	speed: 0.0372s/iter; left time: 1623.2937s
Epoch: 7 cost time: 17.385599613189697
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.963692 --> -0.972555).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1004503
	speed: 0.1615s/iter; left time: 7026.6537s
	iters: 200, epoch: 8 | loss: 0.0651837
	speed: 0.0378s/iter; left time: 1642.7068s
	iters: 300, epoch: 8 | loss: 0.0021037
	speed: 0.0379s/iter; left time: 1643.4504s
	iters: 400, epoch: 8 | loss: 0.0159065
	speed: 0.0355s/iter; left time: 1535.6476s
Epoch: 8 cost time: 17.663320779800415
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.973412).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0862890
	speed: 0.1614s/iter; left time: 6949.8637s
	iters: 200, epoch: 9 | loss: 0.0016622
	speed: 0.0353s/iter; left time: 1516.3171s
	iters: 300, epoch: 9 | loss: 0.0525183
	speed: 0.0377s/iter; left time: 1615.9850s
	iters: 400, epoch: 9 | loss: 0.3091393
	speed: 0.0347s/iter; left time: 1484.6207s
Epoch: 9 cost time: 17.38556694984436
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0062884
	speed: 0.1543s/iter; left time: 6568.1493s
	iters: 200, epoch: 10 | loss: 0.0043371
	speed: 0.0353s/iter; left time: 1500.4273s
	iters: 300, epoch: 10 | loss: 0.0034482
	speed: 0.0360s/iter; left time: 1525.8561s
	iters: 400, epoch: 10 | loss: 0.0121599
	speed: 0.0377s/iter; left time: 1594.9850s
Epoch: 10 cost time: 17.702794313430786
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0078392
	speed: 0.1560s/iter; left time: 6569.2443s
	iters: 200, epoch: 11 | loss: 0.1386913
	speed: 0.0381s/iter; left time: 1602.1828s
	iters: 300, epoch: 11 | loss: 0.0015286
	speed: 0.0364s/iter; left time: 1525.8741s
	iters: 400, epoch: 11 | loss: 0.0086196
	speed: 0.0346s/iter; left time: 1446.3882s
Epoch: 11 cost time: 17.268414735794067
Epoch: 11, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.974842).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0729393
	speed: 0.1730s/iter; left time: 7202.7963s
	iters: 200, epoch: 12 | loss: 0.0053766
	speed: 0.0382s/iter; left time: 1585.4293s
	iters: 300, epoch: 12 | loss: 0.0012813
	speed: 0.0360s/iter; left time: 1492.1452s
	iters: 400, epoch: 12 | loss: 0.0025914
	speed: 0.0405s/iter; left time: 1673.4032s
Epoch: 12 cost time: 18.411792993545532
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975699).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0949039
	speed: 0.1807s/iter; left time: 7439.7684s
	iters: 200, epoch: 13 | loss: 0.0800527
	speed: 0.0389s/iter; left time: 1597.7548s
	iters: 300, epoch: 13 | loss: 0.0022017
	speed: 0.0383s/iter; left time: 1567.6441s
	iters: 400, epoch: 13 | loss: 0.3197352
	speed: 0.0382s/iter; left time: 1562.1978s
Epoch: 13 cost time: 18.575387477874756
Epoch: 13, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1027123
	speed: 0.1707s/iter; left time: 6947.0921s
	iters: 200, epoch: 14 | loss: 0.0008197
	speed: 0.0404s/iter; left time: 1639.0534s
	iters: 300, epoch: 14 | loss: 0.0044630
	speed: 0.0398s/iter; left time: 1611.8824s
	iters: 400, epoch: 14 | loss: 0.0393180
	speed: 0.0362s/iter; left time: 1461.9194s
Epoch: 14 cost time: 18.303525924682617
Epoch: 14, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0517245
	speed: 0.1641s/iter; left time: 6601.6370s
	iters: 200, epoch: 15 | loss: 0.0900816
	speed: 0.0359s/iter; left time: 1440.9912s
	iters: 300, epoch: 15 | loss: 0.0052909
	speed: 0.0362s/iter; left time: 1448.7946s
	iters: 400, epoch: 15 | loss: 0.0089803
	speed: 0.0371s/iter; left time: 1481.5488s
Epoch: 15 cost time: 17.407394647598267
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0039319
	speed: 0.1602s/iter; left time: 6371.4432s
	iters: 200, epoch: 16 | loss: 0.0009879
	speed: 0.0370s/iter; left time: 1468.7030s
	iters: 300, epoch: 16 | loss: 0.0639724
	speed: 0.0358s/iter; left time: 1417.2835s
	iters: 400, epoch: 16 | loss: 0.0083226
	speed: 0.0378s/iter; left time: 1491.2492s
Epoch: 16 cost time: 17.70100450515747
Epoch: 16, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0093022
	speed: 0.1597s/iter; left time: 6274.2129s
	iters: 200, epoch: 17 | loss: 0.0612750
	speed: 0.0375s/iter; left time: 1471.8464s
	iters: 300, epoch: 17 | loss: 0.0013989
	speed: 0.0364s/iter; left time: 1423.0678s
	iters: 400, epoch: 17 | loss: 0.0011671
	speed: 0.0361s/iter; left time: 1408.9431s
Epoch: 17 cost time: 17.432318687438965
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0303726
	speed: 0.1594s/iter; left time: 6187.2815s
	iters: 200, epoch: 18 | loss: 0.0004950
	speed: 0.0360s/iter; left time: 1392.4116s
	iters: 300, epoch: 18 | loss: 0.0043012
	speed: 0.0334s/iter; left time: 1291.4334s
	iters: 400, epoch: 18 | loss: 0.0147591
	speed: 0.0343s/iter; left time: 1320.7576s
Epoch: 18 cost time: 16.609147548675537
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0048079
	speed: 0.1077s/iter; left time: 4132.2644s
	iters: 200, epoch: 19 | loss: 0.0038646
	speed: 0.0318s/iter; left time: 1216.6697s
	iters: 300, epoch: 19 | loss: 0.0048904
	speed: 0.0372s/iter; left time: 1419.3351s
	iters: 400, epoch: 19 | loss: 0.0008395
	speed: 0.0378s/iter; left time: 1438.0225s
Epoch: 19 cost time: 16.815663814544678
Epoch: 19, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0016474
	speed: 0.1553s/iter; left time: 5885.5573s
	iters: 200, epoch: 20 | loss: 0.0009140
	speed: 0.0354s/iter; left time: 1339.5880s
	iters: 300, epoch: 20 | loss: 0.0006884
	speed: 0.0373s/iter; left time: 1407.1643s
	iters: 400, epoch: 20 | loss: 0.0008869
	speed: 0.0352s/iter; left time: 1324.7983s
Epoch: 20 cost time: 17.533419609069824
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0015328
	speed: 0.1628s/iter; left time: 6090.6956s
	iters: 200, epoch: 21 | loss: 0.0016544
	speed: 0.0395s/iter; left time: 1474.5966s
	iters: 300, epoch: 21 | loss: 0.2683476
	speed: 0.0392s/iter; left time: 1458.7415s
	iters: 400, epoch: 21 | loss: 0.0018215
	speed: 0.0391s/iter; left time: 1452.9214s
Epoch: 21 cost time: 18.590125799179077
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976843).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0285720
	speed: 0.1751s/iter; left time: 6468.6796s
	iters: 200, epoch: 22 | loss: 0.0038714
	speed: 0.0396s/iter; left time: 1459.8131s
	iters: 300, epoch: 22 | loss: 0.0030131
	speed: 0.0380s/iter; left time: 1396.6222s
	iters: 400, epoch: 22 | loss: 0.0085765
	speed: 0.0399s/iter; left time: 1462.3599s
Epoch: 22 cost time: 18.891446828842163
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3406311
	speed: 0.1742s/iter; left time: 6357.0442s
	iters: 200, epoch: 23 | loss: 0.0022000
	speed: 0.0444s/iter; left time: 1616.9908s
	iters: 300, epoch: 23 | loss: 0.0012385
	speed: 0.0426s/iter; left time: 1545.9371s
	iters: 400, epoch: 23 | loss: 0.0008073
	speed: 0.0405s/iter; left time: 1465.2389s
Epoch: 23 cost time: 19.865254402160645
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0007193
	speed: 0.1752s/iter; left time: 6309.7410s
	iters: 200, epoch: 24 | loss: 0.0006711
	speed: 0.0395s/iter; left time: 1419.8542s
	iters: 300, epoch: 24 | loss: 0.0006727
	speed: 0.0393s/iter; left time: 1409.2806s
	iters: 400, epoch: 24 | loss: 0.0084395
	speed: 0.0397s/iter; left time: 1419.1121s
Epoch: 24 cost time: 18.969481468200684
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0025912
	speed: 0.1639s/iter; left time: 5825.7586s
	iters: 200, epoch: 25 | loss: 0.0070607
	speed: 0.0388s/iter; left time: 1373.5356s
	iters: 300, epoch: 25 | loss: 0.0002352
	speed: 0.0395s/iter; left time: 1394.5178s
	iters: 400, epoch: 25 | loss: 0.0002899
	speed: 0.0385s/iter; left time: 1357.8173s
Epoch: 25 cost time: 18.38484287261963
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0032019
	speed: 0.1543s/iter; left time: 5411.1827s
	iters: 200, epoch: 26 | loss: 0.0726482
	speed: 0.0383s/iter; left time: 1339.4644s
	iters: 300, epoch: 26 | loss: 0.0012828
	speed: 0.0380s/iter; left time: 1323.6707s
	iters: 400, epoch: 26 | loss: 0.0043414
	speed: 0.0369s/iter; left time: 1284.7774s
Epoch: 26 cost time: 18.008559703826904
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0037344
	speed: 0.1590s/iter; left time: 5502.1532s
	iters: 200, epoch: 27 | loss: 0.0001166
	speed: 0.0372s/iter; left time: 1284.8815s
	iters: 300, epoch: 27 | loss: 0.7912258
	speed: 0.0376s/iter; left time: 1293.8341s
	iters: 400, epoch: 27 | loss: 0.0054305
	speed: 0.0384s/iter; left time: 1317.2942s
Epoch: 27 cost time: 17.688528299331665
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.962 Test Loss: 0.215 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0016785
	speed: 0.1579s/iter; left time: 5390.5543s
	iters: 200, epoch: 28 | loss: 0.0059681
	speed: 0.0370s/iter; left time: 1258.4849s
	iters: 300, epoch: 28 | loss: 0.0076184
	speed: 0.0391s/iter; left time: 1325.3651s
	iters: 400, epoch: 28 | loss: 0.0001646
	speed: 0.0383s/iter; left time: 1295.3040s
Epoch: 28 cost time: 17.906347513198853
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.234 Vali Acc: 0.954 Test Loss: 0.234 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0082746
	speed: 0.1608s/iter; left time: 5415.5218s
	iters: 200, epoch: 29 | loss: 0.0291007
	speed: 0.0383s/iter; left time: 1286.8944s
	iters: 300, epoch: 29 | loss: 0.0099793
	speed: 0.0381s/iter; left time: 1274.3368s
	iters: 400, epoch: 29 | loss: 0.0008926
	speed: 0.0381s/iter; left time: 1269.7556s
Epoch: 29 cost time: 18.284159898757935
Epoch: 29, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0022223
	speed: 0.1603s/iter; left time: 5322.3506s
	iters: 200, epoch: 30 | loss: 0.0023946
	speed: 0.0375s/iter; left time: 1240.4807s
	iters: 300, epoch: 30 | loss: 0.0008823
	speed: 0.0372s/iter; left time: 1228.3846s
	iters: 400, epoch: 30 | loss: 0.0007813
	speed: 0.0381s/iter; left time: 1253.8556s
Epoch: 30 cost time: 18.228635549545288
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0003501
	speed: 0.1718s/iter; left time: 5622.1235s
	iters: 200, epoch: 31 | loss: 0.0004553
	speed: 0.0415s/iter; left time: 1353.1948s
	iters: 300, epoch: 31 | loss: 0.0043646
	speed: 0.0379s/iter; left time: 1233.1185s
	iters: 400, epoch: 31 | loss: 0.0239248
	speed: 0.0394s/iter; left time: 1278.2764s
Epoch: 31 cost time: 18.89715576171875
Epoch: 31, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 255502
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2496548
	speed: 0.0477s/iter; left time: 2233.0931s
	iters: 200, epoch: 1 | loss: 0.8843883
	speed: 0.0293s/iter; left time: 1369.7844s
	iters: 300, epoch: 1 | loss: 0.7311862
	speed: 0.0324s/iter; left time: 1507.7844s
	iters: 400, epoch: 1 | loss: 0.1682699
	speed: 0.0359s/iter; left time: 1670.1065s
Epoch: 1 cost time: 17.24559211730957
Epoch: 1, Steps: 469 | Train Loss: 0.954 Vali Loss: 0.383 Vali Acc: 0.887 Test Loss: 0.383 Test Acc: 0.887
Validation loss decreased (inf --> -0.886789).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1211996
	speed: 0.1474s/iter; left time: 6828.5095s
	iters: 200, epoch: 2 | loss: 0.1820041
	speed: 0.0385s/iter; left time: 1782.1901s
	iters: 300, epoch: 2 | loss: 0.3832023
	speed: 0.0368s/iter; left time: 1696.1095s
	iters: 400, epoch: 2 | loss: 0.0306095
	speed: 0.0368s/iter; left time: 1694.4401s
Epoch: 2 cost time: 17.598828077316284
Epoch: 2, Steps: 469 | Train Loss: 0.211 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.886789 --> -0.945967).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0218793
	speed: 0.1591s/iter; left time: 7298.0508s
	iters: 200, epoch: 3 | loss: 0.1712422
	speed: 0.0369s/iter; left time: 1686.6772s
	iters: 300, epoch: 3 | loss: 0.2276935
	speed: 0.0355s/iter; left time: 1619.9706s
	iters: 400, epoch: 3 | loss: 0.0192759
	speed: 0.0342s/iter; left time: 1558.6624s
Epoch: 3 cost time: 17.28932213783264
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1056467
	speed: 0.1435s/iter; left time: 6515.3349s
	iters: 200, epoch: 4 | loss: 0.0248417
	speed: 0.0365s/iter; left time: 1652.4331s
	iters: 300, epoch: 4 | loss: 0.2195333
	speed: 0.0360s/iter; left time: 1626.9795s
	iters: 400, epoch: 4 | loss: 0.4222929
	speed: 0.0371s/iter; left time: 1672.2584s
Epoch: 4 cost time: 17.179909229278564
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.147 Vali Acc: 0.953 Test Loss: 0.147 Test Acc: 0.953
Validation loss decreased (-0.945967 --> -0.952543).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1251548
	speed: 0.1612s/iter; left time: 7239.7425s
	iters: 200, epoch: 5 | loss: 0.1239724
	speed: 0.0377s/iter; left time: 1691.4418s
	iters: 300, epoch: 5 | loss: 0.2365524
	speed: 0.0365s/iter; left time: 1634.6401s
	iters: 400, epoch: 5 | loss: 0.0017776
	speed: 0.0374s/iter; left time: 1667.2964s
Epoch: 5 cost time: 17.570043087005615
Epoch: 5, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
Validation loss decreased (-0.952543 --> -0.953114).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1107218
	speed: 0.1489s/iter; left time: 6619.1994s
	iters: 200, epoch: 6 | loss: 0.0083347
	speed: 0.0360s/iter; left time: 1597.9698s
	iters: 300, epoch: 6 | loss: 0.0117488
	speed: 0.0339s/iter; left time: 1500.2036s
	iters: 400, epoch: 6 | loss: 0.1987125
	speed: 0.0380s/iter; left time: 1677.4097s
Epoch: 6 cost time: 17.371520280838013
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
Validation loss decreased (-0.953114 --> -0.965979).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1184969
	speed: 0.1590s/iter; left time: 6993.9161s
	iters: 200, epoch: 7 | loss: 0.0203275
	speed: 0.0375s/iter; left time: 1647.7314s
	iters: 300, epoch: 7 | loss: 0.0143127
	speed: 0.0363s/iter; left time: 1591.1596s
	iters: 400, epoch: 7 | loss: 0.0073626
	speed: 0.0357s/iter; left time: 1557.8163s
Epoch: 7 cost time: 17.31434941291809
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0217718
	speed: 0.1599s/iter; left time: 6960.4447s
	iters: 200, epoch: 8 | loss: 0.0026101
	speed: 0.0364s/iter; left time: 1582.1794s
	iters: 300, epoch: 8 | loss: 0.0018921
	speed: 0.0385s/iter; left time: 1668.9548s
	iters: 400, epoch: 8 | loss: 0.5845738
	speed: 0.0368s/iter; left time: 1588.8015s
Epoch: 8 cost time: 17.693055868148804
Epoch: 8, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.966551).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2046625
	speed: 0.1724s/iter; left time: 7421.8083s
	iters: 200, epoch: 9 | loss: 0.0019418
	speed: 0.0384s/iter; left time: 1650.6416s
	iters: 300, epoch: 9 | loss: 0.0221082
	speed: 0.0387s/iter; left time: 1659.3571s
	iters: 400, epoch: 9 | loss: 0.0190731
	speed: 0.0396s/iter; left time: 1694.2942s
Epoch: 9 cost time: 18.61747646331787
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.966551 --> -0.966837).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0102136
	speed: 0.1825s/iter; left time: 7769.4383s
	iters: 200, epoch: 10 | loss: 0.0362235
	speed: 0.0412s/iter; left time: 1750.4261s
	iters: 300, epoch: 10 | loss: 0.2650996
	speed: 0.0408s/iter; left time: 1728.6864s
	iters: 400, epoch: 10 | loss: 0.0176903
	speed: 0.0414s/iter; left time: 1748.4907s
Epoch: 10 cost time: 19.80185842514038
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0443528
	speed: 0.1754s/iter; left time: 7385.5332s
	iters: 200, epoch: 11 | loss: 0.0202521
	speed: 0.0372s/iter; left time: 1562.5373s
	iters: 300, epoch: 11 | loss: 0.0494630
	speed: 0.0400s/iter; left time: 1676.7483s
	iters: 400, epoch: 11 | loss: 0.0064681
	speed: 0.0372s/iter; left time: 1556.2939s
Epoch: 11 cost time: 17.987457513809204
Epoch: 11, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0084657
	speed: 0.1510s/iter; left time: 6287.0947s
	iters: 200, epoch: 12 | loss: 0.0160740
	speed: 0.0362s/iter; left time: 1503.0866s
	iters: 300, epoch: 12 | loss: 0.0249020
	speed: 0.0376s/iter; left time: 1556.2742s
	iters: 400, epoch: 12 | loss: 0.2404570
	speed: 0.0328s/iter; left time: 1356.6799s
Epoch: 12 cost time: 17.203970193862915
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.966837 --> -0.968266).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0012201
	speed: 0.1586s/iter; left time: 6530.3269s
	iters: 200, epoch: 13 | loss: 0.0324115
	speed: 0.0375s/iter; left time: 1539.9038s
	iters: 300, epoch: 13 | loss: 0.0040841
	speed: 0.0376s/iter; left time: 1539.8830s
	iters: 400, epoch: 13 | loss: 0.0067590
	speed: 0.0353s/iter; left time: 1441.1892s
Epoch: 13 cost time: 17.13031768798828
Epoch: 13, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0041330
	speed: 0.1620s/iter; left time: 6593.8990s
	iters: 200, epoch: 14 | loss: 0.1268368
	speed: 0.0364s/iter; left time: 1476.0040s
	iters: 300, epoch: 14 | loss: 0.3677196
	speed: 0.0380s/iter; left time: 1537.4232s
	iters: 400, epoch: 14 | loss: 0.0776948
	speed: 0.0370s/iter; left time: 1494.2322s
Epoch: 14 cost time: 17.558732748031616
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0015875
	speed: 0.1488s/iter; left time: 5987.2614s
	iters: 200, epoch: 15 | loss: 0.0018015
	speed: 0.0355s/iter; left time: 1426.1613s
	iters: 300, epoch: 15 | loss: 0.1033862
	speed: 0.0373s/iter; left time: 1495.2430s
	iters: 400, epoch: 15 | loss: 0.0037773
	speed: 0.0364s/iter; left time: 1451.9929s
Epoch: 15 cost time: 17.68516206741333
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.968266 --> -0.968838).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0015005
	speed: 0.1596s/iter; left time: 6346.5098s
	iters: 200, epoch: 16 | loss: 0.0932951
	speed: 0.0364s/iter; left time: 1443.7374s
	iters: 300, epoch: 16 | loss: 0.0082232
	speed: 0.0370s/iter; left time: 1463.3105s
	iters: 400, epoch: 16 | loss: 0.0006941
	speed: 0.0369s/iter; left time: 1454.9812s
Epoch: 16 cost time: 17.45927333831787
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0015784
	speed: 0.1609s/iter; left time: 6323.4322s
	iters: 200, epoch: 17 | loss: 0.0113479
	speed: 0.0384s/iter; left time: 1503.5772s
	iters: 300, epoch: 17 | loss: 0.0062769
	speed: 0.0364s/iter; left time: 1423.2612s
	iters: 400, epoch: 17 | loss: 0.0984735
	speed: 0.0392s/iter; left time: 1526.7598s
Epoch: 17 cost time: 17.89685893058777
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.968838 --> -0.972840).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2760611
	speed: 0.1507s/iter; left time: 5850.3315s
	iters: 200, epoch: 18 | loss: 0.0096801
	speed: 0.0355s/iter; left time: 1376.1673s
	iters: 300, epoch: 18 | loss: 0.0059988
	speed: 0.0363s/iter; left time: 1402.0670s
	iters: 400, epoch: 18 | loss: 0.0097506
	speed: 0.0366s/iter; left time: 1411.1574s
Epoch: 18 cost time: 17.510009765625
Epoch: 18, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0017489
	speed: 0.1671s/iter; left time: 6410.8759s
	iters: 200, epoch: 19 | loss: 0.0055064
	speed: 0.0318s/iter; left time: 1217.4569s
	iters: 300, epoch: 19 | loss: 0.0005696
	speed: 0.0310s/iter; left time: 1182.0927s
	iters: 400, epoch: 19 | loss: 0.0099758
	speed: 0.0299s/iter; left time: 1136.6928s
Epoch: 19 cost time: 15.361284017562866
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0046024
	speed: 0.1281s/iter; left time: 4854.4599s
	iters: 200, epoch: 20 | loss: 0.0132019
	speed: 0.0387s/iter; left time: 1463.3893s
	iters: 300, epoch: 20 | loss: 0.0021695
	speed: 0.0389s/iter; left time: 1467.1108s
	iters: 400, epoch: 20 | loss: 0.0022985
	speed: 0.0375s/iter; left time: 1409.0132s
Epoch: 20 cost time: 18.365198612213135
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0082167
	speed: 0.1674s/iter; left time: 6264.8780s
	iters: 200, epoch: 21 | loss: 0.0012387
	speed: 0.0389s/iter; left time: 1450.4033s
	iters: 300, epoch: 21 | loss: 0.0007796
	speed: 0.0395s/iter; left time: 1471.3163s
	iters: 400, epoch: 21 | loss: 0.0067432
	speed: 0.0355s/iter; left time: 1316.1413s
Epoch: 21 cost time: 17.880586624145508
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975985).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0342265
	speed: 0.1456s/iter; left time: 5378.4002s
	iters: 200, epoch: 22 | loss: 0.0007788
	speed: 0.0356s/iter; left time: 1310.7846s
	iters: 300, epoch: 22 | loss: 0.0004710
	speed: 0.0355s/iter; left time: 1304.9702s
	iters: 400, epoch: 22 | loss: 0.0047429
	speed: 0.0347s/iter; left time: 1272.5097s
Epoch: 22 cost time: 17.489336490631104
Epoch: 22, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0046901
	speed: 0.1589s/iter; left time: 5798.7712s
	iters: 200, epoch: 23 | loss: 0.0037648
	speed: 0.0386s/iter; left time: 1404.0585s
	iters: 300, epoch: 23 | loss: 0.0106970
	speed: 0.0365s/iter; left time: 1325.8841s
	iters: 400, epoch: 23 | loss: 0.0721186
	speed: 0.0385s/iter; left time: 1394.8484s
Epoch: 23 cost time: 17.911090850830078
Epoch: 23, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1313340
	speed: 0.1581s/iter; left time: 5692.3602s
	iters: 200, epoch: 24 | loss: 0.0024830
	speed: 0.0397s/iter; left time: 1424.9257s
	iters: 300, epoch: 24 | loss: 0.0570017
	speed: 0.0403s/iter; left time: 1443.1391s
	iters: 400, epoch: 24 | loss: 0.0015156
	speed: 0.0377s/iter; left time: 1347.3096s
Epoch: 24 cost time: 18.692636489868164
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.223 Vali Acc: 0.961 Test Loss: 0.223 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0003150
	speed: 0.1648s/iter; left time: 5859.3363s
	iters: 200, epoch: 25 | loss: 0.0085607
	speed: 0.0381s/iter; left time: 1351.7349s
	iters: 300, epoch: 25 | loss: 0.0011096
	speed: 0.0390s/iter; left time: 1379.4966s
	iters: 400, epoch: 25 | loss: 0.0012077
	speed: 0.0390s/iter; left time: 1375.6925s
Epoch: 25 cost time: 18.43336844444275
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0014768
	speed: 0.1473s/iter; left time: 5167.5374s
	iters: 200, epoch: 26 | loss: 0.0006434
	speed: 0.0382s/iter; left time: 1336.4799s
	iters: 300, epoch: 26 | loss: 0.0067835
	speed: 0.0374s/iter; left time: 1304.6622s
	iters: 400, epoch: 26 | loss: 0.0015830
	speed: 0.0368s/iter; left time: 1280.4832s
Epoch: 26 cost time: 17.96923804283142
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978272).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0016900
	speed: 0.1687s/iter; left time: 5837.4046s
	iters: 200, epoch: 27 | loss: 0.0006873
	speed: 0.0393s/iter; left time: 1355.9625s
	iters: 300, epoch: 27 | loss: 0.0297043
	speed: 0.0408s/iter; left time: 1403.5144s
	iters: 400, epoch: 27 | loss: 0.0798449
	speed: 0.0383s/iter; left time: 1314.0371s
Epoch: 27 cost time: 18.46759533882141
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0023164
	speed: 0.1616s/iter; left time: 5515.0921s
	iters: 200, epoch: 28 | loss: 0.0008982
	speed: 0.0355s/iter; left time: 1207.1114s
	iters: 300, epoch: 28 | loss: 0.0005945
	speed: 0.0387s/iter; left time: 1312.6055s
	iters: 400, epoch: 28 | loss: 0.0454015
	speed: 0.0396s/iter; left time: 1338.6494s
Epoch: 28 cost time: 18.288092851638794
Epoch: 28, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0051541
	speed: 0.1706s/iter; left time: 5743.3590s
	iters: 200, epoch: 29 | loss: 0.0022616
	speed: 0.0401s/iter; left time: 1347.5441s
	iters: 300, epoch: 29 | loss: 0.0016798
	speed: 0.0394s/iter; left time: 1319.9772s
	iters: 400, epoch: 29 | loss: 0.0009698
	speed: 0.0390s/iter; left time: 1299.7392s
Epoch: 29 cost time: 18.929372310638428
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0061829
	speed: 0.1720s/iter; left time: 5710.6024s
	iters: 200, epoch: 30 | loss: 0.0020849
	speed: 0.0383s/iter; left time: 1267.9445s
	iters: 300, epoch: 30 | loss: 0.0040998
	speed: 0.0403s/iter; left time: 1330.4457s
	iters: 400, epoch: 30 | loss: 0.0123073
	speed: 0.0396s/iter; left time: 1302.0551s
Epoch: 30 cost time: 18.55039119720459
Epoch: 30, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0191451
	speed: 0.1689s/iter; left time: 5526.8652s
	iters: 200, epoch: 31 | loss: 0.0814178
	speed: 0.0348s/iter; left time: 1135.8761s
	iters: 300, epoch: 31 | loss: 0.0013934
	speed: 0.0370s/iter; left time: 1202.5494s
	iters: 400, epoch: 31 | loss: 0.0004395
	speed: 0.0363s/iter; left time: 1176.4297s
Epoch: 31 cost time: 17.170387506484985
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0055833
	speed: 0.1565s/iter; left time: 5048.3025s
	iters: 200, epoch: 32 | loss: 0.0166334
	speed: 0.0378s/iter; left time: 1217.2488s
	iters: 300, epoch: 32 | loss: 0.0004002
	speed: 0.0366s/iter; left time: 1174.8164s
	iters: 400, epoch: 32 | loss: 0.4071708
	speed: 0.0361s/iter; left time: 1154.5871s
Epoch: 32 cost time: 17.724392890930176
Epoch: 32, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0006328
	speed: 0.1499s/iter; left time: 4764.3508s
	iters: 200, epoch: 33 | loss: 0.2908006
	speed: 0.0367s/iter; left time: 1161.7191s
	iters: 300, epoch: 33 | loss: 0.0005089
	speed: 0.0375s/iter; left time: 1185.7783s
	iters: 400, epoch: 33 | loss: 0.0001890
	speed: 0.0343s/iter; left time: 1081.7446s
Epoch: 33 cost time: 17.376935958862305
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.1673897
	speed: 0.1515s/iter; left time: 4745.7371s
	iters: 200, epoch: 34 | loss: 0.0019919
	speed: 0.0363s/iter; left time: 1134.9113s
	iters: 300, epoch: 34 | loss: 0.0009066
	speed: 0.0360s/iter; left time: 1120.3559s
	iters: 400, epoch: 34 | loss: 0.0004654
	speed: 0.0367s/iter; left time: 1139.2036s
Epoch: 34 cost time: 17.526583671569824
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0004769
	speed: 0.1507s/iter; left time: 4648.5601s
	iters: 200, epoch: 35 | loss: 0.0025760
	speed: 0.0373s/iter; left time: 1146.5557s
	iters: 300, epoch: 35 | loss: 0.0020322
	speed: 0.0348s/iter; left time: 1067.6046s
	iters: 400, epoch: 35 | loss: 0.0475039
	speed: 0.0354s/iter; left time: 1081.5053s
Epoch: 35 cost time: 17.45253610610962
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0018647
	speed: 0.1589s/iter; left time: 4828.7566s
	iters: 200, epoch: 36 | loss: 0.0304648
	speed: 0.0376s/iter; left time: 1140.0572s
	iters: 300, epoch: 36 | loss: 0.0229978
	speed: 0.0362s/iter; left time: 1093.3536s
	iters: 400, epoch: 36 | loss: 0.0003632
	speed: 0.0357s/iter; left time: 1073.1292s
Epoch: 36 cost time: 17.514342308044434
Epoch: 36, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 255438
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4503815
	speed: 0.0494s/iter; left time: 2311.3936s
	iters: 200, epoch: 1 | loss: 0.8937763
	speed: 0.0379s/iter; left time: 1769.9856s
	iters: 300, epoch: 1 | loss: 0.3674369
	speed: 0.0371s/iter; left time: 1728.2968s
	iters: 400, epoch: 1 | loss: 0.2486377
	speed: 0.0365s/iter; left time: 1699.2701s
Epoch: 1 cost time: 18.621145248413086
Epoch: 1, Steps: 469 | Train Loss: 0.993 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
Validation loss decreased (inf --> -0.855056).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3555191
	speed: 0.1637s/iter; left time: 7582.9791s
	iters: 200, epoch: 2 | loss: 0.1762868
	speed: 0.0397s/iter; left time: 1833.6264s
	iters: 300, epoch: 2 | loss: 0.3645159
	speed: 0.0393s/iter; left time: 1813.4766s
	iters: 400, epoch: 2 | loss: 0.0524158
	speed: 0.0407s/iter; left time: 1875.7168s
Epoch: 2 cost time: 19.03257417678833
Epoch: 2, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.855056 --> -0.951113).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5125930
	speed: 0.1650s/iter; left time: 7569.3080s
	iters: 200, epoch: 3 | loss: 0.2313365
	speed: 0.0296s/iter; left time: 1353.4678s
	iters: 300, epoch: 3 | loss: 0.0887216
	speed: 0.0296s/iter; left time: 1352.7566s
	iters: 400, epoch: 3 | loss: 0.1214991
	speed: 0.0294s/iter; left time: 1341.4719s
Epoch: 3 cost time: 14.955597162246704
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.951113 --> -0.953972).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0678614
	speed: 0.1478s/iter; left time: 6710.3298s
	iters: 200, epoch: 4 | loss: 0.0810835
	speed: 0.0377s/iter; left time: 1709.5006s
	iters: 300, epoch: 4 | loss: 0.5892025
	speed: 0.0381s/iter; left time: 1719.7656s
	iters: 400, epoch: 4 | loss: 0.1186042
	speed: 0.0383s/iter; left time: 1726.6960s
Epoch: 4 cost time: 18.18233633041382
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.194 Vali Acc: 0.953 Test Loss: 0.194 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5385495
	speed: 0.1507s/iter; left time: 6771.2556s
	iters: 200, epoch: 5 | loss: 0.0237028
	speed: 0.0371s/iter; left time: 1661.5505s
	iters: 300, epoch: 5 | loss: 0.4655695
	speed: 0.0368s/iter; left time: 1644.5988s
	iters: 400, epoch: 5 | loss: 0.0511271
	speed: 0.0374s/iter; left time: 1666.9068s
Epoch: 5 cost time: 17.01487374305725
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.953972 --> -0.958260).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0259916
	speed: 0.1447s/iter; left time: 6432.4929s
	iters: 200, epoch: 6 | loss: 0.0904359
	speed: 0.0381s/iter; left time: 1689.8766s
	iters: 300, epoch: 6 | loss: 0.0236830
	speed: 0.0354s/iter; left time: 1565.2670s
	iters: 400, epoch: 6 | loss: 0.6482418
	speed: 0.0368s/iter; left time: 1622.8223s
Epoch: 6 cost time: 17.596670150756836
Epoch: 6, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
Validation loss decreased (-0.958260 --> -0.963692).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0083612
	speed: 0.1556s/iter; left time: 6844.9861s
	iters: 200, epoch: 7 | loss: 0.0036658
	speed: 0.0374s/iter; left time: 1642.4488s
	iters: 300, epoch: 7 | loss: 0.3976229
	speed: 0.0351s/iter; left time: 1538.9330s
	iters: 400, epoch: 7 | loss: 0.0237295
	speed: 0.0369s/iter; left time: 1610.0318s
Epoch: 7 cost time: 17.497540712356567
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.963692 --> -0.967981).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0051113
	speed: 0.1543s/iter; left time: 6713.6066s
	iters: 200, epoch: 8 | loss: 0.0037498
	speed: 0.0368s/iter; left time: 1597.7531s
	iters: 300, epoch: 8 | loss: 0.1832918
	speed: 0.0371s/iter; left time: 1607.0930s
	iters: 400, epoch: 8 | loss: 0.0042707
	speed: 0.0356s/iter; left time: 1536.9645s
Epoch: 8 cost time: 17.398499250411987
Epoch: 8, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0272474
	speed: 0.1538s/iter; left time: 6618.9307s
	iters: 200, epoch: 9 | loss: 0.0174898
	speed: 0.0356s/iter; left time: 1529.6674s
	iters: 300, epoch: 9 | loss: 0.0100716
	speed: 0.0372s/iter; left time: 1593.9525s
	iters: 400, epoch: 9 | loss: 0.0022077
	speed: 0.0358s/iter; left time: 1531.5778s
Epoch: 9 cost time: 17.60927939414978
Epoch: 9, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0012083
	speed: 0.1502s/iter; left time: 6394.4075s
	iters: 200, epoch: 10 | loss: 0.0498806
	speed: 0.0368s/iter; left time: 1563.4901s
	iters: 300, epoch: 10 | loss: 0.4107702
	speed: 0.0350s/iter; left time: 1481.6942s
	iters: 400, epoch: 10 | loss: 0.0013696
	speed: 0.0348s/iter; left time: 1472.8016s
Epoch: 10 cost time: 17.27338695526123
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0137755
	speed: 0.1583s/iter; left time: 6667.2455s
	iters: 200, epoch: 11 | loss: 0.0089169
	speed: 0.0382s/iter; left time: 1606.6320s
	iters: 300, epoch: 11 | loss: 0.0490998
	speed: 0.0369s/iter; left time: 1546.3244s
	iters: 400, epoch: 11 | loss: 0.0143810
	speed: 0.0359s/iter; left time: 1502.4431s
Epoch: 11 cost time: 17.712000846862793
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0098447
	speed: 0.1571s/iter; left time: 6541.0857s
	iters: 200, epoch: 12 | loss: 0.2901157
	speed: 0.0369s/iter; left time: 1534.5987s
	iters: 300, epoch: 12 | loss: 0.0065046
	speed: 0.0370s/iter; left time: 1535.3105s
	iters: 400, epoch: 12 | loss: 0.2582805
	speed: 0.0408s/iter; left time: 1686.6462s
Epoch: 12 cost time: 18.491556406021118
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0231270
	speed: 0.1701s/iter; left time: 7004.8120s
	iters: 200, epoch: 13 | loss: 0.0023404
	speed: 0.0417s/iter; left time: 1710.8855s
	iters: 300, epoch: 13 | loss: 0.0714210
	speed: 0.0392s/iter; left time: 1606.7195s
	iters: 400, epoch: 13 | loss: 0.0037972
	speed: 0.0388s/iter; left time: 1587.5290s
Epoch: 13 cost time: 18.642584085464478
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0424593
	speed: 0.1721s/iter; left time: 7006.1292s
	iters: 200, epoch: 14 | loss: 0.2686059
	speed: 0.0368s/iter; left time: 1493.3176s
	iters: 300, epoch: 14 | loss: 0.0527690
	speed: 0.0381s/iter; left time: 1544.5149s
	iters: 400, epoch: 14 | loss: 0.0433312
	speed: 0.0363s/iter; left time: 1467.9542s
Epoch: 14 cost time: 17.74596619606018
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0030879
	speed: 0.1511s/iter; left time: 6081.5084s
	iters: 200, epoch: 15 | loss: 0.0013438
	speed: 0.0348s/iter; left time: 1397.7845s
	iters: 300, epoch: 15 | loss: 0.0243427
	speed: 0.0331s/iter; left time: 1324.2855s
	iters: 400, epoch: 15 | loss: 0.0009731
	speed: 0.0366s/iter; left time: 1460.4149s
Epoch: 15 cost time: 16.665406703948975
Epoch: 15, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0461768
	speed: 0.1521s/iter; left time: 6048.2032s
	iters: 200, epoch: 16 | loss: 0.0147271
	speed: 0.0372s/iter; left time: 1477.4536s
	iters: 300, epoch: 16 | loss: 0.0015162
	speed: 0.0364s/iter; left time: 1440.7967s
	iters: 400, epoch: 16 | loss: 0.5672316
	speed: 0.0346s/iter; left time: 1366.1776s
Epoch: 16 cost time: 17.30923295021057
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.967981 --> -0.972555).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3531157
	speed: 0.1604s/iter; left time: 6301.3555s
	iters: 200, epoch: 17 | loss: 0.0193999
	speed: 0.0377s/iter; left time: 1476.3467s
	iters: 300, epoch: 17 | loss: 0.0648716
	speed: 0.0378s/iter; left time: 1476.0655s
	iters: 400, epoch: 17 | loss: 0.0142774
	speed: 0.0352s/iter; left time: 1372.2030s
Epoch: 17 cost time: 17.516690969467163
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0035926
	speed: 0.1183s/iter; left time: 4591.5046s
	iters: 200, epoch: 18 | loss: 0.0064969
	speed: 0.0299s/iter; left time: 1156.3306s
	iters: 300, epoch: 18 | loss: 0.0033572
	speed: 0.0313s/iter; left time: 1210.2422s
	iters: 400, epoch: 18 | loss: 0.0089135
	speed: 0.0344s/iter; left time: 1324.9838s
Epoch: 18 cost time: 15.342298984527588
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0038166
	speed: 0.1554s/iter; left time: 5960.2782s
	iters: 200, epoch: 19 | loss: 0.0299214
	speed: 0.0360s/iter; left time: 1376.5749s
	iters: 300, epoch: 19 | loss: 0.0005226
	speed: 0.0365s/iter; left time: 1393.1777s
	iters: 400, epoch: 19 | loss: 0.0162367
	speed: 0.0363s/iter; left time: 1382.1190s
Epoch: 19 cost time: 17.248127698898315
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0007678
	speed: 0.1382s/iter; left time: 5238.1079s
	iters: 200, epoch: 20 | loss: 0.0060486
	speed: 0.0367s/iter; left time: 1386.6337s
	iters: 300, epoch: 20 | loss: 0.0037397
	speed: 0.0346s/iter; left time: 1304.1147s
	iters: 400, epoch: 20 | loss: 0.1797299
	speed: 0.0329s/iter; left time: 1235.2056s
Epoch: 20 cost time: 17.05577778816223
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0019686
	speed: 0.1619s/iter; left time: 6058.0894s
	iters: 200, epoch: 21 | loss: 0.0389352
	speed: 0.0375s/iter; left time: 1397.8159s
	iters: 300, epoch: 21 | loss: 0.0022558
	speed: 0.0392s/iter; left time: 1457.5651s
	iters: 400, epoch: 21 | loss: 0.0004294
	speed: 0.0388s/iter; left time: 1440.0715s
Epoch: 21 cost time: 18.097287893295288
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0010376
	speed: 0.1681s/iter; left time: 6210.7225s
	iters: 200, epoch: 22 | loss: 0.0007760
	speed: 0.0396s/iter; left time: 1460.0790s
	iters: 300, epoch: 22 | loss: 0.0239573
	speed: 0.0397s/iter; left time: 1458.5675s
	iters: 400, epoch: 22 | loss: 0.0620020
	speed: 0.0400s/iter; left time: 1467.9070s
Epoch: 22 cost time: 18.941203355789185
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0045666
	speed: 0.1726s/iter; left time: 6297.0878s
	iters: 200, epoch: 23 | loss: 0.0597723
	speed: 0.0395s/iter; left time: 1437.9908s
	iters: 300, epoch: 23 | loss: 0.0080844
	speed: 0.0372s/iter; left time: 1349.1059s
	iters: 400, epoch: 23 | loss: 0.0139632
	speed: 0.0372s/iter; left time: 1346.6170s
Epoch: 23 cost time: 18.349303007125854
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0789170
	speed: 0.1724s/iter; left time: 6209.1186s
	iters: 200, epoch: 24 | loss: 0.0848491
	speed: 0.0340s/iter; left time: 1220.7923s
	iters: 300, epoch: 24 | loss: 0.0005281
	speed: 0.0380s/iter; left time: 1362.5619s
	iters: 400, epoch: 24 | loss: 0.0022714
	speed: 0.0362s/iter; left time: 1293.9013s
Epoch: 24 cost time: 17.15355110168457
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.972555 --> -0.974842).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0027946
	speed: 0.1503s/iter; left time: 5343.6576s
	iters: 200, epoch: 25 | loss: 0.0007482
	speed: 0.0351s/iter; left time: 1244.8972s
	iters: 300, epoch: 25 | loss: 0.0020486
	speed: 0.0355s/iter; left time: 1256.1860s
	iters: 400, epoch: 25 | loss: 0.0500839
	speed: 0.0369s/iter; left time: 1300.4119s
Epoch: 25 cost time: 17.440093278884888
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0220648
	speed: 0.1557s/iter; left time: 5461.9567s
	iters: 200, epoch: 26 | loss: 0.0007300
	speed: 0.0350s/iter; left time: 1224.8553s
	iters: 300, epoch: 26 | loss: 0.0004749
	speed: 0.0354s/iter; left time: 1234.5752s
	iters: 400, epoch: 26 | loss: 0.0012127
	speed: 0.0327s/iter; left time: 1138.5477s
Epoch: 26 cost time: 17.17560362815857
Epoch: 26, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0022195
	speed: 0.1479s/iter; left time: 5117.2154s
	iters: 200, epoch: 27 | loss: 0.3627459
	speed: 0.0376s/iter; left time: 1295.9611s
	iters: 300, epoch: 27 | loss: 0.0009489
	speed: 0.0370s/iter; left time: 1274.0959s
	iters: 400, epoch: 27 | loss: 0.0061675
	speed: 0.0361s/iter; left time: 1237.2534s
Epoch: 27 cost time: 17.524810552597046
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.974842 --> -0.979988).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0003280
	speed: 0.1574s/iter; left time: 5372.5863s
	iters: 200, epoch: 28 | loss: 0.0020332
	speed: 0.0339s/iter; left time: 1152.3395s
	iters: 300, epoch: 28 | loss: 0.0004083
	speed: 0.0366s/iter; left time: 1242.4365s
	iters: 400, epoch: 28 | loss: 0.0021557
	speed: 0.0366s/iter; left time: 1239.1425s
Epoch: 28 cost time: 17.106602907180786
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0019549
	speed: 0.1473s/iter; left time: 4959.6785s
	iters: 200, epoch: 29 | loss: 0.0097898
	speed: 0.0369s/iter; left time: 1237.1204s
	iters: 300, epoch: 29 | loss: 0.0017369
	speed: 0.0369s/iter; left time: 1236.5956s
	iters: 400, epoch: 29 | loss: 0.0022434
	speed: 0.0347s/iter; left time: 1159.4632s
Epoch: 29 cost time: 17.616538047790527
Epoch: 29, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0063362
	speed: 0.1565s/iter; left time: 5196.2573s
	iters: 200, epoch: 30 | loss: 0.0136078
	speed: 0.0377s/iter; left time: 1247.8028s
	iters: 300, epoch: 30 | loss: 0.0004127
	speed: 0.0351s/iter; left time: 1157.9969s
	iters: 400, epoch: 30 | loss: 0.0032815
	speed: 0.0356s/iter; left time: 1170.9779s
Epoch: 30 cost time: 17.37151074409485
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0025449
	speed: 0.1490s/iter; left time: 4878.3612s
	iters: 200, epoch: 31 | loss: 0.0008212
	speed: 0.0357s/iter; left time: 1165.1423s
	iters: 300, epoch: 31 | loss: 0.0075787
	speed: 0.0367s/iter; left time: 1192.3641s
	iters: 400, epoch: 31 | loss: 0.0943390
	speed: 0.0335s/iter; left time: 1087.8265s
Epoch: 31 cost time: 16.923493146896362
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0093017
	speed: 0.1672s/iter; left time: 5393.7391s
	iters: 200, epoch: 32 | loss: 0.0004883
	speed: 0.0378s/iter; left time: 1215.2503s
	iters: 300, epoch: 32 | loss: 0.0006561
	speed: 0.0367s/iter; left time: 1175.9695s
	iters: 400, epoch: 32 | loss: 0.0017604
	speed: 0.0388s/iter; left time: 1239.0470s
Epoch: 32 cost time: 18.14309525489807
Epoch: 32, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0007284
	speed: 0.1669s/iter; left time: 5304.8145s
	iters: 200, epoch: 33 | loss: 0.0038069
	speed: 0.0395s/iter; left time: 1251.0952s
	iters: 300, epoch: 33 | loss: 0.0007066
	speed: 0.0384s/iter; left time: 1212.6102s
	iters: 400, epoch: 33 | loss: 0.0009507
	speed: 0.0354s/iter; left time: 1113.4895s
Epoch: 33 cost time: 18.13021731376648
Epoch: 33, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0062420
	speed: 0.1694s/iter; left time: 5306.0195s
	iters: 200, epoch: 34 | loss: 0.0012378
	speed: 0.0363s/iter; left time: 1134.8163s
	iters: 300, epoch: 34 | loss: 0.0003731
	speed: 0.0352s/iter; left time: 1095.5138s
	iters: 400, epoch: 34 | loss: 0.0286126
	speed: 0.0320s/iter; left time: 993.9582s
Epoch: 34 cost time: 16.603348970413208
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0001992
	speed: 0.1178s/iter; left time: 3634.4517s
	iters: 200, epoch: 35 | loss: 0.0009461
	speed: 0.0359s/iter; left time: 1103.0283s
	iters: 300, epoch: 35 | loss: 0.0011890
	speed: 0.0403s/iter; left time: 1234.9564s
	iters: 400, epoch: 35 | loss: 0.0004902
	speed: 0.0392s/iter; left time: 1196.8324s
Epoch: 35 cost time: 17.4559063911438
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.962 Test Loss: 0.220 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0107692
	speed: 0.1346s/iter; left time: 4089.7581s
	iters: 200, epoch: 36 | loss: 0.0007092
	speed: 0.0351s/iter; left time: 1062.8189s
	iters: 300, epoch: 36 | loss: 0.0002483
	speed: 0.0341s/iter; left time: 1030.8225s
	iters: 400, epoch: 36 | loss: 0.0008154
	speed: 0.0342s/iter; left time: 1028.8941s
Epoch: 36 cost time: 16.494260549545288
Epoch: 36, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.959 Test Loss: 0.238 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0008024
	speed: 0.1545s/iter; left time: 4622.3558s
	iters: 200, epoch: 37 | loss: 0.0667661
	speed: 0.0373s/iter; left time: 1111.0718s
	iters: 300, epoch: 37 | loss: 0.0028964
	speed: 0.0359s/iter; left time: 1068.1378s
	iters: 400, epoch: 37 | loss: 0.0002356
	speed: 0.0345s/iter; left time: 1022.0341s
Epoch: 37 cost time: 17.136364221572876
Epoch: 37, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 255374
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3614900
	speed: 0.0491s/iter; left time: 2299.7973s
	iters: 200, epoch: 1 | loss: 0.8513045
	speed: 0.0378s/iter; left time: 1764.9557s
	iters: 300, epoch: 1 | loss: 0.7234417
	speed: 0.0374s/iter; left time: 1744.8946s
	iters: 400, epoch: 1 | loss: 0.6204661
	speed: 0.0383s/iter; left time: 1782.5214s
Epoch: 1 cost time: 18.916326999664307
Epoch: 1, Steps: 469 | Train Loss: 1.061 Vali Loss: 0.433 Vali Acc: 0.885 Test Loss: 0.433 Test Acc: 0.885
Validation loss decreased (inf --> -0.884787).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3214159
	speed: 0.1578s/iter; left time: 7312.4236s
	iters: 200, epoch: 2 | loss: 0.4050697
	speed: 0.0377s/iter; left time: 1740.9972s
	iters: 300, epoch: 2 | loss: 0.2720279
	speed: 0.0351s/iter; left time: 1620.7416s
	iters: 400, epoch: 2 | loss: 0.0871673
	speed: 0.0385s/iter; left time: 1770.4493s
Epoch: 2 cost time: 18.189350843429565
Epoch: 2, Steps: 469 | Train Loss: 0.236 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
Validation loss decreased (-0.884787 --> -0.935104).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0361464
	speed: 0.1544s/iter; left time: 7080.1897s
	iters: 200, epoch: 3 | loss: 0.2275017
	speed: 0.0378s/iter; left time: 1728.6671s
	iters: 300, epoch: 3 | loss: 0.0627670
	speed: 0.0377s/iter; left time: 1721.5792s
	iters: 400, epoch: 3 | loss: 0.0324327
	speed: 0.0359s/iter; left time: 1634.6910s
Epoch: 3 cost time: 17.294893980026245
Epoch: 3, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.935104 --> -0.956545).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0306236
	speed: 0.1530s/iter; left time: 6947.1440s
	iters: 200, epoch: 4 | loss: 0.2031519
	speed: 0.0347s/iter; left time: 1573.1686s
	iters: 300, epoch: 4 | loss: 0.4085184
	speed: 0.0377s/iter; left time: 1705.8408s
	iters: 400, epoch: 4 | loss: 0.0232732
	speed: 0.0405s/iter; left time: 1824.2354s
Epoch: 4 cost time: 17.705072164535522
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2007601
	speed: 0.1502s/iter; left time: 6746.9480s
	iters: 200, epoch: 5 | loss: 0.0351739
	speed: 0.0358s/iter; left time: 1606.4097s
	iters: 300, epoch: 5 | loss: 0.0085670
	speed: 0.0372s/iter; left time: 1663.7295s
	iters: 400, epoch: 5 | loss: 0.0092529
	speed: 0.0383s/iter; left time: 1708.3707s
Epoch: 5 cost time: 17.912538528442383
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0849518
	speed: 0.1662s/iter; left time: 7389.1123s
	iters: 200, epoch: 6 | loss: 0.4013244
	speed: 0.0415s/iter; left time: 1841.9559s
	iters: 300, epoch: 6 | loss: 0.1024727
	speed: 0.0378s/iter; left time: 1671.0493s
	iters: 400, epoch: 6 | loss: 0.0201907
	speed: 0.0423s/iter; left time: 1866.3467s
Epoch: 6 cost time: 19.10551357269287
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
Validation loss decreased (-0.956545 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0157394
	speed: 0.1716s/iter; left time: 7548.5390s
	iters: 200, epoch: 7 | loss: 0.0057538
	speed: 0.0393s/iter; left time: 1723.3887s
	iters: 300, epoch: 7 | loss: 0.0305493
	speed: 0.0399s/iter; left time: 1745.6465s
	iters: 400, epoch: 7 | loss: 0.0273079
	speed: 0.0417s/iter; left time: 1823.3027s
Epoch: 7 cost time: 18.922526836395264
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.963406 --> -0.976843).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0076678
	speed: 0.1775s/iter; left time: 7723.0870s
	iters: 200, epoch: 8 | loss: 0.6021745
	speed: 0.0383s/iter; left time: 1662.1793s
	iters: 300, epoch: 8 | loss: 0.0010594
	speed: 0.0371s/iter; left time: 1605.4774s
	iters: 400, epoch: 8 | loss: 0.0281369
	speed: 0.0387s/iter; left time: 1670.5868s
Epoch: 8 cost time: 18.674193859100342
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0271731
	speed: 0.1491s/iter; left time: 6418.6157s
	iters: 200, epoch: 9 | loss: 0.0237433
	speed: 0.0396s/iter; left time: 1699.5103s
	iters: 300, epoch: 9 | loss: 0.0090044
	speed: 0.0369s/iter; left time: 1579.2492s
	iters: 400, epoch: 9 | loss: 0.0151805
	speed: 0.0362s/iter; left time: 1546.1618s
Epoch: 9 cost time: 17.736202001571655
Epoch: 9, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0109954
	speed: 0.1623s/iter; left time: 6910.6874s
	iters: 200, epoch: 10 | loss: 0.0537339
	speed: 0.0372s/iter; left time: 1580.3858s
	iters: 300, epoch: 10 | loss: 0.0039413
	speed: 0.0392s/iter; left time: 1660.0574s
	iters: 400, epoch: 10 | loss: 0.0142982
	speed: 0.0370s/iter; left time: 1563.8776s
Epoch: 10 cost time: 18.08944535255432
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0059786
	speed: 0.1544s/iter; left time: 6501.7833s
	iters: 200, epoch: 11 | loss: 0.0185009
	speed: 0.0381s/iter; left time: 1598.9018s
	iters: 300, epoch: 11 | loss: 0.0031653
	speed: 0.0357s/iter; left time: 1494.5845s
	iters: 400, epoch: 11 | loss: 0.1207558
	speed: 0.0391s/iter; left time: 1635.9408s
Epoch: 11 cost time: 18.022119760513306
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0035519
	speed: 0.1589s/iter; left time: 6617.6378s
	iters: 200, epoch: 12 | loss: 0.4998079
	speed: 0.0387s/iter; left time: 1606.4547s
	iters: 300, epoch: 12 | loss: 0.0914911
	speed: 0.0359s/iter; left time: 1486.3213s
	iters: 400, epoch: 12 | loss: 0.1148380
	speed: 0.0372s/iter; left time: 1536.7523s
Epoch: 12 cost time: 17.985973834991455
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0108492
	speed: 0.1541s/iter; left time: 6346.4825s
	iters: 200, epoch: 13 | loss: 0.0119139
	speed: 0.0375s/iter; left time: 1538.2469s
	iters: 300, epoch: 13 | loss: 0.2162581
	speed: 0.0386s/iter; left time: 1579.5598s
	iters: 400, epoch: 13 | loss: 0.0009988
	speed: 0.0395s/iter; left time: 1614.5569s
Epoch: 13 cost time: 17.84748363494873
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0034227
	speed: 0.1527s/iter; left time: 6216.1742s
	iters: 200, epoch: 14 | loss: 0.0234452
	speed: 0.0357s/iter; left time: 1450.3672s
	iters: 300, epoch: 14 | loss: 0.1639832
	speed: 0.0376s/iter; left time: 1522.3880s
	iters: 400, epoch: 14 | loss: 0.0075517
	speed: 0.0398s/iter; left time: 1607.3111s
Epoch: 14 cost time: 17.789337635040283
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0063174
	speed: 0.1539s/iter; left time: 6190.4989s
	iters: 200, epoch: 15 | loss: 0.0089565
	speed: 0.0376s/iter; left time: 1509.1320s
	iters: 300, epoch: 15 | loss: 0.0044566
	speed: 0.0384s/iter; left time: 1538.3694s
	iters: 400, epoch: 15 | loss: 0.0091586
	speed: 0.0345s/iter; left time: 1377.8575s
Epoch: 15 cost time: 17.963299989700317
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0014390
	speed: 0.1718s/iter; left time: 6832.5975s
	iters: 200, epoch: 16 | loss: 0.0019139
	speed: 0.0409s/iter; left time: 1621.0985s
	iters: 300, epoch: 16 | loss: 0.0014690
	speed: 0.0408s/iter; left time: 1613.4320s
	iters: 400, epoch: 16 | loss: 0.0346713
	speed: 0.0416s/iter; left time: 1641.7224s
Epoch: 16 cost time: 19.34122347831726
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0016060
	speed: 0.1771s/iter; left time: 6958.6628s
	iters: 200, epoch: 17 | loss: 0.0022344
	speed: 0.0387s/iter; left time: 1517.3244s
	iters: 300, epoch: 17 | loss: 0.0005071
	speed: 0.0421s/iter; left time: 1644.5053s
	iters: 400, epoch: 17 | loss: 0.0027294
	speed: 0.0421s/iter; left time: 1640.4799s
Epoch: 17 cost time: 19.106754302978516
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 172366
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3673363
	speed: 0.0508s/iter; left time: 2375.4393s
	iters: 200, epoch: 1 | loss: 0.9067132
	speed: 0.0386s/iter; left time: 1803.3163s
	iters: 300, epoch: 1 | loss: 0.6011503
	speed: 0.0362s/iter; left time: 1684.7870s
	iters: 400, epoch: 1 | loss: 0.3293905
	speed: 0.0389s/iter; left time: 1810.1245s
Epoch: 1 cost time: 19.144463539123535
Epoch: 1, Steps: 469 | Train Loss: 0.959 Vali Loss: 0.456 Vali Acc: 0.858 Test Loss: 0.456 Test Acc: 0.858
Validation loss decreased (inf --> -0.857914).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1374253
	speed: 0.1562s/iter; left time: 7236.5796s
	iters: 200, epoch: 2 | loss: 0.2874058
	speed: 0.0388s/iter; left time: 1792.6218s
	iters: 300, epoch: 2 | loss: 0.5829068
	speed: 0.0354s/iter; left time: 1631.4861s
	iters: 400, epoch: 2 | loss: 0.2451646
	speed: 0.0320s/iter; left time: 1473.3966s
Epoch: 2 cost time: 16.916542053222656
Epoch: 2, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.857914 --> -0.940821).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2437718
	speed: 0.1480s/iter; left time: 6787.3896s
	iters: 200, epoch: 3 | loss: 0.1995965
	speed: 0.0337s/iter; left time: 1542.5014s
	iters: 300, epoch: 3 | loss: 0.0338604
	speed: 0.0367s/iter; left time: 1674.1533s
	iters: 400, epoch: 3 | loss: 0.0303618
	speed: 0.0373s/iter; left time: 1698.6737s
Epoch: 3 cost time: 17.39285373687744
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0483985
	speed: 0.1568s/iter; left time: 7116.7216s
	iters: 200, epoch: 4 | loss: 0.0493842
	speed: 0.0379s/iter; left time: 1717.9201s
	iters: 300, epoch: 4 | loss: 0.0485428
	speed: 0.0375s/iter; left time: 1692.9444s
	iters: 400, epoch: 4 | loss: 0.1320330
	speed: 0.0376s/iter; left time: 1697.4612s
Epoch: 4 cost time: 18.33195471763611
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.940821 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0832990
	speed: 0.1574s/iter; left time: 7068.9657s
	iters: 200, epoch: 5 | loss: 0.0616333
	speed: 0.0405s/iter; left time: 1817.5038s
	iters: 300, epoch: 5 | loss: 0.1100552
	speed: 0.0378s/iter; left time: 1689.8718s
	iters: 400, epoch: 5 | loss: 0.0363050
	speed: 0.0365s/iter; left time: 1630.4534s
Epoch: 5 cost time: 18.25289535522461
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0113912
	speed: 0.1607s/iter; left time: 7145.9118s
	iters: 200, epoch: 6 | loss: 0.0137822
	speed: 0.0386s/iter; left time: 1713.5138s
	iters: 300, epoch: 6 | loss: 0.0722539
	speed: 0.0365s/iter; left time: 1613.4372s
	iters: 400, epoch: 6 | loss: 0.0666529
	speed: 0.0368s/iter; left time: 1626.3046s
Epoch: 6 cost time: 17.653494358062744
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0090191
	speed: 0.1530s/iter; left time: 6728.0890s
	iters: 200, epoch: 7 | loss: 0.0138673
	speed: 0.0354s/iter; left time: 1551.9362s
	iters: 300, epoch: 7 | loss: 0.0814603
	speed: 0.0387s/iter; left time: 1696.4330s
	iters: 400, epoch: 7 | loss: 0.0468225
	speed: 0.0379s/iter; left time: 1656.1198s
Epoch: 7 cost time: 17.788850784301758
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0463772
	speed: 0.1725s/iter; left time: 7508.5571s
	iters: 200, epoch: 8 | loss: 0.0624783
	speed: 0.0387s/iter; left time: 1678.1371s
	iters: 300, epoch: 8 | loss: 0.0215121
	speed: 0.0368s/iter; left time: 1592.1850s
	iters: 400, epoch: 8 | loss: 0.0111683
	speed: 0.0398s/iter; left time: 1717.9528s
Epoch: 8 cost time: 18.452566862106323
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0168006
	speed: 0.1668s/iter; left time: 7180.6433s
	iters: 200, epoch: 9 | loss: 0.0833227
	speed: 0.0302s/iter; left time: 1298.2378s
	iters: 300, epoch: 9 | loss: 0.0980282
	speed: 0.0320s/iter; left time: 1370.2051s
	iters: 400, epoch: 9 | loss: 0.4013694
	speed: 0.0289s/iter; left time: 1236.8552s
Epoch: 9 cost time: 15.443659782409668
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
Validation loss decreased (-0.963120 --> -0.965979).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0047677
	speed: 0.1473s/iter; left time: 6272.5143s
	iters: 200, epoch: 10 | loss: 0.0191942
	speed: 0.0384s/iter; left time: 1632.3715s
	iters: 300, epoch: 10 | loss: 0.0036362
	speed: 0.0389s/iter; left time: 1649.7142s
	iters: 400, epoch: 10 | loss: 0.0035199
	speed: 0.0382s/iter; left time: 1617.0585s
Epoch: 10 cost time: 18.651309967041016
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0041916
	speed: 0.1529s/iter; left time: 6439.6057s
	iters: 200, epoch: 11 | loss: 0.0273018
	speed: 0.0378s/iter; left time: 1589.4537s
	iters: 300, epoch: 11 | loss: 0.0403070
	speed: 0.0386s/iter; left time: 1619.6308s
	iters: 400, epoch: 11 | loss: 0.0017812
	speed: 0.0380s/iter; left time: 1587.4166s
Epoch: 11 cost time: 17.445131301879883
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0038900
	speed: 0.1488s/iter; left time: 6195.5924s
	iters: 200, epoch: 12 | loss: 0.2310465
	speed: 0.0371s/iter; left time: 1542.6674s
	iters: 300, epoch: 12 | loss: 0.0624473
	speed: 0.0376s/iter; left time: 1557.7239s
	iters: 400, epoch: 12 | loss: 0.0015937
	speed: 0.0370s/iter; left time: 1531.4336s
Epoch: 12 cost time: 17.803741931915283
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.965979 --> -0.973984).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0206802
	speed: 0.1553s/iter; left time: 6395.1555s
	iters: 200, epoch: 13 | loss: 0.0143966
	speed: 0.0364s/iter; left time: 1495.7952s
	iters: 300, epoch: 13 | loss: 0.0011441
	speed: 0.0365s/iter; left time: 1496.7963s
	iters: 400, epoch: 13 | loss: 0.0020749
	speed: 0.0342s/iter; left time: 1399.6000s
Epoch: 13 cost time: 17.579768896102905
Epoch: 13, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0049935
	speed: 0.1522s/iter; left time: 6193.7284s
	iters: 200, epoch: 14 | loss: 0.0085536
	speed: 0.0398s/iter; left time: 1616.5643s
	iters: 300, epoch: 14 | loss: 0.0315627
	speed: 0.0379s/iter; left time: 1535.5751s
	iters: 400, epoch: 14 | loss: 0.0152655
	speed: 0.0368s/iter; left time: 1487.8299s
Epoch: 14 cost time: 17.84976577758789
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0032443
	speed: 0.1554s/iter; left time: 6252.3506s
	iters: 200, epoch: 15 | loss: 0.0035435
	speed: 0.0369s/iter; left time: 1482.0116s
	iters: 300, epoch: 15 | loss: 0.0031059
	speed: 0.0390s/iter; left time: 1562.0577s
	iters: 400, epoch: 15 | loss: 0.0205996
	speed: 0.0399s/iter; left time: 1592.1256s
Epoch: 15 cost time: 18.316736459732056
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974842).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0041854
	speed: 0.1540s/iter; left time: 6122.1641s
	iters: 200, epoch: 16 | loss: 0.1324899
	speed: 0.0363s/iter; left time: 1439.8234s
	iters: 300, epoch: 16 | loss: 0.0011693
	speed: 0.0393s/iter; left time: 1553.5457s
	iters: 400, epoch: 16 | loss: 0.1829202
	speed: 0.0399s/iter; left time: 1575.6681s
Epoch: 16 cost time: 18.446075916290283
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0147844
	speed: 0.1461s/iter; left time: 5739.8783s
	iters: 200, epoch: 17 | loss: 0.0090571
	speed: 0.0374s/iter; left time: 1465.6003s
	iters: 300, epoch: 17 | loss: 0.0007798
	speed: 0.0373s/iter; left time: 1459.5483s
	iters: 400, epoch: 17 | loss: 0.0003780
	speed: 0.0393s/iter; left time: 1532.5139s
Epoch: 17 cost time: 18.26608657836914
Epoch: 17, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0639563
	speed: 0.1775s/iter; left time: 6890.3274s
	iters: 200, epoch: 18 | loss: 0.0058502
	speed: 0.0397s/iter; left time: 1537.5808s
	iters: 300, epoch: 18 | loss: 0.0028860
	speed: 0.0392s/iter; left time: 1513.7204s
	iters: 400, epoch: 18 | loss: 0.0157985
	speed: 0.0397s/iter; left time: 1529.6210s
Epoch: 18 cost time: 18.77665090560913
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0003094
	speed: 0.1598s/iter; left time: 6131.4663s
	iters: 200, epoch: 19 | loss: 0.1332860
	speed: 0.0387s/iter; left time: 1479.1878s
	iters: 300, epoch: 19 | loss: 0.0222583
	speed: 0.0382s/iter; left time: 1457.2154s
	iters: 400, epoch: 19 | loss: 0.0542164
	speed: 0.0405s/iter; left time: 1543.1523s
Epoch: 19 cost time: 19.204418182373047
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0039322
	speed: 0.1768s/iter; left time: 6700.6476s
	iters: 200, epoch: 20 | loss: 0.2351976
	speed: 0.0389s/iter; left time: 1468.3665s
	iters: 300, epoch: 20 | loss: 0.0352319
	speed: 0.0367s/iter; left time: 1381.5083s
	iters: 400, epoch: 20 | loss: 0.0006687
	speed: 0.0363s/iter; left time: 1363.1222s
Epoch: 20 cost time: 18.458966732025146
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0052361
	speed: 0.1636s/iter; left time: 6120.8306s
	iters: 200, epoch: 21 | loss: 0.0011527
	speed: 0.0387s/iter; left time: 1444.6176s
	iters: 300, epoch: 21 | loss: 0.2838947
	speed: 0.0393s/iter; left time: 1461.6730s
	iters: 400, epoch: 21 | loss: 0.2248167
	speed: 0.0361s/iter; left time: 1340.3186s
Epoch: 21 cost time: 18.020102500915527
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0005217
	speed: 0.1529s/iter; left time: 5650.0164s
	iters: 200, epoch: 22 | loss: 0.0014521
	speed: 0.0358s/iter; left time: 1318.0564s
	iters: 300, epoch: 22 | loss: 0.0060911
	speed: 0.0373s/iter; left time: 1369.9001s
	iters: 400, epoch: 22 | loss: 0.0023355
	speed: 0.0377s/iter; left time: 1383.3689s
Epoch: 22 cost time: 17.706631422042847
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0002705
	speed: 0.1619s/iter; left time: 5906.5367s
	iters: 200, epoch: 23 | loss: 0.0020664
	speed: 0.0372s/iter; left time: 1353.4397s
	iters: 300, epoch: 23 | loss: 0.0092345
	speed: 0.0370s/iter; left time: 1342.6972s
	iters: 400, epoch: 23 | loss: 0.0049930
	speed: 0.0393s/iter; left time: 1420.5606s
Epoch: 23 cost time: 18.239208459854126
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0285047
	speed: 0.1484s/iter; left time: 5342.9147s
	iters: 200, epoch: 24 | loss: 0.0005198
	speed: 0.0378s/iter; left time: 1357.1575s
	iters: 300, epoch: 24 | loss: 0.0281720
	speed: 0.0370s/iter; left time: 1323.7657s
	iters: 400, epoch: 24 | loss: 0.0004607
	speed: 0.0386s/iter; left time: 1379.1686s
Epoch: 24 cost time: 17.885189056396484
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.974842 --> -0.978844).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0003975
	speed: 0.1628s/iter; left time: 5786.1754s
	iters: 200, epoch: 25 | loss: 0.0355407
	speed: 0.0376s/iter; left time: 1331.1568s
	iters: 300, epoch: 25 | loss: 0.0001533
	speed: 0.0360s/iter; left time: 1274.0353s
	iters: 400, epoch: 25 | loss: 0.0006880
	speed: 0.0372s/iter; left time: 1312.7501s
Epoch: 25 cost time: 17.493054628372192
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0061206
	speed: 0.1561s/iter; left time: 5475.2816s
	iters: 200, epoch: 26 | loss: 0.0005811
	speed: 0.0363s/iter; left time: 1269.8827s
	iters: 300, epoch: 26 | loss: 0.0003625
	speed: 0.0382s/iter; left time: 1332.8153s
	iters: 400, epoch: 26 | loss: 0.0128708
	speed: 0.0381s/iter; left time: 1325.0681s
Epoch: 26 cost time: 17.588721990585327
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0004827
	speed: 0.1586s/iter; left time: 5489.1895s
	iters: 200, epoch: 27 | loss: 0.0128345
	speed: 0.0350s/iter; left time: 1207.7879s
	iters: 300, epoch: 27 | loss: 0.0004569
	speed: 0.0372s/iter; left time: 1280.5070s
	iters: 400, epoch: 27 | loss: 0.0039321
	speed: 0.0387s/iter; left time: 1326.1609s
Epoch: 27 cost time: 17.74665904045105
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0118438
	speed: 0.1722s/iter; left time: 5879.8195s
	iters: 200, epoch: 28 | loss: 0.0015032
	speed: 0.0388s/iter; left time: 1320.2270s
	iters: 300, epoch: 28 | loss: 0.0018612
	speed: 0.0369s/iter; left time: 1253.0062s
	iters: 400, epoch: 28 | loss: 0.0015470
	speed: 0.0353s/iter; left time: 1196.0196s
Epoch: 28 cost time: 18.17552161216736
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0004042
	speed: 0.1255s/iter; left time: 4225.8910s
	iters: 200, epoch: 29 | loss: 0.0008797
	speed: 0.0318s/iter; left time: 1066.3549s
	iters: 300, epoch: 29 | loss: 0.0002361
	speed: 0.0313s/iter; left time: 1049.0720s
	iters: 400, epoch: 29 | loss: 0.0003497
	speed: 0.0362s/iter; left time: 1208.5160s
Epoch: 29 cost time: 16.235859632492065
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0022965
	speed: 0.1720s/iter; left time: 5711.1282s
	iters: 200, epoch: 30 | loss: 0.0002604
	speed: 0.0358s/iter; left time: 1184.3697s
	iters: 300, epoch: 30 | loss: 0.0002104
	speed: 0.0369s/iter; left time: 1216.5238s
	iters: 400, epoch: 30 | loss: 0.0013929
	speed: 0.0346s/iter; left time: 1139.8850s
Epoch: 30 cost time: 17.107393741607666
Epoch: 30, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0017266
	speed: 0.1387s/iter; left time: 4538.1672s
	iters: 200, epoch: 31 | loss: 0.0001562
	speed: 0.0360s/iter; left time: 1175.3054s
	iters: 300, epoch: 31 | loss: 0.0006628
	speed: 0.0356s/iter; left time: 1158.2747s
	iters: 400, epoch: 31 | loss: 0.0002492
	speed: 0.0384s/iter; left time: 1244.1576s
Epoch: 31 cost time: 17.466650247573853
Epoch: 31, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0015603
	speed: 0.1496s/iter; left time: 4826.4353s
	iters: 200, epoch: 32 | loss: 0.0203126
	speed: 0.0381s/iter; left time: 1225.7416s
	iters: 300, epoch: 32 | loss: 0.0011272
	speed: 0.0348s/iter; left time: 1117.1781s
	iters: 400, epoch: 32 | loss: 0.0003601
	speed: 0.0350s/iter; left time: 1118.5683s
Epoch: 32 cost time: 17.39875292778015
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0003301
	speed: 0.1507s/iter; left time: 4791.7122s
	iters: 200, epoch: 33 | loss: 0.0012506
	speed: 0.0338s/iter; left time: 1072.3193s
	iters: 300, epoch: 33 | loss: 0.0010825
	speed: 0.0370s/iter; left time: 1169.1778s
	iters: 400, epoch: 33 | loss: 0.0006639
	speed: 0.0359s/iter; left time: 1130.7833s
Epoch: 33 cost time: 16.995309352874756
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0098865
	speed: 0.1587s/iter; left time: 4972.3106s
	iters: 200, epoch: 34 | loss: 0.0031374
	speed: 0.0366s/iter; left time: 1144.0553s
	iters: 300, epoch: 34 | loss: 0.0017954
	speed: 0.0357s/iter; left time: 1112.0906s
	iters: 400, epoch: 34 | loss: 0.0523985
	speed: 0.0378s/iter; left time: 1173.5003s
Epoch: 34 cost time: 17.730634927749634
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 172302
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3300582
	speed: 0.0523s/iter; left time: 2446.7030s
	iters: 200, epoch: 1 | loss: 0.8203778
	speed: 0.0371s/iter; left time: 1733.4883s
	iters: 300, epoch: 1 | loss: 0.6287106
	speed: 0.0377s/iter; left time: 1758.4146s
	iters: 400, epoch: 1 | loss: 0.3936202
	speed: 0.0385s/iter; left time: 1792.3178s
Epoch: 1 cost time: 19.178850889205933
Epoch: 1, Steps: 469 | Train Loss: 1.032 Vali Loss: 0.442 Vali Acc: 0.868 Test Loss: 0.442 Test Acc: 0.868
Validation loss decreased (inf --> -0.867920).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4854790
	speed: 0.1619s/iter; left time: 7499.0900s
	iters: 200, epoch: 2 | loss: 0.3001914
	speed: 0.0362s/iter; left time: 1672.1273s
	iters: 300, epoch: 2 | loss: 0.1076349
	speed: 0.0398s/iter; left time: 1837.7651s
	iters: 400, epoch: 2 | loss: 0.2190231
	speed: 0.0371s/iter; left time: 1708.3479s
Epoch: 2 cost time: 18.003093481063843
Epoch: 2, Steps: 469 | Train Loss: 0.237 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
Validation loss decreased (-0.867920 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0692779
	speed: 0.1771s/iter; left time: 8123.4508s
	iters: 200, epoch: 3 | loss: 0.0468622
	speed: 0.0395s/iter; left time: 1807.2356s
	iters: 300, epoch: 3 | loss: 0.0799630
	speed: 0.0400s/iter; left time: 1824.5153s
	iters: 400, epoch: 3 | loss: 0.0568228
	speed: 0.0393s/iter; left time: 1790.1443s
Epoch: 3 cost time: 18.81407642364502
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.946825 --> -0.949684).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0363903
	speed: 0.1702s/iter; left time: 7724.5751s
	iters: 200, epoch: 4 | loss: 0.0700901
	speed: 0.0401s/iter; left time: 1817.0456s
	iters: 300, epoch: 4 | loss: 0.0996542
	speed: 0.0424s/iter; left time: 1914.6163s
	iters: 400, epoch: 4 | loss: 0.0657462
	speed: 0.0451s/iter; left time: 2035.2060s
Epoch: 4 cost time: 20.563268184661865
Epoch: 4, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0947395
	speed: 0.2158s/iter; left time: 9693.9910s
	iters: 200, epoch: 5 | loss: 0.1655649
	speed: 0.0434s/iter; left time: 1946.6524s
	iters: 300, epoch: 5 | loss: 0.0118325
	speed: 0.0454s/iter; left time: 2032.4931s
	iters: 400, epoch: 5 | loss: 0.0319972
	speed: 0.0442s/iter; left time: 1970.9280s
Epoch: 5 cost time: 21.04778814315796
Epoch: 5, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.949684 --> -0.967980).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0989464
	speed: 0.1929s/iter; left time: 8576.8149s
	iters: 200, epoch: 6 | loss: 0.0512294
	speed: 0.0442s/iter; left time: 1960.7540s
	iters: 300, epoch: 6 | loss: 0.0246319
	speed: 0.0457s/iter; left time: 2021.1753s
	iters: 400, epoch: 6 | loss: 0.0062892
	speed: 0.0468s/iter; left time: 2067.5119s
Epoch: 6 cost time: 22.202330350875854
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.348 Vali Acc: 0.920 Test Loss: 0.348 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0486351
	speed: 0.1989s/iter; left time: 8748.3088s
	iters: 200, epoch: 7 | loss: 0.0802924
	speed: 0.0412s/iter; left time: 1807.2838s
	iters: 300, epoch: 7 | loss: 0.0213490
	speed: 0.0436s/iter; left time: 1907.4326s
	iters: 400, epoch: 7 | loss: 0.0596426
	speed: 0.0420s/iter; left time: 1836.9493s
Epoch: 7 cost time: 20.381271362304688
Epoch: 7, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0021034
	speed: 0.2020s/iter; left time: 8791.2644s
	iters: 200, epoch: 8 | loss: 0.0029746
	speed: 0.0452s/iter; left time: 1962.7306s
	iters: 300, epoch: 8 | loss: 0.1039096
	speed: 0.0463s/iter; left time: 2004.6765s
	iters: 400, epoch: 8 | loss: 0.0445741
	speed: 0.0406s/iter; left time: 1755.4524s
Epoch: 8 cost time: 21.142459869384766
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0035643
	speed: 0.1649s/iter; left time: 7097.4790s
	iters: 200, epoch: 9 | loss: 0.0554157
	speed: 0.0398s/iter; left time: 1708.9634s
	iters: 300, epoch: 9 | loss: 0.0030694
	speed: 0.0373s/iter; left time: 1597.6443s
	iters: 400, epoch: 9 | loss: 0.0034948
	speed: 0.0355s/iter; left time: 1517.7135s
Epoch: 9 cost time: 18.063323736190796
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0078539
	speed: 0.1771s/iter; left time: 7542.9460s
	iters: 200, epoch: 10 | loss: 0.1435412
	speed: 0.0403s/iter; left time: 1713.7185s
	iters: 300, epoch: 10 | loss: 0.1469550
	speed: 0.0372s/iter; left time: 1577.6519s
	iters: 400, epoch: 10 | loss: 0.0108844
	speed: 0.0367s/iter; left time: 1552.4610s
Epoch: 10 cost time: 18.203951120376587
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1172505
	speed: 0.1587s/iter; left time: 6682.1968s
	iters: 200, epoch: 11 | loss: 0.0217001
	speed: 0.0377s/iter; left time: 1585.9058s
	iters: 300, epoch: 11 | loss: 0.0675929
	speed: 0.0388s/iter; left time: 1627.8406s
	iters: 400, epoch: 11 | loss: 0.1623988
	speed: 0.0370s/iter; left time: 1547.7076s
Epoch: 11 cost time: 17.793646574020386
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0016837
	speed: 0.1753s/iter; left time: 7300.4364s
	iters: 200, epoch: 12 | loss: 0.0291138
	speed: 0.0398s/iter; left time: 1652.9640s
	iters: 300, epoch: 12 | loss: 0.0008424
	speed: 0.0392s/iter; left time: 1623.5144s
	iters: 400, epoch: 12 | loss: 0.0079641
	speed: 0.0395s/iter; left time: 1634.0611s
Epoch: 12 cost time: 18.779156923294067
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0070914
	speed: 0.1702s/iter; left time: 7007.1844s
	iters: 200, epoch: 13 | loss: 0.0221684
	speed: 0.0388s/iter; left time: 1593.3634s
	iters: 300, epoch: 13 | loss: 0.0261234
	speed: 0.0375s/iter; left time: 1535.8944s
	iters: 400, epoch: 13 | loss: 0.0940401
	speed: 0.0365s/iter; left time: 1490.2610s
Epoch: 13 cost time: 18.356701612472534
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.967980 --> -0.969982).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0040138
	speed: 0.1730s/iter; left time: 7043.7184s
	iters: 200, epoch: 14 | loss: 0.0012772
	speed: 0.0376s/iter; left time: 1528.5059s
	iters: 300, epoch: 14 | loss: 0.3040318
	speed: 0.0396s/iter; left time: 1604.0986s
	iters: 400, epoch: 14 | loss: 0.0025432
	speed: 0.0360s/iter; left time: 1452.9640s
Epoch: 14 cost time: 18.092795372009277
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0232093
	speed: 0.1524s/iter; left time: 6132.3638s
	iters: 200, epoch: 15 | loss: 0.0007058
	speed: 0.0363s/iter; left time: 1457.3694s
	iters: 300, epoch: 15 | loss: 0.0010963
	speed: 0.0352s/iter; left time: 1408.1137s
	iters: 400, epoch: 15 | loss: 0.0096683
	speed: 0.0345s/iter; left time: 1378.1454s
Epoch: 15 cost time: 17.104926109313965
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.969982 --> -0.975128).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0020522
	speed: 0.1710s/iter; left time: 6800.0308s
	iters: 200, epoch: 16 | loss: 0.0159507
	speed: 0.0392s/iter; left time: 1553.0761s
	iters: 300, epoch: 16 | loss: 0.0449230
	speed: 0.0384s/iter; left time: 1517.7402s
	iters: 400, epoch: 16 | loss: 0.0029388
	speed: 0.0412s/iter; left time: 1626.7918s
Epoch: 16 cost time: 19.250210523605347
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0013193
	speed: 0.1846s/iter; left time: 7254.1608s
	iters: 200, epoch: 17 | loss: 0.0023685
	speed: 0.0442s/iter; left time: 1732.2469s
	iters: 300, epoch: 17 | loss: 0.0023446
	speed: 0.0454s/iter; left time: 1775.3448s
	iters: 400, epoch: 17 | loss: 0.0507460
	speed: 0.0438s/iter; left time: 1706.1405s
Epoch: 17 cost time: 21.11164164543152
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0219349
	speed: 0.2039s/iter; left time: 7916.1871s
	iters: 200, epoch: 18 | loss: 0.1421877
	speed: 0.0523s/iter; left time: 2024.2495s
	iters: 300, epoch: 18 | loss: 0.0021581
	speed: 0.0526s/iter; left time: 2030.7682s
	iters: 400, epoch: 18 | loss: 0.0567651
	speed: 0.0512s/iter; left time: 1974.4789s
Epoch: 18 cost time: 24.392311334609985
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0011096
	speed: 0.2349s/iter; left time: 9011.3748s
	iters: 200, epoch: 19 | loss: 0.0393317
	speed: 0.0487s/iter; left time: 1861.7622s
	iters: 300, epoch: 19 | loss: 0.0029164
	speed: 0.0500s/iter; left time: 1908.8047s
	iters: 400, epoch: 19 | loss: 0.0095951
	speed: 0.0537s/iter; left time: 2045.2541s
Epoch: 19 cost time: 24.321427583694458
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0066873
	speed: 0.2377s/iter; left time: 9004.5985s
	iters: 200, epoch: 20 | loss: 0.0024827
	speed: 0.0536s/iter; left time: 2026.9369s
	iters: 300, epoch: 20 | loss: 0.6609646
	speed: 0.0560s/iter; left time: 2111.3898s
	iters: 400, epoch: 20 | loss: 0.0025236
	speed: 0.0517s/iter; left time: 1944.0980s
Epoch: 20 cost time: 25.571900606155396
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.250 Vali Acc: 0.945 Test Loss: 0.250 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0007024
	speed: 0.2451s/iter; left time: 9172.2592s
	iters: 200, epoch: 21 | loss: 0.0036577
	speed: 0.0482s/iter; left time: 1798.6157s
	iters: 300, epoch: 21 | loss: 0.0008872
	speed: 0.0536s/iter; left time: 1993.2760s
	iters: 400, epoch: 21 | loss: 0.0006870
	speed: 0.0501s/iter; left time: 1859.0990s
Epoch: 21 cost time: 24.559770584106445
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0118505
	speed: 0.2632s/iter; left time: 9725.4629s
	iters: 200, epoch: 22 | loss: 0.2430439
	speed: 0.0548s/iter; left time: 2019.0729s
	iters: 300, epoch: 22 | loss: 0.1196560
	speed: 0.0599s/iter; left time: 2200.5736s
	iters: 400, epoch: 22 | loss: 0.0224616
	speed: 0.0625s/iter; left time: 2289.8780s
Epoch: 22 cost time: 27.68001914024353
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0059624
	speed: 0.2496s/iter; left time: 9106.0176s
	iters: 200, epoch: 23 | loss: 0.0340149
	speed: 0.0489s/iter; left time: 1778.5750s
	iters: 300, epoch: 23 | loss: 0.0014655
	speed: 0.0526s/iter; left time: 1907.4711s
	iters: 400, epoch: 23 | loss: 0.0158463
	speed: 0.0597s/iter; left time: 2158.4958s
Epoch: 23 cost time: 26.42774271965027
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0032226
	speed: 0.2826s/iter; left time: 10177.9485s
	iters: 200, epoch: 24 | loss: 0.1378522
	speed: 0.0681s/iter; left time: 2445.0488s
	iters: 300, epoch: 24 | loss: 0.0005507
	speed: 0.0643s/iter; left time: 2302.4880s
	iters: 400, epoch: 24 | loss: 0.0282724
	speed: 0.0646s/iter; left time: 2305.7359s
Epoch: 24 cost time: 28.988731861114502
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0051565
	speed: 0.1685s/iter; left time: 5989.8709s
	iters: 200, epoch: 25 | loss: 0.0067431
	speed: 0.0399s/iter; left time: 1415.8460s
	iters: 300, epoch: 25 | loss: 0.0057828
	speed: 0.0390s/iter; left time: 1377.0793s
	iters: 400, epoch: 25 | loss: 0.0015783
	speed: 0.0411s/iter; left time: 1446.8451s
Epoch: 25 cost time: 19.184925079345703
Epoch: 25, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 172238
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5306293
	speed: 0.0492s/iter; left time: 2302.0743s
	iters: 200, epoch: 1 | loss: 0.8213375
	speed: 0.0377s/iter; left time: 1762.3904s
	iters: 300, epoch: 1 | loss: 0.3563925
	speed: 0.0370s/iter; left time: 1725.6789s
	iters: 400, epoch: 1 | loss: 0.3803884
	speed: 0.0373s/iter; left time: 1736.2265s
Epoch: 1 cost time: 18.824880123138428
Epoch: 1, Steps: 469 | Train Loss: 0.997 Vali Loss: 0.410 Vali Acc: 0.869 Test Loss: 0.410 Test Acc: 0.869
Validation loss decreased (inf --> -0.868778).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1350520
	speed: 0.1620s/iter; left time: 7504.9806s
	iters: 200, epoch: 2 | loss: 0.5181136
	speed: 0.0366s/iter; left time: 1692.2772s
	iters: 300, epoch: 2 | loss: 0.1038248
	speed: 0.0382s/iter; left time: 1760.7097s
	iters: 400, epoch: 2 | loss: 0.5376518
	speed: 0.0383s/iter; left time: 1761.6793s
Epoch: 2 cost time: 17.72373604774475
Epoch: 2, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.316 Vali Acc: 0.898 Test Loss: 0.316 Test Acc: 0.898
Validation loss decreased (-0.868778 --> -0.898224).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1793350
	speed: 0.1476s/iter; left time: 6770.6329s
	iters: 200, epoch: 3 | loss: 0.1478502
	speed: 0.0373s/iter; left time: 1704.8766s
	iters: 300, epoch: 3 | loss: 0.0557089
	speed: 0.0371s/iter; left time: 1695.9576s
	iters: 400, epoch: 3 | loss: 0.0936994
	speed: 0.0369s/iter; left time: 1679.6011s
Epoch: 3 cost time: 18.188137769699097
Epoch: 3, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.898224 --> -0.940821).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0326319
	speed: 0.1640s/iter; left time: 7445.1983s
	iters: 200, epoch: 4 | loss: 0.3565762
	speed: 0.0412s/iter; left time: 1866.2531s
	iters: 300, epoch: 4 | loss: 0.0530166
	speed: 0.0383s/iter; left time: 1732.7012s
	iters: 400, epoch: 4 | loss: 0.0084960
	speed: 0.0365s/iter; left time: 1647.4633s
Epoch: 4 cost time: 18.20902442932129
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.940821 --> -0.945682).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0183963
	speed: 0.1729s/iter; left time: 7765.4332s
	iters: 200, epoch: 5 | loss: 0.0198273
	speed: 0.0539s/iter; left time: 2415.2001s
	iters: 300, epoch: 5 | loss: 0.1730888
	speed: 0.0508s/iter; left time: 2270.1730s
	iters: 400, epoch: 5 | loss: 0.0254716
	speed: 0.0497s/iter; left time: 2219.2319s
Epoch: 5 cost time: 24.895010232925415
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.945682 --> -0.963120).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0185757
	speed: 0.3469s/iter; left time: 15421.6147s
	iters: 200, epoch: 6 | loss: 0.1908023
	speed: 0.0761s/iter; left time: 3376.3851s
	iters: 300, epoch: 6 | loss: 0.0540281
	speed: 0.0647s/iter; left time: 2863.6852s
	iters: 400, epoch: 6 | loss: 0.0178154
	speed: 0.0623s/iter; left time: 2752.9445s
Epoch: 6 cost time: 32.027448892593384
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.963120 --> -0.964836).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0141387
	speed: 0.3086s/iter; left time: 13574.4715s
	iters: 200, epoch: 7 | loss: 0.1024125
	speed: 0.0601s/iter; left time: 2638.9082s
	iters: 300, epoch: 7 | loss: 0.0118858
	speed: 0.0581s/iter; left time: 2542.4862s
	iters: 400, epoch: 7 | loss: 0.0049905
	speed: 0.0548s/iter; left time: 2392.1534s
Epoch: 7 cost time: 27.85271692276001
Epoch: 7, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.964836 --> -0.967695).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0346705
	speed: 0.2901s/iter; left time: 12624.6324s
	iters: 200, epoch: 8 | loss: 0.0067910
	speed: 0.0653s/iter; left time: 2833.0308s
	iters: 300, epoch: 8 | loss: 0.0034468
	speed: 0.0666s/iter; left time: 2885.9895s
	iters: 400, epoch: 8 | loss: 0.0076830
	speed: 0.0727s/iter; left time: 3142.3715s
Epoch: 8 cost time: 32.26387429237366
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0023772
	speed: 0.3115s/iter; left time: 13411.7264s
	iters: 200, epoch: 9 | loss: 0.0084224
	speed: 0.0553s/iter; left time: 2374.6204s
	iters: 300, epoch: 9 | loss: 0.0029094
	speed: 0.0588s/iter; left time: 2517.4707s
	iters: 400, epoch: 9 | loss: 0.2794914
	speed: 0.0554s/iter; left time: 2370.3898s
Epoch: 9 cost time: 27.42753767967224
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0123274
	speed: 0.2990s/iter; left time: 12732.3272s
	iters: 200, epoch: 10 | loss: 0.0654151
	speed: 0.0629s/iter; left time: 2670.7927s
	iters: 300, epoch: 10 | loss: 0.1223501
	speed: 0.0648s/iter; left time: 2744.9946s
	iters: 400, epoch: 10 | loss: 0.0139297
	speed: 0.0651s/iter; left time: 2754.4607s
Epoch: 10 cost time: 29.486862182617188
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.967695 --> -0.971411).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0355447
	speed: 0.2866s/iter; left time: 12068.3986s
	iters: 200, epoch: 11 | loss: 0.0124556
	speed: 0.0665s/iter; left time: 2794.8480s
	iters: 300, epoch: 11 | loss: 0.0079921
	speed: 0.0621s/iter; left time: 2600.6518s
	iters: 400, epoch: 11 | loss: 0.0018089
	speed: 0.0642s/iter; left time: 2684.1239s
Epoch: 11 cost time: 30.24246597290039
Epoch: 11, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0526420
	speed: 0.3358s/iter; left time: 13983.0435s
	iters: 200, epoch: 12 | loss: 0.0139361
	speed: 0.0737s/iter; left time: 3061.8888s
	iters: 300, epoch: 12 | loss: 0.0061994
	speed: 0.0705s/iter; left time: 2923.2410s
	iters: 400, epoch: 12 | loss: 0.0268120
	speed: 0.0617s/iter; left time: 2551.2748s
Epoch: 12 cost time: 34.52427053451538
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0641995
	speed: 0.3457s/iter; left time: 14231.6302s
	iters: 200, epoch: 13 | loss: 0.1348826
	speed: 0.0643s/iter; left time: 2639.1274s
	iters: 300, epoch: 13 | loss: 0.0012324
	speed: 0.0596s/iter; left time: 2442.8855s
	iters: 400, epoch: 13 | loss: 0.0111596
	speed: 0.0646s/iter; left time: 2639.7922s
Epoch: 13 cost time: 31.012640953063965
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0016628
	speed: 0.2919s/iter; left time: 11880.3193s
	iters: 200, epoch: 14 | loss: 0.0416740
	speed: 0.0500s/iter; left time: 2030.3289s
	iters: 300, epoch: 14 | loss: 0.4654544
	speed: 0.0549s/iter; left time: 2225.6919s
	iters: 400, epoch: 14 | loss: 0.0045846
	speed: 0.0642s/iter; left time: 2595.4507s
Epoch: 14 cost time: 27.41271162033081
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0127882
	speed: 0.3065s/iter; left time: 12333.5951s
	iters: 200, epoch: 15 | loss: 0.0251821
	speed: 0.0612s/iter; left time: 2455.6842s
	iters: 300, epoch: 15 | loss: 0.0091739
	speed: 0.0647s/iter; left time: 2591.1367s
	iters: 400, epoch: 15 | loss: 0.0826351
	speed: 0.0668s/iter; left time: 2667.3228s
Epoch: 15 cost time: 30.74333953857422
Epoch: 15, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.971411 --> -0.976557).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0032194
	speed: 0.3269s/iter; left time: 13000.6138s
	iters: 200, epoch: 16 | loss: 0.0024592
	speed: 0.0660s/iter; left time: 2619.0889s
	iters: 300, epoch: 16 | loss: 0.1042963
	speed: 0.0620s/iter; left time: 2451.8345s
	iters: 400, epoch: 16 | loss: 0.1042021
	speed: 0.0606s/iter; left time: 2391.9048s
Epoch: 16 cost time: 30.453454971313477
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0014151
	speed: 0.2692s/iter; left time: 10580.1176s
	iters: 200, epoch: 17 | loss: 0.0098269
	speed: 0.0689s/iter; left time: 2700.8318s
	iters: 300, epoch: 17 | loss: 0.0269516
	speed: 0.0660s/iter; left time: 2581.7044s
	iters: 400, epoch: 17 | loss: 0.0027339
	speed: 0.0715s/iter; left time: 2787.7678s
Epoch: 17 cost time: 31.230509519577026
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0007104
	speed: 0.2902s/iter; left time: 11267.2113s
	iters: 200, epoch: 18 | loss: 0.0108969
	speed: 0.0553s/iter; left time: 2142.6118s
	iters: 300, epoch: 18 | loss: 0.1509743
	speed: 0.0584s/iter; left time: 2253.9887s
	iters: 400, epoch: 18 | loss: 0.0731614
	speed: 0.0616s/iter; left time: 2373.9637s
Epoch: 18 cost time: 28.1021409034729
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0181366
	speed: 0.2850s/iter; left time: 10930.9681s
	iters: 200, epoch: 19 | loss: 0.0230033
	speed: 0.0557s/iter; left time: 2130.2484s
	iters: 300, epoch: 19 | loss: 0.2586319
	speed: 0.0563s/iter; left time: 2149.0259s
	iters: 400, epoch: 19 | loss: 0.0219842
	speed: 0.0649s/iter; left time: 2468.6631s
Epoch: 19 cost time: 28.103821277618408
Epoch: 19, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0332470
	speed: 0.2952s/iter; left time: 11185.7763s
	iters: 200, epoch: 20 | loss: 0.0027388
	speed: 0.0630s/iter; left time: 2379.2661s
	iters: 300, epoch: 20 | loss: 0.0133202
	speed: 0.0658s/iter; left time: 2480.5896s
	iters: 400, epoch: 20 | loss: 0.0032506
	speed: 0.0690s/iter; left time: 2594.7942s
Epoch: 20 cost time: 30.69303059577942
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0046677
	speed: 0.3218s/iter; left time: 12041.3386s
	iters: 200, epoch: 21 | loss: 0.0065951
	speed: 0.0689s/iter; left time: 2572.4989s
	iters: 300, epoch: 21 | loss: 0.0247251
	speed: 0.0711s/iter; left time: 2647.4096s
	iters: 400, epoch: 21 | loss: 0.0022057
	speed: 0.0655s/iter; left time: 2433.2784s
Epoch: 21 cost time: 32.56830358505249
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0063289
	speed: 0.2864s/iter; left time: 10583.7785s
	iters: 200, epoch: 22 | loss: 0.0025383
	speed: 0.0583s/iter; left time: 2148.6445s
	iters: 300, epoch: 22 | loss: 0.0156514
	speed: 0.0602s/iter; left time: 2213.3336s
	iters: 400, epoch: 22 | loss: 0.0552890
	speed: 0.0597s/iter; left time: 2187.6258s
Epoch: 22 cost time: 28.586167573928833
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0022831
	speed: 0.2667s/iter; left time: 9731.6110s
	iters: 200, epoch: 23 | loss: 0.0053625
	speed: 0.0530s/iter; left time: 1926.8342s
	iters: 300, epoch: 23 | loss: 0.0053334
	speed: 0.0554s/iter; left time: 2009.7560s
	iters: 400, epoch: 23 | loss: 0.0015253
	speed: 0.0551s/iter; left time: 1992.8511s
Epoch: 23 cost time: 25.725765228271484
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1961309
	speed: 0.2883s/iter; left time: 10381.6680s
	iters: 200, epoch: 24 | loss: 0.0218242
	speed: 0.0639s/iter; left time: 2293.9174s
	iters: 300, epoch: 24 | loss: 0.0007218
	speed: 0.0638s/iter; left time: 2284.6616s
	iters: 400, epoch: 24 | loss: 0.0109483
	speed: 0.0586s/iter; left time: 2092.5354s
Epoch: 24 cost time: 28.82365894317627
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0087847
	speed: 0.2686s/iter; left time: 9547.5255s
	iters: 200, epoch: 25 | loss: 0.0254722
	speed: 0.0562s/iter; left time: 1990.2455s
	iters: 300, epoch: 25 | loss: 0.0028028
	speed: 0.0594s/iter; left time: 2098.0239s
	iters: 400, epoch: 25 | loss: 0.6176075
	speed: 0.0693s/iter; left time: 2440.7701s
Epoch: 25 cost time: 29.243183612823486
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 172174
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8152890
	speed: 0.0852s/iter; left time: 3986.2003s
	iters: 200, epoch: 1 | loss: 0.6685177
	speed: 0.0656s/iter; left time: 3063.6284s
	iters: 300, epoch: 1 | loss: 0.8739567
	speed: 0.0655s/iter; left time: 3053.4136s
	iters: 400, epoch: 1 | loss: 0.3645795
	speed: 0.0605s/iter; left time: 2811.9714s
Epoch: 1 cost time: 31.537257194519043
Epoch: 1, Steps: 469 | Train Loss: 1.073 Vali Loss: 0.443 Vali Acc: 0.868 Test Loss: 0.443 Test Acc: 0.868
Validation loss decreased (inf --> -0.868492).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4564778
	speed: 0.2707s/iter; left time: 12541.4491s
	iters: 200, epoch: 2 | loss: 0.1192794
	speed: 0.0553s/iter; left time: 2558.3030s
	iters: 300, epoch: 2 | loss: 0.2978802
	speed: 0.0595s/iter; left time: 2743.6988s
	iters: 400, epoch: 2 | loss: 0.1084554
	speed: 0.0574s/iter; left time: 2641.7564s
Epoch: 2 cost time: 27.683566093444824
Epoch: 2, Steps: 469 | Train Loss: 0.242 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
Validation loss decreased (-0.868492 --> -0.927385).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0709628
	speed: 0.2966s/iter; left time: 13600.6795s
	iters: 200, epoch: 3 | loss: 0.1475585
	speed: 0.0638s/iter; left time: 2921.2406s
	iters: 300, epoch: 3 | loss: 0.0509324
	speed: 0.0632s/iter; left time: 2887.0128s
	iters: 400, epoch: 3 | loss: 0.0323558
	speed: 0.0602s/iter; left time: 2743.2990s
Epoch: 3 cost time: 31.12621521949768
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.186 Vali Acc: 0.947 Test Loss: 0.186 Test Acc: 0.947
Validation loss decreased (-0.927385 --> -0.947397).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0201264
	speed: 0.3389s/iter; left time: 15383.5746s
	iters: 200, epoch: 4 | loss: 0.1600547
	speed: 0.0584s/iter; left time: 2646.5518s
	iters: 300, epoch: 4 | loss: 0.2134673
	speed: 0.0663s/iter; left time: 2996.6683s
	iters: 400, epoch: 4 | loss: 0.0299514
	speed: 0.0576s/iter; left time: 2599.6378s
Epoch: 4 cost time: 29.4049289226532
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.947397 --> -0.964550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0517362
	speed: 0.2900s/iter; left time: 13028.7561s
	iters: 200, epoch: 5 | loss: 0.4168233
	speed: 0.0641s/iter; left time: 2873.6792s
	iters: 300, epoch: 5 | loss: 0.0414768
	speed: 0.0614s/iter; left time: 2747.1113s
	iters: 400, epoch: 5 | loss: 0.0166269
	speed: 0.0642s/iter; left time: 2862.8917s
Epoch: 5 cost time: 30.568742752075195
Epoch: 5, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0089283
	speed: 0.2971s/iter; left time: 13207.6833s
	iters: 200, epoch: 6 | loss: 0.1908607
	speed: 0.0621s/iter; left time: 2753.4006s
	iters: 300, epoch: 6 | loss: 0.0032027
	speed: 0.0630s/iter; left time: 2787.0917s
	iters: 400, epoch: 6 | loss: 0.0138263
	speed: 0.0596s/iter; left time: 2630.7244s
Epoch: 6 cost time: 29.12884521484375
Epoch: 6, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0086344
	speed: 0.2934s/iter; left time: 12907.8527s
	iters: 200, epoch: 7 | loss: 0.0116130
	speed: 0.0581s/iter; left time: 2548.7831s
	iters: 300, epoch: 7 | loss: 0.0054621
	speed: 0.0564s/iter; left time: 2471.3664s
	iters: 400, epoch: 7 | loss: 0.0055159
	speed: 0.0530s/iter; left time: 2316.4675s
Epoch: 7 cost time: 27.113951206207275
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
Validation loss decreased (-0.964550 --> -0.971697).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0348953
	speed: 0.3037s/iter; left time: 13217.5114s
	iters: 200, epoch: 8 | loss: 0.0678273
	speed: 0.0654s/iter; left time: 2838.9006s
	iters: 300, epoch: 8 | loss: 0.0026649
	speed: 0.0694s/iter; left time: 3006.0228s
	iters: 400, epoch: 8 | loss: 0.0265815
	speed: 0.0746s/iter; left time: 3223.2796s
Epoch: 8 cost time: 32.077903032302856
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1495242
	speed: 0.3227s/iter; left time: 13890.7735s
	iters: 200, epoch: 9 | loss: 0.6136137
	speed: 0.0667s/iter; left time: 2866.0005s
	iters: 300, epoch: 9 | loss: 0.4235620
	speed: 0.0713s/iter; left time: 3055.1277s
	iters: 400, epoch: 9 | loss: 0.0474063
	speed: 0.0699s/iter; left time: 2989.8590s
Epoch: 9 cost time: 32.249109745025635
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0329752
	speed: 0.3296s/iter; left time: 14035.0877s
	iters: 200, epoch: 10 | loss: 0.0171795
	speed: 0.0573s/iter; left time: 2434.5198s
	iters: 300, epoch: 10 | loss: 0.0102643
	speed: 0.0627s/iter; left time: 2658.1783s
	iters: 400, epoch: 10 | loss: 0.0063324
	speed: 0.0654s/iter; left time: 2763.4761s
Epoch: 10 cost time: 28.68281650543213
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0043000
	speed: 0.2801s/iter; left time: 11795.9029s
	iters: 200, epoch: 11 | loss: 0.0927224
	speed: 0.0642s/iter; left time: 2699.1420s
	iters: 300, epoch: 11 | loss: 0.2997095
	speed: 0.0655s/iter; left time: 2746.7445s
	iters: 400, epoch: 11 | loss: 0.1381601
	speed: 0.0612s/iter; left time: 2557.7320s
Epoch: 11 cost time: 29.666234493255615
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.971697 --> -0.972269).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0015693
	speed: 0.2885s/iter; left time: 12013.9087s
	iters: 200, epoch: 12 | loss: 0.0248373
	speed: 0.0529s/iter; left time: 2197.1029s
	iters: 300, epoch: 12 | loss: 0.2067106
	speed: 0.0584s/iter; left time: 2418.9601s
	iters: 400, epoch: 12 | loss: 0.0053178
	speed: 0.0589s/iter; left time: 2434.2953s
Epoch: 12 cost time: 28.133761167526245
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0064784
	speed: 0.3274s/iter; left time: 13478.2038s
	iters: 200, epoch: 13 | loss: 0.0028427
	speed: 0.0697s/iter; left time: 2864.6773s
	iters: 300, epoch: 13 | loss: 0.0008178
	speed: 0.0668s/iter; left time: 2738.0946s
	iters: 400, epoch: 13 | loss: 0.0011667
	speed: 0.0680s/iter; left time: 2780.7587s
Epoch: 13 cost time: 31.9106388092041
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0124678
	speed: 0.3284s/iter; left time: 13366.5372s
	iters: 200, epoch: 14 | loss: 0.0426223
	speed: 0.0717s/iter; left time: 2909.7354s
	iters: 300, epoch: 14 | loss: 0.0139580
	speed: 0.0612s/iter; left time: 2478.1178s
	iters: 400, epoch: 14 | loss: 0.0027460
	speed: 0.0709s/iter; left time: 2864.5028s
Epoch: 14 cost time: 32.21290183067322
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0033227
	speed: 0.2827s/iter; left time: 11375.1714s
	iters: 200, epoch: 15 | loss: 0.1424368
	speed: 0.0609s/iter; left time: 2444.7466s
	iters: 300, epoch: 15 | loss: 0.0015809
	speed: 0.0666s/iter; left time: 2667.7412s
	iters: 400, epoch: 15 | loss: 0.0107934
	speed: 0.0708s/iter; left time: 2827.0884s
Epoch: 15 cost time: 30.78887176513672
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2162570
	speed: 0.3182s/iter; left time: 12652.7161s
	iters: 200, epoch: 16 | loss: 0.0018697
	speed: 0.0625s/iter; left time: 2478.4985s
	iters: 300, epoch: 16 | loss: 0.3585408
	speed: 0.0615s/iter; left time: 2432.7938s
	iters: 400, epoch: 16 | loss: 0.1037657
	speed: 0.0632s/iter; left time: 2493.1931s
Epoch: 16 cost time: 30.141660928726196
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0003014
	speed: 0.3249s/iter; left time: 12767.9510s
	iters: 200, epoch: 17 | loss: 0.0010193
	speed: 0.0542s/iter; left time: 2123.8958s
	iters: 300, epoch: 17 | loss: 0.0003318
	speed: 0.0599s/iter; left time: 2343.3971s
	iters: 400, epoch: 17 | loss: 0.0064123
	speed: 0.0634s/iter; left time: 2473.2625s
Epoch: 17 cost time: 29.71200156211853
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0123659
	speed: 0.3349s/iter; left time: 13004.3592s
	iters: 200, epoch: 18 | loss: 0.0077959
	speed: 0.0712s/iter; left time: 2759.0007s
	iters: 300, epoch: 18 | loss: 0.0013763
	speed: 0.0700s/iter; left time: 2705.4301s
	iters: 400, epoch: 18 | loss: 0.0020583
	speed: 0.0661s/iter; left time: 2548.5029s
Epoch: 18 cost time: 32.42642021179199
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.973126).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0013425
	speed: 0.3172s/iter; left time: 12168.5353s
	iters: 200, epoch: 19 | loss: 0.0010544
	speed: 0.0579s/iter; left time: 2214.4047s
	iters: 300, epoch: 19 | loss: 0.0038287
	speed: 0.0652s/iter; left time: 2487.6236s
	iters: 400, epoch: 19 | loss: 0.7506271
	speed: 0.0601s/iter; left time: 2287.6654s
Epoch: 19 cost time: 29.90584707260132
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0010252
	speed: 0.2977s/iter; left time: 11281.2396s
	iters: 200, epoch: 20 | loss: 0.0421672
	speed: 0.0630s/iter; left time: 2379.1697s
	iters: 300, epoch: 20 | loss: 0.0002467
	speed: 0.0520s/iter; left time: 1958.5776s
	iters: 400, epoch: 20 | loss: 0.0036807
	speed: 0.0591s/iter; left time: 2220.8353s
Epoch: 20 cost time: 28.446200132369995
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0284085
	speed: 0.3087s/iter; left time: 11552.4834s
	iters: 200, epoch: 21 | loss: 0.1521243
	speed: 0.0622s/iter; left time: 2321.0688s
	iters: 300, epoch: 21 | loss: 0.0008984
	speed: 0.0633s/iter; left time: 2357.5903s
	iters: 400, epoch: 21 | loss: 0.0011779
	speed: 0.0600s/iter; left time: 2226.3025s
Epoch: 21 cost time: 29.95112180709839
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.973698).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0012561
	speed: 0.3051s/iter; left time: 11272.9265s
	iters: 200, epoch: 22 | loss: 0.0325043
	speed: 0.0622s/iter; left time: 2291.4543s
	iters: 300, epoch: 22 | loss: 0.0095889
	speed: 0.0654s/iter; left time: 2404.4744s
	iters: 400, epoch: 22 | loss: 0.0015256
	speed: 0.0592s/iter; left time: 2167.9805s
Epoch: 22 cost time: 28.787599325180054
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1273663
	speed: 0.2611s/iter; left time: 9526.2391s
	iters: 200, epoch: 23 | loss: 0.0011431
	speed: 0.0593s/iter; left time: 2157.7376s
	iters: 300, epoch: 23 | loss: 0.0002986
	speed: 0.0644s/iter; left time: 2335.0052s
	iters: 400, epoch: 23 | loss: 0.0012200
	speed: 0.0642s/iter; left time: 2321.2951s
Epoch: 23 cost time: 29.896854400634766
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.961 Test Loss: 0.238 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0106463
	speed: 0.3302s/iter; left time: 11893.3349s
	iters: 200, epoch: 24 | loss: 0.0013175
	speed: 0.0674s/iter; left time: 2418.9908s
	iters: 300, epoch: 24 | loss: 0.0084163
	speed: 0.0638s/iter; left time: 2283.5542s
	iters: 400, epoch: 24 | loss: 0.0004361
	speed: 0.0681s/iter; left time: 2431.6587s
Epoch: 24 cost time: 32.196378231048584
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0140600
	speed: 0.3414s/iter; left time: 12134.2697s
	iters: 200, epoch: 25 | loss: 0.0019353
	speed: 0.0672s/iter; left time: 2381.2770s
	iters: 300, epoch: 25 | loss: 0.0422640
	speed: 0.0665s/iter; left time: 2351.6224s
	iters: 400, epoch: 25 | loss: 0.0018003
	speed: 0.0679s/iter; left time: 2394.3580s
Epoch: 25 cost time: 32.02912449836731
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0014602
	speed: 0.3105s/iter; left time: 10889.3874s
	iters: 200, epoch: 26 | loss: 0.0710665
	speed: 0.0660s/iter; left time: 2308.6065s
	iters: 300, epoch: 26 | loss: 0.5044879
	speed: 0.0629s/iter; left time: 2192.7629s
	iters: 400, epoch: 26 | loss: 0.0045449
	speed: 0.0625s/iter; left time: 2172.2650s
Epoch: 26 cost time: 30.916940689086914
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0284011
	speed: 0.2976s/iter; left time: 10297.6650s
	iters: 200, epoch: 27 | loss: 0.0003280
	speed: 0.0614s/iter; left time: 2117.6305s
	iters: 300, epoch: 27 | loss: 0.0009946
	speed: 0.0655s/iter; left time: 2252.8867s
	iters: 400, epoch: 27 | loss: 0.0304184
	speed: 0.0578s/iter; left time: 1983.3337s
Epoch: 27 cost time: 29.512603759765625
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0081188
	speed: 0.2934s/iter; left time: 10017.5011s
	iters: 200, epoch: 28 | loss: 0.0017398
	speed: 0.0627s/iter; left time: 2133.5821s
	iters: 300, epoch: 28 | loss: 0.4025365
	speed: 0.0717s/iter; left time: 2433.9193s
	iters: 400, epoch: 28 | loss: 0.0454840
	speed: 0.0720s/iter; left time: 2435.2403s
Epoch: 28 cost time: 32.128556966781616
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0006899
	speed: 0.2942s/iter; left time: 9905.1502s
	iters: 200, epoch: 29 | loss: 0.0064513
	speed: 0.0633s/iter; left time: 2125.1834s
	iters: 300, epoch: 29 | loss: 0.0002370
	speed: 0.0620s/iter; left time: 2076.0703s
	iters: 400, epoch: 29 | loss: 0.0009359
	speed: 0.0601s/iter; left time: 2004.9086s
Epoch: 29 cost time: 29.351301193237305
Epoch: 29, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0005228
	speed: 0.2967s/iter; left time: 9851.1255s
	iters: 200, epoch: 30 | loss: 0.0009809
	speed: 0.0584s/iter; left time: 1931.9412s
	iters: 300, epoch: 30 | loss: 0.0007142
	speed: 0.0541s/iter; left time: 1786.8128s
	iters: 400, epoch: 30 | loss: 0.0014702
	speed: 0.0659s/iter; left time: 2167.0464s
Epoch: 30 cost time: 29.30358338356018
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0132186
	speed: 0.3442s/iter; left time: 11267.3615s
	iters: 200, epoch: 31 | loss: 0.0033146
	speed: 0.0714s/iter; left time: 2330.2770s
	iters: 300, epoch: 31 | loss: 0.0005520
	speed: 0.0656s/iter; left time: 2132.8381s
	iters: 400, epoch: 31 | loss: 0.0001118
	speed: 0.0646s/iter; left time: 2094.5338s
Epoch: 31 cost time: 32.05118370056152
Epoch: 31, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.974841).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0023952
	speed: 0.2869s/iter; left time: 9256.4337s
	iters: 200, epoch: 32 | loss: 0.0029253
	speed: 0.0663s/iter; left time: 2132.1358s
	iters: 300, epoch: 32 | loss: 0.1733433
	speed: 0.0662s/iter; left time: 2123.3039s
	iters: 400, epoch: 32 | loss: 0.0012587
	speed: 0.0712s/iter; left time: 2276.6443s
Epoch: 32 cost time: 32.11467385292053
Epoch: 32, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0007845
	speed: 0.3135s/iter; left time: 9966.0273s
	iters: 200, epoch: 33 | loss: 0.0129093
	speed: 0.0688s/iter; left time: 2180.9116s
	iters: 300, epoch: 33 | loss: 0.0013286
	speed: 0.0627s/iter; left time: 1982.4176s
	iters: 400, epoch: 33 | loss: 0.0039784
	speed: 0.0715s/iter; left time: 2250.1784s
Epoch: 33 cost time: 33.14195275306702
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0002958
	speed: 0.3372s/iter; left time: 10561.1958s
	iters: 200, epoch: 34 | loss: 0.0004115
	speed: 0.0683s/iter; left time: 2131.6779s
	iters: 300, epoch: 34 | loss: 0.0044854
	speed: 0.0653s/iter; left time: 2033.7953s
	iters: 400, epoch: 34 | loss: 0.0550036
	speed: 0.0709s/iter; left time: 2199.8340s
Epoch: 34 cost time: 33.5922417640686
Epoch: 34, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0008567
	speed: 0.3239s/iter; left time: 9994.7164s
	iters: 200, epoch: 35 | loss: 0.0006310
	speed: 0.0592s/iter; left time: 1820.2322s
	iters: 300, epoch: 35 | loss: 0.0023624
	speed: 0.0614s/iter; left time: 1881.1264s
	iters: 400, epoch: 35 | loss: 0.0030247
	speed: 0.0589s/iter; left time: 1800.2082s
Epoch: 35 cost time: 30.604418516159058
Epoch: 35, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0003894
	speed: 0.2825s/iter; left time: 8584.5377s
	iters: 200, epoch: 36 | loss: 0.0001246
	speed: 0.0720s/iter; left time: 2180.2243s
	iters: 300, epoch: 36 | loss: 0.0013237
	speed: 0.0679s/iter; left time: 2049.8568s
	iters: 400, epoch: 36 | loss: 0.0008481
	speed: 0.0667s/iter; left time: 2006.9518s
Epoch: 36 cost time: 32.324928998947144
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0006239
	speed: 0.3407s/iter; left time: 10192.5326s
	iters: 200, epoch: 37 | loss: 0.0026156
	speed: 0.0720s/iter; left time: 2145.4169s
	iters: 300, epoch: 37 | loss: 0.0009433
	speed: 0.0693s/iter; left time: 2060.1928s
	iters: 400, epoch: 37 | loss: 0.0009934
	speed: 0.0586s/iter; left time: 1735.2748s
Epoch: 37 cost time: 32.7683322429657
Epoch: 37, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0002522
	speed: 0.3107s/iter; left time: 9149.7377s
	iters: 200, epoch: 38 | loss: 0.0056433
	speed: 0.0660s/iter; left time: 1937.5067s
	iters: 300, epoch: 38 | loss: 0.0002139
	speed: 0.0611s/iter; left time: 1786.9199s
	iters: 400, epoch: 38 | loss: 0.0024326
	speed: 0.0597s/iter; left time: 1740.2149s
Epoch: 38 cost time: 30.021624326705933
Epoch: 38, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0007106
	speed: 0.3250s/iter; left time: 9417.9597s
	iters: 200, epoch: 39 | loss: 0.0003297
	speed: 0.0721s/iter; left time: 2082.3590s
	iters: 300, epoch: 39 | loss: 0.4666054
	speed: 0.0694s/iter; left time: 1998.5209s
	iters: 400, epoch: 39 | loss: 0.0069210
	speed: 0.0613s/iter; left time: 1758.6221s
Epoch: 39 cost time: 32.19221830368042
Epoch: 39, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0002061
	speed: 0.3248s/iter; left time: 9260.1554s
	iters: 200, epoch: 40 | loss: 0.0018162
	speed: 0.0624s/iter; left time: 1771.7480s
	iters: 300, epoch: 40 | loss: 0.0004296
	speed: 0.0729s/iter; left time: 2064.3719s
	iters: 400, epoch: 40 | loss: 0.0003194
	speed: 0.0646s/iter; left time: 1822.8798s
Epoch: 40 cost time: 33.28268527984619
Epoch: 40, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0004653
	speed: 0.2963s/iter; left time: 8308.8255s
	iters: 200, epoch: 41 | loss: 0.0001170
	speed: 0.0584s/iter; left time: 1632.3437s
	iters: 300, epoch: 41 | loss: 0.0553424
	speed: 0.0660s/iter; left time: 1836.7112s
	iters: 400, epoch: 41 | loss: 0.0005873
	speed: 0.0567s/iter; left time: 1574.0620s
Epoch: 41 cost time: 28.362666368484497
Epoch: 41, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
Validation loss decreased (-0.974841 --> -0.981131).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0157179
	speed: 0.2422s/iter; left time: 6678.5721s
	iters: 200, epoch: 42 | loss: 0.0002548
	speed: 0.0593s/iter; left time: 1627.9431s
	iters: 300, epoch: 42 | loss: 0.0048776
	speed: 0.0554s/iter; left time: 1517.1221s
	iters: 400, epoch: 42 | loss: 0.0003127
	speed: 0.0616s/iter; left time: 1679.7484s
Epoch: 42 cost time: 27.58465027809143
Epoch: 42, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.0029478
	speed: 0.2704s/iter; left time: 7328.4734s
	iters: 200, epoch: 43 | loss: 0.0003743
	speed: 0.0529s/iter; left time: 1429.4237s
	iters: 300, epoch: 43 | loss: 0.0000850
	speed: 0.0607s/iter; left time: 1632.9445s
	iters: 400, epoch: 43 | loss: 0.0400106
	speed: 0.0566s/iter; left time: 1516.0579s
Epoch: 43 cost time: 28.053513765335083
Epoch: 43, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.0078302
	speed: 0.2946s/iter; left time: 7847.5601s
	iters: 200, epoch: 44 | loss: 0.1280417
	speed: 0.0563s/iter; left time: 1492.9667s
	iters: 300, epoch: 44 | loss: 0.0001218
	speed: 0.0568s/iter; left time: 1500.4917s
	iters: 400, epoch: 44 | loss: 0.0092437
	speed: 0.0609s/iter; left time: 1602.7776s
Epoch: 44 cost time: 28.422544717788696
Epoch: 44, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.0076218
	speed: 0.2976s/iter; left time: 7785.8885s
	iters: 200, epoch: 45 | loss: 0.0006886
	speed: 0.0755s/iter; left time: 1968.3232s
	iters: 300, epoch: 45 | loss: 0.0001324
	speed: 0.0638s/iter; left time: 1655.3901s
	iters: 400, epoch: 45 | loss: 0.0017234
	speed: 0.0641s/iter; left time: 1658.2108s
Epoch: 45 cost time: 31.989831686019897
Epoch: 45, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 0.0075298
	speed: 0.3236s/iter; left time: 8315.5500s
	iters: 200, epoch: 46 | loss: 0.0013270
	speed: 0.0628s/iter; left time: 1607.4211s
	iters: 300, epoch: 46 | loss: 0.0015943
	speed: 0.0608s/iter; left time: 1549.0689s
	iters: 400, epoch: 46 | loss: 0.0013299
	speed: 0.0697s/iter; left time: 1769.1108s
Epoch: 46 cost time: 31.774785041809082
Epoch: 46, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.0683224
	speed: 0.3300s/iter; left time: 8324.0280s
	iters: 200, epoch: 47 | loss: 0.0012847
	speed: 0.0802s/iter; left time: 2015.0314s
	iters: 300, epoch: 47 | loss: 0.0006303
	speed: 0.0757s/iter; left time: 1894.4053s
	iters: 400, epoch: 47 | loss: 0.1490707
	speed: 0.0678s/iter; left time: 1689.1464s
Epoch: 47 cost time: 34.24252796173096
Epoch: 47, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 0.0001060
	speed: 0.3227s/iter; left time: 7989.3022s
	iters: 200, epoch: 48 | loss: 0.0001907
	speed: 0.0627s/iter; left time: 1544.9858s
	iters: 300, epoch: 48 | loss: 0.0005723
	speed: 0.0558s/iter; left time: 1370.2953s
	iters: 400, epoch: 48 | loss: 0.0628430
	speed: 0.0555s/iter; left time: 1357.8629s
Epoch: 48 cost time: 28.688804149627686
Epoch: 48, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.0004860
	speed: 0.2662s/iter; left time: 6465.8626s
	iters: 200, epoch: 49 | loss: 0.0003435
	speed: 0.0583s/iter; left time: 1411.1824s
	iters: 300, epoch: 49 | loss: 0.0016663
	speed: 0.0547s/iter; left time: 1318.1770s
	iters: 400, epoch: 49 | loss: 0.0116289
	speed: 0.0546s/iter; left time: 1308.9445s
Epoch: 49 cost time: 27.70717740058899
Epoch: 49, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.965 Test Loss: 0.225 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 0.0139787
	speed: 0.2813s/iter; left time: 6700.5138s
	iters: 200, epoch: 50 | loss: 0.0047200
	speed: 0.0627s/iter; left time: 1487.0268s
	iters: 300, epoch: 50 | loss: 0.0004569
	speed: 0.0583s/iter; left time: 1377.1539s
	iters: 400, epoch: 50 | loss: 0.0006226
	speed: 0.0642s/iter; left time: 1509.6796s
Epoch: 50 cost time: 29.309387922286987
Epoch: 50, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 0.0001651
	speed: 0.2937s/iter; left time: 6858.5017s
	iters: 200, epoch: 51 | loss: 0.0001327
	speed: 0.0556s/iter; left time: 1292.8535s
	iters: 300, epoch: 51 | loss: 0.0004237
	speed: 0.0629s/iter; left time: 1456.8659s
	iters: 400, epoch: 51 | loss: 0.0060162
	speed: 0.0548s/iter; left time: 1263.7702s
Epoch: 51 cost time: 28.23921489715576
Epoch: 51, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 130766
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4365007
	speed: 0.0774s/iter; left time: 3620.9438s
	iters: 200, epoch: 1 | loss: 1.1635134
	speed: 0.0593s/iter; left time: 2767.2774s
	iters: 300, epoch: 1 | loss: 0.4525802
	speed: 0.0638s/iter; left time: 2974.3201s
	iters: 400, epoch: 1 | loss: 0.4432125
	speed: 0.0683s/iter; left time: 3177.1259s
Epoch: 1 cost time: 31.253031253814697
Epoch: 1, Steps: 469 | Train Loss: 0.988 Vali Loss: 0.462 Vali Acc: 0.873 Test Loss: 0.462 Test Acc: 0.873
Validation loss decreased (inf --> -0.872780).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3241740
	speed: 0.3077s/iter; left time: 14257.1780s
	iters: 200, epoch: 2 | loss: 0.0563021
	speed: 0.0647s/iter; left time: 2989.9206s
	iters: 300, epoch: 2 | loss: 0.4145206
	speed: 0.0593s/iter; left time: 2734.5881s
	iters: 400, epoch: 2 | loss: 0.0926416
	speed: 0.0542s/iter; left time: 2494.9221s
Epoch: 2 cost time: 28.583515167236328
Epoch: 2, Steps: 469 | Train Loss: 0.245 Vali Loss: 0.294 Vali Acc: 0.897 Test Loss: 0.294 Test Acc: 0.897
Validation loss decreased (-0.872780 --> -0.897081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1684102
	speed: 0.3051s/iter; left time: 13991.2090s
	iters: 200, epoch: 3 | loss: 0.0272368
	speed: 0.0551s/iter; left time: 2521.9512s
	iters: 300, epoch: 3 | loss: 0.0464200
	speed: 0.0641s/iter; left time: 2925.8724s
	iters: 400, epoch: 3 | loss: 0.7779272
	speed: 0.0619s/iter; left time: 2822.2420s
Epoch: 3 cost time: 29.13687801361084
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.897081 --> -0.930243).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0496202
	speed: 0.3021s/iter; left time: 13713.1586s
	iters: 200, epoch: 4 | loss: 0.0488354
	speed: 0.0734s/iter; left time: 3326.1118s
	iters: 300, epoch: 4 | loss: 0.3850223
	speed: 0.0627s/iter; left time: 2831.5129s
	iters: 400, epoch: 4 | loss: 0.1141420
	speed: 0.0711s/iter; left time: 3206.9428s
Epoch: 4 cost time: 31.721723079681396
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.930243 --> -0.949112).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0071287
	speed: 0.2518s/iter; left time: 11312.4726s
	iters: 200, epoch: 5 | loss: 0.0466291
	speed: 0.0524s/iter; left time: 2347.4146s
	iters: 300, epoch: 5 | loss: 0.0936993
	speed: 0.0584s/iter; left time: 2612.5115s
	iters: 400, epoch: 5 | loss: 0.0065800
	speed: 0.0528s/iter; left time: 2356.3910s
Epoch: 5 cost time: 26.2581307888031
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.949112 --> -0.950542).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2527127
	speed: 0.2597s/iter; left time: 11547.4265s
	iters: 200, epoch: 6 | loss: 0.3826422
	speed: 0.0638s/iter; left time: 2829.7517s
	iters: 300, epoch: 6 | loss: 0.2923905
	speed: 0.0550s/iter; left time: 2435.7181s
	iters: 400, epoch: 6 | loss: 0.0162360
	speed: 0.0582s/iter; left time: 2567.9705s
Epoch: 6 cost time: 27.39351987838745
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0540053
	speed: 0.2894s/iter; left time: 12728.6110s
	iters: 200, epoch: 7 | loss: 0.0259521
	speed: 0.0695s/iter; left time: 3048.4925s
	iters: 300, epoch: 7 | loss: 0.0752603
	speed: 0.0676s/iter; left time: 2958.6379s
	iters: 400, epoch: 7 | loss: 0.0268288
	speed: 0.0563s/iter; left time: 2458.1333s
Epoch: 7 cost time: 30.389369249343872
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
Validation loss decreased (-0.950542 --> -0.952829).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0083419
	speed: 0.2922s/iter; left time: 12715.2176s
	iters: 200, epoch: 8 | loss: 0.0046741
	speed: 0.0645s/iter; left time: 2802.2723s
	iters: 300, epoch: 8 | loss: 0.0566680
	speed: 0.0630s/iter; left time: 2728.9832s
	iters: 400, epoch: 8 | loss: 0.0085014
	speed: 0.0624s/iter; left time: 2696.6792s
Epoch: 8 cost time: 29.447834014892578
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.952829 --> -0.972555).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0881011
	speed: 0.2781s/iter; left time: 11970.7649s
	iters: 200, epoch: 9 | loss: 0.0129675
	speed: 0.0596s/iter; left time: 2560.1087s
	iters: 300, epoch: 9 | loss: 0.0575395
	speed: 0.0649s/iter; left time: 2779.2690s
	iters: 400, epoch: 9 | loss: 0.0025052
	speed: 0.0577s/iter; left time: 2467.3415s
Epoch: 9 cost time: 27.867056608200073
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0323826
	speed: 0.2618s/iter; left time: 11145.5402s
	iters: 200, epoch: 10 | loss: 0.0670674
	speed: 0.0609s/iter; left time: 2588.5497s
	iters: 300, epoch: 10 | loss: 0.0028002
	speed: 0.0704s/iter; left time: 2983.2045s
	iters: 400, epoch: 10 | loss: 0.0053930
	speed: 0.0700s/iter; left time: 2958.4575s
Epoch: 10 cost time: 31.277095794677734
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0895353
	speed: 0.3337s/iter; left time: 14054.5381s
	iters: 200, epoch: 11 | loss: 0.0027272
	speed: 0.0654s/iter; left time: 2745.6772s
	iters: 300, epoch: 11 | loss: 0.0017929
	speed: 0.0584s/iter; left time: 2448.7420s
	iters: 400, epoch: 11 | loss: 0.0896294
	speed: 0.0635s/iter; left time: 2654.1784s
Epoch: 11 cost time: 30.69773530960083
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0039032
	speed: 0.2947s/iter; left time: 12272.4772s
	iters: 200, epoch: 12 | loss: 0.0027259
	speed: 0.0574s/iter; left time: 2382.9053s
	iters: 300, epoch: 12 | loss: 0.0099879
	speed: 0.0672s/iter; left time: 2785.2500s
	iters: 400, epoch: 12 | loss: 0.0342453
	speed: 0.0723s/iter; left time: 2987.7243s
Epoch: 12 cost time: 29.990501642227173
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1086283
	speed: 0.2776s/iter; left time: 11427.6596s
	iters: 200, epoch: 13 | loss: 0.1038755
	speed: 0.0649s/iter; left time: 2667.6368s
	iters: 300, epoch: 13 | loss: 0.0681595
	speed: 0.0615s/iter; left time: 2519.9992s
	iters: 400, epoch: 13 | loss: 0.0044152
	speed: 0.0517s/iter; left time: 2112.2596s
Epoch: 13 cost time: 28.14999222755432
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0421480
	speed: 0.2417s/iter; left time: 9838.6679s
	iters: 200, epoch: 14 | loss: 0.0029755
	speed: 0.0562s/iter; left time: 2281.6539s
	iters: 300, epoch: 14 | loss: 0.0013605
	speed: 0.0569s/iter; left time: 2304.4099s
	iters: 400, epoch: 14 | loss: 0.0022700
	speed: 0.0560s/iter; left time: 2260.8463s
Epoch: 14 cost time: 27.34686541557312
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0072776
	speed: 0.3007s/iter; left time: 12097.5961s
	iters: 200, epoch: 15 | loss: 0.0036873
	speed: 0.0643s/iter; left time: 2580.0231s
	iters: 300, epoch: 15 | loss: 0.0113832
	speed: 0.0608s/iter; left time: 2436.0274s
	iters: 400, epoch: 15 | loss: 0.0018499
	speed: 0.0599s/iter; left time: 2390.9724s
Epoch: 15 cost time: 30.322989463806152
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0043229
	speed: 0.3052s/iter; left time: 12137.3530s
	iters: 200, epoch: 16 | loss: 0.0180929
	speed: 0.0552s/iter; left time: 2187.5964s
	iters: 300, epoch: 16 | loss: 0.0013381
	speed: 0.0617s/iter; left time: 2440.1762s
	iters: 400, epoch: 16 | loss: 0.0099391
	speed: 0.0655s/iter; left time: 2585.9964s
Epoch: 16 cost time: 29.788400888442993
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0016438
	speed: 0.2908s/iter; left time: 11427.5110s
	iters: 200, epoch: 17 | loss: 0.6344668
	speed: 0.0639s/iter; left time: 2505.5383s
	iters: 300, epoch: 17 | loss: 0.0225118
	speed: 0.0656s/iter; left time: 2566.4860s
	iters: 400, epoch: 17 | loss: 0.0546168
	speed: 0.0602s/iter; left time: 2346.5507s
Epoch: 17 cost time: 30.071717262268066
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0032300
	speed: 0.2848s/iter; left time: 11057.0723s
	iters: 200, epoch: 18 | loss: 0.0022329
	speed: 0.0670s/iter; left time: 2592.9623s
	iters: 300, epoch: 18 | loss: 0.0011513
	speed: 0.0628s/iter; left time: 2427.5789s
	iters: 400, epoch: 18 | loss: 0.0008776
	speed: 0.0644s/iter; left time: 2481.9832s
Epoch: 18 cost time: 30.490936994552612
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.228 Vali Acc: 0.954 Test Loss: 0.228 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9725557461406518
model parameter : 130702
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5935659
	speed: 0.0967s/iter; left time: 4526.9926s
	iters: 200, epoch: 1 | loss: 1.0719737
	speed: 0.0677s/iter; left time: 3159.3294s
	iters: 300, epoch: 1 | loss: 0.6738739
	speed: 0.0603s/iter; left time: 2808.5978s
	iters: 400, epoch: 1 | loss: 0.7806972
	speed: 0.0534s/iter; left time: 2484.8586s
Epoch: 1 cost time: 31.41051983833313
Epoch: 1, Steps: 469 | Train Loss: 1.074 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
Validation loss decreased (inf --> -0.866776).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3227514
	speed: 0.2631s/iter; left time: 12191.0853s
	iters: 200, epoch: 2 | loss: 0.2219843
	speed: 0.0576s/iter; left time: 2660.8658s
	iters: 300, epoch: 2 | loss: 0.1507051
	speed: 0.0555s/iter; left time: 2560.5394s
	iters: 400, epoch: 2 | loss: 0.0803435
	speed: 0.0533s/iter; left time: 2453.5409s
Epoch: 2 cost time: 26.75549626350403
Epoch: 2, Steps: 469 | Train Loss: 0.236 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.866776 --> -0.911089).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0336195
	speed: 0.2651s/iter; left time: 12156.7220s
	iters: 200, epoch: 3 | loss: 0.3140905
	speed: 0.0608s/iter; left time: 2782.2625s
	iters: 300, epoch: 3 | loss: 0.1978460
	speed: 0.0532s/iter; left time: 2427.9221s
	iters: 400, epoch: 3 | loss: 0.0442108
	speed: 0.0538s/iter; left time: 2450.3059s
Epoch: 3 cost time: 27.19675612449646
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.911089 --> -0.941107).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0193271
	speed: 0.2791s/iter; left time: 12667.6539s
	iters: 200, epoch: 4 | loss: 0.0460951
	speed: 0.0612s/iter; left time: 2772.0851s
	iters: 300, epoch: 4 | loss: 0.0172826
	speed: 0.0567s/iter; left time: 2561.2509s
	iters: 400, epoch: 4 | loss: 0.2177546
	speed: 0.0516s/iter; left time: 2326.4089s
Epoch: 4 cost time: 27.94954013824463
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
Validation loss decreased (-0.941107 --> -0.953115).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0307948
	speed: 0.3218s/iter; left time: 14455.4784s
	iters: 200, epoch: 5 | loss: 0.0494913
	speed: 0.0771s/iter; left time: 3457.0816s
	iters: 300, epoch: 5 | loss: 0.0103202
	speed: 0.0764s/iter; left time: 3415.4507s
	iters: 400, epoch: 5 | loss: 0.0233533
	speed: 0.0724s/iter; left time: 3233.0731s
Epoch: 5 cost time: 35.85577464103699
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.953115 --> -0.960262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0131784
	speed: 0.3685s/iter; left time: 16382.2613s
	iters: 200, epoch: 6 | loss: 0.0201838
	speed: 0.0735s/iter; left time: 3259.4383s
	iters: 300, epoch: 6 | loss: 0.0051739
	speed: 0.0698s/iter; left time: 3089.3302s
	iters: 400, epoch: 6 | loss: 0.0374823
	speed: 0.0673s/iter; left time: 2973.7392s
Epoch: 6 cost time: 33.00996160507202
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0500021
	speed: 0.3275s/iter; left time: 14406.9033s
	iters: 200, epoch: 7 | loss: 0.1426484
	speed: 0.0674s/iter; left time: 2958.2268s
	iters: 300, epoch: 7 | loss: 0.4851068
	speed: 0.0694s/iter; left time: 3037.8801s
	iters: 400, epoch: 7 | loss: 0.0109092
	speed: 0.0686s/iter; left time: 2996.3184s
Epoch: 7 cost time: 33.34983730316162
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.960262 --> -0.963120).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0017467
	speed: 0.3543s/iter; left time: 15418.7991s
	iters: 200, epoch: 8 | loss: 0.0020555
	speed: 0.0621s/iter; left time: 2694.8152s
	iters: 300, epoch: 8 | loss: 0.1154967
	speed: 0.0721s/iter; left time: 3125.2788s
	iters: 400, epoch: 8 | loss: 0.0054203
	speed: 0.0672s/iter; left time: 2903.2948s
Epoch: 8 cost time: 33.4392728805542
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.963120 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0107760
	speed: 0.3298s/iter; left time: 14196.7635s
	iters: 200, epoch: 9 | loss: 0.0605647
	speed: 0.0616s/iter; left time: 2643.9033s
	iters: 300, epoch: 9 | loss: 0.0025032
	speed: 0.0615s/iter; left time: 2633.3649s
	iters: 400, epoch: 9 | loss: 0.0416061
	speed: 0.0660s/iter; left time: 2820.8354s
Epoch: 9 cost time: 30.542132139205933
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0917804
	speed: 0.3191s/iter; left time: 13588.9068s
	iters: 200, epoch: 10 | loss: 0.0148368
	speed: 0.0650s/iter; left time: 2760.1158s
	iters: 300, epoch: 10 | loss: 0.1420712
	speed: 0.0646s/iter; left time: 2736.7582s
	iters: 400, epoch: 10 | loss: 0.0065712
	speed: 0.0633s/iter; left time: 2675.4191s
Epoch: 10 cost time: 32.01916217803955
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0072108
	speed: 0.2889s/iter; left time: 12167.5434s
	iters: 200, epoch: 11 | loss: 0.0186074
	speed: 0.0594s/iter; left time: 2495.0595s
	iters: 300, epoch: 11 | loss: 0.0137119
	speed: 0.0651s/iter; left time: 2729.5506s
	iters: 400, epoch: 11 | loss: 0.0227936
	speed: 0.0673s/iter; left time: 2814.7788s
Epoch: 11 cost time: 30.007677793502808
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.329 Vali Acc: 0.928 Test Loss: 0.329 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0032288
	speed: 0.3033s/iter; left time: 12629.5062s
	iters: 200, epoch: 12 | loss: 0.0012247
	speed: 0.0634s/iter; left time: 2635.1011s
	iters: 300, epoch: 12 | loss: 0.1846630
	speed: 0.0762s/iter; left time: 3157.2245s
	iters: 400, epoch: 12 | loss: 0.0919187
	speed: 0.0636s/iter; left time: 2628.6412s
Epoch: 12 cost time: 32.87481665611267
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0041003
	speed: 0.3362s/iter; left time: 13842.6501s
	iters: 200, epoch: 13 | loss: 0.0050544
	speed: 0.0687s/iter; left time: 2820.2807s
	iters: 300, epoch: 13 | loss: 0.3316601
	speed: 0.0705s/iter; left time: 2889.9792s
	iters: 400, epoch: 13 | loss: 0.0030007
	speed: 0.0742s/iter; left time: 3032.5540s
Epoch: 13 cost time: 35.06708526611328
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0094691
	speed: 0.3440s/iter; left time: 14000.5744s
	iters: 200, epoch: 14 | loss: 0.0084776
	speed: 0.0786s/iter; left time: 3190.6911s
	iters: 300, epoch: 14 | loss: 0.0678617
	speed: 0.0694s/iter; left time: 2809.0506s
	iters: 400, epoch: 14 | loss: 0.0224363
	speed: 0.0614s/iter; left time: 2479.6204s
Epoch: 14 cost time: 32.22334265708923
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.259 Vali Acc: 0.940 Test Loss: 0.259 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0200864
	speed: 0.2586s/iter; left time: 10404.3821s
	iters: 200, epoch: 15 | loss: 0.1091504
	speed: 0.0686s/iter; left time: 2752.6164s
	iters: 300, epoch: 15 | loss: 0.0051368
	speed: 0.0632s/iter; left time: 2531.7499s
	iters: 400, epoch: 15 | loss: 0.0034292
	speed: 0.0752s/iter; left time: 3004.7338s
Epoch: 15 cost time: 32.40723514556885
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0043763
	speed: 0.3429s/iter; left time: 13633.8875s
	iters: 200, epoch: 16 | loss: 0.0016970
	speed: 0.0816s/iter; left time: 3234.8390s
	iters: 300, epoch: 16 | loss: 0.0832146
	speed: 0.0721s/iter; left time: 2851.0884s
	iters: 400, epoch: 16 | loss: 0.3233291
	speed: 0.0685s/iter; left time: 2704.3050s
Epoch: 16 cost time: 34.70714831352234
Epoch: 16, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0041893
	speed: 0.3265s/iter; left time: 12828.5192s
	iters: 200, epoch: 17 | loss: 0.0051062
	speed: 0.0624s/iter; left time: 2445.0938s
	iters: 300, epoch: 17 | loss: 0.0233284
	speed: 0.0650s/iter; left time: 2540.9438s
	iters: 400, epoch: 17 | loss: 0.0059495
	speed: 0.0574s/iter; left time: 2239.4162s
Epoch: 17 cost time: 30.5576114654541
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0030673
	speed: 0.3470s/iter; left time: 13474.0012s
	iters: 200, epoch: 18 | loss: 0.0046464
	speed: 0.0710s/iter; left time: 2748.4229s
	iters: 300, epoch: 18 | loss: 0.0218531
	speed: 0.0817s/iter; left time: 3154.7509s
	iters: 400, epoch: 18 | loss: 0.0025950
	speed: 0.0730s/iter; left time: 2811.6921s
Epoch: 18 cost time: 35.23181748390198
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9757004002287021
model parameter : 130638
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6228096
	speed: 0.0785s/iter; left time: 3673.3579s
	iters: 200, epoch: 1 | loss: 1.0371867
	speed: 0.0583s/iter; left time: 2722.3780s
	iters: 300, epoch: 1 | loss: 0.4823935
	speed: 0.0546s/iter; left time: 2546.7161s
	iters: 400, epoch: 1 | loss: 0.3926592
	speed: 0.0597s/iter; left time: 2777.9624s
Epoch: 1 cost time: 29.41075849533081
Epoch: 1, Steps: 469 | Train Loss: 1.125 Vali Loss: 0.474 Vali Acc: 0.834 Test Loss: 0.474 Test Acc: 0.834
Validation loss decreased (inf --> -0.834472).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2365289
	speed: 0.2990s/iter; left time: 13852.2387s
	iters: 200, epoch: 2 | loss: 0.1666736
	speed: 0.0594s/iter; left time: 2745.2273s
	iters: 300, epoch: 2 | loss: 0.0740658
	speed: 0.0637s/iter; left time: 2936.8230s
	iters: 400, epoch: 2 | loss: 0.2520094
	speed: 0.0612s/iter; left time: 2817.8909s
Epoch: 2 cost time: 29.28569746017456
Epoch: 2, Steps: 469 | Train Loss: 0.261 Vali Loss: 0.240 Vali Acc: 0.929 Test Loss: 0.240 Test Acc: 0.929
Validation loss decreased (-0.834472 --> -0.929386).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1760342
	speed: 0.2720s/iter; left time: 12472.6054s
	iters: 200, epoch: 3 | loss: 0.0978854
	speed: 0.0512s/iter; left time: 2344.2115s
	iters: 300, epoch: 3 | loss: 0.1543730
	speed: 0.0548s/iter; left time: 2500.3160s
	iters: 400, epoch: 3 | loss: 0.1058812
	speed: 0.0592s/iter; left time: 2698.9527s
Epoch: 3 cost time: 25.883552312850952
Epoch: 3, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.929386 --> -0.953686).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2873295
	speed: 0.2515s/iter; left time: 11417.9606s
	iters: 200, epoch: 4 | loss: 0.0157474
	speed: 0.0548s/iter; left time: 2480.8693s
	iters: 300, epoch: 4 | loss: 0.2847477
	speed: 0.0510s/iter; left time: 2302.9617s
	iters: 400, epoch: 4 | loss: 0.0515504
	speed: 0.0540s/iter; left time: 2433.1676s
Epoch: 4 cost time: 26.008110284805298
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0717049
	speed: 0.2913s/iter; left time: 13086.5073s
	iters: 200, epoch: 5 | loss: 0.0460053
	speed: 0.0621s/iter; left time: 2783.5120s
	iters: 300, epoch: 5 | loss: 0.0071172
	speed: 0.0587s/iter; left time: 2624.4010s
	iters: 400, epoch: 5 | loss: 0.6061069
	speed: 0.0547s/iter; left time: 2440.3450s
Epoch: 5 cost time: 28.58784055709839
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.953686 --> -0.958832).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0150514
	speed: 0.2738s/iter; left time: 12173.1955s
	iters: 200, epoch: 6 | loss: 0.0144305
	speed: 0.0522s/iter; left time: 2313.5396s
	iters: 300, epoch: 6 | loss: 0.0041239
	speed: 0.0569s/iter; left time: 2518.2051s
	iters: 400, epoch: 6 | loss: 0.0456040
	speed: 0.0615s/iter; left time: 2717.5938s
Epoch: 6 cost time: 26.211103677749634
Epoch: 6, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3621680
	speed: 0.2713s/iter; left time: 11931.8865s
	iters: 200, epoch: 7 | loss: 0.0079758
	speed: 0.0561s/iter; left time: 2463.9668s
	iters: 300, epoch: 7 | loss: 0.0193639
	speed: 0.0588s/iter; left time: 2575.2631s
	iters: 400, epoch: 7 | loss: 0.1013651
	speed: 0.0533s/iter; left time: 2327.5165s
Epoch: 7 cost time: 27.071179151535034
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0089050
	speed: 0.2627s/iter; left time: 11432.0587s
	iters: 200, epoch: 8 | loss: 0.0136747
	speed: 0.0568s/iter; left time: 2467.4093s
	iters: 300, epoch: 8 | loss: 0.5175679
	speed: 0.0550s/iter; left time: 2384.1225s
	iters: 400, epoch: 8 | loss: 0.0127763
	speed: 0.0594s/iter; left time: 2568.2995s
Epoch: 8 cost time: 27.14126181602478
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.958832 --> -0.964264).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0055571
	speed: 0.2791s/iter; left time: 12016.4302s
	iters: 200, epoch: 9 | loss: 0.0489106
	speed: 0.0638s/iter; left time: 2741.0794s
	iters: 300, epoch: 9 | loss: 0.0052139
	speed: 0.0566s/iter; left time: 2424.3142s
	iters: 400, epoch: 9 | loss: 0.6708965
	speed: 0.0540s/iter; left time: 2306.7269s
Epoch: 9 cost time: 27.982195377349854
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0372985
	speed: 0.2702s/iter; left time: 11503.2453s
	iters: 200, epoch: 10 | loss: 0.1953482
	speed: 0.0590s/iter; left time: 2507.0468s
	iters: 300, epoch: 10 | loss: 0.0054869
	speed: 0.0617s/iter; left time: 2614.8589s
	iters: 400, epoch: 10 | loss: 0.0012452
	speed: 0.0564s/iter; left time: 2386.2488s
Epoch: 10 cost time: 27.897605419158936
Epoch: 10, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0031175
	speed: 0.2773s/iter; left time: 11678.6649s
	iters: 200, epoch: 11 | loss: 0.0090594
	speed: 0.0608s/iter; left time: 2554.2322s
	iters: 300, epoch: 11 | loss: 0.1171338
	speed: 0.0617s/iter; left time: 2586.9051s
	iters: 400, epoch: 11 | loss: 0.0009804
	speed: 0.0633s/iter; left time: 2647.6900s
Epoch: 11 cost time: 28.97706651687622
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0042500
	speed: 0.3066s/iter; left time: 12768.0204s
	iters: 200, epoch: 12 | loss: 0.0043169
	speed: 0.0602s/iter; left time: 2499.8091s
	iters: 300, epoch: 12 | loss: 0.0024722
	speed: 0.0585s/iter; left time: 2424.3537s
	iters: 400, epoch: 12 | loss: 0.7204100
	speed: 0.0552s/iter; left time: 2282.5289s
Epoch: 12 cost time: 28.41603446006775
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.352 Vali Acc: 0.920 Test Loss: 0.352 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0168119
	speed: 0.2833s/iter; left time: 11662.4699s
	iters: 200, epoch: 13 | loss: 0.0182693
	speed: 0.0622s/iter; left time: 2553.0358s
	iters: 300, epoch: 13 | loss: 0.0076978
	speed: 0.0558s/iter; left time: 2285.7754s
	iters: 400, epoch: 13 | loss: 0.0037021
	speed: 0.0554s/iter; left time: 2264.5852s
Epoch: 13 cost time: 28.059823989868164
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0224749
	speed: 0.2769s/iter; left time: 11271.5955s
	iters: 200, epoch: 14 | loss: 0.0086675
	speed: 0.0602s/iter; left time: 2444.5710s
	iters: 300, epoch: 14 | loss: 0.0011753
	speed: 0.0657s/iter; left time: 2661.2271s
	iters: 400, epoch: 14 | loss: 0.0140648
	speed: 0.0634s/iter; left time: 2561.3691s
Epoch: 14 cost time: 29.065989017486572
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.964264 --> -0.967123).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1801297
	speed: 0.2628s/iter; left time: 10574.0367s
	iters: 200, epoch: 15 | loss: 0.0054765
	speed: 0.0568s/iter; left time: 2279.3758s
	iters: 300, epoch: 15 | loss: 0.0138241
	speed: 0.0626s/iter; left time: 2506.1492s
	iters: 400, epoch: 15 | loss: 0.0050550
	speed: 0.0600s/iter; left time: 2394.3865s
Epoch: 15 cost time: 27.101343631744385
Epoch: 15, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0009922
	speed: 0.2509s/iter; left time: 9977.4144s
	iters: 200, epoch: 16 | loss: 0.0032129
	speed: 0.0541s/iter; left time: 2144.6311s
	iters: 300, epoch: 16 | loss: 0.0021508
	speed: 0.0545s/iter; left time: 2155.2113s
	iters: 400, epoch: 16 | loss: 0.0064274
	speed: 0.0643s/iter; left time: 2536.5338s
Epoch: 16 cost time: 27.199315309524536
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0048421
	speed: 0.2651s/iter; left time: 10419.1058s
	iters: 200, epoch: 17 | loss: 0.0010701
	speed: 0.0562s/iter; left time: 2201.5746s
	iters: 300, epoch: 17 | loss: 0.0004458
	speed: 0.0563s/iter; left time: 2202.7766s
	iters: 400, epoch: 17 | loss: 0.0013590
	speed: 0.0544s/iter; left time: 2120.0681s
Epoch: 17 cost time: 26.626237154006958
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0104428
	speed: 0.2474s/iter; left time: 9605.1662s
	iters: 200, epoch: 18 | loss: 0.0039071
	speed: 0.0416s/iter; left time: 1609.2737s
	iters: 300, epoch: 18 | loss: 0.0009011
	speed: 0.0449s/iter; left time: 1734.5188s
	iters: 400, epoch: 18 | loss: 0.0088205
	speed: 0.0468s/iter; left time: 1801.2849s
Epoch: 18 cost time: 22.662777185440063
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0079050
	speed: 0.2274s/iter; left time: 8723.2749s
	iters: 200, epoch: 19 | loss: 0.0011112
	speed: 0.0563s/iter; left time: 2152.6203s
	iters: 300, epoch: 19 | loss: 0.0050769
	speed: 0.0579s/iter; left time: 2208.4431s
	iters: 400, epoch: 19 | loss: 0.0056820
	speed: 0.0619s/iter; left time: 2356.5952s
Epoch: 19 cost time: 27.54232144355774
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0011555
	speed: 0.2712s/iter; left time: 10274.4761s
	iters: 200, epoch: 20 | loss: 0.0026480
	speed: 0.0516s/iter; left time: 1949.2651s
	iters: 300, epoch: 20 | loss: 0.0809770
	speed: 0.0510s/iter; left time: 1920.4484s
	iters: 400, epoch: 20 | loss: 0.1501363
	speed: 0.0628s/iter; left time: 2359.3937s
Epoch: 20 cost time: 26.313886642456055
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0254576
	speed: 0.2692s/iter; left time: 10074.8633s
	iters: 200, epoch: 21 | loss: 0.0043634
	speed: 0.0541s/iter; left time: 2017.3558s
	iters: 300, epoch: 21 | loss: 0.0711337
	speed: 0.0562s/iter; left time: 2091.4111s
	iters: 400, epoch: 21 | loss: 0.0046281
	speed: 0.0597s/iter; left time: 2216.8005s
Epoch: 21 cost time: 27.091108798980713
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0054031
	speed: 0.2466s/iter; left time: 9113.5793s
	iters: 200, epoch: 22 | loss: 0.0301128
	speed: 0.0517s/iter; left time: 1905.0974s
	iters: 300, epoch: 22 | loss: 0.0002930
	speed: 0.0514s/iter; left time: 1890.8444s
	iters: 400, epoch: 22 | loss: 0.0019268
	speed: 0.0554s/iter; left time: 2029.9882s
Epoch: 22 cost time: 25.486093759536743
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1956660
	speed: 0.2659s/iter; left time: 9700.1537s
	iters: 200, epoch: 23 | loss: 0.1183449
	speed: 0.0528s/iter; left time: 1919.3117s
	iters: 300, epoch: 23 | loss: 0.0035178
	speed: 0.0538s/iter; left time: 1952.0501s
	iters: 400, epoch: 23 | loss: 0.0014131
	speed: 0.0643s/iter; left time: 2328.2619s
Epoch: 23 cost time: 27.243062496185303
Epoch: 23, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0374201
	speed: 0.2571s/iter; left time: 9260.9622s
	iters: 200, epoch: 24 | loss: 0.0002053
	speed: 0.0505s/iter; left time: 1813.7263s
	iters: 300, epoch: 24 | loss: 0.0007250
	speed: 0.0528s/iter; left time: 1892.2774s
	iters: 400, epoch: 24 | loss: 0.0185128
	speed: 0.0538s/iter; left time: 1920.4719s
Epoch: 24 cost time: 24.844228267669678
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9671240708976558
model parameter : 130574
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7863848
	speed: 0.0572s/iter; left time: 2676.3748s
	iters: 200, epoch: 1 | loss: 0.2240281
	speed: 0.0317s/iter; left time: 1480.4407s
	iters: 300, epoch: 1 | loss: 0.3967604
	speed: 0.0353s/iter; left time: 1643.9269s
	iters: 400, epoch: 1 | loss: 0.0441134
	speed: 0.0389s/iter; left time: 1811.0251s
Epoch: 1 cost time: 18.98087477684021
Epoch: 1, Steps: 469 | Train Loss: 0.479 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
Validation loss decreased (inf --> -0.935104).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8174050
	speed: 0.2087s/iter; left time: 9667.8964s
	iters: 200, epoch: 2 | loss: 0.0476035
	speed: 0.0381s/iter; left time: 1759.8854s
	iters: 300, epoch: 2 | loss: 0.0319116
	speed: 0.0349s/iter; left time: 1610.6259s
	iters: 400, epoch: 2 | loss: 0.1841405
	speed: 0.0380s/iter; left time: 1747.8289s
Epoch: 2 cost time: 17.815889596939087
Epoch: 2, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
Validation loss decreased (-0.935104 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1248638
	speed: 0.2150s/iter; left time: 9860.5474s
	iters: 200, epoch: 3 | loss: 0.0165793
	speed: 0.0296s/iter; left time: 1355.1478s
	iters: 300, epoch: 3 | loss: 0.1036444
	speed: 0.0306s/iter; left time: 1395.6916s
	iters: 400, epoch: 3 | loss: 0.0037276
	speed: 0.0329s/iter; left time: 1497.2250s
Epoch: 3 cost time: 15.17993712425232
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0698164
	speed: 0.2022s/iter; left time: 9178.3834s
	iters: 200, epoch: 4 | loss: 0.0129986
	speed: 0.0368s/iter; left time: 1666.8240s
	iters: 300, epoch: 4 | loss: 0.4032264
	speed: 0.0350s/iter; left time: 1580.9668s
	iters: 400, epoch: 4 | loss: 0.2220708
	speed: 0.0352s/iter; left time: 1588.5329s
Epoch: 4 cost time: 16.663715362548828
Epoch: 4, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.215 Vali Acc: 0.929 Test Loss: 0.215 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0971074
	speed: 0.2068s/iter; left time: 9291.3927s
	iters: 200, epoch: 5 | loss: 0.0255665
	speed: 0.0391s/iter; left time: 1751.5761s
	iters: 300, epoch: 5 | loss: 0.0366652
	speed: 0.0408s/iter; left time: 1823.3131s
	iters: 400, epoch: 5 | loss: 0.1098686
	speed: 0.0378s/iter; left time: 1685.9864s
Epoch: 5 cost time: 18.16087508201599
Epoch: 5, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.389 Vali Acc: 0.895 Test Loss: 0.389 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1011154
	speed: 0.1939s/iter; left time: 8618.7789s
	iters: 200, epoch: 6 | loss: 0.1495628
	speed: 0.0359s/iter; left time: 1592.6033s
	iters: 300, epoch: 6 | loss: 0.1936469
	speed: 0.0343s/iter; left time: 1517.1643s
	iters: 400, epoch: 6 | loss: 0.0850190
	speed: 0.0327s/iter; left time: 1443.7200s
Epoch: 6 cost time: 16.64322066307068
Epoch: 6, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2552962
	speed: 0.2198s/iter; left time: 9668.4129s
	iters: 200, epoch: 7 | loss: 0.1040377
	speed: 0.0342s/iter; left time: 1500.7498s
	iters: 300, epoch: 7 | loss: 0.4692691
	speed: 0.0450s/iter; left time: 1972.1654s
	iters: 400, epoch: 7 | loss: 0.7779307
	speed: 0.0394s/iter; left time: 1720.3175s
Epoch: 7 cost time: 18.266982316970825
Epoch: 7, Steps: 469 | Train Loss: 0.206 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4715739
	speed: 0.2142s/iter; left time: 9321.4729s
	iters: 200, epoch: 8 | loss: 0.0228219
	speed: 0.0326s/iter; left time: 1416.2333s
	iters: 300, epoch: 8 | loss: 0.2530668
	speed: 0.0311s/iter; left time: 1348.5117s
	iters: 400, epoch: 8 | loss: 0.0664499
	speed: 0.0278s/iter; left time: 1201.1964s
Epoch: 8 cost time: 15.218019485473633
Epoch: 8, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0365261
	speed: 0.1890s/iter; left time: 8136.7448s
	iters: 200, epoch: 9 | loss: 0.1140586
	speed: 0.0394s/iter; left time: 1690.6987s
	iters: 300, epoch: 9 | loss: 0.0107238
	speed: 0.0328s/iter; left time: 1407.0431s
	iters: 400, epoch: 9 | loss: 0.0216541
	speed: 0.0340s/iter; left time: 1452.8051s
Epoch: 9 cost time: 17.276206016540527
Epoch: 9, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0021270
	speed: 0.1946s/iter; left time: 8286.2458s
	iters: 200, epoch: 10 | loss: 0.1392403
	speed: 0.0394s/iter; left time: 1675.1985s
	iters: 300, epoch: 10 | loss: 0.0224277
	speed: 0.0381s/iter; left time: 1616.6567s
	iters: 400, epoch: 10 | loss: 0.2909435
	speed: 0.0368s/iter; left time: 1554.4956s
Epoch: 10 cost time: 17.68941617012024
Epoch: 10, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
Validation loss decreased (-0.946825 --> -0.951399).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0126271
	speed: 0.2072s/iter; left time: 8723.7884s
	iters: 200, epoch: 11 | loss: 0.0478123
	speed: 0.0344s/iter; left time: 1444.8007s
	iters: 300, epoch: 11 | loss: 0.3096415
	speed: 0.0359s/iter; left time: 1503.3560s
	iters: 400, epoch: 11 | loss: 0.2184625
	speed: 0.0343s/iter; left time: 1434.5077s
Epoch: 11 cost time: 16.947469234466553
Epoch: 11, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1144200
	speed: 0.2277s/iter; left time: 9481.5953s
	iters: 200, epoch: 12 | loss: 0.0083843
	speed: 0.0356s/iter; left time: 1478.9592s
	iters: 300, epoch: 12 | loss: 0.1563453
	speed: 0.0388s/iter; left time: 1609.4373s
	iters: 400, epoch: 12 | loss: 0.0139742
	speed: 0.0378s/iter; left time: 1563.4385s
Epoch: 12 cost time: 18.233717679977417
Epoch: 12, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0046296
	speed: 0.2228s/iter; left time: 9173.1636s
	iters: 200, epoch: 13 | loss: 0.1746897
	speed: 0.0374s/iter; left time: 1535.5681s
	iters: 300, epoch: 13 | loss: 0.0060588
	speed: 0.0336s/iter; left time: 1374.9402s
	iters: 400, epoch: 13 | loss: 0.1121743
	speed: 0.0345s/iter; left time: 1408.8290s
Epoch: 13 cost time: 17.579912424087524
Epoch: 13, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.263 Vali Acc: 0.938 Test Loss: 0.263 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1408168
	speed: 0.2023s/iter; left time: 8234.1382s
	iters: 200, epoch: 14 | loss: 0.0260743
	speed: 0.0404s/iter; left time: 1641.0551s
	iters: 300, epoch: 14 | loss: 0.1838473
	speed: 0.0398s/iter; left time: 1610.0691s
	iters: 400, epoch: 14 | loss: 0.1344577
	speed: 0.0335s/iter; left time: 1352.5601s
Epoch: 14 cost time: 18.379148244857788
Epoch: 14, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.240 Vali Acc: 0.940 Test Loss: 0.240 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3015763
	speed: 0.2217s/iter; left time: 8922.1019s
	iters: 200, epoch: 15 | loss: 0.0014025
	speed: 0.0306s/iter; left time: 1228.3419s
	iters: 300, epoch: 15 | loss: 0.0025856
	speed: 0.0365s/iter; left time: 1462.7409s
	iters: 400, epoch: 15 | loss: 0.0257628
	speed: 0.0387s/iter; left time: 1547.0564s
Epoch: 15 cost time: 17.28278684616089
Epoch: 15, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.288 Vali Acc: 0.935 Test Loss: 0.288 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.3977230
	speed: 0.2125s/iter; left time: 8449.6145s
	iters: 200, epoch: 16 | loss: 0.0246544
	speed: 0.0339s/iter; left time: 1344.7504s
	iters: 300, epoch: 16 | loss: 0.0958516
	speed: 0.0365s/iter; left time: 1442.9853s
	iters: 400, epoch: 16 | loss: 0.0122804
	speed: 0.0385s/iter; left time: 1519.2955s
Epoch: 16 cost time: 17.57511043548584
Epoch: 16, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0076816
	speed: 0.2205s/iter; left time: 8665.5875s
	iters: 200, epoch: 17 | loss: 0.2542316
	speed: 0.0344s/iter; left time: 1348.6512s
	iters: 300, epoch: 17 | loss: 0.0538766
	speed: 0.0365s/iter; left time: 1425.1752s
	iters: 400, epoch: 17 | loss: 0.0231313
	speed: 0.0368s/iter; left time: 1435.3822s
Epoch: 17 cost time: 17.76878261566162
Epoch: 17, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3061116
	speed: 0.2030s/iter; left time: 7880.7179s
	iters: 200, epoch: 18 | loss: 0.1903339
	speed: 0.0431s/iter; left time: 1670.9412s
	iters: 300, epoch: 18 | loss: 0.0037718
	speed: 0.0370s/iter; left time: 1427.6630s
	iters: 400, epoch: 18 | loss: 0.2565422
	speed: 0.0428s/iter; left time: 1649.9982s
Epoch: 18 cost time: 18.990511655807495
Epoch: 18, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.951399 --> -0.968838).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0037992
	speed: 0.2223s/iter; left time: 8525.3550s
	iters: 200, epoch: 19 | loss: 0.0147475
	speed: 0.0333s/iter; left time: 1273.5559s
	iters: 300, epoch: 19 | loss: 0.0306818
	speed: 0.0302s/iter; left time: 1153.6589s
	iters: 400, epoch: 19 | loss: 0.0070981
	speed: 0.0326s/iter; left time: 1240.6326s
Epoch: 19 cost time: 15.715845346450806
Epoch: 19, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.252 Vali Acc: 0.939 Test Loss: 0.252 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1161297
	speed: 0.1913s/iter; left time: 7247.9880s
	iters: 200, epoch: 20 | loss: 0.0365358
	speed: 0.0323s/iter; left time: 1220.6023s
	iters: 300, epoch: 20 | loss: 0.1567062
	speed: 0.0385s/iter; left time: 1451.8210s
	iters: 400, epoch: 20 | loss: 0.2495152
	speed: 0.0380s/iter; left time: 1430.1327s
Epoch: 20 cost time: 17.819302082061768
Epoch: 20, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0457077
	speed: 0.2101s/iter; left time: 7862.1985s
	iters: 200, epoch: 21 | loss: 0.0279715
	speed: 0.0305s/iter; left time: 1137.0300s
	iters: 300, epoch: 21 | loss: 0.0913209
	speed: 0.0342s/iter; left time: 1274.2193s
	iters: 400, epoch: 21 | loss: 0.1737925
	speed: 0.0312s/iter; left time: 1157.9007s
Epoch: 21 cost time: 15.575859785079956
Epoch: 21, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0089796
	speed: 0.2042s/iter; left time: 7545.9766s
	iters: 200, epoch: 22 | loss: 0.4261884
	speed: 0.0313s/iter; left time: 1152.4790s
	iters: 300, epoch: 22 | loss: 0.0174747
	speed: 0.0289s/iter; left time: 1061.4733s
	iters: 400, epoch: 22 | loss: 0.0044428
	speed: 0.0310s/iter; left time: 1137.9826s
Epoch: 22 cost time: 15.960891246795654
Epoch: 22, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.514 Vali Acc: 0.888 Test Loss: 0.514 Test Acc: 0.888
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0500932
	speed: 0.1968s/iter; left time: 7179.0360s
	iters: 200, epoch: 23 | loss: 0.0290381
	speed: 0.0358s/iter; left time: 1302.7919s
	iters: 300, epoch: 23 | loss: 0.0126590
	speed: 0.0327s/iter; left time: 1186.2005s
	iters: 400, epoch: 23 | loss: 0.2166986
	speed: 0.0369s/iter; left time: 1333.9739s
Epoch: 23 cost time: 16.992194175720215
Epoch: 23, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.2858680
	speed: 0.1859s/iter; left time: 6696.5345s
	iters: 200, epoch: 24 | loss: 0.0041106
	speed: 0.0304s/iter; left time: 1090.7194s
	iters: 300, epoch: 24 | loss: 0.0009681
	speed: 0.0323s/iter; left time: 1156.6479s
	iters: 400, epoch: 24 | loss: 0.0027745
	speed: 0.0357s/iter; left time: 1274.5284s
Epoch: 24 cost time: 15.559767961502075
Epoch: 24, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.4920303
	speed: 0.1833s/iter; left time: 6514.8757s
	iters: 200, epoch: 25 | loss: 0.0114755
	speed: 0.0326s/iter; left time: 1157.2369s
	iters: 300, epoch: 25 | loss: 0.0878934
	speed: 0.0329s/iter; left time: 1161.0861s
	iters: 400, epoch: 25 | loss: 0.2398330
	speed: 0.0299s/iter; left time: 1054.9763s
Epoch: 25 cost time: 14.94547700881958
Epoch: 25, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0763602
	speed: 0.1833s/iter; left time: 6429.5521s
	iters: 200, epoch: 26 | loss: 0.0584169
	speed: 0.0370s/iter; left time: 1294.4968s
	iters: 300, epoch: 26 | loss: 0.0070777
	speed: 0.0342s/iter; left time: 1192.9093s
	iters: 400, epoch: 26 | loss: 0.1365980
	speed: 0.0347s/iter; left time: 1207.2942s
Epoch: 26 cost time: 16.78406071662903
Epoch: 26, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0027657
	speed: 0.1993s/iter; left time: 6897.5530s
	iters: 200, epoch: 27 | loss: 0.2559059
	speed: 0.0320s/iter; left time: 1103.5351s
	iters: 300, epoch: 27 | loss: 0.2926585
	speed: 0.0334s/iter; left time: 1150.0974s
	iters: 400, epoch: 27 | loss: 0.0042272
	speed: 0.0376s/iter; left time: 1289.5421s
Epoch: 27 cost time: 16.756799936294556
Epoch: 27, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0123655
	speed: 0.2214s/iter; left time: 7558.3910s
	iters: 200, epoch: 28 | loss: 0.1023524
	speed: 0.0359s/iter; left time: 1223.0531s
	iters: 300, epoch: 28 | loss: 0.2681775
	speed: 0.0385s/iter; left time: 1307.8896s
	iters: 400, epoch: 28 | loss: 0.0167695
	speed: 0.0379s/iter; left time: 1283.7658s
Epoch: 28 cost time: 18.267030239105225
Epoch: 28, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.968839336763865
model parameter : 4760098
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6515803
	speed: 0.0561s/iter; left time: 2627.5181s
	iters: 200, epoch: 1 | loss: 0.0514917
	speed: 0.0368s/iter; left time: 1716.6304s
	iters: 300, epoch: 1 | loss: 0.1867892
	speed: 0.0424s/iter; left time: 1976.3496s
	iters: 400, epoch: 1 | loss: 0.1379873
	speed: 0.0459s/iter; left time: 2136.1979s
Epoch: 1 cost time: 20.926512002944946
Epoch: 1, Steps: 469 | Train Loss: 0.480 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
Validation loss decreased (inf --> -0.911089).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0803657
	speed: 0.2649s/iter; left time: 12271.4000s
	iters: 200, epoch: 2 | loss: 0.0573464
	speed: 0.0442s/iter; left time: 2045.7122s
	iters: 300, epoch: 2 | loss: 0.0372026
	speed: 0.0408s/iter; left time: 1884.3799s
	iters: 400, epoch: 2 | loss: 0.0988749
	speed: 0.0414s/iter; left time: 1906.9594s
Epoch: 2 cost time: 20.311209201812744
Epoch: 2, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.327 Vali Acc: 0.901 Test Loss: 0.327 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2462173
	speed: 0.2753s/iter; left time: 12627.5525s
	iters: 200, epoch: 3 | loss: 0.3000496
	speed: 0.0482s/iter; left time: 2203.5848s
	iters: 300, epoch: 3 | loss: 0.0358614
	speed: 0.0454s/iter; left time: 2073.2227s
	iters: 400, epoch: 3 | loss: 0.0982946
	speed: 0.0418s/iter; left time: 1906.0305s
Epoch: 3 cost time: 21.46913766860962
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.208 Vali Acc: 0.934 Test Loss: 0.208 Test Acc: 0.934
Validation loss decreased (-0.911089 --> -0.934246).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1101016
	speed: 0.2390s/iter; left time: 10849.7703s
	iters: 200, epoch: 4 | loss: 0.1791986
	speed: 0.0326s/iter; left time: 1475.5164s
	iters: 300, epoch: 4 | loss: 0.0389968
	speed: 0.0371s/iter; left time: 1676.4481s
	iters: 400, epoch: 4 | loss: 0.0383668
	speed: 0.0393s/iter; left time: 1773.5671s
Epoch: 4 cost time: 17.145182132720947
Epoch: 4, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0108626
	speed: 0.2217s/iter; left time: 9960.3404s
	iters: 200, epoch: 5 | loss: 0.0104123
	speed: 0.0362s/iter; left time: 1622.6996s
	iters: 300, epoch: 5 | loss: 0.1006727
	speed: 0.0330s/iter; left time: 1474.9277s
	iters: 400, epoch: 5 | loss: 0.0556579
	speed: 0.0346s/iter; left time: 1545.0393s
Epoch: 5 cost time: 18.261239767074585
Epoch: 5, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.908 Test Loss: 0.305 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0264398
	speed: 0.2202s/iter; left time: 9787.7046s
	iters: 200, epoch: 6 | loss: 0.0060733
	speed: 0.0292s/iter; left time: 1294.2777s
	iters: 300, epoch: 6 | loss: 0.0289149
	speed: 0.0344s/iter; left time: 1520.2259s
	iters: 400, epoch: 6 | loss: 0.0044059
	speed: 0.0409s/iter; left time: 1808.0454s
Epoch: 6 cost time: 16.900614023208618
Epoch: 6, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.185 Vali Acc: 0.945 Test Loss: 0.185 Test Acc: 0.945
Validation loss decreased (-0.934246 --> -0.945110).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0096037
	speed: 0.2402s/iter; left time: 10564.6876s
	iters: 200, epoch: 7 | loss: 0.3495490
	speed: 0.0387s/iter; left time: 1696.3467s
	iters: 300, epoch: 7 | loss: 0.3559342
	speed: 0.0400s/iter; left time: 1751.6999s
	iters: 400, epoch: 7 | loss: 0.0076406
	speed: 0.0379s/iter; left time: 1656.0511s
Epoch: 7 cost time: 19.171597719192505
Epoch: 7, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2138388
	speed: 0.2091s/iter; left time: 9100.0317s
	iters: 200, epoch: 8 | loss: 0.0447968
	speed: 0.0337s/iter; left time: 1464.6994s
	iters: 300, epoch: 8 | loss: 0.0184408
	speed: 0.0316s/iter; left time: 1369.8929s
	iters: 400, epoch: 8 | loss: 0.0887342
	speed: 0.0333s/iter; left time: 1440.2596s
Epoch: 8 cost time: 16.562004327774048
Epoch: 8, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0449939
	speed: 0.2277s/iter; left time: 9802.4477s
	iters: 200, epoch: 9 | loss: 0.2468179
	speed: 0.0417s/iter; left time: 1790.4832s
	iters: 300, epoch: 9 | loss: 0.1204107
	speed: 0.0402s/iter; left time: 1721.5287s
	iters: 400, epoch: 9 | loss: 0.1775316
	speed: 0.0389s/iter; left time: 1662.5071s
Epoch: 9 cost time: 19.27107071876526
Epoch: 9, Steps: 469 | Train Loss: 0.181 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
Validation loss decreased (-0.945110 --> -0.952542).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0092806
	speed: 0.2469s/iter; left time: 10511.7077s
	iters: 200, epoch: 10 | loss: 0.4941161
	speed: 0.0410s/iter; left time: 1741.7175s
	iters: 300, epoch: 10 | loss: 0.1682738
	speed: 0.0422s/iter; left time: 1790.3945s
	iters: 400, epoch: 10 | loss: 0.0101959
	speed: 0.0412s/iter; left time: 1743.6429s
Epoch: 10 cost time: 19.36505913734436
Epoch: 10, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.290 Vali Acc: 0.932 Test Loss: 0.290 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0936934
	speed: 0.2492s/iter; left time: 10495.0524s
	iters: 200, epoch: 11 | loss: 0.1028617
	speed: 0.0441s/iter; left time: 1854.6287s
	iters: 300, epoch: 11 | loss: 0.0111932
	speed: 0.0345s/iter; left time: 1447.6975s
	iters: 400, epoch: 11 | loss: 0.3487842
	speed: 0.0414s/iter; left time: 1731.6430s
Epoch: 11 cost time: 19.915920734405518
Epoch: 11, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0179431
	speed: 0.2240s/iter; left time: 9328.7938s
	iters: 200, epoch: 12 | loss: 0.0186742
	speed: 0.0416s/iter; left time: 1729.8397s
	iters: 300, epoch: 12 | loss: 0.2180867
	speed: 0.0392s/iter; left time: 1624.5561s
	iters: 400, epoch: 12 | loss: 0.2147736
	speed: 0.0368s/iter; left time: 1521.2366s
Epoch: 12 cost time: 18.880905628204346
Epoch: 12, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0264267
	speed: 0.2447s/iter; left time: 10074.7004s
	iters: 200, epoch: 13 | loss: 0.0063039
	speed: 0.0438s/iter; left time: 1798.1371s
	iters: 300, epoch: 13 | loss: 0.0151605
	speed: 0.0382s/iter; left time: 1565.5784s
	iters: 400, epoch: 13 | loss: 0.2687615
	speed: 0.0380s/iter; left time: 1553.2379s
Epoch: 13 cost time: 19.443823099136353
Epoch: 13, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.250 Vali Acc: 0.934 Test Loss: 0.250 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0051816
	speed: 0.2154s/iter; left time: 8766.8188s
	iters: 200, epoch: 14 | loss: 0.3320726
	speed: 0.0340s/iter; left time: 1381.8642s
	iters: 300, epoch: 14 | loss: 0.0828737
	speed: 0.0329s/iter; left time: 1333.4795s
	iters: 400, epoch: 14 | loss: 0.0825496
	speed: 0.0286s/iter; left time: 1155.6605s
Epoch: 14 cost time: 15.856680870056152
Epoch: 14, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.215 Vali Acc: 0.936 Test Loss: 0.215 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0073975
	speed: 0.2297s/iter; left time: 9241.4815s
	iters: 200, epoch: 15 | loss: 0.2199902
	speed: 0.0424s/iter; left time: 1703.0599s
	iters: 300, epoch: 15 | loss: 0.0787584
	speed: 0.0373s/iter; left time: 1492.3486s
	iters: 400, epoch: 15 | loss: 0.1613039
	speed: 0.0380s/iter; left time: 1518.9356s
Epoch: 15 cost time: 18.553168535232544
Epoch: 15, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1702153
	speed: 0.2228s/iter; left time: 8861.5919s
	iters: 200, epoch: 16 | loss: 0.0521561
	speed: 0.0355s/iter; left time: 1406.6857s
	iters: 300, epoch: 16 | loss: 0.0225545
	speed: 0.0348s/iter; left time: 1376.0971s
	iters: 400, epoch: 16 | loss: 0.1951111
	speed: 0.0357s/iter; left time: 1409.9240s
Epoch: 16 cost time: 17.205788373947144
Epoch: 16, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.331 Vali Acc: 0.934 Test Loss: 0.331 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0273789
	speed: 0.2092s/iter; left time: 8222.0871s
	iters: 200, epoch: 17 | loss: 0.0743830
	speed: 0.0343s/iter; left time: 1346.2353s
	iters: 300, epoch: 17 | loss: 0.1398415
	speed: 0.0386s/iter; left time: 1510.9793s
	iters: 400, epoch: 17 | loss: 0.0215908
	speed: 0.0388s/iter; left time: 1513.7056s
Epoch: 17 cost time: 18.008556127548218
Epoch: 17, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1282167
	speed: 0.2126s/iter; left time: 8253.1218s
	iters: 200, epoch: 18 | loss: 0.0064320
	speed: 0.0301s/iter; left time: 1166.3178s
	iters: 300, epoch: 18 | loss: 0.0784993
	speed: 0.0371s/iter; left time: 1431.7801s
	iters: 400, epoch: 18 | loss: 0.2453027
	speed: 0.0342s/iter; left time: 1317.1550s
Epoch: 18 cost time: 16.68865156173706
Epoch: 18, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0811670
	speed: 0.2420s/iter; left time: 9281.5612s
	iters: 200, epoch: 19 | loss: 0.1833057
	speed: 0.0369s/iter; left time: 1413.2047s
	iters: 300, epoch: 19 | loss: 0.0135399
	speed: 0.0386s/iter; left time: 1473.8218s
	iters: 400, epoch: 19 | loss: 0.0183755
	speed: 0.0367s/iter; left time: 1397.9283s
Epoch: 19 cost time: 18.978672742843628
Epoch: 19, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
Validation loss decreased (-0.952542 --> -0.955115).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2313909
	speed: 0.2454s/iter; left time: 9296.9159s
	iters: 200, epoch: 20 | loss: 0.0461308
	speed: 0.0361s/iter; left time: 1362.6783s
	iters: 300, epoch: 20 | loss: 0.0731363
	speed: 0.0374s/iter; left time: 1409.2968s
	iters: 400, epoch: 20 | loss: 0.0117165
	speed: 0.0341s/iter; left time: 1281.8190s
Epoch: 20 cost time: 18.33776330947876
Epoch: 20, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.219 Vali Acc: 0.945 Test Loss: 0.219 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0842394
	speed: 0.2457s/iter; left time: 9195.4653s
	iters: 200, epoch: 21 | loss: 0.0205302
	speed: 0.0363s/iter; left time: 1356.5491s
	iters: 300, epoch: 21 | loss: 0.0074279
	speed: 0.0332s/iter; left time: 1236.6558s
	iters: 400, epoch: 21 | loss: 0.0132431
	speed: 0.0338s/iter; left time: 1255.6361s
Epoch: 21 cost time: 17.30855894088745
Epoch: 21, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.955115 --> -0.958260).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1096463
	speed: 0.2147s/iter; left time: 7933.9530s
	iters: 200, epoch: 22 | loss: 0.1889258
	speed: 0.0401s/iter; left time: 1477.8555s
	iters: 300, epoch: 22 | loss: 0.1509937
	speed: 0.0397s/iter; left time: 1459.8311s
	iters: 400, epoch: 22 | loss: 0.0147263
	speed: 0.0383s/iter; left time: 1403.9825s
Epoch: 22 cost time: 19.8616201877594
Epoch: 22, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
Validation loss decreased (-0.958260 --> -0.961119).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0114979
	speed: 0.2545s/iter; left time: 9283.3634s
	iters: 200, epoch: 23 | loss: 0.0656996
	speed: 0.0450s/iter; left time: 1637.5543s
	iters: 300, epoch: 23 | loss: 0.1625778
	speed: 0.0436s/iter; left time: 1582.0622s
	iters: 400, epoch: 23 | loss: 0.0268709
	speed: 0.0435s/iter; left time: 1572.2513s
Epoch: 23 cost time: 20.434731245040894
Epoch: 23, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1253640
	speed: 0.2275s/iter; left time: 8193.0108s
	iters: 200, epoch: 24 | loss: 0.0216433
	speed: 0.0383s/iter; left time: 1375.6512s
	iters: 300, epoch: 24 | loss: 0.0196935
	speed: 0.0353s/iter; left time: 1265.2808s
	iters: 400, epoch: 24 | loss: 0.1141673
	speed: 0.0375s/iter; left time: 1339.1211s
Epoch: 24 cost time: 17.544229745864868
Epoch: 24, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.961119 --> -0.961977).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2105843
	speed: 0.2090s/iter; left time: 7428.5025s
	iters: 200, epoch: 25 | loss: 0.0195158
	speed: 0.0339s/iter; left time: 1200.8415s
	iters: 300, epoch: 25 | loss: 0.0022254
	speed: 0.0322s/iter; left time: 1137.6482s
	iters: 400, epoch: 25 | loss: 0.0050955
	speed: 0.0303s/iter; left time: 1069.3118s
Epoch: 25 cost time: 16.07062005996704
Epoch: 25, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1797662
	speed: 0.2001s/iter; left time: 7019.7825s
	iters: 200, epoch: 26 | loss: 0.0702602
	speed: 0.0366s/iter; left time: 1279.8616s
	iters: 300, epoch: 26 | loss: 0.0088348
	speed: 0.0327s/iter; left time: 1138.9688s
	iters: 400, epoch: 26 | loss: 0.0349170
	speed: 0.0407s/iter; left time: 1414.0554s
Epoch: 26 cost time: 17.632894277572632
Epoch: 26, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.214 Vali Acc: 0.954 Test Loss: 0.214 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0020582
	speed: 0.1942s/iter; left time: 6721.8657s
	iters: 200, epoch: 27 | loss: 0.0216413
	speed: 0.0332s/iter; left time: 1146.6650s
	iters: 300, epoch: 27 | loss: 0.0029063
	speed: 0.0318s/iter; left time: 1095.0567s
	iters: 400, epoch: 27 | loss: 0.2532102
	speed: 0.0321s/iter; left time: 1101.6917s
Epoch: 27 cost time: 15.782444715499878
Epoch: 27, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0072787
	speed: 0.1695s/iter; left time: 5786.1416s
	iters: 200, epoch: 28 | loss: 0.0560908
	speed: 0.0256s/iter; left time: 872.0993s
	iters: 300, epoch: 28 | loss: 0.4339119
	speed: 0.0276s/iter; left time: 938.0090s
	iters: 400, epoch: 28 | loss: 0.0585252
	speed: 0.0265s/iter; left time: 897.0478s
Epoch: 28 cost time: 12.908663272857666
Epoch: 28, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.961977 --> -0.963406).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.5889544
	speed: 0.1624s/iter; left time: 5468.3077s
	iters: 200, epoch: 29 | loss: 0.1748945
	speed: 0.0306s/iter; left time: 1026.5730s
	iters: 300, epoch: 29 | loss: 0.0020581
	speed: 0.0309s/iter; left time: 1035.0769s
	iters: 400, epoch: 29 | loss: 0.0009878
	speed: 0.0324s/iter; left time: 1082.4320s
Epoch: 29 cost time: 14.725040674209595
Epoch: 29, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0141485
	speed: 0.1785s/iter; left time: 5927.5128s
	iters: 200, epoch: 30 | loss: 0.0022410
	speed: 0.0357s/iter; left time: 1180.0460s
	iters: 300, epoch: 30 | loss: 0.0158648
	speed: 0.0359s/iter; left time: 1184.2309s
	iters: 400, epoch: 30 | loss: 0.0027107
	speed: 0.0370s/iter; left time: 1216.8128s
Epoch: 30 cost time: 17.711739778518677
Epoch: 30, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.208 Vali Acc: 0.945 Test Loss: 0.208 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0318970
	speed: 0.2208s/iter; left time: 7228.6032s
	iters: 200, epoch: 31 | loss: 0.0969318
	speed: 0.0359s/iter; left time: 1170.9384s
	iters: 300, epoch: 31 | loss: 0.0056652
	speed: 0.0377s/iter; left time: 1225.9843s
	iters: 400, epoch: 31 | loss: 0.0033613
	speed: 0.0385s/iter; left time: 1249.5901s
Epoch: 31 cost time: 18.04294228553772
Epoch: 31, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0301948
	speed: 0.2059s/iter; left time: 6641.2123s
	iters: 200, epoch: 32 | loss: 0.1302312
	speed: 0.0370s/iter; left time: 1189.5923s
	iters: 300, epoch: 32 | loss: 0.1349536
	speed: 0.0297s/iter; left time: 950.7550s
	iters: 400, epoch: 32 | loss: 0.2716164
	speed: 0.0306s/iter; left time: 977.4718s
Epoch: 32 cost time: 15.969072103500366
Epoch: 32, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0066546
	speed: 0.2220s/iter; left time: 7059.5759s
	iters: 200, epoch: 33 | loss: 0.0028507
	speed: 0.0333s/iter; left time: 1056.6249s
	iters: 300, epoch: 33 | loss: 0.1096452
	speed: 0.0396s/iter; left time: 1252.2713s
	iters: 400, epoch: 33 | loss: 0.0023078
	speed: 0.0374s/iter; left time: 1178.8058s
Epoch: 33 cost time: 17.938448905944824
Epoch: 33, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
Validation loss decreased (-0.963406 --> -0.965693).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.6843805
	speed: 0.2181s/iter; left time: 6833.1329s
	iters: 200, epoch: 34 | loss: 0.0111418
	speed: 0.0437s/iter; left time: 1365.8138s
	iters: 300, epoch: 34 | loss: 0.1663811
	speed: 0.0410s/iter; left time: 1274.9103s
	iters: 400, epoch: 34 | loss: 0.0485466
	speed: 0.0351s/iter; left time: 1089.6267s
Epoch: 34 cost time: 19.39439582824707
Epoch: 34, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.1595960
	speed: 0.2230s/iter; left time: 6881.9633s
	iters: 200, epoch: 35 | loss: 0.0426354
	speed: 0.0364s/iter; left time: 1119.6018s
	iters: 300, epoch: 35 | loss: 0.0043474
	speed: 0.0385s/iter; left time: 1181.2693s
	iters: 400, epoch: 35 | loss: 0.0034316
	speed: 0.0348s/iter; left time: 1064.8207s
Epoch: 35 cost time: 17.441705465316772
Epoch: 35, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.379 Vali Acc: 0.909 Test Loss: 0.379 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0182823
	speed: 0.2134s/iter; left time: 6483.0705s
	iters: 200, epoch: 36 | loss: 0.0016176
	speed: 0.0380s/iter; left time: 1150.1802s
	iters: 300, epoch: 36 | loss: 0.0040571
	speed: 0.0369s/iter; left time: 1113.2232s
	iters: 400, epoch: 36 | loss: 0.0350702
	speed: 0.0321s/iter; left time: 966.5605s
Epoch: 36 cost time: 17.563262701034546
Epoch: 36, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.222 Vali Acc: 0.947 Test Loss: 0.222 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0003054
	speed: 0.2049s/iter; left time: 6130.6800s
	iters: 200, epoch: 37 | loss: 0.0016336
	speed: 0.0369s/iter; left time: 1099.4665s
	iters: 300, epoch: 37 | loss: 0.0144182
	speed: 0.0379s/iter; left time: 1124.8240s
	iters: 400, epoch: 37 | loss: 0.0175511
	speed: 0.0329s/iter; left time: 973.3706s
Epoch: 37 cost time: 17.31309199333191
Epoch: 37, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
Validation loss decreased (-0.965693 --> -0.965979).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.1521014
	speed: 0.2272s/iter; left time: 6690.6850s
	iters: 200, epoch: 38 | loss: 0.3518391
	speed: 0.0431s/iter; left time: 1265.8496s
	iters: 300, epoch: 38 | loss: 0.0039904
	speed: 0.0404s/iter; left time: 1181.3744s
	iters: 400, epoch: 38 | loss: 0.1633557
	speed: 0.0347s/iter; left time: 1011.4616s
Epoch: 38 cost time: 18.33508062362671
Epoch: 38, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0705128
	speed: 0.1875s/iter; left time: 5434.8838s
	iters: 200, epoch: 39 | loss: 0.0560194
	speed: 0.0316s/iter; left time: 913.8267s
	iters: 300, epoch: 39 | loss: 0.0101756
	speed: 0.0315s/iter; left time: 906.5715s
	iters: 400, epoch: 39 | loss: 0.0323345
	speed: 0.0339s/iter; left time: 971.5238s
Epoch: 39 cost time: 15.720177173614502
Epoch: 39, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.965979 --> -0.965979).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0162887
	speed: 0.2260s/iter; left time: 6442.9453s
	iters: 200, epoch: 40 | loss: 0.0281428
	speed: 0.0356s/iter; left time: 1012.5827s
	iters: 300, epoch: 40 | loss: 0.1685455
	speed: 0.0360s/iter; left time: 1019.4779s
	iters: 400, epoch: 40 | loss: 0.0284759
	speed: 0.0345s/iter; left time: 974.5708s
Epoch: 40 cost time: 16.778129816055298
Epoch: 40, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0496171
	speed: 0.2204s/iter; left time: 6179.7447s
	iters: 200, epoch: 41 | loss: 0.1880455
	speed: 0.0389s/iter; left time: 1087.5063s
	iters: 300, epoch: 41 | loss: 0.0034526
	speed: 0.0347s/iter; left time: 965.5438s
	iters: 400, epoch: 41 | loss: 0.0009634
	speed: 0.0317s/iter; left time: 879.2078s
Epoch: 41 cost time: 16.74292802810669
Epoch: 41, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.190 Vali Acc: 0.966 Test Loss: 0.190 Test Acc: 0.966
Validation loss decreased (-0.965979 --> -0.966265).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0016267
	speed: 0.1856s/iter; left time: 5116.9721s
	iters: 200, epoch: 42 | loss: 0.0414139
	speed: 0.0316s/iter; left time: 867.3426s
	iters: 300, epoch: 42 | loss: 0.0031313
	speed: 0.0291s/iter; left time: 795.4373s
	iters: 400, epoch: 42 | loss: 0.0198996
	speed: 0.0269s/iter; left time: 732.4592s
Epoch: 42 cost time: 14.135931015014648
Epoch: 42, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.0018223
	speed: 0.1884s/iter; left time: 5107.4238s
	iters: 200, epoch: 43 | loss: 1.1660348
	speed: 0.0340s/iter; left time: 919.2441s
	iters: 300, epoch: 43 | loss: 0.2098345
	speed: 0.0322s/iter; left time: 866.9044s
	iters: 400, epoch: 43 | loss: 0.0037096
	speed: 0.0331s/iter; left time: 886.0663s
Epoch: 43 cost time: 16.372169733047485
Epoch: 43, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.0026428
	speed: 0.2175s/iter; left time: 5794.0712s
	iters: 200, epoch: 44 | loss: 0.0019794
	speed: 0.0383s/iter; left time: 1016.5417s
	iters: 300, epoch: 44 | loss: 0.0024411
	speed: 0.0420s/iter; left time: 1109.4631s
	iters: 400, epoch: 44 | loss: 0.0015808
	speed: 0.0373s/iter; left time: 981.3564s
Epoch: 44 cost time: 18.98352336883545
Epoch: 44, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.0024037
	speed: 0.2138s/iter; left time: 5593.6287s
	iters: 200, epoch: 45 | loss: 0.0385833
	speed: 0.0350s/iter; left time: 911.0097s
	iters: 300, epoch: 45 | loss: 0.0009954
	speed: 0.0354s/iter; left time: 919.5130s
	iters: 400, epoch: 45 | loss: 0.0045698
	speed: 0.0341s/iter; left time: 882.5356s
Epoch: 45 cost time: 16.242821216583252
Epoch: 45, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 0.0650033
	speed: 0.1901s/iter; left time: 4883.6787s
	iters: 200, epoch: 46 | loss: 0.0082844
	speed: 0.0326s/iter; left time: 833.7084s
	iters: 300, epoch: 46 | loss: 0.4420569
	speed: 0.0345s/iter; left time: 880.1496s
	iters: 400, epoch: 46 | loss: 0.0049049
	speed: 0.0355s/iter; left time: 900.9107s
Epoch: 46 cost time: 16.030089855194092
Epoch: 46, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.1120143
	speed: 0.1939s/iter; left time: 4892.2974s
	iters: 200, epoch: 47 | loss: 0.0003122
	speed: 0.0338s/iter; left time: 850.4069s
	iters: 300, epoch: 47 | loss: 0.0008856
	speed: 0.0353s/iter; left time: 884.1648s
	iters: 400, epoch: 47 | loss: 0.0049107
	speed: 0.0364s/iter; left time: 908.5682s
Epoch: 47 cost time: 16.71877384185791
Epoch: 47, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 0.0170489
	speed: 0.2105s/iter; left time: 5210.8206s
	iters: 200, epoch: 48 | loss: 0.0061073
	speed: 0.0359s/iter; left time: 884.1704s
	iters: 300, epoch: 48 | loss: 0.4220622
	speed: 0.0371s/iter; left time: 910.1494s
	iters: 400, epoch: 48 | loss: 0.0008987
	speed: 0.0360s/iter; left time: 881.6727s
Epoch: 48 cost time: 17.48540496826172
Epoch: 48, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.0359611
	speed: 0.1915s/iter; left time: 4652.5141s
	iters: 200, epoch: 49 | loss: 0.0046136
	speed: 0.0312s/iter; left time: 753.7999s
	iters: 300, epoch: 49 | loss: 0.0061889
	speed: 0.0322s/iter; left time: 776.1392s
	iters: 400, epoch: 49 | loss: 0.0062489
	speed: 0.0303s/iter; left time: 725.9785s
Epoch: 49 cost time: 14.868047714233398
Epoch: 49, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.967408).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0034839
	speed: 0.1917s/iter; left time: 4567.0165s
	iters: 200, epoch: 50 | loss: 0.0041864
	speed: 0.0338s/iter; left time: 801.0508s
	iters: 300, epoch: 50 | loss: 0.0006959
	speed: 0.0340s/iter; left time: 803.5310s
	iters: 400, epoch: 50 | loss: 0.0294396
	speed: 0.0333s/iter; left time: 782.2443s
Epoch: 50 cost time: 16.348268270492554
Epoch: 50, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0023198
	speed: 0.2059s/iter; left time: 4808.3923s
	iters: 200, epoch: 51 | loss: 0.0006955
	speed: 0.0362s/iter; left time: 841.0106s
	iters: 300, epoch: 51 | loss: 0.0530823
	speed: 0.0331s/iter; left time: 766.6316s
	iters: 400, epoch: 51 | loss: 0.0260601
	speed: 0.0375s/iter; left time: 863.5175s
Epoch: 51 cost time: 16.631659507751465
Epoch: 51, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0155686
	speed: 0.2101s/iter; left time: 4806.4126s
	iters: 200, epoch: 52 | loss: 0.0223191
	speed: 0.0291s/iter; left time: 663.7260s
	iters: 300, epoch: 52 | loss: 0.0032303
	speed: 0.0287s/iter; left time: 652.0302s
	iters: 400, epoch: 52 | loss: 0.0067463
	speed: 0.0305s/iter; left time: 689.4725s
Epoch: 52 cost time: 14.985330581665039
Epoch: 52, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0017282
	speed: 0.2194s/iter; left time: 4917.8518s
	iters: 200, epoch: 53 | loss: 0.1723680
	speed: 0.0378s/iter; left time: 843.3283s
	iters: 300, epoch: 53 | loss: 0.0019377
	speed: 0.0299s/iter; left time: 665.0504s
	iters: 400, epoch: 53 | loss: 0.1377845
	speed: 0.0329s/iter; left time: 728.5633s
Epoch: 53 cost time: 16.543750762939453
Epoch: 53, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.0014309
	speed: 0.1928s/iter; left time: 4231.6284s
	iters: 200, epoch: 54 | loss: 0.2705750
	speed: 0.0363s/iter; left time: 793.5349s
	iters: 300, epoch: 54 | loss: 0.0071929
	speed: 0.0327s/iter; left time: 710.3642s
	iters: 400, epoch: 54 | loss: 0.0022290
	speed: 0.0331s/iter; left time: 716.4141s
Epoch: 54 cost time: 16.56442928314209
Epoch: 54, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 0.0046266
	speed: 0.1846s/iter; left time: 3964.8824s
	iters: 200, epoch: 55 | loss: 0.0441114
	speed: 0.0361s/iter; left time: 772.1123s
	iters: 300, epoch: 55 | loss: 0.0011491
	speed: 0.0287s/iter; left time: 609.7941s
	iters: 400, epoch: 55 | loss: 0.0003959
	speed: 0.0344s/iter; left time: 728.9031s
Epoch: 55 cost time: 16.355714082717896
Epoch: 55, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.945 Test Loss: 0.220 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 0.0888444
	speed: 0.2011s/iter; left time: 4224.2662s
	iters: 200, epoch: 56 | loss: 0.0034046
	speed: 0.0292s/iter; left time: 610.8825s
	iters: 300, epoch: 56 | loss: 0.0021464
	speed: 0.0338s/iter; left time: 702.4279s
	iters: 400, epoch: 56 | loss: 0.0005926
	speed: 0.0355s/iter; left time: 734.6408s
Epoch: 56 cost time: 15.512721061706543
Epoch: 56, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.967408 --> -0.969410).  Saving model ...
	iters: 100, epoch: 57 | loss: 0.0287051
	speed: 0.2283s/iter; left time: 4688.5320s
	iters: 200, epoch: 57 | loss: 0.0052735
	speed: 0.0424s/iter; left time: 865.7734s
	iters: 300, epoch: 57 | loss: 0.0018584
	speed: 0.0344s/iter; left time: 699.8872s
	iters: 400, epoch: 57 | loss: 0.0051471
	speed: 0.0325s/iter; left time: 657.1830s
Epoch: 57 cost time: 17.949179649353027
Epoch: 57, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 58 | loss: 0.0018149
	speed: 0.2152s/iter; left time: 4317.7296s
	iters: 200, epoch: 58 | loss: 0.0356686
	speed: 0.0417s/iter; left time: 831.9307s
	iters: 300, epoch: 58 | loss: 0.0128212
	speed: 0.0338s/iter; left time: 671.7033s
	iters: 400, epoch: 58 | loss: 0.0021378
	speed: 0.0345s/iter; left time: 681.5626s
Epoch: 58 cost time: 17.712103605270386
Epoch: 58, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.971125).  Saving model ...
	iters: 100, epoch: 59 | loss: 0.0005911
	speed: 0.2047s/iter; left time: 4012.6693s
	iters: 200, epoch: 59 | loss: 0.3180615
	speed: 0.0309s/iter; left time: 603.0394s
	iters: 300, epoch: 59 | loss: 0.4291885
	speed: 0.0323s/iter; left time: 627.2357s
	iters: 400, epoch: 59 | loss: 0.0033898
	speed: 0.0346s/iter; left time: 667.9238s
Epoch: 59 cost time: 15.796333312988281
Epoch: 59, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 60 | loss: 0.0047010
	speed: 0.1848s/iter; left time: 3534.8869s
	iters: 200, epoch: 60 | loss: 0.0043726
	speed: 0.0309s/iter; left time: 588.0471s
	iters: 300, epoch: 60 | loss: 0.0021190
	speed: 0.0340s/iter; left time: 642.9876s
	iters: 400, epoch: 60 | loss: 0.0456710
	speed: 0.0309s/iter; left time: 581.6433s
Epoch: 60 cost time: 15.553714513778687
Epoch: 60, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 61 | loss: 0.1370390
	speed: 0.1925s/iter; left time: 3591.7519s
	iters: 200, epoch: 61 | loss: 0.0033032
	speed: 0.0333s/iter; left time: 617.5651s
	iters: 300, epoch: 61 | loss: 0.0802276
	speed: 0.0337s/iter; left time: 622.0918s
	iters: 400, epoch: 61 | loss: 0.0498343
	speed: 0.0388s/iter; left time: 712.9627s
Epoch: 61 cost time: 17.079983711242676
Epoch: 61, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 62 | loss: 0.0085462
	speed: 0.2293s/iter; left time: 4171.5655s
	iters: 200, epoch: 62 | loss: 0.0136079
	speed: 0.0350s/iter; left time: 633.3871s
	iters: 300, epoch: 62 | loss: 0.0012331
	speed: 0.0398s/iter; left time: 716.3207s
	iters: 400, epoch: 62 | loss: 0.0010049
	speed: 0.0399s/iter; left time: 713.8467s
Epoch: 62 cost time: 18.466265201568604
Epoch: 62, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 63 | loss: 0.0007757
	speed: 0.1959s/iter; left time: 3472.5554s
	iters: 200, epoch: 63 | loss: 0.0551335
	speed: 0.0342s/iter; left time: 602.3428s
	iters: 300, epoch: 63 | loss: 0.0107827
	speed: 0.0334s/iter; left time: 584.4277s
	iters: 400, epoch: 63 | loss: 0.0064301
	speed: 0.0332s/iter; left time: 579.0299s
Epoch: 63 cost time: 16.91911745071411
Epoch: 63, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 64 | loss: 0.0589234
	speed: 0.1946s/iter; left time: 3357.3060s
	iters: 200, epoch: 64 | loss: 0.0021594
	speed: 0.0279s/iter; left time: 478.6832s
	iters: 300, epoch: 64 | loss: 0.0166594
	speed: 0.0283s/iter; left time: 482.2080s
	iters: 400, epoch: 64 | loss: 0.0560850
	speed: 0.0319s/iter; left time: 541.4171s
Epoch: 64 cost time: 13.983102083206177
Epoch: 64, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 65 | loss: 0.0248883
	speed: 0.1695s/iter; left time: 2844.9773s
	iters: 200, epoch: 65 | loss: 0.0173291
	speed: 0.0336s/iter; left time: 561.3077s
	iters: 300, epoch: 65 | loss: 0.0123937
	speed: 0.0295s/iter; left time: 489.4264s
	iters: 400, epoch: 65 | loss: 0.0055340
	speed: 0.0298s/iter; left time: 490.6778s
Epoch: 65 cost time: 15.088168621063232
Epoch: 65, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 66 | loss: 0.0009892
	speed: 0.1910s/iter; left time: 3116.4226s
	iters: 200, epoch: 66 | loss: 0.0022480
	speed: 0.0323s/iter; left time: 523.4318s
	iters: 300, epoch: 66 | loss: 0.0003670
	speed: 0.0335s/iter; left time: 540.5260s
	iters: 400, epoch: 66 | loss: 0.0659146
	speed: 0.0389s/iter; left time: 622.9834s
Epoch: 66 cost time: 17.404896020889282
Epoch: 66, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 67 | loss: 0.0025430
	speed: 0.2138s/iter; left time: 3387.5585s
	iters: 200, epoch: 67 | loss: 0.0023162
	speed: 0.0332s/iter; left time: 522.0646s
	iters: 300, epoch: 67 | loss: 0.0078178
	speed: 0.0336s/iter; left time: 525.9601s
	iters: 400, epoch: 67 | loss: 0.0547777
	speed: 0.0310s/iter; left time: 481.7293s
Epoch: 67 cost time: 15.985795497894287
Epoch: 67, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 68 | loss: 0.0007806
	speed: 0.1787s/iter; left time: 2748.4099s
	iters: 200, epoch: 68 | loss: 0.0021759
	speed: 0.0368s/iter; left time: 561.6542s
	iters: 300, epoch: 68 | loss: 0.0016012
	speed: 0.0359s/iter; left time: 545.5678s
	iters: 400, epoch: 68 | loss: 0.0654519
	speed: 0.0348s/iter; left time: 524.7899s
Epoch: 68 cost time: 17.738154411315918
Epoch: 68, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9711263579188107
model parameter : 4759842
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4384601
	speed: 0.0538s/iter; left time: 2517.8392s
	iters: 200, epoch: 1 | loss: 0.1772328
	speed: 0.0312s/iter; left time: 1455.4417s
	iters: 300, epoch: 1 | loss: 0.2492730
	speed: 0.0350s/iter; left time: 1630.3471s
	iters: 400, epoch: 1 | loss: 0.0598342
	speed: 0.0321s/iter; left time: 1491.1463s
Epoch: 1 cost time: 17.209089279174805
Epoch: 1, Steps: 469 | Train Loss: 0.471 Vali Loss: 0.215 Vali Acc: 0.934 Test Loss: 0.215 Test Acc: 0.934
Validation loss decreased (inf --> -0.933960).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1375864
	speed: 0.1562s/iter; left time: 7235.6437s
	iters: 200, epoch: 2 | loss: 0.1278712
	speed: 0.0269s/iter; left time: 1242.9817s
	iters: 300, epoch: 2 | loss: 0.2866809
	speed: 0.0295s/iter; left time: 1361.4513s
	iters: 400, epoch: 2 | loss: 0.5045316
	speed: 0.0280s/iter; left time: 1290.5690s
Epoch: 2 cost time: 13.788196325302124
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1079836
	speed: 0.1785s/iter; left time: 8187.2364s
	iters: 200, epoch: 3 | loss: 0.0558489
	speed: 0.0320s/iter; left time: 1462.1994s
	iters: 300, epoch: 3 | loss: 0.0285105
	speed: 0.0337s/iter; left time: 1539.3980s
	iters: 400, epoch: 3 | loss: 0.0131652
	speed: 0.0336s/iter; left time: 1529.4835s
Epoch: 3 cost time: 15.646870374679565
Epoch: 3, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.339 Vali Acc: 0.905 Test Loss: 0.339 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0259362
	speed: 0.1991s/iter; left time: 9038.8123s
	iters: 200, epoch: 4 | loss: 0.2851844
	speed: 0.0309s/iter; left time: 1397.5641s
	iters: 300, epoch: 4 | loss: 0.1171695
	speed: 0.0368s/iter; left time: 1662.2950s
	iters: 400, epoch: 4 | loss: 0.0563548
	speed: 0.0306s/iter; left time: 1377.9331s
Epoch: 4 cost time: 15.785690546035767
Epoch: 4, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0059500
	speed: 0.1987s/iter; left time: 8924.6810s
	iters: 200, epoch: 5 | loss: 0.0658671
	speed: 0.0314s/iter; left time: 1406.9074s
	iters: 300, epoch: 5 | loss: 0.0105077
	speed: 0.0317s/iter; left time: 1417.6722s
	iters: 400, epoch: 5 | loss: 0.0118781
	speed: 0.0273s/iter; left time: 1218.9919s
Epoch: 5 cost time: 14.338885068893433
Epoch: 5, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.933960 --> -0.941107).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0235491
	speed: 0.1684s/iter; left time: 7485.5331s
	iters: 200, epoch: 6 | loss: 0.0074591
	speed: 0.0303s/iter; left time: 1346.0507s
	iters: 300, epoch: 6 | loss: 0.1951200
	speed: 0.0300s/iter; left time: 1327.5527s
	iters: 400, epoch: 6 | loss: 0.0705457
	speed: 0.0315s/iter; left time: 1388.9696s
Epoch: 6 cost time: 15.496752738952637
Epoch: 6, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.258 Vali Acc: 0.934 Test Loss: 0.258 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0544837
	speed: 0.1947s/iter; left time: 8566.2045s
	iters: 200, epoch: 7 | loss: 0.0337402
	speed: 0.0296s/iter; left time: 1298.0033s
	iters: 300, epoch: 7 | loss: 0.0105860
	speed: 0.0367s/iter; left time: 1605.0624s
	iters: 400, epoch: 7 | loss: 0.0428235
	speed: 0.0319s/iter; left time: 1391.6089s
Epoch: 7 cost time: 15.779887914657593
Epoch: 7, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.941107 --> -0.951685).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0045180
	speed: 0.2056s/iter; left time: 8949.3575s
	iters: 200, epoch: 8 | loss: 0.0059355
	speed: 0.0341s/iter; left time: 1479.4831s
	iters: 300, epoch: 8 | loss: 0.0200596
	speed: 0.0342s/iter; left time: 1483.4951s
	iters: 400, epoch: 8 | loss: 0.2454846
	speed: 0.0378s/iter; left time: 1633.1160s
Epoch: 8 cost time: 17.065845489501953
Epoch: 8, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1012553
	speed: 0.1807s/iter; left time: 7778.6570s
	iters: 200, epoch: 9 | loss: 0.5907841
	speed: 0.0370s/iter; left time: 1587.1096s
	iters: 300, epoch: 9 | loss: 0.0041925
	speed: 0.0291s/iter; left time: 1248.4694s
	iters: 400, epoch: 9 | loss: 0.0066066
	speed: 0.0292s/iter; left time: 1247.1731s
Epoch: 9 cost time: 15.461984634399414
Epoch: 9, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2338412
	speed: 0.1922s/iter; left time: 8183.6297s
	iters: 200, epoch: 10 | loss: 0.2864580
	speed: 0.0289s/iter; left time: 1229.3360s
	iters: 300, epoch: 10 | loss: 0.0753209
	speed: 0.0322s/iter; left time: 1366.6368s
	iters: 400, epoch: 10 | loss: 0.0962784
	speed: 0.0333s/iter; left time: 1409.1179s
Epoch: 10 cost time: 15.654210090637207
Epoch: 10, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1241215
	speed: 0.1912s/iter; left time: 8050.0367s
	iters: 200, epoch: 11 | loss: 0.0475061
	speed: 0.0295s/iter; left time: 1238.3796s
	iters: 300, epoch: 11 | loss: 0.0016765
	speed: 0.0287s/iter; left time: 1202.2933s
	iters: 400, epoch: 11 | loss: 0.0239571
	speed: 0.0337s/iter; left time: 1409.8487s
Epoch: 11 cost time: 15.587065935134888
Epoch: 11, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.286 Vali Acc: 0.934 Test Loss: 0.286 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2349439
	speed: 0.1871s/iter; left time: 7791.4475s
	iters: 200, epoch: 12 | loss: 0.2832006
	speed: 0.0285s/iter; left time: 1184.8716s
	iters: 300, epoch: 12 | loss: 0.0798385
	speed: 0.0285s/iter; left time: 1179.8579s
	iters: 400, epoch: 12 | loss: 0.1323771
	speed: 0.0286s/iter; left time: 1183.8628s
Epoch: 12 cost time: 13.95779037475586
Epoch: 12, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0166795
	speed: 0.1929s/iter; left time: 7942.0067s
	iters: 200, epoch: 13 | loss: 0.0387024
	speed: 0.0294s/iter; left time: 1206.4065s
	iters: 300, epoch: 13 | loss: 0.0502306
	speed: 0.0276s/iter; left time: 1131.8577s
	iters: 400, epoch: 13 | loss: 0.4192843
	speed: 0.0317s/iter; left time: 1295.0443s
Epoch: 13 cost time: 14.76927137374878
Epoch: 13, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1694408
	speed: 0.1705s/iter; left time: 6938.8920s
	iters: 200, epoch: 14 | loss: 0.0191273
	speed: 0.0309s/iter; left time: 1253.2055s
	iters: 300, epoch: 14 | loss: 0.0225038
	speed: 0.0314s/iter; left time: 1273.7927s
	iters: 400, epoch: 14 | loss: 0.0044192
	speed: 0.0292s/iter; left time: 1181.5375s
Epoch: 14 cost time: 14.197277784347534
Epoch: 14, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.951685 --> -0.956259).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0068485
	speed: 0.1785s/iter; left time: 7182.5513s
	iters: 200, epoch: 15 | loss: 0.3865501
	speed: 0.0333s/iter; left time: 1336.4372s
	iters: 300, epoch: 15 | loss: 0.0667300
	speed: 0.0327s/iter; left time: 1307.3546s
	iters: 400, epoch: 15 | loss: 0.0622789
	speed: 0.0328s/iter; left time: 1311.5314s
Epoch: 15 cost time: 15.842449188232422
Epoch: 15, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0803832
	speed: 0.1687s/iter; left time: 6708.9243s
	iters: 200, epoch: 16 | loss: 0.0328004
	speed: 0.0310s/iter; left time: 1230.0049s
	iters: 300, epoch: 16 | loss: 0.0016783
	speed: 0.0306s/iter; left time: 1210.2923s
	iters: 400, epoch: 16 | loss: 0.0023028
	speed: 0.0328s/iter; left time: 1294.8974s
Epoch: 16 cost time: 14.601776123046875
Epoch: 16, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.956259 --> -0.957974).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0064484
	speed: 0.1798s/iter; left time: 7064.9394s
	iters: 200, epoch: 17 | loss: 0.0044763
	speed: 0.0298s/iter; left time: 1166.9757s
	iters: 300, epoch: 17 | loss: 0.0567879
	speed: 0.0306s/iter; left time: 1196.8621s
	iters: 400, epoch: 17 | loss: 0.0358850
	speed: 0.0314s/iter; left time: 1223.8931s
Epoch: 17 cost time: 14.358171701431274
Epoch: 17, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.957974 --> -0.961977).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0146427
	speed: 0.1820s/iter; left time: 7066.3660s
	iters: 200, epoch: 18 | loss: 0.4058056
	speed: 0.0294s/iter; left time: 1138.6316s
	iters: 300, epoch: 18 | loss: 0.0141349
	speed: 0.0291s/iter; left time: 1122.4700s
	iters: 400, epoch: 18 | loss: 0.0054107
	speed: 0.0297s/iter; left time: 1143.5213s
Epoch: 18 cost time: 14.175296306610107
Epoch: 18, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.229 Vali Acc: 0.945 Test Loss: 0.229 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0333707
	speed: 0.1838s/iter; left time: 7048.5660s
	iters: 200, epoch: 19 | loss: 0.0007396
	speed: 0.0326s/iter; left time: 1248.6813s
	iters: 300, epoch: 19 | loss: 0.0960040
	speed: 0.0305s/iter; left time: 1161.9440s
	iters: 400, epoch: 19 | loss: 0.1597019
	speed: 0.0295s/iter; left time: 1121.6610s
Epoch: 19 cost time: 15.323063611984253
Epoch: 19, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0039708
	speed: 0.1852s/iter; left time: 7016.2417s
	iters: 200, epoch: 20 | loss: 0.0073839
	speed: 0.0324s/iter; left time: 1223.8349s
	iters: 300, epoch: 20 | loss: 0.5088737
	speed: 0.0342s/iter; left time: 1289.7149s
	iters: 400, epoch: 20 | loss: 0.0535913
	speed: 0.0339s/iter; left time: 1274.7218s
Epoch: 20 cost time: 16.199655532836914
Epoch: 20, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1818199
	speed: 0.1913s/iter; left time: 7158.0860s
	iters: 200, epoch: 21 | loss: 0.0011393
	speed: 0.0371s/iter; left time: 1382.8594s
	iters: 300, epoch: 21 | loss: 0.0580136
	speed: 0.0342s/iter; left time: 1272.1848s
	iters: 400, epoch: 21 | loss: 0.0317840
	speed: 0.0354s/iter; left time: 1313.7619s
Epoch: 21 cost time: 16.879642724990845
Epoch: 21, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0996287
	speed: 0.1709s/iter; left time: 6314.9177s
	iters: 200, epoch: 22 | loss: 0.1410675
	speed: 0.0307s/iter; left time: 1129.8581s
	iters: 300, epoch: 22 | loss: 0.4648597
	speed: 0.0292s/iter; left time: 1074.8121s
	iters: 400, epoch: 22 | loss: 0.0518579
	speed: 0.0282s/iter; left time: 1032.5922s
Epoch: 22 cost time: 13.588188648223877
Epoch: 22, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
Validation loss decreased (-0.961977 --> -0.965979).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0203093
	speed: 0.1692s/iter; left time: 6171.6950s
	iters: 200, epoch: 23 | loss: 0.0235140
	speed: 0.0274s/iter; left time: 998.5241s
	iters: 300, epoch: 23 | loss: 0.0025260
	speed: 0.0280s/iter; left time: 1016.8805s
	iters: 400, epoch: 23 | loss: 0.0073345
	speed: 0.0304s/iter; left time: 1100.3225s
Epoch: 23 cost time: 13.985305309295654
Epoch: 23, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0083870
	speed: 0.1745s/iter; left time: 6285.8641s
	iters: 200, epoch: 24 | loss: 0.1102017
	speed: 0.0313s/iter; left time: 1122.8334s
	iters: 300, epoch: 24 | loss: 0.0047509
	speed: 0.0331s/iter; left time: 1185.7002s
	iters: 400, epoch: 24 | loss: 0.2568972
	speed: 0.0310s/iter; left time: 1107.6080s
Epoch: 24 cost time: 15.370614767074585
Epoch: 24, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0099479
	speed: 0.1770s/iter; left time: 6289.9804s
	iters: 200, epoch: 25 | loss: 0.0927175
	speed: 0.0303s/iter; left time: 1072.2840s
	iters: 300, epoch: 25 | loss: 0.0096020
	speed: 0.0331s/iter; left time: 1171.3164s
	iters: 400, epoch: 25 | loss: 0.1101032
	speed: 0.0323s/iter; left time: 1137.4070s
Epoch: 25 cost time: 16.07197141647339
Epoch: 25, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0297313
	speed: 0.1715s/iter; left time: 6017.0179s
	iters: 200, epoch: 26 | loss: 0.0618158
	speed: 0.0269s/iter; left time: 940.6141s
	iters: 300, epoch: 26 | loss: 0.0008987
	speed: 0.0321s/iter; left time: 1119.5394s
	iters: 400, epoch: 26 | loss: 0.0778536
	speed: 0.0269s/iter; left time: 935.8334s
Epoch: 26 cost time: 13.947307348251343
Epoch: 26, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0020527
	speed: 0.1665s/iter; left time: 5762.3947s
	iters: 200, epoch: 27 | loss: 0.0030380
	speed: 0.0291s/iter; left time: 1002.6747s
	iters: 300, epoch: 27 | loss: 0.0184517
	speed: 0.0313s/iter; left time: 1077.5154s
	iters: 400, epoch: 27 | loss: 0.0021270
	speed: 0.0315s/iter; left time: 1080.0053s
Epoch: 27 cost time: 15.495709657669067
Epoch: 27, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1568082
	speed: 0.1861s/iter; left time: 6352.0130s
	iters: 200, epoch: 28 | loss: 0.0025055
	speed: 0.0389s/iter; left time: 1322.9599s
	iters: 300, epoch: 28 | loss: 0.0079000
	speed: 0.0370s/iter; left time: 1255.4846s
	iters: 400, epoch: 28 | loss: 0.0018166
	speed: 0.0325s/iter; left time: 1099.3753s
Epoch: 28 cost time: 17.128902912139893
Epoch: 28, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0153839
	speed: 0.2067s/iter; left time: 6959.4408s
	iters: 200, epoch: 29 | loss: 0.0018451
	speed: 0.0372s/iter; left time: 1249.4169s
	iters: 300, epoch: 29 | loss: 0.7456704
	speed: 0.0445s/iter; left time: 1489.5410s
	iters: 400, epoch: 29 | loss: 0.0915336
	speed: 0.0371s/iter; left time: 1238.3743s
Epoch: 29 cost time: 18.589338779449463
Epoch: 29, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0119101
	speed: 0.2048s/iter; left time: 6798.9314s
	iters: 200, epoch: 30 | loss: 0.0015474
	speed: 0.0356s/iter; left time: 1177.4475s
	iters: 300, epoch: 30 | loss: 0.0007740
	speed: 0.0325s/iter; left time: 1073.7718s
	iters: 400, epoch: 30 | loss: 0.0027398
	speed: 0.0296s/iter; left time: 972.7248s
Epoch: 30 cost time: 15.417036771774292
Epoch: 30, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0158654
	speed: 0.1945s/iter; left time: 6366.9440s
	iters: 200, epoch: 31 | loss: 0.0040553
	speed: 0.0354s/iter; left time: 1154.9212s
	iters: 300, epoch: 31 | loss: 0.4144202
	speed: 0.0378s/iter; left time: 1229.5246s
	iters: 400, epoch: 31 | loss: 0.0797950
	speed: 0.0323s/iter; left time: 1048.7575s
Epoch: 31 cost time: 17.118147611618042
Epoch: 31, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.3744076
	speed: 0.1926s/iter; left time: 6212.2955s
	iters: 200, epoch: 32 | loss: 0.0063038
	speed: 0.0396s/iter; left time: 1272.4460s
	iters: 300, epoch: 32 | loss: 0.0034625
	speed: 0.0402s/iter; left time: 1287.4421s
	iters: 400, epoch: 32 | loss: 0.0148959
	speed: 0.0368s/iter; left time: 1177.4890s
Epoch: 32 cost time: 18.321072816848755
Epoch: 32, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.965980560320183
model parameter : 4759586
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4041406
	speed: 0.0483s/iter; left time: 2260.6459s
	iters: 200, epoch: 1 | loss: 0.1712974
	speed: 0.0325s/iter; left time: 1518.1725s
	iters: 300, epoch: 1 | loss: 0.1030829
	speed: 0.0298s/iter; left time: 1390.2132s
	iters: 400, epoch: 1 | loss: 0.7879469
	speed: 0.0295s/iter; left time: 1373.9157s
Epoch: 1 cost time: 16.10578179359436
Epoch: 1, Steps: 469 | Train Loss: 0.481 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
Validation loss decreased (inf --> -0.929672).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3555443
	speed: 0.1721s/iter; left time: 7972.0778s
	iters: 200, epoch: 2 | loss: 0.0170124
	speed: 0.0323s/iter; left time: 1492.7340s
	iters: 300, epoch: 2 | loss: 0.2210304
	speed: 0.0353s/iter; left time: 1627.5596s
	iters: 400, epoch: 2 | loss: 0.3187990
	speed: 0.0341s/iter; left time: 1569.4119s
Epoch: 2 cost time: 16.189918994903564
Epoch: 2, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.929672 --> -0.956831).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3916290
	speed: 0.1707s/iter; left time: 7828.8913s
	iters: 200, epoch: 3 | loss: 0.0255243
	speed: 0.0220s/iter; left time: 1008.1773s
	iters: 300, epoch: 3 | loss: 0.1771422
	speed: 0.0240s/iter; left time: 1097.7600s
	iters: 400, epoch: 3 | loss: 0.1028692
	speed: 0.0270s/iter; left time: 1229.8693s
Epoch: 3 cost time: 11.687902212142944
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0151590
	speed: 0.1622s/iter; left time: 7361.2668s
	iters: 200, epoch: 4 | loss: 0.1593500
	speed: 0.0251s/iter; left time: 1136.9358s
	iters: 300, epoch: 4 | loss: 0.0043559
	speed: 0.0249s/iter; left time: 1124.1990s
	iters: 400, epoch: 4 | loss: 0.0168521
	speed: 0.0222s/iter; left time: 998.9941s
Epoch: 4 cost time: 11.76571011543274
Epoch: 4, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3921233
	speed: 0.1604s/iter; left time: 7205.5107s
	iters: 200, epoch: 5 | loss: 0.1363254
	speed: 0.0269s/iter; left time: 1205.9978s
	iters: 300, epoch: 5 | loss: 0.0153338
	speed: 0.0289s/iter; left time: 1291.8483s
	iters: 400, epoch: 5 | loss: 0.2772335
	speed: 0.0299s/iter; left time: 1333.7335s
Epoch: 5 cost time: 14.611272811889648
Epoch: 5, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0302561
	speed: 0.1896s/iter; left time: 8428.5515s
	iters: 200, epoch: 6 | loss: 0.0181334
	speed: 0.0334s/iter; left time: 1479.4492s
	iters: 300, epoch: 6 | loss: 0.3828284
	speed: 0.0296s/iter; left time: 1311.3825s
	iters: 400, epoch: 6 | loss: 0.0179841
	speed: 0.0293s/iter; left time: 1294.1047s
Epoch: 6 cost time: 14.89214301109314
Epoch: 6, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0587718
	speed: 0.1894s/iter; left time: 8332.6903s
	iters: 200, epoch: 7 | loss: 0.0277057
	speed: 0.0400s/iter; left time: 1756.7831s
	iters: 300, epoch: 7 | loss: 0.3038982
	speed: 0.0341s/iter; left time: 1493.4937s
	iters: 400, epoch: 7 | loss: 0.0643098
	speed: 0.0291s/iter; left time: 1273.2648s
Epoch: 7 cost time: 16.3742835521698
Epoch: 7, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.392 Vali Acc: 0.899 Test Loss: 0.392 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0380924
	speed: 0.1916s/iter; left time: 8339.5287s
	iters: 200, epoch: 8 | loss: 0.0105056
	speed: 0.0371s/iter; left time: 1609.9293s
	iters: 300, epoch: 8 | loss: 0.5530260
	speed: 0.0328s/iter; left time: 1422.9227s
	iters: 400, epoch: 8 | loss: 0.0834559
	speed: 0.0340s/iter; left time: 1469.8825s
Epoch: 8 cost time: 16.472566604614258
Epoch: 8, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.956831 --> -0.961691).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1068914
	speed: 0.1773s/iter; left time: 7634.3422s
	iters: 200, epoch: 9 | loss: 0.5222523
	speed: 0.0325s/iter; left time: 1394.8975s
	iters: 300, epoch: 9 | loss: 0.0075011
	speed: 0.0385s/iter; left time: 1649.7256s
	iters: 400, epoch: 9 | loss: 0.0136351
	speed: 0.0354s/iter; left time: 1513.9535s
Epoch: 9 cost time: 16.18743658065796
Epoch: 9, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0160669
	speed: 0.2055s/iter; left time: 8751.8859s
	iters: 200, epoch: 10 | loss: 0.0072404
	speed: 0.0320s/iter; left time: 1358.1309s
	iters: 300, epoch: 10 | loss: 0.1332447
	speed: 0.0383s/iter; left time: 1624.6102s
	iters: 400, epoch: 10 | loss: 0.0387407
	speed: 0.0358s/iter; left time: 1515.2711s
Epoch: 10 cost time: 17.16638994216919
Epoch: 10, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.192 Vali Acc: 0.945 Test Loss: 0.192 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0162962
	speed: 0.2028s/iter; left time: 8539.1147s
	iters: 200, epoch: 11 | loss: 0.0030456
	speed: 0.0347s/iter; left time: 1459.2053s
	iters: 300, epoch: 11 | loss: 0.0071761
	speed: 0.0329s/iter; left time: 1377.5000s
	iters: 400, epoch: 11 | loss: 0.0026916
	speed: 0.0333s/iter; left time: 1394.2934s
Epoch: 11 cost time: 16.22332000732422
Epoch: 11, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0212677
	speed: 0.1879s/iter; left time: 7826.4052s
	iters: 200, epoch: 12 | loss: 0.0020117
	speed: 0.0331s/iter; left time: 1373.5072s
	iters: 300, epoch: 12 | loss: 0.0029533
	speed: 0.0305s/iter; left time: 1264.0691s
	iters: 400, epoch: 12 | loss: 0.0291920
	speed: 0.0322s/iter; left time: 1330.4626s
Epoch: 12 cost time: 15.270794868469238
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2822539
	speed: 0.1957s/iter; left time: 8059.4419s
	iters: 200, epoch: 13 | loss: 0.0230082
	speed: 0.0360s/iter; left time: 1478.8698s
	iters: 300, epoch: 13 | loss: 0.0087082
	speed: 0.0361s/iter; left time: 1477.8312s
	iters: 400, epoch: 13 | loss: 0.3297268
	speed: 0.0360s/iter; left time: 1471.6805s
Epoch: 13 cost time: 17.297261953353882
Epoch: 13, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0031453
	speed: 0.1836s/iter; left time: 7472.2270s
	iters: 200, epoch: 14 | loss: 0.2513514
	speed: 0.0247s/iter; left time: 1004.2361s
	iters: 300, epoch: 14 | loss: 0.0048035
	speed: 0.0263s/iter; left time: 1065.9895s
	iters: 400, epoch: 14 | loss: 0.0107996
	speed: 0.0313s/iter; left time: 1262.9852s
Epoch: 14 cost time: 13.901089668273926
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0178271
	speed: 0.1737s/iter; left time: 6988.0568s
	iters: 200, epoch: 15 | loss: 0.4013135
	speed: 0.0300s/iter; left time: 1204.2994s
	iters: 300, epoch: 15 | loss: 0.0735158
	speed: 0.0303s/iter; left time: 1214.0289s
	iters: 400, epoch: 15 | loss: 0.0128870
	speed: 0.0282s/iter; left time: 1125.7895s
Epoch: 15 cost time: 14.262718200683594
Epoch: 15, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.284 Vali Acc: 0.929 Test Loss: 0.284 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0062021
	speed: 0.2003s/iter; left time: 7965.9857s
	iters: 200, epoch: 16 | loss: 0.3219678
	speed: 0.0346s/iter; left time: 1370.7214s
	iters: 300, epoch: 16 | loss: 0.2045017
	speed: 0.0324s/iter; left time: 1280.5791s
	iters: 400, epoch: 16 | loss: 0.0321784
	speed: 0.0328s/iter; left time: 1293.7034s
Epoch: 16 cost time: 15.890711307525635
Epoch: 16, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0255628
	speed: 0.1892s/iter; left time: 7434.2451s
	iters: 200, epoch: 17 | loss: 0.0343539
	speed: 0.0264s/iter; left time: 1035.1990s
	iters: 300, epoch: 17 | loss: 0.2171109
	speed: 0.0301s/iter; left time: 1178.5824s
	iters: 400, epoch: 17 | loss: 0.0013140
	speed: 0.0305s/iter; left time: 1189.9958s
Epoch: 17 cost time: 14.560263395309448
Epoch: 17, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
Validation loss decreased (-0.961691 --> -0.963978).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0108504
	speed: 0.2114s/iter; left time: 8209.2205s
	iters: 200, epoch: 18 | loss: 0.0665606
	speed: 0.0315s/iter; left time: 1219.1165s
	iters: 300, epoch: 18 | loss: 0.0613960
	speed: 0.0331s/iter; left time: 1278.8797s
	iters: 400, epoch: 18 | loss: 0.0127367
	speed: 0.0342s/iter; left time: 1316.4835s
Epoch: 18 cost time: 16.63608407974243
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.963978 --> -0.967408).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0089395
	speed: 0.2226s/iter; left time: 8538.4960s
	iters: 200, epoch: 19 | loss: 0.0024920
	speed: 0.0319s/iter; left time: 1219.5571s
	iters: 300, epoch: 19 | loss: 0.1170569
	speed: 0.0330s/iter; left time: 1258.8146s
	iters: 400, epoch: 19 | loss: 0.0688540
	speed: 0.0341s/iter; left time: 1298.2189s
Epoch: 19 cost time: 16.7003915309906
Epoch: 19, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0092232
	speed: 0.1990s/iter; left time: 7539.2871s
	iters: 200, epoch: 20 | loss: 0.0583596
	speed: 0.0321s/iter; left time: 1213.1986s
	iters: 300, epoch: 20 | loss: 0.0118700
	speed: 0.0302s/iter; left time: 1139.7959s
	iters: 400, epoch: 20 | loss: 0.0011679
	speed: 0.0340s/iter; left time: 1276.8013s
Epoch: 20 cost time: 15.482159852981567
Epoch: 20, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0011991
	speed: 0.1952s/iter; left time: 7305.8659s
	iters: 200, epoch: 21 | loss: 0.1096536
	speed: 0.0337s/iter; left time: 1257.9318s
	iters: 300, epoch: 21 | loss: 0.0379290
	speed: 0.0337s/iter; left time: 1253.8724s
	iters: 400, epoch: 21 | loss: 0.0016737
	speed: 0.0303s/iter; left time: 1124.8459s
Epoch: 21 cost time: 15.833336353302002
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.955 Test Loss: 0.216 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0097954
	speed: 0.2141s/iter; left time: 7910.3361s
	iters: 200, epoch: 22 | loss: 0.0022625
	speed: 0.0320s/iter; left time: 1180.0564s
	iters: 300, epoch: 22 | loss: 0.1348638
	speed: 0.0310s/iter; left time: 1140.9330s
	iters: 400, epoch: 22 | loss: 0.1003046
	speed: 0.0301s/iter; left time: 1101.9475s
Epoch: 22 cost time: 15.34378457069397
Epoch: 22, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.279 Vali Acc: 0.947 Test Loss: 0.279 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0687889
	speed: 0.1990s/iter; left time: 7260.0147s
	iters: 200, epoch: 23 | loss: 0.0043566
	speed: 0.0253s/iter; left time: 920.7290s
	iters: 300, epoch: 23 | loss: 0.0630502
	speed: 0.0280s/iter; left time: 1017.4200s
	iters: 400, epoch: 23 | loss: 0.0024297
	speed: 0.0273s/iter; left time: 986.0046s
Epoch: 23 cost time: 13.474035501480103
Epoch: 23, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0030198
	speed: 0.1944s/iter; left time: 6999.4097s
	iters: 200, epoch: 24 | loss: 0.0246666
	speed: 0.0347s/iter; left time: 1246.3397s
	iters: 300, epoch: 24 | loss: 0.0096083
	speed: 0.0324s/iter; left time: 1162.1553s
	iters: 400, epoch: 24 | loss: 0.0069951
	speed: 0.0320s/iter; left time: 1143.1325s
Epoch: 24 cost time: 15.856592893600464
Epoch: 24, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0007120
	speed: 0.1862s/iter; left time: 6616.9140s
	iters: 200, epoch: 25 | loss: 0.0036714
	speed: 0.0330s/iter; left time: 1170.3403s
	iters: 300, epoch: 25 | loss: 0.0597689
	speed: 0.0335s/iter; left time: 1184.4383s
	iters: 400, epoch: 25 | loss: 0.0497194
	speed: 0.0312s/iter; left time: 1099.2357s
Epoch: 25 cost time: 15.822985649108887
Epoch: 25, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.936 Test Loss: 0.261 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0004088
	speed: 0.2012s/iter; left time: 7057.5910s
	iters: 200, epoch: 26 | loss: 0.0008117
	speed: 0.0332s/iter; left time: 1160.4004s
	iters: 300, epoch: 26 | loss: 0.0003824
	speed: 0.0357s/iter; left time: 1246.6860s
	iters: 400, epoch: 26 | loss: 0.0015662
	speed: 0.0346s/iter; left time: 1203.4699s
Epoch: 26 cost time: 16.396275758743286
Epoch: 26, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0061206
	speed: 0.1913s/iter; left time: 6620.5389s
	iters: 200, epoch: 27 | loss: 0.0393682
	speed: 0.0320s/iter; left time: 1105.4915s
	iters: 300, epoch: 27 | loss: 0.0007406
	speed: 0.0323s/iter; left time: 1111.4979s
	iters: 400, epoch: 27 | loss: 0.0031607
	speed: 0.0313s/iter; left time: 1075.0244s
Epoch: 27 cost time: 15.154935359954834
Epoch: 27, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0352723
	speed: 0.1813s/iter; left time: 6188.7781s
	iters: 200, epoch: 28 | loss: 0.0019708
	speed: 0.0299s/iter; left time: 1018.2403s
	iters: 300, epoch: 28 | loss: 0.0014109
	speed: 0.0316s/iter; left time: 1072.6243s
	iters: 400, epoch: 28 | loss: 0.0174875
	speed: 0.0408s/iter; left time: 1379.4172s
Epoch: 28 cost time: 16.342895984649658
Epoch: 28, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.967408 --> -0.974556).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.2936664
	speed: 0.2148s/iter; left time: 7232.3287s
	iters: 200, epoch: 29 | loss: 0.0733609
	speed: 0.0353s/iter; left time: 1184.3690s
	iters: 300, epoch: 29 | loss: 0.0270716
	speed: 0.0369s/iter; left time: 1236.3781s
	iters: 400, epoch: 29 | loss: 0.3249656
	speed: 0.0385s/iter; left time: 1286.2058s
Epoch: 29 cost time: 17.89684748649597
Epoch: 29, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0365826
	speed: 0.1934s/iter; left time: 6420.1691s
	iters: 200, epoch: 30 | loss: 0.0116576
	speed: 0.0300s/iter; left time: 993.9279s
	iters: 300, epoch: 30 | loss: 0.0291465
	speed: 0.0331s/iter; left time: 1090.9612s
	iters: 400, epoch: 30 | loss: 0.0002027
	speed: 0.0289s/iter; left time: 950.3972s
Epoch: 30 cost time: 14.707528829574585
Epoch: 30, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.221 Vali Acc: 0.961 Test Loss: 0.221 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0019520
	speed: 0.1503s/iter; left time: 4919.6916s
	iters: 200, epoch: 31 | loss: 0.0294309
	speed: 0.0250s/iter; left time: 815.1035s
	iters: 300, epoch: 31 | loss: 0.0082574
	speed: 0.0272s/iter; left time: 883.4575s
	iters: 400, epoch: 31 | loss: 0.0043235
	speed: 0.0323s/iter; left time: 1047.7881s
Epoch: 31 cost time: 14.081133604049683
Epoch: 31, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0252047
	speed: 0.2126s/iter; left time: 6859.5719s
	iters: 200, epoch: 32 | loss: 0.0014077
	speed: 0.0370s/iter; left time: 1189.1945s
	iters: 300, epoch: 32 | loss: 0.0014860
	speed: 0.0337s/iter; left time: 1080.9893s
	iters: 400, epoch: 32 | loss: 0.0583806
	speed: 0.0312s/iter; left time: 997.7293s
Epoch: 32 cost time: 17.098028659820557
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.1497416
	speed: 0.1925s/iter; left time: 6120.8772s
	iters: 200, epoch: 33 | loss: 0.0077981
	speed: 0.0331s/iter; left time: 1048.0075s
	iters: 300, epoch: 33 | loss: 0.2192327
	speed: 0.0315s/iter; left time: 996.0605s
	iters: 400, epoch: 33 | loss: 0.0051599
	speed: 0.0325s/iter; left time: 1022.3557s
Epoch: 33 cost time: 16.290251970291138
Epoch: 33, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0456841
	speed: 0.1953s/iter; left time: 6117.8296s
	iters: 200, epoch: 34 | loss: 0.0008770
	speed: 0.0320s/iter; left time: 998.1732s
	iters: 300, epoch: 34 | loss: 0.0707384
	speed: 0.0299s/iter; left time: 931.4653s
	iters: 400, epoch: 34 | loss: 0.0272737
	speed: 0.0293s/iter; left time: 909.6995s
Epoch: 34 cost time: 15.632670879364014
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0041956
	speed: 0.1842s/iter; left time: 5684.0656s
	iters: 200, epoch: 35 | loss: 0.0147424
	speed: 0.0317s/iter; left time: 973.9389s
	iters: 300, epoch: 35 | loss: 0.0003967
	speed: 0.0282s/iter; left time: 865.7825s
	iters: 400, epoch: 35 | loss: 0.0016389
	speed: 0.0349s/iter; left time: 1067.3294s
Epoch: 35 cost time: 14.98851227760315
Epoch: 35, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0037632
	speed: 0.1999s/iter; left time: 6073.4941s
	iters: 200, epoch: 36 | loss: 0.0015766
	speed: 0.0329s/iter; left time: 997.5029s
	iters: 300, epoch: 36 | loss: 0.0080449
	speed: 0.0284s/iter; left time: 858.4085s
	iters: 400, epoch: 36 | loss: 0.0019579
	speed: 0.0386s/iter; left time: 1160.3129s
Epoch: 36 cost time: 16.916283130645752
Epoch: 36, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.943 Test Loss: 0.300 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0002290
	speed: 0.2054s/iter; left time: 6144.5014s
	iters: 200, epoch: 37 | loss: 0.0472513
	speed: 0.0340s/iter; left time: 1013.2297s
	iters: 300, epoch: 37 | loss: 0.0013101
	speed: 0.0370s/iter; left time: 1098.9971s
	iters: 400, epoch: 37 | loss: 0.0690622
	speed: 0.0348s/iter; left time: 1030.6879s
Epoch: 37 cost time: 16.664828538894653
Epoch: 37, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000650
	speed: 0.1952s/iter; left time: 5749.1738s
	iters: 200, epoch: 38 | loss: 0.0000936
	speed: 0.0310s/iter; left time: 910.2956s
	iters: 300, epoch: 38 | loss: 0.0149148
	speed: 0.0310s/iter; left time: 908.0477s
	iters: 400, epoch: 38 | loss: 0.0206755
	speed: 0.0302s/iter; left time: 881.3224s
Epoch: 38 cost time: 14.818981170654297
Epoch: 38, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 4759330
model size : 23.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5325786
	speed: 0.0549s/iter; left time: 2568.0958s
	iters: 200, epoch: 1 | loss: 0.3454141
	speed: 0.0340s/iter; left time: 1588.6898s
	iters: 300, epoch: 1 | loss: 0.1949356
	speed: 0.0324s/iter; left time: 1509.5800s
	iters: 400, epoch: 1 | loss: 0.2527840
	speed: 0.0312s/iter; left time: 1449.4790s
Epoch: 1 cost time: 17.502854347229004
Epoch: 1, Steps: 469 | Train Loss: 0.526 Vali Loss: 0.337 Vali Acc: 0.898 Test Loss: 0.337 Test Acc: 0.898
Validation loss decreased (inf --> -0.897938).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0506726
	speed: 0.1835s/iter; left time: 8503.6021s
	iters: 200, epoch: 2 | loss: 0.3009332
	speed: 0.0317s/iter; left time: 1465.1992s
	iters: 300, epoch: 2 | loss: 0.0239271
	speed: 0.0325s/iter; left time: 1499.9576s
	iters: 400, epoch: 2 | loss: 0.0393485
	speed: 0.0313s/iter; left time: 1438.9237s
Epoch: 2 cost time: 15.238443374633789
Epoch: 2, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.897938 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2351067
	speed: 0.2015s/iter; left time: 9243.2790s
	iters: 200, epoch: 3 | loss: 0.1464436
	speed: 0.0278s/iter; left time: 1274.4423s
	iters: 300, epoch: 3 | loss: 0.0532769
	speed: 0.0295s/iter; left time: 1347.9949s
	iters: 400, epoch: 3 | loss: 0.0081870
	speed: 0.0278s/iter; left time: 1267.5938s
Epoch: 3 cost time: 14.445194244384766
Epoch: 3, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.454 Vali Acc: 0.864 Test Loss: 0.454 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0147628
	speed: 0.1624s/iter; left time: 7372.2699s
	iters: 200, epoch: 4 | loss: 0.1740767
	speed: 0.0292s/iter; left time: 1322.3364s
	iters: 300, epoch: 4 | loss: 0.0498317
	speed: 0.0260s/iter; left time: 1175.9743s
	iters: 400, epoch: 4 | loss: 0.0291273
	speed: 0.0252s/iter; left time: 1135.5126s
Epoch: 4 cost time: 13.34392499923706
Epoch: 4, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0288504
	speed: 0.1562s/iter; left time: 7015.6137s
	iters: 200, epoch: 5 | loss: 0.0064847
	speed: 0.0273s/iter; left time: 1224.0743s
	iters: 300, epoch: 5 | loss: 0.0328785
	speed: 0.0262s/iter; left time: 1170.7223s
	iters: 400, epoch: 5 | loss: 0.0260969
	speed: 0.0258s/iter; left time: 1149.5126s
Epoch: 5 cost time: 12.749433755874634
Epoch: 5, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0086770
	speed: 0.1980s/iter; left time: 8802.4238s
	iters: 200, epoch: 6 | loss: 0.0299882
	speed: 0.0361s/iter; left time: 1601.6737s
	iters: 300, epoch: 6 | loss: 0.3238988
	speed: 0.0409s/iter; left time: 1810.3529s
	iters: 400, epoch: 6 | loss: 0.0119805
	speed: 0.0416s/iter; left time: 1838.4220s
Epoch: 6 cost time: 19.64114236831665
Epoch: 6, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3080301
	speed: 0.2229s/iter; left time: 9805.6152s
	iters: 200, epoch: 7 | loss: 0.0771564
	speed: 0.0331s/iter; left time: 1451.5006s
	iters: 300, epoch: 7 | loss: 0.5644018
	speed: 0.0334s/iter; left time: 1464.5166s
	iters: 400, epoch: 7 | loss: 0.0063723
	speed: 0.0322s/iter; left time: 1405.6956s
Epoch: 7 cost time: 16.24750304222107
Epoch: 7, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0462304
	speed: 0.2132s/iter; left time: 9277.1370s
	iters: 200, epoch: 8 | loss: 0.0656713
	speed: 0.0382s/iter; left time: 1660.2421s
	iters: 300, epoch: 8 | loss: 0.3582908
	speed: 0.0403s/iter; left time: 1745.0674s
	iters: 400, epoch: 8 | loss: 0.0559040
	speed: 0.0390s/iter; left time: 1685.0790s
Epoch: 8 cost time: 18.837180614471436
Epoch: 8, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2121463
	speed: 0.2139s/iter; left time: 9208.6596s
	iters: 200, epoch: 9 | loss: 0.4355634
	speed: 0.0354s/iter; left time: 1518.6616s
	iters: 300, epoch: 9 | loss: 0.1021852
	speed: 0.0380s/iter; left time: 1629.6314s
	iters: 400, epoch: 9 | loss: 0.5956585
	speed: 0.0388s/iter; left time: 1658.4988s
Epoch: 9 cost time: 18.1018123626709
Epoch: 9, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3146437
	speed: 0.2101s/iter; left time: 8945.0113s
	iters: 200, epoch: 10 | loss: 0.0892776
	speed: 0.0410s/iter; left time: 1741.5822s
	iters: 300, epoch: 10 | loss: 0.1723076
	speed: 0.0364s/iter; left time: 1544.4784s
	iters: 400, epoch: 10 | loss: 0.0303544
	speed: 0.0359s/iter; left time: 1518.0855s
Epoch: 10 cost time: 17.778878211975098
Epoch: 10, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0147849
	speed: 0.1979s/iter; left time: 8335.3985s
	iters: 200, epoch: 11 | loss: 0.0101317
	speed: 0.0320s/iter; left time: 1343.9678s
	iters: 300, epoch: 11 | loss: 0.0144218
	speed: 0.0288s/iter; left time: 1206.6658s
	iters: 400, epoch: 11 | loss: 0.0127408
	speed: 0.0290s/iter; left time: 1213.7952s
Epoch: 11 cost time: 15.617520570755005
Epoch: 11, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.313 Vali Acc: 0.902 Test Loss: 0.313 Test Acc: 0.902
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0762352
	speed: 0.1794s/iter; left time: 7472.2293s
	iters: 200, epoch: 12 | loss: 0.0091043
	speed: 0.0293s/iter; left time: 1217.1816s
	iters: 300, epoch: 12 | loss: 0.0270185
	speed: 0.0304s/iter; left time: 1258.1104s
	iters: 400, epoch: 12 | loss: 0.4398743
	speed: 0.0390s/iter; left time: 1613.1627s
Epoch: 12 cost time: 16.0009925365448
Epoch: 12, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9642652944539737
model parameter : 3972130
model size : 20.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5429828
	speed: 0.0518s/iter; left time: 2426.3019s
	iters: 200, epoch: 1 | loss: 0.1318180
	speed: 0.0337s/iter; left time: 1573.4174s
	iters: 300, epoch: 1 | loss: 0.2403030
	speed: 0.0345s/iter; left time: 1607.1064s
	iters: 400, epoch: 1 | loss: 0.1040224
	speed: 0.0349s/iter; left time: 1621.4456s
Epoch: 1 cost time: 17.530629634857178
Epoch: 1, Steps: 469 | Train Loss: 0.505 Vali Loss: 0.356 Vali Acc: 0.873 Test Loss: 0.356 Test Acc: 0.873
Validation loss decreased (inf --> -0.872781).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1441439
	speed: 0.1787s/iter; left time: 8281.7844s
	iters: 200, epoch: 2 | loss: 0.0382301
	speed: 0.0307s/iter; left time: 1417.5260s
	iters: 300, epoch: 2 | loss: 0.0996667
	speed: 0.0291s/iter; left time: 1344.2381s
	iters: 400, epoch: 2 | loss: 0.0516311
	speed: 0.0339s/iter; left time: 1561.8349s
Epoch: 2 cost time: 15.081361293792725
Epoch: 2, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.872781 --> -0.883644).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0784740
	speed: 0.1862s/iter; left time: 8537.4082s
	iters: 200, epoch: 3 | loss: 0.0079276
	speed: 0.0323s/iter; left time: 1476.4492s
	iters: 300, epoch: 3 | loss: 0.0241812
	speed: 0.0302s/iter; left time: 1378.6190s
	iters: 400, epoch: 3 | loss: 0.0285659
	speed: 0.0333s/iter; left time: 1516.3614s
Epoch: 3 cost time: 15.815360069274902
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
Validation loss decreased (-0.883644 --> -0.924812).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2989604
	speed: 0.1815s/iter; left time: 8238.5042s
	iters: 200, epoch: 4 | loss: 0.1187049
	speed: 0.0302s/iter; left time: 1366.1608s
	iters: 300, epoch: 4 | loss: 0.1032403
	speed: 0.0328s/iter; left time: 1480.5139s
	iters: 400, epoch: 4 | loss: 0.3428857
	speed: 0.0352s/iter; left time: 1587.2301s
Epoch: 4 cost time: 15.889803409576416
Epoch: 4, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
Validation loss decreased (-0.924812 --> -0.938820).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0234814
	speed: 0.2011s/iter; left time: 9036.0059s
	iters: 200, epoch: 5 | loss: 0.0468150
	speed: 0.0297s/iter; left time: 1332.5720s
	iters: 300, epoch: 5 | loss: 0.0509722
	speed: 0.0334s/iter; left time: 1495.7443s
	iters: 400, epoch: 5 | loss: 0.0106594
	speed: 0.0300s/iter; left time: 1338.5699s
Epoch: 5 cost time: 15.13463044166565
Epoch: 5, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0584149
	speed: 0.1724s/iter; left time: 7665.0706s
	iters: 200, epoch: 6 | loss: 0.0110605
	speed: 0.0322s/iter; left time: 1428.5598s
	iters: 300, epoch: 6 | loss: 0.0111293
	speed: 0.0307s/iter; left time: 1359.1345s
	iters: 400, epoch: 6 | loss: 0.0336208
	speed: 0.0318s/iter; left time: 1405.2002s
Epoch: 6 cost time: 15.032611846923828
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.938820 --> -0.944252).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0377009
	speed: 0.1941s/iter; left time: 8538.9533s
	iters: 200, epoch: 7 | loss: 0.5750622
	speed: 0.0311s/iter; left time: 1363.4943s
	iters: 300, epoch: 7 | loss: 0.1201919
	speed: 0.0277s/iter; left time: 1212.8123s
	iters: 400, epoch: 7 | loss: 0.0802555
	speed: 0.0267s/iter; left time: 1167.5702s
Epoch: 7 cost time: 13.656359434127808
Epoch: 7, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.229 Vali Acc: 0.936 Test Loss: 0.229 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1344774
	speed: 0.1869s/iter; left time: 8134.7049s
	iters: 200, epoch: 8 | loss: 0.0176100
	speed: 0.0341s/iter; left time: 1478.3885s
	iters: 300, epoch: 8 | loss: 0.0055156
	speed: 0.0336s/iter; left time: 1455.5825s
	iters: 400, epoch: 8 | loss: 0.1665886
	speed: 0.0309s/iter; left time: 1337.0465s
Epoch: 8 cost time: 15.639599800109863
Epoch: 8, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.944252 --> -0.951113).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4135415
	speed: 0.1801s/iter; left time: 7753.8494s
	iters: 200, epoch: 9 | loss: 0.0197308
	speed: 0.0307s/iter; left time: 1317.0309s
	iters: 300, epoch: 9 | loss: 0.2114768
	speed: 0.0314s/iter; left time: 1344.6463s
	iters: 400, epoch: 9 | loss: 0.1460361
	speed: 0.0289s/iter; left time: 1233.3932s
Epoch: 9 cost time: 14.848106384277344
Epoch: 9, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.399 Vali Acc: 0.886 Test Loss: 0.399 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3423268
	speed: 0.1511s/iter; left time: 6431.8295s
	iters: 200, epoch: 10 | loss: 0.6390419
	speed: 0.0264s/iter; left time: 1123.2283s
	iters: 300, epoch: 10 | loss: 0.1227704
	speed: 0.0263s/iter; left time: 1116.2330s
	iters: 400, epoch: 10 | loss: 0.0199598
	speed: 0.0303s/iter; left time: 1280.3338s
Epoch: 10 cost time: 13.565003156661987
Epoch: 10, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.186 Vali Acc: 0.947 Test Loss: 0.186 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0029206
	speed: 0.1774s/iter; left time: 7470.6130s
	iters: 200, epoch: 11 | loss: 0.1656262
	speed: 0.0288s/iter; left time: 1208.2968s
	iters: 300, epoch: 11 | loss: 0.0023050
	speed: 0.0327s/iter; left time: 1371.0819s
	iters: 400, epoch: 11 | loss: 0.1122053
	speed: 0.0295s/iter; left time: 1233.2685s
Epoch: 11 cost time: 14.239458560943604
Epoch: 11, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.951113 --> -0.962263).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0568370
	speed: 0.1818s/iter; left time: 7570.7316s
	iters: 200, epoch: 12 | loss: 0.0691578
	speed: 0.0309s/iter; left time: 1285.5437s
	iters: 300, epoch: 12 | loss: 0.0076286
	speed: 0.0328s/iter; left time: 1358.6615s
	iters: 400, epoch: 12 | loss: 0.4731143
	speed: 0.0342s/iter; left time: 1413.8414s
Epoch: 12 cost time: 15.846034526824951
Epoch: 12, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0036034
	speed: 0.1973s/iter; left time: 8121.8838s
	iters: 200, epoch: 13 | loss: 0.0474699
	speed: 0.0324s/iter; left time: 1331.4406s
	iters: 300, epoch: 13 | loss: 0.0053737
	speed: 0.0335s/iter; left time: 1372.8567s
	iters: 400, epoch: 13 | loss: 0.6566608
	speed: 0.0340s/iter; left time: 1390.4336s
Epoch: 13 cost time: 16.229201793670654
Epoch: 13, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0408034
	speed: 0.1899s/iter; left time: 7728.6685s
	iters: 200, epoch: 14 | loss: 0.0248305
	speed: 0.0327s/iter; left time: 1326.2841s
	iters: 300, epoch: 14 | loss: 0.0180267
	speed: 0.0357s/iter; left time: 1446.3895s
	iters: 400, epoch: 14 | loss: 0.0083731
	speed: 0.0303s/iter; left time: 1224.1619s
Epoch: 14 cost time: 15.752793312072754
Epoch: 14, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0123528
	speed: 0.1937s/iter; left time: 7793.5263s
	iters: 200, epoch: 15 | loss: 0.1541806
	speed: 0.0354s/iter; left time: 1419.1967s
	iters: 300, epoch: 15 | loss: 0.1129773
	speed: 0.0367s/iter; left time: 1469.7849s
	iters: 400, epoch: 15 | loss: 0.0070718
	speed: 0.0351s/iter; left time: 1400.8340s
Epoch: 15 cost time: 17.56346845626831
Epoch: 15, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.251 Vali Acc: 0.945 Test Loss: 0.251 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0671749
	speed: 0.1826s/iter; left time: 7259.6304s
	iters: 200, epoch: 16 | loss: 0.0516745
	speed: 0.0366s/iter; left time: 1451.4409s
	iters: 300, epoch: 16 | loss: 0.2279402
	speed: 0.0332s/iter; left time: 1314.3423s
	iters: 400, epoch: 16 | loss: 0.0570036
	speed: 0.0306s/iter; left time: 1205.9968s
Epoch: 16 cost time: 15.63597822189331
Epoch: 16, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2620521
	speed: 0.1831s/iter; left time: 7196.5468s
	iters: 200, epoch: 17 | loss: 0.0081495
	speed: 0.0303s/iter; left time: 1185.9976s
	iters: 300, epoch: 17 | loss: 0.0052394
	speed: 0.0291s/iter; left time: 1136.4046s
	iters: 400, epoch: 17 | loss: 0.1730341
	speed: 0.0336s/iter; left time: 1308.5627s
Epoch: 17 cost time: 15.164882898330688
Epoch: 17, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.289 Vali Acc: 0.936 Test Loss: 0.289 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0117019
	speed: 0.1958s/iter; left time: 7604.3652s
	iters: 200, epoch: 18 | loss: 0.0461837
	speed: 0.0320s/iter; left time: 1238.3376s
	iters: 300, epoch: 18 | loss: 0.0199267
	speed: 0.0372s/iter; left time: 1437.0849s
	iters: 400, epoch: 18 | loss: 0.0015747
	speed: 0.0350s/iter; left time: 1347.2809s
Epoch: 18 cost time: 16.5201358795166
Epoch: 18, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0012767
	speed: 0.1843s/iter; left time: 7070.7523s
	iters: 200, epoch: 19 | loss: 0.0085613
	speed: 0.0300s/iter; left time: 1149.6239s
	iters: 300, epoch: 19 | loss: 0.3004073
	speed: 0.0354s/iter; left time: 1352.1526s
	iters: 400, epoch: 19 | loss: 0.0024261
	speed: 0.0315s/iter; left time: 1197.7038s
Epoch: 19 cost time: 15.454721689224243
Epoch: 19, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.203 Vali Acc: 0.955 Test Loss: 0.203 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.9151272
	speed: 0.2014s/iter; left time: 7630.8539s
	iters: 200, epoch: 20 | loss: 0.0854339
	speed: 0.0382s/iter; left time: 1442.0295s
	iters: 300, epoch: 20 | loss: 0.0383037
	speed: 0.0359s/iter; left time: 1351.3757s
	iters: 400, epoch: 20 | loss: 0.0068136
	speed: 0.0327s/iter; left time: 1229.4187s
Epoch: 20 cost time: 17.760931968688965
Epoch: 20, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0021742
	speed: 0.2140s/iter; left time: 8009.5727s
	iters: 200, epoch: 21 | loss: 0.0474494
	speed: 0.0304s/iter; left time: 1136.3233s
	iters: 300, epoch: 21 | loss: 0.0470064
	speed: 0.0285s/iter; left time: 1060.1859s
	iters: 400, epoch: 21 | loss: 0.1392263
	speed: 0.0275s/iter; left time: 1021.7256s
Epoch: 21 cost time: 14.713957786560059
Epoch: 21, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9622641509433962
model parameter : 3971874
model size : 20.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5929282
	speed: 0.0480s/iter; left time: 2248.3207s
	iters: 200, epoch: 1 | loss: 0.4597155
	speed: 0.0250s/iter; left time: 1165.8411s
	iters: 300, epoch: 1 | loss: 0.1454083
	speed: 0.0248s/iter; left time: 1157.2403s
	iters: 400, epoch: 1 | loss: 0.4468402
	speed: 0.0273s/iter; left time: 1267.3459s
Epoch: 1 cost time: 14.834989309310913
Epoch: 1, Steps: 469 | Train Loss: 0.520 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
Validation loss decreased (inf --> -0.925669).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0836423
	speed: 0.1707s/iter; left time: 7909.3196s
	iters: 200, epoch: 2 | loss: 0.1034599
	speed: 0.0253s/iter; left time: 1171.9387s
	iters: 300, epoch: 2 | loss: 0.1549499
	speed: 0.0252s/iter; left time: 1162.6089s
	iters: 400, epoch: 2 | loss: 0.0808969
	speed: 0.0302s/iter; left time: 1389.1937s
Epoch: 2 cost time: 13.434498310089111
Epoch: 2, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0526893
	speed: 0.1845s/iter; left time: 8461.2912s
	iters: 200, epoch: 3 | loss: 0.0408472
	speed: 0.0328s/iter; left time: 1501.8600s
	iters: 300, epoch: 3 | loss: 0.0174852
	speed: 0.0306s/iter; left time: 1395.5963s
	iters: 400, epoch: 3 | loss: 0.0698098
	speed: 0.0313s/iter; left time: 1425.7973s
Epoch: 3 cost time: 14.829734802246094
Epoch: 3, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.320 Vali Acc: 0.910 Test Loss: 0.320 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1717506
	speed: 0.1864s/iter; left time: 8462.2893s
	iters: 200, epoch: 4 | loss: 0.0416446
	speed: 0.0311s/iter; left time: 1410.3976s
	iters: 300, epoch: 4 | loss: 0.1849118
	speed: 0.0312s/iter; left time: 1408.6651s
	iters: 400, epoch: 4 | loss: 0.1139765
	speed: 0.0277s/iter; left time: 1247.9275s
Epoch: 4 cost time: 14.857227802276611
Epoch: 4, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
Validation loss decreased (-0.925669 --> -0.939106).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1889662
	speed: 0.1714s/iter; left time: 7700.0524s
	iters: 200, epoch: 5 | loss: 0.0209983
	speed: 0.0318s/iter; left time: 1423.8636s
	iters: 300, epoch: 5 | loss: 0.2904195
	speed: 0.0326s/iter; left time: 1458.2318s
	iters: 400, epoch: 5 | loss: 0.0477811
	speed: 0.0318s/iter; left time: 1419.1973s
Epoch: 5 cost time: 15.227840900421143
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3096220
	speed: 0.1842s/iter; left time: 8190.4848s
	iters: 200, epoch: 6 | loss: 0.0996610
	speed: 0.0334s/iter; left time: 1482.8671s
	iters: 300, epoch: 6 | loss: 0.0077144
	speed: 0.0361s/iter; left time: 1599.3172s
	iters: 400, epoch: 6 | loss: 0.0031243
	speed: 0.0328s/iter; left time: 1448.0072s
Epoch: 6 cost time: 15.961137294769287
Epoch: 6, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.939106 --> -0.941965).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0333454
	speed: 0.1751s/iter; left time: 7702.0033s
	iters: 200, epoch: 7 | loss: 0.1164492
	speed: 0.0308s/iter; left time: 1349.6573s
	iters: 300, epoch: 7 | loss: 0.5151210
	speed: 0.0300s/iter; left time: 1312.0422s
	iters: 400, epoch: 7 | loss: 0.5579570
	speed: 0.0308s/iter; left time: 1346.7354s
Epoch: 7 cost time: 14.359301328659058
Epoch: 7, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.343 Vali Acc: 0.923 Test Loss: 0.343 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0098274
	speed: 0.1729s/iter; left time: 7524.2658s
	iters: 200, epoch: 8 | loss: 0.0313820
	speed: 0.0290s/iter; left time: 1258.0369s
	iters: 300, epoch: 8 | loss: 0.0429268
	speed: 0.0343s/iter; left time: 1483.8440s
	iters: 400, epoch: 8 | loss: 0.0011653
	speed: 0.0340s/iter; left time: 1470.8106s
Epoch: 8 cost time: 15.301130056381226
Epoch: 8, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0030152
	speed: 0.1895s/iter; left time: 8156.8710s
	iters: 200, epoch: 9 | loss: 0.1700564
	speed: 0.0276s/iter; left time: 1187.3259s
	iters: 300, epoch: 9 | loss: 0.0347460
	speed: 0.0340s/iter; left time: 1456.7369s
	iters: 400, epoch: 9 | loss: 0.0088982
	speed: 0.0350s/iter; left time: 1495.7581s
Epoch: 9 cost time: 15.58884048461914
Epoch: 9, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
Validation loss decreased (-0.941965 --> -0.964264).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0047006
	speed: 0.1793s/iter; left time: 7634.8677s
	iters: 200, epoch: 10 | loss: 0.0123449
	speed: 0.0286s/iter; left time: 1214.0173s
	iters: 300, epoch: 10 | loss: 0.0102308
	speed: 0.0275s/iter; left time: 1163.8872s
	iters: 400, epoch: 10 | loss: 0.0154228
	speed: 0.0275s/iter; left time: 1162.4487s
Epoch: 10 cost time: 13.64178991317749
Epoch: 10, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0020076
	speed: 0.1713s/iter; left time: 7213.7821s
	iters: 200, epoch: 11 | loss: 0.0019416
	speed: 0.0293s/iter; left time: 1232.1849s
	iters: 300, epoch: 11 | loss: 0.0111340
	speed: 0.0309s/iter; left time: 1295.7277s
	iters: 400, epoch: 11 | loss: 0.0303802
	speed: 0.0272s/iter; left time: 1138.3626s
Epoch: 11 cost time: 14.082936525344849
Epoch: 11, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0075304
	speed: 0.1717s/iter; left time: 7147.8800s
	iters: 200, epoch: 12 | loss: 0.9888206
	speed: 0.0298s/iter; left time: 1238.5771s
	iters: 300, epoch: 12 | loss: 0.0105277
	speed: 0.0305s/iter; left time: 1264.1642s
	iters: 400, epoch: 12 | loss: 0.7065025
	speed: 0.0321s/iter; left time: 1326.8471s
Epoch: 12 cost time: 15.177015542984009
Epoch: 12, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0341838
	speed: 0.1770s/iter; left time: 7286.5096s
	iters: 200, epoch: 13 | loss: 0.2606987
	speed: 0.0306s/iter; left time: 1256.2883s
	iters: 300, epoch: 13 | loss: 0.0358682
	speed: 0.0298s/iter; left time: 1221.7489s
	iters: 400, epoch: 13 | loss: 0.0771554
	speed: 0.0337s/iter; left time: 1375.8058s
Epoch: 13 cost time: 15.678216218948364
Epoch: 13, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 0.945 Test Loss: 0.228 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0111481
	speed: 0.1965s/iter; left time: 7998.0287s
	iters: 200, epoch: 14 | loss: 0.0696809
	speed: 0.0340s/iter; left time: 1379.0965s
	iters: 300, epoch: 14 | loss: 0.0128401
	speed: 0.0263s/iter; left time: 1063.4034s
	iters: 400, epoch: 14 | loss: 0.0582854
	speed: 0.0257s/iter; left time: 1037.3513s
Epoch: 14 cost time: 13.911417484283447
Epoch: 14, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0100638
	speed: 0.1467s/iter; left time: 5901.1225s
	iters: 200, epoch: 15 | loss: 0.0271271
	speed: 0.0269s/iter; left time: 1079.5564s
	iters: 300, epoch: 15 | loss: 1.1657119
	speed: 0.0274s/iter; left time: 1095.8466s
	iters: 400, epoch: 15 | loss: 0.4528008
	speed: 0.0250s/iter; left time: 997.8005s
Epoch: 15 cost time: 12.998728275299072
Epoch: 15, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0146790
	speed: 0.1579s/iter; left time: 6278.0140s
	iters: 200, epoch: 16 | loss: 0.2107665
	speed: 0.0264s/iter; left time: 1045.7270s
	iters: 300, epoch: 16 | loss: 0.0748103
	speed: 0.0304s/iter; left time: 1204.2184s
	iters: 400, epoch: 16 | loss: 0.0743969
	speed: 0.0291s/iter; left time: 1148.4995s
Epoch: 16 cost time: 14.059367895126343
Epoch: 16, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0924755
	speed: 0.1463s/iter; left time: 5750.7085s
	iters: 200, epoch: 17 | loss: 0.0031250
	speed: 0.0286s/iter; left time: 1119.5272s
	iters: 300, epoch: 17 | loss: 0.0424049
	speed: 0.0272s/iter; left time: 1065.1464s
	iters: 400, epoch: 17 | loss: 0.0362240
	speed: 0.0266s/iter; left time: 1036.2405s
Epoch: 17 cost time: 13.506455421447754
Epoch: 17, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0110316
	speed: 0.1542s/iter; left time: 5988.3469s
	iters: 200, epoch: 18 | loss: 0.1964641
	speed: 0.0304s/iter; left time: 1175.7831s
	iters: 300, epoch: 18 | loss: 0.0075838
	speed: 0.0328s/iter; left time: 1267.9929s
	iters: 400, epoch: 18 | loss: 0.0015677
	speed: 0.0333s/iter; left time: 1283.9208s
Epoch: 18 cost time: 15.61364221572876
Epoch: 18, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0639744
	speed: 0.1514s/iter; left time: 5809.4030s
	iters: 200, epoch: 19 | loss: 0.0032965
	speed: 0.0338s/iter; left time: 1293.0000s
	iters: 300, epoch: 19 | loss: 0.0972986
	speed: 0.0331s/iter; left time: 1263.0743s
	iters: 400, epoch: 19 | loss: 0.0187131
	speed: 0.0306s/iter; left time: 1164.4789s
Epoch: 19 cost time: 15.07558560371399
Epoch: 19, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9642652944539737
model parameter : 3971618
model size : 20.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8282028
	speed: 0.0736s/iter; left time: 3442.5617s
	iters: 200, epoch: 1 | loss: 0.4800016
	speed: 0.0419s/iter; left time: 1954.7222s
	iters: 300, epoch: 1 | loss: 0.4679032
	speed: 0.0402s/iter; left time: 1871.0472s
	iters: 400, epoch: 1 | loss: 0.1629670
	speed: 0.0360s/iter; left time: 1675.9421s
Epoch: 1 cost time: 21.97358250617981
Epoch: 1, Steps: 469 | Train Loss: 0.533 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (inf --> -0.899654).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0323402
	speed: 0.2405s/iter; left time: 11141.7439s
	iters: 200, epoch: 2 | loss: 0.2651595
	speed: 0.0424s/iter; left time: 1960.4997s
	iters: 300, epoch: 2 | loss: 0.0083489
	speed: 0.0368s/iter; left time: 1695.7938s
	iters: 400, epoch: 2 | loss: 0.5273434
	speed: 0.0366s/iter; left time: 1685.5173s
Epoch: 2 cost time: 18.68878960609436
Epoch: 2, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.899654 --> -0.954258).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0959932
	speed: 0.2597s/iter; left time: 11909.9562s
	iters: 200, epoch: 3 | loss: 0.2890771
	speed: 0.0512s/iter; left time: 2342.7938s
	iters: 300, epoch: 3 | loss: 0.2020820
	speed: 0.0484s/iter; left time: 2208.3271s
	iters: 400, epoch: 3 | loss: 0.1311682
	speed: 0.0395s/iter; left time: 1801.6557s
Epoch: 3 cost time: 22.055495977401733
Epoch: 3, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.954258 --> -0.959404).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1336538
	speed: 0.2757s/iter; left time: 12517.2330s
	iters: 200, epoch: 4 | loss: 0.0298349
	speed: 0.0464s/iter; left time: 2100.3987s
	iters: 300, epoch: 4 | loss: 0.0092879
	speed: 0.0480s/iter; left time: 2170.5758s
	iters: 400, epoch: 4 | loss: 0.4056878
	speed: 0.0432s/iter; left time: 1947.8180s
Epoch: 4 cost time: 21.785085678100586
Epoch: 4, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.305 Vali Acc: 0.914 Test Loss: 0.305 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0262843
	speed: 0.2769s/iter; left time: 12437.9477s
	iters: 200, epoch: 5 | loss: 0.0128792
	speed: 0.0453s/iter; left time: 2030.7992s
	iters: 300, epoch: 5 | loss: 0.0111536
	speed: 0.0486s/iter; left time: 2173.0695s
	iters: 400, epoch: 5 | loss: 0.0538194
	speed: 0.0468s/iter; left time: 2088.9710s
Epoch: 5 cost time: 22.99347996711731
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2063728
	speed: 0.2750s/iter; left time: 12223.4324s
	iters: 200, epoch: 6 | loss: 0.0998395
	speed: 0.0473s/iter; left time: 2100.1605s
	iters: 300, epoch: 6 | loss: 0.0035892
	speed: 0.0478s/iter; left time: 2115.9524s
	iters: 400, epoch: 6 | loss: 0.0259317
	speed: 0.0441s/iter; left time: 1945.1872s
Epoch: 6 cost time: 21.627556085586548
Epoch: 6, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0610931
	speed: 0.2645s/iter; left time: 11632.9331s
	iters: 200, epoch: 7 | loss: 0.1027814
	speed: 0.0466s/iter; left time: 2045.9806s
	iters: 300, epoch: 7 | loss: 0.0166439
	speed: 0.0502s/iter; left time: 2198.5968s
	iters: 400, epoch: 7 | loss: 0.1767331
	speed: 0.0495s/iter; left time: 2162.0920s
Epoch: 7 cost time: 23.52268671989441
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.959404 --> -0.960261).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2665549
	speed: 0.3064s/iter; left time: 13334.8579s
	iters: 200, epoch: 8 | loss: 0.0032149
	speed: 0.0524s/iter; left time: 2274.4644s
	iters: 300, epoch: 8 | loss: 0.1197203
	speed: 0.0470s/iter; left time: 2034.7788s
	iters: 400, epoch: 8 | loss: 0.0152963
	speed: 0.0466s/iter; left time: 2015.6212s
Epoch: 8 cost time: 24.80837392807007
Epoch: 8, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0058366
	speed: 0.2702s/iter; left time: 11632.2594s
	iters: 200, epoch: 9 | loss: 0.0126338
	speed: 0.0400s/iter; left time: 1718.8406s
	iters: 300, epoch: 9 | loss: 0.0508160
	speed: 0.0390s/iter; left time: 1670.6790s
	iters: 400, epoch: 9 | loss: 0.0046084
	speed: 0.0422s/iter; left time: 1802.6156s
Epoch: 9 cost time: 19.187341928482056
Epoch: 9, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1483341
	speed: 0.2648s/iter; left time: 11273.1723s
	iters: 200, epoch: 10 | loss: 0.0085079
	speed: 0.0476s/iter; left time: 2023.2052s
	iters: 300, epoch: 10 | loss: 0.0017257
	speed: 0.0411s/iter; left time: 1739.9403s
	iters: 400, epoch: 10 | loss: 0.5170254
	speed: 0.0468s/iter; left time: 1980.2339s
Epoch: 10 cost time: 21.861413955688477
Epoch: 10, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.233 Vali Acc: 0.945 Test Loss: 0.233 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1413266
	speed: 0.2927s/iter; left time: 12325.1962s
	iters: 200, epoch: 11 | loss: 0.1449208
	speed: 0.0595s/iter; left time: 2500.6332s
	iters: 300, epoch: 11 | loss: 0.0856924
	speed: 0.0466s/iter; left time: 1951.6490s
	iters: 400, epoch: 11 | loss: 0.0026011
	speed: 0.0549s/iter; left time: 2296.8962s
Epoch: 11 cost time: 25.897749423980713
Epoch: 11, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4699260
	speed: 0.3029s/iter; left time: 12611.4161s
	iters: 200, epoch: 12 | loss: 0.0080053
	speed: 0.0375s/iter; left time: 1557.1953s
	iters: 300, epoch: 12 | loss: 0.0817531
	speed: 0.0486s/iter; left time: 2015.7333s
	iters: 400, epoch: 12 | loss: 0.0026105
	speed: 0.0501s/iter; left time: 2070.2498s
Epoch: 12 cost time: 22.149685621261597
Epoch: 12, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0024412
	speed: 0.2706s/iter; left time: 11139.9165s
	iters: 200, epoch: 13 | loss: 0.3204618
	speed: 0.0472s/iter; left time: 1937.3581s
	iters: 300, epoch: 13 | loss: 0.0055022
	speed: 0.0425s/iter; left time: 1741.2024s
	iters: 400, epoch: 13 | loss: 0.0017437
	speed: 0.0463s/iter; left time: 1892.3029s
Epoch: 13 cost time: 20.83185863494873
Epoch: 13, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.223 Vali Acc: 0.939 Test Loss: 0.223 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1539665
	speed: 0.2614s/iter; left time: 10639.9426s
	iters: 200, epoch: 14 | loss: 0.2595178
	speed: 0.0395s/iter; left time: 1602.0347s
	iters: 300, epoch: 14 | loss: 0.0029914
	speed: 0.0398s/iter; left time: 1611.9250s
	iters: 400, epoch: 14 | loss: 0.0073324
	speed: 0.0387s/iter; left time: 1564.3923s
Epoch: 14 cost time: 19.164499044418335
Epoch: 14, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0098641
	speed: 0.2923s/iter; left time: 11762.4187s
	iters: 200, epoch: 15 | loss: 0.0868510
	speed: 0.0448s/iter; left time: 1798.7858s
	iters: 300, epoch: 15 | loss: 0.0026653
	speed: 0.0487s/iter; left time: 1949.9793s
	iters: 400, epoch: 15 | loss: 0.0042841
	speed: 0.0503s/iter; left time: 2009.7909s
Epoch: 15 cost time: 23.496856212615967
Epoch: 15, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
Validation loss decreased (-0.960261 --> -0.964835).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1527054
	speed: 0.3186s/iter; left time: 12667.5679s
	iters: 200, epoch: 16 | loss: 0.0003113
	speed: 0.0482s/iter; left time: 1913.2780s
	iters: 300, epoch: 16 | loss: 0.1222871
	speed: 0.0540s/iter; left time: 2136.9686s
	iters: 400, epoch: 16 | loss: 0.0577642
	speed: 0.0450s/iter; left time: 1774.6548s
Epoch: 16 cost time: 24.891024351119995
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1594595
	speed: 0.2738s/iter; left time: 10758.9561s
	iters: 200, epoch: 17 | loss: 0.0004131
	speed: 0.0451s/iter; left time: 1767.9609s
	iters: 300, epoch: 17 | loss: 0.0028433
	speed: 0.0451s/iter; left time: 1763.2043s
	iters: 400, epoch: 17 | loss: 0.0072417
	speed: 0.0499s/iter; left time: 1944.6006s
Epoch: 17 cost time: 21.91492247581482
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0136510
	speed: 0.2483s/iter; left time: 9640.3083s
	iters: 200, epoch: 18 | loss: 0.1022134
	speed: 0.0422s/iter; left time: 1635.6942s
	iters: 300, epoch: 18 | loss: 0.2190979
	speed: 0.0499s/iter; left time: 1929.3852s
	iters: 400, epoch: 18 | loss: 0.0504777
	speed: 0.0523s/iter; left time: 2014.8547s
Epoch: 18 cost time: 22.110273838043213
Epoch: 18, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.228 Vali Acc: 0.955 Test Loss: 0.228 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0031763
	speed: 0.2952s/iter; left time: 11323.6800s
	iters: 200, epoch: 19 | loss: 0.0003946
	speed: 0.0414s/iter; left time: 1585.5743s
	iters: 300, epoch: 19 | loss: 0.0081860
	speed: 0.0390s/iter; left time: 1488.9012s
	iters: 400, epoch: 19 | loss: 0.0791700
	speed: 0.0472s/iter; left time: 1796.1264s
Epoch: 19 cost time: 22.276535272598267
Epoch: 19, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0015605
	speed: 0.2686s/iter; left time: 10178.7012s
	iters: 200, epoch: 20 | loss: 0.2634809
	speed: 0.0452s/iter; left time: 1708.9827s
	iters: 300, epoch: 20 | loss: 0.1924784
	speed: 0.0408s/iter; left time: 1535.9567s
	iters: 400, epoch: 20 | loss: 0.0005019
	speed: 0.0553s/iter; left time: 2077.4729s
Epoch: 20 cost time: 22.85358452796936
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0126516
	speed: 0.2842s/iter; left time: 10633.6812s
	iters: 200, epoch: 21 | loss: 0.0319849
	speed: 0.0509s/iter; left time: 1900.6177s
	iters: 300, epoch: 21 | loss: 0.0031178
	speed: 0.0342s/iter; left time: 1273.3213s
	iters: 400, epoch: 21 | loss: 0.0013671
	speed: 0.0396s/iter; left time: 1471.5221s
Epoch: 21 cost time: 20.829497575759888
Epoch: 21, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0719465
	speed: 0.2489s/iter; left time: 9196.1375s
	iters: 200, epoch: 22 | loss: 0.3365008
	speed: 0.0466s/iter; left time: 1718.3845s
	iters: 300, epoch: 22 | loss: 0.0665098
	speed: 0.0457s/iter; left time: 1680.4337s
	iters: 400, epoch: 22 | loss: 0.1902822
	speed: 0.0488s/iter; left time: 1788.5040s
Epoch: 22 cost time: 22.511167526245117
Epoch: 22, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0012472
	speed: 0.2994s/iter; left time: 10924.0457s
	iters: 200, epoch: 23 | loss: 0.0002756
	speed: 0.0365s/iter; left time: 1327.6552s
	iters: 300, epoch: 23 | loss: 0.0004203
	speed: 0.0430s/iter; left time: 1558.5002s
	iters: 400, epoch: 23 | loss: 0.2308380
	speed: 0.0468s/iter; left time: 1692.2586s
Epoch: 23 cost time: 21.706185817718506
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0050553
	speed: 0.2775s/iter; left time: 9994.9444s
	iters: 200, epoch: 24 | loss: 0.0153776
	speed: 0.0470s/iter; left time: 1687.1143s
	iters: 300, epoch: 24 | loss: 0.0090500
	speed: 0.0513s/iter; left time: 1837.9937s
	iters: 400, epoch: 24 | loss: 0.0018156
	speed: 0.0489s/iter; left time: 1745.3402s
Epoch: 24 cost time: 23.00294780731201
Epoch: 24, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0030224
	speed: 0.2470s/iter; left time: 8780.8716s
	iters: 200, epoch: 25 | loss: 0.0815043
	speed: 0.0415s/iter; left time: 1471.9684s
	iters: 300, epoch: 25 | loss: 0.0047092
	speed: 0.0403s/iter; left time: 1423.6958s
	iters: 400, epoch: 25 | loss: 0.0366824
	speed: 0.0450s/iter; left time: 1587.0826s
Epoch: 25 cost time: 20.247288465499878
Epoch: 25, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.945 Test Loss: 0.238 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9648370497427101
model parameter : 3971362
model size : 20.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8974366
	speed: 0.0649s/iter; left time: 3036.5517s
	iters: 200, epoch: 1 | loss: 0.3263814
	speed: 0.0433s/iter; left time: 2021.6532s
	iters: 300, epoch: 1 | loss: 0.2924277
	speed: 0.0433s/iter; left time: 2017.3355s
	iters: 400, epoch: 1 | loss: 0.1685912
	speed: 0.0455s/iter; left time: 2115.8570s
Epoch: 1 cost time: 22.603465795516968
Epoch: 1, Steps: 469 | Train Loss: 0.548 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
Validation loss decreased (inf --> -0.926241).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1017067
	speed: 0.2709s/iter; left time: 12553.3978s
	iters: 200, epoch: 2 | loss: 0.0242010
	speed: 0.0431s/iter; left time: 1992.4570s
	iters: 300, epoch: 2 | loss: 0.0709927
	speed: 0.0486s/iter; left time: 2239.8117s
	iters: 400, epoch: 2 | loss: 0.1411150
	speed: 0.0480s/iter; left time: 2211.4333s
Epoch: 2 cost time: 22.295077323913574
Epoch: 2, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.257 Vali Acc: 0.918 Test Loss: 0.257 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0430198
	speed: 0.2699s/iter; left time: 12379.4969s
	iters: 200, epoch: 3 | loss: 0.0182118
	speed: 0.0403s/iter; left time: 1844.5510s
	iters: 300, epoch: 3 | loss: 0.0316702
	speed: 0.0385s/iter; left time: 1756.3424s
	iters: 400, epoch: 3 | loss: 0.0331442
	speed: 0.0484s/iter; left time: 2205.8994s
Epoch: 3 cost time: 20.921093463897705
Epoch: 3, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.926241 --> -0.948254).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0512237
	speed: 0.2971s/iter; left time: 13485.8643s
	iters: 200, epoch: 4 | loss: 0.1614674
	speed: 0.0632s/iter; left time: 2862.7814s
	iters: 300, epoch: 4 | loss: 0.3669377
	speed: 0.0535s/iter; left time: 2416.0778s
	iters: 400, epoch: 4 | loss: 0.0177733
	speed: 0.0454s/iter; left time: 2049.3225s
Epoch: 4 cost time: 26.063433170318604
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0832350
	speed: 0.2813s/iter; left time: 12635.3107s
	iters: 200, epoch: 5 | loss: 0.1119576
	speed: 0.0459s/iter; left time: 2055.9547s
	iters: 300, epoch: 5 | loss: 0.0175814
	speed: 0.0456s/iter; left time: 2037.9897s
	iters: 400, epoch: 5 | loss: 0.0065452
	speed: 0.0495s/iter; left time: 2209.5158s
Epoch: 5 cost time: 21.92543601989746
Epoch: 5, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0877883
	speed: 0.2325s/iter; left time: 10337.7028s
	iters: 200, epoch: 6 | loss: 0.0271933
	speed: 0.0448s/iter; left time: 1986.4987s
	iters: 300, epoch: 6 | loss: 0.2783311
	speed: 0.0422s/iter; left time: 1868.6394s
	iters: 400, epoch: 6 | loss: 0.0951289
	speed: 0.0444s/iter; left time: 1962.6800s
Epoch: 6 cost time: 20.698282718658447
Epoch: 6, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2254940
	speed: 0.1946s/iter; left time: 8558.2240s
	iters: 200, epoch: 7 | loss: 0.0195598
	speed: 0.0309s/iter; left time: 1355.2592s
	iters: 300, epoch: 7 | loss: 0.2194905
	speed: 0.0310s/iter; left time: 1356.8599s
	iters: 400, epoch: 7 | loss: 0.2658085
	speed: 0.0387s/iter; left time: 1689.8647s
Epoch: 7 cost time: 16.704755306243896
Epoch: 7, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.353 Vali Acc: 0.901 Test Loss: 0.353 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1925552
	speed: 0.2387s/iter; left time: 10386.1110s
	iters: 200, epoch: 8 | loss: 0.1483726
	speed: 0.0480s/iter; left time: 2085.5635s
	iters: 300, epoch: 8 | loss: 0.2397803
	speed: 0.0417s/iter; left time: 1806.4605s
	iters: 400, epoch: 8 | loss: 0.0084982
	speed: 0.0520s/iter; left time: 2246.8147s
Epoch: 8 cost time: 22.59152841567993
Epoch: 8, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5105426
	speed: 0.2681s/iter; left time: 11542.5523s
	iters: 200, epoch: 9 | loss: 0.3317432
	speed: 0.0469s/iter; left time: 2013.6002s
	iters: 300, epoch: 9 | loss: 0.8116147
	speed: 0.0490s/iter; left time: 2098.3912s
	iters: 400, epoch: 9 | loss: 0.5479158
	speed: 0.0533s/iter; left time: 2277.6597s
Epoch: 9 cost time: 22.814530849456787
Epoch: 9, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1899507
	speed: 0.2537s/iter; left time: 10803.1963s
	iters: 200, epoch: 10 | loss: 0.0217967
	speed: 0.0411s/iter; left time: 1745.0206s
	iters: 300, epoch: 10 | loss: 0.2593750
	speed: 0.0383s/iter; left time: 1625.1066s
	iters: 400, epoch: 10 | loss: 0.1232706
	speed: 0.0331s/iter; left time: 1400.3930s
Epoch: 10 cost time: 19.70073962211609
Epoch: 10, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3577637
	speed: 0.2452s/iter; left time: 10325.0925s
	iters: 200, epoch: 11 | loss: 0.0485460
	speed: 0.0483s/iter; left time: 2030.2628s
	iters: 300, epoch: 11 | loss: 0.1488528
	speed: 0.0412s/iter; left time: 1728.7645s
	iters: 400, epoch: 11 | loss: 0.4206028
	speed: 0.0484s/iter; left time: 2024.0196s
Epoch: 11 cost time: 21.599242210388184
Epoch: 11, Steps: 469 | Train Loss: 0.177 Vali Loss: 0.343 Vali Acc: 0.899 Test Loss: 0.343 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0312653
	speed: 0.2727s/iter; left time: 11354.8138s
	iters: 200, epoch: 12 | loss: 0.0025608
	speed: 0.0403s/iter; left time: 1674.5343s
	iters: 300, epoch: 12 | loss: 0.0325627
	speed: 0.0488s/iter; left time: 2022.8913s
	iters: 400, epoch: 12 | loss: 0.1637259
	speed: 0.0445s/iter; left time: 1839.3908s
Epoch: 12 cost time: 21.35744071006775
Epoch: 12, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.237 Vali Acc: 0.945 Test Loss: 0.237 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2582110
	speed: 0.2933s/iter; left time: 12075.9730s
	iters: 200, epoch: 13 | loss: 0.0136606
	speed: 0.0514s/iter; left time: 2111.5270s
	iters: 300, epoch: 13 | loss: 0.0107081
	speed: 0.0493s/iter; left time: 2019.4478s
	iters: 400, epoch: 13 | loss: 0.0352177
	speed: 0.0464s/iter; left time: 1898.1043s
Epoch: 13 cost time: 23.993377923965454
Epoch: 13, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.948256146369354
model parameter : 3578146
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2774548
	speed: 0.0763s/iter; left time: 3571.4769s
	iters: 200, epoch: 1 | loss: 0.3911875
	speed: 0.0438s/iter; left time: 2044.6343s
	iters: 300, epoch: 1 | loss: 0.2326011
	speed: 0.0443s/iter; left time: 2066.4390s
	iters: 400, epoch: 1 | loss: 0.1550981
	speed: 0.0413s/iter; left time: 1921.7496s
Epoch: 1 cost time: 23.172589540481567
Epoch: 1, Steps: 469 | Train Loss: 0.539 Vali Loss: 0.255 Vali Acc: 0.913 Test Loss: 0.255 Test Acc: 0.913
Validation loss decreased (inf --> -0.913091).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0796065
	speed: 0.2445s/iter; left time: 11330.4407s
	iters: 200, epoch: 2 | loss: 0.0656883
	speed: 0.0442s/iter; left time: 2042.8642s
	iters: 300, epoch: 2 | loss: 0.0161846
	speed: 0.0383s/iter; left time: 1765.6895s
	iters: 400, epoch: 2 | loss: 0.0281049
	speed: 0.0410s/iter; left time: 1887.8033s
Epoch: 2 cost time: 20.386277198791504
Epoch: 2, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.913091 --> -0.931101).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0089492
	speed: 0.2492s/iter; left time: 11429.5233s
	iters: 200, epoch: 3 | loss: 0.3583487
	speed: 0.0474s/iter; left time: 2167.4506s
	iters: 300, epoch: 3 | loss: 0.0294005
	speed: 0.0431s/iter; left time: 1968.6075s
	iters: 400, epoch: 3 | loss: 0.4885973
	speed: 0.0445s/iter; left time: 2027.4420s
Epoch: 3 cost time: 21.13944149017334
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0175674
	speed: 0.2423s/iter; left time: 10996.7594s
	iters: 200, epoch: 4 | loss: 0.0173451
	speed: 0.0374s/iter; left time: 1694.1285s
	iters: 300, epoch: 4 | loss: 0.0962962
	speed: 0.0388s/iter; left time: 1755.6297s
	iters: 400, epoch: 4 | loss: 0.0914155
	speed: 0.0502s/iter; left time: 2263.7848s
Epoch: 4 cost time: 20.178287982940674
Epoch: 4, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
Validation loss decreased (-0.931101 --> -0.932245).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0208087
	speed: 0.2434s/iter; left time: 10935.4459s
	iters: 200, epoch: 5 | loss: 0.0333004
	speed: 0.0394s/iter; left time: 1766.2935s
	iters: 300, epoch: 5 | loss: 0.3709512
	speed: 0.0447s/iter; left time: 1997.1057s
	iters: 400, epoch: 5 | loss: 0.1749766
	speed: 0.0480s/iter; left time: 2141.2438s
Epoch: 5 cost time: 21.279584646224976
Epoch: 5, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.375 Vali Acc: 0.895 Test Loss: 0.375 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0115995
	speed: 0.2274s/iter; left time: 10108.7749s
	iters: 200, epoch: 6 | loss: 0.1468742
	speed: 0.0362s/iter; left time: 1604.4490s
	iters: 300, epoch: 6 | loss: 0.6077000
	speed: 0.0403s/iter; left time: 1783.1165s
	iters: 400, epoch: 6 | loss: 0.0196843
	speed: 0.0449s/iter; left time: 1983.9022s
Epoch: 6 cost time: 19.03599262237549
Epoch: 6, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.932245 --> -0.948826).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0068025
	speed: 0.2574s/iter; left time: 11322.7566s
	iters: 200, epoch: 7 | loss: 0.0490418
	speed: 0.0441s/iter; left time: 1934.6741s
	iters: 300, epoch: 7 | loss: 0.0738441
	speed: 0.0400s/iter; left time: 1749.5442s
	iters: 400, epoch: 7 | loss: 0.8003552
	speed: 0.0409s/iter; left time: 1788.6960s
Epoch: 7 cost time: 19.71726107597351
Epoch: 7, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
Validation loss decreased (-0.948826 --> -0.951113).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0217025
	speed: 0.2373s/iter; left time: 10326.2227s
	iters: 200, epoch: 8 | loss: 0.0720659
	speed: 0.0395s/iter; left time: 1715.5308s
	iters: 300, epoch: 8 | loss: 0.0079611
	speed: 0.0361s/iter; left time: 1565.7700s
	iters: 400, epoch: 8 | loss: 0.0179778
	speed: 0.0373s/iter; left time: 1611.4980s
Epoch: 8 cost time: 19.432567596435547
Epoch: 8, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.327 Vali Acc: 0.920 Test Loss: 0.327 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7695913
	speed: 0.2740s/iter; left time: 11795.7906s
	iters: 200, epoch: 9 | loss: 0.0569778
	speed: 0.0443s/iter; left time: 1904.1614s
	iters: 300, epoch: 9 | loss: 0.0113419
	speed: 0.0433s/iter; left time: 1854.4424s
	iters: 400, epoch: 9 | loss: 0.2313560
	speed: 0.0364s/iter; left time: 1555.7279s
Epoch: 9 cost time: 20.60252022743225
Epoch: 9, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.951113 --> -0.960547).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1499186
	speed: 0.2791s/iter; left time: 11884.1410s
	iters: 200, epoch: 10 | loss: 0.4187526
	speed: 0.0562s/iter; left time: 2387.4100s
	iters: 300, epoch: 10 | loss: 0.1846971
	speed: 0.0558s/iter; left time: 2363.6796s
	iters: 400, epoch: 10 | loss: 0.2623484
	speed: 0.0444s/iter; left time: 1877.8459s
Epoch: 10 cost time: 24.26726508140564
Epoch: 10, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0212150
	speed: 0.2950s/iter; left time: 12422.2956s
	iters: 200, epoch: 11 | loss: 0.1655425
	speed: 0.0501s/iter; left time: 2106.7056s
	iters: 300, epoch: 11 | loss: 0.3858638
	speed: 0.0505s/iter; left time: 2115.9793s
	iters: 400, epoch: 11 | loss: 0.0040420
	speed: 0.0476s/iter; left time: 1990.2598s
Epoch: 11 cost time: 23.387436151504517
Epoch: 11, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5161675
	speed: 0.2464s/iter; left time: 10261.1283s
	iters: 200, epoch: 12 | loss: 0.0468345
	speed: 0.0354s/iter; left time: 1469.4189s
	iters: 300, epoch: 12 | loss: 0.4747874
	speed: 0.0318s/iter; left time: 1316.6379s
	iters: 400, epoch: 12 | loss: 0.0219695
	speed: 0.0334s/iter; left time: 1382.7719s
Epoch: 12 cost time: 16.96736431121826
Epoch: 12, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0725888
	speed: 0.2421s/iter; left time: 9968.9402s
	iters: 200, epoch: 13 | loss: 0.3021724
	speed: 0.0385s/iter; left time: 1580.0372s
	iters: 300, epoch: 13 | loss: 0.0133945
	speed: 0.0381s/iter; left time: 1559.4524s
	iters: 400, epoch: 13 | loss: 0.8496367
	speed: 0.0351s/iter; left time: 1433.5588s
Epoch: 13 cost time: 17.981679677963257
Epoch: 13, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0933783
	speed: 0.2421s/iter; left time: 9855.1301s
	iters: 200, epoch: 14 | loss: 0.0151168
	speed: 0.0509s/iter; left time: 2064.8281s
	iters: 300, epoch: 14 | loss: 0.3608207
	speed: 0.0517s/iter; left time: 2092.9046s
	iters: 400, epoch: 14 | loss: 0.0171756
	speed: 0.0439s/iter; left time: 1773.3987s
Epoch: 14 cost time: 22.277589082717896
Epoch: 14, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.339 Vali Acc: 0.918 Test Loss: 0.339 Test Acc: 0.918
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1867988
	speed: 0.3169s/iter; left time: 12751.1936s
	iters: 200, epoch: 15 | loss: 0.0445643
	speed: 0.0475s/iter; left time: 1905.4499s
	iters: 300, epoch: 15 | loss: 0.0320374
	speed: 0.0550s/iter; left time: 2203.0141s
	iters: 400, epoch: 15 | loss: 0.0008429
	speed: 0.0483s/iter; left time: 1928.1312s
Epoch: 15 cost time: 25.401472806930542
Epoch: 15, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0691132
	speed: 0.3519s/iter; left time: 13991.9400s
	iters: 200, epoch: 16 | loss: 0.0040687
	speed: 0.0584s/iter; left time: 2318.0468s
	iters: 300, epoch: 16 | loss: 0.4541176
	speed: 0.0508s/iter; left time: 2011.4814s
	iters: 400, epoch: 16 | loss: 0.0133026
	speed: 0.0499s/iter; left time: 1968.1524s
Epoch: 16 cost time: 26.95700192451477
Epoch: 16, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.4740551
	speed: 0.3199s/iter; left time: 12571.3938s
	iters: 200, epoch: 17 | loss: 0.0227616
	speed: 0.0532s/iter; left time: 2087.0327s
	iters: 300, epoch: 17 | loss: 0.0190348
	speed: 0.0444s/iter; left time: 1735.3964s
	iters: 400, epoch: 17 | loss: 0.0669789
	speed: 0.0444s/iter; left time: 1731.5871s
Epoch: 17 cost time: 24.229247093200684
Epoch: 17, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0639091
	speed: 0.3015s/iter; left time: 11705.0476s
	iters: 200, epoch: 18 | loss: 0.0523820
	speed: 0.0495s/iter; left time: 1918.5809s
	iters: 300, epoch: 18 | loss: 0.0013330
	speed: 0.0625s/iter; left time: 2415.1716s
	iters: 400, epoch: 18 | loss: 0.0272238
	speed: 0.0634s/iter; left time: 2444.4953s
Epoch: 18 cost time: 27.25864839553833
Epoch: 18, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0028450
	speed: 0.3403s/iter; left time: 13053.6895s
	iters: 200, epoch: 19 | loss: 0.8875321
	speed: 0.0549s/iter; left time: 2101.9486s
	iters: 300, epoch: 19 | loss: 0.0100412
	speed: 0.0491s/iter; left time: 1874.8679s
	iters: 400, epoch: 19 | loss: 0.0936401
	speed: 0.0526s/iter; left time: 2000.9507s
Epoch: 19 cost time: 25.09553074836731
Epoch: 19, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.277 Vali Acc: 0.939 Test Loss: 0.277 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9605488850771869
model parameter : 3577890
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8413511
	speed: 0.0705s/iter; left time: 3300.1346s
	iters: 200, epoch: 1 | loss: 0.4273959
	speed: 0.0497s/iter; left time: 2322.7334s
	iters: 300, epoch: 1 | loss: 0.0856181
	speed: 0.0458s/iter; left time: 2132.2875s
	iters: 400, epoch: 1 | loss: 0.3720296
	speed: 0.0513s/iter; left time: 2385.3184s
Epoch: 1 cost time: 24.959024906158447
Epoch: 1, Steps: 469 | Train Loss: 0.525 Vali Loss: 0.287 Vali Acc: 0.897 Test Loss: 0.287 Test Acc: 0.897
Validation loss decreased (inf --> -0.897367).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1439771
	speed: 0.2987s/iter; left time: 13837.5684s
	iters: 200, epoch: 2 | loss: 0.1095206
	speed: 0.0499s/iter; left time: 2305.5820s
	iters: 300, epoch: 2 | loss: 0.1512968
	speed: 0.0485s/iter; left time: 2237.4997s
	iters: 400, epoch: 2 | loss: 0.0243269
	speed: 0.0618s/iter; left time: 2845.0409s
Epoch: 2 cost time: 24.78657555580139
Epoch: 2, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.260 Vali Acc: 0.913 Test Loss: 0.260 Test Acc: 0.913
Validation loss decreased (-0.897367 --> -0.912805).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0268667
	speed: 0.3378s/iter; left time: 15494.6216s
	iters: 200, epoch: 3 | loss: 0.0579805
	speed: 0.0448s/iter; left time: 2050.2136s
	iters: 300, epoch: 3 | loss: 0.2815750
	speed: 0.0659s/iter; left time: 3007.6984s
	iters: 400, epoch: 3 | loss: 0.1876668
	speed: 0.0620s/iter; left time: 2824.7395s
Epoch: 3 cost time: 28.382181644439697
Epoch: 3, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.912805 --> -0.941679).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0241339
	speed: 0.3520s/iter; left time: 15977.0733s
	iters: 200, epoch: 4 | loss: 0.1989978
	speed: 0.0492s/iter; left time: 2226.7502s
	iters: 300, epoch: 4 | loss: 0.0175802
	speed: 0.0517s/iter; left time: 2335.6462s
	iters: 400, epoch: 4 | loss: 0.0087456
	speed: 0.0582s/iter; left time: 2626.0600s
Epoch: 4 cost time: 27.672167539596558
Epoch: 4, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.235 Vali Acc: 0.929 Test Loss: 0.235 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2222447
	speed: 0.3199s/iter; left time: 14369.5902s
	iters: 200, epoch: 5 | loss: 0.0025298
	speed: 0.0496s/iter; left time: 2223.7929s
	iters: 300, epoch: 5 | loss: 0.4026271
	speed: 0.0425s/iter; left time: 1901.4351s
	iters: 400, epoch: 5 | loss: 0.3078356
	speed: 0.0501s/iter; left time: 2236.5223s
Epoch: 5 cost time: 23.737829208374023
Epoch: 5, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.941679 --> -0.964550).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0111122
	speed: 0.3590s/iter; left time: 15960.8715s
	iters: 200, epoch: 6 | loss: 0.0364806
	speed: 0.0544s/iter; left time: 2411.7379s
	iters: 300, epoch: 6 | loss: 0.0141801
	speed: 0.0473s/iter; left time: 2092.1161s
	iters: 400, epoch: 6 | loss: 0.0247514
	speed: 0.0527s/iter; left time: 2329.1104s
Epoch: 6 cost time: 25.12958335876465
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.964550 --> -0.966837).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0128381
	speed: 0.3305s/iter; left time: 14535.5987s
	iters: 200, epoch: 7 | loss: 0.0064932
	speed: 0.0585s/iter; left time: 2566.3304s
	iters: 300, epoch: 7 | loss: 0.0756270
	speed: 0.0511s/iter; left time: 2236.6888s
	iters: 400, epoch: 7 | loss: 0.0546012
	speed: 0.0529s/iter; left time: 2309.7032s
Epoch: 7 cost time: 25.780168533325195
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0404865
	speed: 0.3021s/iter; left time: 13148.9252s
	iters: 200, epoch: 8 | loss: 0.1335554
	speed: 0.0467s/iter; left time: 2028.5574s
	iters: 300, epoch: 8 | loss: 0.0372102
	speed: 0.0504s/iter; left time: 2183.5843s
	iters: 400, epoch: 8 | loss: 0.0117418
	speed: 0.0541s/iter; left time: 2338.7127s
Epoch: 8 cost time: 24.189947843551636
Epoch: 8, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1862961
	speed: 0.3223s/iter; left time: 13872.8357s
	iters: 200, epoch: 9 | loss: 0.3449168
	speed: 0.0497s/iter; left time: 2134.6326s
	iters: 300, epoch: 9 | loss: 0.0591835
	speed: 0.0523s/iter; left time: 2240.3612s
	iters: 400, epoch: 9 | loss: 0.0501415
	speed: 0.0583s/iter; left time: 2491.9642s
Epoch: 9 cost time: 25.626579523086548
Epoch: 9, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0130366
	speed: 0.3167s/iter; left time: 13486.1778s
	iters: 200, epoch: 10 | loss: 0.0021129
	speed: 0.0622s/iter; left time: 2641.6983s
	iters: 300, epoch: 10 | loss: 0.0022405
	speed: 0.0583s/iter; left time: 2471.1486s
	iters: 400, epoch: 10 | loss: 0.0472452
	speed: 0.0597s/iter; left time: 2522.9810s
Epoch: 10 cost time: 28.072227716445923
Epoch: 10, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2998192
	speed: 0.3562s/iter; left time: 15000.6631s
	iters: 200, epoch: 11 | loss: 0.0078149
	speed: 0.0499s/iter; left time: 2098.2670s
	iters: 300, epoch: 11 | loss: 0.0179745
	speed: 0.0582s/iter; left time: 2438.7559s
	iters: 400, epoch: 11 | loss: 0.0517673
	speed: 0.0622s/iter; left time: 2599.8038s
Epoch: 11 cost time: 26.298860788345337
Epoch: 11, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0528256
	speed: 0.2878s/iter; left time: 11985.6117s
	iters: 200, epoch: 12 | loss: 0.2257190
	speed: 0.0438s/iter; left time: 1821.5906s
	iters: 300, epoch: 12 | loss: 0.0612118
	speed: 0.0455s/iter; left time: 1886.3952s
	iters: 400, epoch: 12 | loss: 0.0797898
	speed: 0.0441s/iter; left time: 1823.8321s
Epoch: 12 cost time: 21.54741930961609
Epoch: 12, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0448971
	speed: 0.3054s/iter; left time: 12573.9273s
	iters: 200, epoch: 13 | loss: 0.0745080
	speed: 0.0579s/iter; left time: 2379.0467s
	iters: 300, epoch: 13 | loss: 0.1956407
	speed: 0.0566s/iter; left time: 2318.3873s
	iters: 400, epoch: 13 | loss: 0.1093994
	speed: 0.0572s/iter; left time: 2336.8248s
Epoch: 13 cost time: 26.202768087387085
Epoch: 13, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0143779
	speed: 0.3401s/iter; left time: 13841.7914s
	iters: 200, epoch: 14 | loss: 0.2742704
	speed: 0.0490s/iter; left time: 1989.9615s
	iters: 300, epoch: 14 | loss: 0.0075776
	speed: 0.0613s/iter; left time: 2482.7007s
	iters: 400, epoch: 14 | loss: 0.0092687
	speed: 0.0596s/iter; left time: 2407.8438s
Epoch: 14 cost time: 27.589072704315186
Epoch: 14, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1326820
	speed: 0.3387s/iter; left time: 13629.0433s
	iters: 200, epoch: 15 | loss: 0.1044152
	speed: 0.0582s/iter; left time: 2336.5242s
	iters: 300, epoch: 15 | loss: 0.0258340
	speed: 0.0567s/iter; left time: 2271.9074s
	iters: 400, epoch: 15 | loss: 0.0035583
	speed: 0.0558s/iter; left time: 2227.5722s
Epoch: 15 cost time: 26.79292869567871
Epoch: 15, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.230 Vali Acc: 0.947 Test Loss: 0.230 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0050059
	speed: 0.3053s/iter; left time: 12141.8616s
	iters: 200, epoch: 16 | loss: 0.0116242
	speed: 0.0507s/iter; left time: 2011.8414s
	iters: 300, epoch: 16 | loss: 0.0398237
	speed: 0.0558s/iter; left time: 2206.2116s
	iters: 400, epoch: 16 | loss: 0.0856528
	speed: 0.0534s/iter; left time: 2106.7247s
Epoch: 16 cost time: 25.014857292175293
Epoch: 16, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 3577634
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5833900
	speed: 0.0837s/iter; left time: 3916.9753s
	iters: 200, epoch: 1 | loss: 0.3499568
	speed: 0.0468s/iter; left time: 2185.2554s
	iters: 300, epoch: 1 | loss: 0.1218859
	speed: 0.0470s/iter; left time: 2188.9596s
	iters: 400, epoch: 1 | loss: 0.0987954
	speed: 0.0573s/iter; left time: 2664.2975s
Epoch: 1 cost time: 27.19452428817749
Epoch: 1, Steps: 469 | Train Loss: 0.545 Vali Loss: 0.355 Vali Acc: 0.890 Test Loss: 0.355 Test Acc: 0.890
Validation loss decreased (inf --> -0.889648).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1607071
	speed: 0.2949s/iter; left time: 13663.7980s
	iters: 200, epoch: 2 | loss: 0.0742634
	speed: 0.0633s/iter; left time: 2926.3704s
	iters: 300, epoch: 2 | loss: 0.0915528
	speed: 0.0464s/iter; left time: 2140.8149s
	iters: 400, epoch: 2 | loss: 0.1072419
	speed: 0.0498s/iter; left time: 2293.9398s
Epoch: 2 cost time: 24.150446891784668
Epoch: 2, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
Validation loss decreased (-0.889648 --> -0.934532).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0282414
	speed: 0.3000s/iter; left time: 13760.4190s
	iters: 200, epoch: 3 | loss: 0.1423223
	speed: 0.0612s/iter; left time: 2799.5808s
	iters: 300, epoch: 3 | loss: 0.0584747
	speed: 0.0502s/iter; left time: 2290.4438s
	iters: 400, epoch: 3 | loss: 0.1648442
	speed: 0.0530s/iter; left time: 2414.9977s
Epoch: 3 cost time: 26.981313228607178
Epoch: 3, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.293 Vali Acc: 0.912 Test Loss: 0.293 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3138522
	speed: 0.3459s/iter; left time: 15703.2214s
	iters: 200, epoch: 4 | loss: 0.2081093
	speed: 0.0570s/iter; left time: 2583.1774s
	iters: 300, epoch: 4 | loss: 0.0239007
	speed: 0.0580s/iter; left time: 2621.5657s
	iters: 400, epoch: 4 | loss: 0.0515994
	speed: 0.0609s/iter; left time: 2746.9596s
Epoch: 4 cost time: 27.209267139434814
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2022022
	speed: 0.3188s/iter; left time: 14322.6317s
	iters: 200, epoch: 5 | loss: 0.0044610
	speed: 0.0635s/iter; left time: 2846.7548s
	iters: 300, epoch: 5 | loss: 0.0189033
	speed: 0.0596s/iter; left time: 2664.1760s
	iters: 400, epoch: 5 | loss: 0.0504890
	speed: 0.0512s/iter; left time: 2286.3133s
Epoch: 5 cost time: 27.2780864238739
Epoch: 5, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1139191
	speed: 0.3376s/iter; left time: 15008.3503s
	iters: 200, epoch: 6 | loss: 0.0248059
	speed: 0.0488s/iter; left time: 2166.1924s
	iters: 300, epoch: 6 | loss: 0.0587859
	speed: 0.0529s/iter; left time: 2341.3834s
	iters: 400, epoch: 6 | loss: 0.0298461
	speed: 0.0530s/iter; left time: 2339.6615s
Epoch: 6 cost time: 25.58944869041443
Epoch: 6, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0877868
	speed: 0.3016s/iter; left time: 13268.1416s
	iters: 200, epoch: 7 | loss: 0.0108711
	speed: 0.0456s/iter; left time: 2001.1017s
	iters: 300, epoch: 7 | loss: 0.0105055
	speed: 0.0534s/iter; left time: 2337.5837s
	iters: 400, epoch: 7 | loss: 0.3348699
	speed: 0.0463s/iter; left time: 2022.8285s
Epoch: 7 cost time: 23.50711154937744
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.934532 --> -0.941393).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0087813
	speed: 0.3127s/iter; left time: 13609.3769s
	iters: 200, epoch: 8 | loss: 0.0073620
	speed: 0.0480s/iter; left time: 2085.1845s
	iters: 300, epoch: 8 | loss: 0.0147068
	speed: 0.0577s/iter; left time: 2497.8231s
	iters: 400, epoch: 8 | loss: 0.0470125
	speed: 0.0515s/iter; left time: 2223.5777s
Epoch: 8 cost time: 24.14987325668335
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.941393 --> -0.957689).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3620010
	speed: 0.2697s/iter; left time: 11611.8968s
	iters: 200, epoch: 9 | loss: 0.0176177
	speed: 0.0425s/iter; left time: 1826.7868s
	iters: 300, epoch: 9 | loss: 0.0083363
	speed: 0.0494s/iter; left time: 2116.1050s
	iters: 400, epoch: 9 | loss: 0.0015722
	speed: 0.0430s/iter; left time: 1837.1104s
Epoch: 9 cost time: 22.335399866104126
Epoch: 9, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0067562
	speed: 0.2940s/iter; left time: 12518.3610s
	iters: 200, epoch: 10 | loss: 0.0885512
	speed: 0.0387s/iter; left time: 1644.5546s
	iters: 300, epoch: 10 | loss: 0.0247790
	speed: 0.0397s/iter; left time: 1683.2688s
	iters: 400, epoch: 10 | loss: 0.0040477
	speed: 0.0458s/iter; left time: 1935.7679s
Epoch: 10 cost time: 22.256227254867554
Epoch: 10, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1271910
	speed: 0.2749s/iter; left time: 11575.1109s
	iters: 200, epoch: 11 | loss: 0.0019396
	speed: 0.0431s/iter; left time: 1809.4470s
	iters: 300, epoch: 11 | loss: 0.0172256
	speed: 0.0421s/iter; left time: 1762.3968s
	iters: 400, epoch: 11 | loss: 0.0025170
	speed: 0.0467s/iter; left time: 1954.3394s
Epoch: 11 cost time: 21.66537094116211
Epoch: 11, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0018954
	speed: 0.2915s/iter; left time: 12136.9121s
	iters: 200, epoch: 12 | loss: 0.0214625
	speed: 0.0537s/iter; left time: 2229.6298s
	iters: 300, epoch: 12 | loss: 0.0326744
	speed: 0.0650s/iter; left time: 2694.2098s
	iters: 400, epoch: 12 | loss: 0.0282080
	speed: 0.0528s/iter; left time: 2184.1442s
Epoch: 12 cost time: 26.828397750854492
Epoch: 12, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0020453
	speed: 0.3061s/iter; left time: 12603.4108s
	iters: 200, epoch: 13 | loss: 0.1275548
	speed: 0.0522s/iter; left time: 2142.0049s
	iters: 300, epoch: 13 | loss: 0.1359178
	speed: 0.0529s/iter; left time: 2168.7602s
	iters: 400, epoch: 13 | loss: 0.0015386
	speed: 0.0537s/iter; left time: 2193.4862s
Epoch: 13 cost time: 25.695069551467896
Epoch: 13, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0394396
	speed: 0.2977s/iter; left time: 12119.1122s
	iters: 200, epoch: 14 | loss: 0.0013272
	speed: 0.0558s/iter; left time: 2265.8764s
	iters: 300, epoch: 14 | loss: 0.0262578
	speed: 0.0425s/iter; left time: 1721.5851s
	iters: 400, epoch: 14 | loss: 0.0008591
	speed: 0.0446s/iter; left time: 1801.9550s
Epoch: 14 cost time: 23.448935747146606
Epoch: 14, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (-0.957689 --> -0.958832).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0201943
	speed: 0.2623s/iter; left time: 10555.6484s
	iters: 200, epoch: 15 | loss: 0.0339810
	speed: 0.0567s/iter; left time: 2274.1258s
	iters: 300, epoch: 15 | loss: 0.0091574
	speed: 0.0482s/iter; left time: 1930.4243s
	iters: 400, epoch: 15 | loss: 0.1546417
	speed: 0.0532s/iter; left time: 2123.0909s
Epoch: 15 cost time: 24.332079887390137
Epoch: 15, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0052455
	speed: 0.3004s/iter; left time: 11944.4969s
	iters: 200, epoch: 16 | loss: 0.0093907
	speed: 0.0403s/iter; left time: 1599.2773s
	iters: 300, epoch: 16 | loss: 0.0582502
	speed: 0.0533s/iter; left time: 2108.3701s
	iters: 400, epoch: 16 | loss: 0.0036347
	speed: 0.0549s/iter; left time: 2166.5678s
Epoch: 16 cost time: 23.21862244606018
Epoch: 16, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0292490
	speed: 0.3285s/iter; left time: 12910.4420s
	iters: 200, epoch: 17 | loss: 0.0767421
	speed: 0.0438s/iter; left time: 1717.3414s
	iters: 300, epoch: 17 | loss: 0.0220955
	speed: 0.0534s/iter; left time: 2086.4660s
	iters: 400, epoch: 17 | loss: 0.4124511
	speed: 0.0454s/iter; left time: 1771.5601s
Epoch: 17 cost time: 23.59348702430725
Epoch: 17, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0452605
	speed: 0.3200s/iter; left time: 12423.0735s
	iters: 200, epoch: 18 | loss: 0.0075248
	speed: 0.0464s/iter; left time: 1796.8695s
	iters: 300, epoch: 18 | loss: 0.0949754
	speed: 0.0457s/iter; left time: 1764.1195s
	iters: 400, epoch: 18 | loss: 0.1694081
	speed: 0.0413s/iter; left time: 1589.5299s
Epoch: 18 cost time: 22.297759771347046
Epoch: 18, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0014331
	speed: 0.3142s/iter; left time: 12053.1720s
	iters: 200, epoch: 19 | loss: 0.0114047
	speed: 0.0422s/iter; left time: 1613.3965s
	iters: 300, epoch: 19 | loss: 0.0331087
	speed: 0.0486s/iter; left time: 1854.3540s
	iters: 400, epoch: 19 | loss: 0.0446929
	speed: 0.0433s/iter; left time: 1646.5587s
Epoch: 19 cost time: 22.07142663002014
Epoch: 19, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.958832 --> -0.961977).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0446015
	speed: 0.2842s/iter; left time: 10768.3355s
	iters: 200, epoch: 20 | loss: 0.0443715
	speed: 0.0487s/iter; left time: 1841.1551s
	iters: 300, epoch: 20 | loss: 0.0079520
	speed: 0.0421s/iter; left time: 1588.4095s
	iters: 400, epoch: 20 | loss: 0.0195718
	speed: 0.0427s/iter; left time: 1603.5576s
Epoch: 20 cost time: 22.430792331695557
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.961977 --> -0.970267).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1293971
	speed: 0.3061s/iter; left time: 11455.0895s
	iters: 200, epoch: 21 | loss: 0.0089512
	speed: 0.0429s/iter; left time: 1601.3157s
	iters: 300, epoch: 21 | loss: 0.3009359
	speed: 0.0409s/iter; left time: 1521.6220s
	iters: 400, epoch: 21 | loss: 0.0010188
	speed: 0.0427s/iter; left time: 1586.5166s
Epoch: 21 cost time: 20.744951963424683
Epoch: 21, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.376 Vali Acc: 0.921 Test Loss: 0.376 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0014581
	speed: 0.2516s/iter; left time: 9296.6567s
	iters: 200, epoch: 22 | loss: 0.0518810
	speed: 0.0393s/iter; left time: 1449.5645s
	iters: 300, epoch: 22 | loss: 0.0759264
	speed: 0.0476s/iter; left time: 1748.6976s
	iters: 400, epoch: 22 | loss: 0.2152407
	speed: 0.0494s/iter; left time: 1812.1683s
Epoch: 22 cost time: 22.578639030456543
Epoch: 22, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.970267 --> -0.974270).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0018748
	speed: 0.3170s/iter; left time: 11566.4391s
	iters: 200, epoch: 23 | loss: 0.1096176
	speed: 0.0467s/iter; left time: 1700.6351s
	iters: 300, epoch: 23 | loss: 0.0027488
	speed: 0.0475s/iter; left time: 1723.2749s
	iters: 400, epoch: 23 | loss: 0.0007899
	speed: 0.0516s/iter; left time: 1867.2504s
Epoch: 23 cost time: 23.453086853027344
Epoch: 23, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0253035
	speed: 0.3000s/iter; left time: 10803.1568s
	iters: 200, epoch: 24 | loss: 0.0006788
	speed: 0.0390s/iter; left time: 1401.1044s
	iters: 300, epoch: 24 | loss: 0.1242829
	speed: 0.0496s/iter; left time: 1776.5708s
	iters: 400, epoch: 24 | loss: 0.1473898
	speed: 0.0526s/iter; left time: 1878.9004s
Epoch: 24 cost time: 22.929799795150757
Epoch: 24, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0277452
	speed: 0.3168s/iter; left time: 11261.0940s
	iters: 200, epoch: 25 | loss: 0.0642307
	speed: 0.0574s/iter; left time: 2033.8102s
	iters: 300, epoch: 25 | loss: 0.0011251
	speed: 0.0462s/iter; left time: 1633.9390s
	iters: 400, epoch: 25 | loss: 0.0022175
	speed: 0.0470s/iter; left time: 1658.0201s
Epoch: 25 cost time: 23.980235815048218
Epoch: 25, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0003734
	speed: 0.3001s/iter; left time: 10525.1539s
	iters: 200, epoch: 26 | loss: 0.0127509
	speed: 0.0506s/iter; left time: 1770.9859s
	iters: 300, epoch: 26 | loss: 0.0011224
	speed: 0.0500s/iter; left time: 1742.4234s
	iters: 400, epoch: 26 | loss: 0.0018335
	speed: 0.0578s/iter; left time: 2008.9302s
Epoch: 26 cost time: 25.371874809265137
Epoch: 26, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0057000
	speed: 0.3143s/iter; left time: 10875.9907s
	iters: 200, epoch: 27 | loss: 0.0021001
	speed: 0.0480s/iter; left time: 1656.3016s
	iters: 300, epoch: 27 | loss: 0.0094561
	speed: 0.0491s/iter; left time: 1689.6414s
	iters: 400, epoch: 27 | loss: 0.0260558
	speed: 0.0468s/iter; left time: 1605.7201s
Epoch: 27 cost time: 22.848072290420532
Epoch: 27, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.290 Vali Acc: 0.940 Test Loss: 0.290 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1887183
	speed: 0.2899s/iter; left time: 9895.4835s
	iters: 200, epoch: 28 | loss: 0.0009608
	speed: 0.0466s/iter; left time: 1584.9539s
	iters: 300, epoch: 28 | loss: 0.2997217
	speed: 0.0526s/iter; left time: 1784.6209s
	iters: 400, epoch: 28 | loss: 0.0443209
	speed: 0.0481s/iter; left time: 1627.1089s
Epoch: 28 cost time: 23.698291301727295
Epoch: 28, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0194220
	speed: 0.3149s/iter; left time: 10603.4932s
	iters: 200, epoch: 29 | loss: 0.0021223
	speed: 0.0516s/iter; left time: 1731.5250s
	iters: 300, epoch: 29 | loss: 0.0033369
	speed: 0.0497s/iter; left time: 1662.3398s
	iters: 400, epoch: 29 | loss: 0.0034000
	speed: 0.0551s/iter; left time: 1840.0931s
Epoch: 29 cost time: 25.002400636672974
Epoch: 29, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0061064
	speed: 0.3214s/iter; left time: 10671.4361s
	iters: 200, epoch: 30 | loss: 0.2508854
	speed: 0.0615s/iter; left time: 2036.6791s
	iters: 300, epoch: 30 | loss: 0.0069511
	speed: 0.0486s/iter; left time: 1604.4262s
	iters: 400, epoch: 30 | loss: 0.0091278
	speed: 0.0632s/iter; left time: 2078.0874s
Epoch: 30 cost time: 27.865284204483032
Epoch: 30, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0054816
	speed: 0.2868s/iter; left time: 9386.8493s
	iters: 200, epoch: 31 | loss: 0.0035797
	speed: 0.0402s/iter; left time: 1310.1928s
	iters: 300, epoch: 31 | loss: 0.0021125
	speed: 0.0403s/iter; left time: 1312.4169s
	iters: 400, epoch: 31 | loss: 0.0528765
	speed: 0.0417s/iter; left time: 1352.1749s
Epoch: 31 cost time: 20.68729543685913
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0026889
	speed: 0.2811s/iter; left time: 9069.8704s
	iters: 200, epoch: 32 | loss: 0.0667414
	speed: 0.0418s/iter; left time: 1344.3440s
	iters: 300, epoch: 32 | loss: 0.1368476
	speed: 0.0486s/iter; left time: 1558.4616s
	iters: 400, epoch: 32 | loss: 0.0020830
	speed: 0.0484s/iter; left time: 1546.7503s
Epoch: 32 cost time: 22.310421466827393
Epoch: 32, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 3577378
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6232919
	speed: 0.0766s/iter; left time: 3583.4341s
	iters: 200, epoch: 1 | loss: 0.2984796
	speed: 0.0443s/iter; left time: 2068.2187s
	iters: 300, epoch: 1 | loss: 0.2959298
	speed: 0.0451s/iter; left time: 2102.0232s
	iters: 400, epoch: 1 | loss: 0.3931038
	speed: 0.0485s/iter; left time: 2256.3337s
Epoch: 1 cost time: 24.5283305644989
Epoch: 1, Steps: 469 | Train Loss: 0.553 Vali Loss: 0.256 Vali Acc: 0.918 Test Loss: 0.256 Test Acc: 0.918
Validation loss decreased (inf --> -0.917665).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0404168
	speed: 0.2595s/iter; left time: 12024.9879s
	iters: 200, epoch: 2 | loss: 0.1393944
	speed: 0.0504s/iter; left time: 2329.4754s
	iters: 300, epoch: 2 | loss: 0.0698473
	speed: 0.0466s/iter; left time: 2149.1618s
	iters: 400, epoch: 2 | loss: 0.1256112
	speed: 0.0465s/iter; left time: 2140.3096s
Epoch: 2 cost time: 21.398093461990356
Epoch: 2, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
Validation loss decreased (-0.917665 --> -0.939964).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0174341
	speed: 0.2454s/iter; left time: 11252.6216s
	iters: 200, epoch: 3 | loss: 0.0403827
	speed: 0.0408s/iter; left time: 1867.2684s
	iters: 300, epoch: 3 | loss: 0.2002767
	speed: 0.0451s/iter; left time: 2057.3495s
	iters: 400, epoch: 3 | loss: 0.0266588
	speed: 0.0425s/iter; left time: 1936.4592s
Epoch: 3 cost time: 20.165691614151
Epoch: 3, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
Validation loss decreased (-0.939964 --> -0.950541).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0586960
	speed: 0.2435s/iter; left time: 11053.0198s
	iters: 200, epoch: 4 | loss: 0.1051147
	speed: 0.0451s/iter; left time: 2043.2164s
	iters: 300, epoch: 4 | loss: 0.0976434
	speed: 0.0488s/iter; left time: 2206.0699s
	iters: 400, epoch: 4 | loss: 0.0861724
	speed: 0.0436s/iter; left time: 1967.7385s
Epoch: 4 cost time: 21.25085687637329
Epoch: 4, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.289 Vali Acc: 0.914 Test Loss: 0.289 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0388083
	speed: 0.2851s/iter; left time: 12808.6654s
	iters: 200, epoch: 5 | loss: 0.0441874
	speed: 0.0417s/iter; left time: 1866.9716s
	iters: 300, epoch: 5 | loss: 0.1034778
	speed: 0.0445s/iter; left time: 1991.1939s
	iters: 400, epoch: 5 | loss: 0.0115736
	speed: 0.0477s/iter; left time: 2127.8956s
Epoch: 5 cost time: 21.147728204727173
Epoch: 5, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1455078
	speed: 0.2444s/iter; left time: 10867.1068s
	iters: 200, epoch: 6 | loss: 0.0392297
	speed: 0.0481s/iter; left time: 2131.6184s
	iters: 300, epoch: 6 | loss: 0.1325348
	speed: 0.0378s/iter; left time: 1671.7100s
	iters: 400, epoch: 6 | loss: 0.1857561
	speed: 0.0413s/iter; left time: 1822.0236s
Epoch: 6 cost time: 19.786784887313843
Epoch: 6, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0691004
	speed: 0.2661s/iter; left time: 11705.3937s
	iters: 200, epoch: 7 | loss: 0.0600081
	speed: 0.0341s/iter; left time: 1498.4644s
	iters: 300, epoch: 7 | loss: 0.3066546
	speed: 0.0387s/iter; left time: 1692.9735s
	iters: 400, epoch: 7 | loss: 0.0321517
	speed: 0.0439s/iter; left time: 1916.8553s
Epoch: 7 cost time: 19.31849980354309
Epoch: 7, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.322 Vali Acc: 0.928 Test Loss: 0.322 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0543406
	speed: 0.2553s/iter; left time: 11110.2621s
	iters: 200, epoch: 8 | loss: 0.4830095
	speed: 0.0467s/iter; left time: 2027.8811s
	iters: 300, epoch: 8 | loss: 0.3140329
	speed: 0.0439s/iter; left time: 1903.6085s
	iters: 400, epoch: 8 | loss: 0.1432897
	speed: 0.0460s/iter; left time: 1986.9795s
Epoch: 8 cost time: 21.857993841171265
Epoch: 8, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0779999
	speed: 0.2482s/iter; left time: 10685.4281s
	iters: 200, epoch: 9 | loss: 0.0956671
	speed: 0.0431s/iter; left time: 1850.7924s
	iters: 300, epoch: 9 | loss: 0.0042134
	speed: 0.0407s/iter; left time: 1743.2831s
	iters: 400, epoch: 9 | loss: 0.4344864
	speed: 0.0441s/iter; left time: 1884.2649s
Epoch: 9 cost time: 20.260488510131836
Epoch: 9, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.368 Vali Acc: 0.907 Test Loss: 0.368 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0204252
	speed: 0.2688s/iter; left time: 11445.7078s
	iters: 200, epoch: 10 | loss: 0.0721918
	speed: 0.0381s/iter; left time: 1618.0409s
	iters: 300, epoch: 10 | loss: 0.0014552
	speed: 0.0397s/iter; left time: 1680.6530s
	iters: 400, epoch: 10 | loss: 0.0425316
	speed: 0.0499s/iter; left time: 2108.7536s
Epoch: 10 cost time: 20.724907875061035
Epoch: 10, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
Validation loss decreased (-0.950541 --> -0.953972).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1889197
	speed: 0.2535s/iter; left time: 10675.8431s
	iters: 200, epoch: 11 | loss: 0.7148654
	speed: 0.0438s/iter; left time: 1839.9381s
	iters: 300, epoch: 11 | loss: 0.5511120
	speed: 0.0445s/iter; left time: 1865.5766s
	iters: 400, epoch: 11 | loss: 0.2786910
	speed: 0.0421s/iter; left time: 1761.7615s
Epoch: 11 cost time: 20.59196710586548
Epoch: 11, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1169235
	speed: 0.2740s/iter; left time: 11409.3257s
	iters: 200, epoch: 12 | loss: 0.0020521
	speed: 0.0485s/iter; left time: 2016.0294s
	iters: 300, epoch: 12 | loss: 0.0587957
	speed: 0.0489s/iter; left time: 2028.2026s
	iters: 400, epoch: 12 | loss: 0.0935803
	speed: 0.0428s/iter; left time: 1769.7222s
Epoch: 12 cost time: 22.66957378387451
Epoch: 12, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0192915
	speed: 0.2543s/iter; left time: 10468.3321s
	iters: 200, epoch: 13 | loss: 0.6164173
	speed: 0.0398s/iter; left time: 1632.6974s
	iters: 300, epoch: 13 | loss: 0.0457830
	speed: 0.0455s/iter; left time: 1863.5134s
	iters: 400, epoch: 13 | loss: 0.4049636
	speed: 0.0380s/iter; left time: 1554.2082s
Epoch: 13 cost time: 19.42463994026184
Epoch: 13, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.263 Vali Acc: 0.934 Test Loss: 0.263 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1314239
	speed: 0.2194s/iter; left time: 8930.6836s
	iters: 200, epoch: 14 | loss: 0.1724029
	speed: 0.0387s/iter; left time: 1573.2582s
	iters: 300, epoch: 14 | loss: 0.1526554
	speed: 0.0396s/iter; left time: 1603.7222s
	iters: 400, epoch: 14 | loss: 0.0247366
	speed: 0.0431s/iter; left time: 1742.5931s
Epoch: 14 cost time: 19.622406482696533
Epoch: 14, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0141015
	speed: 0.2681s/iter; left time: 10786.7539s
	iters: 200, epoch: 15 | loss: 0.0131459
	speed: 0.0545s/iter; left time: 2187.8260s
	iters: 300, epoch: 15 | loss: 0.0892625
	speed: 0.0422s/iter; left time: 1689.7646s
	iters: 400, epoch: 15 | loss: 0.0250284
	speed: 0.0448s/iter; left time: 1790.7756s
Epoch: 15 cost time: 22.71830654144287
Epoch: 15, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.213 Vali Acc: 0.947 Test Loss: 0.213 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0098193
	speed: 0.2993s/iter; left time: 11903.8547s
	iters: 200, epoch: 16 | loss: 0.0018107
	speed: 0.0458s/iter; left time: 1816.3390s
	iters: 300, epoch: 16 | loss: 0.0155471
	speed: 0.0486s/iter; left time: 1922.5296s
	iters: 400, epoch: 16 | loss: 0.0004315
	speed: 0.0501s/iter; left time: 1977.8830s
Epoch: 16 cost time: 24.37399697303772
Epoch: 16, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.953972 --> -0.956545).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2126756
	speed: 0.3054s/iter; left time: 11999.8265s
	iters: 200, epoch: 17 | loss: 0.0372753
	speed: 0.0460s/iter; left time: 1802.9427s
	iters: 300, epoch: 17 | loss: 0.0300328
	speed: 0.0473s/iter; left time: 1849.9126s
	iters: 400, epoch: 17 | loss: 0.0177413
	speed: 0.0472s/iter; left time: 1842.1793s
Epoch: 17 cost time: 22.37453317642212
Epoch: 17, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.301 Vali Acc: 0.934 Test Loss: 0.301 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0081522
	speed: 0.2654s/iter; left time: 10305.9758s
	iters: 200, epoch: 18 | loss: 0.3234047
	speed: 0.0410s/iter; left time: 1587.4139s
	iters: 300, epoch: 18 | loss: 0.0325039
	speed: 0.0483s/iter; left time: 1863.9063s
	iters: 400, epoch: 18 | loss: 0.0779140
	speed: 0.0451s/iter; left time: 1739.5160s
Epoch: 18 cost time: 21.444295644760132
Epoch: 18, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0119824
	speed: 0.2741s/iter; left time: 10513.8380s
	iters: 200, epoch: 19 | loss: 0.0186262
	speed: 0.0449s/iter; left time: 1717.6705s
	iters: 300, epoch: 19 | loss: 0.0049708
	speed: 0.0378s/iter; left time: 1441.3578s
	iters: 400, epoch: 19 | loss: 0.2751513
	speed: 0.0471s/iter; left time: 1790.7001s
Epoch: 19 cost time: 20.492695331573486
Epoch: 19, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0489550
	speed: 0.2789s/iter; left time: 10569.1266s
	iters: 200, epoch: 20 | loss: 0.2776842
	speed: 0.0415s/iter; left time: 1568.0466s
	iters: 300, epoch: 20 | loss: 0.0296705
	speed: 0.0365s/iter; left time: 1373.8283s
	iters: 400, epoch: 20 | loss: 0.2305855
	speed: 0.0464s/iter; left time: 1744.2365s
Epoch: 20 cost time: 20.787904739379883
Epoch: 20, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.210 Vali Acc: 0.947 Test Loss: 0.210 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0600167
	speed: 0.2735s/iter; left time: 10234.6436s
	iters: 200, epoch: 21 | loss: 0.0208039
	speed: 0.0472s/iter; left time: 1763.1751s
	iters: 300, epoch: 21 | loss: 0.0128517
	speed: 0.0508s/iter; left time: 1891.1020s
	iters: 400, epoch: 21 | loss: 0.1118278
	speed: 0.0469s/iter; left time: 1739.6773s
Epoch: 21 cost time: 23.30760431289673
Epoch: 21, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0055595
	speed: 0.2631s/iter; left time: 9721.2159s
	iters: 200, epoch: 22 | loss: 0.1045079
	speed: 0.0496s/iter; left time: 1826.5797s
	iters: 300, epoch: 22 | loss: 0.0861641
	speed: 0.0519s/iter; left time: 1905.8498s
	iters: 400, epoch: 22 | loss: 0.0029046
	speed: 0.0470s/iter; left time: 1722.0616s
Epoch: 22 cost time: 23.17330288887024
Epoch: 22, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.240 Vali Acc: 0.945 Test Loss: 0.240 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1710673
	speed: 0.2467s/iter; left time: 9001.2796s
	iters: 200, epoch: 23 | loss: 0.0353930
	speed: 0.0378s/iter; left time: 1374.8690s
	iters: 300, epoch: 23 | loss: 0.3157208
	speed: 0.0375s/iter; left time: 1361.6464s
	iters: 400, epoch: 23 | loss: 0.0052113
	speed: 0.0362s/iter; left time: 1311.2085s
Epoch: 23 cost time: 18.076282501220703
Epoch: 23, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0006820
	speed: 0.2466s/iter; left time: 8882.5734s
	iters: 200, epoch: 24 | loss: 0.0016518
	speed: 0.0468s/iter; left time: 1680.7346s
	iters: 300, epoch: 24 | loss: 0.0277164
	speed: 0.0419s/iter; left time: 1502.0884s
	iters: 400, epoch: 24 | loss: 0.0356241
	speed: 0.0395s/iter; left time: 1410.3874s
Epoch: 24 cost time: 21.15636420249939
Epoch: 24, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1151201
	speed: 0.2827s/iter; left time: 10048.5854s
	iters: 200, epoch: 25 | loss: 0.0247162
	speed: 0.0449s/iter; left time: 1590.7286s
	iters: 300, epoch: 25 | loss: 0.1601027
	speed: 0.0481s/iter; left time: 1699.4464s
	iters: 400, epoch: 25 | loss: 0.0703241
	speed: 0.0439s/iter; left time: 1548.5227s
Epoch: 25 cost time: 22.692082405090332
Epoch: 25, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2207174
	speed: 0.2557s/iter; left time: 8967.6507s
	iters: 200, epoch: 26 | loss: 0.4726989
	speed: 0.0415s/iter; left time: 1450.1779s
	iters: 300, epoch: 26 | loss: 0.1649624
	speed: 0.0457s/iter; left time: 1593.3362s
	iters: 400, epoch: 26 | loss: 0.0004471
	speed: 0.0465s/iter; left time: 1618.7728s
Epoch: 26 cost time: 20.95933175086975
Epoch: 26, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.956545 --> -0.958260).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0217265
	speed: 0.2593s/iter; left time: 8972.5765s
	iters: 200, epoch: 27 | loss: 0.0010190
	speed: 0.0539s/iter; left time: 1861.2411s
	iters: 300, epoch: 27 | loss: 0.0067655
	speed: 0.0450s/iter; left time: 1548.7248s
	iters: 400, epoch: 27 | loss: 0.2107007
	speed: 0.0471s/iter; left time: 1614.1451s
Epoch: 27 cost time: 23.62396764755249
Epoch: 27, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
Validation loss decreased (-0.958260 --> -0.964835).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.2946015
	speed: 0.2949s/iter; left time: 10067.1543s
	iters: 200, epoch: 28 | loss: 0.0046359
	speed: 0.0454s/iter; left time: 1545.1619s
	iters: 300, epoch: 28 | loss: 0.0350130
	speed: 0.0423s/iter; left time: 1436.6393s
	iters: 400, epoch: 28 | loss: 0.0028739
	speed: 0.0471s/iter; left time: 1592.3574s
Epoch: 28 cost time: 23.31286644935608
Epoch: 28, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0099108
	speed: 0.2790s/iter; left time: 9393.2556s
	iters: 200, epoch: 29 | loss: 0.0050530
	speed: 0.0486s/iter; left time: 1630.4772s
	iters: 300, epoch: 29 | loss: 0.0036840
	speed: 0.0496s/iter; left time: 1659.5705s
	iters: 400, epoch: 29 | loss: 0.0135309
	speed: 0.0421s/iter; left time: 1403.4450s
Epoch: 29 cost time: 22.637290239334106
Epoch: 29, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0294099
	speed: 0.2791s/iter; left time: 9266.2538s
	iters: 200, epoch: 30 | loss: 0.0088763
	speed: 0.0492s/iter; left time: 1629.4779s
	iters: 300, epoch: 30 | loss: 0.3057959
	speed: 0.0421s/iter; left time: 1390.3256s
	iters: 400, epoch: 30 | loss: 0.0053275
	speed: 0.0452s/iter; left time: 1486.3462s
Epoch: 30 cost time: 22.036847352981567
Epoch: 30, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.252 Vali Acc: 0.943 Test Loss: 0.252 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.1184200
	speed: 0.2864s/iter; left time: 9374.4993s
	iters: 200, epoch: 31 | loss: 0.0056182
	speed: 0.0483s/iter; left time: 1576.4820s
	iters: 300, epoch: 31 | loss: 0.0065014
	speed: 0.0425s/iter; left time: 1383.8465s
	iters: 400, epoch: 31 | loss: 0.1814370
	speed: 0.0475s/iter; left time: 1540.2359s
Epoch: 31 cost time: 23.229562282562256
Epoch: 31, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0108034
	speed: 0.2762s/iter; left time: 8909.4951s
	iters: 200, epoch: 32 | loss: 0.0825597
	speed: 0.0440s/iter; left time: 1413.5467s
	iters: 300, epoch: 32 | loss: 0.0618121
	speed: 0.0431s/iter; left time: 1383.0638s
	iters: 400, epoch: 32 | loss: 0.0399806
	speed: 0.0480s/iter; left time: 1534.9206s
Epoch: 32 cost time: 22.120176076889038
Epoch: 32, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0108149
	speed: 0.2818s/iter; left time: 8958.6371s
	iters: 200, epoch: 33 | loss: 0.0017903
	speed: 0.0510s/iter; left time: 1616.7685s
	iters: 300, epoch: 33 | loss: 0.0335349
	speed: 0.0536s/iter; left time: 1693.0452s
	iters: 400, epoch: 33 | loss: 0.0014426
	speed: 0.0455s/iter; left time: 1433.0609s
Epoch: 33 cost time: 23.26863408088684
Epoch: 33, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0733930
	speed: 0.2711s/iter; left time: 8492.6788s
	iters: 200, epoch: 34 | loss: 0.0011892
	speed: 0.0462s/iter; left time: 1443.1985s
	iters: 300, epoch: 34 | loss: 0.0389574
	speed: 0.0524s/iter; left time: 1631.6785s
	iters: 400, epoch: 34 | loss: 0.3601055
	speed: 0.0453s/iter; left time: 1404.1566s
Epoch: 34 cost time: 23.026285886764526
Epoch: 34, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0078336
	speed: 0.2900s/iter; left time: 8946.8764s
	iters: 200, epoch: 35 | loss: 0.2714058
	speed: 0.0482s/iter; left time: 1481.8852s
	iters: 300, epoch: 35 | loss: 0.0078756
	speed: 0.0543s/iter; left time: 1664.0221s
	iters: 400, epoch: 35 | loss: 0.2514327
	speed: 0.0562s/iter; left time: 1717.0359s
Epoch: 35 cost time: 24.9807767868042
Epoch: 35, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
Validation loss decreased (-0.964835 --> -0.966265).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.4852410
	speed: 0.3096s/iter; left time: 9408.2287s
	iters: 200, epoch: 36 | loss: 0.0065563
	speed: 0.0603s/iter; left time: 1826.7055s
	iters: 300, epoch: 36 | loss: 0.0022495
	speed: 0.0538s/iter; left time: 1625.1256s
	iters: 400, epoch: 36 | loss: 0.0402177
	speed: 0.0450s/iter; left time: 1353.4900s
Epoch: 36 cost time: 26.067147731781006
Epoch: 36, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0200596
	speed: 0.3032s/iter; left time: 9072.3253s
	iters: 200, epoch: 37 | loss: 0.0125019
	speed: 0.0519s/iter; left time: 1547.3267s
	iters: 300, epoch: 37 | loss: 0.0171519
	speed: 0.0491s/iter; left time: 1459.6963s
	iters: 400, epoch: 37 | loss: 0.0016437
	speed: 0.0390s/iter; left time: 1154.2196s
Epoch: 37 cost time: 23.431719303131104
Epoch: 37, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0386859
	speed: 0.2979s/iter; left time: 8773.6564s
	iters: 200, epoch: 38 | loss: 0.0029930
	speed: 0.0569s/iter; left time: 1668.9762s
	iters: 300, epoch: 38 | loss: 0.0588848
	speed: 0.0401s/iter; left time: 1171.5789s
	iters: 400, epoch: 38 | loss: 0.0736497
	speed: 0.0489s/iter; left time: 1424.9643s
Epoch: 38 cost time: 24.580180644989014
Epoch: 38, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.1740198
	speed: 0.3001s/iter; left time: 8697.6510s
	iters: 200, epoch: 39 | loss: 0.0401301
	speed: 0.0556s/iter; left time: 1606.7219s
	iters: 300, epoch: 39 | loss: 0.0384965
	speed: 0.0481s/iter; left time: 1382.9292s
	iters: 400, epoch: 39 | loss: 0.0030938
	speed: 0.0496s/iter; left time: 1423.2859s
Epoch: 39 cost time: 25.033679246902466
Epoch: 39, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.3442283
	speed: 0.3249s/iter; left time: 9263.7820s
	iters: 200, epoch: 40 | loss: 0.2728285
	speed: 0.0469s/iter; left time: 1332.1160s
	iters: 300, epoch: 40 | loss: 0.0119451
	speed: 0.0488s/iter; left time: 1382.5983s
	iters: 400, epoch: 40 | loss: 0.0004732
	speed: 0.0500s/iter; left time: 1411.6859s
Epoch: 40 cost time: 23.64959716796875
Epoch: 40, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.967123).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0099536
	speed: 0.2880s/iter; left time: 8076.5476s
	iters: 200, epoch: 41 | loss: 0.0241954
	speed: 0.0430s/iter; left time: 1200.3720s
	iters: 300, epoch: 41 | loss: 0.3069525
	speed: 0.0442s/iter; left time: 1231.8486s
	iters: 400, epoch: 41 | loss: 0.0052583
	speed: 0.0467s/iter; left time: 1296.5175s
Epoch: 41 cost time: 21.914197206497192
Epoch: 41, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0043011
	speed: 0.3011s/iter; left time: 8300.7362s
	iters: 200, epoch: 42 | loss: 0.0190473
	speed: 0.0460s/iter; left time: 1263.6272s
	iters: 300, epoch: 42 | loss: 0.0023049
	speed: 0.0456s/iter; left time: 1249.4081s
	iters: 400, epoch: 42 | loss: 0.1288256
	speed: 0.0535s/iter; left time: 1459.9487s
Epoch: 42 cost time: 24.168835878372192
Epoch: 42, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0144452
	speed: 0.3160s/iter; left time: 8565.1790s
	iters: 200, epoch: 43 | loss: 0.0015093
	speed: 0.0471s/iter; left time: 1270.6813s
	iters: 300, epoch: 43 | loss: 0.3024600
	speed: 0.0442s/iter; left time: 1190.2733s
	iters: 400, epoch: 43 | loss: 0.0013569
	speed: 0.0441s/iter; left time: 1182.9978s
Epoch: 43 cost time: 24.103890419006348
Epoch: 43, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.209 Vali Acc: 0.961 Test Loss: 0.209 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0867292
	speed: 0.2832s/iter; left time: 7541.7674s
	iters: 200, epoch: 44 | loss: 0.0043985
	speed: 0.0471s/iter; left time: 1249.4812s
	iters: 300, epoch: 44 | loss: 0.0106890
	speed: 0.0406s/iter; left time: 1073.8952s
	iters: 400, epoch: 44 | loss: 0.0057633
	speed: 0.0461s/iter; left time: 1214.3709s
Epoch: 44 cost time: 22.31697654724121
Epoch: 44, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0046156
	speed: 0.2747s/iter; left time: 7188.7574s
	iters: 200, epoch: 45 | loss: 0.0023110
	speed: 0.0464s/iter; left time: 1208.5568s
	iters: 300, epoch: 45 | loss: 0.0474797
	speed: 0.0509s/iter; left time: 1322.1963s
	iters: 400, epoch: 45 | loss: 0.0022555
	speed: 0.0443s/iter; left time: 1145.7957s
Epoch: 45 cost time: 23.050825357437134
Epoch: 45, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0512554
	speed: 0.2799s/iter; left time: 7193.5629s
	iters: 200, epoch: 46 | loss: 0.0011640
	speed: 0.0504s/iter; left time: 1291.1559s
	iters: 300, epoch: 46 | loss: 0.0040599
	speed: 0.0590s/iter; left time: 1504.7663s
	iters: 400, epoch: 46 | loss: 0.0126932
	speed: 0.0543s/iter; left time: 1378.8377s
Epoch: 46 cost time: 26.00319194793701
Epoch: 46, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0018788
	speed: 0.2894s/iter; left time: 7300.3663s
	iters: 200, epoch: 47 | loss: 0.0948115
	speed: 0.0452s/iter; left time: 1134.5481s
	iters: 300, epoch: 47 | loss: 0.2374966
	speed: 0.0528s/iter; left time: 1321.3783s
	iters: 400, epoch: 47 | loss: 0.0110265
	speed: 0.0526s/iter; left time: 1311.7382s
Epoch: 47 cost time: 23.638482570648193
Epoch: 47, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0067805
	speed: 0.2670s/iter; left time: 6611.2771s
	iters: 200, epoch: 48 | loss: 0.0050569
	speed: 0.0516s/iter; left time: 1272.4712s
	iters: 300, epoch: 48 | loss: 0.0008792
	speed: 0.0529s/iter; left time: 1298.1830s
	iters: 400, epoch: 48 | loss: 0.0136269
	speed: 0.0532s/iter; left time: 1302.1128s
Epoch: 48 cost time: 25.247114658355713
Epoch: 48, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0091708
	speed: 0.2886s/iter; left time: 7010.9140s
	iters: 200, epoch: 49 | loss: 0.0183103
	speed: 0.0596s/iter; left time: 1442.2995s
	iters: 300, epoch: 49 | loss: 0.0304444
	speed: 0.0568s/iter; left time: 1369.2396s
	iters: 400, epoch: 49 | loss: 0.0423142
	speed: 0.0610s/iter; left time: 1463.4296s
Epoch: 49 cost time: 26.242234468460083
Epoch: 49, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.1993160
	speed: 0.2963s/iter; left time: 7057.8669s
	iters: 200, epoch: 50 | loss: 0.0132218
	speed: 0.0531s/iter; left time: 1258.9939s
	iters: 300, epoch: 50 | loss: 0.0078753
	speed: 0.0503s/iter; left time: 1188.0705s
	iters: 400, epoch: 50 | loss: 0.5692328
	speed: 0.0493s/iter; left time: 1158.8916s
Epoch: 50 cost time: 23.840967893600464
Epoch: 50, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9671240708976558
model parameter : 3381154
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6813786
	speed: 0.0673s/iter; left time: 3148.8232s
	iters: 200, epoch: 1 | loss: 0.3222620
	speed: 0.0503s/iter; left time: 2350.6052s
	iters: 300, epoch: 1 | loss: 0.2885275
	speed: 0.0491s/iter; left time: 2286.8968s
	iters: 400, epoch: 1 | loss: 0.1674103
	speed: 0.0518s/iter; left time: 2408.5614s
Epoch: 1 cost time: 25.029674530029297
Epoch: 1, Steps: 469 | Train Loss: 0.560 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
Validation loss decreased (inf --> -0.883358).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2746783
	speed: 0.2626s/iter; left time: 12164.7068s
	iters: 200, epoch: 2 | loss: 0.1893599
	speed: 0.0416s/iter; left time: 1922.1805s
	iters: 300, epoch: 2 | loss: 0.2150497
	speed: 0.0503s/iter; left time: 2318.6306s
	iters: 400, epoch: 2 | loss: 0.2920152
	speed: 0.0427s/iter; left time: 1963.4847s
Epoch: 2 cost time: 21.999903440475464
Epoch: 2, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
Validation loss decreased (-0.883358 --> -0.914806).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0246431
	speed: 0.2849s/iter; left time: 13065.2890s
	iters: 200, epoch: 3 | loss: 0.1706692
	speed: 0.0423s/iter; left time: 1937.1740s
	iters: 300, epoch: 3 | loss: 0.0159718
	speed: 0.0486s/iter; left time: 2220.5406s
	iters: 400, epoch: 3 | loss: 0.0326462
	speed: 0.0623s/iter; left time: 2840.8230s
Epoch: 3 cost time: 24.177324056625366
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.914806 --> -0.943966).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0076188
	speed: 0.3076s/iter; left time: 13962.2016s
	iters: 200, epoch: 4 | loss: 0.1039736
	speed: 0.0470s/iter; left time: 2127.2101s
	iters: 300, epoch: 4 | loss: 0.0612298
	speed: 0.0455s/iter; left time: 2054.5647s
	iters: 400, epoch: 4 | loss: 0.1865524
	speed: 0.0446s/iter; left time: 2010.9473s
Epoch: 4 cost time: 22.33537006378174
Epoch: 4, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0313961
	speed: 0.2908s/iter; left time: 13062.3935s
	iters: 200, epoch: 5 | loss: 0.0095855
	speed: 0.0522s/iter; left time: 2339.1422s
	iters: 300, epoch: 5 | loss: 0.1353285
	speed: 0.0522s/iter; left time: 2336.2599s
	iters: 400, epoch: 5 | loss: 0.0510426
	speed: 0.0443s/iter; left time: 1975.9022s
Epoch: 5 cost time: 23.498013019561768
Epoch: 5, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.943966 --> -0.946253).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0708131
	speed: 0.2995s/iter; left time: 13314.2080s
	iters: 200, epoch: 6 | loss: 0.0562270
	speed: 0.0480s/iter; left time: 2130.4062s
	iters: 300, epoch: 6 | loss: 0.0167617
	speed: 0.0574s/iter; left time: 2539.1700s
	iters: 400, epoch: 6 | loss: 0.0109780
	speed: 0.0462s/iter; left time: 2041.4663s
Epoch: 6 cost time: 23.97229814529419
Epoch: 6, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.946253 --> -0.958546).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4403148
	speed: 0.3112s/iter; left time: 13689.4201s
	iters: 200, epoch: 7 | loss: 0.0154153
	speed: 0.0439s/iter; left time: 1928.3064s
	iters: 300, epoch: 7 | loss: 0.0661461
	speed: 0.0405s/iter; left time: 1771.7798s
	iters: 400, epoch: 7 | loss: 0.1052915
	speed: 0.0458s/iter; left time: 2001.9618s
Epoch: 7 cost time: 21.87924838066101
Epoch: 7, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0101050
	speed: 0.3110s/iter; left time: 13533.2653s
	iters: 200, epoch: 8 | loss: 0.1383478
	speed: 0.0521s/iter; left time: 2263.6129s
	iters: 300, epoch: 8 | loss: 0.1364303
	speed: 0.0503s/iter; left time: 2177.3572s
	iters: 400, epoch: 8 | loss: 0.2729065
	speed: 0.0473s/iter; left time: 2042.2187s
Epoch: 8 cost time: 23.669072151184082
Epoch: 8, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0464171
	speed: 0.3167s/iter; left time: 13632.8675s
	iters: 200, epoch: 9 | loss: 0.0414733
	speed: 0.0488s/iter; left time: 2094.6915s
	iters: 300, epoch: 9 | loss: 0.1762066
	speed: 0.0505s/iter; left time: 2161.9631s
	iters: 400, epoch: 9 | loss: 0.2860040
	speed: 0.0568s/iter; left time: 2429.0415s
Epoch: 9 cost time: 26.719732761383057
Epoch: 9, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2346075
	speed: 0.3263s/iter; left time: 13892.6523s
	iters: 200, epoch: 10 | loss: 0.1295184
	speed: 0.0444s/iter; left time: 1885.3371s
	iters: 300, epoch: 10 | loss: 0.0046739
	speed: 0.0453s/iter; left time: 1919.5458s
	iters: 400, epoch: 10 | loss: 0.0040512
	speed: 0.0472s/iter; left time: 1996.8230s
Epoch: 10 cost time: 22.596118450164795
Epoch: 10, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
Validation loss decreased (-0.958546 --> -0.961690).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0195048
	speed: 0.3153s/iter; left time: 13279.2711s
	iters: 200, epoch: 11 | loss: 0.1730879
	speed: 0.0525s/iter; left time: 2207.4600s
	iters: 300, epoch: 11 | loss: 0.0098166
	speed: 0.0506s/iter; left time: 2118.8736s
	iters: 400, epoch: 11 | loss: 0.0908453
	speed: 0.0522s/iter; left time: 2182.7316s
Epoch: 11 cost time: 26.89646887779236
Epoch: 11, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.246 Vali Acc: 0.945 Test Loss: 0.246 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0472281
	speed: 0.3418s/iter; left time: 14233.2211s
	iters: 200, epoch: 12 | loss: 0.0055577
	speed: 0.0410s/iter; left time: 1703.9857s
	iters: 300, epoch: 12 | loss: 0.8898109
	speed: 0.0509s/iter; left time: 2109.0609s
	iters: 400, epoch: 12 | loss: 0.0787219
	speed: 0.0606s/iter; left time: 2506.2751s
Epoch: 12 cost time: 25.57071590423584
Epoch: 12, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.268 Vali Acc: 0.940 Test Loss: 0.268 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0154587
	speed: 0.3109s/iter; left time: 12799.7340s
	iters: 200, epoch: 13 | loss: 0.0344469
	speed: 0.0448s/iter; left time: 1840.9451s
	iters: 300, epoch: 13 | loss: 0.0031427
	speed: 0.0458s/iter; left time: 1878.5934s
	iters: 400, epoch: 13 | loss: 0.0017683
	speed: 0.0461s/iter; left time: 1883.4646s
Epoch: 13 cost time: 22.803004026412964
Epoch: 13, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0231313
	speed: 0.2825s/iter; left time: 11498.4122s
	iters: 200, epoch: 14 | loss: 0.0046684
	speed: 0.0416s/iter; left time: 1689.6519s
	iters: 300, epoch: 14 | loss: 0.0087435
	speed: 0.0397s/iter; left time: 1606.4393s
	iters: 400, epoch: 14 | loss: 0.0678833
	speed: 0.0477s/iter; left time: 1925.7866s
Epoch: 14 cost time: 21.245075702667236
Epoch: 14, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0463216
	speed: 0.3153s/iter; left time: 12687.9582s
	iters: 200, epoch: 15 | loss: 0.0579582
	speed: 0.0427s/iter; left time: 1712.7393s
	iters: 300, epoch: 15 | loss: 0.2115597
	speed: 0.0455s/iter; left time: 1821.6047s
	iters: 400, epoch: 15 | loss: 0.0050066
	speed: 0.0540s/iter; left time: 2156.2820s
Epoch: 15 cost time: 22.449339151382446
Epoch: 15, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.231 Vali Acc: 0.945 Test Loss: 0.231 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0658145
	speed: 0.2912s/iter; left time: 11581.7565s
	iters: 200, epoch: 16 | loss: 0.0404834
	speed: 0.0449s/iter; left time: 1782.1676s
	iters: 300, epoch: 16 | loss: 0.0236727
	speed: 0.0532s/iter; left time: 2103.6568s
	iters: 400, epoch: 16 | loss: 0.0064847
	speed: 0.0518s/iter; left time: 2042.6257s
Epoch: 16 cost time: 22.76747179031372
Epoch: 16, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0116047
	speed: 0.2781s/iter; left time: 10929.0786s
	iters: 200, epoch: 17 | loss: 0.0719467
	speed: 0.0474s/iter; left time: 1857.3721s
	iters: 300, epoch: 17 | loss: 0.0858903
	speed: 0.0503s/iter; left time: 1966.8717s
	iters: 400, epoch: 17 | loss: 0.2486541
	speed: 0.0488s/iter; left time: 1903.0502s
Epoch: 17 cost time: 23.49404811859131
Epoch: 17, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.285 Vali Acc: 0.938 Test Loss: 0.285 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3661543
	speed: 0.3073s/iter; left time: 11932.1112s
	iters: 200, epoch: 18 | loss: 0.3583686
	speed: 0.0508s/iter; left time: 1967.2988s
	iters: 300, epoch: 18 | loss: 0.0873245
	speed: 0.0473s/iter; left time: 1826.0807s
	iters: 400, epoch: 18 | loss: 0.0063407
	speed: 0.0529s/iter; left time: 2039.3861s
Epoch: 18 cost time: 24.512431383132935
Epoch: 18, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.961690 --> -0.964836).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0049476
	speed: 0.3142s/iter; left time: 12054.1458s
	iters: 200, epoch: 19 | loss: 0.0076079
	speed: 0.0496s/iter; left time: 1899.3781s
	iters: 300, epoch: 19 | loss: 0.5091776
	speed: 0.0479s/iter; left time: 1829.3297s
	iters: 400, epoch: 19 | loss: 0.0132965
	speed: 0.0519s/iter; left time: 1975.5732s
Epoch: 19 cost time: 23.82811975479126
Epoch: 19, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0009459
	speed: 0.2912s/iter; left time: 11032.7158s
	iters: 200, epoch: 20 | loss: 0.1131070
	speed: 0.0516s/iter; left time: 1951.6847s
	iters: 300, epoch: 20 | loss: 0.0082892
	speed: 0.0433s/iter; left time: 1632.3370s
	iters: 400, epoch: 20 | loss: 0.0200129
	speed: 0.0478s/iter; left time: 1796.6196s
Epoch: 20 cost time: 23.73064136505127
Epoch: 20, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0334825
	speed: 0.2903s/iter; left time: 10861.8291s
	iters: 200, epoch: 21 | loss: 0.0525337
	speed: 0.0485s/iter; left time: 1809.4637s
	iters: 300, epoch: 21 | loss: 0.3605846
	speed: 0.0509s/iter; left time: 1895.4758s
	iters: 400, epoch: 21 | loss: 0.1174887
	speed: 0.0573s/iter; left time: 2125.9659s
Epoch: 21 cost time: 25.033841371536255
Epoch: 21, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.3432174
	speed: 0.2866s/iter; left time: 10589.0414s
	iters: 200, epoch: 22 | loss: 0.1769448
	speed: 0.0560s/iter; left time: 2065.3899s
	iters: 300, epoch: 22 | loss: 0.0012265
	speed: 0.0492s/iter; left time: 1806.7967s
	iters: 400, epoch: 22 | loss: 0.0322336
	speed: 0.0440s/iter; left time: 1613.1719s
Epoch: 22 cost time: 23.949005365371704
Epoch: 22, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0393007
	speed: 0.3325s/iter; left time: 12129.5415s
	iters: 200, epoch: 23 | loss: 0.6949167
	speed: 0.0457s/iter; left time: 1664.1111s
	iters: 300, epoch: 23 | loss: 0.2708476
	speed: 0.0548s/iter; left time: 1986.6490s
	iters: 400, epoch: 23 | loss: 0.1221141
	speed: 0.0535s/iter; left time: 1935.1728s
Epoch: 23 cost time: 24.211082935333252
Epoch: 23, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0142095
	speed: 0.3132s/iter; left time: 11280.6698s
	iters: 200, epoch: 24 | loss: 0.0008539
	speed: 0.0615s/iter; left time: 2207.1097s
	iters: 300, epoch: 24 | loss: 0.0149546
	speed: 0.0497s/iter; left time: 1780.9749s
	iters: 400, epoch: 24 | loss: 0.0183428
	speed: 0.0462s/iter; left time: 1651.3299s
Epoch: 24 cost time: 24.658218383789062
Epoch: 24, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0077805
	speed: 0.2916s/iter; left time: 10363.1846s
	iters: 200, epoch: 25 | loss: 0.0518422
	speed: 0.0449s/iter; left time: 1593.1897s
	iters: 300, epoch: 25 | loss: 0.1336063
	speed: 0.0446s/iter; left time: 1577.7265s
	iters: 400, epoch: 25 | loss: 0.1127752
	speed: 0.0476s/iter; left time: 1679.1837s
Epoch: 25 cost time: 22.864392518997192
Epoch: 25, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1839272
	speed: 0.3198s/iter; left time: 11217.5304s
	iters: 200, epoch: 26 | loss: 0.0023805
	speed: 0.0571s/iter; left time: 1997.2883s
	iters: 300, epoch: 26 | loss: 0.0518802
	speed: 0.0652s/iter; left time: 2272.6087s
	iters: 400, epoch: 26 | loss: 0.2630394
	speed: 0.0532s/iter; left time: 1850.6031s
Epoch: 26 cost time: 27.373451709747314
Epoch: 26, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.292 Vali Acc: 0.939 Test Loss: 0.292 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0216901
	speed: 0.2999s/iter; left time: 10380.1635s
	iters: 200, epoch: 27 | loss: 0.0902675
	speed: 0.0504s/iter; left time: 1739.6377s
	iters: 300, epoch: 27 | loss: 0.0219602
	speed: 0.0467s/iter; left time: 1607.0819s
	iters: 400, epoch: 27 | loss: 0.7572495
	speed: 0.0485s/iter; left time: 1665.0268s
Epoch: 27 cost time: 24.14349937438965
Epoch: 27, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0097811
	speed: 0.2718s/iter; left time: 9277.2008s
	iters: 200, epoch: 28 | loss: 0.0005897
	speed: 0.0536s/iter; left time: 1823.4691s
	iters: 300, epoch: 28 | loss: 0.0104437
	speed: 0.0500s/iter; left time: 1697.4681s
	iters: 400, epoch: 28 | loss: 0.0098282
	speed: 0.0455s/iter; left time: 1540.1232s
Epoch: 28 cost time: 23.630650520324707
Epoch: 28, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9648370497427101
model parameter : 3380898
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5954953
	speed: 0.0827s/iter; left time: 3869.8904s
	iters: 200, epoch: 1 | loss: 0.1516783
	speed: 0.0446s/iter; left time: 2081.2828s
	iters: 300, epoch: 1 | loss: 0.6546013
	speed: 0.0537s/iter; left time: 2502.0809s
	iters: 400, epoch: 1 | loss: 0.0526082
	speed: 0.0503s/iter; left time: 2339.6470s
Epoch: 1 cost time: 26.389787197113037
Epoch: 1, Steps: 469 | Train Loss: 0.560 Vali Loss: 0.249 Vali Acc: 0.920 Test Loss: 0.249 Test Acc: 0.920
Validation loss decreased (inf --> -0.919666).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5322775
	speed: 0.2913s/iter; left time: 13497.1053s
	iters: 200, epoch: 2 | loss: 0.0303827
	speed: 0.0474s/iter; left time: 2189.3171s
	iters: 300, epoch: 2 | loss: 0.0621023
	speed: 0.0539s/iter; left time: 2484.9624s
	iters: 400, epoch: 2 | loss: 0.1566695
	speed: 0.0591s/iter; left time: 2720.1475s
Epoch: 2 cost time: 25.057260274887085
Epoch: 2, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.309 Vali Acc: 0.905 Test Loss: 0.309 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1548035
	speed: 0.3270s/iter; left time: 14996.1970s
	iters: 200, epoch: 3 | loss: 0.0370090
	speed: 0.0523s/iter; left time: 2395.6474s
	iters: 300, epoch: 3 | loss: 0.0473831
	speed: 0.0562s/iter; left time: 2567.0890s
	iters: 400, epoch: 3 | loss: 0.3673658
	speed: 0.0582s/iter; left time: 2651.7136s
Epoch: 3 cost time: 26.52069616317749
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.256 Vali Acc: 0.921 Test Loss: 0.256 Test Acc: 0.921
Validation loss decreased (-0.919666 --> -0.920809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1128391
	speed: 0.3321s/iter; left time: 15075.4254s
	iters: 200, epoch: 4 | loss: 0.0435443
	speed: 0.0469s/iter; left time: 2124.2197s
	iters: 300, epoch: 4 | loss: 0.3806749
	speed: 0.0446s/iter; left time: 2015.1319s
	iters: 400, epoch: 4 | loss: 0.0312643
	speed: 0.0444s/iter; left time: 2002.8481s
Epoch: 4 cost time: 23.70599126815796
Epoch: 4, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
Validation loss decreased (-0.920809 --> -0.938534).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2181832
	speed: 0.3119s/iter; left time: 14012.6458s
	iters: 200, epoch: 5 | loss: 0.0036707
	speed: 0.0505s/iter; left time: 2263.6127s
	iters: 300, epoch: 5 | loss: 0.6210557
	speed: 0.0590s/iter; left time: 2640.2422s
	iters: 400, epoch: 5 | loss: 0.0020901
	speed: 0.0583s/iter; left time: 2602.8507s
Epoch: 5 cost time: 26.317293643951416
Epoch: 5, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6367803
	speed: 0.3048s/iter; left time: 13549.6674s
	iters: 200, epoch: 6 | loss: 0.1990771
	speed: 0.0564s/iter; left time: 2501.2733s
	iters: 300, epoch: 6 | loss: 0.0419521
	speed: 0.0489s/iter; left time: 2166.2605s
	iters: 400, epoch: 6 | loss: 0.0803956
	speed: 0.0482s/iter; left time: 2126.1861s
Epoch: 6 cost time: 24.314443588256836
Epoch: 6, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.194 Vali Acc: 0.936 Test Loss: 0.194 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1263802
	speed: 0.3082s/iter; left time: 13557.0657s
	iters: 200, epoch: 7 | loss: 0.0381430
	speed: 0.0469s/iter; left time: 2057.5806s
	iters: 300, epoch: 7 | loss: 0.0065679
	speed: 0.0473s/iter; left time: 2070.6327s
	iters: 400, epoch: 7 | loss: 0.0975411
	speed: 0.0505s/iter; left time: 2205.4984s
Epoch: 7 cost time: 24.327064275741577
Epoch: 7, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0326771
	speed: 0.2610s/iter; left time: 11359.4883s
	iters: 200, epoch: 8 | loss: 0.0664697
	speed: 0.0408s/iter; left time: 1773.0580s
	iters: 300, epoch: 8 | loss: 0.0257199
	speed: 0.0430s/iter; left time: 1863.6038s
	iters: 400, epoch: 8 | loss: 0.1742906
	speed: 0.0394s/iter; left time: 1701.6088s
Epoch: 8 cost time: 20.352213621139526
Epoch: 8, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
Validation loss decreased (-0.938534 --> -0.939392).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0592619
	speed: 0.2550s/iter; left time: 10977.5122s
	iters: 200, epoch: 9 | loss: 0.1497200
	speed: 0.0541s/iter; left time: 2321.7069s
	iters: 300, epoch: 9 | loss: 0.2868099
	speed: 0.0516s/iter; left time: 2210.9117s
	iters: 400, epoch: 9 | loss: 0.0362063
	speed: 0.0473s/iter; left time: 2023.1724s
Epoch: 9 cost time: 23.78496742248535
Epoch: 9, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.939392 --> -0.958832).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0031546
	speed: 0.2932s/iter; left time: 12486.0408s
	iters: 200, epoch: 10 | loss: 0.1246911
	speed: 0.0461s/iter; left time: 1956.8824s
	iters: 300, epoch: 10 | loss: 0.0342702
	speed: 0.0455s/iter; left time: 1927.2019s
	iters: 400, epoch: 10 | loss: 0.3075905
	speed: 0.0448s/iter; left time: 1894.6668s
Epoch: 10 cost time: 22.611876726150513
Epoch: 10, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0999587
	speed: 0.2654s/iter; left time: 11176.8064s
	iters: 200, epoch: 11 | loss: 0.2088961
	speed: 0.0467s/iter; left time: 1963.1986s
	iters: 300, epoch: 11 | loss: 0.0376392
	speed: 0.0468s/iter; left time: 1961.3782s
	iters: 400, epoch: 11 | loss: 0.0135536
	speed: 0.0399s/iter; left time: 1669.5968s
Epoch: 11 cost time: 20.741302251815796
Epoch: 11, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0777815
	speed: 0.2386s/iter; left time: 9934.0989s
	iters: 200, epoch: 12 | loss: 0.0098089
	speed: 0.0411s/iter; left time: 1707.7385s
	iters: 300, epoch: 12 | loss: 0.0793752
	speed: 0.0436s/iter; left time: 1805.4894s
	iters: 400, epoch: 12 | loss: 0.0027072
	speed: 0.0449s/iter; left time: 1857.8350s
Epoch: 12 cost time: 22.324132680892944
Epoch: 12, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0106573
	speed: 0.2672s/iter; left time: 11003.0785s
	iters: 200, epoch: 13 | loss: 0.0117793
	speed: 0.0515s/iter; left time: 2116.8900s
	iters: 300, epoch: 13 | loss: 0.0036463
	speed: 0.0489s/iter; left time: 2004.1927s
	iters: 400, epoch: 13 | loss: 0.1989879
	speed: 0.0498s/iter; left time: 2033.5506s
Epoch: 13 cost time: 23.976465463638306
Epoch: 13, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1728801
	speed: 0.2634s/iter; left time: 10721.8615s
	iters: 200, epoch: 14 | loss: 0.0180139
	speed: 0.0366s/iter; left time: 1486.0199s
	iters: 300, epoch: 14 | loss: 0.0017759
	speed: 0.0399s/iter; left time: 1614.7011s
	iters: 400, epoch: 14 | loss: 0.0798047
	speed: 0.0484s/iter; left time: 1953.5582s
Epoch: 14 cost time: 21.292343854904175
Epoch: 14, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0205949
	speed: 0.2738s/iter; left time: 11015.8625s
	iters: 200, epoch: 15 | loss: 0.2380375
	speed: 0.0454s/iter; left time: 1823.7658s
	iters: 300, epoch: 15 | loss: 0.0594181
	speed: 0.0507s/iter; left time: 2029.2445s
	iters: 400, epoch: 15 | loss: 0.0514196
	speed: 0.0496s/iter; left time: 1979.7330s
Epoch: 15 cost time: 23.005820989608765
Epoch: 15, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2641172
	speed: 0.2653s/iter; left time: 10549.7698s
	iters: 200, epoch: 16 | loss: 0.0055737
	speed: 0.0432s/iter; left time: 1712.0257s
	iters: 300, epoch: 16 | loss: 0.0174088
	speed: 0.0407s/iter; left time: 1609.8956s
	iters: 400, epoch: 16 | loss: 0.0729842
	speed: 0.0554s/iter; left time: 2186.6129s
Epoch: 16 cost time: 23.365980863571167
Epoch: 16, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0121014
	speed: 0.2987s/iter; left time: 11736.2324s
	iters: 200, epoch: 17 | loss: 0.0152909
	speed: 0.0540s/iter; left time: 2114.9497s
	iters: 300, epoch: 17 | loss: 0.0672650
	speed: 0.0506s/iter; left time: 1977.7400s
	iters: 400, epoch: 17 | loss: 0.5334841
	speed: 0.0397s/iter; left time: 1549.1369s
Epoch: 17 cost time: 23.756865739822388
Epoch: 17, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0111676
	speed: 0.2856s/iter; left time: 11090.7122s
	iters: 200, epoch: 18 | loss: 0.0320446
	speed: 0.0459s/iter; left time: 1776.6149s
	iters: 300, epoch: 18 | loss: 0.0040800
	speed: 0.0474s/iter; left time: 1829.4462s
	iters: 400, epoch: 18 | loss: 0.0266883
	speed: 0.0540s/iter; left time: 2081.9571s
Epoch: 18 cost time: 23.542309999465942
Epoch: 18, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0086961
	speed: 0.2990s/iter; left time: 11471.0872s
	iters: 200, epoch: 19 | loss: 0.0037998
	speed: 0.0448s/iter; left time: 1715.8895s
	iters: 300, epoch: 19 | loss: 0.0034997
	speed: 0.0465s/iter; left time: 1774.5457s
	iters: 400, epoch: 19 | loss: 0.0180225
	speed: 0.0388s/iter; left time: 1478.2140s
Epoch: 19 cost time: 21.105888843536377
Epoch: 19, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9588336192109777
model parameter : 3380642
model size : 17.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5923445
	speed: 0.0768s/iter; left time: 3595.9144s
	iters: 200, epoch: 1 | loss: 0.3181530
	speed: 0.0509s/iter; left time: 2374.9377s
	iters: 300, epoch: 1 | loss: 0.2181773
	speed: 0.0422s/iter; left time: 1965.8891s
	iters: 400, epoch: 1 | loss: 0.1515493
	speed: 0.0452s/iter; left time: 2100.4126s
Epoch: 1 cost time: 24.94665813446045
Epoch: 1, Steps: 469 | Train Loss: 0.577 Vali Loss: 0.235 Vali Acc: 0.927 Test Loss: 0.235 Test Acc: 0.927
Validation loss decreased (inf --> -0.927385).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2284408
	speed: 0.2500s/iter; left time: 11582.5444s
	iters: 200, epoch: 2 | loss: 0.1353916
	speed: 0.0474s/iter; left time: 2189.8641s
	iters: 300, epoch: 2 | loss: 0.4916911
	speed: 0.0509s/iter; left time: 2348.6463s
	iters: 400, epoch: 2 | loss: 0.0162146
	speed: 0.0513s/iter; left time: 2360.3075s
Epoch: 2 cost time: 22.659002780914307
Epoch: 2, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.927385 --> -0.958546).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0069511
	speed: 0.2543s/iter; left time: 11662.5623s
	iters: 200, epoch: 3 | loss: 0.0415327
	speed: 0.0524s/iter; left time: 2397.8965s
	iters: 300, epoch: 3 | loss: 0.2954978
	speed: 0.0516s/iter; left time: 2357.3473s
	iters: 400, epoch: 3 | loss: 0.2804374
	speed: 0.0453s/iter; left time: 2063.2125s
Epoch: 3 cost time: 23.494940996170044
Epoch: 3, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0686540
	speed: 0.3065s/iter; left time: 13912.4632s
	iters: 200, epoch: 4 | loss: 0.0902592
	speed: 0.0492s/iter; left time: 2227.5478s
	iters: 300, epoch: 4 | loss: 0.0102782
	speed: 0.0452s/iter; left time: 2040.6832s
	iters: 400, epoch: 4 | loss: 0.0124415
	speed: 0.0481s/iter; left time: 2167.3909s
Epoch: 4 cost time: 23.63704538345337
Epoch: 4, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1444316
	speed: 0.2492s/iter; left time: 11194.5596s
	iters: 200, epoch: 5 | loss: 0.0415814
	speed: 0.0460s/iter; left time: 2062.7491s
	iters: 300, epoch: 5 | loss: 0.0052540
	speed: 0.0410s/iter; left time: 1833.9302s
	iters: 400, epoch: 5 | loss: 0.1014134
	speed: 0.0445s/iter; left time: 1984.0704s
Epoch: 5 cost time: 21.370620250701904
Epoch: 5, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0132317
	speed: 0.2614s/iter; left time: 11622.2605s
	iters: 200, epoch: 6 | loss: 0.2084283
	speed: 0.0417s/iter; left time: 1848.5792s
	iters: 300, epoch: 6 | loss: 0.0734317
	speed: 0.0386s/iter; left time: 1706.6219s
	iters: 400, epoch: 6 | loss: 0.0065483
	speed: 0.0440s/iter; left time: 1943.3206s
Epoch: 6 cost time: 20.709800958633423
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0197055
	speed: 0.2807s/iter; left time: 12348.4207s
	iters: 200, epoch: 7 | loss: 0.0057125
	speed: 0.0518s/iter; left time: 2273.8928s
	iters: 300, epoch: 7 | loss: 0.5335650
	speed: 0.0476s/iter; left time: 2083.0655s
	iters: 400, epoch: 7 | loss: 0.0214448
	speed: 0.0412s/iter; left time: 1800.6598s
Epoch: 7 cost time: 22.454150199890137
Epoch: 7, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0257636
	speed: 0.2682s/iter; left time: 11672.3632s
	iters: 200, epoch: 8 | loss: 0.0303341
	speed: 0.0420s/iter; left time: 1824.4785s
	iters: 300, epoch: 8 | loss: 0.0252162
	speed: 0.0509s/iter; left time: 2203.1605s
	iters: 400, epoch: 8 | loss: 0.1560654
	speed: 0.0494s/iter; left time: 2133.8960s
Epoch: 8 cost time: 21.929667472839355
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1032299
	speed: 0.2850s/iter; left time: 12269.4633s
	iters: 200, epoch: 9 | loss: 0.0998393
	speed: 0.0475s/iter; left time: 2038.5336s
	iters: 300, epoch: 9 | loss: 0.1935615
	speed: 0.0497s/iter; left time: 2128.0947s
	iters: 400, epoch: 9 | loss: 0.0165537
	speed: 0.0541s/iter; left time: 2311.9967s
Epoch: 9 cost time: 23.327043294906616
Epoch: 9, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
Validation loss decreased (-0.958546 --> -0.965693).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0625725
	speed: 0.2474s/iter; left time: 10534.7284s
	iters: 200, epoch: 10 | loss: 0.0733824
	speed: 0.0408s/iter; left time: 1731.9035s
	iters: 300, epoch: 10 | loss: 0.0062731
	speed: 0.0396s/iter; left time: 1678.1080s
	iters: 400, epoch: 10 | loss: 0.0044366
	speed: 0.0480s/iter; left time: 2029.4236s
Epoch: 10 cost time: 21.49528217315674
Epoch: 10, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0023968
	speed: 0.3052s/iter; left time: 12851.1821s
	iters: 200, epoch: 11 | loss: 0.1603896
	speed: 0.0513s/iter; left time: 2156.4538s
	iters: 300, epoch: 11 | loss: 0.0360662
	speed: 0.0530s/iter; left time: 2220.1333s
	iters: 400, epoch: 11 | loss: 0.1687453
	speed: 0.0446s/iter; left time: 1864.1002s
Epoch: 11 cost time: 24.01776146888733
Epoch: 11, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0431450
	speed: 0.2794s/iter; left time: 11636.3474s
	iters: 200, epoch: 12 | loss: 0.1050320
	speed: 0.0473s/iter; left time: 1963.9267s
	iters: 300, epoch: 12 | loss: 0.0021168
	speed: 0.0419s/iter; left time: 1735.6098s
	iters: 400, epoch: 12 | loss: 0.0972701
	speed: 0.0410s/iter; left time: 1695.9542s
Epoch: 12 cost time: 21.942626476287842
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.243 Vali Acc: 0.952 Test Loss: 0.243 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1036841
	speed: 0.2589s/iter; left time: 10661.2079s
	iters: 200, epoch: 13 | loss: 0.3715937
	speed: 0.0369s/iter; left time: 1516.5336s
	iters: 300, epoch: 13 | loss: 0.0412135
	speed: 0.0404s/iter; left time: 1653.8610s
	iters: 400, epoch: 13 | loss: 0.0285744
	speed: 0.0402s/iter; left time: 1641.7532s
Epoch: 13 cost time: 19.78549098968506
Epoch: 13, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.231 Vali Acc: 0.945 Test Loss: 0.231 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0007149
	speed: 0.2551s/iter; left time: 10381.9591s
	iters: 200, epoch: 14 | loss: 0.0095310
	speed: 0.0502s/iter; left time: 2039.9040s
	iters: 300, epoch: 14 | loss: 0.0275580
	speed: 0.0488s/iter; left time: 1976.5036s
	iters: 400, epoch: 14 | loss: 0.0069730
	speed: 0.0399s/iter; left time: 1610.8700s
Epoch: 14 cost time: 21.996407985687256
Epoch: 14, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.295 Vali Acc: 0.936 Test Loss: 0.295 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0315962
	speed: 0.2568s/iter; left time: 10331.0262s
	iters: 200, epoch: 15 | loss: 0.1016475
	speed: 0.0433s/iter; left time: 1739.7683s
	iters: 300, epoch: 15 | loss: 0.1151886
	speed: 0.0468s/iter; left time: 1873.1628s
	iters: 400, epoch: 15 | loss: 0.0006884
	speed: 0.0535s/iter; left time: 2138.3179s
Epoch: 15 cost time: 22.5561683177948
Epoch: 15, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0477391
	speed: 0.2840s/iter; left time: 11294.2758s
	iters: 200, epoch: 16 | loss: 0.0566255
	speed: 0.0461s/iter; left time: 1830.0964s
	iters: 300, epoch: 16 | loss: 0.0065899
	speed: 0.0479s/iter; left time: 1896.0537s
	iters: 400, epoch: 16 | loss: 0.0018984
	speed: 0.0398s/iter; left time: 1572.3144s
Epoch: 16 cost time: 21.815651416778564
Epoch: 16, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0014719
	speed: 0.2674s/iter; left time: 10506.6656s
	iters: 200, epoch: 17 | loss: 0.0458413
	speed: 0.0358s/iter; left time: 1401.4723s
	iters: 300, epoch: 17 | loss: 0.0002096
	speed: 0.0347s/iter; left time: 1358.3314s
	iters: 400, epoch: 17 | loss: 0.0041575
	speed: 0.0351s/iter; left time: 1368.9875s
Epoch: 17 cost time: 18.487879753112793
Epoch: 17, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2177775
	speed: 0.2740s/iter; left time: 10638.2536s
	iters: 200, epoch: 18 | loss: 0.0983024
	speed: 0.0442s/iter; left time: 1712.4584s
	iters: 300, epoch: 18 | loss: 0.1232557
	speed: 0.0564s/iter; left time: 2177.1508s
	iters: 400, epoch: 18 | loss: 0.0005376
	speed: 0.0523s/iter; left time: 2014.6043s
Epoch: 18 cost time: 25.112632751464844
Epoch: 18, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0972136
	speed: 0.2780s/iter; left time: 10665.4504s
	iters: 200, epoch: 19 | loss: 0.0015944
	speed: 0.0458s/iter; left time: 1751.3018s
	iters: 300, epoch: 19 | loss: 0.0420973
	speed: 0.0453s/iter; left time: 1729.2951s
	iters: 400, epoch: 19 | loss: 0.0154822
	speed: 0.0498s/iter; left time: 1895.7137s
Epoch: 19 cost time: 23.016624212265015
Epoch: 19, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.969410).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0038042
	speed: 0.2946s/iter; left time: 11162.2805s
	iters: 200, epoch: 20 | loss: 0.0008465
	speed: 0.0435s/iter; left time: 1642.7357s
	iters: 300, epoch: 20 | loss: 0.1207243
	speed: 0.0344s/iter; left time: 1296.0352s
	iters: 400, epoch: 20 | loss: 0.0291929
	speed: 0.0379s/iter; left time: 1423.8435s
Epoch: 20 cost time: 19.853745460510254
Epoch: 20, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0016249
	speed: 0.2592s/iter; left time: 9698.0434s
	iters: 200, epoch: 21 | loss: 0.0632984
	speed: 0.0402s/iter; left time: 1501.6041s
	iters: 300, epoch: 21 | loss: 0.0020173
	speed: 0.0408s/iter; left time: 1516.8986s
	iters: 400, epoch: 21 | loss: 0.2483922
	speed: 0.0474s/iter; left time: 1760.8985s
Epoch: 21 cost time: 20.844797372817993
Epoch: 21, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0708826
	speed: 0.2447s/iter; left time: 9043.6318s
	iters: 200, epoch: 22 | loss: 1.1048764
	speed: 0.0373s/iter; left time: 1374.5524s
	iters: 300, epoch: 22 | loss: 0.1431662
	speed: 0.0425s/iter; left time: 1561.1353s
	iters: 400, epoch: 22 | loss: 0.0705361
	speed: 0.0473s/iter; left time: 1732.5638s
Epoch: 22 cost time: 20.39024543762207
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0060339
	speed: 0.2268s/iter; left time: 8275.6112s
	iters: 200, epoch: 23 | loss: 0.0009320
	speed: 0.0387s/iter; left time: 1407.2298s
	iters: 300, epoch: 23 | loss: 0.0036461
	speed: 0.0412s/iter; left time: 1493.0612s
	iters: 400, epoch: 23 | loss: 0.0007244
	speed: 0.0456s/iter; left time: 1649.8086s
Epoch: 23 cost time: 20.19115686416626
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0607049
	speed: 0.2799s/iter; left time: 10081.9444s
	iters: 200, epoch: 24 | loss: 0.0031095
	speed: 0.0485s/iter; left time: 1740.6139s
	iters: 300, epoch: 24 | loss: 0.1377885
	speed: 0.0456s/iter; left time: 1632.2151s
	iters: 400, epoch: 24 | loss: 0.0032300
	speed: 0.0461s/iter; left time: 1647.5311s
Epoch: 24 cost time: 22.782187938690186
Epoch: 24, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0013421
	speed: 0.2711s/iter; left time: 9637.3426s
	iters: 200, epoch: 25 | loss: 0.0047693
	speed: 0.0442s/iter; left time: 1565.9579s
	iters: 300, epoch: 25 | loss: 0.0006163
	speed: 0.0434s/iter; left time: 1535.7197s
	iters: 400, epoch: 25 | loss: 0.2236552
	speed: 0.0485s/iter; left time: 1708.5153s
Epoch: 25 cost time: 21.901559114456177
Epoch: 25, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0424132
	speed: 0.2540s/iter; left time: 8908.6382s
	iters: 200, epoch: 26 | loss: 0.0113551
	speed: 0.0456s/iter; left time: 1595.7265s
	iters: 300, epoch: 26 | loss: 0.0072335
	speed: 0.0424s/iter; left time: 1478.7757s
	iters: 400, epoch: 26 | loss: 0.0029167
	speed: 0.0401s/iter; left time: 1395.5014s
Epoch: 26 cost time: 21.305552005767822
Epoch: 26, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0027176
	speed: 0.2633s/iter; left time: 9111.4801s
	iters: 200, epoch: 27 | loss: 0.2570890
	speed: 0.0439s/iter; left time: 1515.5249s
	iters: 300, epoch: 27 | loss: 0.0017328
	speed: 0.0468s/iter; left time: 1610.3489s
	iters: 400, epoch: 27 | loss: 0.0494118
	speed: 0.0412s/iter; left time: 1411.9825s
Epoch: 27 cost time: 21.240078687667847
Epoch: 27, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0202491
	speed: 0.2383s/iter; left time: 8136.1672s
	iters: 200, epoch: 28 | loss: 0.1746828
	speed: 0.0322s/iter; left time: 1096.7768s
	iters: 300, epoch: 28 | loss: 0.0639650
	speed: 0.0418s/iter; left time: 1419.1992s
	iters: 400, epoch: 28 | loss: 0.0051684
	speed: 0.0385s/iter; left time: 1302.1664s
Epoch: 28 cost time: 18.34087085723877
Epoch: 28, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0040883
	speed: 0.2717s/iter; left time: 9146.4732s
	iters: 200, epoch: 29 | loss: 0.2070443
	speed: 0.0439s/iter; left time: 1473.5435s
	iters: 300, epoch: 29 | loss: 0.0002531
	speed: 0.0490s/iter; left time: 1639.1314s
	iters: 400, epoch: 29 | loss: 0.0107808
	speed: 0.0527s/iter; left time: 1759.8530s
Epoch: 29 cost time: 22.563753843307495
Epoch: 29, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9694110920526015
model parameter : 3380386
model size : 17.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6943848
	speed: 0.0692s/iter; left time: 3236.5274s
	iters: 200, epoch: 1 | loss: 0.4446597
	speed: 0.0413s/iter; left time: 1929.4666s
	iters: 300, epoch: 1 | loss: 0.1638539
	speed: 0.0468s/iter; left time: 2179.1595s
	iters: 400, epoch: 1 | loss: 0.3592277
	speed: 0.0463s/iter; left time: 2154.9749s
Epoch: 1 cost time: 23.548649549484253
Epoch: 1, Steps: 469 | Train Loss: 0.568 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (inf --> -0.930529).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0519732
	speed: 0.3010s/iter; left time: 13946.9440s
	iters: 200, epoch: 2 | loss: 0.0868236
	speed: 0.0513s/iter; left time: 2373.8378s
	iters: 300, epoch: 2 | loss: 0.0391538
	speed: 0.0560s/iter; left time: 2585.6402s
	iters: 400, epoch: 2 | loss: 0.1070909
	speed: 0.0485s/iter; left time: 2233.1241s
Epoch: 2 cost time: 25.12632465362549
Epoch: 2, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0342677
	speed: 0.2668s/iter; left time: 12234.4278s
	iters: 200, epoch: 3 | loss: 0.0154575
	speed: 0.0432s/iter; left time: 1977.3653s
	iters: 300, epoch: 3 | loss: 0.0211313
	speed: 0.0389s/iter; left time: 1774.0618s
	iters: 400, epoch: 3 | loss: 0.1951236
	speed: 0.0434s/iter; left time: 1975.6533s
Epoch: 3 cost time: 19.878161191940308
Epoch: 3, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0197130
	speed: 0.2456s/iter; left time: 11147.5387s
	iters: 200, epoch: 4 | loss: 0.0105564
	speed: 0.0489s/iter; left time: 2214.3383s
	iters: 300, epoch: 4 | loss: 0.0251468
	speed: 0.0421s/iter; left time: 1901.7002s
	iters: 400, epoch: 4 | loss: 0.0253068
	speed: 0.0383s/iter; left time: 1725.2919s
Epoch: 4 cost time: 21.4825496673584
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.930529 --> -0.951399).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2553006
	speed: 0.2568s/iter; left time: 11535.1971s
	iters: 200, epoch: 5 | loss: 0.0062144
	speed: 0.0405s/iter; left time: 1815.2374s
	iters: 300, epoch: 5 | loss: 0.0766265
	speed: 0.0432s/iter; left time: 1933.1882s
	iters: 400, epoch: 5 | loss: 0.0109354
	speed: 0.0416s/iter; left time: 1857.6425s
Epoch: 5 cost time: 19.69993257522583
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.951399 --> -0.951971).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2416302
	speed: 0.2186s/iter; left time: 9718.3697s
	iters: 200, epoch: 6 | loss: 0.3504941
	speed: 0.0428s/iter; left time: 1897.6947s
	iters: 300, epoch: 6 | loss: 0.0081561
	speed: 0.0413s/iter; left time: 1829.8413s
	iters: 400, epoch: 6 | loss: 0.4380013
	speed: 0.0390s/iter; left time: 1723.3301s
Epoch: 6 cost time: 18.878862142562866
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0161521
	speed: 0.2516s/iter; left time: 11064.9422s
	iters: 200, epoch: 7 | loss: 0.0122021
	speed: 0.0458s/iter; left time: 2007.8980s
	iters: 300, epoch: 7 | loss: 0.2892820
	speed: 0.0487s/iter; left time: 2130.4761s
	iters: 400, epoch: 7 | loss: 0.0435338
	speed: 0.0487s/iter; left time: 2129.7125s
Epoch: 7 cost time: 22.693989038467407
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0348471
	speed: 0.2553s/iter; left time: 11111.8633s
	iters: 200, epoch: 8 | loss: 0.0242991
	speed: 0.0365s/iter; left time: 1584.2442s
	iters: 300, epoch: 8 | loss: 0.0021455
	speed: 0.0345s/iter; left time: 1492.6429s
	iters: 400, epoch: 8 | loss: 0.1168645
	speed: 0.0419s/iter; left time: 1811.3683s
Epoch: 8 cost time: 18.38322925567627
Epoch: 8, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.951971 --> -0.957117).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0448261
	speed: 0.2580s/iter; left time: 11106.1709s
	iters: 200, epoch: 9 | loss: 0.0143073
	speed: 0.0453s/iter; left time: 1947.0426s
	iters: 300, epoch: 9 | loss: 0.0288083
	speed: 0.0530s/iter; left time: 2270.2000s
	iters: 400, epoch: 9 | loss: 0.0256299
	speed: 0.0487s/iter; left time: 2082.8545s
Epoch: 9 cost time: 23.410576581954956
Epoch: 9, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0231173
	speed: 0.2346s/iter; left time: 9988.0385s
	iters: 200, epoch: 10 | loss: 0.0249359
	speed: 0.0411s/iter; left time: 1747.4303s
	iters: 300, epoch: 10 | loss: 0.0015605
	speed: 0.0432s/iter; left time: 1830.2926s
	iters: 400, epoch: 10 | loss: 0.0061579
	speed: 0.0438s/iter; left time: 1853.8246s
Epoch: 10 cost time: 21.574690103530884
Epoch: 10, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.957117 --> -0.957688).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0278816
	speed: 0.2749s/iter; left time: 11577.1841s
	iters: 200, epoch: 11 | loss: 0.0106782
	speed: 0.0513s/iter; left time: 2153.3577s
	iters: 300, epoch: 11 | loss: 0.0166411
	speed: 0.0530s/iter; left time: 2221.9019s
	iters: 400, epoch: 11 | loss: 0.1442652
	speed: 0.0475s/iter; left time: 1986.5485s
Epoch: 11 cost time: 23.778109550476074
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1354383
	speed: 0.2697s/iter; left time: 11228.8674s
	iters: 200, epoch: 12 | loss: 0.1698392
	speed: 0.0341s/iter; left time: 1417.9485s
	iters: 300, epoch: 12 | loss: 0.0264560
	speed: 0.0404s/iter; left time: 1675.8201s
	iters: 400, epoch: 12 | loss: 0.0135399
	speed: 0.0428s/iter; left time: 1771.1329s
Epoch: 12 cost time: 19.294221878051758
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0019159
	speed: 0.2539s/iter; left time: 10455.2131s
	iters: 200, epoch: 13 | loss: 0.0608135
	speed: 0.0478s/iter; left time: 1961.2596s
	iters: 300, epoch: 13 | loss: 0.2460999
	speed: 0.0443s/iter; left time: 1816.0390s
	iters: 400, epoch: 13 | loss: 0.0277971
	speed: 0.0463s/iter; left time: 1892.2871s
Epoch: 13 cost time: 21.250303745269775
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.957688 --> -0.959118).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0090175
	speed: 0.2209s/iter; left time: 8990.6750s
	iters: 200, epoch: 14 | loss: 0.0079777
	speed: 0.0479s/iter; left time: 1944.6488s
	iters: 300, epoch: 14 | loss: 0.0056997
	speed: 0.0494s/iter; left time: 1999.0680s
	iters: 400, epoch: 14 | loss: 0.2585610
	speed: 0.0480s/iter; left time: 1937.6825s
Epoch: 14 cost time: 22.591659784317017
Epoch: 14, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
Validation loss decreased (-0.959118 --> -0.971983).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0373330
	speed: 0.2656s/iter; left time: 10687.4375s
	iters: 200, epoch: 15 | loss: 0.0372571
	speed: 0.0476s/iter; left time: 1908.9881s
	iters: 300, epoch: 15 | loss: 0.1112978
	speed: 0.0448s/iter; left time: 1794.4196s
	iters: 400, epoch: 15 | loss: 0.0063940
	speed: 0.0555s/iter; left time: 2214.4348s
Epoch: 15 cost time: 23.652838230133057
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.207 Vali Acc: 0.960 Test Loss: 0.207 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0322738
	speed: 0.2512s/iter; left time: 9988.9902s
	iters: 200, epoch: 16 | loss: 0.0106695
	speed: 0.0454s/iter; left time: 1801.5357s
	iters: 300, epoch: 16 | loss: 0.0070030
	speed: 0.0440s/iter; left time: 1741.9987s
	iters: 400, epoch: 16 | loss: 0.0015745
	speed: 0.0459s/iter; left time: 1810.9870s
Epoch: 16 cost time: 21.33199644088745
Epoch: 16, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0259279
	speed: 0.2507s/iter; left time: 9853.5445s
	iters: 200, epoch: 17 | loss: 0.0044993
	speed: 0.0467s/iter; left time: 1831.3476s
	iters: 300, epoch: 17 | loss: 0.0672039
	speed: 0.0355s/iter; left time: 1387.8694s
	iters: 400, epoch: 17 | loss: 0.0023360
	speed: 0.0394s/iter; left time: 1534.7922s
Epoch: 17 cost time: 20.482459783554077
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3679685
	speed: 0.2290s/iter; left time: 8891.0864s
	iters: 200, epoch: 18 | loss: 0.0032509
	speed: 0.0421s/iter; left time: 1630.0877s
	iters: 300, epoch: 18 | loss: 0.0376252
	speed: 0.0433s/iter; left time: 1672.8527s
	iters: 400, epoch: 18 | loss: 0.0142041
	speed: 0.0423s/iter; left time: 1631.3002s
Epoch: 18 cost time: 20.322539806365967
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0386596
	speed: 0.2582s/iter; left time: 9905.5612s
	iters: 200, epoch: 19 | loss: 0.0010525
	speed: 0.0455s/iter; left time: 1740.5473s
	iters: 300, epoch: 19 | loss: 0.1599318
	speed: 0.0400s/iter; left time: 1527.1381s
	iters: 400, epoch: 19 | loss: 0.0066081
	speed: 0.0377s/iter; left time: 1434.0345s
Epoch: 19 cost time: 19.904329538345337
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0016979
	speed: 0.2491s/iter; left time: 9439.0188s
	iters: 200, epoch: 20 | loss: 0.0827562
	speed: 0.0453s/iter; left time: 1711.9815s
	iters: 300, epoch: 20 | loss: 0.0922409
	speed: 0.0397s/iter; left time: 1497.8758s
	iters: 400, epoch: 20 | loss: 0.0083661
	speed: 0.0377s/iter; left time: 1416.3503s
Epoch: 20 cost time: 20.272764205932617
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0090391
	speed: 0.2086s/iter; left time: 7806.7190s
	iters: 200, epoch: 21 | loss: 0.0003529
	speed: 0.0315s/iter; left time: 1175.6671s
	iters: 300, epoch: 21 | loss: 0.0011358
	speed: 0.0325s/iter; left time: 1209.3237s
	iters: 400, epoch: 21 | loss: 0.0160730
	speed: 0.0383s/iter; left time: 1422.8538s
Epoch: 21 cost time: 17.03529143333435
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0099447
	speed: 0.2175s/iter; left time: 8037.8376s
	iters: 200, epoch: 22 | loss: 0.0175480
	speed: 0.0388s/iter; left time: 1430.9774s
	iters: 300, epoch: 22 | loss: 0.0039591
	speed: 0.0357s/iter; left time: 1313.7026s
	iters: 400, epoch: 22 | loss: 0.0187378
	speed: 0.0428s/iter; left time: 1568.6683s
Epoch: 22 cost time: 18.339102029800415
Epoch: 22, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0005777
	speed: 0.2602s/iter; left time: 9492.7843s
	iters: 200, epoch: 23 | loss: 0.0521756
	speed: 0.0440s/iter; left time: 1599.7259s
	iters: 300, epoch: 23 | loss: 0.0026273
	speed: 0.0485s/iter; left time: 1760.9546s
	iters: 400, epoch: 23 | loss: 0.0029214
	speed: 0.0485s/iter; left time: 1754.6246s
Epoch: 23 cost time: 23.414177179336548
Epoch: 23, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0070300
	speed: 0.2514s/iter; left time: 9054.0700s
	iters: 200, epoch: 24 | loss: 0.0122965
	speed: 0.0418s/iter; left time: 1500.3539s
	iters: 300, epoch: 24 | loss: 0.0022943
	speed: 0.0375s/iter; left time: 1343.6447s
	iters: 400, epoch: 24 | loss: 0.0018408
	speed: 0.0431s/iter; left time: 1539.6656s
Epoch: 24 cost time: 19.893401384353638
Epoch: 24, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 1595170
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7808750
	speed: 0.0607s/iter; left time: 2841.5844s
	iters: 200, epoch: 1 | loss: 0.3474256
	speed: 0.0344s/iter; left time: 1608.7170s
	iters: 300, epoch: 1 | loss: 0.1860370
	speed: 0.0360s/iter; left time: 1675.8076s
	iters: 400, epoch: 1 | loss: 0.0882752
	speed: 0.0392s/iter; left time: 1821.7950s
Epoch: 1 cost time: 19.72588038444519
Epoch: 1, Steps: 469 | Train Loss: 0.597 Vali Loss: 0.258 Vali Acc: 0.936 Test Loss: 0.258 Test Acc: 0.936
Validation loss decreased (inf --> -0.935675).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0444318
	speed: 0.2456s/iter; left time: 11378.2432s
	iters: 200, epoch: 2 | loss: 0.0281137
	speed: 0.0422s/iter; left time: 1949.4899s
	iters: 300, epoch: 2 | loss: 0.0537492
	speed: 0.0389s/iter; left time: 1795.9752s
	iters: 400, epoch: 2 | loss: 0.0267979
	speed: 0.0382s/iter; left time: 1756.1659s
Epoch: 2 cost time: 19.5343759059906
Epoch: 2, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.935675 --> -0.950827).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2473759
	speed: 0.2628s/iter; left time: 12053.2949s
	iters: 200, epoch: 3 | loss: 0.0408647
	speed: 0.0430s/iter; left time: 1969.2214s
	iters: 300, epoch: 3 | loss: 0.0241219
	speed: 0.0483s/iter; left time: 2205.1238s
	iters: 400, epoch: 3 | loss: 0.0248617
	speed: 0.0419s/iter; left time: 1908.4653s
Epoch: 3 cost time: 21.64654517173767
Epoch: 3, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1933807
	speed: 0.2566s/iter; left time: 11647.0875s
	iters: 200, epoch: 4 | loss: 0.1508353
	speed: 0.0375s/iter; left time: 1700.6962s
	iters: 300, epoch: 4 | loss: 0.1904060
	speed: 0.0357s/iter; left time: 1615.3454s
	iters: 400, epoch: 4 | loss: 0.0781196
	speed: 0.0364s/iter; left time: 1643.2960s
Epoch: 4 cost time: 18.293423891067505
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0239918
	speed: 0.2466s/iter; left time: 11076.8846s
	iters: 200, epoch: 5 | loss: 0.0722014
	speed: 0.0357s/iter; left time: 1598.9040s
	iters: 300, epoch: 5 | loss: 0.0117659
	speed: 0.0374s/iter; left time: 1673.7859s
	iters: 400, epoch: 5 | loss: 0.0024613
	speed: 0.0390s/iter; left time: 1740.7442s
Epoch: 5 cost time: 19.081606149673462
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
Validation loss decreased (-0.950827 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0647587
	speed: 0.2416s/iter; left time: 10740.4989s
	iters: 200, epoch: 6 | loss: 0.0630711
	speed: 0.0403s/iter; left time: 1788.4429s
	iters: 300, epoch: 6 | loss: 0.1163141
	speed: 0.0478s/iter; left time: 2117.2269s
	iters: 400, epoch: 6 | loss: 0.0155776
	speed: 0.0444s/iter; left time: 1960.0776s
Epoch: 6 cost time: 20.800174951553345
Epoch: 6, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.187 Vali Acc: 0.947 Test Loss: 0.187 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0742597
	speed: 0.2482s/iter; left time: 10917.9176s
	iters: 200, epoch: 7 | loss: 0.0155933
	speed: 0.0422s/iter; left time: 1853.0261s
	iters: 300, epoch: 7 | loss: 0.0522605
	speed: 0.0393s/iter; left time: 1720.3022s
	iters: 400, epoch: 7 | loss: 0.0100377
	speed: 0.0431s/iter; left time: 1882.8080s
Epoch: 7 cost time: 20.491953134536743
Epoch: 7, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2549961
	speed: 0.2488s/iter; left time: 10826.3880s
	iters: 200, epoch: 8 | loss: 0.0296368
	speed: 0.0405s/iter; left time: 1758.4783s
	iters: 300, epoch: 8 | loss: 0.0175301
	speed: 0.0401s/iter; left time: 1737.0390s
	iters: 400, epoch: 8 | loss: 0.0302761
	speed: 0.0422s/iter; left time: 1822.3167s
Epoch: 8 cost time: 18.897770404815674
Epoch: 8, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.163 Vali Acc: 0.947 Test Loss: 0.163 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0632469
	speed: 0.2189s/iter; left time: 9421.4402s
	iters: 200, epoch: 9 | loss: 0.0640561
	speed: 0.0459s/iter; left time: 1971.5743s
	iters: 300, epoch: 9 | loss: 0.0738218
	speed: 0.0447s/iter; left time: 1914.5364s
	iters: 400, epoch: 9 | loss: 0.4895268
	speed: 0.0520s/iter; left time: 2223.0600s
Epoch: 9 cost time: 22.39749264717102
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0029950
	speed: 0.2822s/iter; left time: 12016.9028s
	iters: 200, epoch: 10 | loss: 0.0031354
	speed: 0.0399s/iter; left time: 1693.7308s
	iters: 300, epoch: 10 | loss: 0.3243080
	speed: 0.0456s/iter; left time: 1931.4148s
	iters: 400, epoch: 10 | loss: 0.0017973
	speed: 0.0380s/iter; left time: 1608.1671s
Epoch: 10 cost time: 20.681221961975098
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0169336
	speed: 0.2433s/iter; left time: 10245.9643s
	iters: 200, epoch: 11 | loss: 0.0028558
	speed: 0.0460s/iter; left time: 1934.2046s
	iters: 300, epoch: 11 | loss: 0.1145362
	speed: 0.0441s/iter; left time: 1849.2440s
	iters: 400, epoch: 11 | loss: 0.1658013
	speed: 0.0425s/iter; left time: 1775.0263s
Epoch: 11 cost time: 20.491657257080078
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0040457
	speed: 0.2366s/iter; left time: 9854.4079s
	iters: 200, epoch: 12 | loss: 0.0292574
	speed: 0.0480s/iter; left time: 1994.4879s
	iters: 300, epoch: 12 | loss: 0.0082617
	speed: 0.0453s/iter; left time: 1875.9195s
	iters: 400, epoch: 12 | loss: 0.0068945
	speed: 0.0436s/iter; left time: 1804.1407s
Epoch: 12 cost time: 21.373424768447876
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0050981
	speed: 0.2650s/iter; left time: 10911.9728s
	iters: 200, epoch: 13 | loss: 0.1921384
	speed: 0.0466s/iter; left time: 1913.6529s
	iters: 300, epoch: 13 | loss: 0.0012454
	speed: 0.0455s/iter; left time: 1865.1595s
	iters: 400, epoch: 13 | loss: 0.0268508
	speed: 0.0479s/iter; left time: 1958.7195s
Epoch: 13 cost time: 22.363011837005615
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0689569
	speed: 0.2796s/iter; left time: 11381.0129s
	iters: 200, epoch: 14 | loss: 0.0365799
	speed: 0.0374s/iter; left time: 1519.1691s
	iters: 300, epoch: 14 | loss: 0.0049288
	speed: 0.0374s/iter; left time: 1513.5564s
	iters: 400, epoch: 14 | loss: 0.0036707
	speed: 0.0390s/iter; left time: 1576.4675s
Epoch: 14 cost time: 18.792177200317383
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0064970
	speed: 0.2333s/iter; left time: 9385.1919s
	iters: 200, epoch: 15 | loss: 0.0047336
	speed: 0.0324s/iter; left time: 1302.0309s
	iters: 300, epoch: 15 | loss: 0.0283932
	speed: 0.0361s/iter; left time: 1445.9287s
	iters: 400, epoch: 15 | loss: 0.1051229
	speed: 0.0326s/iter; left time: 1300.8015s
Epoch: 15 cost time: 18.160696506500244
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9691252144082333
model parameter : 1595042
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8118745
	speed: 0.0702s/iter; left time: 3286.7145s
	iters: 200, epoch: 1 | loss: 0.1522310
	speed: 0.0415s/iter; left time: 1939.5716s
	iters: 300, epoch: 1 | loss: 0.1763262
	speed: 0.0487s/iter; left time: 2267.7961s
	iters: 400, epoch: 1 | loss: 0.0745255
	speed: 0.0429s/iter; left time: 1996.0971s
Epoch: 1 cost time: 23.667912006378174
Epoch: 1, Steps: 469 | Train Loss: 0.574 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (inf --> -0.921667).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0753559
	speed: 0.2335s/iter; left time: 10819.2709s
	iters: 200, epoch: 2 | loss: 0.0595514
	speed: 0.0406s/iter; left time: 1874.7290s
	iters: 300, epoch: 2 | loss: 0.2654719
	speed: 0.0432s/iter; left time: 1993.0411s
	iters: 400, epoch: 2 | loss: 0.0478855
	speed: 0.0367s/iter; left time: 1688.9033s
Epoch: 2 cost time: 19.313660621643066
Epoch: 2, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.356 Vali Acc: 0.896 Test Loss: 0.356 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0605543
	speed: 0.2133s/iter; left time: 9781.4552s
	iters: 200, epoch: 3 | loss: 0.3376699
	speed: 0.0435s/iter; left time: 1989.7713s
	iters: 300, epoch: 3 | loss: 0.0261548
	speed: 0.0360s/iter; left time: 1642.0900s
	iters: 400, epoch: 3 | loss: 0.1661503
	speed: 0.0360s/iter; left time: 1639.3952s
Epoch: 3 cost time: 18.84839653968811
Epoch: 3, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.921667 --> -0.921953).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0538804
	speed: 0.2093s/iter; left time: 9502.7308s
	iters: 200, epoch: 4 | loss: 0.2870416
	speed: 0.0293s/iter; left time: 1326.7810s
	iters: 300, epoch: 4 | loss: 0.0564947
	speed: 0.0298s/iter; left time: 1348.9164s
	iters: 400, epoch: 4 | loss: 0.0192020
	speed: 0.0284s/iter; left time: 1280.7044s
Epoch: 4 cost time: 14.397339582443237
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0190111
	speed: 0.2054s/iter; left time: 9228.4679s
	iters: 200, epoch: 5 | loss: 0.0112433
	speed: 0.0384s/iter; left time: 1721.7087s
	iters: 300, epoch: 5 | loss: 0.0127454
	speed: 0.0415s/iter; left time: 1857.8096s
	iters: 400, epoch: 5 | loss: 0.0764627
	speed: 0.0329s/iter; left time: 1467.1461s
Epoch: 5 cost time: 17.41108727455139
Epoch: 5, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.921953 --> -0.959404).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2492652
	speed: 0.2063s/iter; left time: 9170.4976s
	iters: 200, epoch: 6 | loss: 0.0289063
	speed: 0.0395s/iter; left time: 1752.5279s
	iters: 300, epoch: 6 | loss: 0.0111033
	speed: 0.0434s/iter; left time: 1920.6597s
	iters: 400, epoch: 6 | loss: 0.0144677
	speed: 0.0367s/iter; left time: 1622.6357s
Epoch: 6 cost time: 18.90489387512207
Epoch: 6, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3336261
	speed: 0.2298s/iter; left time: 10108.7569s
	iters: 200, epoch: 7 | loss: 0.0774804
	speed: 0.0364s/iter; left time: 1598.2994s
	iters: 300, epoch: 7 | loss: 0.0085502
	speed: 0.0360s/iter; left time: 1578.1004s
	iters: 400, epoch: 7 | loss: 0.1589442
	speed: 0.0352s/iter; left time: 1536.5395s
Epoch: 7 cost time: 18.504247426986694
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.959404 --> -0.969124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0692767
	speed: 0.2070s/iter; left time: 9008.9667s
	iters: 200, epoch: 8 | loss: 0.0185128
	speed: 0.0375s/iter; left time: 1627.3600s
	iters: 300, epoch: 8 | loss: 0.0047790
	speed: 0.0389s/iter; left time: 1685.6297s
	iters: 400, epoch: 8 | loss: 0.2852811
	speed: 0.0400s/iter; left time: 1726.8759s
Epoch: 8 cost time: 17.894073724746704
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.317 Vali Acc: 0.907 Test Loss: 0.317 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0029420
	speed: 0.2147s/iter; left time: 9244.0504s
	iters: 200, epoch: 9 | loss: 0.0028115
	speed: 0.0394s/iter; left time: 1690.6230s
	iters: 300, epoch: 9 | loss: 0.0108405
	speed: 0.0430s/iter; left time: 1842.5961s
	iters: 400, epoch: 9 | loss: 0.7455685
	speed: 0.0413s/iter; left time: 1765.7935s
Epoch: 9 cost time: 18.88914918899536
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0713832
	speed: 0.2110s/iter; left time: 8986.0994s
	iters: 200, epoch: 10 | loss: 0.0056173
	speed: 0.0417s/iter; left time: 1771.8892s
	iters: 300, epoch: 10 | loss: 0.0050221
	speed: 0.0330s/iter; left time: 1400.1281s
	iters: 400, epoch: 10 | loss: 0.0036384
	speed: 0.0361s/iter; left time: 1526.7709s
Epoch: 10 cost time: 18.19953727722168
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0034387
	speed: 0.2141s/iter; left time: 9016.1798s
	iters: 200, epoch: 11 | loss: 0.1523321
	speed: 0.0334s/iter; left time: 1401.4618s
	iters: 300, epoch: 11 | loss: 0.0517902
	speed: 0.0418s/iter; left time: 1752.6012s
	iters: 400, epoch: 11 | loss: 0.0594686
	speed: 0.0390s/iter; left time: 1628.9209s
Epoch: 11 cost time: 18.176838159561157
Epoch: 11, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0073512
	speed: 0.2187s/iter; left time: 9106.3725s
	iters: 200, epoch: 12 | loss: 0.0025703
	speed: 0.0398s/iter; left time: 1654.5924s
	iters: 300, epoch: 12 | loss: 0.1911837
	speed: 0.0385s/iter; left time: 1594.8506s
	iters: 400, epoch: 12 | loss: 0.0499768
	speed: 0.0339s/iter; left time: 1401.1766s
Epoch: 12 cost time: 17.44245457649231
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2103242
	speed: 0.2006s/iter; left time: 8260.7280s
	iters: 200, epoch: 13 | loss: 0.1100011
	speed: 0.0343s/iter; left time: 1410.3540s
	iters: 300, epoch: 13 | loss: 0.1720026
	speed: 0.0399s/iter; left time: 1634.3529s
	iters: 400, epoch: 13 | loss: 0.2661137
	speed: 0.0336s/iter; left time: 1373.9692s
Epoch: 13 cost time: 17.446101427078247
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0062391
	speed: 0.2311s/iter; left time: 9407.7870s
	iters: 200, epoch: 14 | loss: 0.0014440
	speed: 0.0392s/iter; left time: 1591.0650s
	iters: 300, epoch: 14 | loss: 0.0027099
	speed: 0.0464s/iter; left time: 1879.4171s
	iters: 400, epoch: 14 | loss: 0.0263870
	speed: 0.0385s/iter; left time: 1555.1442s
Epoch: 14 cost time: 19.81923246383667
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0015120
	speed: 0.2082s/iter; left time: 8378.8159s
	iters: 200, epoch: 15 | loss: 0.0039070
	speed: 0.0400s/iter; left time: 1603.4464s
	iters: 300, epoch: 15 | loss: 0.0071542
	speed: 0.0410s/iter; left time: 1640.5542s
	iters: 400, epoch: 15 | loss: 0.0955257
	speed: 0.0426s/iter; left time: 1701.0613s
Epoch: 15 cost time: 19.1384756565094
Epoch: 15, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0969868
	speed: 0.2061s/iter; left time: 8196.0226s
	iters: 200, epoch: 16 | loss: 0.0102811
	speed: 0.0353s/iter; left time: 1398.3761s
	iters: 300, epoch: 16 | loss: 0.1837032
	speed: 0.0443s/iter; left time: 1751.1835s
	iters: 400, epoch: 16 | loss: 0.0162151
	speed: 0.0510s/iter; left time: 2013.0962s
Epoch: 16 cost time: 19.183205366134644
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0055434
	speed: 0.1892s/iter; left time: 7433.4607s
	iters: 200, epoch: 17 | loss: 0.0095476
	speed: 0.0341s/iter; left time: 1336.4525s
	iters: 300, epoch: 17 | loss: 0.0509609
	speed: 0.0342s/iter; left time: 1337.3195s
	iters: 400, epoch: 17 | loss: 0.0017281
	speed: 0.0413s/iter; left time: 1608.7174s
Epoch: 17 cost time: 17.217464447021484
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9691252144082333
model parameter : 1594914
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6377689
	speed: 0.0696s/iter; left time: 3257.6050s
	iters: 200, epoch: 1 | loss: 0.3364879
	speed: 0.0436s/iter; left time: 2037.7697s
	iters: 300, epoch: 1 | loss: 0.1829180
	speed: 0.0472s/iter; left time: 2198.5393s
	iters: 400, epoch: 1 | loss: 0.1068987
	speed: 0.0422s/iter; left time: 1963.1431s
Epoch: 1 cost time: 23.24855089187622
Epoch: 1, Steps: 469 | Train Loss: 0.587 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (inf --> -0.926241).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0728268
	speed: 0.2486s/iter; left time: 11516.8173s
	iters: 200, epoch: 2 | loss: 0.2596755
	speed: 0.0339s/iter; left time: 1565.3301s
	iters: 300, epoch: 2 | loss: 0.0798389
	speed: 0.0397s/iter; left time: 1830.8089s
	iters: 400, epoch: 2 | loss: 0.0152769
	speed: 0.0400s/iter; left time: 1840.1859s
Epoch: 2 cost time: 18.879410982131958
Epoch: 2, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1396260
	speed: 0.2421s/iter; left time: 11104.3986s
	iters: 200, epoch: 3 | loss: 0.1334249
	speed: 0.0452s/iter; left time: 2068.1127s
	iters: 300, epoch: 3 | loss: 0.0357601
	speed: 0.0412s/iter; left time: 1881.8658s
	iters: 400, epoch: 3 | loss: 0.0058363
	speed: 0.0389s/iter; left time: 1772.8299s
Epoch: 3 cost time: 20.039239168167114
Epoch: 3, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.926241 --> -0.948540).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0173189
	speed: 0.2455s/iter; left time: 11144.5769s
	iters: 200, epoch: 4 | loss: 0.1795564
	speed: 0.0463s/iter; left time: 2095.0843s
	iters: 300, epoch: 4 | loss: 0.0448898
	speed: 0.0421s/iter; left time: 1902.8085s
	iters: 400, epoch: 4 | loss: 0.0121427
	speed: 0.0391s/iter; left time: 1763.5498s
Epoch: 4 cost time: 20.086966514587402
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0712655
	speed: 0.2431s/iter; left time: 10922.9066s
	iters: 200, epoch: 5 | loss: 0.0046237
	speed: 0.0538s/iter; left time: 2411.9016s
	iters: 300, epoch: 5 | loss: 0.0167491
	speed: 0.0466s/iter; left time: 2085.6745s
	iters: 400, epoch: 5 | loss: 0.0144953
	speed: 0.0432s/iter; left time: 1928.6078s
Epoch: 5 cost time: 22.610616207122803
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1979199
	speed: 0.2740s/iter; left time: 12180.2945s
	iters: 200, epoch: 6 | loss: 0.0553123
	speed: 0.0411s/iter; left time: 1821.4957s
	iters: 300, epoch: 6 | loss: 0.0352548
	speed: 0.0404s/iter; left time: 1787.4724s
	iters: 400, epoch: 6 | loss: 0.1612034
	speed: 0.0422s/iter; left time: 1864.5268s
Epoch: 6 cost time: 20.304335832595825
Epoch: 6, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.948540 --> -0.951113).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2563912
	speed: 0.2348s/iter; left time: 10327.1253s
	iters: 200, epoch: 7 | loss: 0.0277714
	speed: 0.0382s/iter; left time: 1676.0694s
	iters: 300, epoch: 7 | loss: 0.0056944
	speed: 0.0337s/iter; left time: 1476.1000s
	iters: 400, epoch: 7 | loss: 0.0461644
	speed: 0.0302s/iter; left time: 1320.5765s
Epoch: 7 cost time: 16.764532804489136
Epoch: 7, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.951113 --> -0.969124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3097561
	speed: 0.2363s/iter; left time: 10283.1664s
	iters: 200, epoch: 8 | loss: 0.0343587
	speed: 0.0374s/iter; left time: 1625.4259s
	iters: 300, epoch: 8 | loss: 0.0186322
	speed: 0.0415s/iter; left time: 1795.5881s
	iters: 400, epoch: 8 | loss: 0.0418938
	speed: 0.0391s/iter; left time: 1688.9577s
Epoch: 8 cost time: 18.820880889892578
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.193 Vali Acc: 0.947 Test Loss: 0.193 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0135539
	speed: 0.2459s/iter; left time: 10584.7719s
	iters: 200, epoch: 9 | loss: 0.0105701
	speed: 0.0378s/iter; left time: 1622.2785s
	iters: 300, epoch: 9 | loss: 0.5929438
	speed: 0.0354s/iter; left time: 1517.5282s
	iters: 400, epoch: 9 | loss: 0.0020244
	speed: 0.0416s/iter; left time: 1777.5130s
Epoch: 9 cost time: 19.139097452163696
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0207165
	speed: 0.2687s/iter; left time: 11441.6132s
	iters: 200, epoch: 10 | loss: 0.0141723
	speed: 0.0391s/iter; left time: 1661.5090s
	iters: 300, epoch: 10 | loss: 0.0252478
	speed: 0.0393s/iter; left time: 1664.8942s
	iters: 400, epoch: 10 | loss: 0.0034167
	speed: 0.0432s/iter; left time: 1824.7423s
Epoch: 10 cost time: 19.84857726097107
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0043485
	speed: 0.2354s/iter; left time: 9912.5360s
	iters: 200, epoch: 11 | loss: 0.0016686
	speed: 0.0446s/iter; left time: 1873.3907s
	iters: 300, epoch: 11 | loss: 0.0420036
	speed: 0.0456s/iter; left time: 1912.5285s
	iters: 400, epoch: 11 | loss: 0.0082354
	speed: 0.0427s/iter; left time: 1785.8184s
Epoch: 11 cost time: 20.784437894821167
Epoch: 11, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0143397
	speed: 0.2310s/iter; left time: 9618.8846s
	iters: 200, epoch: 12 | loss: 0.0069186
	speed: 0.0408s/iter; left time: 1693.1888s
	iters: 300, epoch: 12 | loss: 0.0653664
	speed: 0.0339s/iter; left time: 1402.9285s
	iters: 400, epoch: 12 | loss: 0.0219082
	speed: 0.0412s/iter; left time: 1704.7130s
Epoch: 12 cost time: 19.62762975692749
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0230720
	speed: 0.2570s/iter; left time: 10582.4209s
	iters: 200, epoch: 13 | loss: 0.0395453
	speed: 0.0417s/iter; left time: 1713.9369s
	iters: 300, epoch: 13 | loss: 0.0277666
	speed: 0.0356s/iter; left time: 1460.4081s
	iters: 400, epoch: 13 | loss: 0.0026403
	speed: 0.0413s/iter; left time: 1689.0638s
Epoch: 13 cost time: 19.96659755706787
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0019588
	speed: 0.2637s/iter; left time: 10732.8440s
	iters: 200, epoch: 14 | loss: 0.0009869
	speed: 0.0437s/iter; left time: 1772.5565s
	iters: 300, epoch: 14 | loss: 0.0076815
	speed: 0.0428s/iter; left time: 1735.2892s
	iters: 400, epoch: 14 | loss: 0.0156257
	speed: 0.0515s/iter; left time: 2080.4539s
Epoch: 14 cost time: 20.828043222427368
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.969982).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0538625
	speed: 0.2439s/iter; left time: 9815.1937s
	iters: 200, epoch: 15 | loss: 0.0221960
	speed: 0.0404s/iter; left time: 1621.1321s
	iters: 300, epoch: 15 | loss: 0.4179876
	speed: 0.0431s/iter; left time: 1724.3465s
	iters: 400, epoch: 15 | loss: 0.0892121
	speed: 0.0371s/iter; left time: 1481.9423s
Epoch: 15 cost time: 19.43934440612793
Epoch: 15, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0036672
	speed: 0.2096s/iter; left time: 8333.8859s
	iters: 200, epoch: 16 | loss: 0.0055861
	speed: 0.0331s/iter; left time: 1311.8377s
	iters: 300, epoch: 16 | loss: 0.0172710
	speed: 0.0339s/iter; left time: 1342.7879s
	iters: 400, epoch: 16 | loss: 0.0043402
	speed: 0.0388s/iter; left time: 1529.4895s
Epoch: 16 cost time: 18.01443362236023
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0049164
	speed: 0.2389s/iter; left time: 9389.0754s
	iters: 200, epoch: 17 | loss: 0.0058116
	speed: 0.0374s/iter; left time: 1467.2113s
	iters: 300, epoch: 17 | loss: 0.0868179
	speed: 0.0415s/iter; left time: 1622.9957s
	iters: 400, epoch: 17 | loss: 0.0343926
	speed: 0.0467s/iter; left time: 1820.7240s
Epoch: 17 cost time: 20.12309193611145
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0022927
	speed: 0.2332s/iter; left time: 9053.0367s
	iters: 200, epoch: 18 | loss: 0.0028923
	speed: 0.0381s/iter; left time: 1475.8696s
	iters: 300, epoch: 18 | loss: 0.0032009
	speed: 0.0454s/iter; left time: 1753.5711s
	iters: 400, epoch: 18 | loss: 0.0009203
	speed: 0.0405s/iter; left time: 1560.7697s
Epoch: 18 cost time: 19.62468433380127
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0016951
	speed: 0.2533s/iter; left time: 9715.3774s
	iters: 200, epoch: 19 | loss: 0.3251059
	speed: 0.0460s/iter; left time: 1758.0366s
	iters: 300, epoch: 19 | loss: 0.0035623
	speed: 0.0436s/iter; left time: 1661.9772s
	iters: 400, epoch: 19 | loss: 0.1909580
	speed: 0.0449s/iter; left time: 1709.2961s
Epoch: 19 cost time: 21.139719009399414
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0070842
	speed: 0.2372s/iter; left time: 8989.2940s
	iters: 200, epoch: 20 | loss: 0.0088148
	speed: 0.0410s/iter; left time: 1549.2226s
	iters: 300, epoch: 20 | loss: 0.0009247
	speed: 0.0317s/iter; left time: 1194.0092s
	iters: 400, epoch: 20 | loss: 0.0002956
	speed: 0.0428s/iter; left time: 1607.4819s
Epoch: 20 cost time: 20.005155324935913
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0545555
	speed: 0.2075s/iter; left time: 7763.6805s
	iters: 200, epoch: 21 | loss: 0.0609477
	speed: 0.0375s/iter; left time: 1398.7073s
	iters: 300, epoch: 21 | loss: 0.0080259
	speed: 0.0437s/iter; left time: 1625.6822s
	iters: 400, epoch: 21 | loss: 0.0056595
	speed: 0.0417s/iter; left time: 1548.4893s
Epoch: 21 cost time: 19.557422876358032
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0893590
	speed: 0.2351s/iter; left time: 8686.3546s
	iters: 200, epoch: 22 | loss: 0.0687522
	speed: 0.0481s/iter; left time: 1771.9061s
	iters: 300, epoch: 22 | loss: 0.0055698
	speed: 0.0449s/iter; left time: 1650.2593s
	iters: 400, epoch: 22 | loss: 0.0047411
	speed: 0.0442s/iter; left time: 1619.5019s
Epoch: 22 cost time: 21.557560205459595
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0039659
	speed: 0.2869s/iter; left time: 10466.8029s
	iters: 200, epoch: 23 | loss: 0.0005567
	speed: 0.0501s/iter; left time: 1822.9687s
	iters: 300, epoch: 23 | loss: 0.0296973
	speed: 0.0501s/iter; left time: 1816.1523s
	iters: 400, epoch: 23 | loss: 0.1654946
	speed: 0.0417s/iter; left time: 1509.3264s
Epoch: 23 cost time: 23.408750295639038
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2052160
	speed: 0.2514s/iter; left time: 9052.4156s
	iters: 200, epoch: 24 | loss: 0.0180949
	speed: 0.0441s/iter; left time: 1583.9623s
	iters: 300, epoch: 24 | loss: 0.0014167
	speed: 0.0371s/iter; left time: 1330.2825s
	iters: 400, epoch: 24 | loss: 0.2898096
	speed: 0.0388s/iter; left time: 1386.9755s
Epoch: 24 cost time: 19.517582893371582
Epoch: 24, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9699828473413379
model parameter : 1594786
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0713927
	speed: 0.0812s/iter; left time: 3802.2655s
	iters: 200, epoch: 1 | loss: 0.6439641
	speed: 0.0398s/iter; left time: 1860.8803s
	iters: 300, epoch: 1 | loss: 0.2681288
	speed: 0.0428s/iter; left time: 1993.1745s
	iters: 400, epoch: 1 | loss: 0.1631828
	speed: 0.0624s/iter; left time: 2901.8937s
Epoch: 1 cost time: 26.17798376083374
Epoch: 1, Steps: 469 | Train Loss: 0.636 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
Validation loss decreased (inf --> -0.913091).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4272127
	speed: 0.2603s/iter; left time: 12061.2469s
	iters: 200, epoch: 2 | loss: 0.0642203
	speed: 0.0482s/iter; left time: 2228.4597s
	iters: 300, epoch: 2 | loss: 0.1814472
	speed: 0.0481s/iter; left time: 2217.7877s
	iters: 400, epoch: 2 | loss: 0.0508005
	speed: 0.0458s/iter; left time: 2109.9161s
Epoch: 2 cost time: 22.910306930541992
Epoch: 2, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (-0.913091 --> -0.953972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0322443
	speed: 0.2432s/iter; left time: 11153.2251s
	iters: 200, epoch: 3 | loss: 0.0389611
	speed: 0.0411s/iter; left time: 1880.7360s
	iters: 300, epoch: 3 | loss: 0.0530864
	speed: 0.0428s/iter; left time: 1956.2252s
	iters: 400, epoch: 3 | loss: 0.0801171
	speed: 0.0311s/iter; left time: 1414.8410s
Epoch: 3 cost time: 18.947274923324585
Epoch: 3, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0115105
	speed: 0.2095s/iter; left time: 9510.9556s
	iters: 200, epoch: 4 | loss: 0.0067696
	speed: 0.0380s/iter; left time: 1721.3845s
	iters: 300, epoch: 4 | loss: 0.1087611
	speed: 0.0352s/iter; left time: 1591.5656s
	iters: 400, epoch: 4 | loss: 0.0612173
	speed: 0.0361s/iter; left time: 1627.3880s
Epoch: 4 cost time: 17.516122579574585
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.953972 --> -0.972269).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0094704
	speed: 0.2173s/iter; left time: 9760.2932s
	iters: 200, epoch: 5 | loss: 0.1069859
	speed: 0.0452s/iter; left time: 2024.1636s
	iters: 300, epoch: 5 | loss: 0.0142083
	speed: 0.0445s/iter; left time: 1988.0466s
	iters: 400, epoch: 5 | loss: 0.0137720
	speed: 0.0409s/iter; left time: 1822.9405s
Epoch: 5 cost time: 20.752291202545166
Epoch: 5, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0060915
	speed: 0.2411s/iter; left time: 10717.8277s
	iters: 200, epoch: 6 | loss: 0.0312437
	speed: 0.0456s/iter; left time: 2023.0534s
	iters: 300, epoch: 6 | loss: 0.0392915
	speed: 0.0375s/iter; left time: 1659.2128s
	iters: 400, epoch: 6 | loss: 0.0076436
	speed: 0.0366s/iter; left time: 1615.9680s
Epoch: 6 cost time: 19.691399812698364
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2595508
	speed: 0.2308s/iter; left time: 10151.7784s
	iters: 200, epoch: 7 | loss: 0.4080153
	speed: 0.0442s/iter; left time: 1941.1842s
	iters: 300, epoch: 7 | loss: 0.1911735
	speed: 0.0422s/iter; left time: 1848.8782s
	iters: 400, epoch: 7 | loss: 0.0233786
	speed: 0.0394s/iter; left time: 1720.2776s
Epoch: 7 cost time: 20.09994411468506
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0136502
	speed: 0.2141s/iter; left time: 9319.1946s
	iters: 200, epoch: 8 | loss: 0.0074538
	speed: 0.0355s/iter; left time: 1540.6462s
	iters: 300, epoch: 8 | loss: 0.0214432
	speed: 0.0386s/iter; left time: 1670.3771s
	iters: 400, epoch: 8 | loss: 0.0683378
	speed: 0.0354s/iter; left time: 1531.2229s
Epoch: 8 cost time: 17.84239935874939
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0409817
	speed: 0.2358s/iter; left time: 10149.2278s
	iters: 200, epoch: 9 | loss: 0.4756251
	speed: 0.0434s/iter; left time: 1862.9298s
	iters: 300, epoch: 9 | loss: 0.0175828
	speed: 0.0448s/iter; left time: 1918.9040s
	iters: 400, epoch: 9 | loss: 0.0038232
	speed: 0.0435s/iter; left time: 1858.4351s
Epoch: 9 cost time: 20.571406602859497
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1844518
	speed: 0.2316s/iter; left time: 9862.0475s
	iters: 200, epoch: 10 | loss: 0.3916852
	speed: 0.0406s/iter; left time: 1725.4554s
	iters: 300, epoch: 10 | loss: 0.0788229
	speed: 0.0458s/iter; left time: 1940.0520s
	iters: 400, epoch: 10 | loss: 0.0023008
	speed: 0.0417s/iter; left time: 1761.7334s
Epoch: 10 cost time: 20.475078105926514
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0017137
	speed: 0.2332s/iter; left time: 9819.7290s
	iters: 200, epoch: 11 | loss: 0.1433766
	speed: 0.0409s/iter; left time: 1718.8156s
	iters: 300, epoch: 11 | loss: 0.0020380
	speed: 0.0391s/iter; left time: 1640.6307s
	iters: 400, epoch: 11 | loss: 0.0255532
	speed: 0.0368s/iter; left time: 1539.0632s
Epoch: 11 cost time: 18.664080381393433
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0098159
	speed: 0.2303s/iter; left time: 9591.7493s
	iters: 200, epoch: 12 | loss: 0.0067182
	speed: 0.0390s/iter; left time: 1619.1967s
	iters: 300, epoch: 12 | loss: 0.0434024
	speed: 0.0372s/iter; left time: 1543.3330s
	iters: 400, epoch: 12 | loss: 0.0455610
	speed: 0.0357s/iter; left time: 1476.4980s
Epoch: 12 cost time: 18.483487606048584
Epoch: 12, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0528710
	speed: 0.2190s/iter; left time: 9016.3439s
	iters: 200, epoch: 13 | loss: 0.0204740
	speed: 0.0413s/iter; left time: 1694.3606s
	iters: 300, epoch: 13 | loss: 0.0094488
	speed: 0.0436s/iter; left time: 1784.7118s
	iters: 400, epoch: 13 | loss: 0.0401230
	speed: 0.0394s/iter; left time: 1610.3608s
Epoch: 13 cost time: 20.254878520965576
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0006715
	speed: 0.2306s/iter; left time: 9387.8640s
	iters: 200, epoch: 14 | loss: 0.0071062
	speed: 0.0475s/iter; left time: 1930.0870s
	iters: 300, epoch: 14 | loss: 0.0017136
	speed: 0.0415s/iter; left time: 1679.1489s
	iters: 400, epoch: 14 | loss: 0.0173099
	speed: 0.0466s/iter; left time: 1881.4402s
Epoch: 14 cost time: 21.421876192092896
Epoch: 14, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9722698684962836
model parameter : 1200418
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9225037
	speed: 0.0484s/iter; left time: 2264.3540s
	iters: 200, epoch: 1 | loss: 0.2348665
	speed: 0.0299s/iter; left time: 1394.4646s
	iters: 300, epoch: 1 | loss: 0.3182304
	speed: 0.0384s/iter; left time: 1789.8365s
	iters: 400, epoch: 1 | loss: 0.0597242
	speed: 0.0323s/iter; left time: 1504.2225s
Epoch: 1 cost time: 17.13847279548645
Epoch: 1, Steps: 469 | Train Loss: 0.643 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
Validation loss decreased (inf --> -0.942250).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0700458
	speed: 0.1931s/iter; left time: 8947.2751s
	iters: 200, epoch: 2 | loss: 0.1651101
	speed: 0.0354s/iter; left time: 1634.5712s
	iters: 300, epoch: 2 | loss: 0.0306921
	speed: 0.0347s/iter; left time: 1600.8948s
	iters: 400, epoch: 2 | loss: 0.0643772
	speed: 0.0393s/iter; left time: 1811.1154s
Epoch: 2 cost time: 17.581228733062744
Epoch: 2, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0136320
	speed: 0.2146s/iter; left time: 9844.0398s
	iters: 200, epoch: 3 | loss: 0.3105747
	speed: 0.0321s/iter; left time: 1467.7261s
	iters: 300, epoch: 3 | loss: 0.0389372
	speed: 0.0372s/iter; left time: 1697.8875s
	iters: 400, epoch: 3 | loss: 0.0778923
	speed: 0.0354s/iter; left time: 1613.2914s
Epoch: 3 cost time: 16.705474138259888
Epoch: 3, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
Validation loss decreased (-0.942250 --> -0.943108).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0235641
	speed: 0.2060s/iter; left time: 9348.9525s
	iters: 200, epoch: 4 | loss: 0.2386609
	speed: 0.0368s/iter; left time: 1667.5022s
	iters: 300, epoch: 4 | loss: 0.0737417
	speed: 0.0408s/iter; left time: 1844.1087s
	iters: 400, epoch: 4 | loss: 0.0996339
	speed: 0.0424s/iter; left time: 1914.2162s
Epoch: 4 cost time: 18.58653450012207
Epoch: 4, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.943108 --> -0.952543).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0161477
	speed: 0.2359s/iter; left time: 10598.3568s
	iters: 200, epoch: 5 | loss: 0.0074665
	speed: 0.0333s/iter; left time: 1490.4787s
	iters: 300, epoch: 5 | loss: 0.0174337
	speed: 0.0350s/iter; left time: 1563.2427s
	iters: 400, epoch: 5 | loss: 0.0824100
	speed: 0.0354s/iter; left time: 1578.9070s
Epoch: 5 cost time: 17.804614305496216
Epoch: 5, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.952543 --> -0.965122).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0295327
	speed: 0.2029s/iter; left time: 9021.5631s
	iters: 200, epoch: 6 | loss: 0.0033081
	speed: 0.0283s/iter; left time: 1257.4544s
	iters: 300, epoch: 6 | loss: 0.0100876
	speed: 0.0354s/iter; left time: 1567.1715s
	iters: 400, epoch: 6 | loss: 0.0176778
	speed: 0.0335s/iter; left time: 1480.8538s
Epoch: 6 cost time: 15.656510353088379
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0143955
	speed: 0.1851s/iter; left time: 8141.1675s
	iters: 200, epoch: 7 | loss: 0.0053513
	speed: 0.0298s/iter; left time: 1306.1144s
	iters: 300, epoch: 7 | loss: 0.1682348
	speed: 0.0309s/iter; left time: 1353.9044s
	iters: 400, epoch: 7 | loss: 0.2663644
	speed: 0.0325s/iter; left time: 1418.0770s
Epoch: 7 cost time: 15.334043264389038
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.193 Vali Acc: 0.945 Test Loss: 0.193 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0137386
	speed: 0.1792s/iter; left time: 7798.9108s
	iters: 200, epoch: 8 | loss: 0.0146799
	speed: 0.0363s/iter; left time: 1575.1930s
	iters: 300, epoch: 8 | loss: 0.0747055
	speed: 0.0347s/iter; left time: 1502.2595s
	iters: 400, epoch: 8 | loss: 0.0276185
	speed: 0.0353s/iter; left time: 1525.3086s
Epoch: 8 cost time: 17.38302731513977
Epoch: 8, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0211132
	speed: 0.2178s/iter; left time: 9375.4684s
	iters: 200, epoch: 9 | loss: 0.0026379
	speed: 0.0367s/iter; left time: 1575.6239s
	iters: 300, epoch: 9 | loss: 0.0008819
	speed: 0.0416s/iter; left time: 1780.9755s
	iters: 400, epoch: 9 | loss: 0.0034725
	speed: 0.0429s/iter; left time: 1832.1679s
Epoch: 9 cost time: 18.412842750549316
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1933564
	speed: 0.1850s/iter; left time: 7877.8907s
	iters: 200, epoch: 10 | loss: 0.0473819
	speed: 0.0335s/iter; left time: 1424.0084s
	iters: 300, epoch: 10 | loss: 0.0446364
	speed: 0.0348s/iter; left time: 1476.3015s
	iters: 400, epoch: 10 | loss: 0.0043601
	speed: 0.0279s/iter; left time: 1177.5025s
Epoch: 10 cost time: 15.223977327346802
Epoch: 10, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0591266
	speed: 0.1919s/iter; left time: 8082.7048s
	iters: 200, epoch: 11 | loss: 0.2311558
	speed: 0.0347s/iter; left time: 1458.3034s
	iters: 300, epoch: 11 | loss: 0.0357379
	speed: 0.0344s/iter; left time: 1442.3486s
	iters: 400, epoch: 11 | loss: 0.0036006
	speed: 0.0291s/iter; left time: 1215.8510s
Epoch: 11 cost time: 16.49962544441223
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4039541
	speed: 0.1973s/iter; left time: 8216.8060s
	iters: 200, epoch: 12 | loss: 0.0055239
	speed: 0.0337s/iter; left time: 1399.4830s
	iters: 300, epoch: 12 | loss: 0.1870500
	speed: 0.0400s/iter; left time: 1659.2955s
	iters: 400, epoch: 12 | loss: 0.0043115
	speed: 0.0385s/iter; left time: 1593.4956s
Epoch: 12 cost time: 17.33447575569153
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0237519
	speed: 0.1911s/iter; left time: 7866.6934s
	iters: 200, epoch: 13 | loss: 0.0072559
	speed: 0.0383s/iter; left time: 1571.9870s
	iters: 300, epoch: 13 | loss: 0.0242430
	speed: 0.0360s/iter; left time: 1476.3531s
	iters: 400, epoch: 13 | loss: 0.0492526
	speed: 0.0337s/iter; left time: 1378.5621s
Epoch: 13 cost time: 17.369226932525635
Epoch: 13, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1116605
	speed: 0.1886s/iter; left time: 7676.9941s
	iters: 200, epoch: 14 | loss: 0.0560455
	speed: 0.0352s/iter; left time: 1430.3986s
	iters: 300, epoch: 14 | loss: 0.0208364
	speed: 0.0337s/iter; left time: 1365.2468s
	iters: 400, epoch: 14 | loss: 0.0226913
	speed: 0.0309s/iter; left time: 1247.6529s
Epoch: 14 cost time: 16.131528854370117
Epoch: 14, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0192171
	speed: 0.1895s/iter; left time: 7623.7227s
	iters: 200, epoch: 15 | loss: 0.0313410
	speed: 0.0272s/iter; left time: 1090.0553s
	iters: 300, epoch: 15 | loss: 0.0099165
	speed: 0.0305s/iter; left time: 1219.7783s
	iters: 400, epoch: 15 | loss: 0.0098344
	speed: 0.0347s/iter; left time: 1385.7535s
Epoch: 15 cost time: 15.825492143630981
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
Validation loss decreased (-0.965122 --> -0.965979).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0009061
	speed: 0.1811s/iter; left time: 7201.9168s
	iters: 200, epoch: 16 | loss: 0.0421299
	speed: 0.0317s/iter; left time: 1257.6374s
	iters: 300, epoch: 16 | loss: 0.0028743
	speed: 0.0354s/iter; left time: 1398.8347s
	iters: 400, epoch: 16 | loss: 0.0182469
	speed: 0.0385s/iter; left time: 1518.3168s
Epoch: 16 cost time: 16.211325883865356
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.966837).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1043973
	speed: 0.2142s/iter; left time: 8416.7299s
	iters: 200, epoch: 17 | loss: 0.7291094
	speed: 0.0419s/iter; left time: 1642.4886s
	iters: 300, epoch: 17 | loss: 0.1611449
	speed: 0.0323s/iter; left time: 1261.7263s
	iters: 400, epoch: 17 | loss: 0.0187185
	speed: 0.0346s/iter; left time: 1349.8784s
Epoch: 17 cost time: 17.231666803359985
Epoch: 17, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.966837 --> -0.974842).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0483191
	speed: 0.2142s/iter; left time: 8316.2029s
	iters: 200, epoch: 18 | loss: 0.0099704
	speed: 0.0337s/iter; left time: 1305.7125s
	iters: 300, epoch: 18 | loss: 0.0595514
	speed: 0.0328s/iter; left time: 1268.8412s
	iters: 400, epoch: 18 | loss: 0.0187938
	speed: 0.0329s/iter; left time: 1269.0069s
Epoch: 18 cost time: 16.62850832939148
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0701538
	speed: 0.2218s/iter; left time: 8506.6492s
	iters: 200, epoch: 19 | loss: 0.0020317
	speed: 0.0380s/iter; left time: 1452.5702s
	iters: 300, epoch: 19 | loss: 0.2282461
	speed: 0.0346s/iter; left time: 1320.6603s
	iters: 400, epoch: 19 | loss: 0.0181044
	speed: 0.0378s/iter; left time: 1439.9534s
Epoch: 19 cost time: 17.212704181671143
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1816227
	speed: 0.2469s/iter; left time: 9355.2264s
	iters: 200, epoch: 20 | loss: 0.0003983
	speed: 0.0430s/iter; left time: 1626.4648s
	iters: 300, epoch: 20 | loss: 0.0103919
	speed: 0.0325s/iter; left time: 1225.7241s
	iters: 400, epoch: 20 | loss: 0.0077066
	speed: 0.0332s/iter; left time: 1247.4435s
Epoch: 20 cost time: 18.494256019592285
Epoch: 20, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0044016
	speed: 0.2273s/iter; left time: 8504.2604s
	iters: 200, epoch: 21 | loss: 0.0125445
	speed: 0.0471s/iter; left time: 1757.1770s
	iters: 300, epoch: 21 | loss: 0.0068159
	speed: 0.0526s/iter; left time: 1958.0858s
	iters: 400, epoch: 21 | loss: 0.0596706
	speed: 0.0467s/iter; left time: 1734.2945s
Epoch: 21 cost time: 23.692026615142822
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0150451
	speed: 0.2733s/iter; left time: 10098.5440s
	iters: 200, epoch: 22 | loss: 0.0006505
	speed: 0.0444s/iter; left time: 1636.4331s
	iters: 300, epoch: 22 | loss: 0.0359779
	speed: 0.0468s/iter; left time: 1718.9439s
	iters: 400, epoch: 22 | loss: 0.0016476
	speed: 0.0530s/iter; left time: 1942.6045s
Epoch: 22 cost time: 23.382731199264526
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.276 Vali Acc: 0.932 Test Loss: 0.276 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2488266
	speed: 0.2743s/iter; left time: 10005.8024s
	iters: 200, epoch: 23 | loss: 0.1611733
	speed: 0.0448s/iter; left time: 1628.6001s
	iters: 300, epoch: 23 | loss: 0.0017841
	speed: 0.0416s/iter; left time: 1509.0708s
	iters: 400, epoch: 23 | loss: 0.0029705
	speed: 0.0459s/iter; left time: 1659.4057s
Epoch: 23 cost time: 20.922927379608154
Epoch: 23, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0045143
	speed: 0.2474s/iter; left time: 8909.6611s
	iters: 200, epoch: 24 | loss: 0.0043637
	speed: 0.0349s/iter; left time: 1252.0253s
	iters: 300, epoch: 24 | loss: 0.0146277
	speed: 0.0337s/iter; left time: 1206.2756s
	iters: 400, epoch: 24 | loss: 0.0026046
	speed: 0.0360s/iter; left time: 1284.3693s
Epoch: 24 cost time: 17.853068113327026
Epoch: 24, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0084149
	speed: 0.2275s/iter; left time: 8087.6183s
	iters: 200, epoch: 25 | loss: 0.0087281
	speed: 0.0381s/iter; left time: 1351.7413s
	iters: 300, epoch: 25 | loss: 0.0407179
	speed: 0.0351s/iter; left time: 1242.0970s
	iters: 400, epoch: 25 | loss: 0.0002230
	speed: 0.0395s/iter; left time: 1391.0278s
Epoch: 25 cost time: 19.038074731826782
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0294621
	speed: 0.2509s/iter; left time: 8802.1877s
	iters: 200, epoch: 26 | loss: 0.0020101
	speed: 0.0439s/iter; left time: 1536.9303s
	iters: 300, epoch: 26 | loss: 0.0060532
	speed: 0.0500s/iter; left time: 1744.9499s
	iters: 400, epoch: 26 | loss: 0.4585664
	speed: 0.0479s/iter; left time: 1666.6613s
Epoch: 26 cost time: 23.296603679656982
Epoch: 26, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0158341
	speed: 0.2549s/iter; left time: 8820.9708s
	iters: 200, epoch: 27 | loss: 0.0550853
	speed: 0.0446s/iter; left time: 1538.8120s
	iters: 300, epoch: 27 | loss: 0.0313331
	speed: 0.0414s/iter; left time: 1425.2857s
	iters: 400, epoch: 27 | loss: 0.0008273
	speed: 0.0405s/iter; left time: 1388.6338s
Epoch: 27 cost time: 20.59182572364807
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 1200290
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9368419
	speed: 0.0598s/iter; left time: 2798.0064s
	iters: 200, epoch: 1 | loss: 0.2299264
	speed: 0.0388s/iter; left time: 1812.2469s
	iters: 300, epoch: 1 | loss: 0.1479127
	speed: 0.0363s/iter; left time: 1693.4163s
	iters: 400, epoch: 1 | loss: 0.0773728
	speed: 0.0381s/iter; left time: 1769.6201s
Epoch: 1 cost time: 20.11952495574951
Epoch: 1, Steps: 469 | Train Loss: 0.642 Vali Loss: 0.221 Vali Acc: 0.929 Test Loss: 0.221 Test Acc: 0.929
Validation loss decreased (inf --> -0.928814).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0516520
	speed: 0.2039s/iter; left time: 9447.2371s
	iters: 200, epoch: 2 | loss: 0.0676810
	speed: 0.0412s/iter; left time: 1903.5193s
	iters: 300, epoch: 2 | loss: 0.1802841
	speed: 0.0398s/iter; left time: 1835.1384s
	iters: 400, epoch: 2 | loss: 0.1222333
	speed: 0.0309s/iter; left time: 1423.3603s
Epoch: 2 cost time: 18.008021354675293
Epoch: 2, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
Validation loss decreased (-0.928814 --> -0.955116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1619015
	speed: 0.1977s/iter; left time: 9067.8850s
	iters: 200, epoch: 3 | loss: 0.0690659
	speed: 0.0417s/iter; left time: 1910.3594s
	iters: 300, epoch: 3 | loss: 0.0928412
	speed: 0.0346s/iter; left time: 1581.8761s
	iters: 400, epoch: 3 | loss: 0.1473094
	speed: 0.0309s/iter; left time: 1407.4353s
Epoch: 3 cost time: 17.577009677886963
Epoch: 3, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.955116 --> -0.960262).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1307841
	speed: 0.2113s/iter; left time: 9592.1833s
	iters: 200, epoch: 4 | loss: 0.2322455
	speed: 0.0360s/iter; left time: 1629.1588s
	iters: 300, epoch: 4 | loss: 0.0144373
	speed: 0.0385s/iter; left time: 1740.8312s
	iters: 400, epoch: 4 | loss: 0.0198932
	speed: 0.0453s/iter; left time: 2043.7439s
Epoch: 4 cost time: 18.75441074371338
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.328 Vali Acc: 0.915 Test Loss: 0.328 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0185917
	speed: 0.2280s/iter; left time: 10243.6121s
	iters: 200, epoch: 5 | loss: 0.1649730
	speed: 0.0409s/iter; left time: 1835.2033s
	iters: 300, epoch: 5 | loss: 0.0033845
	speed: 0.0442s/iter; left time: 1978.2892s
	iters: 400, epoch: 5 | loss: 0.0195800
	speed: 0.0383s/iter; left time: 1708.8990s
Epoch: 5 cost time: 19.188469648361206
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.960262 --> -0.963406).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0485315
	speed: 0.2236s/iter; left time: 9939.8321s
	iters: 200, epoch: 6 | loss: 0.0063957
	speed: 0.0392s/iter; left time: 1737.9953s
	iters: 300, epoch: 6 | loss: 0.0272497
	speed: 0.0326s/iter; left time: 1441.9283s
	iters: 400, epoch: 6 | loss: 0.0083302
	speed: 0.0335s/iter; left time: 1477.7254s
Epoch: 6 cost time: 17.051565408706665
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0434996
	speed: 0.2252s/iter; left time: 9906.0763s
	iters: 200, epoch: 7 | loss: 0.0464080
	speed: 0.0380s/iter; left time: 1668.8613s
	iters: 300, epoch: 7 | loss: 0.0570751
	speed: 0.0317s/iter; left time: 1385.9490s
	iters: 400, epoch: 7 | loss: 0.0095026
	speed: 0.0347s/iter; left time: 1516.4228s
Epoch: 7 cost time: 16.69231414794922
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0198676
	speed: 0.1883s/iter; left time: 8192.6660s
	iters: 200, epoch: 8 | loss: 0.0106423
	speed: 0.0273s/iter; left time: 1185.9026s
	iters: 300, epoch: 8 | loss: 0.0022740
	speed: 0.0357s/iter; left time: 1544.3311s
	iters: 400, epoch: 8 | loss: 0.0319841
	speed: 0.0349s/iter; left time: 1506.3721s
Epoch: 8 cost time: 15.684575319290161
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.969124 --> -0.974556).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0010438
	speed: 0.1931s/iter; left time: 8312.4885s
	iters: 200, epoch: 9 | loss: 0.0038339
	speed: 0.0372s/iter; left time: 1599.4135s
	iters: 300, epoch: 9 | loss: 0.0028456
	speed: 0.0312s/iter; left time: 1335.3230s
	iters: 400, epoch: 9 | loss: 0.0068642
	speed: 0.0318s/iter; left time: 1359.0721s
Epoch: 9 cost time: 15.859232425689697
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0023948
	speed: 0.2167s/iter; left time: 9226.3764s
	iters: 200, epoch: 10 | loss: 0.0952189
	speed: 0.0330s/iter; left time: 1400.4540s
	iters: 300, epoch: 10 | loss: 0.0467063
	speed: 0.0343s/iter; left time: 1453.7656s
	iters: 400, epoch: 10 | loss: 0.1581168
	speed: 0.0280s/iter; left time: 1183.9452s
Epoch: 10 cost time: 15.928911924362183
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0130334
	speed: 0.2137s/iter; left time: 8999.0003s
	iters: 200, epoch: 11 | loss: 0.0052711
	speed: 0.0356s/iter; left time: 1497.3251s
	iters: 300, epoch: 11 | loss: 0.0071297
	speed: 0.0375s/iter; left time: 1571.0205s
	iters: 400, epoch: 11 | loss: 0.0071635
	speed: 0.0338s/iter; left time: 1411.6488s
Epoch: 11 cost time: 16.684868812561035
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0009359
	speed: 0.2221s/iter; left time: 9246.9197s
	iters: 200, epoch: 12 | loss: 0.0116377
	speed: 0.0336s/iter; left time: 1395.1236s
	iters: 300, epoch: 12 | loss: 0.0217618
	speed: 0.0351s/iter; left time: 1453.1843s
	iters: 400, epoch: 12 | loss: 0.0055524
	speed: 0.0333s/iter; left time: 1376.4539s
Epoch: 12 cost time: 16.77182102203369
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.196 Vali Acc: 0.945 Test Loss: 0.196 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0042221
	speed: 0.2097s/iter; left time: 8635.3662s
	iters: 200, epoch: 13 | loss: 0.0005009
	speed: 0.0312s/iter; left time: 1283.3632s
	iters: 300, epoch: 13 | loss: 0.2649879
	speed: 0.0355s/iter; left time: 1453.0516s
	iters: 400, epoch: 13 | loss: 0.3140735
	speed: 0.0352s/iter; left time: 1440.1069s
Epoch: 13 cost time: 17.05836319923401
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0171042
	speed: 0.2061s/iter; left time: 8390.7125s
	iters: 200, epoch: 14 | loss: 0.1756992
	speed: 0.0298s/iter; left time: 1210.3054s
	iters: 300, epoch: 14 | loss: 0.0929052
	speed: 0.0391s/iter; left time: 1583.2895s
	iters: 400, epoch: 14 | loss: 0.0127579
	speed: 0.0388s/iter; left time: 1566.8898s
Epoch: 14 cost time: 17.61854314804077
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0021932
	speed: 0.2144s/iter; left time: 8626.3659s
	iters: 200, epoch: 15 | loss: 0.0038935
	speed: 0.0311s/iter; left time: 1249.5466s
	iters: 300, epoch: 15 | loss: 0.1291262
	speed: 0.0321s/iter; left time: 1286.1950s
	iters: 400, epoch: 15 | loss: 0.1491712
	speed: 0.0345s/iter; left time: 1377.2438s
Epoch: 15 cost time: 16.096144914627075
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0033697
	speed: 0.2272s/iter; left time: 9035.9531s
	iters: 200, epoch: 16 | loss: 0.1276870
	speed: 0.0354s/iter; left time: 1405.1230s
	iters: 300, epoch: 16 | loss: 0.0022447
	speed: 0.0352s/iter; left time: 1391.0457s
	iters: 400, epoch: 16 | loss: 0.0045842
	speed: 0.0262s/iter; left time: 1034.0448s
Epoch: 16 cost time: 16.567554712295532
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0154202
	speed: 0.2238s/iter; left time: 8795.8582s
	iters: 200, epoch: 17 | loss: 0.0196856
	speed: 0.0331s/iter; left time: 1296.9301s
	iters: 300, epoch: 17 | loss: 0.0668847
	speed: 0.0371s/iter; left time: 1449.9460s
	iters: 400, epoch: 17 | loss: 0.0023283
	speed: 0.0308s/iter; left time: 1202.6645s
Epoch: 17 cost time: 17.10159659385681
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0147092
	speed: 0.2170s/iter; left time: 8427.4719s
	iters: 200, epoch: 18 | loss: 0.0061721
	speed: 0.0345s/iter; left time: 1337.6913s
	iters: 300, epoch: 18 | loss: 0.0447734
	speed: 0.0375s/iter; left time: 1449.2239s
	iters: 400, epoch: 18 | loss: 0.0131002
	speed: 0.0321s/iter; left time: 1238.2647s
Epoch: 18 cost time: 17.423057317733765
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 1200162
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8557115
	speed: 0.0593s/iter; left time: 2773.7904s
	iters: 200, epoch: 1 | loss: 0.4986372
	speed: 0.0414s/iter; left time: 1931.9371s
	iters: 300, epoch: 1 | loss: 0.1574543
	speed: 0.0393s/iter; left time: 1832.0465s
	iters: 400, epoch: 1 | loss: 0.2802052
	speed: 0.0369s/iter; left time: 1715.4735s
Epoch: 1 cost time: 20.63206672668457
Epoch: 1, Steps: 469 | Train Loss: 0.616 Vali Loss: 0.273 Vali Acc: 0.921 Test Loss: 0.273 Test Acc: 0.921
Validation loss decreased (inf --> -0.920809).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2464511
	speed: 0.2180s/iter; left time: 10101.6231s
	iters: 200, epoch: 2 | loss: 0.2388704
	speed: 0.0366s/iter; left time: 1692.1807s
	iters: 300, epoch: 2 | loss: 0.0511298
	speed: 0.0367s/iter; left time: 1693.2467s
	iters: 400, epoch: 2 | loss: 0.0541795
	speed: 0.0372s/iter; left time: 1711.9708s
Epoch: 2 cost time: 17.6701340675354
Epoch: 2, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.920809 --> -0.950256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1852573
	speed: 0.2265s/iter; left time: 10386.3959s
	iters: 200, epoch: 3 | loss: 0.0263121
	speed: 0.0436s/iter; left time: 1993.2427s
	iters: 300, epoch: 3 | loss: 0.0340887
	speed: 0.0370s/iter; left time: 1689.5979s
	iters: 400, epoch: 3 | loss: 0.0406340
	speed: 0.0402s/iter; left time: 1831.7601s
Epoch: 3 cost time: 20.318873405456543
Epoch: 3, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0037732
	speed: 0.2500s/iter; left time: 11347.5314s
	iters: 200, epoch: 4 | loss: 0.1027173
	speed: 0.0417s/iter; left time: 1886.7439s
	iters: 300, epoch: 4 | loss: 0.0104990
	speed: 0.0441s/iter; left time: 1991.5628s
	iters: 400, epoch: 4 | loss: 0.0154758
	speed: 0.0418s/iter; left time: 1885.0828s
Epoch: 4 cost time: 20.36353349685669
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.950256 --> -0.959118).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0300805
	speed: 0.2622s/iter; left time: 11780.0956s
	iters: 200, epoch: 5 | loss: 0.0221073
	speed: 0.0409s/iter; left time: 1831.2290s
	iters: 300, epoch: 5 | loss: 0.3049837
	speed: 0.0414s/iter; left time: 1849.8980s
	iters: 400, epoch: 5 | loss: 0.0052593
	speed: 0.0358s/iter; left time: 1595.4312s
Epoch: 5 cost time: 20.016782522201538
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
Validation loss decreased (-0.959118 --> -0.967409).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4476360
	speed: 0.2372s/iter; left time: 10544.2653s
	iters: 200, epoch: 6 | loss: 0.0247429
	speed: 0.0321s/iter; left time: 1422.8864s
	iters: 300, epoch: 6 | loss: 0.0098610
	speed: 0.0265s/iter; left time: 1173.2390s
	iters: 400, epoch: 6 | loss: 0.0347840
	speed: 0.0309s/iter; left time: 1366.3867s
Epoch: 6 cost time: 15.434178590774536
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3654387
	speed: 0.2019s/iter; left time: 8879.1975s
	iters: 200, epoch: 7 | loss: 0.0926221
	speed: 0.0357s/iter; left time: 1566.0518s
	iters: 300, epoch: 7 | loss: 0.0132279
	speed: 0.0420s/iter; left time: 1840.2330s
	iters: 400, epoch: 7 | loss: 0.0277802
	speed: 0.0406s/iter; left time: 1772.7278s
Epoch: 7 cost time: 18.859471797943115
Epoch: 7, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0021396
	speed: 0.2463s/iter; left time: 10719.7863s
	iters: 200, epoch: 8 | loss: 0.0248855
	speed: 0.0488s/iter; left time: 2118.9469s
	iters: 300, epoch: 8 | loss: 0.0841409
	speed: 0.0497s/iter; left time: 2151.1565s
	iters: 400, epoch: 8 | loss: 0.0048134
	speed: 0.0460s/iter; left time: 1989.4163s
Epoch: 8 cost time: 23.16503357887268
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0621153
	speed: 0.2587s/iter; left time: 11135.9247s
	iters: 200, epoch: 9 | loss: 0.0578859
	speed: 0.0458s/iter; left time: 1967.1097s
	iters: 300, epoch: 9 | loss: 0.0007961
	speed: 0.0412s/iter; left time: 1765.0786s
	iters: 400, epoch: 9 | loss: 0.0170087
	speed: 0.0385s/iter; left time: 1645.0846s
Epoch: 9 cost time: 19.923773765563965
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.967409 --> -0.972841).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0506930
	speed: 0.2057s/iter; left time: 8758.0646s
	iters: 200, epoch: 10 | loss: 0.0042079
	speed: 0.0396s/iter; left time: 1684.0006s
	iters: 300, epoch: 10 | loss: 0.0702763
	speed: 0.0406s/iter; left time: 1721.0744s
	iters: 400, epoch: 10 | loss: 0.0158418
	speed: 0.0369s/iter; left time: 1560.7488s
Epoch: 10 cost time: 19.13784098625183
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0102590
	speed: 0.2431s/iter; left time: 10235.1215s
	iters: 200, epoch: 11 | loss: 0.0049165
	speed: 0.0446s/iter; left time: 1874.7753s
	iters: 300, epoch: 11 | loss: 0.0327026
	speed: 0.0558s/iter; left time: 2337.1724s
	iters: 400, epoch: 11 | loss: 0.0387870
	speed: 0.0454s/iter; left time: 1899.8949s
Epoch: 11 cost time: 22.4926016330719
Epoch: 11, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0693862
	speed: 0.2374s/iter; left time: 9883.9932s
	iters: 200, epoch: 12 | loss: 0.0766652
	speed: 0.0341s/iter; left time: 1416.0267s
	iters: 300, epoch: 12 | loss: 0.0089062
	speed: 0.0393s/iter; left time: 1627.9446s
	iters: 400, epoch: 12 | loss: 0.5485611
	speed: 0.0386s/iter; left time: 1595.4001s
Epoch: 12 cost time: 17.866202354431152
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1236613
	speed: 0.2162s/iter; left time: 8900.3190s
	iters: 200, epoch: 13 | loss: 0.0010091
	speed: 0.0365s/iter; left time: 1497.8161s
	iters: 300, epoch: 13 | loss: 0.0261578
	speed: 0.0423s/iter; left time: 1733.3984s
	iters: 400, epoch: 13 | loss: 0.0050578
	speed: 0.0391s/iter; left time: 1597.3909s
Epoch: 13 cost time: 18.57752561569214
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.227 Vali Acc: 0.945 Test Loss: 0.227 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0485791
	speed: 0.2345s/iter; left time: 9543.2942s
	iters: 200, epoch: 14 | loss: 0.0342137
	speed: 0.0436s/iter; left time: 1772.0825s
	iters: 300, epoch: 14 | loss: 0.0267180
	speed: 0.0544s/iter; left time: 2201.6001s
	iters: 400, epoch: 14 | loss: 0.0024735
	speed: 0.0487s/iter; left time: 1968.4763s
Epoch: 14 cost time: 22.818300485610962
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0261314
	speed: 0.2610s/iter; left time: 10499.6472s
	iters: 200, epoch: 15 | loss: 0.2987538
	speed: 0.0456s/iter; left time: 1830.8714s
	iters: 300, epoch: 15 | loss: 0.0028152
	speed: 0.0365s/iter; left time: 1462.3950s
	iters: 400, epoch: 15 | loss: 0.0182944
	speed: 0.0495s/iter; left time: 1976.2727s
Epoch: 15 cost time: 21.064528942108154
Epoch: 15, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0115483
	speed: 0.2109s/iter; left time: 8385.2871s
	iters: 200, epoch: 16 | loss: 0.1873907
	speed: 0.0396s/iter; left time: 1572.1945s
	iters: 300, epoch: 16 | loss: 0.7066416
	speed: 0.0371s/iter; left time: 1469.2473s
	iters: 400, epoch: 16 | loss: 0.2453643
	speed: 0.0363s/iter; left time: 1432.1025s
Epoch: 16 cost time: 17.817275524139404
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1947750
	speed: 0.1971s/iter; left time: 7744.1271s
	iters: 200, epoch: 17 | loss: 0.0016779
	speed: 0.0312s/iter; left time: 1221.1922s
	iters: 300, epoch: 17 | loss: 0.0103834
	speed: 0.0388s/iter; left time: 1516.4456s
	iters: 400, epoch: 17 | loss: 0.2633705
	speed: 0.0342s/iter; left time: 1335.3410s
Epoch: 17 cost time: 16.46779775619507
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0016782
	speed: 0.2080s/iter; left time: 8076.0979s
	iters: 200, epoch: 18 | loss: 0.0181773
	speed: 0.0423s/iter; left time: 1638.8128s
	iters: 300, epoch: 18 | loss: 0.1061516
	speed: 0.0471s/iter; left time: 1818.4304s
	iters: 400, epoch: 18 | loss: 0.0079709
	speed: 0.0434s/iter; left time: 1670.9564s
Epoch: 18 cost time: 20.441781520843506
Epoch: 18, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0358840
	speed: 0.2546s/iter; left time: 9766.6701s
	iters: 200, epoch: 19 | loss: 0.0091732
	speed: 0.0465s/iter; left time: 1777.3327s
	iters: 300, epoch: 19 | loss: 0.0236139
	speed: 0.0487s/iter; left time: 1857.8672s
	iters: 400, epoch: 19 | loss: 0.0286985
	speed: 0.0416s/iter; left time: 1584.2525s
Epoch: 19 cost time: 21.498485565185547
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 1200034
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9785918
	speed: 0.0506s/iter; left time: 2366.8261s
	iters: 200, epoch: 1 | loss: 0.3343667
	speed: 0.0328s/iter; left time: 1533.4441s
	iters: 300, epoch: 1 | loss: 0.1523280
	speed: 0.0345s/iter; left time: 1608.5236s
	iters: 400, epoch: 1 | loss: 0.3024228
	speed: 0.0438s/iter; left time: 2037.4503s
Epoch: 1 cost time: 19.349135160446167
Epoch: 1, Steps: 469 | Train Loss: 0.668 Vali Loss: 0.312 Vali Acc: 0.923 Test Loss: 0.312 Test Acc: 0.923
Validation loss decreased (inf --> -0.923382).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0869616
	speed: 0.2328s/iter; left time: 10785.9950s
	iters: 200, epoch: 2 | loss: 0.1636629
	speed: 0.0386s/iter; left time: 1784.0564s
	iters: 300, epoch: 2 | loss: 0.0113759
	speed: 0.0389s/iter; left time: 1795.1916s
	iters: 400, epoch: 2 | loss: 0.1422309
	speed: 0.0486s/iter; left time: 2237.9008s
Epoch: 2 cost time: 19.84006690979004
Epoch: 2, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0690559
	speed: 0.2456s/iter; left time: 11263.7049s
	iters: 200, epoch: 3 | loss: 0.1093067
	speed: 0.0356s/iter; left time: 1631.4056s
	iters: 300, epoch: 3 | loss: 0.2761599
	speed: 0.0404s/iter; left time: 1844.0947s
	iters: 400, epoch: 3 | loss: 0.2151834
	speed: 0.0397s/iter; left time: 1809.0853s
Epoch: 3 cost time: 18.29364800453186
Epoch: 3, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
Validation loss decreased (-0.923382 --> -0.938820).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0498991
	speed: 0.2273s/iter; left time: 10317.6725s
	iters: 200, epoch: 4 | loss: 0.2226449
	speed: 0.0301s/iter; left time: 1361.6364s
	iters: 300, epoch: 4 | loss: 0.1462086
	speed: 0.0290s/iter; left time: 1308.8136s
	iters: 400, epoch: 4 | loss: 0.0793412
	speed: 0.0286s/iter; left time: 1291.2773s
Epoch: 4 cost time: 14.624515295028687
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
Validation loss decreased (-0.938820 --> -0.965979).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0091661
	speed: 0.2272s/iter; left time: 10207.5287s
	iters: 200, epoch: 5 | loss: 0.0110046
	speed: 0.0354s/iter; left time: 1587.6433s
	iters: 300, epoch: 5 | loss: 0.0405587
	speed: 0.0390s/iter; left time: 1742.8622s
	iters: 400, epoch: 5 | loss: 0.1036620
	speed: 0.0346s/iter; left time: 1545.9029s
Epoch: 5 cost time: 17.62407422065735
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.223 Vali Acc: 0.936 Test Loss: 0.223 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0147888
	speed: 0.2642s/iter; left time: 11745.2283s
	iters: 200, epoch: 6 | loss: 0.2203055
	speed: 0.0393s/iter; left time: 1741.4293s
	iters: 300, epoch: 6 | loss: 0.1399814
	speed: 0.0373s/iter; left time: 1650.0785s
	iters: 400, epoch: 6 | loss: 0.2696375
	speed: 0.0363s/iter; left time: 1602.7782s
Epoch: 6 cost time: 19.01968479156494
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0157197
	speed: 0.2504s/iter; left time: 11012.6194s
	iters: 200, epoch: 7 | loss: 0.0390503
	speed: 0.0362s/iter; left time: 1588.9020s
	iters: 300, epoch: 7 | loss: 0.1317547
	speed: 0.0308s/iter; left time: 1346.6416s
	iters: 400, epoch: 7 | loss: 0.0359295
	speed: 0.0307s/iter; left time: 1341.7469s
Epoch: 7 cost time: 16.391019105911255
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0222215
	speed: 0.2501s/iter; left time: 10883.6739s
	iters: 200, epoch: 8 | loss: 0.0367098
	speed: 0.0356s/iter; left time: 1545.0019s
	iters: 300, epoch: 8 | loss: 0.1000351
	speed: 0.0402s/iter; left time: 1741.8111s
	iters: 400, epoch: 8 | loss: 0.0152076
	speed: 0.0328s/iter; left time: 1415.9750s
Epoch: 8 cost time: 18.12658166885376
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0051977
	speed: 0.1915s/iter; left time: 8242.9491s
	iters: 200, epoch: 9 | loss: 0.0144221
	speed: 0.0306s/iter; left time: 1312.5350s
	iters: 300, epoch: 9 | loss: 0.2228104
	speed: 0.0286s/iter; left time: 1225.0793s
	iters: 400, epoch: 9 | loss: 0.0023990
	speed: 0.0353s/iter; left time: 1506.9185s
Epoch: 9 cost time: 16.232532262802124
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0036411
	speed: 0.2128s/iter; left time: 9061.4117s
	iters: 200, epoch: 10 | loss: 0.0178803
	speed: 0.0317s/iter; left time: 1346.3935s
	iters: 300, epoch: 10 | loss: 0.0363695
	speed: 0.0393s/iter; left time: 1666.5000s
	iters: 400, epoch: 10 | loss: 0.0314074
	speed: 0.0388s/iter; left time: 1640.0628s
Epoch: 10 cost time: 17.9168918132782
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.279 Vali Acc: 0.934 Test Loss: 0.279 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0019247
	speed: 0.2404s/iter; left time: 10121.7658s
	iters: 200, epoch: 11 | loss: 0.0016701
	speed: 0.0360s/iter; left time: 1512.5367s
	iters: 300, epoch: 11 | loss: 0.0008939
	speed: 0.0401s/iter; left time: 1682.6957s
	iters: 400, epoch: 11 | loss: 0.2137559
	speed: 0.0479s/iter; left time: 2003.0298s
Epoch: 11 cost time: 19.224790334701538
Epoch: 11, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0601204
	speed: 0.2509s/iter; left time: 10447.3383s
	iters: 200, epoch: 12 | loss: 0.0953187
	speed: 0.0406s/iter; left time: 1687.6447s
	iters: 300, epoch: 12 | loss: 0.0076803
	speed: 0.0387s/iter; left time: 1604.7052s
	iters: 400, epoch: 12 | loss: 0.0286549
	speed: 0.0386s/iter; left time: 1594.3230s
Epoch: 12 cost time: 19.228963375091553
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0040275
	speed: 0.2254s/iter; left time: 9279.3196s
	iters: 200, epoch: 13 | loss: 0.0521433
	speed: 0.0433s/iter; left time: 1779.4798s
	iters: 300, epoch: 13 | loss: 0.0579728
	speed: 0.0361s/iter; left time: 1480.4255s
	iters: 400, epoch: 13 | loss: 0.3037173
	speed: 0.0415s/iter; left time: 1696.3040s
Epoch: 13 cost time: 20.179651260375977
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0026069
	speed: 0.2243s/iter; left time: 9131.2316s
	iters: 200, epoch: 14 | loss: 0.0070139
	speed: 0.0360s/iter; left time: 1461.5638s
	iters: 300, epoch: 14 | loss: 0.0160561
	speed: 0.0374s/iter; left time: 1514.6162s
	iters: 400, epoch: 14 | loss: 0.0089876
	speed: 0.0381s/iter; left time: 1539.1912s
Epoch: 14 cost time: 17.800447463989258
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.965980560320183
model parameter : 1003042
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2622095
	speed: 0.0588s/iter; left time: 2750.0666s
	iters: 200, epoch: 1 | loss: 0.6719326
	speed: 0.0347s/iter; left time: 1619.7745s
	iters: 300, epoch: 1 | loss: 0.2035793
	speed: 0.0314s/iter; left time: 1461.0893s
	iters: 400, epoch: 1 | loss: 0.0898864
	speed: 0.0302s/iter; left time: 1404.1901s
Epoch: 1 cost time: 17.653066635131836
Epoch: 1, Steps: 469 | Train Loss: 0.699 Vali Loss: 0.308 Vali Acc: 0.897 Test Loss: 0.308 Test Acc: 0.897
Validation loss decreased (inf --> -0.897081).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3059309
	speed: 0.2040s/iter; left time: 9451.6976s
	iters: 200, epoch: 2 | loss: 0.0793331
	speed: 0.0278s/iter; left time: 1283.7500s
	iters: 300, epoch: 2 | loss: 0.0524952
	speed: 0.0278s/iter; left time: 1280.6626s
	iters: 400, epoch: 2 | loss: 0.2819825
	speed: 0.0309s/iter; left time: 1420.8149s
Epoch: 2 cost time: 14.26828145980835
Epoch: 2, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.897081 --> -0.952256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1044462
	speed: 0.1820s/iter; left time: 8347.6130s
	iters: 200, epoch: 3 | loss: 0.0529466
	speed: 0.0356s/iter; left time: 1630.7658s
	iters: 300, epoch: 3 | loss: 0.0278657
	speed: 0.0358s/iter; left time: 1633.4872s
	iters: 400, epoch: 3 | loss: 0.2748604
	speed: 0.0322s/iter; left time: 1465.8901s
Epoch: 3 cost time: 16.40438199043274
Epoch: 3, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
Validation loss decreased (-0.952256 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1663495
	speed: 0.2060s/iter; left time: 9351.1912s
	iters: 200, epoch: 4 | loss: 0.0610377
	speed: 0.0414s/iter; left time: 1876.2437s
	iters: 300, epoch: 4 | loss: 0.0655276
	speed: 0.0303s/iter; left time: 1368.5768s
	iters: 400, epoch: 4 | loss: 0.1069123
	speed: 0.0291s/iter; left time: 1311.6996s
Epoch: 4 cost time: 16.794583082199097
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0620413
	speed: 0.2033s/iter; left time: 9132.7846s
	iters: 200, epoch: 5 | loss: 0.0183407
	speed: 0.0328s/iter; left time: 1469.0435s
	iters: 300, epoch: 5 | loss: 0.0227122
	speed: 0.0245s/iter; left time: 1097.1173s
	iters: 400, epoch: 5 | loss: 0.0090424
	speed: 0.0278s/iter; left time: 1240.0787s
Epoch: 5 cost time: 14.339937448501587
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.204 Vali Acc: 0.936 Test Loss: 0.204 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0459798
	speed: 0.1535s/iter; left time: 6825.9541s
	iters: 200, epoch: 6 | loss: 0.2177647
	speed: 0.0298s/iter; left time: 1320.1406s
	iters: 300, epoch: 6 | loss: 0.0044669
	speed: 0.0298s/iter; left time: 1319.5645s
	iters: 400, epoch: 6 | loss: 0.0048547
	speed: 0.0311s/iter; left time: 1375.0420s
Epoch: 6 cost time: 14.519353151321411
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0635359
	speed: 0.1886s/iter; left time: 8295.1459s
	iters: 200, epoch: 7 | loss: 0.0007413
	speed: 0.0400s/iter; left time: 1757.4383s
	iters: 300, epoch: 7 | loss: 0.0112189
	speed: 0.0353s/iter; left time: 1545.5552s
	iters: 400, epoch: 7 | loss: 0.0798727
	speed: 0.0326s/iter; left time: 1422.6749s
Epoch: 7 cost time: 17.155616521835327
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0098007
	speed: 0.1949s/iter; left time: 8480.1374s
	iters: 200, epoch: 8 | loss: 0.1023409
	speed: 0.0341s/iter; left time: 1482.2840s
	iters: 300, epoch: 8 | loss: 0.0044488
	speed: 0.0376s/iter; left time: 1630.4243s
	iters: 400, epoch: 8 | loss: 0.0028606
	speed: 0.0400s/iter; left time: 1730.3705s
Epoch: 8 cost time: 17.560063362121582
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0069855
	speed: 0.2241s/iter; left time: 9646.5733s
	iters: 200, epoch: 9 | loss: 0.0068383
	speed: 0.0391s/iter; left time: 1677.1895s
	iters: 300, epoch: 9 | loss: 0.0236342
	speed: 0.0435s/iter; left time: 1864.6716s
	iters: 400, epoch: 9 | loss: 0.0148347
	speed: 0.0374s/iter; left time: 1599.6675s
Epoch: 9 cost time: 18.686867713928223
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0103865
	speed: 0.1918s/iter; left time: 8168.9227s
	iters: 200, epoch: 10 | loss: 0.0038453
	speed: 0.0329s/iter; left time: 1397.4608s
	iters: 300, epoch: 10 | loss: 0.0095492
	speed: 0.0285s/iter; left time: 1209.9208s
	iters: 400, epoch: 10 | loss: 0.0176270
	speed: 0.0325s/iter; left time: 1372.5524s
Epoch: 10 cost time: 15.693873643875122
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1345458
	speed: 0.1904s/iter; left time: 8016.1729s
	iters: 200, epoch: 11 | loss: 0.0161191
	speed: 0.0330s/iter; left time: 1387.4301s
	iters: 300, epoch: 11 | loss: 0.0447505
	speed: 0.0344s/iter; left time: 1443.3481s
	iters: 400, epoch: 11 | loss: 0.0027422
	speed: 0.0390s/iter; left time: 1632.5016s
Epoch: 11 cost time: 16.847214460372925
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1996987
	speed: 0.1808s/iter; left time: 7527.3622s
	iters: 200, epoch: 12 | loss: 0.0026948
	speed: 0.0308s/iter; left time: 1279.9916s
	iters: 300, epoch: 12 | loss: 0.0299484
	speed: 0.0332s/iter; left time: 1377.9324s
	iters: 400, epoch: 12 | loss: 0.2056454
	speed: 0.0326s/iter; left time: 1347.9126s
Epoch: 12 cost time: 15.458723545074463
Epoch: 12, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
Validation loss decreased (-0.961405 --> -0.965693).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0064635
	speed: 0.2076s/iter; left time: 8546.0961s
	iters: 200, epoch: 13 | loss: 0.0083725
	speed: 0.0335s/iter; left time: 1374.8366s
	iters: 300, epoch: 13 | loss: 0.0452496
	speed: 0.0384s/iter; left time: 1572.6895s
	iters: 400, epoch: 13 | loss: 0.0714886
	speed: 0.0381s/iter; left time: 1555.2231s
Epoch: 13 cost time: 17.190186262130737
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0844079
	speed: 0.1993s/iter; left time: 8114.1624s
	iters: 200, epoch: 14 | loss: 0.0255095
	speed: 0.0392s/iter; left time: 1593.5153s
	iters: 300, epoch: 14 | loss: 0.0939399
	speed: 0.0333s/iter; left time: 1347.4153s
	iters: 400, epoch: 14 | loss: 0.0023842
	speed: 0.0268s/iter; left time: 1083.0813s
Epoch: 14 cost time: 15.651145696640015
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1746960
	speed: 0.1845s/iter; left time: 7421.8816s
	iters: 200, epoch: 15 | loss: 0.0152690
	speed: 0.0342s/iter; left time: 1373.8418s
	iters: 300, epoch: 15 | loss: 0.4910741
	speed: 0.0420s/iter; left time: 1681.3982s
	iters: 400, epoch: 15 | loss: 0.1254117
	speed: 0.0390s/iter; left time: 1558.0118s
Epoch: 15 cost time: 18.065985918045044
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0091994
	speed: 0.1813s/iter; left time: 7210.4250s
	iters: 200, epoch: 16 | loss: 0.0420224
	speed: 0.0361s/iter; left time: 1430.2935s
	iters: 300, epoch: 16 | loss: 0.0024466
	speed: 0.0407s/iter; left time: 1608.9838s
	iters: 400, epoch: 16 | loss: 0.0130881
	speed: 0.0316s/iter; left time: 1246.1524s
Epoch: 16 cost time: 16.54794979095459
Epoch: 16, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0209471
	speed: 0.1806s/iter; left time: 7095.3753s
	iters: 200, epoch: 17 | loss: 0.0511057
	speed: 0.0324s/iter; left time: 1270.2303s
	iters: 300, epoch: 17 | loss: 0.0407926
	speed: 0.0323s/iter; left time: 1262.3112s
	iters: 400, epoch: 17 | loss: 0.0025602
	speed: 0.0308s/iter; left time: 1201.1721s
Epoch: 17 cost time: 16.251598834991455
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0025973
	speed: 0.1869s/iter; left time: 7255.3045s
	iters: 200, epoch: 18 | loss: 0.0008344
	speed: 0.0327s/iter; left time: 1268.0368s
	iters: 300, epoch: 18 | loss: 0.0237863
	speed: 0.0327s/iter; left time: 1262.0107s
	iters: 400, epoch: 18 | loss: 0.0328627
	speed: 0.0318s/iter; left time: 1226.2020s
Epoch: 18 cost time: 15.653905630111694
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.966837).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0055549
	speed: 0.1704s/iter; left time: 6535.0165s
	iters: 200, epoch: 19 | loss: 0.0169433
	speed: 0.0280s/iter; left time: 1072.4913s
	iters: 300, epoch: 19 | loss: 0.3753673
	speed: 0.0352s/iter; left time: 1342.6844s
	iters: 400, epoch: 19 | loss: 0.3411821
	speed: 0.0314s/iter; left time: 1196.4664s
Epoch: 19 cost time: 15.261254072189331
Epoch: 19, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4731371
	speed: 0.1900s/iter; left time: 7198.1622s
	iters: 200, epoch: 20 | loss: 0.0237510
	speed: 0.0309s/iter; left time: 1166.0120s
	iters: 300, epoch: 20 | loss: 0.0123640
	speed: 0.0325s/iter; left time: 1223.8602s
	iters: 400, epoch: 20 | loss: 0.0008270
	speed: 0.0358s/iter; left time: 1345.8279s
Epoch: 20 cost time: 15.693485260009766
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0040095
	speed: 0.1929s/iter; left time: 7217.4219s
	iters: 200, epoch: 21 | loss: 0.0287448
	speed: 0.0377s/iter; left time: 1406.6355s
	iters: 300, epoch: 21 | loss: 0.0151133
	speed: 0.0330s/iter; left time: 1229.7836s
	iters: 400, epoch: 21 | loss: 0.0186775
	speed: 0.0302s/iter; left time: 1120.2046s
Epoch: 21 cost time: 15.852223634719849
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.216 Vali Acc: 0.947 Test Loss: 0.216 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0042665
	speed: 0.1775s/iter; left time: 6558.8344s
	iters: 200, epoch: 22 | loss: 0.0017023
	speed: 0.0306s/iter; left time: 1128.1905s
	iters: 300, epoch: 22 | loss: 0.0197956
	speed: 0.0280s/iter; left time: 1029.6967s
	iters: 400, epoch: 22 | loss: 0.4382950
	speed: 0.0286s/iter; left time: 1046.7131s
Epoch: 22 cost time: 13.98590636253357
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.266 Vali Acc: 0.939 Test Loss: 0.266 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0045899
	speed: 0.1491s/iter; left time: 5438.4779s
	iters: 200, epoch: 23 | loss: 0.0036316
	speed: 0.0284s/iter; left time: 1033.0707s
	iters: 300, epoch: 23 | loss: 0.0065925
	speed: 0.0278s/iter; left time: 1010.2346s
	iters: 400, epoch: 23 | loss: 0.0179982
	speed: 0.0264s/iter; left time: 954.3250s
Epoch: 23 cost time: 13.067756652832031
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0145543
	speed: 0.1566s/iter; left time: 5638.4765s
	iters: 200, epoch: 24 | loss: 0.2144560
	speed: 0.0305s/iter; left time: 1095.9963s
	iters: 300, epoch: 24 | loss: 0.0056233
	speed: 0.0371s/iter; left time: 1327.4218s
	iters: 400, epoch: 24 | loss: 0.0009997
	speed: 0.0360s/iter; left time: 1285.2351s
Epoch: 24 cost time: 16.596030950546265
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0908859
	speed: 0.1813s/iter; left time: 6445.7317s
	iters: 200, epoch: 25 | loss: 0.0019015
	speed: 0.0290s/iter; left time: 1028.8161s
	iters: 300, epoch: 25 | loss: 0.0008480
	speed: 0.0344s/iter; left time: 1217.5751s
	iters: 400, epoch: 25 | loss: 0.0062591
	speed: 0.0367s/iter; left time: 1291.9728s
Epoch: 25 cost time: 15.622197389602661
Epoch: 25, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.966837 --> -0.968266).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0007845
	speed: 0.1615s/iter; left time: 5665.4399s
	iters: 200, epoch: 26 | loss: 0.0005430
	speed: 0.0286s/iter; left time: 1000.3123s
	iters: 300, epoch: 26 | loss: 0.0113980
	speed: 0.0256s/iter; left time: 891.0997s
	iters: 400, epoch: 26 | loss: 0.0198336
	speed: 0.0310s/iter; left time: 1079.2819s
Epoch: 26 cost time: 14.05456829071045
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0691406
	speed: 0.1754s/iter; left time: 6070.3343s
	iters: 200, epoch: 27 | loss: 0.0063903
	speed: 0.0310s/iter; left time: 1071.4205s
	iters: 300, epoch: 27 | loss: 0.0852901
	speed: 0.0275s/iter; left time: 946.7572s
	iters: 400, epoch: 27 | loss: 0.1083615
	speed: 0.0246s/iter; left time: 844.6453s
Epoch: 27 cost time: 14.623531818389893
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2440077
	speed: 0.1596s/iter; left time: 5447.4834s
	iters: 200, epoch: 28 | loss: 0.0007301
	speed: 0.0263s/iter; left time: 895.7906s
	iters: 300, epoch: 28 | loss: 0.0051999
	speed: 0.0252s/iter; left time: 854.9492s
	iters: 400, epoch: 28 | loss: 0.0064231
	speed: 0.0290s/iter; left time: 980.7357s
Epoch: 28 cost time: 12.532570362091064
Epoch: 28, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0199035
	speed: 0.1518s/iter; left time: 5109.3299s
	iters: 200, epoch: 29 | loss: 0.1315467
	speed: 0.0281s/iter; left time: 942.5629s
	iters: 300, epoch: 29 | loss: 0.3658635
	speed: 0.0259s/iter; left time: 867.7374s
	iters: 400, epoch: 29 | loss: 0.0975656
	speed: 0.0260s/iter; left time: 869.1662s
Epoch: 29 cost time: 13.102420568466187
Epoch: 29, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0003820
	speed: 0.1518s/iter; left time: 5040.9473s
	iters: 200, epoch: 30 | loss: 0.0012295
	speed: 0.0356s/iter; left time: 1176.9988s
	iters: 300, epoch: 30 | loss: 0.0019156
	speed: 0.0355s/iter; left time: 1170.0957s
	iters: 400, epoch: 30 | loss: 0.0004413
	speed: 0.0360s/iter; left time: 1185.1911s
Epoch: 30 cost time: 16.640364170074463
Epoch: 30, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0007193
	speed: 0.1647s/iter; left time: 5392.0775s
	iters: 200, epoch: 31 | loss: 0.0222591
	speed: 0.0282s/iter; left time: 920.3751s
	iters: 300, epoch: 31 | loss: 0.1150820
	speed: 0.0257s/iter; left time: 835.7107s
	iters: 400, epoch: 31 | loss: 0.0367096
	speed: 0.0271s/iter; left time: 880.3008s
Epoch: 31 cost time: 13.177857398986816
Epoch: 31, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0007424
	speed: 0.1689s/iter; left time: 5450.1488s
	iters: 200, epoch: 32 | loss: 0.0034506
	speed: 0.0299s/iter; left time: 962.0558s
	iters: 300, epoch: 32 | loss: 0.0029522
	speed: 0.0290s/iter; left time: 930.1516s
	iters: 400, epoch: 32 | loss: 0.0408017
	speed: 0.0325s/iter; left time: 1038.4177s
Epoch: 32 cost time: 15.300984859466553
Epoch: 32, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0049889
	speed: 0.1964s/iter; left time: 6245.2812s
	iters: 200, epoch: 33 | loss: 0.0130288
	speed: 0.0332s/iter; left time: 1051.1548s
	iters: 300, epoch: 33 | loss: 0.0008018
	speed: 0.0349s/iter; left time: 1101.0871s
	iters: 400, epoch: 33 | loss: 0.0008608
	speed: 0.0313s/iter; left time: 985.4357s
Epoch: 33 cost time: 16.23247194290161
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0140101
	speed: 0.1612s/iter; left time: 5049.8081s
	iters: 200, epoch: 34 | loss: 0.0010152
	speed: 0.0257s/iter; left time: 801.5132s
	iters: 300, epoch: 34 | loss: 0.0005422
	speed: 0.0302s/iter; left time: 939.8618s
	iters: 400, epoch: 34 | loss: 0.0064606
	speed: 0.0315s/iter; left time: 978.0501s
Epoch: 34 cost time: 13.610251426696777
Epoch: 34, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.968266 --> -0.970553).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0801416
	speed: 0.1732s/iter; left time: 5345.3382s
	iters: 200, epoch: 35 | loss: 0.0034848
	speed: 0.0248s/iter; left time: 761.6933s
	iters: 300, epoch: 35 | loss: 0.0050715
	speed: 0.0276s/iter; left time: 847.5802s
	iters: 400, epoch: 35 | loss: 0.3059982
	speed: 0.0245s/iter; left time: 747.1023s
Epoch: 35 cost time: 13.005336999893188
Epoch: 35, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0003372
	speed: 0.1692s/iter; left time: 5142.3153s
	iters: 200, epoch: 36 | loss: 0.0051655
	speed: 0.0300s/iter; left time: 907.3225s
	iters: 300, epoch: 36 | loss: 0.0004530
	speed: 0.0269s/iter; left time: 811.0724s
	iters: 400, epoch: 36 | loss: 0.0184735
	speed: 0.0286s/iter; left time: 859.3755s
Epoch: 36 cost time: 14.210755109786987
Epoch: 36, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.970553 --> -0.972269).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0085256
	speed: 0.1727s/iter; left time: 5167.9337s
	iters: 200, epoch: 37 | loss: 0.0108148
	speed: 0.0300s/iter; left time: 895.6963s
	iters: 300, epoch: 37 | loss: 0.0230353
	speed: 0.0287s/iter; left time: 853.1196s
	iters: 400, epoch: 37 | loss: 0.0050121
	speed: 0.0274s/iter; left time: 810.6766s
Epoch: 37 cost time: 14.439903736114502
Epoch: 37, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0022382
	speed: 0.2048s/iter; left time: 6031.1700s
	iters: 200, epoch: 38 | loss: 0.0029087
	speed: 0.0274s/iter; left time: 804.2343s
	iters: 300, epoch: 38 | loss: 0.0012851
	speed: 0.0274s/iter; left time: 802.1992s
	iters: 400, epoch: 38 | loss: 0.1237958
	speed: 0.0273s/iter; left time: 795.9018s
Epoch: 38 cost time: 14.080693006515503
Epoch: 38, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0039950
	speed: 0.1881s/iter; left time: 5450.3402s
	iters: 200, epoch: 39 | loss: 0.0007264
	speed: 0.0310s/iter; left time: 896.4944s
	iters: 300, epoch: 39 | loss: 0.0232798
	speed: 0.0280s/iter; left time: 807.1254s
	iters: 400, epoch: 39 | loss: 0.0346191
	speed: 0.0280s/iter; left time: 803.7243s
Epoch: 39 cost time: 14.680899620056152
Epoch: 39, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0150216
	speed: 0.1756s/iter; left time: 5006.3784s
	iters: 200, epoch: 40 | loss: 0.0017644
	speed: 0.0239s/iter; left time: 677.9241s
	iters: 300, epoch: 40 | loss: 0.0043774
	speed: 0.0281s/iter; left time: 796.9175s
	iters: 400, epoch: 40 | loss: 0.1078979
	speed: 0.0260s/iter; left time: 732.7392s
Epoch: 40 cost time: 12.611731767654419
Epoch: 40, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0006600
	speed: 0.1448s/iter; left time: 4061.6751s
	iters: 200, epoch: 41 | loss: 0.0005701
	speed: 0.0263s/iter; left time: 733.8428s
	iters: 300, epoch: 41 | loss: 0.0022624
	speed: 0.0279s/iter; left time: 775.6215s
	iters: 400, epoch: 41 | loss: 0.0524613
	speed: 0.0279s/iter; left time: 773.3788s
Epoch: 41 cost time: 12.96424412727356
Epoch: 41, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0251797
	speed: 0.1632s/iter; left time: 4501.0514s
	iters: 200, epoch: 42 | loss: 0.0040956
	speed: 0.0300s/iter; left time: 823.2593s
	iters: 300, epoch: 42 | loss: 0.0033670
	speed: 0.0295s/iter; left time: 808.5271s
	iters: 400, epoch: 42 | loss: 0.0075356
	speed: 0.0308s/iter; left time: 839.6613s
Epoch: 42 cost time: 14.500511646270752
Epoch: 42, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0037573
	speed: 0.1781s/iter; left time: 4826.3864s
	iters: 200, epoch: 43 | loss: 0.0022911
	speed: 0.0354s/iter; left time: 957.1718s
	iters: 300, epoch: 43 | loss: 0.0081950
	speed: 0.0313s/iter; left time: 843.0850s
	iters: 400, epoch: 43 | loss: 0.0041029
	speed: 0.0342s/iter; left time: 916.1397s
Epoch: 43 cost time: 15.888644218444824
Epoch: 43, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0268663
	speed: 0.1605s/iter; left time: 4274.8889s
	iters: 200, epoch: 44 | loss: 0.0012191
	speed: 0.0281s/iter; left time: 744.9122s
	iters: 300, epoch: 44 | loss: 0.0852343
	speed: 0.0294s/iter; left time: 778.4314s
	iters: 400, epoch: 44 | loss: 0.0002908
	speed: 0.0271s/iter; left time: 714.0030s
Epoch: 44 cost time: 13.513374328613281
Epoch: 44, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0030333
	speed: 0.1850s/iter; left time: 4839.7757s
	iters: 200, epoch: 45 | loss: 0.0090462
	speed: 0.0324s/iter; left time: 843.5787s
	iters: 300, epoch: 45 | loss: 0.0003395
	speed: 0.0298s/iter; left time: 772.9278s
	iters: 400, epoch: 45 | loss: 0.0003159
	speed: 0.0307s/iter; left time: 794.1762s
Epoch: 45 cost time: 14.77895712852478
Epoch: 45, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0003978
	speed: 0.1690s/iter; left time: 4343.0322s
	iters: 200, epoch: 46 | loss: 0.0010319
	speed: 0.0290s/iter; left time: 743.1157s
	iters: 300, epoch: 46 | loss: 0.0380982
	speed: 0.0356s/iter; left time: 908.0782s
	iters: 400, epoch: 46 | loss: 0.0147920
	speed: 0.0301s/iter; left time: 765.5779s
Epoch: 46 cost time: 14.632249116897583
Epoch: 46, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9722698684962836
model parameter : 1002914
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2372289
	speed: 0.0424s/iter; left time: 1986.4537s
	iters: 200, epoch: 1 | loss: 0.4803252
	speed: 0.0253s/iter; left time: 1180.8319s
	iters: 300, epoch: 1 | loss: 0.2924928
	speed: 0.0281s/iter; left time: 1311.2544s
	iters: 400, epoch: 1 | loss: 0.2338414
	speed: 0.0316s/iter; left time: 1470.4149s
Epoch: 1 cost time: 15.497555255889893
Epoch: 1, Steps: 469 | Train Loss: 0.667 Vali Loss: 0.252 Vali Acc: 0.927 Test Loss: 0.252 Test Acc: 0.927
Validation loss decreased (inf --> -0.926813).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0634686
	speed: 0.1846s/iter; left time: 8551.1852s
	iters: 200, epoch: 2 | loss: 0.0585454
	speed: 0.0345s/iter; left time: 1594.5811s
	iters: 300, epoch: 2 | loss: 0.3361242
	speed: 0.0312s/iter; left time: 1440.1457s
	iters: 400, epoch: 2 | loss: 0.2047791
	speed: 0.0355s/iter; left time: 1631.9283s
Epoch: 2 cost time: 16.399149417877197
Epoch: 2, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.926813 --> -0.953972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1070663
	speed: 0.1829s/iter; left time: 8387.6999s
	iters: 200, epoch: 3 | loss: 0.0788136
	speed: 0.0310s/iter; left time: 1417.0934s
	iters: 300, epoch: 3 | loss: 0.0374601
	speed: 0.0335s/iter; left time: 1530.6843s
	iters: 400, epoch: 3 | loss: 0.1047664
	speed: 0.0310s/iter; left time: 1414.3866s
Epoch: 3 cost time: 14.959743976593018
Epoch: 3, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.953972 --> -0.956259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0302045
	speed: 0.1643s/iter; left time: 7459.6569s
	iters: 200, epoch: 4 | loss: 0.0151305
	speed: 0.0287s/iter; left time: 1302.1398s
	iters: 300, epoch: 4 | loss: 0.0554749
	speed: 0.0314s/iter; left time: 1418.6789s
	iters: 400, epoch: 4 | loss: 0.0758174
	speed: 0.0256s/iter; left time: 1155.1194s
Epoch: 4 cost time: 13.771989583969116
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1409153
	speed: 0.1694s/iter; left time: 7611.7845s
	iters: 200, epoch: 5 | loss: 0.0109937
	speed: 0.0262s/iter; left time: 1173.0608s
	iters: 300, epoch: 5 | loss: 0.1195501
	speed: 0.0217s/iter; left time: 972.7453s
	iters: 400, epoch: 5 | loss: 0.0030954
	speed: 0.0260s/iter; left time: 1159.0563s
Epoch: 5 cost time: 12.30882978439331
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.956259 --> -0.971411).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0546847
	speed: 0.1588s/iter; left time: 7059.3549s
	iters: 200, epoch: 6 | loss: 0.1000683
	speed: 0.0283s/iter; left time: 1255.1007s
	iters: 300, epoch: 6 | loss: 0.0058071
	speed: 0.0345s/iter; left time: 1526.0791s
	iters: 400, epoch: 6 | loss: 0.1057909
	speed: 0.0333s/iter; left time: 1469.1269s
Epoch: 6 cost time: 14.748061180114746
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0450045
	speed: 0.1712s/iter; left time: 7531.8848s
	iters: 200, epoch: 7 | loss: 0.0042826
	speed: 0.0238s/iter; left time: 1045.1000s
	iters: 300, epoch: 7 | loss: 0.0702483
	speed: 0.0255s/iter; left time: 1117.5830s
	iters: 400, epoch: 7 | loss: 0.0065798
	speed: 0.0301s/iter; left time: 1314.7919s
Epoch: 7 cost time: 13.138704776763916
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0129730
	speed: 0.1765s/iter; left time: 7682.3591s
	iters: 200, epoch: 8 | loss: 0.0111635
	speed: 0.0318s/iter; left time: 1380.6798s
	iters: 300, epoch: 8 | loss: 0.0057183
	speed: 0.0306s/iter; left time: 1324.3157s
	iters: 400, epoch: 8 | loss: 0.2689054
	speed: 0.0336s/iter; left time: 1452.2817s
Epoch: 8 cost time: 14.914754390716553
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0510156
	speed: 0.1737s/iter; left time: 7477.0268s
	iters: 200, epoch: 9 | loss: 0.0026471
	speed: 0.0264s/iter; left time: 1134.2384s
	iters: 300, epoch: 9 | loss: 0.0053053
	speed: 0.0265s/iter; left time: 1136.3956s
	iters: 400, epoch: 9 | loss: 0.0023519
	speed: 0.0281s/iter; left time: 1200.7118s
Epoch: 9 cost time: 13.195093393325806
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1694297
	speed: 0.1874s/iter; left time: 7980.2649s
	iters: 200, epoch: 10 | loss: 0.0209314
	speed: 0.0265s/iter; left time: 1125.9458s
	iters: 300, epoch: 10 | loss: 0.0182948
	speed: 0.0273s/iter; left time: 1156.3331s
	iters: 400, epoch: 10 | loss: 0.0019760
	speed: 0.0302s/iter; left time: 1276.5841s
Epoch: 10 cost time: 13.997089624404907
Epoch: 10, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0021749
	speed: 0.1971s/iter; left time: 8301.3025s
	iters: 200, epoch: 11 | loss: 0.0050150
	speed: 0.0330s/iter; left time: 1386.2167s
	iters: 300, epoch: 11 | loss: 0.1818123
	speed: 0.0272s/iter; left time: 1141.8775s
	iters: 400, epoch: 11 | loss: 0.0029850
	speed: 0.0306s/iter; left time: 1278.5352s
Epoch: 11 cost time: 14.734899282455444
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0059207
	speed: 0.1689s/iter; left time: 7032.3647s
	iters: 200, epoch: 12 | loss: 0.0100557
	speed: 0.0306s/iter; left time: 1270.9730s
	iters: 300, epoch: 12 | loss: 0.1936311
	speed: 0.0268s/iter; left time: 1112.5093s
	iters: 400, epoch: 12 | loss: 0.7603012
	speed: 0.0254s/iter; left time: 1049.2446s
Epoch: 12 cost time: 13.599467515945435
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0067927
	speed: 0.1528s/iter; left time: 6289.6173s
	iters: 200, epoch: 13 | loss: 0.0109401
	speed: 0.0267s/iter; left time: 1098.6829s
	iters: 300, epoch: 13 | loss: 0.0093942
	speed: 0.0294s/iter; left time: 1206.3816s
	iters: 400, epoch: 13 | loss: 0.0044636
	speed: 0.0301s/iter; left time: 1229.5054s
Epoch: 13 cost time: 13.846368074417114
Epoch: 13, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0014346
	speed: 0.1855s/iter; left time: 7551.5313s
	iters: 200, epoch: 14 | loss: 0.2236604
	speed: 0.0309s/iter; left time: 1253.8414s
	iters: 300, epoch: 14 | loss: 0.0307002
	speed: 0.0289s/iter; left time: 1170.0692s
	iters: 400, epoch: 14 | loss: 0.0027121
	speed: 0.0263s/iter; left time: 1062.2970s
Epoch: 14 cost time: 14.201207399368286
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0094061
	speed: 0.1572s/iter; left time: 6324.4317s
	iters: 200, epoch: 15 | loss: 0.0080369
	speed: 0.0340s/iter; left time: 1363.3979s
	iters: 300, epoch: 15 | loss: 0.0062891
	speed: 0.0381s/iter; left time: 1524.7006s
	iters: 400, epoch: 15 | loss: 0.0130464
	speed: 0.0370s/iter; left time: 1478.6711s
Epoch: 15 cost time: 16.663089752197266
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9714122355631789
model parameter : 1002786
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6175056
	speed: 0.0472s/iter; left time: 2210.8124s
	iters: 200, epoch: 1 | loss: 0.3454336
	speed: 0.0329s/iter; left time: 1536.3872s
	iters: 300, epoch: 1 | loss: 0.3156091
	speed: 0.0259s/iter; left time: 1205.7074s
	iters: 400, epoch: 1 | loss: 0.2114653
	speed: 0.0249s/iter; left time: 1160.0348s
Epoch: 1 cost time: 14.896233081817627
Epoch: 1, Steps: 469 | Train Loss: 0.681 Vali Loss: 0.283 Vali Acc: 0.909 Test Loss: 0.283 Test Acc: 0.909
Validation loss decreased (inf --> -0.909088).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0644324
	speed: 0.1832s/iter; left time: 8488.2684s
	iters: 200, epoch: 2 | loss: 0.3289257
	speed: 0.0309s/iter; left time: 1426.7055s
	iters: 300, epoch: 2 | loss: 0.0902648
	speed: 0.0297s/iter; left time: 1369.8485s
	iters: 400, epoch: 2 | loss: 0.0373287
	speed: 0.0317s/iter; left time: 1461.1404s
Epoch: 2 cost time: 15.676975727081299
Epoch: 2, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
Validation loss decreased (-0.909088 --> -0.947396).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0502081
	speed: 0.1810s/iter; left time: 8299.3015s
	iters: 200, epoch: 3 | loss: 0.0226646
	speed: 0.0294s/iter; left time: 1345.2358s
	iters: 300, epoch: 3 | loss: 0.3204728
	speed: 0.0337s/iter; left time: 1540.7007s
	iters: 400, epoch: 3 | loss: 0.0280921
	speed: 0.0300s/iter; left time: 1367.2417s
Epoch: 3 cost time: 14.484118223190308
Epoch: 3, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
Validation loss decreased (-0.947396 --> -0.964264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0057953
	speed: 0.1614s/iter; left time: 7326.3853s
	iters: 200, epoch: 4 | loss: 0.3159337
	speed: 0.0254s/iter; left time: 1151.6586s
	iters: 300, epoch: 4 | loss: 0.0105473
	speed: 0.0271s/iter; left time: 1224.6972s
	iters: 400, epoch: 4 | loss: 0.0131073
	speed: 0.0307s/iter; left time: 1382.5815s
Epoch: 4 cost time: 13.637361288070679
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2236267
	speed: 0.1590s/iter; left time: 7144.6244s
	iters: 200, epoch: 5 | loss: 0.0716639
	speed: 0.0304s/iter; left time: 1363.8175s
	iters: 300, epoch: 5 | loss: 0.0083376
	speed: 0.0308s/iter; left time: 1378.7892s
	iters: 400, epoch: 5 | loss: 0.0191966
	speed: 0.0339s/iter; left time: 1513.9231s
Epoch: 5 cost time: 15.395276069641113
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.289 Vali Acc: 0.923 Test Loss: 0.289 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0942375
	speed: 0.1901s/iter; left time: 8452.2727s
	iters: 200, epoch: 6 | loss: 0.0051314
	speed: 0.0408s/iter; left time: 1811.2338s
	iters: 300, epoch: 6 | loss: 0.6691912
	speed: 0.0318s/iter; left time: 1408.4665s
	iters: 400, epoch: 6 | loss: 0.0592190
	speed: 0.0314s/iter; left time: 1386.8086s
Epoch: 6 cost time: 16.12992787361145
Epoch: 6, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964264 --> -0.964550).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0026902
	speed: 0.1894s/iter; left time: 8329.0323s
	iters: 200, epoch: 7 | loss: 0.0890500
	speed: 0.0309s/iter; left time: 1358.2716s
	iters: 300, epoch: 7 | loss: 0.0024088
	speed: 0.0372s/iter; left time: 1627.3096s
	iters: 400, epoch: 7 | loss: 0.3471678
	speed: 0.0345s/iter; left time: 1505.9392s
Epoch: 7 cost time: 16.770000219345093
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0082754
	speed: 0.1846s/iter; left time: 8031.5277s
	iters: 200, epoch: 8 | loss: 0.0043683
	speed: 0.0237s/iter; left time: 1028.8178s
	iters: 300, epoch: 8 | loss: 0.0960559
	speed: 0.0283s/iter; left time: 1227.6203s
	iters: 400, epoch: 8 | loss: 0.1373229
	speed: 0.0298s/iter; left time: 1287.1022s
Epoch: 8 cost time: 13.391612529754639
Epoch: 8, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0103625
	speed: 0.1708s/iter; left time: 7351.8646s
	iters: 200, epoch: 9 | loss: 0.0042385
	speed: 0.0304s/iter; left time: 1303.5913s
	iters: 300, epoch: 9 | loss: 0.2887876
	speed: 0.0366s/iter; left time: 1567.2023s
	iters: 400, epoch: 9 | loss: 0.0242090
	speed: 0.0377s/iter; left time: 1609.7546s
Epoch: 9 cost time: 16.59414768218994
Epoch: 9, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0048519
	speed: 0.1820s/iter; left time: 7750.9693s
	iters: 200, epoch: 10 | loss: 0.0005623
	speed: 0.0336s/iter; left time: 1427.6450s
	iters: 300, epoch: 10 | loss: 0.0044612
	speed: 0.0365s/iter; left time: 1545.4986s
	iters: 400, epoch: 10 | loss: 0.0005340
	speed: 0.0366s/iter; left time: 1547.9163s
Epoch: 10 cost time: 17.4905788898468
Epoch: 10, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964550 --> -0.965122).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0022056
	speed: 0.1704s/iter; left time: 7176.8587s
	iters: 200, epoch: 11 | loss: 0.2076812
	speed: 0.0292s/iter; left time: 1225.2012s
	iters: 300, epoch: 11 | loss: 0.0151712
	speed: 0.0255s/iter; left time: 1068.1658s
	iters: 400, epoch: 11 | loss: 0.0100940
	speed: 0.0247s/iter; left time: 1034.2854s
Epoch: 11 cost time: 13.434461116790771
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.965122 --> -0.969124).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1311822
	speed: 0.1795s/iter; left time: 7473.5179s
	iters: 200, epoch: 12 | loss: 0.0073491
	speed: 0.0293s/iter; left time: 1216.3284s
	iters: 300, epoch: 12 | loss: 0.2608785
	speed: 0.0308s/iter; left time: 1274.3835s
	iters: 400, epoch: 12 | loss: 0.0334512
	speed: 0.0288s/iter; left time: 1192.2676s
Epoch: 12 cost time: 14.256317377090454
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006254
	speed: 0.1664s/iter; left time: 6850.2997s
	iters: 200, epoch: 13 | loss: 0.0031500
	speed: 0.0296s/iter; left time: 1217.6601s
	iters: 300, epoch: 13 | loss: 0.0039285
	speed: 0.0320s/iter; left time: 1309.4083s
	iters: 400, epoch: 13 | loss: 0.0011885
	speed: 0.0292s/iter; left time: 1195.4399s
Epoch: 13 cost time: 15.508184671401978
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0158833
	speed: 0.1747s/iter; left time: 7110.8046s
	iters: 200, epoch: 14 | loss: 0.0415379
	speed: 0.0221s/iter; left time: 896.9147s
	iters: 300, epoch: 14 | loss: 0.1127639
	speed: 0.0246s/iter; left time: 994.8668s
	iters: 400, epoch: 14 | loss: 0.3405854
	speed: 0.0246s/iter; left time: 995.6226s
Epoch: 14 cost time: 11.878402471542358
Epoch: 14, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.969982).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0017807
	speed: 0.1629s/iter; left time: 6555.4788s
	iters: 200, epoch: 15 | loss: 0.0107312
	speed: 0.0316s/iter; left time: 1269.8819s
	iters: 300, epoch: 15 | loss: 0.0133509
	speed: 0.0318s/iter; left time: 1271.7418s
	iters: 400, epoch: 15 | loss: 0.0020224
	speed: 0.0289s/iter; left time: 1152.9339s
Epoch: 15 cost time: 14.449900388717651
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0079310
	speed: 0.1408s/iter; left time: 5598.7623s
	iters: 200, epoch: 16 | loss: 0.0013361
	speed: 0.0253s/iter; left time: 1005.2362s
	iters: 300, epoch: 16 | loss: 0.0064770
	speed: 0.0250s/iter; left time: 989.1334s
	iters: 400, epoch: 16 | loss: 0.0033524
	speed: 0.0296s/iter; left time: 1167.8087s
Epoch: 16 cost time: 13.362622737884521
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0775467
	speed: 0.1941s/iter; left time: 7625.9121s
	iters: 200, epoch: 17 | loss: 0.0696793
	speed: 0.0314s/iter; left time: 1231.1982s
	iters: 300, epoch: 17 | loss: 0.0309677
	speed: 0.0255s/iter; left time: 997.2722s
	iters: 400, epoch: 17 | loss: 0.0097095
	speed: 0.0314s/iter; left time: 1223.7680s
Epoch: 17 cost time: 15.224379777908325
Epoch: 17, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0046910
	speed: 0.2068s/iter; left time: 8027.8832s
	iters: 200, epoch: 18 | loss: 0.0022218
	speed: 0.0299s/iter; left time: 1157.7421s
	iters: 300, epoch: 18 | loss: 0.1914673
	speed: 0.0342s/iter; left time: 1322.0665s
	iters: 400, epoch: 18 | loss: 0.0282770
	speed: 0.0349s/iter; left time: 1343.3718s
Epoch: 18 cost time: 15.55971646308899
Epoch: 18, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0612421
	speed: 0.1654s/iter; left time: 6342.7285s
	iters: 200, epoch: 19 | loss: 0.0137076
	speed: 0.0319s/iter; left time: 1219.1772s
	iters: 300, epoch: 19 | loss: 0.0120755
	speed: 0.0268s/iter; left time: 1023.9915s
	iters: 400, epoch: 19 | loss: 0.0721224
	speed: 0.0326s/iter; left time: 1239.6673s
Epoch: 19 cost time: 14.600074529647827
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001479
	speed: 0.1440s/iter; left time: 5455.7742s
	iters: 200, epoch: 20 | loss: 0.0014297
	speed: 0.0274s/iter; left time: 1036.4578s
	iters: 300, epoch: 20 | loss: 0.0013430
	speed: 0.0283s/iter; left time: 1065.0203s
	iters: 400, epoch: 20 | loss: 0.0010951
	speed: 0.0285s/iter; left time: 1070.0543s
Epoch: 20 cost time: 13.584341049194336
Epoch: 20, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2222271
	speed: 0.1755s/iter; left time: 6567.7326s
	iters: 200, epoch: 21 | loss: 0.0048147
	speed: 0.0296s/iter; left time: 1103.8941s
	iters: 300, epoch: 21 | loss: 0.0335201
	speed: 0.0332s/iter; left time: 1235.8366s
	iters: 400, epoch: 21 | loss: 0.0031471
	speed: 0.0345s/iter; left time: 1282.3904s
Epoch: 21 cost time: 15.81366229057312
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0260394
	speed: 0.2075s/iter; left time: 7668.6500s
	iters: 200, epoch: 22 | loss: 0.0007022
	speed: 0.0331s/iter; left time: 1221.2238s
	iters: 300, epoch: 22 | loss: 0.0029585
	speed: 0.0344s/iter; left time: 1264.2032s
	iters: 400, epoch: 22 | loss: 0.0320657
	speed: 0.0313s/iter; left time: 1146.9994s
Epoch: 22 cost time: 15.976417064666748
Epoch: 22, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0008474
	speed: 0.1665s/iter; left time: 6075.0106s
	iters: 200, epoch: 23 | loss: 0.0408416
	speed: 0.0288s/iter; left time: 1047.3667s
	iters: 300, epoch: 23 | loss: 0.0027095
	speed: 0.0331s/iter; left time: 1199.5088s
	iters: 400, epoch: 23 | loss: 0.0057100
	speed: 0.0387s/iter; left time: 1398.8932s
Epoch: 23 cost time: 15.590604543685913
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0550995
	speed: 0.1467s/iter; left time: 5284.6601s
	iters: 200, epoch: 24 | loss: 0.0057745
	speed: 0.0270s/iter; left time: 970.6581s
	iters: 300, epoch: 24 | loss: 0.0000868
	speed: 0.0319s/iter; left time: 1140.6891s
	iters: 400, epoch: 24 | loss: 0.0054913
	speed: 0.0323s/iter; left time: 1153.6571s
Epoch: 24 cost time: 14.357036828994751
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9699828473413379
model parameter : 1002658
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8527643
	speed: 0.0480s/iter; left time: 2247.5646s
	iters: 200, epoch: 1 | loss: 0.6504864
	speed: 0.0259s/iter; left time: 1210.5350s
	iters: 300, epoch: 1 | loss: 0.1471403
	speed: 0.0267s/iter; left time: 1244.0353s
	iters: 400, epoch: 1 | loss: 0.2085642
	speed: 0.0300s/iter; left time: 1393.7133s
Epoch: 1 cost time: 14.952313661575317
Epoch: 1, Steps: 469 | Train Loss: 0.724 Vali Loss: 0.321 Vali Acc: 0.887 Test Loss: 0.321 Test Acc: 0.887
Validation loss decreased (inf --> -0.887075).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1241214
	speed: 0.1571s/iter; left time: 7280.0817s
	iters: 200, epoch: 2 | loss: 0.0999066
	speed: 0.0248s/iter; left time: 1146.2891s
	iters: 300, epoch: 2 | loss: 0.0928856
	speed: 0.0267s/iter; left time: 1233.0229s
	iters: 400, epoch: 2 | loss: 0.3153253
	speed: 0.0291s/iter; left time: 1338.9801s
Epoch: 2 cost time: 13.053700685501099
Epoch: 2, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.887075 --> -0.943966).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0686582
	speed: 0.1491s/iter; left time: 6840.2039s
	iters: 200, epoch: 3 | loss: 0.0308556
	speed: 0.0274s/iter; left time: 1254.3501s
	iters: 300, epoch: 3 | loss: 0.0231117
	speed: 0.0244s/iter; left time: 1113.7886s
	iters: 400, epoch: 3 | loss: 0.0179292
	speed: 0.0249s/iter; left time: 1135.5282s
Epoch: 3 cost time: 12.785566568374634
Epoch: 3, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0254725
	speed: 0.1694s/iter; left time: 7688.1475s
	iters: 200, epoch: 4 | loss: 0.0901753
	speed: 0.0324s/iter; left time: 1467.2746s
	iters: 300, epoch: 4 | loss: 0.0062788
	speed: 0.0369s/iter; left time: 1667.7010s
	iters: 400, epoch: 4 | loss: 0.0476414
	speed: 0.0342s/iter; left time: 1541.2148s
Epoch: 4 cost time: 16.20640730857849
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0416423
	speed: 0.1575s/iter; left time: 7074.6336s
	iters: 200, epoch: 5 | loss: 0.0626977
	speed: 0.0272s/iter; left time: 1218.2167s
	iters: 300, epoch: 5 | loss: 0.0702768
	speed: 0.0285s/iter; left time: 1273.4182s
	iters: 400, epoch: 5 | loss: 0.4118005
	speed: 0.0317s/iter; left time: 1414.8015s
Epoch: 5 cost time: 14.015246629714966
Epoch: 5, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.943966 --> -0.957117).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0876273
	speed: 0.1849s/iter; left time: 8218.8054s
	iters: 200, epoch: 6 | loss: 0.0610765
	speed: 0.0294s/iter; left time: 1305.5512s
	iters: 300, epoch: 6 | loss: 0.1391262
	speed: 0.0280s/iter; left time: 1238.5047s
	iters: 400, epoch: 6 | loss: 0.0182179
	speed: 0.0278s/iter; left time: 1228.1415s
Epoch: 6 cost time: 13.734004020690918
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0094991
	speed: 0.1552s/iter; left time: 6825.2501s
	iters: 200, epoch: 7 | loss: 0.0473757
	speed: 0.0259s/iter; left time: 1136.6213s
	iters: 300, epoch: 7 | loss: 0.0087548
	speed: 0.0247s/iter; left time: 1082.3254s
	iters: 400, epoch: 7 | loss: 0.2743114
	speed: 0.0285s/iter; left time: 1247.0974s
Epoch: 7 cost time: 12.898110389709473
Epoch: 7, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1639544
	speed: 0.1515s/iter; left time: 6593.9924s
	iters: 200, epoch: 8 | loss: 0.0148967
	speed: 0.0280s/iter; left time: 1215.5650s
	iters: 300, epoch: 8 | loss: 0.1372055
	speed: 0.0258s/iter; left time: 1119.6000s
	iters: 400, epoch: 8 | loss: 0.0051604
	speed: 0.0263s/iter; left time: 1138.3972s
Epoch: 8 cost time: 12.552531003952026
Epoch: 8, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.957117 --> -0.958260).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0404439
	speed: 0.1539s/iter; left time: 6623.3246s
	iters: 200, epoch: 9 | loss: 0.0060280
	speed: 0.0280s/iter; left time: 1201.6181s
	iters: 300, epoch: 9 | loss: 0.0012163
	speed: 0.0244s/iter; left time: 1047.5694s
	iters: 400, epoch: 9 | loss: 0.0654083
	speed: 0.0290s/iter; left time: 1237.8705s
Epoch: 9 cost time: 13.350640296936035
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0012899
	speed: 0.1489s/iter; left time: 6338.6219s
	iters: 200, epoch: 10 | loss: 0.0125856
	speed: 0.0273s/iter; left time: 1158.2930s
	iters: 300, epoch: 10 | loss: 0.0161742
	speed: 0.0303s/iter; left time: 1283.5753s
	iters: 400, epoch: 10 | loss: 0.0114089
	speed: 0.0284s/iter; left time: 1199.5687s
Epoch: 10 cost time: 13.461264371871948
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.958260 --> -0.966551).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1437415
	speed: 0.1378s/iter; left time: 5801.3045s
	iters: 200, epoch: 11 | loss: 0.0259408
	speed: 0.0239s/iter; left time: 1005.7208s
	iters: 300, epoch: 11 | loss: 0.0007242
	speed: 0.0221s/iter; left time: 927.3805s
	iters: 400, epoch: 11 | loss: 0.0135139
	speed: 0.0271s/iter; left time: 1131.2459s
Epoch: 11 cost time: 12.521498918533325
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0018810
	speed: 0.1615s/iter; left time: 6726.7080s
	iters: 200, epoch: 12 | loss: 0.0034543
	speed: 0.0284s/iter; left time: 1177.8523s
	iters: 300, epoch: 12 | loss: 0.0070612
	speed: 0.0294s/iter; left time: 1216.8415s
	iters: 400, epoch: 12 | loss: 0.1277472
	speed: 0.0280s/iter; left time: 1156.1021s
Epoch: 12 cost time: 13.605639696121216
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1082208
	speed: 0.1450s/iter; left time: 5969.3651s
	iters: 200, epoch: 13 | loss: 0.0007889
	speed: 0.0261s/iter; left time: 1070.5941s
	iters: 300, epoch: 13 | loss: 0.0007220
	speed: 0.0266s/iter; left time: 1091.1296s
	iters: 400, epoch: 13 | loss: 0.0310849
	speed: 0.0236s/iter; left time: 963.4580s
Epoch: 13 cost time: 12.23225212097168
Epoch: 13, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0501898
	speed: 0.1367s/iter; left time: 5564.5494s
	iters: 200, epoch: 14 | loss: 0.0014641
	speed: 0.0271s/iter; left time: 1100.9596s
	iters: 300, epoch: 14 | loss: 0.0104453
	speed: 0.0225s/iter; left time: 909.4056s
	iters: 400, epoch: 14 | loss: 0.0111916
	speed: 0.0256s/iter; left time: 1032.9396s
Epoch: 14 cost time: 11.643208265304565
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.966551 --> -0.969982).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1564679
	speed: 0.1191s/iter; left time: 4790.9662s
	iters: 200, epoch: 15 | loss: 0.0071137
	speed: 0.0224s/iter; left time: 897.4314s
	iters: 300, epoch: 15 | loss: 0.0045736
	speed: 0.0250s/iter; left time: 999.6266s
	iters: 400, epoch: 15 | loss: 0.0665383
	speed: 0.0262s/iter; left time: 1045.4939s
Epoch: 15 cost time: 11.655373334884644
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0213469
	speed: 0.1459s/iter; left time: 5802.9209s
	iters: 200, epoch: 16 | loss: 0.0139934
	speed: 0.0227s/iter; left time: 901.1328s
	iters: 300, epoch: 16 | loss: 0.3686428
	speed: 0.0225s/iter; left time: 890.3835s
	iters: 400, epoch: 16 | loss: 0.0079415
	speed: 0.0248s/iter; left time: 978.7321s
Epoch: 16 cost time: 12.025938749313354
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0008784
	speed: 0.1649s/iter; left time: 6481.7443s
	iters: 200, epoch: 17 | loss: 0.0160300
	speed: 0.0288s/iter; left time: 1129.4574s
	iters: 300, epoch: 17 | loss: 0.0061637
	speed: 0.0237s/iter; left time: 927.8667s
	iters: 400, epoch: 17 | loss: 0.2382615
	speed: 0.0237s/iter; left time: 925.6957s
Epoch: 17 cost time: 12.724060773849487
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969982 --> -0.973126).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0628275
	speed: 0.1542s/iter; left time: 5985.6409s
	iters: 200, epoch: 18 | loss: 0.0117198
	speed: 0.0286s/iter; left time: 1108.8853s
	iters: 300, epoch: 18 | loss: 0.1113495
	speed: 0.0255s/iter; left time: 985.9717s
	iters: 400, epoch: 18 | loss: 0.0060151
	speed: 0.0239s/iter; left time: 919.8761s
Epoch: 18 cost time: 12.988720178604126
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0044718
	speed: 0.1486s/iter; left time: 5698.6562s
	iters: 200, epoch: 19 | loss: 0.0045520
	speed: 0.0249s/iter; left time: 950.8617s
	iters: 300, epoch: 19 | loss: 0.0212587
	speed: 0.0272s/iter; left time: 1039.5854s
	iters: 400, epoch: 19 | loss: 0.0036581
	speed: 0.0267s/iter; left time: 1017.1708s
Epoch: 19 cost time: 12.959830522537231
Epoch: 19, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0154549
	speed: 0.1548s/iter; left time: 5865.8366s
	iters: 200, epoch: 20 | loss: 0.0187860
	speed: 0.0292s/iter; left time: 1104.3055s
	iters: 300, epoch: 20 | loss: 0.1574761
	speed: 0.0285s/iter; left time: 1074.4349s
	iters: 400, epoch: 20 | loss: 0.0620300
	speed: 0.0268s/iter; left time: 1007.3042s
Epoch: 20 cost time: 13.342928886413574
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0318288
	speed: 0.1527s/iter; left time: 5713.2752s
	iters: 200, epoch: 21 | loss: 0.1018179
	speed: 0.0267s/iter; left time: 996.2425s
	iters: 300, epoch: 21 | loss: 0.0381553
	speed: 0.0264s/iter; left time: 984.2133s
	iters: 400, epoch: 21 | loss: 0.2297634
	speed: 0.0253s/iter; left time: 938.8598s
Epoch: 21 cost time: 12.458977699279785
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.234 Vali Acc: 0.943 Test Loss: 0.234 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0093796
	speed: 0.1421s/iter; left time: 5249.7249s
	iters: 200, epoch: 22 | loss: 0.0355843
	speed: 0.0231s/iter; left time: 852.1578s
	iters: 300, epoch: 22 | loss: 0.0146550
	speed: 0.0250s/iter; left time: 917.3464s
	iters: 400, epoch: 22 | loss: 0.0016226
	speed: 0.0232s/iter; left time: 852.0131s
Epoch: 22 cost time: 11.722779273986816
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0468981
	speed: 0.1227s/iter; left time: 4477.7313s
	iters: 200, epoch: 23 | loss: 0.0019547
	speed: 0.0221s/iter; left time: 802.3592s
	iters: 300, epoch: 23 | loss: 0.0011863
	speed: 0.0258s/iter; left time: 937.4015s
	iters: 400, epoch: 23 | loss: 0.0003485
	speed: 0.0257s/iter; left time: 931.5693s
Epoch: 23 cost time: 12.014685869216919
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0018199
	speed: 0.1452s/iter; left time: 5230.2853s
	iters: 200, epoch: 24 | loss: 0.0004677
	speed: 0.0266s/iter; left time: 956.7175s
	iters: 300, epoch: 24 | loss: 0.0053342
	speed: 0.0302s/iter; left time: 1081.1483s
	iters: 400, epoch: 24 | loss: 0.0317159
	speed: 0.0241s/iter; left time: 859.6042s
Epoch: 24 cost time: 12.737032890319824
Epoch: 24, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0208583
	speed: 0.1422s/iter; left time: 5054.3758s
	iters: 200, epoch: 25 | loss: 0.0026365
	speed: 0.0269s/iter; left time: 953.3173s
	iters: 300, epoch: 25 | loss: 0.0013182
	speed: 0.0290s/iter; left time: 1023.6897s
	iters: 400, epoch: 25 | loss: 0.1861625
	speed: 0.0281s/iter; left time: 990.5762s
Epoch: 25 cost time: 13.750773429870605
Epoch: 25, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.233 Vali Acc: 0.947 Test Loss: 0.233 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1288120
	speed: 0.1358s/iter; left time: 4763.4034s
	iters: 200, epoch: 26 | loss: 0.0184878
	speed: 0.0232s/iter; left time: 809.9353s
	iters: 300, epoch: 26 | loss: 0.0022197
	speed: 0.0250s/iter; left time: 871.4507s
	iters: 400, epoch: 26 | loss: 0.0052164
	speed: 0.0252s/iter; left time: 875.3112s
Epoch: 26 cost time: 11.54040265083313
Epoch: 26, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0236133
	speed: 0.1280s/iter; left time: 4429.0428s
	iters: 200, epoch: 27 | loss: 0.0410682
	speed: 0.0257s/iter; left time: 888.5004s
	iters: 300, epoch: 27 | loss: 0.3204593
	speed: 0.0257s/iter; left time: 884.5921s
	iters: 400, epoch: 27 | loss: 0.0296685
	speed: 0.0270s/iter; left time: 925.1170s
Epoch: 27 cost time: 12.41720724105835
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 904354
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2793809
	speed: 0.0487s/iter; left time: 2278.1153s
	iters: 200, epoch: 1 | loss: 0.6024848
	speed: 0.0325s/iter; left time: 1516.4473s
	iters: 300, epoch: 1 | loss: 0.2238586
	speed: 0.0256s/iter; left time: 1191.6604s
	iters: 400, epoch: 1 | loss: 0.3804209
	speed: 0.0271s/iter; left time: 1259.7411s
Epoch: 1 cost time: 15.080524921417236
Epoch: 1, Steps: 469 | Train Loss: 0.703 Vali Loss: 0.327 Vali Acc: 0.902 Test Loss: 0.327 Test Acc: 0.902
Validation loss decreased (inf --> -0.901655).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3566690
	speed: 0.1382s/iter; left time: 6400.8424s
	iters: 200, epoch: 2 | loss: 0.1158290
	speed: 0.0220s/iter; left time: 1015.2279s
	iters: 300, epoch: 2 | loss: 0.0433442
	speed: 0.0226s/iter; left time: 1041.2176s
	iters: 400, epoch: 2 | loss: 0.0874878
	speed: 0.0232s/iter; left time: 1069.8232s
Epoch: 2 cost time: 11.084981441497803
Epoch: 2, Steps: 469 | Train Loss: 0.154 Vali Loss: 0.200 Vali Acc: 0.940 Test Loss: 0.200 Test Acc: 0.940
Validation loss decreased (-0.901655 --> -0.939964).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2691077
	speed: 0.1118s/iter; left time: 5129.2009s
	iters: 200, epoch: 3 | loss: 0.0557443
	speed: 0.0248s/iter; left time: 1135.2821s
	iters: 300, epoch: 3 | loss: 0.2547039
	speed: 0.0260s/iter; left time: 1186.7473s
	iters: 400, epoch: 3 | loss: 0.0119330
	speed: 0.0284s/iter; left time: 1294.5850s
Epoch: 3 cost time: 12.331556558609009
Epoch: 3, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0675230
	speed: 0.1574s/iter; left time: 7145.6564s
	iters: 200, epoch: 4 | loss: 0.0724201
	speed: 0.0258s/iter; left time: 1169.1028s
	iters: 300, epoch: 4 | loss: 0.0340197
	speed: 0.0228s/iter; left time: 1030.0588s
	iters: 400, epoch: 4 | loss: 0.0196581
	speed: 0.0246s/iter; left time: 1109.1486s
Epoch: 4 cost time: 12.87432599067688
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
Validation loss decreased (-0.939964 --> -0.946539).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0065489
	speed: 0.1724s/iter; left time: 7743.3899s
	iters: 200, epoch: 5 | loss: 0.0308355
	speed: 0.0276s/iter; left time: 1237.7536s
	iters: 300, epoch: 5 | loss: 0.4130480
	speed: 0.0265s/iter; left time: 1186.7583s
	iters: 400, epoch: 5 | loss: 0.0355207
	speed: 0.0256s/iter; left time: 1140.8203s
Epoch: 5 cost time: 13.139959335327148
Epoch: 5, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.946539 --> -0.964550).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0027018
	speed: 0.1650s/iter; left time: 7334.6241s
	iters: 200, epoch: 6 | loss: 0.0119440
	speed: 0.0223s/iter; left time: 989.7699s
	iters: 300, epoch: 6 | loss: 0.0059898
	speed: 0.0232s/iter; left time: 1028.1717s
	iters: 400, epoch: 6 | loss: 0.0288515
	speed: 0.0249s/iter; left time: 1097.7690s
Epoch: 6 cost time: 12.395794153213501
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0056355
	speed: 0.1663s/iter; left time: 7314.2435s
	iters: 200, epoch: 7 | loss: 0.0176221
	speed: 0.0276s/iter; left time: 1212.8134s
	iters: 300, epoch: 7 | loss: 0.0048330
	speed: 0.0311s/iter; left time: 1360.4492s
	iters: 400, epoch: 7 | loss: 0.0165370
	speed: 0.0308s/iter; left time: 1343.3850s
Epoch: 7 cost time: 13.728244543075562
Epoch: 7, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.251 Vali Acc: 0.939 Test Loss: 0.251 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0273457
	speed: 0.1435s/iter; left time: 6243.3244s
	iters: 200, epoch: 8 | loss: 0.0824625
	speed: 0.0249s/iter; left time: 1082.2400s
	iters: 300, epoch: 8 | loss: 0.0343645
	speed: 0.0264s/iter; left time: 1145.7160s
	iters: 400, epoch: 8 | loss: 0.1141093
	speed: 0.0266s/iter; left time: 1148.4182s
Epoch: 8 cost time: 12.684851169586182
Epoch: 8, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0073672
	speed: 0.1205s/iter; left time: 5185.3591s
	iters: 200, epoch: 9 | loss: 0.0478470
	speed: 0.0262s/iter; left time: 1124.2285s
	iters: 300, epoch: 9 | loss: 0.1192205
	speed: 0.0243s/iter; left time: 1039.7544s
	iters: 400, epoch: 9 | loss: 0.0182979
	speed: 0.0214s/iter; left time: 916.1064s
Epoch: 9 cost time: 11.33684778213501
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0096788
	speed: 0.1170s/iter; left time: 4981.0322s
	iters: 200, epoch: 10 | loss: 0.0104718
	speed: 0.0231s/iter; left time: 979.6110s
	iters: 300, epoch: 10 | loss: 0.1377086
	speed: 0.0240s/iter; left time: 1016.5813s
	iters: 400, epoch: 10 | loss: 0.0097815
	speed: 0.0253s/iter; left time: 1071.3664s
Epoch: 10 cost time: 11.454968214035034
Epoch: 10, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.964550 --> -0.965979).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0014234
	speed: 0.1375s/iter; left time: 5792.3217s
	iters: 200, epoch: 11 | loss: 0.0108015
	speed: 0.0274s/iter; left time: 1149.2729s
	iters: 300, epoch: 11 | loss: 0.0020035
	speed: 0.0320s/iter; left time: 1341.0479s
	iters: 400, epoch: 11 | loss: 0.0077688
	speed: 0.0320s/iter; left time: 1336.4248s
Epoch: 11 cost time: 14.094228267669678
Epoch: 11, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3742399
	speed: 0.1556s/iter; left time: 6479.7126s
	iters: 200, epoch: 12 | loss: 0.0040949
	speed: 0.0299s/iter; left time: 1241.4343s
	iters: 300, epoch: 12 | loss: 0.0096406
	speed: 0.0278s/iter; left time: 1150.9207s
	iters: 400, epoch: 12 | loss: 0.1149159
	speed: 0.0259s/iter; left time: 1068.8334s
Epoch: 12 cost time: 13.451997995376587
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0373263
	speed: 0.1324s/iter; left time: 5451.8717s
	iters: 200, epoch: 13 | loss: 0.0123811
	speed: 0.0232s/iter; left time: 953.3473s
	iters: 300, epoch: 13 | loss: 0.0331846
	speed: 0.0268s/iter; left time: 1097.2945s
	iters: 400, epoch: 13 | loss: 0.0021764
	speed: 0.0254s/iter; left time: 1038.6074s
Epoch: 13 cost time: 12.060650110244751
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0067703
	speed: 0.1552s/iter; left time: 6316.6993s
	iters: 200, epoch: 14 | loss: 0.0083968
	speed: 0.0281s/iter; left time: 1142.1091s
	iters: 300, epoch: 14 | loss: 0.0734631
	speed: 0.0276s/iter; left time: 1118.7055s
	iters: 400, epoch: 14 | loss: 0.1135104
	speed: 0.0255s/iter; left time: 1031.9626s
Epoch: 14 cost time: 13.258782625198364
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
Validation loss decreased (-0.965979 --> -0.971983).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4447944
	speed: 0.1255s/iter; left time: 5049.3628s
	iters: 200, epoch: 15 | loss: 0.0271147
	speed: 0.0242s/iter; left time: 970.6571s
	iters: 300, epoch: 15 | loss: 0.0260834
	speed: 0.0236s/iter; left time: 946.4967s
	iters: 400, epoch: 15 | loss: 0.0004694
	speed: 0.0253s/iter; left time: 1009.2983s
Epoch: 15 cost time: 11.61102294921875
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0172362
	speed: 0.1291s/iter; left time: 5133.1086s
	iters: 200, epoch: 16 | loss: 0.0022324
	speed: 0.0208s/iter; left time: 825.5150s
	iters: 300, epoch: 16 | loss: 0.4132226
	speed: 0.0209s/iter; left time: 825.2300s
	iters: 400, epoch: 16 | loss: 0.0017083
	speed: 0.0214s/iter; left time: 845.5181s
Epoch: 16 cost time: 10.364678859710693
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0546781
	speed: 0.1523s/iter; left time: 5985.0859s
	iters: 200, epoch: 17 | loss: 0.0005667
	speed: 0.0268s/iter; left time: 1052.1037s
	iters: 300, epoch: 17 | loss: 0.0075536
	speed: 0.0246s/iter; left time: 963.4839s
	iters: 400, epoch: 17 | loss: 0.0491053
	speed: 0.0212s/iter; left time: 826.4132s
Epoch: 17 cost time: 11.918658256530762
Epoch: 17, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.190 Vali Acc: 0.947 Test Loss: 0.190 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0009336
	speed: 0.1374s/iter; left time: 5333.5301s
	iters: 200, epoch: 18 | loss: 0.0102223
	speed: 0.0282s/iter; left time: 1090.3781s
	iters: 300, epoch: 18 | loss: 0.0486439
	speed: 0.0280s/iter; left time: 1083.0512s
	iters: 400, epoch: 18 | loss: 0.0117325
	speed: 0.0263s/iter; left time: 1012.4407s
Epoch: 18 cost time: 13.147965669631958
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0060398
	speed: 0.1115s/iter; left time: 4277.3226s
	iters: 200, epoch: 19 | loss: 0.0022845
	speed: 0.0204s/iter; left time: 779.4499s
	iters: 300, epoch: 19 | loss: 0.0028634
	speed: 0.0223s/iter; left time: 852.8521s
	iters: 400, epoch: 19 | loss: 0.0588544
	speed: 0.0234s/iter; left time: 889.8810s
Epoch: 19 cost time: 10.43981409072876
Epoch: 19, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001863
	speed: 0.1358s/iter; left time: 5145.5141s
	iters: 200, epoch: 20 | loss: 0.0075156
	speed: 0.0210s/iter; left time: 792.9660s
	iters: 300, epoch: 20 | loss: 0.0010895
	speed: 0.0217s/iter; left time: 816.3597s
	iters: 400, epoch: 20 | loss: 0.0113314
	speed: 0.0205s/iter; left time: 770.5615s
Epoch: 20 cost time: 10.571514368057251
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0033301
	speed: 0.1360s/iter; left time: 5091.0197s
	iters: 200, epoch: 21 | loss: 0.0238362
	speed: 0.0230s/iter; left time: 859.7905s
	iters: 300, epoch: 21 | loss: 0.0023266
	speed: 0.0222s/iter; left time: 827.3527s
	iters: 400, epoch: 21 | loss: 0.0278640
	speed: 0.0206s/iter; left time: 766.3227s
Epoch: 21 cost time: 11.029697179794312
Epoch: 21, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0074097
	speed: 0.1185s/iter; left time: 4378.6522s
	iters: 200, epoch: 22 | loss: 0.0520123
	speed: 0.0233s/iter; left time: 856.8259s
	iters: 300, epoch: 22 | loss: 0.1970842
	speed: 0.0240s/iter; left time: 882.0878s
	iters: 400, epoch: 22 | loss: 0.0143571
	speed: 0.0210s/iter; left time: 771.3318s
Epoch: 22 cost time: 10.610673904418945
Epoch: 22, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0012943
	speed: 0.0983s/iter; left time: 3587.9696s
	iters: 200, epoch: 23 | loss: 0.0372713
	speed: 0.0235s/iter; left time: 855.7277s
	iters: 300, epoch: 23 | loss: 0.0173036
	speed: 0.0278s/iter; left time: 1008.0688s
	iters: 400, epoch: 23 | loss: 0.2375878
	speed: 0.0251s/iter; left time: 907.5105s
Epoch: 23 cost time: 11.692015886306763
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0108603
	speed: 0.1357s/iter; left time: 4886.1571s
	iters: 200, epoch: 24 | loss: 0.0010881
	speed: 0.0220s/iter; left time: 789.6551s
	iters: 300, epoch: 24 | loss: 0.0078376
	speed: 0.0215s/iter; left time: 769.6251s
	iters: 400, epoch: 24 | loss: 0.0179594
	speed: 0.0230s/iter; left time: 820.0317s
Epoch: 24 cost time: 11.179367065429688
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 904226
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0920993
	speed: 0.0389s/iter; left time: 1822.7633s
	iters: 200, epoch: 1 | loss: 0.2978868
	speed: 0.0247s/iter; left time: 1153.2988s
	iters: 300, epoch: 1 | loss: 0.0694123
	speed: 0.0248s/iter; left time: 1157.5436s
	iters: 400, epoch: 1 | loss: 0.0670757
	speed: 0.0215s/iter; left time: 998.8597s
Epoch: 1 cost time: 12.505776166915894
Epoch: 1, Steps: 469 | Train Loss: 0.726 Vali Loss: 0.353 Vali Acc: 0.881 Test Loss: 0.353 Test Acc: 0.881
Validation loss decreased (inf --> -0.880500).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0771295
	speed: 0.1349s/iter; left time: 6248.3609s
	iters: 200, epoch: 2 | loss: 0.1925844
	speed: 0.0255s/iter; left time: 1177.0436s
	iters: 300, epoch: 2 | loss: 0.0344186
	speed: 0.0236s/iter; left time: 1086.6722s
	iters: 400, epoch: 2 | loss: 0.0719930
	speed: 0.0274s/iter; left time: 1262.2062s
Epoch: 2 cost time: 12.225430965423584
Epoch: 2, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.880500 --> -0.917379).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5044256
	speed: 0.1394s/iter; left time: 6392.6857s
	iters: 200, epoch: 3 | loss: 0.5186815
	speed: 0.0289s/iter; left time: 1322.5437s
	iters: 300, epoch: 3 | loss: 0.0439706
	speed: 0.0248s/iter; left time: 1132.3318s
	iters: 400, epoch: 3 | loss: 0.0119037
	speed: 0.0243s/iter; left time: 1105.2070s
Epoch: 3 cost time: 12.204871416091919
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.917379 --> -0.943966).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1364253
	speed: 0.1417s/iter; left time: 6432.6919s
	iters: 200, epoch: 4 | loss: 0.0679926
	speed: 0.0236s/iter; left time: 1067.5316s
	iters: 300, epoch: 4 | loss: 0.0064230
	speed: 0.0217s/iter; left time: 980.2580s
	iters: 400, epoch: 4 | loss: 0.0196275
	speed: 0.0195s/iter; left time: 877.8487s
Epoch: 4 cost time: 10.961150169372559
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0136597
	speed: 0.1210s/iter; left time: 5436.8131s
	iters: 200, epoch: 5 | loss: 0.1221218
	speed: 0.0273s/iter; left time: 1223.5466s
	iters: 300, epoch: 5 | loss: 0.0390659
	speed: 0.0245s/iter; left time: 1094.8180s
	iters: 400, epoch: 5 | loss: 0.0102068
	speed: 0.0229s/iter; left time: 1019.9405s
Epoch: 5 cost time: 12.081286430358887
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.943966 --> -0.954258).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0289165
	speed: 0.1147s/iter; left time: 5097.9258s
	iters: 200, epoch: 6 | loss: 0.1392526
	speed: 0.0233s/iter; left time: 1033.5403s
	iters: 300, epoch: 6 | loss: 0.0233514
	speed: 0.0213s/iter; left time: 944.5568s
	iters: 400, epoch: 6 | loss: 0.1085989
	speed: 0.0226s/iter; left time: 997.5031s
Epoch: 6 cost time: 10.88869309425354
Epoch: 6, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.954258 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1755640
	speed: 0.1278s/iter; left time: 5623.1507s
	iters: 200, epoch: 7 | loss: 0.0932124
	speed: 0.0206s/iter; left time: 905.7696s
	iters: 300, epoch: 7 | loss: 0.0447519
	speed: 0.0188s/iter; left time: 821.1200s
	iters: 400, epoch: 7 | loss: 0.0564171
	speed: 0.0193s/iter; left time: 842.7209s
Epoch: 7 cost time: 10.11276125907898
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0190792
	speed: 0.1136s/iter; left time: 4944.3781s
	iters: 200, epoch: 8 | loss: 0.0169586
	speed: 0.0204s/iter; left time: 885.8619s
	iters: 300, epoch: 8 | loss: 0.0066699
	speed: 0.0202s/iter; left time: 876.9773s
	iters: 400, epoch: 8 | loss: 0.0082859
	speed: 0.0193s/iter; left time: 833.9258s
Epoch: 8 cost time: 10.013398885726929
Epoch: 8, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.969410).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0137577
	speed: 0.1305s/iter; left time: 5619.3239s
	iters: 200, epoch: 9 | loss: 0.0042373
	speed: 0.0230s/iter; left time: 988.2560s
	iters: 300, epoch: 9 | loss: 0.0499993
	speed: 0.0222s/iter; left time: 950.8061s
	iters: 400, epoch: 9 | loss: 0.2371854
	speed: 0.0197s/iter; left time: 842.7027s
Epoch: 9 cost time: 10.583918333053589
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0788645
	speed: 0.1376s/iter; left time: 5859.5368s
	iters: 200, epoch: 10 | loss: 0.0023845
	speed: 0.0318s/iter; left time: 1349.0859s
	iters: 300, epoch: 10 | loss: 0.0025995
	speed: 0.0282s/iter; left time: 1193.8604s
	iters: 400, epoch: 10 | loss: 0.0045561
	speed: 0.0247s/iter; left time: 1045.4518s
Epoch: 10 cost time: 13.727809190750122
Epoch: 10, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0351038
	speed: 0.1587s/iter; left time: 6681.2604s
	iters: 200, epoch: 11 | loss: 0.0018283
	speed: 0.0247s/iter; left time: 1035.8390s
	iters: 300, epoch: 11 | loss: 0.0561423
	speed: 0.0232s/iter; left time: 971.4866s
	iters: 400, epoch: 11 | loss: 0.0027442
	speed: 0.0261s/iter; left time: 1092.5884s
Epoch: 11 cost time: 12.991074800491333
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.969410 --> -0.976271).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0024365
	speed: 0.1477s/iter; left time: 6149.7977s
	iters: 200, epoch: 12 | loss: 0.0036420
	speed: 0.0236s/iter; left time: 978.4195s
	iters: 300, epoch: 12 | loss: 0.0068222
	speed: 0.0206s/iter; left time: 855.2658s
	iters: 400, epoch: 12 | loss: 0.0197184
	speed: 0.0213s/iter; left time: 879.2137s
Epoch: 12 cost time: 10.972400665283203
Epoch: 12, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0305212
	speed: 0.1165s/iter; left time: 4797.6326s
	iters: 200, epoch: 13 | loss: 0.0048603
	speed: 0.0217s/iter; left time: 890.8765s
	iters: 300, epoch: 13 | loss: 0.0057753
	speed: 0.0222s/iter; left time: 911.3311s
	iters: 400, epoch: 13 | loss: 0.0018302
	speed: 0.0218s/iter; left time: 891.0619s
Epoch: 13 cost time: 10.75831651687622
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0310407
	speed: 0.1270s/iter; left time: 5168.4223s
	iters: 200, epoch: 14 | loss: 0.0129004
	speed: 0.0216s/iter; left time: 878.4391s
	iters: 300, epoch: 14 | loss: 0.0494516
	speed: 0.0219s/iter; left time: 887.4876s
	iters: 400, epoch: 14 | loss: 0.1146410
	speed: 0.0272s/iter; left time: 1100.4491s
Epoch: 14 cost time: 11.950530529022217
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0020006
	speed: 0.1278s/iter; left time: 5141.8056s
	iters: 200, epoch: 15 | loss: 0.0525913
	speed: 0.0202s/iter; left time: 812.0827s
	iters: 300, epoch: 15 | loss: 0.0317431
	speed: 0.0219s/iter; left time: 876.0390s
	iters: 400, epoch: 15 | loss: 0.0036535
	speed: 0.0223s/iter; left time: 889.9535s
Epoch: 15 cost time: 10.39922022819519
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0043546
	speed: 0.1301s/iter; left time: 5172.3144s
	iters: 200, epoch: 16 | loss: 0.4696933
	speed: 0.0195s/iter; left time: 775.0048s
	iters: 300, epoch: 16 | loss: 0.0085961
	speed: 0.0230s/iter; left time: 908.8633s
	iters: 400, epoch: 16 | loss: 0.0093573
	speed: 0.0253s/iter; left time: 999.0223s
Epoch: 16 cost time: 11.05518126487732
Epoch: 16, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5041899
	speed: 0.1471s/iter; left time: 5779.4602s
	iters: 200, epoch: 17 | loss: 0.0090196
	speed: 0.0236s/iter; left time: 924.6263s
	iters: 300, epoch: 17 | loss: 0.0115312
	speed: 0.0226s/iter; left time: 881.9702s
	iters: 400, epoch: 17 | loss: 0.0563086
	speed: 0.0222s/iter; left time: 864.4112s
Epoch: 17 cost time: 11.025263547897339
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0154480
	speed: 0.1386s/iter; left time: 5380.0863s
	iters: 200, epoch: 18 | loss: 0.0185480
	speed: 0.0242s/iter; left time: 936.4022s
	iters: 300, epoch: 18 | loss: 0.0027630
	speed: 0.0232s/iter; left time: 894.9912s
	iters: 400, epoch: 18 | loss: 0.0027545
	speed: 0.0209s/iter; left time: 804.3077s
Epoch: 18 cost time: 11.31783938407898
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1198490
	speed: 0.1107s/iter; left time: 4247.9330s
	iters: 200, epoch: 19 | loss: 0.0061009
	speed: 0.0228s/iter; left time: 871.7405s
	iters: 300, epoch: 19 | loss: 0.2462879
	speed: 0.0222s/iter; left time: 847.0708s
	iters: 400, epoch: 19 | loss: 0.0003409
	speed: 0.0252s/iter; left time: 959.0591s
Epoch: 19 cost time: 11.161210060119629
Epoch: 19, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0127768
	speed: 0.1208s/iter; left time: 4578.9087s
	iters: 200, epoch: 20 | loss: 0.0428910
	speed: 0.0213s/iter; left time: 806.2106s
	iters: 300, epoch: 20 | loss: 0.0081837
	speed: 0.0258s/iter; left time: 974.0292s
	iters: 400, epoch: 20 | loss: 0.0024072
	speed: 0.0267s/iter; left time: 1002.6598s
Epoch: 20 cost time: 11.872191905975342
Epoch: 20, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0008473
	speed: 0.1423s/iter; left time: 5326.6491s
	iters: 200, epoch: 21 | loss: 0.0991062
	speed: 0.0221s/iter; left time: 823.0584s
	iters: 300, epoch: 21 | loss: 0.0007965
	speed: 0.0213s/iter; left time: 793.3228s
	iters: 400, epoch: 21 | loss: 0.0020412
	speed: 0.0267s/iter; left time: 992.8346s
Epoch: 21 cost time: 11.803545475006104
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 904098
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1498441
	speed: 0.0396s/iter; left time: 1852.3493s
	iters: 200, epoch: 1 | loss: 0.7535740
	speed: 0.0229s/iter; left time: 1071.7315s
	iters: 300, epoch: 1 | loss: 0.5467017
	speed: 0.0246s/iter; left time: 1147.9149s
	iters: 400, epoch: 1 | loss: 0.2639517
	speed: 0.0250s/iter; left time: 1164.2968s
Epoch: 1 cost time: 13.119258642196655
Epoch: 1, Steps: 469 | Train Loss: 0.738 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
Validation loss decreased (inf --> -0.910803).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4007474
	speed: 0.1386s/iter; left time: 6419.6543s
	iters: 200, epoch: 2 | loss: 0.0561805
	speed: 0.0224s/iter; left time: 1037.7272s
	iters: 300, epoch: 2 | loss: 0.2405951
	speed: 0.0241s/iter; left time: 1113.5177s
	iters: 400, epoch: 2 | loss: 0.0378755
	speed: 0.0270s/iter; left time: 1244.9547s
Epoch: 2 cost time: 11.865519523620605
Epoch: 2, Steps: 469 | Train Loss: 0.150 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.910803 --> -0.950256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3591086
	speed: 0.1447s/iter; left time: 6638.3096s
	iters: 200, epoch: 3 | loss: 0.5643883
	speed: 0.0244s/iter; left time: 1116.1498s
	iters: 300, epoch: 3 | loss: 0.1656300
	speed: 0.0253s/iter; left time: 1157.2802s
	iters: 400, epoch: 3 | loss: 0.0242671
	speed: 0.0231s/iter; left time: 1050.8556s
Epoch: 3 cost time: 11.780754327774048
Epoch: 3, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.198 Vali Acc: 0.945 Test Loss: 0.198 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1766197
	speed: 0.1308s/iter; left time: 5937.7676s
	iters: 200, epoch: 4 | loss: 0.0624625
	speed: 0.0271s/iter; left time: 1229.5623s
	iters: 300, epoch: 4 | loss: 0.0768655
	speed: 0.0283s/iter; left time: 1279.6719s
	iters: 400, epoch: 4 | loss: 0.0673606
	speed: 0.0248s/iter; left time: 1118.8279s
Epoch: 4 cost time: 12.480600357055664
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.950256 --> -0.965408).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0099821
	speed: 0.1169s/iter; left time: 5251.0930s
	iters: 200, epoch: 5 | loss: 0.0587031
	speed: 0.0227s/iter; left time: 1018.1619s
	iters: 300, epoch: 5 | loss: 0.0557710
	speed: 0.0235s/iter; left time: 1051.9148s
	iters: 400, epoch: 5 | loss: 0.0846378
	speed: 0.0225s/iter; left time: 1005.2068s
Epoch: 5 cost time: 11.200560092926025
Epoch: 5, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2368405
	speed: 0.1305s/iter; left time: 5802.8849s
	iters: 200, epoch: 6 | loss: 0.0429447
	speed: 0.0191s/iter; left time: 846.8472s
	iters: 300, epoch: 6 | loss: 0.0492441
	speed: 0.0214s/iter; left time: 945.6906s
	iters: 400, epoch: 6 | loss: 0.0038099
	speed: 0.0220s/iter; left time: 970.3060s
Epoch: 6 cost time: 10.248078107833862
Epoch: 6, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0427707
	speed: 0.1205s/iter; left time: 5301.3318s
	iters: 200, epoch: 7 | loss: 0.0571703
	speed: 0.0243s/iter; left time: 1064.6052s
	iters: 300, epoch: 7 | loss: 0.0077319
	speed: 0.0201s/iter; left time: 880.0556s
	iters: 400, epoch: 7 | loss: 0.0477248
	speed: 0.0187s/iter; left time: 814.8266s
Epoch: 7 cost time: 10.350809812545776
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0063792
	speed: 0.0878s/iter; left time: 3820.2451s
	iters: 200, epoch: 8 | loss: 0.0096425
	speed: 0.0211s/iter; left time: 914.2436s
	iters: 300, epoch: 8 | loss: 0.0057494
	speed: 0.0236s/iter; left time: 1022.7880s
	iters: 400, epoch: 8 | loss: 0.0227593
	speed: 0.0257s/iter; left time: 1109.7600s
Epoch: 8 cost time: 11.091586828231812
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0141937
	speed: 0.1280s/iter; left time: 5512.0740s
	iters: 200, epoch: 9 | loss: 0.0130414
	speed: 0.0201s/iter; left time: 861.4095s
	iters: 300, epoch: 9 | loss: 0.3253457
	speed: 0.0208s/iter; left time: 893.1015s
	iters: 400, epoch: 9 | loss: 0.1087808
	speed: 0.0222s/iter; left time: 948.3660s
Epoch: 9 cost time: 10.399660587310791
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0068205
	speed: 0.1411s/iter; left time: 6005.9664s
	iters: 200, epoch: 10 | loss: 0.3051890
	speed: 0.0238s/iter; left time: 1009.5384s
	iters: 300, epoch: 10 | loss: 0.0300749
	speed: 0.0231s/iter; left time: 978.4851s
	iters: 400, epoch: 10 | loss: 0.6823153
	speed: 0.0211s/iter; left time: 894.0215s
Epoch: 10 cost time: 10.911600828170776
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2155333
	speed: 0.1131s/iter; left time: 4761.9149s
	iters: 200, epoch: 11 | loss: 0.0323297
	speed: 0.0245s/iter; left time: 1027.3720s
	iters: 300, epoch: 11 | loss: 0.0037600
	speed: 0.0228s/iter; left time: 955.1792s
	iters: 400, epoch: 11 | loss: 0.0510974
	speed: 0.0243s/iter; left time: 1016.5137s
Epoch: 11 cost time: 11.675334215164185
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1178860
	speed: 0.1413s/iter; left time: 5883.4625s
	iters: 200, epoch: 12 | loss: 0.0390191
	speed: 0.0248s/iter; left time: 1031.1056s
	iters: 300, epoch: 12 | loss: 0.0082252
	speed: 0.0235s/iter; left time: 975.7594s
	iters: 400, epoch: 12 | loss: 0.0139121
	speed: 0.0253s/iter; left time: 1046.0614s
Epoch: 12 cost time: 11.923576831817627
Epoch: 12, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1724585
	speed: 0.1529s/iter; left time: 6294.3196s
	iters: 200, epoch: 13 | loss: 0.2918364
	speed: 0.0241s/iter; left time: 988.3852s
	iters: 300, epoch: 13 | loss: 0.0363025
	speed: 0.0248s/iter; left time: 1014.1514s
	iters: 400, epoch: 13 | loss: 0.0279762
	speed: 0.0229s/iter; left time: 937.9714s
Epoch: 13 cost time: 11.68380355834961
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0838103
	speed: 0.1225s/iter; left time: 4986.9750s
	iters: 200, epoch: 14 | loss: 0.0087897
	speed: 0.0212s/iter; left time: 862.2670s
	iters: 300, epoch: 14 | loss: 0.0023736
	speed: 0.0217s/iter; left time: 878.9293s
	iters: 400, epoch: 14 | loss: 0.0019388
	speed: 0.0206s/iter; left time: 833.5326s
Epoch: 14 cost time: 10.16173005104065
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9654088050314465
model parameter : 903970
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3081074
	speed: 0.0392s/iter; left time: 1836.2989s
	iters: 200, epoch: 1 | loss: 0.5432150
	speed: 0.0228s/iter; left time: 1066.0031s
	iters: 300, epoch: 1 | loss: 0.4082003
	speed: 0.0237s/iter; left time: 1106.2003s
	iters: 400, epoch: 1 | loss: 0.2079911
	speed: 0.0240s/iter; left time: 1116.1663s
Epoch: 1 cost time: 12.77338719367981
Epoch: 1, Steps: 469 | Train Loss: 0.796 Vali Loss: 0.316 Vali Acc: 0.904 Test Loss: 0.316 Test Acc: 0.904
Validation loss decreased (inf --> -0.903942).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2004076
	speed: 0.1280s/iter; left time: 5929.7491s
	iters: 200, epoch: 2 | loss: 0.2974375
	speed: 0.0206s/iter; left time: 951.8255s
	iters: 300, epoch: 2 | loss: 0.0618952
	speed: 0.0203s/iter; left time: 934.8538s
	iters: 400, epoch: 2 | loss: 0.0348650
	speed: 0.0217s/iter; left time: 999.3884s
Epoch: 2 cost time: 9.959502696990967
Epoch: 2, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.903942 --> -0.938820).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0381495
	speed: 0.1038s/iter; left time: 4760.2048s
	iters: 200, epoch: 3 | loss: 0.0061552
	speed: 0.0221s/iter; left time: 1011.2328s
	iters: 300, epoch: 3 | loss: 0.0158164
	speed: 0.0227s/iter; left time: 1037.8648s
	iters: 400, epoch: 3 | loss: 0.0238182
	speed: 0.0208s/iter; left time: 949.2900s
Epoch: 3 cost time: 10.462748765945435
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.938820 --> -0.958832).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0389149
	speed: 0.1236s/iter; left time: 5612.7715s
	iters: 200, epoch: 4 | loss: 0.1918919
	speed: 0.0210s/iter; left time: 950.7212s
	iters: 300, epoch: 4 | loss: 0.0845129
	speed: 0.0231s/iter; left time: 1044.5217s
	iters: 400, epoch: 4 | loss: 0.0062922
	speed: 0.0237s/iter; left time: 1068.4647s
Epoch: 4 cost time: 11.339535236358643
Epoch: 4, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.958832 --> -0.966265).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0036842
	speed: 0.1464s/iter; left time: 6578.4274s
	iters: 200, epoch: 5 | loss: 0.1308766
	speed: 0.0227s/iter; left time: 1015.4910s
	iters: 300, epoch: 5 | loss: 0.0146531
	speed: 0.0230s/iter; left time: 1029.9804s
	iters: 400, epoch: 5 | loss: 0.1537784
	speed: 0.0203s/iter; left time: 905.0408s
Epoch: 5 cost time: 10.79281497001648
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0817240
	speed: 0.1245s/iter; left time: 5535.2754s
	iters: 200, epoch: 6 | loss: 0.0050269
	speed: 0.0213s/iter; left time: 943.7564s
	iters: 300, epoch: 6 | loss: 0.0442514
	speed: 0.0220s/iter; left time: 974.1016s
	iters: 400, epoch: 6 | loss: 0.0479251
	speed: 0.0203s/iter; left time: 896.9351s
Epoch: 6 cost time: 10.616934299468994
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0049241
	speed: 0.1314s/iter; left time: 5780.6004s
	iters: 200, epoch: 7 | loss: 0.0248870
	speed: 0.0247s/iter; left time: 1082.4417s
	iters: 300, epoch: 7 | loss: 0.2583117
	speed: 0.0263s/iter; left time: 1152.2555s
	iters: 400, epoch: 7 | loss: 0.0011805
	speed: 0.0252s/iter; left time: 1102.0212s
Epoch: 7 cost time: 12.83927297592163
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0039269
	speed: 0.1608s/iter; left time: 6997.0136s
	iters: 200, epoch: 8 | loss: 0.0061651
	speed: 0.0231s/iter; left time: 1001.9497s
	iters: 300, epoch: 8 | loss: 0.1468755
	speed: 0.0251s/iter; left time: 1086.3599s
	iters: 400, epoch: 8 | loss: 0.1097699
	speed: 0.0251s/iter; left time: 1083.1081s
Epoch: 8 cost time: 12.027910232543945
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0369413
	speed: 0.1266s/iter; left time: 5450.2669s
	iters: 200, epoch: 9 | loss: 0.0199308
	speed: 0.0232s/iter; left time: 994.5679s
	iters: 300, epoch: 9 | loss: 0.0008451
	speed: 0.0225s/iter; left time: 963.5680s
	iters: 400, epoch: 9 | loss: 0.0180442
	speed: 0.0205s/iter; left time: 877.4117s
Epoch: 9 cost time: 10.475856304168701
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0143585
	speed: 0.0974s/iter; left time: 4147.2825s
	iters: 200, epoch: 10 | loss: 0.0012087
	speed: 0.0218s/iter; left time: 926.4587s
	iters: 300, epoch: 10 | loss: 0.1254464
	speed: 0.0247s/iter; left time: 1047.6231s
	iters: 400, epoch: 10 | loss: 0.0014107
	speed: 0.0227s/iter; left time: 959.5922s
Epoch: 10 cost time: 10.772855520248413
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0286605
	speed: 0.1184s/iter; left time: 4984.9782s
	iters: 200, epoch: 11 | loss: 0.0018648
	speed: 0.0208s/iter; left time: 872.3497s
	iters: 300, epoch: 11 | loss: 0.0163153
	speed: 0.0265s/iter; left time: 1111.4473s
	iters: 400, epoch: 11 | loss: 0.0041094
	speed: 0.0269s/iter; left time: 1124.8069s
Epoch: 11 cost time: 11.473798274993896
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1097189
	speed: 0.1218s/iter; left time: 5070.9831s
	iters: 200, epoch: 12 | loss: 0.0272725
	speed: 0.0244s/iter; left time: 1015.1471s
	iters: 300, epoch: 12 | loss: 0.0015331
	speed: 0.0223s/iter; left time: 923.5717s
	iters: 400, epoch: 12 | loss: 0.0129186
	speed: 0.0243s/iter; left time: 1003.8273s
Epoch: 12 cost time: 11.500974655151367
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0147283
	speed: 0.1261s/iter; left time: 5190.2883s
	iters: 200, epoch: 13 | loss: 0.0029025
	speed: 0.0203s/iter; left time: 833.2654s
	iters: 300, epoch: 13 | loss: 0.0056815
	speed: 0.0220s/iter; left time: 901.4110s
	iters: 400, epoch: 13 | loss: 0.0268226
	speed: 0.0225s/iter; left time: 917.9814s
Epoch: 13 cost time: 10.933960199356079
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0058770
	speed: 0.1375s/iter; left time: 5598.3621s
	iters: 200, epoch: 14 | loss: 0.0004203
	speed: 0.0280s/iter; left time: 1138.6448s
	iters: 300, epoch: 14 | loss: 0.0038189
	speed: 0.0229s/iter; left time: 929.1395s
	iters: 400, epoch: 14 | loss: 0.0040983
	speed: 0.0246s/iter; left time: 995.2308s
Epoch: 14 cost time: 12.301108360290527
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.966837).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0052584
	speed: 0.1333s/iter; left time: 5361.8578s
	iters: 200, epoch: 15 | loss: 0.0086081
	speed: 0.0231s/iter; left time: 925.7811s
	iters: 300, epoch: 15 | loss: 0.0046436
	speed: 0.0248s/iter; left time: 993.6408s
	iters: 400, epoch: 15 | loss: 0.0083526
	speed: 0.0259s/iter; left time: 1033.8904s
Epoch: 15 cost time: 11.631234645843506
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.966837 --> -0.967695).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1301511
	speed: 0.1218s/iter; left time: 4845.2509s
	iters: 200, epoch: 16 | loss: 0.0086233
	speed: 0.0227s/iter; left time: 901.7393s
	iters: 300, epoch: 16 | loss: 0.0051946
	speed: 0.0256s/iter; left time: 1013.4722s
	iters: 400, epoch: 16 | loss: 0.0083219
	speed: 0.0201s/iter; left time: 793.8970s
Epoch: 16 cost time: 10.934632539749146
Epoch: 16, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
Validation loss decreased (-0.967695 --> -0.969124).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0034269
	speed: 0.1268s/iter; left time: 4983.0778s
	iters: 200, epoch: 17 | loss: 0.0026132
	speed: 0.0248s/iter; left time: 970.8075s
	iters: 300, epoch: 17 | loss: 0.0023485
	speed: 0.0273s/iter; left time: 1066.1305s
	iters: 400, epoch: 17 | loss: 0.2495213
	speed: 0.0266s/iter; left time: 1038.2666s
Epoch: 17 cost time: 12.374502897262573
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0129239
	speed: 0.1381s/iter; left time: 5363.4062s
	iters: 200, epoch: 18 | loss: 0.0024801
	speed: 0.0275s/iter; left time: 1066.9510s
	iters: 300, epoch: 18 | loss: 0.0005410
	speed: 0.0240s/iter; left time: 925.8334s
	iters: 400, epoch: 18 | loss: 0.0027812
	speed: 0.0226s/iter; left time: 869.0096s
Epoch: 18 cost time: 12.051998138427734
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0071572
	speed: 0.1272s/iter; left time: 4879.0091s
	iters: 200, epoch: 19 | loss: 0.0038998
	speed: 0.0233s/iter; left time: 889.7130s
	iters: 300, epoch: 19 | loss: 0.0012009
	speed: 0.0200s/iter; left time: 763.6571s
	iters: 400, epoch: 19 | loss: 0.0012414
	speed: 0.0222s/iter; left time: 843.6315s
Epoch: 19 cost time: 10.878389596939087
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0005530
	speed: 0.1254s/iter; left time: 4750.3540s
	iters: 200, epoch: 20 | loss: 0.0005191
	speed: 0.0223s/iter; left time: 841.0350s
	iters: 300, epoch: 20 | loss: 0.0005205
	speed: 0.0222s/iter; left time: 834.9961s
	iters: 400, epoch: 20 | loss: 0.0011897
	speed: 0.0253s/iter; left time: 950.6988s
Epoch: 20 cost time: 11.465356588363647
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0058666
	speed: 0.1664s/iter; left time: 6226.6510s
	iters: 200, epoch: 21 | loss: 0.0031889
	speed: 0.0235s/iter; left time: 876.2350s
	iters: 300, epoch: 21 | loss: 0.0003657
	speed: 0.0227s/iter; left time: 844.1607s
	iters: 400, epoch: 21 | loss: 0.0008326
	speed: 0.0222s/iter; left time: 824.2034s
Epoch: 21 cost time: 12.174907207489014
Epoch: 21, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0029206
	speed: 0.1433s/iter; left time: 5296.0821s
	iters: 200, epoch: 22 | loss: 0.0015169
	speed: 0.0268s/iter; left time: 988.2612s
	iters: 300, epoch: 22 | loss: 0.4361360
	speed: 0.0260s/iter; left time: 955.4052s
	iters: 400, epoch: 22 | loss: 0.0254139
	speed: 0.0222s/iter; left time: 813.6901s
Epoch: 22 cost time: 12.165241003036499
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.969124 --> -0.971697).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0007777
	speed: 0.1195s/iter; left time: 4359.7893s
	iters: 200, epoch: 23 | loss: 0.0019092
	speed: 0.0236s/iter; left time: 857.7142s
	iters: 300, epoch: 23 | loss: 0.0028640
	speed: 0.0227s/iter; left time: 823.0734s
	iters: 400, epoch: 23 | loss: 0.0125048
	speed: 0.0237s/iter; left time: 856.0815s
Epoch: 23 cost time: 11.45568060874939
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0088769
	speed: 0.1217s/iter; left time: 4382.6898s
	iters: 200, epoch: 24 | loss: 0.0007179
	speed: 0.0218s/iter; left time: 784.7199s
	iters: 300, epoch: 24 | loss: 0.0009305
	speed: 0.0238s/iter; left time: 850.6617s
	iters: 400, epoch: 24 | loss: 0.0038690
	speed: 0.0249s/iter; left time: 890.0893s
Epoch: 24 cost time: 11.333899736404419
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0004748
	speed: 0.1253s/iter; left time: 4453.7098s
	iters: 200, epoch: 25 | loss: 0.0015513
	speed: 0.0219s/iter; left time: 775.3317s
	iters: 300, epoch: 25 | loss: 0.0002336
	speed: 0.0200s/iter; left time: 706.4363s
	iters: 400, epoch: 25 | loss: 0.0152260
	speed: 0.0215s/iter; left time: 757.8193s
Epoch: 25 cost time: 10.331166505813599
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0032413
	speed: 0.1119s/iter; left time: 3924.0644s
	iters: 200, epoch: 26 | loss: 0.0008819
	speed: 0.0251s/iter; left time: 877.5404s
	iters: 300, epoch: 26 | loss: 0.0193384
	speed: 0.0203s/iter; left time: 707.9684s
	iters: 400, epoch: 26 | loss: 0.0054741
	speed: 0.0192s/iter; left time: 666.7584s
Epoch: 26 cost time: 10.560372352600098
Epoch: 26, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0009293
	speed: 0.0986s/iter; left time: 3413.8316s
	iters: 200, epoch: 27 | loss: 0.0001141
	speed: 0.0273s/iter; left time: 940.6873s
	iters: 300, epoch: 27 | loss: 0.0540734
	speed: 0.0253s/iter; left time: 870.9597s
	iters: 400, epoch: 27 | loss: 0.0865214
	speed: 0.0237s/iter; left time: 813.3855s
Epoch: 27 cost time: 12.04097867012024
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972840).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0007319
	speed: 0.1226s/iter; left time: 4186.5252s
	iters: 200, epoch: 28 | loss: 0.0294079
	speed: 0.0251s/iter; left time: 854.4023s
	iters: 300, epoch: 28 | loss: 0.0007311
	speed: 0.0260s/iter; left time: 882.9088s
	iters: 400, epoch: 28 | loss: 0.0029361
	speed: 0.0273s/iter; left time: 924.3930s
Epoch: 28 cost time: 12.374726295471191
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0279458
	speed: 0.1399s/iter; left time: 4710.7230s
	iters: 200, epoch: 29 | loss: 0.0003567
	speed: 0.0262s/iter; left time: 879.4406s
	iters: 300, epoch: 29 | loss: 0.0011923
	speed: 0.0227s/iter; left time: 759.3359s
	iters: 400, epoch: 29 | loss: 0.0502132
	speed: 0.0209s/iter; left time: 695.8352s
Epoch: 29 cost time: 11.345947265625
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0026216
	speed: 0.1217s/iter; left time: 4039.7398s
	iters: 200, epoch: 30 | loss: 0.0021439
	speed: 0.0261s/iter; left time: 864.3201s
	iters: 300, epoch: 30 | loss: 0.0007007
	speed: 0.0250s/iter; left time: 824.2625s
	iters: 400, epoch: 30 | loss: 0.4921219
	speed: 0.0288s/iter; left time: 947.3727s
Epoch: 30 cost time: 12.726353645324707
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0006637
	speed: 0.1331s/iter; left time: 4355.1981s
	iters: 200, epoch: 31 | loss: 0.1989859
	speed: 0.0283s/iter; left time: 922.0730s
	iters: 300, epoch: 31 | loss: 0.0009093
	speed: 0.0257s/iter; left time: 837.4775s
	iters: 400, epoch: 31 | loss: 0.0168839
	speed: 0.0258s/iter; left time: 837.5339s
Epoch: 31 cost time: 12.76132345199585
Epoch: 31, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0093762
	speed: 0.1370s/iter; left time: 4420.8981s
	iters: 200, epoch: 32 | loss: 0.0018674
	speed: 0.0229s/iter; left time: 737.8779s
	iters: 300, epoch: 32 | loss: 0.0004740
	speed: 0.0245s/iter; left time: 785.9061s
	iters: 400, epoch: 32 | loss: 0.0013712
	speed: 0.0214s/iter; left time: 683.9141s
Epoch: 32 cost time: 11.442048072814941
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0417953
	speed: 0.0973s/iter; left time: 3092.8783s
	iters: 200, epoch: 33 | loss: 0.0408617
	speed: 0.0210s/iter; left time: 665.2254s
	iters: 300, epoch: 33 | loss: 0.0005217
	speed: 0.0229s/iter; left time: 722.3743s
	iters: 400, epoch: 33 | loss: 0.0034026
	speed: 0.0211s/iter; left time: 665.5537s
Epoch: 33 cost time: 10.183910369873047
Epoch: 33, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0085974
	speed: 0.1034s/iter; left time: 3238.8098s
	iters: 200, epoch: 34 | loss: 0.0028882
	speed: 0.0216s/iter; left time: 674.8486s
	iters: 300, epoch: 34 | loss: 0.1548221
	speed: 0.0225s/iter; left time: 699.6216s
	iters: 400, epoch: 34 | loss: 0.0052840
	speed: 0.0235s/iter; left time: 729.0291s
Epoch: 34 cost time: 10.898954629898071
Epoch: 34, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0003461
	speed: 0.1306s/iter; left time: 4028.1635s
	iters: 200, epoch: 35 | loss: 0.0011338
	speed: 0.0221s/iter; left time: 681.1580s
	iters: 300, epoch: 35 | loss: 0.0001040
	speed: 0.0204s/iter; left time: 624.9656s
	iters: 400, epoch: 35 | loss: 0.0026504
	speed: 0.0224s/iter; left time: 685.5614s
Epoch: 35 cost time: 10.66787075996399
Epoch: 35, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0040975
	speed: 0.1068s/iter; left time: 3244.7597s
	iters: 200, epoch: 36 | loss: 0.0000768
	speed: 0.0233s/iter; left time: 705.0749s
	iters: 300, epoch: 36 | loss: 0.0004738
	speed: 0.0255s/iter; left time: 769.8769s
	iters: 400, epoch: 36 | loss: 0.0069754
	speed: 0.0247s/iter; left time: 742.8163s
Epoch: 36 cost time: 11.375706434249878
Epoch: 36, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.962 Test Loss: 0.207 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0010206
	speed: 0.1021s/iter; left time: 3053.9543s
	iters: 200, epoch: 37 | loss: 0.0003529
	speed: 0.0241s/iter; left time: 718.5547s
	iters: 300, epoch: 37 | loss: 0.0010112
	speed: 0.0262s/iter; left time: 779.5120s
	iters: 400, epoch: 37 | loss: 0.0012006
	speed: 0.0240s/iter; left time: 711.0916s
Epoch: 37 cost time: 11.761967420578003
Epoch: 37, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 602530
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1473682
	speed: 0.0430s/iter; left time: 2012.2402s
	iters: 200, epoch: 1 | loss: 0.5464537
	speed: 0.0258s/iter; left time: 1204.9516s
	iters: 300, epoch: 1 | loss: 0.2376848
	speed: 0.0244s/iter; left time: 1137.4779s
	iters: 400, epoch: 1 | loss: 0.3210964
	speed: 0.0237s/iter; left time: 1100.0931s
Epoch: 1 cost time: 13.33065128326416
Epoch: 1, Steps: 469 | Train Loss: 0.787 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (inf --> -0.902513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2131172
	speed: 0.1145s/iter; left time: 5307.1039s
	iters: 200, epoch: 2 | loss: 0.2153974
	speed: 0.0221s/iter; left time: 1020.9705s
	iters: 300, epoch: 2 | loss: 0.1715343
	speed: 0.0235s/iter; left time: 1083.5411s
	iters: 400, epoch: 2 | loss: 0.0864396
	speed: 0.0272s/iter; left time: 1251.4808s
Epoch: 2 cost time: 11.76585054397583
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.245 Vali Acc: 0.921 Test Loss: 0.245 Test Acc: 0.921
Validation loss decreased (-0.902513 --> -0.921381).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0760238
	speed: 0.1436s/iter; left time: 6584.4741s
	iters: 200, epoch: 3 | loss: 0.0958172
	speed: 0.0239s/iter; left time: 1094.4252s
	iters: 300, epoch: 3 | loss: 0.2055361
	speed: 0.0285s/iter; left time: 1301.2047s
	iters: 400, epoch: 3 | loss: 0.0227293
	speed: 0.0264s/iter; left time: 1201.6983s
Epoch: 3 cost time: 12.341391324996948
Epoch: 3, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.921381 --> -0.958260).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1682449
	speed: 0.1273s/iter; left time: 5778.2683s
	iters: 200, epoch: 4 | loss: 0.0333330
	speed: 0.0232s/iter; left time: 1050.8329s
	iters: 300, epoch: 4 | loss: 0.0074650
	speed: 0.0250s/iter; left time: 1131.7754s
	iters: 400, epoch: 4 | loss: 0.1529250
	speed: 0.0228s/iter; left time: 1030.1964s
Epoch: 4 cost time: 11.486660957336426
Epoch: 4, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0116864
	speed: 0.1217s/iter; left time: 5468.8454s
	iters: 200, epoch: 5 | loss: 0.0189280
	speed: 0.0212s/iter; left time: 949.9677s
	iters: 300, epoch: 5 | loss: 0.0154430
	speed: 0.0229s/iter; left time: 1024.6697s
	iters: 400, epoch: 5 | loss: 0.0053475
	speed: 0.0219s/iter; left time: 975.3647s
Epoch: 5 cost time: 10.49277114868164
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0845711
	speed: 0.0894s/iter; left time: 3975.7926s
	iters: 200, epoch: 6 | loss: 0.0057974
	speed: 0.0216s/iter; left time: 957.3782s
	iters: 300, epoch: 6 | loss: 0.0103352
	speed: 0.0227s/iter; left time: 1003.5707s
	iters: 400, epoch: 6 | loss: 0.1227423
	speed: 0.0261s/iter; left time: 1153.5863s
Epoch: 6 cost time: 11.389470338821411
Epoch: 6, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
Validation loss decreased (-0.958260 --> -0.965979).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0027338
	speed: 0.1213s/iter; left time: 5335.3181s
	iters: 200, epoch: 7 | loss: 0.0136177
	speed: 0.0223s/iter; left time: 980.2153s
	iters: 300, epoch: 7 | loss: 0.0045807
	speed: 0.0239s/iter; left time: 1047.9381s
	iters: 400, epoch: 7 | loss: 0.0146894
	speed: 0.0257s/iter; left time: 1123.9431s
Epoch: 7 cost time: 11.94521975517273
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0021507
	speed: 0.1311s/iter; left time: 5706.1123s
	iters: 200, epoch: 8 | loss: 0.0023551
	speed: 0.0197s/iter; left time: 856.0585s
	iters: 300, epoch: 8 | loss: 0.0042054
	speed: 0.0210s/iter; left time: 907.6224s
	iters: 400, epoch: 8 | loss: 0.1257980
	speed: 0.0211s/iter; left time: 913.1676s
Epoch: 8 cost time: 9.877549886703491
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0023697
	speed: 0.1163s/iter; left time: 5005.7522s
	iters: 200, epoch: 9 | loss: 0.0205839
	speed: 0.0240s/iter; left time: 1030.2899s
	iters: 300, epoch: 9 | loss: 0.0505741
	speed: 0.0310s/iter; left time: 1330.0010s
	iters: 400, epoch: 9 | loss: 0.0043803
	speed: 0.0233s/iter; left time: 994.1949s
Epoch: 9 cost time: 12.407829761505127
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0019933
	speed: 0.1231s/iter; left time: 5241.5461s
	iters: 200, epoch: 10 | loss: 0.4803911
	speed: 0.0241s/iter; left time: 1022.4076s
	iters: 300, epoch: 10 | loss: 0.0112212
	speed: 0.0216s/iter; left time: 914.2515s
	iters: 400, epoch: 10 | loss: 0.0131832
	speed: 0.0222s/iter; left time: 937.7523s
Epoch: 10 cost time: 11.054882049560547
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0073642
	speed: 0.1367s/iter; left time: 5757.8479s
	iters: 200, epoch: 11 | loss: 0.0009434
	speed: 0.0240s/iter; left time: 1008.7974s
	iters: 300, epoch: 11 | loss: 0.0068887
	speed: 0.0255s/iter; left time: 1068.2082s
	iters: 400, epoch: 11 | loss: 0.0042086
	speed: 0.0250s/iter; left time: 1046.1857s
Epoch: 11 cost time: 12.194661140441895
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2249429
	speed: 0.1000s/iter; left time: 4164.4031s
	iters: 200, epoch: 12 | loss: 0.0387694
	speed: 0.0180s/iter; left time: 749.6484s
	iters: 300, epoch: 12 | loss: 0.0003280
	speed: 0.0217s/iter; left time: 898.5849s
	iters: 400, epoch: 12 | loss: 0.0117002
	speed: 0.0206s/iter; left time: 849.6994s
Epoch: 12 cost time: 9.844778060913086
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.967123).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0009057
	speed: 0.1271s/iter; left time: 5234.8677s
	iters: 200, epoch: 13 | loss: 0.0456613
	speed: 0.0259s/iter; left time: 1065.0783s
	iters: 300, epoch: 13 | loss: 0.0012089
	speed: 0.0270s/iter; left time: 1104.3939s
	iters: 400, epoch: 13 | loss: 0.0092470
	speed: 0.0254s/iter; left time: 1039.9457s
Epoch: 13 cost time: 11.982674837112427
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0235274
	speed: 0.1317s/iter; left time: 5360.0373s
	iters: 200, epoch: 14 | loss: 0.0005809
	speed: 0.0220s/iter; left time: 894.8908s
	iters: 300, epoch: 14 | loss: 0.0015670
	speed: 0.0227s/iter; left time: 919.8853s
	iters: 400, epoch: 14 | loss: 0.0015251
	speed: 0.0249s/iter; left time: 1007.2655s
Epoch: 14 cost time: 11.215455532073975
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0127872
	speed: 0.1324s/iter; left time: 5327.9594s
	iters: 200, epoch: 15 | loss: 0.0015347
	speed: 0.0228s/iter; left time: 915.2620s
	iters: 300, epoch: 15 | loss: 0.0664514
	speed: 0.0206s/iter; left time: 824.6376s
	iters: 400, epoch: 15 | loss: 0.0117638
	speed: 0.0221s/iter; left time: 880.8786s
Epoch: 15 cost time: 10.55122184753418
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0011939
	speed: 0.1081s/iter; left time: 4299.3572s
	iters: 200, epoch: 16 | loss: 0.0026914
	speed: 0.0238s/iter; left time: 942.5500s
	iters: 300, epoch: 16 | loss: 0.0029001
	speed: 0.0272s/iter; left time: 1078.1627s
	iters: 400, epoch: 16 | loss: 0.0190826
	speed: 0.0244s/iter; left time: 961.7627s
Epoch: 16 cost time: 11.603495597839355
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.967123 --> -0.970267).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0008828
	speed: 0.1324s/iter; left time: 5201.5555s
	iters: 200, epoch: 17 | loss: 0.0019886
	speed: 0.0241s/iter; left time: 943.5782s
	iters: 300, epoch: 17 | loss: 0.0005349
	speed: 0.0232s/iter; left time: 907.8575s
	iters: 400, epoch: 17 | loss: 0.0018018
	speed: 0.0226s/iter; left time: 880.4515s
Epoch: 17 cost time: 11.40108585357666
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0007537
	speed: 0.1402s/iter; left time: 5441.9514s
	iters: 200, epoch: 18 | loss: 0.0172339
	speed: 0.0233s/iter; left time: 901.0082s
	iters: 300, epoch: 18 | loss: 0.0048073
	speed: 0.0258s/iter; left time: 994.8053s
	iters: 400, epoch: 18 | loss: 0.1208877
	speed: 0.0288s/iter; left time: 1111.4695s
Epoch: 18 cost time: 12.052413940429688
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0009710
	speed: 0.1104s/iter; left time: 4234.3412s
	iters: 200, epoch: 19 | loss: 0.0020617
	speed: 0.0200s/iter; left time: 764.3867s
	iters: 300, epoch: 19 | loss: 0.0025063
	speed: 0.0220s/iter; left time: 838.1668s
	iters: 400, epoch: 19 | loss: 0.0034800
	speed: 0.0219s/iter; left time: 832.0884s
Epoch: 19 cost time: 10.007047176361084
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.7488518
	speed: 0.1118s/iter; left time: 4234.5789s
	iters: 200, epoch: 20 | loss: 0.0360833
	speed: 0.0202s/iter; left time: 761.8960s
	iters: 300, epoch: 20 | loss: 0.1114055
	speed: 0.0210s/iter; left time: 790.6078s
	iters: 400, epoch: 20 | loss: 0.0038277
	speed: 0.0219s/iter; left time: 822.0682s
Epoch: 20 cost time: 10.297526836395264
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0010587
	speed: 0.1213s/iter; left time: 4538.0154s
	iters: 200, epoch: 21 | loss: 0.0239542
	speed: 0.0223s/iter; left time: 831.8914s
	iters: 300, epoch: 21 | loss: 0.0014432
	speed: 0.0224s/iter; left time: 834.2529s
	iters: 400, epoch: 21 | loss: 0.0049781
	speed: 0.0227s/iter; left time: 844.0904s
Epoch: 21 cost time: 10.851473093032837
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0024571
	speed: 0.1225s/iter; left time: 4525.3663s
	iters: 200, epoch: 22 | loss: 0.0002622
	speed: 0.0179s/iter; left time: 659.7043s
	iters: 300, epoch: 22 | loss: 0.0002562
	speed: 0.0182s/iter; left time: 668.4271s
	iters: 400, epoch: 22 | loss: 0.0015562
	speed: 0.0226s/iter; left time: 827.4411s
Epoch: 22 cost time: 9.386006832122803
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0100232
	speed: 0.1124s/iter; left time: 4100.9632s
	iters: 200, epoch: 23 | loss: 0.0037648
	speed: 0.0199s/iter; left time: 725.4500s
	iters: 300, epoch: 23 | loss: 0.0011734
	speed: 0.0223s/iter; left time: 809.2761s
	iters: 400, epoch: 23 | loss: 0.0142220
	speed: 0.0236s/iter; left time: 855.2457s
Epoch: 23 cost time: 10.414965867996216
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0118610
	speed: 0.1313s/iter; left time: 4728.7767s
	iters: 200, epoch: 24 | loss: 0.0008658
	speed: 0.0220s/iter; left time: 790.3489s
	iters: 300, epoch: 24 | loss: 0.0706946
	speed: 0.0193s/iter; left time: 692.0068s
	iters: 400, epoch: 24 | loss: 0.0032982
	speed: 0.0191s/iter; left time: 680.4125s
Epoch: 24 cost time: 9.757890939712524
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0003533
	speed: 0.1102s/iter; left time: 3915.9853s
	iters: 200, epoch: 25 | loss: 0.0103004
	speed: 0.0241s/iter; left time: 855.8735s
	iters: 300, epoch: 25 | loss: 0.0003198
	speed: 0.0248s/iter; left time: 876.6795s
	iters: 400, epoch: 25 | loss: 0.0094513
	speed: 0.0268s/iter; left time: 944.4765s
Epoch: 25 cost time: 12.33583402633667
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.965 Test Loss: 0.229 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0003612
	speed: 0.1250s/iter; left time: 4385.7226s
	iters: 200, epoch: 26 | loss: 0.0010096
	speed: 0.0242s/iter; left time: 847.5239s
	iters: 300, epoch: 26 | loss: 0.0006049
	speed: 0.0244s/iter; left time: 849.8046s
	iters: 400, epoch: 26 | loss: 0.0232948
	speed: 0.0240s/iter; left time: 833.7621s
Epoch: 26 cost time: 11.479737997055054
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9702687249857062
model parameter : 602466
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1847104
	speed: 0.0440s/iter; left time: 2060.2556s
	iters: 200, epoch: 1 | loss: 0.6553968
	speed: 0.0259s/iter; left time: 1210.8117s
	iters: 300, epoch: 1 | loss: 0.5771401
	speed: 0.0243s/iter; left time: 1131.7911s
	iters: 400, epoch: 1 | loss: 0.1352620
	speed: 0.0186s/iter; left time: 864.2218s
Epoch: 1 cost time: 12.74184274673462
Epoch: 1, Steps: 469 | Train Loss: 0.789 Vali Loss: 0.347 Vali Acc: 0.893 Test Loss: 0.347 Test Acc: 0.893
Validation loss decreased (inf --> -0.892792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1882539
	speed: 0.1111s/iter; left time: 5148.2483s
	iters: 200, epoch: 2 | loss: 0.1128544
	speed: 0.0226s/iter; left time: 1046.9809s
	iters: 300, epoch: 2 | loss: 0.1307967
	speed: 0.0231s/iter; left time: 1065.8039s
	iters: 400, epoch: 2 | loss: 0.3471658
	speed: 0.0245s/iter; left time: 1127.3073s
Epoch: 2 cost time: 11.144458532333374
Epoch: 2, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.892792 --> -0.953114).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0197982
	speed: 0.1198s/iter; left time: 5496.4874s
	iters: 200, epoch: 3 | loss: 0.3387455
	speed: 0.0211s/iter; left time: 965.5757s
	iters: 300, epoch: 3 | loss: 0.1846841
	speed: 0.0222s/iter; left time: 1015.1769s
	iters: 400, epoch: 3 | loss: 0.2103447
	speed: 0.0233s/iter; left time: 1059.5360s
Epoch: 3 cost time: 10.634481430053711
Epoch: 3, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0525551
	speed: 0.0956s/iter; left time: 4339.1818s
	iters: 200, epoch: 4 | loss: 0.0523582
	speed: 0.0208s/iter; left time: 940.9328s
	iters: 300, epoch: 4 | loss: 0.0082098
	speed: 0.0203s/iter; left time: 917.2814s
	iters: 400, epoch: 4 | loss: 0.0110536
	speed: 0.0235s/iter; left time: 1057.8261s
Epoch: 4 cost time: 10.517196655273438
Epoch: 4, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.953114 --> -0.959690).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1914442
	speed: 0.0940s/iter; left time: 4220.7161s
	iters: 200, epoch: 5 | loss: 0.3442623
	speed: 0.0248s/iter; left time: 1112.6316s
	iters: 300, epoch: 5 | loss: 0.1472083
	speed: 0.0240s/iter; left time: 1074.5996s
	iters: 400, epoch: 5 | loss: 0.0051936
	speed: 0.0247s/iter; left time: 1103.9584s
Epoch: 5 cost time: 11.701942205429077
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3275886
	speed: 0.1389s/iter; left time: 6175.2572s
	iters: 200, epoch: 6 | loss: 0.4041906
	speed: 0.0263s/iter; left time: 1167.4148s
	iters: 300, epoch: 6 | loss: 0.0481913
	speed: 0.0272s/iter; left time: 1205.1812s
	iters: 400, epoch: 6 | loss: 0.0127048
	speed: 0.0231s/iter; left time: 1019.0033s
Epoch: 6 cost time: 12.230659246444702
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0077895
	speed: 0.1404s/iter; left time: 6176.9272s
	iters: 200, epoch: 7 | loss: 0.0908485
	speed: 0.0213s/iter; left time: 933.4599s
	iters: 300, epoch: 7 | loss: 0.0129055
	speed: 0.0197s/iter; left time: 861.8574s
	iters: 400, epoch: 7 | loss: 0.0211792
	speed: 0.0194s/iter; left time: 846.3601s
Epoch: 7 cost time: 10.541062355041504
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1319727
	speed: 0.1154s/iter; left time: 5022.1162s
	iters: 200, epoch: 8 | loss: 0.0315067
	speed: 0.0225s/iter; left time: 978.4385s
	iters: 300, epoch: 8 | loss: 0.0069277
	speed: 0.0219s/iter; left time: 946.6953s
	iters: 400, epoch: 8 | loss: 0.1408778
	speed: 0.0206s/iter; left time: 889.7336s
Epoch: 8 cost time: 10.766451358795166
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.255 Vali Acc: 0.936 Test Loss: 0.255 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0232966
	speed: 0.1283s/iter; left time: 5523.4515s
	iters: 200, epoch: 9 | loss: 0.0799804
	speed: 0.0231s/iter; left time: 991.3916s
	iters: 300, epoch: 9 | loss: 0.0040039
	speed: 0.0251s/iter; left time: 1077.5094s
	iters: 400, epoch: 9 | loss: 0.0050820
	speed: 0.0291s/iter; left time: 1242.0430s
Epoch: 9 cost time: 12.544732570648193
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0007312
	speed: 0.1524s/iter; left time: 6489.8367s
	iters: 200, epoch: 10 | loss: 0.0188501
	speed: 0.0238s/iter; left time: 1009.9449s
	iters: 300, epoch: 10 | loss: 0.1386209
	speed: 0.0267s/iter; left time: 1130.8844s
	iters: 400, epoch: 10 | loss: 0.0050595
	speed: 0.0263s/iter; left time: 1111.4184s
Epoch: 10 cost time: 12.161951780319214
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.959690 --> -0.962834).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0026363
	speed: 0.1273s/iter; left time: 5360.5770s
	iters: 200, epoch: 11 | loss: 0.3100560
	speed: 0.0203s/iter; left time: 854.7170s
	iters: 300, epoch: 11 | loss: 0.0040597
	speed: 0.0217s/iter; left time: 910.2114s
	iters: 400, epoch: 11 | loss: 0.0021146
	speed: 0.0212s/iter; left time: 886.1918s
Epoch: 11 cost time: 10.55293893814087
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0005605
	speed: 0.1059s/iter; left time: 4409.8013s
	iters: 200, epoch: 12 | loss: 0.0029737
	speed: 0.0227s/iter; left time: 942.7555s
	iters: 300, epoch: 12 | loss: 0.0181996
	speed: 0.0263s/iter; left time: 1088.6811s
	iters: 400, epoch: 12 | loss: 0.0023865
	speed: 0.0217s/iter; left time: 897.4641s
Epoch: 12 cost time: 11.006084442138672
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0923393
	speed: 0.1325s/iter; left time: 5453.7130s
	iters: 200, epoch: 13 | loss: 0.1810134
	speed: 0.0228s/iter; left time: 936.1059s
	iters: 300, epoch: 13 | loss: 0.0463668
	speed: 0.0271s/iter; left time: 1110.1231s
	iters: 400, epoch: 13 | loss: 0.0098164
	speed: 0.0248s/iter; left time: 1012.6461s
Epoch: 13 cost time: 12.482839345932007
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.962834 --> -0.969410).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0662754
	speed: 0.1382s/iter; left time: 5625.3972s
	iters: 200, epoch: 14 | loss: 0.1310633
	speed: 0.0255s/iter; left time: 1035.8779s
	iters: 300, epoch: 14 | loss: 0.0067840
	speed: 0.0222s/iter; left time: 899.9960s
	iters: 400, epoch: 14 | loss: 0.0068835
	speed: 0.0196s/iter; left time: 790.1587s
Epoch: 14 cost time: 11.083733558654785
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0022983
	speed: 0.1141s/iter; left time: 4589.3237s
	iters: 200, epoch: 15 | loss: 0.0033925
	speed: 0.0266s/iter; left time: 1068.9769s
	iters: 300, epoch: 15 | loss: 0.0009062
	speed: 0.0228s/iter; left time: 914.5187s
	iters: 400, epoch: 15 | loss: 0.0014439
	speed: 0.0212s/iter; left time: 847.8033s
Epoch: 15 cost time: 11.365028381347656
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.970267).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0020378
	speed: 0.1261s/iter; left time: 5013.4304s
	iters: 200, epoch: 16 | loss: 0.0029699
	speed: 0.0246s/iter; left time: 974.9387s
	iters: 300, epoch: 16 | loss: 0.0010329
	speed: 0.0259s/iter; left time: 1026.6954s
	iters: 400, epoch: 16 | loss: 0.0409547
	speed: 0.0233s/iter; left time: 921.4469s
Epoch: 16 cost time: 11.909487009048462
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0361829
	speed: 0.1209s/iter; left time: 4750.2149s
	iters: 200, epoch: 17 | loss: 0.0021772
	speed: 0.0254s/iter; left time: 994.9577s
	iters: 300, epoch: 17 | loss: 0.1880553
	speed: 0.0237s/iter; left time: 926.8246s
	iters: 400, epoch: 17 | loss: 0.0013289
	speed: 0.0213s/iter; left time: 829.5337s
Epoch: 17 cost time: 11.370747327804565
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0039299
	speed: 0.1227s/iter; left time: 4762.6570s
	iters: 200, epoch: 18 | loss: 0.0064018
	speed: 0.0211s/iter; left time: 815.7130s
	iters: 300, epoch: 18 | loss: 0.0112817
	speed: 0.0177s/iter; left time: 682.5963s
	iters: 400, epoch: 18 | loss: 0.0718710
	speed: 0.0176s/iter; left time: 676.7648s
Epoch: 18 cost time: 9.499990701675415
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.260 Vali Acc: 0.955 Test Loss: 0.260 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0021902
	speed: 0.1166s/iter; left time: 4473.6856s
	iters: 200, epoch: 19 | loss: 0.0008106
	speed: 0.0297s/iter; left time: 1136.4228s
	iters: 300, epoch: 19 | loss: 0.0067776
	speed: 0.0281s/iter; left time: 1072.8498s
	iters: 400, epoch: 19 | loss: 0.0010825
	speed: 0.0242s/iter; left time: 922.6400s
Epoch: 19 cost time: 13.044583082199097
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4024581
	speed: 0.1320s/iter; left time: 5000.7056s
	iters: 200, epoch: 20 | loss: 0.2337078
	speed: 0.0238s/iter; left time: 897.8096s
	iters: 300, epoch: 20 | loss: 0.0386522
	speed: 0.0259s/iter; left time: 975.1565s
	iters: 400, epoch: 20 | loss: 0.0014744
	speed: 0.0260s/iter; left time: 975.8099s
Epoch: 20 cost time: 12.282756090164185
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.212 Vali Acc: 0.961 Test Loss: 0.212 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0006714
	speed: 0.1327s/iter; left time: 4966.9252s
	iters: 200, epoch: 21 | loss: 0.2127671
	speed: 0.0258s/iter; left time: 962.0339s
	iters: 300, epoch: 21 | loss: 0.0005469
	speed: 0.0259s/iter; left time: 964.1683s
	iters: 400, epoch: 21 | loss: 0.0197629
	speed: 0.0244s/iter; left time: 905.3364s
Epoch: 21 cost time: 12.352864265441895
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.970267 --> -0.973412).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0101396
	speed: 0.1207s/iter; left time: 4460.1425s
	iters: 200, epoch: 22 | loss: 0.0001366
	speed: 0.0233s/iter; left time: 860.3674s
	iters: 300, epoch: 22 | loss: 0.0009352
	speed: 0.0241s/iter; left time: 886.3122s
	iters: 400, epoch: 22 | loss: 0.0069836
	speed: 0.0223s/iter; left time: 818.3674s
Epoch: 22 cost time: 11.497058868408203
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0037362
	speed: 0.1643s/iter; left time: 5995.5974s
	iters: 200, epoch: 23 | loss: 0.0355589
	speed: 0.0251s/iter; left time: 914.4371s
	iters: 300, epoch: 23 | loss: 0.0165348
	speed: 0.0230s/iter; left time: 834.7021s
	iters: 400, epoch: 23 | loss: 0.0001703
	speed: 0.0227s/iter; left time: 820.6942s
Epoch: 23 cost time: 12.26311206817627
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0009786
	speed: 0.1491s/iter; left time: 5368.3243s
	iters: 200, epoch: 24 | loss: 0.0016379
	speed: 0.0235s/iter; left time: 844.7314s
	iters: 300, epoch: 24 | loss: 0.0009947
	speed: 0.0240s/iter; left time: 861.1052s
	iters: 400, epoch: 24 | loss: 0.1435577
	speed: 0.0227s/iter; left time: 809.4641s
Epoch: 24 cost time: 11.583807229995728
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0311974
	speed: 0.1160s/iter; left time: 4124.6311s
	iters: 200, epoch: 25 | loss: 0.0031933
	speed: 0.0213s/iter; left time: 755.0669s
	iters: 300, epoch: 25 | loss: 0.0005550
	speed: 0.0223s/iter; left time: 788.7907s
	iters: 400, epoch: 25 | loss: 0.0023799
	speed: 0.0236s/iter; left time: 832.0821s
Epoch: 25 cost time: 10.94979453086853
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0005922
	speed: 0.1094s/iter; left time: 3836.1950s
	iters: 200, epoch: 26 | loss: 0.0005650
	speed: 0.0220s/iter; left time: 767.7417s
	iters: 300, epoch: 26 | loss: 0.0025337
	speed: 0.0223s/iter; left time: 777.5618s
	iters: 400, epoch: 26 | loss: 0.0019632
	speed: 0.0227s/iter; left time: 789.5731s
Epoch: 26 cost time: 11.140131711959839
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0017904
	speed: 0.1362s/iter; left time: 4715.0471s
	iters: 200, epoch: 27 | loss: 0.0227022
	speed: 0.0214s/iter; left time: 739.1141s
	iters: 300, epoch: 27 | loss: 0.0053032
	speed: 0.0244s/iter; left time: 839.6117s
	iters: 400, epoch: 27 | loss: 0.0029280
	speed: 0.0239s/iter; left time: 818.5357s
Epoch: 27 cost time: 11.132900714874268
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.974842).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0597282
	speed: 0.1377s/iter; left time: 4699.3093s
	iters: 200, epoch: 28 | loss: 0.0195567
	speed: 0.0200s/iter; left time: 681.4859s
	iters: 300, epoch: 28 | loss: 0.1590098
	speed: 0.0182s/iter; left time: 618.5226s
	iters: 400, epoch: 28 | loss: 0.0025466
	speed: 0.0182s/iter; left time: 616.7044s
Epoch: 28 cost time: 9.920045852661133
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0007208
	speed: 0.1095s/iter; left time: 3687.2007s
	iters: 200, epoch: 29 | loss: 0.0001911
	speed: 0.0203s/iter; left time: 679.9574s
	iters: 300, epoch: 29 | loss: 0.0012385
	speed: 0.0235s/iter; left time: 785.9823s
	iters: 400, epoch: 29 | loss: 0.0008961
	speed: 0.0250s/iter; left time: 835.7810s
Epoch: 29 cost time: 11.335547685623169
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0001439
	speed: 0.1423s/iter; left time: 4724.4489s
	iters: 200, epoch: 30 | loss: 0.0000444
	speed: 0.0247s/iter; left time: 815.9233s
	iters: 300, epoch: 30 | loss: 0.0011021
	speed: 0.0263s/iter; left time: 868.7441s
	iters: 400, epoch: 30 | loss: 0.0004507
	speed: 0.0282s/iter; left time: 926.1807s
Epoch: 30 cost time: 13.18617033958435
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0021300
	speed: 0.1456s/iter; left time: 4764.4955s
	iters: 200, epoch: 31 | loss: 0.0168204
	speed: 0.0241s/iter; left time: 785.9634s
	iters: 300, epoch: 31 | loss: 0.0009534
	speed: 0.0285s/iter; left time: 928.2603s
	iters: 400, epoch: 31 | loss: 0.0480218
	speed: 0.0255s/iter; left time: 826.1759s
Epoch: 31 cost time: 12.300135135650635
Epoch: 31, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.977415).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0004055
	speed: 0.1349s/iter; left time: 4350.6257s
	iters: 200, epoch: 32 | loss: 0.0018130
	speed: 0.0244s/iter; left time: 783.7173s
	iters: 300, epoch: 32 | loss: 0.0182236
	speed: 0.0223s/iter; left time: 716.2068s
	iters: 400, epoch: 32 | loss: 0.0009256
	speed: 0.0251s/iter; left time: 801.1727s
Epoch: 32 cost time: 11.75750732421875
Epoch: 32, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0523735
	speed: 0.1170s/iter; left time: 3720.5470s
	iters: 200, epoch: 33 | loss: 0.0212242
	speed: 0.0286s/iter; left time: 907.7657s
	iters: 300, epoch: 33 | loss: 0.0005328
	speed: 0.0301s/iter; left time: 951.8191s
	iters: 400, epoch: 33 | loss: 0.0035276
	speed: 0.0254s/iter; left time: 799.5337s
Epoch: 33 cost time: 12.60581350326538
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0023768
	speed: 0.1300s/iter; left time: 4073.6088s
	iters: 200, epoch: 34 | loss: 0.0035653
	speed: 0.0213s/iter; left time: 664.0027s
	iters: 300, epoch: 34 | loss: 0.0012234
	speed: 0.0205s/iter; left time: 637.7711s
	iters: 400, epoch: 34 | loss: 0.0010023
	speed: 0.0222s/iter; left time: 688.6173s
Epoch: 34 cost time: 10.75466513633728
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0440217
	speed: 0.1162s/iter; left time: 3586.1225s
	iters: 200, epoch: 35 | loss: 0.0005026
	speed: 0.0226s/iter; left time: 694.0916s
	iters: 300, epoch: 35 | loss: 0.0004587
	speed: 0.0198s/iter; left time: 608.0824s
	iters: 400, epoch: 35 | loss: 0.0007112
	speed: 0.0222s/iter; left time: 678.2601s
Epoch: 35 cost time: 10.881007432937622
Epoch: 35, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0004394
	speed: 0.1060s/iter; left time: 3219.8628s
	iters: 200, epoch: 36 | loss: 0.0326105
	speed: 0.0188s/iter; left time: 569.5245s
	iters: 300, epoch: 36 | loss: 0.0009978
	speed: 0.0222s/iter; left time: 670.9602s
	iters: 400, epoch: 36 | loss: 0.0004541
	speed: 0.0270s/iter; left time: 812.0147s
Epoch: 36 cost time: 10.98899245262146
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.953 Test Loss: 0.228 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0013334
	speed: 0.1230s/iter; left time: 3678.5671s
	iters: 200, epoch: 37 | loss: 0.0003457
	speed: 0.0240s/iter; left time: 714.2258s
	iters: 300, epoch: 37 | loss: 0.0000923
	speed: 0.0253s/iter; left time: 751.8858s
	iters: 400, epoch: 37 | loss: 0.0308492
	speed: 0.0265s/iter; left time: 784.3793s
Epoch: 37 cost time: 12.141176223754883
Epoch: 37, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0024181
	speed: 0.1334s/iter; left time: 3926.8993s
	iters: 200, epoch: 38 | loss: 0.0236672
	speed: 0.0242s/iter; left time: 710.8168s
	iters: 300, epoch: 38 | loss: 0.0037265
	speed: 0.0236s/iter; left time: 689.7790s
	iters: 400, epoch: 38 | loss: 0.0019814
	speed: 0.0226s/iter; left time: 657.4826s
Epoch: 38 cost time: 11.530035734176636
Epoch: 38, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0046690
	speed: 0.1010s/iter; left time: 2925.8883s
	iters: 200, epoch: 39 | loss: 0.0005517
	speed: 0.0231s/iter; left time: 666.8450s
	iters: 300, epoch: 39 | loss: 0.0028886
	speed: 0.0219s/iter; left time: 630.2281s
	iters: 400, epoch: 39 | loss: 0.0006006
	speed: 0.0214s/iter; left time: 615.0083s
Epoch: 39 cost time: 10.593466520309448
Epoch: 39, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0001039
	speed: 0.1144s/iter; left time: 3260.9320s
	iters: 200, epoch: 40 | loss: 0.0001143
	speed: 0.0246s/iter; left time: 699.6838s
	iters: 300, epoch: 40 | loss: 0.0005263
	speed: 0.0256s/iter; left time: 725.1860s
	iters: 400, epoch: 40 | loss: 0.0001990
	speed: 0.0289s/iter; left time: 815.8700s
Epoch: 40 cost time: 12.840530395507812
Epoch: 40, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0023696
	speed: 0.1482s/iter; left time: 4155.7702s
	iters: 200, epoch: 41 | loss: 0.0004216
	speed: 0.0293s/iter; left time: 819.8550s
	iters: 300, epoch: 41 | loss: 0.0002185
	speed: 0.0264s/iter; left time: 736.0953s
	iters: 400, epoch: 41 | loss: 0.0026381
	speed: 0.0232s/iter; left time: 642.5087s
Epoch: 41 cost time: 12.468268632888794
Epoch: 41, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 602402
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9931436
	speed: 0.0377s/iter; left time: 1766.6924s
	iters: 200, epoch: 1 | loss: 0.6673055
	speed: 0.0198s/iter; left time: 926.0186s
	iters: 300, epoch: 1 | loss: 0.1178313
	speed: 0.0223s/iter; left time: 1038.5931s
	iters: 400, epoch: 1 | loss: 0.1680254
	speed: 0.0215s/iter; left time: 1001.0352s
Epoch: 1 cost time: 11.662397384643555
Epoch: 1, Steps: 469 | Train Loss: 0.739 Vali Loss: 0.315 Vali Acc: 0.893 Test Loss: 0.315 Test Acc: 0.893
Validation loss decreased (inf --> -0.893364).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1297486
	speed: 0.1248s/iter; left time: 5782.0613s
	iters: 200, epoch: 2 | loss: 0.0624642
	speed: 0.0265s/iter; left time: 1224.9841s
	iters: 300, epoch: 2 | loss: 0.0487787
	speed: 0.0279s/iter; left time: 1286.1835s
	iters: 400, epoch: 2 | loss: 0.0819531
	speed: 0.0248s/iter; left time: 1142.0408s
Epoch: 2 cost time: 12.52645230293274
Epoch: 2, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.893364 --> -0.952829).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2742450
	speed: 0.1305s/iter; left time: 5986.2627s
	iters: 200, epoch: 3 | loss: 0.0557778
	speed: 0.0227s/iter; left time: 1037.4989s
	iters: 300, epoch: 3 | loss: 0.0668859
	speed: 0.0220s/iter; left time: 1005.6535s
	iters: 400, epoch: 3 | loss: 0.1229077
	speed: 0.0239s/iter; left time: 1090.7075s
Epoch: 3 cost time: 11.35522174835205
Epoch: 3, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0114251
	speed: 0.1305s/iter; left time: 5926.1485s
	iters: 200, epoch: 4 | loss: 0.0807127
	speed: 0.0192s/iter; left time: 868.3666s
	iters: 300, epoch: 4 | loss: 0.3083696
	speed: 0.0194s/iter; left time: 876.6684s
	iters: 400, epoch: 4 | loss: 0.2053549
	speed: 0.0201s/iter; left time: 904.1404s
Epoch: 4 cost time: 9.700706720352173
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.952829 --> -0.954258).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0712212
	speed: 0.1196s/iter; left time: 5373.1550s
	iters: 200, epoch: 5 | loss: 0.0057709
	speed: 0.0228s/iter; left time: 1022.9071s
	iters: 300, epoch: 5 | loss: 0.0304966
	speed: 0.0245s/iter; left time: 1097.7825s
	iters: 400, epoch: 5 | loss: 0.0142346
	speed: 0.0242s/iter; left time: 1080.4229s
Epoch: 5 cost time: 11.354431867599487
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.954258 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0365567
	speed: 0.1261s/iter; left time: 5607.7139s
	iters: 200, epoch: 6 | loss: 0.0069394
	speed: 0.0262s/iter; left time: 1161.1189s
	iters: 300, epoch: 6 | loss: 0.0629245
	speed: 0.0254s/iter; left time: 1124.4101s
	iters: 400, epoch: 6 | loss: 0.0030264
	speed: 0.0251s/iter; left time: 1106.8462s
Epoch: 6 cost time: 12.040222406387329
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0147802
	speed: 0.1256s/iter; left time: 5525.6109s
	iters: 200, epoch: 7 | loss: 0.0080552
	speed: 0.0229s/iter; left time: 1004.1790s
	iters: 300, epoch: 7 | loss: 0.3953352
	speed: 0.0263s/iter; left time: 1150.3184s
	iters: 400, epoch: 7 | loss: 0.0173923
	speed: 0.0239s/iter; left time: 1042.2981s
Epoch: 7 cost time: 11.815531015396118
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.184 Vali Acc: 0.947 Test Loss: 0.184 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0632776
	speed: 0.1003s/iter; left time: 4365.3842s
	iters: 200, epoch: 8 | loss: 0.2905613
	speed: 0.0190s/iter; left time: 824.4783s
	iters: 300, epoch: 8 | loss: 0.0312345
	speed: 0.0197s/iter; left time: 854.0719s
	iters: 400, epoch: 8 | loss: 0.3044841
	speed: 0.0207s/iter; left time: 894.5526s
Epoch: 8 cost time: 9.672062873840332
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0174026
	speed: 0.1086s/iter; left time: 4675.3636s
	iters: 200, epoch: 9 | loss: 0.0104546
	speed: 0.0218s/iter; left time: 934.4396s
	iters: 300, epoch: 9 | loss: 0.1482454
	speed: 0.0247s/iter; left time: 1057.7182s
	iters: 400, epoch: 9 | loss: 0.0244251
	speed: 0.0220s/iter; left time: 939.8593s
Epoch: 9 cost time: 11.120503902435303
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0837184
	speed: 0.1282s/iter; left time: 5459.9089s
	iters: 200, epoch: 10 | loss: 0.0022948
	speed: 0.0250s/iter; left time: 1060.4555s
	iters: 300, epoch: 10 | loss: 0.1644579
	speed: 0.0257s/iter; left time: 1087.6300s
	iters: 400, epoch: 10 | loss: 0.0090553
	speed: 0.0247s/iter; left time: 1042.6301s
Epoch: 10 cost time: 12.169121742248535
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0011571
	speed: 0.1238s/iter; left time: 5212.0687s
	iters: 200, epoch: 11 | loss: 0.0379249
	speed: 0.0272s/iter; left time: 1141.1998s
	iters: 300, epoch: 11 | loss: 0.1410151
	speed: 0.0266s/iter; left time: 1115.1589s
	iters: 400, epoch: 11 | loss: 0.0857447
	speed: 0.0238s/iter; left time: 994.2522s
Epoch: 11 cost time: 12.351189136505127
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
Validation loss decreased (-0.968552 --> -0.972269).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0027790
	speed: 0.1230s/iter; left time: 5122.1486s
	iters: 200, epoch: 12 | loss: 0.0006645
	speed: 0.0257s/iter; left time: 1069.3787s
	iters: 300, epoch: 12 | loss: 0.0214067
	speed: 0.0233s/iter; left time: 964.1580s
	iters: 400, epoch: 12 | loss: 0.0004109
	speed: 0.0248s/iter; left time: 1023.4204s
Epoch: 12 cost time: 11.734607696533203
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0066856
	speed: 0.1411s/iter; left time: 5811.2872s
	iters: 200, epoch: 13 | loss: 0.0748126
	speed: 0.0264s/iter; left time: 1085.6932s
	iters: 300, epoch: 13 | loss: 0.0540515
	speed: 0.0238s/iter; left time: 973.7808s
	iters: 400, epoch: 13 | loss: 0.0005691
	speed: 0.0224s/iter; left time: 914.8493s
Epoch: 13 cost time: 12.041052103042603
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.972269 --> -0.972269).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0247486
	speed: 0.1374s/iter; left time: 5592.9458s
	iters: 200, epoch: 14 | loss: 0.0915658
	speed: 0.0238s/iter; left time: 964.7673s
	iters: 300, epoch: 14 | loss: 0.0065534
	speed: 0.0220s/iter; left time: 890.0388s
	iters: 400, epoch: 14 | loss: 0.0564683
	speed: 0.0231s/iter; left time: 934.5953s
Epoch: 14 cost time: 11.272236347198486
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0053317
	speed: 0.1255s/iter; left time: 5050.5600s
	iters: 200, epoch: 15 | loss: 0.0031998
	speed: 0.0233s/iter; left time: 936.3618s
	iters: 300, epoch: 15 | loss: 0.0022617
	speed: 0.0204s/iter; left time: 815.6108s
	iters: 400, epoch: 15 | loss: 0.0010089
	speed: 0.0194s/iter; left time: 773.8664s
Epoch: 15 cost time: 10.463195562362671
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1160053
	speed: 0.1287s/iter; left time: 5116.4224s
	iters: 200, epoch: 16 | loss: 0.0054440
	speed: 0.0186s/iter; left time: 738.8930s
	iters: 300, epoch: 16 | loss: 0.0016673
	speed: 0.0199s/iter; left time: 789.1833s
	iters: 400, epoch: 16 | loss: 0.0066409
	speed: 0.0238s/iter; left time: 938.5601s
Epoch: 16 cost time: 10.437175512313843
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1167387
	speed: 0.1281s/iter; left time: 5035.0052s
	iters: 200, epoch: 17 | loss: 0.2961537
	speed: 0.0199s/iter; left time: 781.0689s
	iters: 300, epoch: 17 | loss: 0.0481091
	speed: 0.0222s/iter; left time: 869.6076s
	iters: 400, epoch: 17 | loss: 0.0242791
	speed: 0.0216s/iter; left time: 843.6566s
Epoch: 17 cost time: 10.573240280151367
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0541820
	speed: 0.1235s/iter; left time: 4794.0522s
	iters: 200, epoch: 18 | loss: 0.0064651
	speed: 0.0207s/iter; left time: 802.6656s
	iters: 300, epoch: 18 | loss: 0.0031337
	speed: 0.0247s/iter; left time: 955.5413s
	iters: 400, epoch: 18 | loss: 0.0010582
	speed: 0.0259s/iter; left time: 996.5988s
Epoch: 18 cost time: 11.269575119018555
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0004719
	speed: 0.1108s/iter; left time: 4248.8809s
	iters: 200, epoch: 19 | loss: 0.0141531
	speed: 0.0212s/iter; left time: 811.4168s
	iters: 300, epoch: 19 | loss: 0.0035872
	speed: 0.0215s/iter; left time: 819.1165s
	iters: 400, epoch: 19 | loss: 0.0010841
	speed: 0.0206s/iter; left time: 782.5408s
Epoch: 19 cost time: 10.079987287521362
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1504795
	speed: 0.1145s/iter; left time: 4338.9590s
	iters: 200, epoch: 20 | loss: 0.0006294
	speed: 0.0228s/iter; left time: 861.0491s
	iters: 300, epoch: 20 | loss: 0.0002753
	speed: 0.0260s/iter; left time: 980.7759s
	iters: 400, epoch: 20 | loss: 0.0032295
	speed: 0.0236s/iter; left time: 885.6823s
Epoch: 20 cost time: 11.59494948387146
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0770607
	speed: 0.1359s/iter; left time: 5086.4989s
	iters: 200, epoch: 21 | loss: 0.0223802
	speed: 0.0220s/iter; left time: 820.1178s
	iters: 300, epoch: 21 | loss: 0.0062079
	speed: 0.0222s/iter; left time: 826.0254s
	iters: 400, epoch: 21 | loss: 0.0072789
	speed: 0.0233s/iter; left time: 863.1518s
Epoch: 21 cost time: 10.972525596618652
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0303974
	speed: 0.1344s/iter; left time: 4965.4957s
	iters: 200, epoch: 22 | loss: 0.0306031
	speed: 0.0228s/iter; left time: 840.2030s
	iters: 300, epoch: 22 | loss: 0.0010631
	speed: 0.0238s/iter; left time: 874.0411s
	iters: 400, epoch: 22 | loss: 0.0169281
	speed: 0.0216s/iter; left time: 792.5675s
Epoch: 22 cost time: 11.387604236602783
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.972555).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0004980
	speed: 0.1264s/iter; left time: 4612.5545s
	iters: 200, epoch: 23 | loss: 0.0013471
	speed: 0.0221s/iter; left time: 802.4858s
	iters: 300, epoch: 23 | loss: 0.0006037
	speed: 0.0234s/iter; left time: 850.2531s
	iters: 400, epoch: 23 | loss: 0.0002222
	speed: 0.0269s/iter; left time: 974.4672s
Epoch: 23 cost time: 11.52210283279419
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.974270).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0002846
	speed: 0.1383s/iter; left time: 4982.0234s
	iters: 200, epoch: 24 | loss: 0.0002494
	speed: 0.0206s/iter; left time: 739.0307s
	iters: 300, epoch: 24 | loss: 0.0002113
	speed: 0.0202s/iter; left time: 723.2980s
	iters: 400, epoch: 24 | loss: 0.0003379
	speed: 0.0185s/iter; left time: 660.5256s
Epoch: 24 cost time: 9.878698348999023
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0139588
	speed: 0.1268s/iter; left time: 4505.9223s
	iters: 200, epoch: 25 | loss: 0.0042570
	speed: 0.0207s/iter; left time: 731.9566s
	iters: 300, epoch: 25 | loss: 0.0257384
	speed: 0.0217s/iter; left time: 768.2497s
	iters: 400, epoch: 25 | loss: 0.0020391
	speed: 0.0209s/iter; left time: 735.8183s
Epoch: 25 cost time: 10.30628776550293
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0018729
	speed: 0.0904s/iter; left time: 3170.1651s
	iters: 200, epoch: 26 | loss: 0.0129556
	speed: 0.0193s/iter; left time: 675.5353s
	iters: 300, epoch: 26 | loss: 0.0011776
	speed: 0.0181s/iter; left time: 632.7348s
	iters: 400, epoch: 26 | loss: 0.0026667
	speed: 0.0209s/iter; left time: 725.7224s
Epoch: 26 cost time: 9.540163040161133
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0069843
	speed: 0.1140s/iter; left time: 3944.5377s
	iters: 200, epoch: 27 | loss: 0.0031086
	speed: 0.0232s/iter; left time: 800.5756s
	iters: 300, epoch: 27 | loss: 0.0047053
	speed: 0.0200s/iter; left time: 687.9428s
	iters: 400, epoch: 27 | loss: 0.0003888
	speed: 0.0192s/iter; left time: 660.1546s
Epoch: 27 cost time: 10.560809850692749
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3520697
	speed: 0.1127s/iter; left time: 3848.2929s
	iters: 200, epoch: 28 | loss: 0.0028592
	speed: 0.0221s/iter; left time: 752.1024s
	iters: 300, epoch: 28 | loss: 0.0001921
	speed: 0.0223s/iter; left time: 757.9824s
	iters: 400, epoch: 28 | loss: 0.0019300
	speed: 0.0246s/iter; left time: 832.2853s
Epoch: 28 cost time: 11.09949016571045
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0003747
	speed: 0.1108s/iter; left time: 3730.9205s
	iters: 200, epoch: 29 | loss: 0.0260032
	speed: 0.0208s/iter; left time: 697.6843s
	iters: 300, epoch: 29 | loss: 0.0002152
	speed: 0.0215s/iter; left time: 718.7363s
	iters: 400, epoch: 29 | loss: 0.0264408
	speed: 0.0239s/iter; left time: 796.0077s
Epoch: 29 cost time: 10.348898649215698
Epoch: 29, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0488509
	speed: 0.0985s/iter; left time: 3270.3819s
	iters: 200, epoch: 30 | loss: 0.0267768
	speed: 0.0220s/iter; left time: 728.3994s
	iters: 300, epoch: 30 | loss: 0.0004130
	speed: 0.0210s/iter; left time: 693.7915s
	iters: 400, epoch: 30 | loss: 0.0019178
	speed: 0.0212s/iter; left time: 698.0502s
Epoch: 30 cost time: 10.535040616989136
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0006526
	speed: 0.1387s/iter; left time: 4540.5509s
	iters: 200, epoch: 31 | loss: 0.0003672
	speed: 0.0247s/iter; left time: 806.3952s
	iters: 300, epoch: 31 | loss: 0.0146521
	speed: 0.0233s/iter; left time: 756.8815s
	iters: 400, epoch: 31 | loss: 0.0003969
	speed: 0.0233s/iter; left time: 754.9206s
Epoch: 31 cost time: 11.444674253463745
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0003904
	speed: 0.1263s/iter; left time: 4073.7514s
	iters: 200, epoch: 32 | loss: 0.0012170
	speed: 0.0233s/iter; left time: 750.6880s
	iters: 300, epoch: 32 | loss: 0.0002671
	speed: 0.0200s/iter; left time: 640.2253s
	iters: 400, epoch: 32 | loss: 0.0124276
	speed: 0.0196s/iter; left time: 625.3457s
Epoch: 32 cost time: 10.32555341720581
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0005502
	speed: 0.1072s/iter; left time: 3408.4572s
	iters: 200, epoch: 33 | loss: 0.0003516
	speed: 0.0212s/iter; left time: 671.9543s
	iters: 300, epoch: 33 | loss: 0.0005369
	speed: 0.0192s/iter; left time: 605.6338s
	iters: 400, epoch: 33 | loss: 0.0020046
	speed: 0.0197s/iter; left time: 620.0193s
Epoch: 33 cost time: 9.69034481048584
Epoch: 33, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 602338
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2319505
	speed: 0.0443s/iter; left time: 2071.6452s
	iters: 200, epoch: 1 | loss: 0.5919089
	speed: 0.0292s/iter; left time: 1363.3595s
	iters: 300, epoch: 1 | loss: 0.3344573
	speed: 0.0272s/iter; left time: 1269.2224s
	iters: 400, epoch: 1 | loss: 0.3532125
	speed: 0.0229s/iter; left time: 1065.8985s
Epoch: 1 cost time: 13.97870659828186
Epoch: 1, Steps: 469 | Train Loss: 0.844 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (inf --> -0.875068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2105351
	speed: 0.1294s/iter; left time: 5995.5927s
	iters: 200, epoch: 2 | loss: 0.1332535
	speed: 0.0227s/iter; left time: 1049.3518s
	iters: 300, epoch: 2 | loss: 0.0319754
	speed: 0.0238s/iter; left time: 1096.6320s
	iters: 400, epoch: 2 | loss: 0.1596800
	speed: 0.0256s/iter; left time: 1178.0363s
Epoch: 2 cost time: 11.98499083518982
Epoch: 2, Steps: 469 | Train Loss: 0.156 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
Validation loss decreased (-0.875068 --> -0.943394).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1844133
	speed: 0.1330s/iter; left time: 6099.1857s
	iters: 200, epoch: 3 | loss: 0.0263866
	speed: 0.0235s/iter; left time: 1077.0986s
	iters: 300, epoch: 3 | loss: 0.0120053
	speed: 0.0236s/iter; left time: 1079.7882s
	iters: 400, epoch: 3 | loss: 0.0743304
	speed: 0.0218s/iter; left time: 992.6390s
Epoch: 3 cost time: 10.867670774459839
Epoch: 3, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
Validation loss decreased (-0.943394 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1638403
	speed: 0.1455s/iter; left time: 6604.2001s
	iters: 200, epoch: 4 | loss: 0.0543293
	speed: 0.0228s/iter; left time: 1031.2640s
	iters: 300, epoch: 4 | loss: 0.0113852
	speed: 0.0221s/iter; left time: 997.6939s
	iters: 400, epoch: 4 | loss: 0.0124643
	speed: 0.0250s/iter; left time: 1128.4295s
Epoch: 4 cost time: 11.81998348236084
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0232391
	speed: 0.1457s/iter; left time: 6546.4275s
	iters: 200, epoch: 5 | loss: 0.0620981
	speed: 0.0246s/iter; left time: 1101.8044s
	iters: 300, epoch: 5 | loss: 0.0274719
	speed: 0.0221s/iter; left time: 990.1198s
	iters: 400, epoch: 5 | loss: 0.0282232
	speed: 0.0207s/iter; left time: 922.3921s
Epoch: 5 cost time: 10.901898860931396
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1012107
	speed: 0.0989s/iter; left time: 4394.5406s
	iters: 200, epoch: 6 | loss: 0.0619933
	speed: 0.0214s/iter; left time: 951.2930s
	iters: 300, epoch: 6 | loss: 0.0083144
	speed: 0.0218s/iter; left time: 963.3420s
	iters: 400, epoch: 6 | loss: 0.0090407
	speed: 0.0227s/iter; left time: 1003.7666s
Epoch: 6 cost time: 10.686582326889038
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.955973 --> -0.965122).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0163418
	speed: 0.1130s/iter; left time: 4971.4894s
	iters: 200, epoch: 7 | loss: 0.0053960
	speed: 0.0219s/iter; left time: 962.5272s
	iters: 300, epoch: 7 | loss: 0.1477700
	speed: 0.0234s/iter; left time: 1026.6022s
	iters: 400, epoch: 7 | loss: 0.0155994
	speed: 0.0242s/iter; left time: 1056.7582s
Epoch: 7 cost time: 11.263007640838623
Epoch: 7, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2480984
	speed: 0.1290s/iter; left time: 5611.8227s
	iters: 200, epoch: 8 | loss: 0.3235632
	speed: 0.0218s/iter; left time: 947.2487s
	iters: 300, epoch: 8 | loss: 0.0449372
	speed: 0.0217s/iter; left time: 942.1465s
	iters: 400, epoch: 8 | loss: 0.0192926
	speed: 0.0214s/iter; left time: 924.4274s
Epoch: 8 cost time: 10.539722442626953
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0042701
	speed: 0.1131s/iter; left time: 4869.2403s
	iters: 200, epoch: 9 | loss: 0.0024954
	speed: 0.0215s/iter; left time: 922.1500s
	iters: 300, epoch: 9 | loss: 0.0022924
	speed: 0.0200s/iter; left time: 858.5047s
	iters: 400, epoch: 9 | loss: 0.1997695
	speed: 0.0210s/iter; left time: 899.1592s
Epoch: 9 cost time: 10.783334255218506
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.965122 --> -0.975128).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0043853
	speed: 0.1512s/iter; left time: 6437.1608s
	iters: 200, epoch: 10 | loss: 0.0008267
	speed: 0.0257s/iter; left time: 1093.5556s
	iters: 300, epoch: 10 | loss: 0.0852953
	speed: 0.0230s/iter; left time: 975.8019s
	iters: 400, epoch: 10 | loss: 0.0027418
	speed: 0.0229s/iter; left time: 967.0454s
Epoch: 10 cost time: 12.066750049591064
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0067462
	speed: 0.1502s/iter; left time: 6324.9310s
	iters: 200, epoch: 11 | loss: 0.0402750
	speed: 0.0231s/iter; left time: 968.4882s
	iters: 300, epoch: 11 | loss: 0.0134921
	speed: 0.0267s/iter; left time: 1117.1400s
	iters: 400, epoch: 11 | loss: 0.0036679
	speed: 0.0346s/iter; left time: 1448.5125s
Epoch: 11 cost time: 13.63715672492981
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0003190
	speed: 0.1547s/iter; left time: 6440.8588s
	iters: 200, epoch: 12 | loss: 0.0035151
	speed: 0.0255s/iter; left time: 1059.4555s
	iters: 300, epoch: 12 | loss: 0.0008424
	speed: 0.0248s/iter; left time: 1026.2495s
	iters: 400, epoch: 12 | loss: 0.0044157
	speed: 0.0260s/iter; left time: 1073.3667s
Epoch: 12 cost time: 12.173251628875732
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.945 Test Loss: 0.265 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0770971
	speed: 0.1074s/iter; left time: 4420.4201s
	iters: 200, epoch: 13 | loss: 0.0037983
	speed: 0.0216s/iter; left time: 885.7914s
	iters: 300, epoch: 13 | loss: 0.0083759
	speed: 0.0205s/iter; left time: 840.2080s
	iters: 400, epoch: 13 | loss: 0.1375250
	speed: 0.0224s/iter; left time: 914.1653s
Epoch: 13 cost time: 10.576138019561768
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0219077
	speed: 0.1057s/iter; left time: 4301.9442s
	iters: 200, epoch: 14 | loss: 0.0031915
	speed: 0.0209s/iter; left time: 847.0078s
	iters: 300, epoch: 14 | loss: 0.0228364
	speed: 0.0219s/iter; left time: 887.3852s
	iters: 400, epoch: 14 | loss: 0.0399629
	speed: 0.0260s/iter; left time: 1048.8715s
Epoch: 14 cost time: 10.803865194320679
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.975128 --> -0.975414).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0861463
	speed: 0.1070s/iter; left time: 4303.3964s
	iters: 200, epoch: 15 | loss: 0.0042215
	speed: 0.0184s/iter; left time: 739.0722s
	iters: 300, epoch: 15 | loss: 0.0009475
	speed: 0.0187s/iter; left time: 747.5559s
	iters: 400, epoch: 15 | loss: 0.0681901
	speed: 0.0218s/iter; left time: 870.3092s
Epoch: 15 cost time: 9.940594673156738
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0141450
	speed: 0.1170s/iter; left time: 4651.3951s
	iters: 200, epoch: 16 | loss: 0.0105650
	speed: 0.0184s/iter; left time: 731.5339s
	iters: 300, epoch: 16 | loss: 0.0109731
	speed: 0.0208s/iter; left time: 823.3928s
	iters: 400, epoch: 16 | loss: 0.0454974
	speed: 0.0195s/iter; left time: 771.3212s
Epoch: 16 cost time: 9.437253952026367
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.243 Vali Acc: 0.955 Test Loss: 0.243 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0164397
	speed: 0.1140s/iter; left time: 4478.5253s
	iters: 200, epoch: 17 | loss: 0.0035351
	speed: 0.0219s/iter; left time: 857.4172s
	iters: 300, epoch: 17 | loss: 0.0060208
	speed: 0.0229s/iter; left time: 893.3914s
	iters: 400, epoch: 17 | loss: 0.2406498
	speed: 0.0239s/iter; left time: 933.7623s
Epoch: 17 cost time: 11.236498355865479
Epoch: 17, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0007314
	speed: 0.1158s/iter; left time: 4497.1034s
	iters: 200, epoch: 18 | loss: 0.0021037
	speed: 0.0195s/iter; left time: 754.1884s
	iters: 300, epoch: 18 | loss: 0.0024458
	speed: 0.0216s/iter; left time: 833.7635s
	iters: 400, epoch: 18 | loss: 0.1072093
	speed: 0.0254s/iter; left time: 977.5691s
Epoch: 18 cost time: 10.92529845237732
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0005106
	speed: 0.1145s/iter; left time: 4393.2280s
	iters: 200, epoch: 19 | loss: 0.3055023
	speed: 0.0205s/iter; left time: 783.6983s
	iters: 300, epoch: 19 | loss: 0.0190659
	speed: 0.0230s/iter; left time: 879.4793s
	iters: 400, epoch: 19 | loss: 0.0026061
	speed: 0.0225s/iter; left time: 857.7632s
Epoch: 19 cost time: 10.837701082229614
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0015084
	speed: 0.1462s/iter; left time: 5541.4046s
	iters: 200, epoch: 20 | loss: 0.0008551
	speed: 0.0216s/iter; left time: 815.3658s
	iters: 300, epoch: 20 | loss: 0.0103394
	speed: 0.0214s/iter; left time: 808.1268s
	iters: 400, epoch: 20 | loss: 0.0061696
	speed: 0.0214s/iter; left time: 803.5686s
Epoch: 20 cost time: 10.615035057067871
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0031660
	speed: 0.1082s/iter; left time: 4048.8016s
	iters: 200, epoch: 21 | loss: 0.2398043
	speed: 0.0217s/iter; left time: 810.6678s
	iters: 300, epoch: 21 | loss: 0.0321431
	speed: 0.0256s/iter; left time: 953.2364s
	iters: 400, epoch: 21 | loss: 0.0108745
	speed: 0.0228s/iter; left time: 845.4524s
Epoch: 21 cost time: 10.949182987213135
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3608961
	speed: 0.0939s/iter; left time: 3469.3555s
	iters: 200, epoch: 22 | loss: 0.0016844
	speed: 0.0196s/iter; left time: 723.3050s
	iters: 300, epoch: 22 | loss: 0.0016339
	speed: 0.0193s/iter; left time: 707.6659s
	iters: 400, epoch: 22 | loss: 0.0029810
	speed: 0.0202s/iter; left time: 742.0965s
Epoch: 22 cost time: 9.555444240570068
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.975414 --> -0.976557).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0014347
	speed: 0.1168s/iter; left time: 4262.6384s
	iters: 200, epoch: 23 | loss: 0.0025802
	speed: 0.0206s/iter; left time: 748.7626s
	iters: 300, epoch: 23 | loss: 0.0005157
	speed: 0.0237s/iter; left time: 860.4182s
	iters: 400, epoch: 23 | loss: 0.3844313
	speed: 0.0267s/iter; left time: 967.1915s
Epoch: 23 cost time: 11.560528755187988
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0005761
	speed: 0.1333s/iter; left time: 4799.8707s
	iters: 200, epoch: 24 | loss: 0.0043456
	speed: 0.0227s/iter; left time: 813.6412s
	iters: 300, epoch: 24 | loss: 0.0027371
	speed: 0.0224s/iter; left time: 803.5306s
	iters: 400, epoch: 24 | loss: 0.0323102
	speed: 0.0215s/iter; left time: 767.2682s
Epoch: 24 cost time: 10.678134679794312
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.3215759
	speed: 0.1305s/iter; left time: 4639.8473s
	iters: 200, epoch: 25 | loss: 0.0003660
	speed: 0.0218s/iter; left time: 772.1374s
	iters: 300, epoch: 25 | loss: 0.0005418
	speed: 0.0203s/iter; left time: 718.6750s
	iters: 400, epoch: 25 | loss: 0.0169976
	speed: 0.0211s/iter; left time: 745.2680s
Epoch: 25 cost time: 10.58598804473877
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0004808
	speed: 0.1257s/iter; left time: 4409.9992s
	iters: 200, epoch: 26 | loss: 0.0002942
	speed: 0.0252s/iter; left time: 882.5904s
	iters: 300, epoch: 26 | loss: 0.0106631
	speed: 0.0237s/iter; left time: 826.7170s
	iters: 400, epoch: 26 | loss: 0.0015013
	speed: 0.0298s/iter; left time: 1038.0296s
Epoch: 26 cost time: 12.598865985870361
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0051415
	speed: 0.1215s/iter; left time: 4205.9093s
	iters: 200, epoch: 27 | loss: 0.0050274
	speed: 0.0292s/iter; left time: 1006.5177s
	iters: 300, epoch: 27 | loss: 0.0024463
	speed: 0.0326s/iter; left time: 1121.3667s
	iters: 400, epoch: 27 | loss: 0.0016968
	speed: 0.0237s/iter; left time: 812.2820s
Epoch: 27 cost time: 12.90168046951294
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0012946
	speed: 0.1119s/iter; left time: 3819.2288s
	iters: 200, epoch: 28 | loss: 0.0802632
	speed: 0.0232s/iter; left time: 790.3034s
	iters: 300, epoch: 28 | loss: 0.4851092
	speed: 0.0292s/iter; left time: 990.7407s
	iters: 400, epoch: 28 | loss: 0.0006706
	speed: 0.0242s/iter; left time: 817.6407s
Epoch: 28 cost time: 11.705101013183594
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0005447
	speed: 0.1141s/iter; left time: 3842.2432s
	iters: 200, epoch: 29 | loss: 0.0017627
	speed: 0.0228s/iter; left time: 765.8076s
	iters: 300, epoch: 29 | loss: 0.0009412
	speed: 0.0231s/iter; left time: 772.7547s
	iters: 400, epoch: 29 | loss: 0.0006239
	speed: 0.0203s/iter; left time: 677.0580s
Epoch: 29 cost time: 10.5311598777771
Epoch: 29, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0034991
	speed: 0.1119s/iter; left time: 3714.9665s
	iters: 200, epoch: 30 | loss: 0.0004884
	speed: 0.0223s/iter; left time: 737.7899s
	iters: 300, epoch: 30 | loss: 0.0053444
	speed: 0.0204s/iter; left time: 673.3916s
	iters: 400, epoch: 30 | loss: 0.0021186
	speed: 0.0230s/iter; left time: 758.1965s
Epoch: 30 cost time: 10.964653491973877
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0010146
	speed: 0.1265s/iter; left time: 4141.0589s
	iters: 200, epoch: 31 | loss: 0.0631288
	speed: 0.0228s/iter; left time: 744.4863s
	iters: 300, epoch: 31 | loss: 0.0022466
	speed: 0.0232s/iter; left time: 755.5437s
	iters: 400, epoch: 31 | loss: 0.0051576
	speed: 0.0213s/iter; left time: 689.1951s
Epoch: 31 cost time: 11.097641944885254
Epoch: 31, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0034210
	speed: 0.1053s/iter; left time: 3397.8044s
	iters: 200, epoch: 32 | loss: 0.0011075
	speed: 0.0243s/iter; left time: 782.1799s
	iters: 300, epoch: 32 | loss: 0.0053794
	speed: 0.0212s/iter; left time: 679.5823s
	iters: 400, epoch: 32 | loss: 0.0002111
	speed: 0.0253s/iter; left time: 810.2117s
Epoch: 32 cost time: 11.751778602600098
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 404386
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1807950
	speed: 0.0424s/iter; left time: 1985.6456s
	iters: 200, epoch: 1 | loss: 0.4342529
	speed: 0.0262s/iter; left time: 1225.6806s
	iters: 300, epoch: 1 | loss: 0.4885919
	speed: 0.0289s/iter; left time: 1345.7547s
	iters: 400, epoch: 1 | loss: 0.2027791
	speed: 0.0295s/iter; left time: 1371.2318s
Epoch: 1 cost time: 14.307944059371948
Epoch: 1, Steps: 469 | Train Loss: 0.862 Vali Loss: 0.421 Vali Acc: 0.866 Test Loss: 0.421 Test Acc: 0.866
Validation loss decreased (inf --> -0.865633).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2282783
	speed: 0.1309s/iter; left time: 6067.0888s
	iters: 200, epoch: 2 | loss: 0.0960894
	speed: 0.0234s/iter; left time: 1082.6031s
	iters: 300, epoch: 2 | loss: 0.1967755
	speed: 0.0258s/iter; left time: 1189.4072s
	iters: 400, epoch: 2 | loss: 0.1037484
	speed: 0.0239s/iter; left time: 1098.7243s
Epoch: 2 cost time: 11.534745693206787
Epoch: 2, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
Validation loss decreased (-0.865633 --> -0.932245).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0199309
	speed: 0.1134s/iter; left time: 5202.4545s
	iters: 200, epoch: 3 | loss: 0.1939866
	speed: 0.0233s/iter; left time: 1068.0578s
	iters: 300, epoch: 3 | loss: 0.2473430
	speed: 0.0239s/iter; left time: 1091.2641s
	iters: 400, epoch: 3 | loss: 0.0713162
	speed: 0.0221s/iter; left time: 1008.1861s
Epoch: 3 cost time: 10.956830263137817
Epoch: 3, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.932245 --> -0.961691).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0103819
	speed: 0.1053s/iter; left time: 4777.7848s
	iters: 200, epoch: 4 | loss: 0.0109790
	speed: 0.0241s/iter; left time: 1091.3908s
	iters: 300, epoch: 4 | loss: 0.0031667
	speed: 0.0249s/iter; left time: 1123.4279s
	iters: 400, epoch: 4 | loss: 0.0173963
	speed: 0.0213s/iter; left time: 958.7390s
Epoch: 4 cost time: 11.25333571434021
Epoch: 4, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0193220
	speed: 0.1142s/iter; left time: 5129.4352s
	iters: 200, epoch: 5 | loss: 0.0062980
	speed: 0.0269s/iter; left time: 1207.0995s
	iters: 300, epoch: 5 | loss: 0.0426311
	speed: 0.0290s/iter; left time: 1296.4750s
	iters: 400, epoch: 5 | loss: 0.1488508
	speed: 0.0240s/iter; left time: 1072.7382s
Epoch: 5 cost time: 12.277565479278564
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.961691 --> -0.963692).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1556364
	speed: 0.1162s/iter; left time: 5164.8706s
	iters: 200, epoch: 6 | loss: 0.0132211
	speed: 0.0235s/iter; left time: 1043.7052s
	iters: 300, epoch: 6 | loss: 0.1654442
	speed: 0.0210s/iter; left time: 929.7610s
	iters: 400, epoch: 6 | loss: 0.0371702
	speed: 0.0211s/iter; left time: 931.7040s
Epoch: 6 cost time: 10.73973035812378
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.963692 --> -0.967123).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0049220
	speed: 0.1488s/iter; left time: 6543.4232s
	iters: 200, epoch: 7 | loss: 0.0788135
	speed: 0.0225s/iter; left time: 989.4080s
	iters: 300, epoch: 7 | loss: 0.3699524
	speed: 0.0239s/iter; left time: 1045.8675s
	iters: 400, epoch: 7 | loss: 0.0117441
	speed: 0.0228s/iter; left time: 998.0188s
Epoch: 7 cost time: 10.814147233963013
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.967123 --> -0.971697).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0067409
	speed: 0.1291s/iter; left time: 5619.8202s
	iters: 200, epoch: 8 | loss: 0.0204383
	speed: 0.0233s/iter; left time: 1011.9717s
	iters: 300, epoch: 8 | loss: 0.0016122
	speed: 0.0227s/iter; left time: 982.9669s
	iters: 400, epoch: 8 | loss: 0.0113172
	speed: 0.0220s/iter; left time: 951.5951s
Epoch: 8 cost time: 11.213523387908936
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.971697 --> -0.974556).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0016559
	speed: 0.1336s/iter; left time: 5751.1412s
	iters: 200, epoch: 9 | loss: 0.0062261
	speed: 0.0246s/iter; left time: 1058.4246s
	iters: 300, epoch: 9 | loss: 0.0004837
	speed: 0.0236s/iter; left time: 1012.6232s
	iters: 400, epoch: 9 | loss: 0.0285145
	speed: 0.0233s/iter; left time: 997.5095s
Epoch: 9 cost time: 11.956881761550903
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0116214
	speed: 0.1246s/iter; left time: 5305.0506s
	iters: 200, epoch: 10 | loss: 0.0059257
	speed: 0.0174s/iter; left time: 739.7571s
	iters: 300, epoch: 10 | loss: 0.0018058
	speed: 0.0172s/iter; left time: 729.0956s
	iters: 400, epoch: 10 | loss: 0.0092154
	speed: 0.0180s/iter; left time: 761.0684s
Epoch: 10 cost time: 8.80095624923706
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2051918
	speed: 0.0966s/iter; left time: 4066.1695s
	iters: 200, epoch: 11 | loss: 0.0022579
	speed: 0.0218s/iter; left time: 915.0660s
	iters: 300, epoch: 11 | loss: 0.0020872
	speed: 0.0226s/iter; left time: 948.7248s
	iters: 400, epoch: 11 | loss: 0.0084206
	speed: 0.0216s/iter; left time: 902.2921s
Epoch: 11 cost time: 10.447099208831787
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0131375
	speed: 0.1187s/iter; left time: 4942.1736s
	iters: 200, epoch: 12 | loss: 0.0159572
	speed: 0.0238s/iter; left time: 989.4348s
	iters: 300, epoch: 12 | loss: 0.0023096
	speed: 0.0221s/iter; left time: 915.8644s
	iters: 400, epoch: 12 | loss: 0.0012103
	speed: 0.0224s/iter; left time: 925.5237s
Epoch: 12 cost time: 11.082375288009644
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0089783
	speed: 0.1288s/iter; left time: 5304.6274s
	iters: 200, epoch: 13 | loss: 0.0164361
	speed: 0.0174s/iter; left time: 713.7600s
	iters: 300, epoch: 13 | loss: 0.0067575
	speed: 0.0173s/iter; left time: 708.6433s
	iters: 400, epoch: 13 | loss: 0.0090981
	speed: 0.0177s/iter; left time: 721.6702s
Epoch: 13 cost time: 8.885789632797241
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0318535
	speed: 0.1037s/iter; left time: 4221.2144s
	iters: 200, epoch: 14 | loss: 0.0401392
	speed: 0.0237s/iter; left time: 963.4926s
	iters: 300, epoch: 14 | loss: 0.0115470
	speed: 0.0249s/iter; left time: 1008.6967s
	iters: 400, epoch: 14 | loss: 0.0005292
	speed: 0.0253s/iter; left time: 1020.7363s
Epoch: 14 cost time: 11.313830375671387
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.2049175
	speed: 0.1421s/iter; left time: 5716.0311s
	iters: 200, epoch: 15 | loss: 0.0340579
	speed: 0.0241s/iter; left time: 965.4475s
	iters: 300, epoch: 15 | loss: 0.0030556
	speed: 0.0239s/iter; left time: 957.2319s
	iters: 400, epoch: 15 | loss: 0.0022581
	speed: 0.0292s/iter; left time: 1165.2703s
Epoch: 15 cost time: 13.180737018585205
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975699).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0469662
	speed: 0.1354s/iter; left time: 5383.5170s
	iters: 200, epoch: 16 | loss: 0.0017306
	speed: 0.0212s/iter; left time: 839.9100s
	iters: 300, epoch: 16 | loss: 0.0050329
	speed: 0.0223s/iter; left time: 883.6915s
	iters: 400, epoch: 16 | loss: 0.0084828
	speed: 0.0242s/iter; left time: 955.3943s
Epoch: 16 cost time: 10.86180067062378
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0026517
	speed: 0.1224s/iter; left time: 4808.3485s
	iters: 200, epoch: 17 | loss: 0.0184939
	speed: 0.0197s/iter; left time: 770.2884s
	iters: 300, epoch: 17 | loss: 0.0017142
	speed: 0.0189s/iter; left time: 738.3105s
	iters: 400, epoch: 17 | loss: 0.0400776
	speed: 0.0219s/iter; left time: 855.7552s
Epoch: 17 cost time: 9.960913896560669
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0093928
	speed: 0.1247s/iter; left time: 4841.3849s
	iters: 200, epoch: 18 | loss: 0.0002417
	speed: 0.0213s/iter; left time: 824.3423s
	iters: 300, epoch: 18 | loss: 0.0010476
	speed: 0.0221s/iter; left time: 853.8359s
	iters: 400, epoch: 18 | loss: 0.0023294
	speed: 0.0208s/iter; left time: 801.0527s
Epoch: 18 cost time: 10.474610805511475
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0037213
	speed: 0.1124s/iter; left time: 4310.6707s
	iters: 200, epoch: 19 | loss: 0.0064568
	speed: 0.0203s/iter; left time: 775.2347s
	iters: 300, epoch: 19 | loss: 0.0763535
	speed: 0.0221s/iter; left time: 843.1207s
	iters: 400, epoch: 19 | loss: 0.0008343
	speed: 0.0200s/iter; left time: 761.6724s
Epoch: 19 cost time: 10.156354427337646
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.954 Test Loss: 0.220 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0580607
	speed: 0.1184s/iter; left time: 4485.6501s
	iters: 200, epoch: 20 | loss: 0.2140293
	speed: 0.0198s/iter; left time: 746.8151s
	iters: 300, epoch: 20 | loss: 0.0010607
	speed: 0.0197s/iter; left time: 743.9903s
	iters: 400, epoch: 20 | loss: 0.0006024
	speed: 0.0205s/iter; left time: 772.3380s
Epoch: 20 cost time: 9.918877840042114
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0344095
	speed: 0.1104s/iter; left time: 4132.4906s
	iters: 200, epoch: 21 | loss: 0.0006641
	speed: 0.0254s/iter; left time: 946.9976s
	iters: 300, epoch: 21 | loss: 0.0025675
	speed: 0.0243s/iter; left time: 904.6423s
	iters: 400, epoch: 21 | loss: 0.0353504
	speed: 0.0213s/iter; left time: 791.3608s
Epoch: 21 cost time: 11.318525075912476
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0410010
	speed: 0.1182s/iter; left time: 4367.2768s
	iters: 200, epoch: 22 | loss: 0.0006499
	speed: 0.0237s/iter; left time: 872.1610s
	iters: 300, epoch: 22 | loss: 0.0011988
	speed: 0.0243s/iter; left time: 892.5041s
	iters: 400, epoch: 22 | loss: 0.0044176
	speed: 0.0309s/iter; left time: 1132.1666s
Epoch: 22 cost time: 12.82555866241455
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2450536
	speed: 0.1303s/iter; left time: 4753.0397s
	iters: 200, epoch: 23 | loss: 0.0599008
	speed: 0.0198s/iter; left time: 721.5462s
	iters: 300, epoch: 23 | loss: 0.0214557
	speed: 0.0205s/iter; left time: 744.6396s
	iters: 400, epoch: 23 | loss: 0.0013885
	speed: 0.0215s/iter; left time: 776.1852s
Epoch: 23 cost time: 10.135056734085083
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0127144
	speed: 0.1360s/iter; left time: 4896.1184s
	iters: 200, epoch: 24 | loss: 0.0023875
	speed: 0.0221s/iter; left time: 794.6249s
	iters: 300, epoch: 24 | loss: 0.0171394
	speed: 0.0244s/iter; left time: 873.4274s
	iters: 400, epoch: 24 | loss: 0.0053562
	speed: 0.0248s/iter; left time: 884.1687s
Epoch: 24 cost time: 11.325900554656982
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1099296
	speed: 0.1510s/iter; left time: 5366.6449s
	iters: 200, epoch: 25 | loss: 0.0069979
	speed: 0.0271s/iter; left time: 962.2491s
	iters: 300, epoch: 25 | loss: 0.0036335
	speed: 0.0241s/iter; left time: 853.3585s
	iters: 400, epoch: 25 | loss: 0.0045734
	speed: 0.0236s/iter; left time: 832.3532s
Epoch: 25 cost time: 12.426223516464233
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9757004002287021
model parameter : 404322
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4784194
	speed: 0.0376s/iter; left time: 1757.7465s
	iters: 200, epoch: 1 | loss: 0.9475347
	speed: 0.0217s/iter; left time: 1013.5842s
	iters: 300, epoch: 1 | loss: 0.4416453
	speed: 0.0187s/iter; left time: 871.2929s
	iters: 400, epoch: 1 | loss: 0.1893841
	speed: 0.0223s/iter; left time: 1037.4336s
Epoch: 1 cost time: 11.519402265548706
Epoch: 1, Steps: 469 | Train Loss: 0.861 Vali Loss: 0.365 Vali Acc: 0.899 Test Loss: 0.365 Test Acc: 0.899
Validation loss decreased (inf --> -0.899367).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2180984
	speed: 0.1202s/iter; left time: 5571.3675s
	iters: 200, epoch: 2 | loss: 0.0913548
	speed: 0.0253s/iter; left time: 1167.6043s
	iters: 300, epoch: 2 | loss: 0.0759451
	speed: 0.0244s/iter; left time: 1125.1452s
	iters: 400, epoch: 2 | loss: 0.2707145
	speed: 0.0244s/iter; left time: 1122.6415s
Epoch: 2 cost time: 11.81024718284607
Epoch: 2, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.899367 --> -0.943966).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1466704
	speed: 0.1253s/iter; left time: 5745.2992s
	iters: 200, epoch: 3 | loss: 0.2565106
	speed: 0.0220s/iter; left time: 1005.0057s
	iters: 300, epoch: 3 | loss: 0.2138934
	speed: 0.0269s/iter; left time: 1227.9092s
	iters: 400, epoch: 3 | loss: 0.3848509
	speed: 0.0286s/iter; left time: 1303.2823s
Epoch: 3 cost time: 12.547033309936523
Epoch: 3, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0059789
	speed: 0.1313s/iter; left time: 5962.2906s
	iters: 200, epoch: 4 | loss: 0.0200627
	speed: 0.0245s/iter; left time: 1108.0046s
	iters: 300, epoch: 4 | loss: 0.0104652
	speed: 0.0251s/iter; left time: 1136.3068s
	iters: 400, epoch: 4 | loss: 0.0261969
	speed: 0.0234s/iter; left time: 1053.3392s
Epoch: 4 cost time: 11.509126901626587
Epoch: 4, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.943966 --> -0.967695).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0199399
	speed: 0.1091s/iter; left time: 4899.8919s
	iters: 200, epoch: 5 | loss: 0.0088700
	speed: 0.0190s/iter; left time: 850.4914s
	iters: 300, epoch: 5 | loss: 0.0033666
	speed: 0.0199s/iter; left time: 888.8914s
	iters: 400, epoch: 5 | loss: 0.0037848
	speed: 0.0195s/iter; left time: 868.7864s
Epoch: 5 cost time: 9.595605611801147
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0257756
	speed: 0.1393s/iter; left time: 6191.6068s
	iters: 200, epoch: 6 | loss: 0.0663586
	speed: 0.0223s/iter; left time: 990.6082s
	iters: 300, epoch: 6 | loss: 0.0158641
	speed: 0.0215s/iter; left time: 952.9196s
	iters: 400, epoch: 6 | loss: 0.0038025
	speed: 0.0222s/iter; left time: 978.2919s
Epoch: 6 cost time: 11.040755271911621
Epoch: 6, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0189514
	speed: 0.1372s/iter; left time: 6033.6350s
	iters: 200, epoch: 7 | loss: 0.0121174
	speed: 0.0232s/iter; left time: 1017.2966s
	iters: 300, epoch: 7 | loss: 0.0485855
	speed: 0.0217s/iter; left time: 951.0821s
	iters: 400, epoch: 7 | loss: 0.0028339
	speed: 0.0214s/iter; left time: 933.4263s
Epoch: 7 cost time: 10.964109897613525
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.967695 --> -0.970839).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0048941
	speed: 0.0864s/iter; left time: 3758.3239s
	iters: 200, epoch: 8 | loss: 0.0196285
	speed: 0.0203s/iter; left time: 879.9431s
	iters: 300, epoch: 8 | loss: 0.5425485
	speed: 0.0228s/iter; left time: 986.3651s
	iters: 400, epoch: 8 | loss: 0.0016929
	speed: 0.0226s/iter; left time: 976.8650s
Epoch: 8 cost time: 10.497405529022217
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0920011
	speed: 0.1080s/iter; left time: 4649.3720s
	iters: 200, epoch: 9 | loss: 0.0009276
	speed: 0.0254s/iter; left time: 1091.6681s
	iters: 300, epoch: 9 | loss: 0.1930131
	speed: 0.0260s/iter; left time: 1113.6669s
	iters: 400, epoch: 9 | loss: 0.0061399
	speed: 0.0265s/iter; left time: 1132.4960s
Epoch: 9 cost time: 12.188295602798462
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0038407
	speed: 0.1415s/iter; left time: 6023.4206s
	iters: 200, epoch: 10 | loss: 0.0106292
	speed: 0.0229s/iter; left time: 972.0971s
	iters: 300, epoch: 10 | loss: 0.1040901
	speed: 0.0250s/iter; left time: 1059.4308s
	iters: 400, epoch: 10 | loss: 0.0155563
	speed: 0.0256s/iter; left time: 1081.1256s
Epoch: 10 cost time: 11.922741174697876
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0129888
	speed: 0.1546s/iter; left time: 6508.9771s
	iters: 200, epoch: 11 | loss: 0.0291300
	speed: 0.0236s/iter; left time: 993.0407s
	iters: 300, epoch: 11 | loss: 0.0035296
	speed: 0.0221s/iter; left time: 925.8805s
	iters: 400, epoch: 11 | loss: 0.0107527
	speed: 0.0219s/iter; left time: 916.2925s
Epoch: 11 cost time: 11.423298358917236
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0023271
	speed: 0.1167s/iter; left time: 4857.7775s
	iters: 200, epoch: 12 | loss: 0.0173713
	speed: 0.0215s/iter; left time: 891.5764s
	iters: 300, epoch: 12 | loss: 0.0095946
	speed: 0.0220s/iter; left time: 913.0362s
	iters: 400, epoch: 12 | loss: 0.0075283
	speed: 0.0216s/iter; left time: 892.4621s
Epoch: 12 cost time: 10.847360372543335
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0968865
	speed: 0.1315s/iter; left time: 5415.7381s
	iters: 200, epoch: 13 | loss: 0.0052515
	speed: 0.0219s/iter; left time: 897.8904s
	iters: 300, epoch: 13 | loss: 0.0515808
	speed: 0.0250s/iter; left time: 1025.6886s
	iters: 400, epoch: 13 | loss: 0.0097646
	speed: 0.0239s/iter; left time: 977.4883s
Epoch: 13 cost time: 11.195426940917969
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0837805
	speed: 0.1374s/iter; left time: 5594.5615s
	iters: 200, epoch: 14 | loss: 0.0038905
	speed: 0.0230s/iter; left time: 935.9039s
	iters: 300, epoch: 14 | loss: 0.0049988
	speed: 0.0228s/iter; left time: 923.5952s
	iters: 400, epoch: 14 | loss: 0.0352466
	speed: 0.0211s/iter; left time: 852.7848s
Epoch: 14 cost time: 11.493605375289917
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.972555).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0035247
	speed: 0.1163s/iter; left time: 4679.0360s
	iters: 200, epoch: 15 | loss: 0.0139673
	speed: 0.0208s/iter; left time: 836.5005s
	iters: 300, epoch: 15 | loss: 0.0610211
	speed: 0.0199s/iter; left time: 798.4899s
	iters: 400, epoch: 15 | loss: 0.0201603
	speed: 0.0197s/iter; left time: 788.1650s
Epoch: 15 cost time: 9.66480302810669
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0019483
	speed: 0.1123s/iter; left time: 4464.2263s
	iters: 200, epoch: 16 | loss: 0.0094678
	speed: 0.0261s/iter; left time: 1035.7548s
	iters: 300, epoch: 16 | loss: 0.0084394
	speed: 0.0226s/iter; left time: 893.9834s
	iters: 400, epoch: 16 | loss: 0.0439226
	speed: 0.0237s/iter; left time: 933.8491s
Epoch: 16 cost time: 11.817671775817871
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0008298
	speed: 0.1059s/iter; left time: 4161.4614s
	iters: 200, epoch: 17 | loss: 0.0347189
	speed: 0.0250s/iter; left time: 981.2966s
	iters: 300, epoch: 17 | loss: 0.0002159
	speed: 0.0240s/iter; left time: 936.6992s
	iters: 400, epoch: 17 | loss: 0.2080777
	speed: 0.0282s/iter; left time: 1099.9751s
Epoch: 17 cost time: 12.360806226730347
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0025779
	speed: 0.1131s/iter; left time: 4392.2053s
	iters: 200, epoch: 18 | loss: 0.0138338
	speed: 0.0197s/iter; left time: 762.2794s
	iters: 300, epoch: 18 | loss: 0.0005535
	speed: 0.0187s/iter; left time: 723.6819s
	iters: 400, epoch: 18 | loss: 0.0341363
	speed: 0.0201s/iter; left time: 774.2750s
Epoch: 18 cost time: 9.677799940109253
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0007572
	speed: 0.1190s/iter; left time: 4563.1621s
	iters: 200, epoch: 19 | loss: 0.0206687
	speed: 0.0252s/iter; left time: 964.3906s
	iters: 300, epoch: 19 | loss: 0.0023388
	speed: 0.0227s/iter; left time: 864.6587s
	iters: 400, epoch: 19 | loss: 0.1492563
	speed: 0.0263s/iter; left time: 1000.6519s
Epoch: 19 cost time: 12.35457444190979
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.972555 --> -0.978272).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0023982
	speed: 0.1717s/iter; left time: 6505.3181s
	iters: 200, epoch: 20 | loss: 0.0578208
	speed: 0.0260s/iter; left time: 983.4257s
	iters: 300, epoch: 20 | loss: 0.0013813
	speed: 0.0251s/iter; left time: 947.1411s
	iters: 400, epoch: 20 | loss: 0.0032314
	speed: 0.0258s/iter; left time: 969.8664s
Epoch: 20 cost time: 12.799060344696045
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.949 Test Loss: 0.233 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1129126
	speed: 0.1523s/iter; left time: 5700.1622s
	iters: 200, epoch: 21 | loss: 0.0015671
	speed: 0.0208s/iter; left time: 775.8754s
	iters: 300, epoch: 21 | loss: 0.0075911
	speed: 0.0220s/iter; left time: 817.8174s
	iters: 400, epoch: 21 | loss: 0.0010861
	speed: 0.0222s/iter; left time: 825.8900s
Epoch: 21 cost time: 10.665263652801514
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0026976
	speed: 0.1250s/iter; left time: 4617.4900s
	iters: 200, epoch: 22 | loss: 0.0335504
	speed: 0.0286s/iter; left time: 1054.8147s
	iters: 300, epoch: 22 | loss: 0.0011627
	speed: 0.0278s/iter; left time: 1020.1337s
	iters: 400, epoch: 22 | loss: 0.0075572
	speed: 0.0299s/iter; left time: 1094.3048s
Epoch: 22 cost time: 13.938740015029907
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0066232
	speed: 0.1239s/iter; left time: 4519.6020s
	iters: 200, epoch: 23 | loss: 0.0031357
	speed: 0.0266s/iter; left time: 966.1810s
	iters: 300, epoch: 23 | loss: 0.0092539
	speed: 0.0305s/iter; left time: 1106.7920s
	iters: 400, epoch: 23 | loss: 0.0082780
	speed: 0.0238s/iter; left time: 859.9119s
Epoch: 23 cost time: 12.368711233139038
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0410785
	speed: 0.1357s/iter; left time: 4887.3993s
	iters: 200, epoch: 24 | loss: 0.0009456
	speed: 0.0226s/iter; left time: 810.4985s
	iters: 300, epoch: 24 | loss: 0.0172780
	speed: 0.0216s/iter; left time: 773.3388s
	iters: 400, epoch: 24 | loss: 0.0007116
	speed: 0.0201s/iter; left time: 719.0561s
Epoch: 24 cost time: 10.474040985107422
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0010484
	speed: 0.0968s/iter; left time: 3440.9192s
	iters: 200, epoch: 25 | loss: 0.0003999
	speed: 0.0218s/iter; left time: 773.4070s
	iters: 300, epoch: 25 | loss: 0.1739243
	speed: 0.0234s/iter; left time: 825.4195s
	iters: 400, epoch: 25 | loss: 0.0089192
	speed: 0.0227s/iter; left time: 799.4302s
Epoch: 25 cost time: 10.578726530075073
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0010553
	speed: 0.1314s/iter; left time: 4609.2860s
	iters: 200, epoch: 26 | loss: 0.0004680
	speed: 0.0261s/iter; left time: 913.9954s
	iters: 300, epoch: 26 | loss: 0.0007878
	speed: 0.0243s/iter; left time: 848.3505s
	iters: 400, epoch: 26 | loss: 0.0014522
	speed: 0.0276s/iter; left time: 960.2879s
Epoch: 26 cost time: 12.939366579055786
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0003268
	speed: 0.1643s/iter; left time: 5685.3348s
	iters: 200, epoch: 27 | loss: 0.0623595
	speed: 0.0233s/iter; left time: 802.2879s
	iters: 300, epoch: 27 | loss: 0.0007920
	speed: 0.0238s/iter; left time: 818.9077s
	iters: 400, epoch: 27 | loss: 0.0039372
	speed: 0.0221s/iter; left time: 757.9334s
Epoch: 27 cost time: 11.280200958251953
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0003753
	speed: 0.1068s/iter; left time: 3645.3763s
	iters: 200, epoch: 28 | loss: 0.1309031
	speed: 0.0232s/iter; left time: 790.2181s
	iters: 300, epoch: 28 | loss: 0.0002948
	speed: 0.0238s/iter; left time: 808.6094s
	iters: 400, epoch: 28 | loss: 0.0023408
	speed: 0.0228s/iter; left time: 770.8653s
Epoch: 28 cost time: 10.84276032447815
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0021756
	speed: 0.1276s/iter; left time: 4296.3104s
	iters: 200, epoch: 29 | loss: 0.0030210
	speed: 0.0210s/iter; left time: 706.0552s
	iters: 300, epoch: 29 | loss: 0.0003295
	speed: 0.0211s/iter; left time: 706.3599s
	iters: 400, epoch: 29 | loss: 0.2078801
	speed: 0.0214s/iter; left time: 715.2811s
Epoch: 29 cost time: 10.842128992080688
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 404258
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3703159
	speed: 0.0330s/iter; left time: 1546.4341s
	iters: 200, epoch: 1 | loss: 0.7633490
	speed: 0.0240s/iter; left time: 1122.8698s
	iters: 300, epoch: 1 | loss: 0.3446320
	speed: 0.0241s/iter; left time: 1123.9592s
	iters: 400, epoch: 1 | loss: 0.2273213
	speed: 0.0253s/iter; left time: 1175.7310s
Epoch: 1 cost time: 12.493993520736694
Epoch: 1, Steps: 469 | Train Loss: 0.829 Vali Loss: 0.364 Vali Acc: 0.881 Test Loss: 0.364 Test Acc: 0.881
Validation loss decreased (inf --> -0.880500).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1692090
	speed: 0.1064s/iter; left time: 4928.6356s
	iters: 200, epoch: 2 | loss: 0.0628887
	speed: 0.0190s/iter; left time: 880.4229s
	iters: 300, epoch: 2 | loss: 0.0629812
	speed: 0.0221s/iter; left time: 1021.5828s
	iters: 400, epoch: 2 | loss: 0.0788321
	speed: 0.0214s/iter; left time: 987.0428s
Epoch: 2 cost time: 10.531310081481934
Epoch: 2, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.231 Vali Acc: 0.940 Test Loss: 0.231 Test Acc: 0.940
Validation loss decreased (-0.880500 --> -0.939963).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1756667
	speed: 0.1306s/iter; left time: 5989.2622s
	iters: 200, epoch: 3 | loss: 0.0251826
	speed: 0.0217s/iter; left time: 990.9544s
	iters: 300, epoch: 3 | loss: 0.0523670
	speed: 0.0235s/iter; left time: 1072.8685s
	iters: 400, epoch: 3 | loss: 0.0181527
	speed: 0.0252s/iter; left time: 1147.0867s
Epoch: 3 cost time: 11.255282878875732
Epoch: 3, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0706656
	speed: 0.1150s/iter; left time: 5221.0995s
	iters: 200, epoch: 4 | loss: 0.1051425
	speed: 0.0204s/iter; left time: 924.2992s
	iters: 300, epoch: 4 | loss: 0.0120557
	speed: 0.0253s/iter; left time: 1143.7169s
	iters: 400, epoch: 4 | loss: 0.2057167
	speed: 0.0236s/iter; left time: 1064.7712s
Epoch: 4 cost time: 11.251344680786133
Epoch: 4, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.939963 --> -0.956545).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0324926
	speed: 0.1190s/iter; left time: 5347.6605s
	iters: 200, epoch: 5 | loss: 0.0136169
	speed: 0.0250s/iter; left time: 1120.2220s
	iters: 300, epoch: 5 | loss: 0.0094432
	speed: 0.0273s/iter; left time: 1219.0178s
	iters: 400, epoch: 5 | loss: 0.0269075
	speed: 0.0261s/iter; left time: 1164.6223s
Epoch: 5 cost time: 11.667414426803589
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.956545 --> -0.970553).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0085431
	speed: 0.1122s/iter; left time: 4986.4972s
	iters: 200, epoch: 6 | loss: 0.0361205
	speed: 0.0267s/iter; left time: 1185.7245s
	iters: 300, epoch: 6 | loss: 0.2297120
	speed: 0.0282s/iter; left time: 1247.3018s
	iters: 400, epoch: 6 | loss: 0.4872152
	speed: 0.0233s/iter; left time: 1028.8771s
Epoch: 6 cost time: 12.225428342819214
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0867844
	speed: 0.1121s/iter; left time: 4932.1846s
	iters: 200, epoch: 7 | loss: 0.0103572
	speed: 0.0207s/iter; left time: 906.4265s
	iters: 300, epoch: 7 | loss: 0.0132720
	speed: 0.0238s/iter; left time: 1040.6770s
	iters: 400, epoch: 7 | loss: 0.0038047
	speed: 0.0201s/iter; left time: 880.0531s
Epoch: 7 cost time: 10.251265287399292
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0149572
	speed: 0.0884s/iter; left time: 3848.2151s
	iters: 200, epoch: 8 | loss: 0.0847643
	speed: 0.0189s/iter; left time: 818.9237s
	iters: 300, epoch: 8 | loss: 0.0108642
	speed: 0.0200s/iter; left time: 866.4883s
	iters: 400, epoch: 8 | loss: 0.0161517
	speed: 0.0215s/iter; left time: 930.7313s
Epoch: 8 cost time: 9.816445112228394
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.970553 --> -0.973126).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2702877
	speed: 0.1071s/iter; left time: 4610.1246s
	iters: 200, epoch: 9 | loss: 0.0318354
	speed: 0.0200s/iter; left time: 861.0167s
	iters: 300, epoch: 9 | loss: 0.0049068
	speed: 0.0204s/iter; left time: 872.1400s
	iters: 400, epoch: 9 | loss: 0.0019772
	speed: 0.0205s/iter; left time: 877.9125s
Epoch: 9 cost time: 9.934338331222534
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0131196
	speed: 0.1223s/iter; left time: 5205.6439s
	iters: 200, epoch: 10 | loss: 0.0497834
	speed: 0.0228s/iter; left time: 966.7491s
	iters: 300, epoch: 10 | loss: 0.0037548
	speed: 0.0279s/iter; left time: 1184.1923s
	iters: 400, epoch: 10 | loss: 0.2958273
	speed: 0.0242s/iter; left time: 1024.5723s
Epoch: 10 cost time: 11.51819109916687
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.222 Vali Acc: 0.940 Test Loss: 0.222 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1695166
	speed: 0.1111s/iter; left time: 4679.8404s
	iters: 200, epoch: 11 | loss: 0.0410264
	speed: 0.0187s/iter; left time: 786.5553s
	iters: 300, epoch: 11 | loss: 0.1988793
	speed: 0.0204s/iter; left time: 855.5629s
	iters: 400, epoch: 11 | loss: 0.2891515
	speed: 0.0219s/iter; left time: 914.4121s
Epoch: 11 cost time: 10.058470249176025
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0008501
	speed: 0.0999s/iter; left time: 4158.0255s
	iters: 200, epoch: 12 | loss: 0.0015178
	speed: 0.0210s/iter; left time: 874.0674s
	iters: 300, epoch: 12 | loss: 0.0008498
	speed: 0.0216s/iter; left time: 894.6408s
	iters: 400, epoch: 12 | loss: 0.0007018
	speed: 0.0218s/iter; left time: 901.8842s
Epoch: 12 cost time: 10.470806360244751
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0038646
	speed: 0.1560s/iter; left time: 6424.1599s
	iters: 200, epoch: 13 | loss: 0.0080980
	speed: 0.0276s/iter; left time: 1133.7727s
	iters: 300, epoch: 13 | loss: 0.0116498
	speed: 0.0299s/iter; left time: 1224.6243s
	iters: 400, epoch: 13 | loss: 0.0367934
	speed: 0.0271s/iter; left time: 1108.7734s
Epoch: 13 cost time: 13.193220853805542
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0143108
	speed: 0.1412s/iter; left time: 5746.5677s
	iters: 200, epoch: 14 | loss: 0.0460919
	speed: 0.0213s/iter; left time: 865.6956s
	iters: 300, epoch: 14 | loss: 0.0007737
	speed: 0.0258s/iter; left time: 1046.8515s
	iters: 400, epoch: 14 | loss: 0.0019657
	speed: 0.0196s/iter; left time: 793.7546s
Epoch: 14 cost time: 10.657966136932373
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0400903
	speed: 0.1186s/iter; left time: 4771.0465s
	iters: 200, epoch: 15 | loss: 0.0113778
	speed: 0.0214s/iter; left time: 858.5981s
	iters: 300, epoch: 15 | loss: 0.0212225
	speed: 0.0183s/iter; left time: 733.2551s
	iters: 400, epoch: 15 | loss: 0.0074615
	speed: 0.0192s/iter; left time: 767.3147s
Epoch: 15 cost time: 10.371853828430176
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0019991
	speed: 0.1350s/iter; left time: 5369.0163s
	iters: 200, epoch: 16 | loss: 0.0142168
	speed: 0.0290s/iter; left time: 1149.7483s
	iters: 300, epoch: 16 | loss: 0.0047590
	speed: 0.0259s/iter; left time: 1025.2722s
	iters: 400, epoch: 16 | loss: 0.0007344
	speed: 0.0225s/iter; left time: 886.1108s
Epoch: 16 cost time: 12.228229999542236
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0004987
	speed: 0.1131s/iter; left time: 4443.3997s
	iters: 200, epoch: 17 | loss: 0.0046969
	speed: 0.0250s/iter; left time: 978.2821s
	iters: 300, epoch: 17 | loss: 0.0032100
	speed: 0.0251s/iter; left time: 983.1710s
	iters: 400, epoch: 17 | loss: 0.0008849
	speed: 0.0205s/iter; left time: 800.7117s
Epoch: 17 cost time: 11.444371461868286
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0046249
	speed: 0.1189s/iter; left time: 4618.3585s
	iters: 200, epoch: 18 | loss: 0.0113956
	speed: 0.0269s/iter; left time: 1043.3584s
	iters: 300, epoch: 18 | loss: 0.0118932
	speed: 0.0269s/iter; left time: 1038.7529s
	iters: 400, epoch: 18 | loss: 0.0053558
	speed: 0.0226s/iter; left time: 871.9755s
Epoch: 18 cost time: 12.119432210922241
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9731275014293882
model parameter : 404194
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4753972
	speed: 0.0412s/iter; left time: 1926.3344s
	iters: 200, epoch: 1 | loss: 0.8666546
	speed: 0.0227s/iter; left time: 1060.0725s
	iters: 300, epoch: 1 | loss: 0.2717140
	speed: 0.0221s/iter; left time: 1027.6421s
	iters: 400, epoch: 1 | loss: 0.1852548
	speed: 0.0216s/iter; left time: 1005.0698s
Epoch: 1 cost time: 12.276303052902222
Epoch: 1, Steps: 469 | Train Loss: 0.921 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
Validation loss decreased (inf --> -0.911089).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2097941
	speed: 0.1337s/iter; left time: 6193.0431s
	iters: 200, epoch: 2 | loss: 0.0789901
	speed: 0.0286s/iter; left time: 1321.3477s
	iters: 300, epoch: 2 | loss: 0.0613530
	speed: 0.0271s/iter; left time: 1251.3552s
	iters: 400, epoch: 2 | loss: 0.2652572
	speed: 0.0226s/iter; left time: 1040.7892s
Epoch: 2 cost time: 12.823092937469482
Epoch: 2, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
Validation loss decreased (-0.911089 --> -0.957116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0381853
	speed: 0.1122s/iter; left time: 5147.3436s
	iters: 200, epoch: 3 | loss: 0.0493462
	speed: 0.0201s/iter; left time: 918.3659s
	iters: 300, epoch: 3 | loss: 0.0462148
	speed: 0.0193s/iter; left time: 880.6090s
	iters: 400, epoch: 3 | loss: 0.0466399
	speed: 0.0200s/iter; left time: 911.8967s
Epoch: 3 cost time: 9.753022193908691
Epoch: 3, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0301296
	speed: 0.1257s/iter; left time: 5708.1321s
	iters: 200, epoch: 4 | loss: 0.0259611
	speed: 0.0243s/iter; left time: 1101.7185s
	iters: 300, epoch: 4 | loss: 0.0233246
	speed: 0.0210s/iter; left time: 950.6935s
	iters: 400, epoch: 4 | loss: 0.0094314
	speed: 0.0198s/iter; left time: 892.7141s
Epoch: 4 cost time: 10.809983491897583
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0725691
	speed: 0.1129s/iter; left time: 5073.5052s
	iters: 200, epoch: 5 | loss: 0.0099260
	speed: 0.0208s/iter; left time: 932.4758s
	iters: 300, epoch: 5 | loss: 0.0181060
	speed: 0.0255s/iter; left time: 1140.2193s
	iters: 400, epoch: 5 | loss: 0.0258586
	speed: 0.0215s/iter; left time: 957.7326s
Epoch: 5 cost time: 10.84093451499939
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.957116 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0300432
	speed: 0.1315s/iter; left time: 5848.1368s
	iters: 200, epoch: 6 | loss: 0.2307825
	speed: 0.0219s/iter; left time: 973.6029s
	iters: 300, epoch: 6 | loss: 0.0055648
	speed: 0.0231s/iter; left time: 1023.1546s
	iters: 400, epoch: 6 | loss: 0.0056709
	speed: 0.0249s/iter; left time: 1100.4001s
Epoch: 6 cost time: 12.114659786224365
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0022129
	speed: 0.1529s/iter; left time: 6727.1496s
	iters: 200, epoch: 7 | loss: 0.0092064
	speed: 0.0233s/iter; left time: 1021.4427s
	iters: 300, epoch: 7 | loss: 0.0282819
	speed: 0.0258s/iter; left time: 1131.1957s
	iters: 400, epoch: 7 | loss: 0.0041844
	speed: 0.0256s/iter; left time: 1120.3795s
Epoch: 7 cost time: 12.565245389938354
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.969410 --> -0.974270).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0475621
	speed: 0.1173s/iter; left time: 5103.9145s
	iters: 200, epoch: 8 | loss: 0.0632815
	speed: 0.0215s/iter; left time: 933.4882s
	iters: 300, epoch: 8 | loss: 0.1078705
	speed: 0.0209s/iter; left time: 906.9308s
	iters: 400, epoch: 8 | loss: 0.0024661
	speed: 0.0209s/iter; left time: 905.1239s
Epoch: 8 cost time: 10.416481733322144
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0077666
	speed: 0.1350s/iter; left time: 5813.5155s
	iters: 200, epoch: 9 | loss: 0.0064345
	speed: 0.0192s/iter; left time: 825.5151s
	iters: 300, epoch: 9 | loss: 0.0076334
	speed: 0.0196s/iter; left time: 841.6514s
	iters: 400, epoch: 9 | loss: 0.0108635
	speed: 0.0190s/iter; left time: 812.5593s
Epoch: 9 cost time: 9.723375797271729
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1099882
	speed: 0.1044s/iter; left time: 4446.8903s
	iters: 200, epoch: 10 | loss: 0.0097135
	speed: 0.0176s/iter; left time: 747.3004s
	iters: 300, epoch: 10 | loss: 0.0035812
	speed: 0.0213s/iter; left time: 903.1910s
	iters: 400, epoch: 10 | loss: 0.0111789
	speed: 0.0214s/iter; left time: 904.9376s
Epoch: 10 cost time: 10.149129152297974
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0040790
	speed: 0.1160s/iter; left time: 4886.5106s
	iters: 200, epoch: 11 | loss: 0.0043829
	speed: 0.0222s/iter; left time: 930.7339s
	iters: 300, epoch: 11 | loss: 0.0031144
	speed: 0.0204s/iter; left time: 855.9850s
	iters: 400, epoch: 11 | loss: 0.0099097
	speed: 0.0239s/iter; left time: 999.5378s
Epoch: 11 cost time: 11.017493724822998
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0101469
	speed: 0.1134s/iter; left time: 4722.0293s
	iters: 200, epoch: 12 | loss: 0.0110547
	speed: 0.0218s/iter; left time: 906.0463s
	iters: 300, epoch: 12 | loss: 0.0039144
	speed: 0.0183s/iter; left time: 757.3889s
	iters: 400, epoch: 12 | loss: 0.0612518
	speed: 0.0205s/iter; left time: 846.8609s
Epoch: 12 cost time: 10.221775531768799
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0014322
	speed: 0.0915s/iter; left time: 3766.5061s
	iters: 200, epoch: 13 | loss: 0.0027208
	speed: 0.0213s/iter; left time: 874.0966s
	iters: 300, epoch: 13 | loss: 0.0038316
	speed: 0.0204s/iter; left time: 836.2719s
	iters: 400, epoch: 13 | loss: 0.0008995
	speed: 0.0207s/iter; left time: 844.4033s
Epoch: 13 cost time: 10.062498092651367
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0105380
	speed: 0.1027s/iter; left time: 4180.3237s
	iters: 200, epoch: 14 | loss: 0.0034369
	speed: 0.0185s/iter; left time: 751.0183s
	iters: 300, epoch: 14 | loss: 0.0041543
	speed: 0.0191s/iter; left time: 773.2546s
	iters: 400, epoch: 14 | loss: 0.3263331
	speed: 0.0206s/iter; left time: 830.6812s
Epoch: 14 cost time: 9.734058856964111
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0146625
	speed: 0.1058s/iter; left time: 4257.1309s
	iters: 200, epoch: 15 | loss: 0.1626568
	speed: 0.0198s/iter; left time: 793.7874s
	iters: 300, epoch: 15 | loss: 0.0056719
	speed: 0.0189s/iter; left time: 755.9186s
	iters: 400, epoch: 15 | loss: 0.0037812
	speed: 0.0180s/iter; left time: 720.7154s
Epoch: 15 cost time: 9.394251585006714
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0060920
	speed: 0.0853s/iter; left time: 3391.7045s
	iters: 200, epoch: 16 | loss: 0.1766285
	speed: 0.0204s/iter; left time: 810.9157s
	iters: 300, epoch: 16 | loss: 0.0009430
	speed: 0.0206s/iter; left time: 815.9016s
	iters: 400, epoch: 16 | loss: 0.0010364
	speed: 0.0269s/iter; left time: 1060.3349s
Epoch: 16 cost time: 10.824427366256714
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0125997
	speed: 0.1231s/iter; left time: 4837.5107s
	iters: 200, epoch: 17 | loss: 0.0083830
	speed: 0.0236s/iter; left time: 926.5561s
	iters: 300, epoch: 17 | loss: 0.0051126
	speed: 0.0228s/iter; left time: 890.6318s
	iters: 400, epoch: 17 | loss: 0.0008646
	speed: 0.0261s/iter; left time: 1017.4376s
Epoch: 17 cost time: 11.746435642242432
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.977415).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0793200
	speed: 0.1496s/iter; left time: 5806.8478s
	iters: 200, epoch: 18 | loss: 0.0170459
	speed: 0.0273s/iter; left time: 1056.8754s
	iters: 300, epoch: 18 | loss: 0.0062256
	speed: 0.0233s/iter; left time: 899.1948s
	iters: 400, epoch: 18 | loss: 0.0031038
	speed: 0.0210s/iter; left time: 809.3552s
Epoch: 18 cost time: 11.431407690048218
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0096367
	speed: 0.1083s/iter; left time: 4153.6472s
	iters: 200, epoch: 19 | loss: 0.0517967
	speed: 0.0203s/iter; left time: 775.4415s
	iters: 300, epoch: 19 | loss: 0.0054853
	speed: 0.0207s/iter; left time: 789.1401s
	iters: 400, epoch: 19 | loss: 0.0120597
	speed: 0.0206s/iter; left time: 784.5267s
Epoch: 19 cost time: 10.251081943511963
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0006353
	speed: 0.0954s/iter; left time: 3614.2191s
	iters: 200, epoch: 20 | loss: 0.0110955
	speed: 0.0208s/iter; left time: 784.9903s
	iters: 300, epoch: 20 | loss: 0.0004637
	speed: 0.0207s/iter; left time: 780.6533s
	iters: 400, epoch: 20 | loss: 0.0014439
	speed: 0.0204s/iter; left time: 766.1783s
Epoch: 20 cost time: 9.745805263519287
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005371
	speed: 0.1018s/iter; left time: 3810.4301s
	iters: 200, epoch: 21 | loss: 0.0031706
	speed: 0.0195s/iter; left time: 728.9622s
	iters: 300, epoch: 21 | loss: 0.0007125
	speed: 0.0173s/iter; left time: 644.6287s
	iters: 400, epoch: 21 | loss: 0.0003764
	speed: 0.0209s/iter; left time: 776.5909s
Epoch: 21 cost time: 9.822566986083984
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.979130).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0003660
	speed: 0.1112s/iter; left time: 4110.8673s
	iters: 200, epoch: 22 | loss: 0.0009365
	speed: 0.0253s/iter; left time: 933.7805s
	iters: 300, epoch: 22 | loss: 0.0002737
	speed: 0.0234s/iter; left time: 858.9695s
	iters: 400, epoch: 22 | loss: 0.0018581
	speed: 0.0225s/iter; left time: 824.0079s
Epoch: 22 cost time: 11.595399856567383
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003363
	speed: 0.1151s/iter; left time: 4197.5681s
	iters: 200, epoch: 23 | loss: 0.0072737
	speed: 0.0220s/iter; left time: 801.4499s
	iters: 300, epoch: 23 | loss: 0.0094416
	speed: 0.0185s/iter; left time: 672.5257s
	iters: 400, epoch: 23 | loss: 0.0065481
	speed: 0.0173s/iter; left time: 625.9818s
Epoch: 23 cost time: 9.572803974151611
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0021927
	speed: 0.1004s/iter; left time: 3614.0676s
	iters: 200, epoch: 24 | loss: 0.2546409
	speed: 0.0193s/iter; left time: 691.9518s
	iters: 300, epoch: 24 | loss: 0.0040507
	speed: 0.0194s/iter; left time: 696.0020s
	iters: 400, epoch: 24 | loss: 0.0647904
	speed: 0.0197s/iter; left time: 703.7234s
Epoch: 24 cost time: 9.5898916721344
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0023813
	speed: 0.1048s/iter; left time: 3726.7341s
	iters: 200, epoch: 25 | loss: 0.0012015
	speed: 0.0206s/iter; left time: 731.7932s
	iters: 300, epoch: 25 | loss: 0.0076298
	speed: 0.0228s/iter; left time: 806.5257s
	iters: 400, epoch: 25 | loss: 0.0017826
	speed: 0.0216s/iter; left time: 761.2337s
Epoch: 25 cost time: 10.495339393615723
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0001550
	speed: 0.0991s/iter; left time: 3477.3150s
	iters: 200, epoch: 26 | loss: 0.1192683
	speed: 0.0177s/iter; left time: 619.6030s
	iters: 300, epoch: 26 | loss: 0.0003155
	speed: 0.0182s/iter; left time: 633.2918s
	iters: 400, epoch: 26 | loss: 0.0010760
	speed: 0.0184s/iter; left time: 638.8149s
Epoch: 26 cost time: 8.99161958694458
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0007228
	speed: 0.0981s/iter; left time: 3396.5631s
	iters: 200, epoch: 27 | loss: 0.0029804
	speed: 0.0205s/iter; left time: 707.4369s
	iters: 300, epoch: 27 | loss: 0.0008370
	speed: 0.0234s/iter; left time: 806.7534s
	iters: 400, epoch: 27 | loss: 0.0124501
	speed: 0.0220s/iter; left time: 756.3274s
Epoch: 27 cost time: 10.616880178451538
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0009629
	speed: 0.1164s/iter; left time: 3973.6513s
	iters: 200, epoch: 28 | loss: 0.0038112
	speed: 0.0235s/iter; left time: 799.4909s
	iters: 300, epoch: 28 | loss: 0.0027989
	speed: 0.0243s/iter; left time: 824.5860s
	iters: 400, epoch: 28 | loss: 0.0171453
	speed: 0.0266s/iter; left time: 901.0211s
Epoch: 28 cost time: 12.13843297958374
Epoch: 28, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0356892
	speed: 0.1515s/iter; left time: 5101.8830s
	iters: 200, epoch: 29 | loss: 0.0054976
	speed: 0.0254s/iter; left time: 852.5160s
	iters: 300, epoch: 29 | loss: 0.0034310
	speed: 0.0205s/iter; left time: 686.3790s
	iters: 400, epoch: 29 | loss: 0.0002873
	speed: 0.0208s/iter; left time: 693.6986s
Epoch: 29 cost time: 11.183714866638184
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0031879
	speed: 0.1222s/iter; left time: 4057.6968s
	iters: 200, epoch: 30 | loss: 0.0014143
	speed: 0.0242s/iter; left time: 801.0750s
	iters: 300, epoch: 30 | loss: 0.0009241
	speed: 0.0244s/iter; left time: 804.7417s
	iters: 400, epoch: 30 | loss: 0.0582406
	speed: 0.0216s/iter; left time: 710.5020s
Epoch: 30 cost time: 11.567079305648804
Epoch: 30, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0008202
	speed: 0.1327s/iter; left time: 4342.6293s
	iters: 200, epoch: 31 | loss: 0.0107860
	speed: 0.0248s/iter; left time: 807.6865s
	iters: 300, epoch: 31 | loss: 0.0625743
	speed: 0.0246s/iter; left time: 798.9490s
	iters: 400, epoch: 31 | loss: 0.0249543
	speed: 0.0232s/iter; left time: 751.6919s
Epoch: 31 cost time: 11.377636432647705
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 305314
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7178332
	speed: 0.0332s/iter; left time: 1555.9707s
	iters: 200, epoch: 1 | loss: 0.6037228
	speed: 0.0208s/iter; left time: 971.9404s
	iters: 300, epoch: 1 | loss: 0.6120710
	speed: 0.0223s/iter; left time: 1038.2958s
	iters: 400, epoch: 1 | loss: 0.1916142
	speed: 0.0246s/iter; left time: 1146.0775s
Epoch: 1 cost time: 11.769146919250488
Epoch: 1, Steps: 469 | Train Loss: 0.950 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
Validation loss decreased (inf --> -0.862775).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2126579
	speed: 0.1297s/iter; left time: 6007.8596s
	iters: 200, epoch: 2 | loss: 0.6963123
	speed: 0.0215s/iter; left time: 992.4320s
	iters: 300, epoch: 2 | loss: 0.3698721
	speed: 0.0210s/iter; left time: 970.1609s
	iters: 400, epoch: 2 | loss: 0.0957112
	speed: 0.0240s/iter; left time: 1106.7857s
Epoch: 2 cost time: 11.124014139175415
Epoch: 2, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.862775 --> -0.943680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0364277
	speed: 0.1263s/iter; left time: 5792.0408s
	iters: 200, epoch: 3 | loss: 0.3877752
	speed: 0.0201s/iter; left time: 921.2726s
	iters: 300, epoch: 3 | loss: 0.0953421
	speed: 0.0190s/iter; left time: 869.4216s
	iters: 400, epoch: 3 | loss: 0.1068691
	speed: 0.0184s/iter; left time: 837.0562s
Epoch: 3 cost time: 9.821893453598022
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0942206
	speed: 0.0887s/iter; left time: 4027.8828s
	iters: 200, epoch: 4 | loss: 0.0204032
	speed: 0.0198s/iter; left time: 897.1965s
	iters: 300, epoch: 4 | loss: 0.0147907
	speed: 0.0209s/iter; left time: 944.2632s
	iters: 400, epoch: 4 | loss: 0.0151364
	speed: 0.0224s/iter; left time: 1011.2875s
Epoch: 4 cost time: 10.14255690574646
Epoch: 4, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.943680 --> -0.949684).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0372373
	speed: 0.1116s/iter; left time: 5013.9517s
	iters: 200, epoch: 5 | loss: 0.0124268
	speed: 0.0239s/iter; left time: 1072.5936s
	iters: 300, epoch: 5 | loss: 0.0223373
	speed: 0.0225s/iter; left time: 1006.9806s
	iters: 400, epoch: 5 | loss: 0.6908924
	speed: 0.0234s/iter; left time: 1045.1244s
Epoch: 5 cost time: 11.382861375808716
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.213 Vali Acc: 0.940 Test Loss: 0.213 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0227017
	speed: 0.1348s/iter; left time: 5994.6555s
	iters: 200, epoch: 6 | loss: 0.0220207
	speed: 0.0210s/iter; left time: 933.1887s
	iters: 300, epoch: 6 | loss: 0.0636686
	speed: 0.0188s/iter; left time: 830.8517s
	iters: 400, epoch: 6 | loss: 0.0220383
	speed: 0.0192s/iter; left time: 849.2728s
Epoch: 6 cost time: 10.498516082763672
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.949684 --> -0.963120).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0079329
	speed: 0.1171s/iter; left time: 5150.7949s
	iters: 200, epoch: 7 | loss: 0.0270289
	speed: 0.0238s/iter; left time: 1042.6277s
	iters: 300, epoch: 7 | loss: 0.2679431
	speed: 0.0213s/iter; left time: 932.8393s
	iters: 400, epoch: 7 | loss: 0.3445672
	speed: 0.0246s/iter; left time: 1072.6460s
Epoch: 7 cost time: 11.570167541503906
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0219255
	speed: 0.1382s/iter; left time: 6012.3761s
	iters: 200, epoch: 8 | loss: 0.4632433
	speed: 0.0229s/iter; left time: 992.2862s
	iters: 300, epoch: 8 | loss: 0.0324031
	speed: 0.0241s/iter; left time: 1045.2984s
	iters: 400, epoch: 8 | loss: 0.0807501
	speed: 0.0251s/iter; left time: 1082.7287s
Epoch: 8 cost time: 11.792567729949951
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0871909
	speed: 0.1214s/iter; left time: 5227.1310s
	iters: 200, epoch: 9 | loss: 0.1034026
	speed: 0.0211s/iter; left time: 906.6774s
	iters: 300, epoch: 9 | loss: 0.0007808
	speed: 0.0194s/iter; left time: 829.1321s
	iters: 400, epoch: 9 | loss: 0.0014082
	speed: 0.0209s/iter; left time: 894.4355s
Epoch: 9 cost time: 10.137895345687866
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0097633
	speed: 0.1049s/iter; left time: 4466.3788s
	iters: 200, epoch: 10 | loss: 0.0184513
	speed: 0.0217s/iter; left time: 920.7047s
	iters: 300, epoch: 10 | loss: 0.0144145
	speed: 0.0198s/iter; left time: 838.9123s
	iters: 400, epoch: 10 | loss: 0.0071629
	speed: 0.0224s/iter; left time: 945.7246s
Epoch: 10 cost time: 10.378137826919556
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0031019
	speed: 0.1316s/iter; left time: 5539.7060s
	iters: 200, epoch: 11 | loss: 0.0039498
	speed: 0.0255s/iter; left time: 1072.2869s
	iters: 300, epoch: 11 | loss: 0.0130815
	speed: 0.0234s/iter; left time: 980.6298s
	iters: 400, epoch: 11 | loss: 0.0201652
	speed: 0.0228s/iter; left time: 951.3369s
Epoch: 11 cost time: 11.764743089675903
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.262 Vali Acc: 0.947 Test Loss: 0.262 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0167034
	speed: 0.1310s/iter; left time: 5453.4125s
	iters: 200, epoch: 12 | loss: 0.0014149
	speed: 0.0271s/iter; left time: 1124.9264s
	iters: 300, epoch: 12 | loss: 0.0435922
	speed: 0.0260s/iter; left time: 1076.9317s
	iters: 400, epoch: 12 | loss: 0.0054882
	speed: 0.0232s/iter; left time: 957.2338s
Epoch: 12 cost time: 12.177867889404297
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.963120 --> -0.966551).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1554365
	speed: 0.1038s/iter; left time: 4274.5911s
	iters: 200, epoch: 13 | loss: 0.0079315
	speed: 0.0189s/iter; left time: 776.6103s
	iters: 300, epoch: 13 | loss: 0.0235511
	speed: 0.0175s/iter; left time: 717.7082s
	iters: 400, epoch: 13 | loss: 0.0020571
	speed: 0.0203s/iter; left time: 830.5105s
Epoch: 13 cost time: 9.447164297103882
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.966551 --> -0.971983).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0010172
	speed: 0.1287s/iter; left time: 5240.3698s
	iters: 200, epoch: 14 | loss: 0.0182036
	speed: 0.0202s/iter; left time: 819.8215s
	iters: 300, epoch: 14 | loss: 0.0052817
	speed: 0.0201s/iter; left time: 815.7576s
	iters: 400, epoch: 14 | loss: 0.0069252
	speed: 0.0230s/iter; left time: 928.2718s
Epoch: 14 cost time: 10.337154626846313
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0012893
	speed: 0.1097s/iter; left time: 4415.0678s
	iters: 200, epoch: 15 | loss: 0.0141279
	speed: 0.0225s/iter; left time: 901.9903s
	iters: 300, epoch: 15 | loss: 0.1365778
	speed: 0.0219s/iter; left time: 876.1662s
	iters: 400, epoch: 15 | loss: 0.0173569
	speed: 0.0198s/iter; left time: 788.9039s
Epoch: 15 cost time: 10.626784801483154
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0041709
	speed: 0.0981s/iter; left time: 3901.0556s
	iters: 200, epoch: 16 | loss: 0.1265356
	speed: 0.0192s/iter; left time: 760.6154s
	iters: 300, epoch: 16 | loss: 0.0294126
	speed: 0.0201s/iter; left time: 795.7938s
	iters: 400, epoch: 16 | loss: 0.0087916
	speed: 0.0226s/iter; left time: 890.3272s
Epoch: 16 cost time: 10.109142303466797
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0098418
	speed: 0.1415s/iter; left time: 5560.7586s
	iters: 200, epoch: 17 | loss: 0.0021718
	speed: 0.0256s/iter; left time: 1002.6961s
	iters: 300, epoch: 17 | loss: 0.0022015
	speed: 0.0242s/iter; left time: 945.4050s
	iters: 400, epoch: 17 | loss: 0.0021277
	speed: 0.0251s/iter; left time: 978.1045s
Epoch: 17 cost time: 12.457911014556885
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0016438
	speed: 0.1390s/iter; left time: 5395.3691s
	iters: 200, epoch: 18 | loss: 0.0007100
	speed: 0.0210s/iter; left time: 811.5993s
	iters: 300, epoch: 18 | loss: 0.0131518
	speed: 0.0205s/iter; left time: 791.9147s
	iters: 400, epoch: 18 | loss: 0.0031704
	speed: 0.0188s/iter; left time: 723.3572s
Epoch: 18 cost time: 9.962681531906128
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0011428
	speed: 0.0849s/iter; left time: 3255.5648s
	iters: 200, epoch: 19 | loss: 0.0343598
	speed: 0.0217s/iter; left time: 831.8609s
	iters: 300, epoch: 19 | loss: 0.0034456
	speed: 0.0230s/iter; left time: 876.2618s
	iters: 400, epoch: 19 | loss: 0.0012590
	speed: 0.0197s/iter; left time: 751.2014s
Epoch: 19 cost time: 10.236670017242432
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0018135
	speed: 0.1291s/iter; left time: 4890.4780s
	iters: 200, epoch: 20 | loss: 0.0087648
	speed: 0.0217s/iter; left time: 820.6515s
	iters: 300, epoch: 20 | loss: 0.0021813
	speed: 0.0203s/iter; left time: 763.8846s
	iters: 400, epoch: 20 | loss: 0.0271108
	speed: 0.0216s/iter; left time: 812.0071s
Epoch: 20 cost time: 10.439730405807495
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0017265
	speed: 0.0978s/iter; left time: 3660.3439s
	iters: 200, epoch: 21 | loss: 0.0013923
	speed: 0.0202s/iter; left time: 753.0398s
	iters: 300, epoch: 21 | loss: 0.0035593
	speed: 0.0206s/iter; left time: 766.9144s
	iters: 400, epoch: 21 | loss: 0.0007608
	speed: 0.0222s/iter; left time: 825.0527s
Epoch: 21 cost time: 10.381271362304688
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0017949
	speed: 0.1083s/iter; left time: 4002.7839s
	iters: 200, epoch: 22 | loss: 0.0014388
	speed: 0.0229s/iter; left time: 843.8939s
	iters: 300, epoch: 22 | loss: 0.0021573
	speed: 0.0243s/iter; left time: 893.9794s
	iters: 400, epoch: 22 | loss: 0.0391313
	speed: 0.0245s/iter; left time: 899.0560s
Epoch: 22 cost time: 11.592496156692505
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0007577
	speed: 0.1459s/iter; left time: 5321.3526s
	iters: 200, epoch: 23 | loss: 0.0084358
	speed: 0.0233s/iter; left time: 846.0613s
	iters: 300, epoch: 23 | loss: 0.0004858
	speed: 0.0225s/iter; left time: 817.0762s
	iters: 400, epoch: 23 | loss: 0.0026704
	speed: 0.0212s/iter; left time: 765.7679s
Epoch: 23 cost time: 11.413559198379517
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 305250
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3884941
	speed: 0.0401s/iter; left time: 1877.3659s
	iters: 200, epoch: 1 | loss: 1.2375252
	speed: 0.0226s/iter; left time: 1053.2608s
	iters: 300, epoch: 1 | loss: 0.3894674
	speed: 0.0203s/iter; left time: 943.9398s
	iters: 400, epoch: 1 | loss: 0.4270955
	speed: 0.0238s/iter; left time: 1105.9881s
Epoch: 1 cost time: 12.302079439163208
Epoch: 1, Steps: 469 | Train Loss: 0.918 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
Validation loss decreased (inf --> -0.891077).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1168277
	speed: 0.1103s/iter; left time: 5111.7702s
	iters: 200, epoch: 2 | loss: 0.0635015
	speed: 0.0214s/iter; left time: 990.3966s
	iters: 300, epoch: 2 | loss: 0.0728866
	speed: 0.0216s/iter; left time: 996.6113s
	iters: 400, epoch: 2 | loss: 0.6938039
	speed: 0.0245s/iter; left time: 1129.6249s
Epoch: 2 cost time: 10.839740991592407
Epoch: 2, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.213 Vali Acc: 0.936 Test Loss: 0.213 Test Acc: 0.936
Validation loss decreased (-0.891077 --> -0.936247).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0185115
	speed: 0.1028s/iter; left time: 4712.4625s
	iters: 200, epoch: 3 | loss: 0.0701471
	speed: 0.0195s/iter; left time: 892.9580s
	iters: 300, epoch: 3 | loss: 0.1639590
	speed: 0.0216s/iter; left time: 985.0705s
	iters: 400, epoch: 3 | loss: 0.0198989
	speed: 0.0238s/iter; left time: 1085.7266s
Epoch: 3 cost time: 10.57292890548706
Epoch: 3, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
Validation loss decreased (-0.936247 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0214034
	speed: 0.1161s/iter; left time: 5269.8726s
	iters: 200, epoch: 4 | loss: 0.0202954
	speed: 0.0219s/iter; left time: 993.0409s
	iters: 300, epoch: 4 | loss: 0.0857137
	speed: 0.0221s/iter; left time: 1000.3108s
	iters: 400, epoch: 4 | loss: 0.0800974
	speed: 0.0240s/iter; left time: 1082.9210s
Epoch: 4 cost time: 11.588850975036621
Epoch: 4, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
Validation loss decreased (-0.955973 --> -0.960261).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0917948
	speed: 0.1300s/iter; left time: 5839.3199s
	iters: 200, epoch: 5 | loss: 0.0228365
	speed: 0.0203s/iter; left time: 909.7793s
	iters: 300, epoch: 5 | loss: 0.0396670
	speed: 0.0203s/iter; left time: 908.2162s
	iters: 400, epoch: 5 | loss: 0.0029599
	speed: 0.0196s/iter; left time: 872.9695s
Epoch: 5 cost time: 9.921778917312622
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.960261 --> -0.964264).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0421912
	speed: 0.0987s/iter; left time: 4387.6843s
	iters: 200, epoch: 6 | loss: 0.1566583
	speed: 0.0225s/iter; left time: 996.0261s
	iters: 300, epoch: 6 | loss: 0.1297769
	speed: 0.0196s/iter; left time: 867.1189s
	iters: 400, epoch: 6 | loss: 0.0077941
	speed: 0.0185s/iter; left time: 817.0234s
Epoch: 6 cost time: 9.837368249893188
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.964264 --> -0.969696).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0611193
	speed: 0.1193s/iter; left time: 5247.7580s
	iters: 200, epoch: 7 | loss: 0.0447380
	speed: 0.0242s/iter; left time: 1061.3449s
	iters: 300, epoch: 7 | loss: 0.2358722
	speed: 0.0244s/iter; left time: 1066.2976s
	iters: 400, epoch: 7 | loss: 0.0029347
	speed: 0.0223s/iter; left time: 974.7733s
Epoch: 7 cost time: 11.78875207901001
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0017355
	speed: 0.1293s/iter; left time: 5625.7118s
	iters: 200, epoch: 8 | loss: 0.0204060
	speed: 0.0222s/iter; left time: 963.0852s
	iters: 300, epoch: 8 | loss: 0.0115981
	speed: 0.0184s/iter; left time: 796.5281s
	iters: 400, epoch: 8 | loss: 0.0375949
	speed: 0.0194s/iter; left time: 839.1191s
Epoch: 8 cost time: 10.80490779876709
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0388017
	speed: 0.1088s/iter; left time: 4684.3138s
	iters: 200, epoch: 9 | loss: 0.0020602
	speed: 0.0222s/iter; left time: 953.6489s
	iters: 300, epoch: 9 | loss: 0.0069950
	speed: 0.0213s/iter; left time: 912.6075s
	iters: 400, epoch: 9 | loss: 0.0782511
	speed: 0.0221s/iter; left time: 944.3158s
Epoch: 9 cost time: 10.749073266983032
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0018229
	speed: 0.1171s/iter; left time: 4988.2198s
	iters: 200, epoch: 10 | loss: 0.0139766
	speed: 0.0243s/iter; left time: 1031.3954s
	iters: 300, epoch: 10 | loss: 0.0068172
	speed: 0.0251s/iter; left time: 1062.8927s
	iters: 400, epoch: 10 | loss: 0.0639967
	speed: 0.0242s/iter; left time: 1021.9312s
Epoch: 10 cost time: 11.742913007736206
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0067635
	speed: 0.1241s/iter; left time: 5224.4985s
	iters: 200, epoch: 11 | loss: 0.0156715
	speed: 0.0210s/iter; left time: 882.2674s
	iters: 300, epoch: 11 | loss: 0.0065702
	speed: 0.0213s/iter; left time: 891.0969s
	iters: 400, epoch: 11 | loss: 0.0051995
	speed: 0.0196s/iter; left time: 819.5661s
Epoch: 11 cost time: 10.178895473480225
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0244712
	speed: 0.1123s/iter; left time: 4676.8698s
	iters: 200, epoch: 12 | loss: 0.0225386
	speed: 0.0187s/iter; left time: 775.8857s
	iters: 300, epoch: 12 | loss: 0.0081575
	speed: 0.0192s/iter; left time: 796.3621s
	iters: 400, epoch: 12 | loss: 0.0109909
	speed: 0.0183s/iter; left time: 757.6889s
Epoch: 12 cost time: 9.811226844787598
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2757444
	speed: 0.1034s/iter; left time: 4258.5434s
	iters: 200, epoch: 13 | loss: 0.0019462
	speed: 0.0225s/iter; left time: 923.6062s
	iters: 300, epoch: 13 | loss: 0.0047808
	speed: 0.0223s/iter; left time: 912.3378s
	iters: 400, epoch: 13 | loss: 0.6852539
	speed: 0.0226s/iter; left time: 922.5283s
Epoch: 13 cost time: 10.771232843399048
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0464895
	speed: 0.1194s/iter; left time: 4858.5472s
	iters: 200, epoch: 14 | loss: 0.0039858
	speed: 0.0224s/iter; left time: 909.3652s
	iters: 300, epoch: 14 | loss: 0.0131088
	speed: 0.0227s/iter; left time: 918.6264s
	iters: 400, epoch: 14 | loss: 0.0006818
	speed: 0.0241s/iter; left time: 973.3738s
Epoch: 14 cost time: 11.031493902206421
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0011332
	speed: 0.1090s/iter; left time: 4384.0737s
	iters: 200, epoch: 15 | loss: 0.0040489
	speed: 0.0197s/iter; left time: 789.3807s
	iters: 300, epoch: 15 | loss: 0.3238727
	speed: 0.0203s/iter; left time: 812.9553s
	iters: 400, epoch: 15 | loss: 0.0185910
	speed: 0.0201s/iter; left time: 802.5950s
Epoch: 15 cost time: 9.868940353393555
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0375165
	speed: 0.0998s/iter; left time: 3969.0911s
	iters: 200, epoch: 16 | loss: 0.0088913
	speed: 0.0209s/iter; left time: 829.6293s
	iters: 300, epoch: 16 | loss: 0.0030790
	speed: 0.0249s/iter; left time: 983.4265s
	iters: 400, epoch: 16 | loss: 0.0226021
	speed: 0.0289s/iter; left time: 1141.1998s
Epoch: 16 cost time: 11.709675788879395
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9696969696969697
model parameter : 305186
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7042549
	speed: 0.0350s/iter; left time: 1635.8620s
	iters: 200, epoch: 1 | loss: 0.7124299
	speed: 0.0163s/iter; left time: 763.4666s
	iters: 300, epoch: 1 | loss: 0.3083642
	speed: 0.0179s/iter; left time: 836.2877s
	iters: 400, epoch: 1 | loss: 0.2260505
	speed: 0.0188s/iter; left time: 872.9503s
Epoch: 1 cost time: 10.020580530166626
Epoch: 1, Steps: 469 | Train Loss: 0.930 Vali Loss: 0.385 Vali Acc: 0.881 Test Loss: 0.385 Test Acc: 0.881
Validation loss decreased (inf --> -0.881357).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2077829
	speed: 0.0946s/iter; left time: 4382.6857s
	iters: 200, epoch: 2 | loss: 0.1672093
	speed: 0.0180s/iter; left time: 832.2093s
	iters: 300, epoch: 2 | loss: 0.1565245
	speed: 0.0195s/iter; left time: 898.3830s
	iters: 400, epoch: 2 | loss: 0.0552153
	speed: 0.0208s/iter; left time: 959.5631s
Epoch: 2 cost time: 9.61401629447937
Epoch: 2, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.881357 --> -0.930243).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0328164
	speed: 0.1177s/iter; left time: 5396.6417s
	iters: 200, epoch: 3 | loss: 0.0146495
	speed: 0.0201s/iter; left time: 918.9966s
	iters: 300, epoch: 3 | loss: 0.0516952
	speed: 0.0210s/iter; left time: 958.1331s
	iters: 400, epoch: 3 | loss: 0.0637984
	speed: 0.0197s/iter; left time: 896.8127s
Epoch: 3 cost time: 9.963448286056519
Epoch: 3, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930243 --> -0.930529).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0361500
	speed: 0.1251s/iter; left time: 5680.1839s
	iters: 200, epoch: 4 | loss: 0.2279342
	speed: 0.0214s/iter; left time: 969.2864s
	iters: 300, epoch: 4 | loss: 0.0331449
	speed: 0.0223s/iter; left time: 1006.0514s
	iters: 400, epoch: 4 | loss: 0.3159451
	speed: 0.0197s/iter; left time: 889.3938s
Epoch: 4 cost time: 10.337489366531372
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.930529 --> -0.940249).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1733828
	speed: 0.0978s/iter; left time: 4393.2002s
	iters: 200, epoch: 5 | loss: 0.0812945
	speed: 0.0205s/iter; left time: 917.1885s
	iters: 300, epoch: 5 | loss: 0.0207450
	speed: 0.0230s/iter; left time: 1030.0883s
	iters: 400, epoch: 5 | loss: 0.0044518
	speed: 0.0231s/iter; left time: 1030.5012s
Epoch: 5 cost time: 10.490312576293945
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.940249 --> -0.963692).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2055570
	speed: 0.1088s/iter; left time: 4837.3380s
	iters: 200, epoch: 6 | loss: 0.0017865
	speed: 0.0216s/iter; left time: 956.3954s
	iters: 300, epoch: 6 | loss: 0.0249136
	speed: 0.0212s/iter; left time: 936.4110s
	iters: 400, epoch: 6 | loss: 0.0739764
	speed: 0.0213s/iter; left time: 942.4259s
Epoch: 6 cost time: 10.4415123462677
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0206355
	speed: 0.1176s/iter; left time: 5170.9715s
	iters: 200, epoch: 7 | loss: 0.0087344
	speed: 0.0204s/iter; left time: 894.6826s
	iters: 300, epoch: 7 | loss: 0.0056515
	speed: 0.0192s/iter; left time: 840.6510s
	iters: 400, epoch: 7 | loss: 0.0231620
	speed: 0.0224s/iter; left time: 977.4982s
Epoch: 7 cost time: 10.26867413520813
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0134320
	speed: 0.1189s/iter; left time: 5175.0173s
	iters: 200, epoch: 8 | loss: 0.0123375
	speed: 0.0237s/iter; left time: 1027.5986s
	iters: 300, epoch: 8 | loss: 0.4307246
	speed: 0.0197s/iter; left time: 853.4915s
	iters: 400, epoch: 8 | loss: 0.0053570
	speed: 0.0220s/iter; left time: 949.2953s
Epoch: 8 cost time: 10.70443320274353
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0985065
	speed: 0.1150s/iter; left time: 4950.6580s
	iters: 200, epoch: 9 | loss: 0.1786369
	speed: 0.0218s/iter; left time: 937.7668s
	iters: 300, epoch: 9 | loss: 0.0101152
	speed: 0.0218s/iter; left time: 935.9330s
	iters: 400, epoch: 9 | loss: 0.0025646
	speed: 0.0219s/iter; left time: 937.3919s
Epoch: 9 cost time: 10.643590211868286
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0494578
	speed: 0.1094s/iter; left time: 4657.3484s
	iters: 200, epoch: 10 | loss: 0.0051924
	speed: 0.0191s/iter; left time: 809.5026s
	iters: 300, epoch: 10 | loss: 0.0971039
	speed: 0.0190s/iter; left time: 806.2041s
	iters: 400, epoch: 10 | loss: 0.0139266
	speed: 0.0178s/iter; left time: 751.6318s
Epoch: 10 cost time: 9.11936902999878
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0016011
	speed: 0.0888s/iter; left time: 3739.5666s
	iters: 200, epoch: 11 | loss: 0.0176236
	speed: 0.0201s/iter; left time: 843.1771s
	iters: 300, epoch: 11 | loss: 0.0040667
	speed: 0.0184s/iter; left time: 772.5177s
	iters: 400, epoch: 11 | loss: 0.0284322
	speed: 0.0177s/iter; left time: 741.7022s
Epoch: 11 cost time: 9.149916887283325
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0029665
	speed: 0.1117s/iter; left time: 4651.9687s
	iters: 200, epoch: 12 | loss: 0.0052447
	speed: 0.0229s/iter; left time: 952.8099s
	iters: 300, epoch: 12 | loss: 0.0029305
	speed: 0.0257s/iter; left time: 1065.9965s
	iters: 400, epoch: 12 | loss: 0.0046600
	speed: 0.0250s/iter; left time: 1033.4409s
Epoch: 12 cost time: 11.99497365951538
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0107974
	speed: 0.1305s/iter; left time: 5374.3406s
	iters: 200, epoch: 13 | loss: 0.2083886
	speed: 0.0269s/iter; left time: 1106.7006s
	iters: 300, epoch: 13 | loss: 0.0011408
	speed: 0.0261s/iter; left time: 1067.8312s
	iters: 400, epoch: 13 | loss: 0.0009580
	speed: 0.0227s/iter; left time: 925.7894s
Epoch: 13 cost time: 11.821842432022095
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0015386
	speed: 0.1010s/iter; left time: 4111.2717s
	iters: 200, epoch: 14 | loss: 0.0107032
	speed: 0.0199s/iter; left time: 806.5905s
	iters: 300, epoch: 14 | loss: 0.0129686
	speed: 0.0208s/iter; left time: 842.3818s
	iters: 400, epoch: 14 | loss: 0.0125942
	speed: 0.0210s/iter; left time: 847.4805s
Epoch: 14 cost time: 10.046218633651733
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.963692 --> -0.973412).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0782148
	speed: 0.1486s/iter; left time: 5979.6846s
	iters: 200, epoch: 15 | loss: 0.0068057
	speed: 0.0230s/iter; left time: 924.1017s
	iters: 300, epoch: 15 | loss: 0.3351123
	speed: 0.0226s/iter; left time: 903.0453s
	iters: 400, epoch: 15 | loss: 0.0226794
	speed: 0.0237s/iter; left time: 948.2046s
Epoch: 15 cost time: 11.394149541854858
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0394309
	speed: 0.1410s/iter; left time: 5606.7674s
	iters: 200, epoch: 16 | loss: 0.0026522
	speed: 0.0267s/iter; left time: 1060.2928s
	iters: 300, epoch: 16 | loss: 0.0045748
	speed: 0.0251s/iter; left time: 994.2734s
	iters: 400, epoch: 16 | loss: 0.1112971
	speed: 0.0211s/iter; left time: 831.9815s
Epoch: 16 cost time: 11.707935810089111
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0006524
	speed: 0.1041s/iter; left time: 4091.0104s
	iters: 200, epoch: 17 | loss: 0.0010551
	speed: 0.0242s/iter; left time: 949.3153s
	iters: 300, epoch: 17 | loss: 0.1030633
	speed: 0.0231s/iter; left time: 903.2717s
	iters: 400, epoch: 17 | loss: 0.0006014
	speed: 0.0202s/iter; left time: 786.8126s
Epoch: 17 cost time: 10.661369800567627
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0454444
	speed: 0.1239s/iter; left time: 4811.7453s
	iters: 200, epoch: 18 | loss: 0.1894671
	speed: 0.0243s/iter; left time: 942.2880s
	iters: 300, epoch: 18 | loss: 0.0037030
	speed: 0.0216s/iter; left time: 834.5189s
	iters: 400, epoch: 18 | loss: 0.1445948
	speed: 0.0216s/iter; left time: 830.4474s
Epoch: 18 cost time: 10.922326803207397
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.285 Vali Acc: 0.936 Test Loss: 0.285 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0037780
	speed: 0.1205s/iter; left time: 4621.1664s
	iters: 200, epoch: 19 | loss: 0.0003805
	speed: 0.0223s/iter; left time: 852.8285s
	iters: 300, epoch: 19 | loss: 0.0009010
	speed: 0.0187s/iter; left time: 714.6637s
	iters: 400, epoch: 19 | loss: 0.1272625
	speed: 0.0191s/iter; left time: 728.6354s
Epoch: 19 cost time: 10.356281995773315
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0030637
	speed: 0.1009s/iter; left time: 3821.7397s
	iters: 200, epoch: 20 | loss: 0.0215786
	speed: 0.0208s/iter; left time: 784.2222s
	iters: 300, epoch: 20 | loss: 0.0127969
	speed: 0.0201s/iter; left time: 758.4861s
	iters: 400, epoch: 20 | loss: 0.0001920
	speed: 0.0215s/iter; left time: 808.3637s
Epoch: 20 cost time: 10.445712566375732
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.189 Vali Acc: 0.955 Test Loss: 0.189 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0057281
	speed: 0.1289s/iter; left time: 4824.5226s
	iters: 200, epoch: 21 | loss: 0.0008237
	speed: 0.0223s/iter; left time: 833.1300s
	iters: 300, epoch: 21 | loss: 0.0245502
	speed: 0.0264s/iter; left time: 983.2794s
	iters: 400, epoch: 21 | loss: 0.7021833
	speed: 0.0237s/iter; left time: 879.5774s
Epoch: 21 cost time: 11.682641744613647
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0012827
	speed: 0.1093s/iter; left time: 4038.0661s
	iters: 200, epoch: 22 | loss: 0.0142642
	speed: 0.0197s/iter; left time: 725.2284s
	iters: 300, epoch: 22 | loss: 0.0711277
	speed: 0.0196s/iter; left time: 718.7453s
	iters: 400, epoch: 22 | loss: 0.0009096
	speed: 0.0216s/iter; left time: 790.6802s
Epoch: 22 cost time: 9.87225341796875
Epoch: 22, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0060249
	speed: 0.1091s/iter; left time: 3980.1818s
	iters: 200, epoch: 23 | loss: 0.0006000
	speed: 0.0261s/iter; left time: 948.3694s
	iters: 300, epoch: 23 | loss: 0.0238679
	speed: 0.0265s/iter; left time: 959.7378s
	iters: 400, epoch: 23 | loss: 0.0003518
	speed: 0.0245s/iter; left time: 887.3066s
Epoch: 23 cost time: 12.136175155639648
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0008198
	speed: 0.1395s/iter; left time: 5025.4677s
	iters: 200, epoch: 24 | loss: 0.0036882
	speed: 0.0246s/iter; left time: 882.8742s
	iters: 300, epoch: 24 | loss: 0.0017648
	speed: 0.0259s/iter; left time: 927.6740s
	iters: 400, epoch: 24 | loss: 0.0346652
	speed: 0.0257s/iter; left time: 918.0150s
Epoch: 24 cost time: 12.742161750793457
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9734133790737565
model parameter : 305122
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4852229
	speed: 0.0371s/iter; left time: 1735.4891s
	iters: 200, epoch: 1 | loss: 0.7841117
	speed: 0.0246s/iter; left time: 1151.1640s
	iters: 300, epoch: 1 | loss: 0.4306519
	speed: 0.0221s/iter; left time: 1028.0498s
	iters: 400, epoch: 1 | loss: 0.2781118
	speed: 0.0209s/iter; left time: 971.3906s
Epoch: 1 cost time: 11.952075481414795
Epoch: 1, Steps: 469 | Train Loss: 1.022 Vali Loss: 0.413 Vali Acc: 0.867 Test Loss: 0.413 Test Acc: 0.867
Validation loss decreased (inf --> -0.867349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3038276
	speed: 0.1187s/iter; left time: 5497.5360s
	iters: 200, epoch: 2 | loss: 0.1432903
	speed: 0.0254s/iter; left time: 1172.1989s
	iters: 300, epoch: 2 | loss: 0.2027463
	speed: 0.0255s/iter; left time: 1176.8739s
	iters: 400, epoch: 2 | loss: 0.0622391
	speed: 0.0225s/iter; left time: 1034.0126s
Epoch: 2 cost time: 11.343921899795532
Epoch: 2, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
Validation loss decreased (-0.867349 --> -0.932245).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0673411
	speed: 0.1021s/iter; left time: 4681.6658s
	iters: 200, epoch: 3 | loss: 0.5331986
	speed: 0.0200s/iter; left time: 914.6086s
	iters: 300, epoch: 3 | loss: 0.0248633
	speed: 0.0196s/iter; left time: 894.5887s
	iters: 400, epoch: 3 | loss: 0.1108971
	speed: 0.0204s/iter; left time: 931.2684s
Epoch: 3 cost time: 9.998800277709961
Epoch: 3, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.270 Vali Acc: 0.923 Test Loss: 0.270 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0207961
	speed: 0.1059s/iter; left time: 4807.9734s
	iters: 200, epoch: 4 | loss: 0.0559635
	speed: 0.0178s/iter; left time: 804.6451s
	iters: 300, epoch: 4 | loss: 0.0075115
	speed: 0.0159s/iter; left time: 718.4485s
	iters: 400, epoch: 4 | loss: 0.0698691
	speed: 0.0180s/iter; left time: 813.4532s
Epoch: 4 cost time: 8.64875054359436
Epoch: 4, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.166 Vali Acc: 0.947 Test Loss: 0.166 Test Acc: 0.947
Validation loss decreased (-0.932245 --> -0.946539).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2315074
	speed: 0.0930s/iter; left time: 4178.0730s
	iters: 200, epoch: 5 | loss: 0.0962006
	speed: 0.0184s/iter; left time: 822.6954s
	iters: 300, epoch: 5 | loss: 0.0067613
	speed: 0.0193s/iter; left time: 861.0290s
	iters: 400, epoch: 5 | loss: 0.0361155
	speed: 0.0185s/iter; left time: 827.0626s
Epoch: 5 cost time: 9.08970308303833
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.946539 --> -0.947683).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0050641
	speed: 0.1050s/iter; left time: 4667.5062s
	iters: 200, epoch: 6 | loss: 0.0226042
	speed: 0.0194s/iter; left time: 858.3591s
	iters: 300, epoch: 6 | loss: 0.1059292
	speed: 0.0190s/iter; left time: 840.3757s
	iters: 400, epoch: 6 | loss: 0.0947775
	speed: 0.0185s/iter; left time: 818.8081s
Epoch: 6 cost time: 9.3050856590271
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.947683 --> -0.960261).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1407342
	speed: 0.1049s/iter; left time: 4612.5936s
	iters: 200, epoch: 7 | loss: 0.1279124
	speed: 0.0251s/iter; left time: 1101.5560s
	iters: 300, epoch: 7 | loss: 0.0180906
	speed: 0.0243s/iter; left time: 1063.0526s
	iters: 400, epoch: 7 | loss: 0.3706813
	speed: 0.0250s/iter; left time: 1090.6596s
Epoch: 7 cost time: 11.831089735031128
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1354425
	speed: 0.1031s/iter; left time: 4488.2697s
	iters: 200, epoch: 8 | loss: 0.0044589
	speed: 0.0190s/iter; left time: 823.3811s
	iters: 300, epoch: 8 | loss: 0.0104530
	speed: 0.0198s/iter; left time: 859.4033s
	iters: 400, epoch: 8 | loss: 0.0019542
	speed: 0.0193s/iter; left time: 834.7129s
Epoch: 8 cost time: 9.556336402893066
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0181466
	speed: 0.1269s/iter; left time: 5464.0113s
	iters: 200, epoch: 9 | loss: 0.0489567
	speed: 0.0229s/iter; left time: 982.2073s
	iters: 300, epoch: 9 | loss: 0.0625161
	speed: 0.0266s/iter; left time: 1139.6347s
	iters: 400, epoch: 9 | loss: 0.0371277
	speed: 0.0239s/iter; left time: 1020.3072s
Epoch: 9 cost time: 11.597040176391602
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0052206
	speed: 0.1299s/iter; left time: 5532.4647s
	iters: 200, epoch: 10 | loss: 0.0271524
	speed: 0.0248s/iter; left time: 1054.8026s
	iters: 300, epoch: 10 | loss: 0.0026648
	speed: 0.0238s/iter; left time: 1009.4437s
	iters: 400, epoch: 10 | loss: 0.0028091
	speed: 0.0211s/iter; left time: 890.0998s
Epoch: 10 cost time: 11.552239656448364
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0995989
	speed: 0.1224s/iter; left time: 5155.9617s
	iters: 200, epoch: 11 | loss: 0.0014824
	speed: 0.0218s/iter; left time: 915.3227s
	iters: 300, epoch: 11 | loss: 0.0110196
	speed: 0.0238s/iter; left time: 998.1491s
	iters: 400, epoch: 11 | loss: 0.2486739
	speed: 0.0220s/iter; left time: 919.5577s
Epoch: 11 cost time: 11.379416227340698
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0084916
	speed: 0.1091s/iter; left time: 4542.8845s
	iters: 200, epoch: 12 | loss: 0.1047202
	speed: 0.0199s/iter; left time: 826.3515s
	iters: 300, epoch: 12 | loss: 0.0047727
	speed: 0.0203s/iter; left time: 842.3778s
	iters: 400, epoch: 12 | loss: 0.0179740
	speed: 0.0195s/iter; left time: 807.3685s
Epoch: 12 cost time: 9.721278190612793
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0016295
	speed: 0.1154s/iter; left time: 4749.7306s
	iters: 200, epoch: 13 | loss: 0.0307742
	speed: 0.0257s/iter; left time: 1055.7424s
	iters: 300, epoch: 13 | loss: 0.0055522
	speed: 0.0256s/iter; left time: 1049.5214s
	iters: 400, epoch: 13 | loss: 0.0018468
	speed: 0.0232s/iter; left time: 946.8634s
Epoch: 13 cost time: 11.485692501068115
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
Validation loss decreased (-0.960261 --> -0.961119).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0563454
	speed: 0.1060s/iter; left time: 4314.6597s
	iters: 200, epoch: 14 | loss: 0.0025829
	speed: 0.0208s/iter; left time: 845.3882s
	iters: 300, epoch: 14 | loss: 0.0028648
	speed: 0.0207s/iter; left time: 838.4430s
	iters: 400, epoch: 14 | loss: 0.0219362
	speed: 0.0218s/iter; left time: 880.2149s
Epoch: 14 cost time: 10.098361492156982
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0034835
	speed: 0.0806s/iter; left time: 3241.7113s
	iters: 200, epoch: 15 | loss: 0.0547554
	speed: 0.0190s/iter; left time: 763.5041s
	iters: 300, epoch: 15 | loss: 0.0378679
	speed: 0.0188s/iter; left time: 753.9131s
	iters: 400, epoch: 15 | loss: 0.0027884
	speed: 0.0179s/iter; left time: 715.7042s
Epoch: 15 cost time: 9.05684208869934
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0020615
	speed: 0.1123s/iter; left time: 4464.9225s
	iters: 200, epoch: 16 | loss: 0.0010617
	speed: 0.0206s/iter; left time: 817.1052s
	iters: 300, epoch: 16 | loss: 0.1067219
	speed: 0.0203s/iter; left time: 804.3134s
	iters: 400, epoch: 16 | loss: 0.0005537
	speed: 0.0195s/iter; left time: 767.6956s
Epoch: 16 cost time: 9.926222324371338
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
Validation loss decreased (-0.961119 --> -0.964835).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0005477
	speed: 0.1217s/iter; left time: 4783.1100s
	iters: 200, epoch: 17 | loss: 0.0039195
	speed: 0.0272s/iter; left time: 1064.6359s
	iters: 300, epoch: 17 | loss: 0.0206185
	speed: 0.0228s/iter; left time: 892.9301s
	iters: 400, epoch: 17 | loss: 0.0047042
	speed: 0.0230s/iter; left time: 895.3842s
Epoch: 17 cost time: 11.476280212402344
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.964835 --> -0.967122).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0016363
	speed: 0.1167s/iter; left time: 4532.1672s
	iters: 200, epoch: 18 | loss: 0.0004179
	speed: 0.0198s/iter; left time: 766.0986s
	iters: 300, epoch: 18 | loss: 0.0010627
	speed: 0.0208s/iter; left time: 802.2204s
	iters: 400, epoch: 18 | loss: 0.0054757
	speed: 0.0203s/iter; left time: 780.8430s
Epoch: 18 cost time: 9.762393236160278
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.967122 --> -0.970267).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0841428
	speed: 0.1030s/iter; left time: 3952.4954s
	iters: 200, epoch: 19 | loss: 0.0013055
	speed: 0.0228s/iter; left time: 872.8596s
	iters: 300, epoch: 19 | loss: 0.0092013
	speed: 0.0214s/iter; left time: 815.0623s
	iters: 400, epoch: 19 | loss: 0.0027804
	speed: 0.0201s/iter; left time: 763.4211s
Epoch: 19 cost time: 10.378328084945679
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0017584
	speed: 0.1016s/iter; left time: 3847.7378s
	iters: 200, epoch: 20 | loss: 0.0104804
	speed: 0.0245s/iter; left time: 925.0312s
	iters: 300, epoch: 20 | loss: 0.0027375
	speed: 0.0228s/iter; left time: 858.7296s
	iters: 400, epoch: 20 | loss: 0.0014150
	speed: 0.0227s/iter; left time: 853.8043s
Epoch: 20 cost time: 10.848558187484741
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.970267 --> -0.977700).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0052627
	speed: 0.1136s/iter; left time: 4252.2347s
	iters: 200, epoch: 21 | loss: 0.0046061
	speed: 0.0204s/iter; left time: 762.3099s
	iters: 300, epoch: 21 | loss: 0.0252837
	speed: 0.0200s/iter; left time: 743.3790s
	iters: 400, epoch: 21 | loss: 0.1281750
	speed: 0.0215s/iter; left time: 797.7451s
Epoch: 21 cost time: 10.01078486442566
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0737196
	speed: 0.1072s/iter; left time: 3961.6990s
	iters: 200, epoch: 22 | loss: 0.0063830
	speed: 0.0195s/iter; left time: 720.3203s
	iters: 300, epoch: 22 | loss: 0.0048055
	speed: 0.0233s/iter; left time: 856.2250s
	iters: 400, epoch: 22 | loss: 0.0025238
	speed: 0.0225s/iter; left time: 825.4593s
Epoch: 22 cost time: 10.330799341201782
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0007891
	speed: 0.1164s/iter; left time: 4245.3847s
	iters: 200, epoch: 23 | loss: 0.0009469
	speed: 0.0231s/iter; left time: 841.2466s
	iters: 300, epoch: 23 | loss: 0.2964596
	speed: 0.0223s/iter; left time: 809.6985s
	iters: 400, epoch: 23 | loss: 0.0002123
	speed: 0.0222s/iter; left time: 804.7998s
Epoch: 23 cost time: 10.824320554733276
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0018454
	speed: 0.1081s/iter; left time: 3892.7714s
	iters: 200, epoch: 24 | loss: 0.0005788
	speed: 0.0193s/iter; left time: 691.8969s
	iters: 300, epoch: 24 | loss: 0.0014724
	speed: 0.0177s/iter; left time: 633.3565s
	iters: 400, epoch: 24 | loss: 0.0041752
	speed: 0.0176s/iter; left time: 629.9820s
Epoch: 24 cost time: 9.066922903060913
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0011092
	speed: 0.0937s/iter; left time: 3330.8585s
	iters: 200, epoch: 25 | loss: 0.0007947
	speed: 0.0210s/iter; left time: 742.9932s
	iters: 300, epoch: 25 | loss: 0.0014203
	speed: 0.0225s/iter; left time: 795.9543s
	iters: 400, epoch: 25 | loss: 0.0068932
	speed: 0.0187s/iter; left time: 659.2261s
Epoch: 25 cost time: 10.178837537765503
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0990369
	speed: 0.1031s/iter; left time: 3617.2807s
	iters: 200, epoch: 26 | loss: 0.0018059
	speed: 0.0226s/iter; left time: 790.1959s
	iters: 300, epoch: 26 | loss: 0.0042872
	speed: 0.0233s/iter; left time: 814.2866s
	iters: 400, epoch: 26 | loss: 0.0011602
	speed: 0.0242s/iter; left time: 840.5429s
Epoch: 26 cost time: 11.04222822189331
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0067953
	speed: 0.1163s/iter; left time: 4024.9479s
	iters: 200, epoch: 27 | loss: 0.0040882
	speed: 0.0210s/iter; left time: 725.4972s
	iters: 300, epoch: 27 | loss: 0.0035903
	speed: 0.0226s/iter; left time: 776.8512s
	iters: 400, epoch: 27 | loss: 0.0212225
	speed: 0.0217s/iter; left time: 745.9943s
Epoch: 27 cost time: 10.384859323501587
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0023884
	speed: 0.1004s/iter; left time: 3428.4894s
	iters: 200, epoch: 28 | loss: 0.0002226
	speed: 0.0203s/iter; left time: 691.4375s
	iters: 300, epoch: 28 | loss: 0.0684727
	speed: 0.0188s/iter; left time: 639.3283s
	iters: 400, epoch: 28 | loss: 0.0063962
	speed: 0.0193s/iter; left time: 652.8630s
Epoch: 28 cost time: 9.535528421401978
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0053311
	speed: 0.1029s/iter; left time: 3465.4437s
	iters: 200, epoch: 29 | loss: 0.0073365
	speed: 0.0207s/iter; left time: 695.9837s
	iters: 300, epoch: 29 | loss: 0.0181870
	speed: 0.0233s/iter; left time: 781.2865s
	iters: 400, epoch: 29 | loss: 0.0006701
	speed: 0.0261s/iter; left time: 869.8638s
Epoch: 29 cost time: 11.177021980285645
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0006315
	speed: 0.1158s/iter; left time: 3845.6608s
	iters: 200, epoch: 30 | loss: 0.0012770
	speed: 0.0218s/iter; left time: 722.4355s
	iters: 300, epoch: 30 | loss: 0.0068983
	speed: 0.0205s/iter; left time: 675.1405s
	iters: 400, epoch: 30 | loss: 0.0027169
	speed: 0.0197s/iter; left time: 647.8269s
Epoch: 30 cost time: 9.762072324752808
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 255778
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6129169
	speed: 0.0400s/iter; left time: 1873.4797s
	iters: 200, epoch: 1 | loss: 0.7838807
	speed: 0.0202s/iter; left time: 941.5982s
	iters: 300, epoch: 1 | loss: 0.6211792
	speed: 0.0195s/iter; left time: 908.6943s
	iters: 400, epoch: 1 | loss: 0.3351446
	speed: 0.0229s/iter; left time: 1064.5161s
Epoch: 1 cost time: 11.748999118804932
Epoch: 1, Steps: 469 | Train Loss: 0.974 Vali Loss: 0.424 Vali Acc: 0.864 Test Loss: 0.424 Test Acc: 0.864
Validation loss decreased (inf --> -0.864490).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2371218
	speed: 0.1118s/iter; left time: 5181.2971s
	iters: 200, epoch: 2 | loss: 0.2239610
	speed: 0.0235s/iter; left time: 1086.1433s
	iters: 300, epoch: 2 | loss: 0.1609153
	speed: 0.0222s/iter; left time: 1026.2547s
	iters: 400, epoch: 2 | loss: 0.2101621
	speed: 0.0225s/iter; left time: 1033.5389s
Epoch: 2 cost time: 10.938418865203857
Epoch: 2, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.864490 --> -0.933102).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0358097
	speed: 0.0889s/iter; left time: 4075.0394s
	iters: 200, epoch: 3 | loss: 0.0397627
	speed: 0.0202s/iter; left time: 923.9682s
	iters: 300, epoch: 3 | loss: 0.0165165
	speed: 0.0206s/iter; left time: 940.1760s
	iters: 400, epoch: 3 | loss: 0.2796290
	speed: 0.0229s/iter; left time: 1044.7357s
Epoch: 3 cost time: 10.341826677322388
Epoch: 3, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.933102 --> -0.965122).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0086809
	speed: 0.1244s/iter; left time: 5646.6418s
	iters: 200, epoch: 4 | loss: 0.0110448
	speed: 0.0231s/iter; left time: 1047.4653s
	iters: 300, epoch: 4 | loss: 0.0348619
	speed: 0.0230s/iter; left time: 1038.7672s
	iters: 400, epoch: 4 | loss: 0.0831869
	speed: 0.0231s/iter; left time: 1039.5061s
Epoch: 4 cost time: 11.170565128326416
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0448294
	speed: 0.1430s/iter; left time: 6422.4220s
	iters: 200, epoch: 5 | loss: 0.3740468
	speed: 0.0253s/iter; left time: 1133.5235s
	iters: 300, epoch: 5 | loss: 0.0533850
	speed: 0.0225s/iter; left time: 1007.3513s
	iters: 400, epoch: 5 | loss: 0.0108146
	speed: 0.0214s/iter; left time: 954.1950s
Epoch: 5 cost time: 11.686668634414673
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0451713
	speed: 0.0935s/iter; left time: 4158.7118s
	iters: 200, epoch: 6 | loss: 0.0166597
	speed: 0.0207s/iter; left time: 919.5253s
	iters: 300, epoch: 6 | loss: 0.0321111
	speed: 0.0226s/iter; left time: 999.4085s
	iters: 400, epoch: 6 | loss: 0.0488025
	speed: 0.0230s/iter; left time: 1014.5340s
Epoch: 6 cost time: 10.599287986755371
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0387106
	speed: 0.0981s/iter; left time: 4315.6646s
	iters: 200, epoch: 7 | loss: 0.0126495
	speed: 0.0205s/iter; left time: 900.7912s
	iters: 300, epoch: 7 | loss: 0.0138425
	speed: 0.0199s/iter; left time: 872.2185s
	iters: 400, epoch: 7 | loss: 0.0415217
	speed: 0.0224s/iter; left time: 978.1730s
Epoch: 7 cost time: 10.048707008361816
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0126958
	speed: 0.1160s/iter; left time: 5047.8686s
	iters: 200, epoch: 8 | loss: 0.0103884
	speed: 0.0206s/iter; left time: 895.1970s
	iters: 300, epoch: 8 | loss: 0.0148075
	speed: 0.0221s/iter; left time: 956.5420s
	iters: 400, epoch: 8 | loss: 0.3477141
	speed: 0.0202s/iter; left time: 872.9086s
Epoch: 8 cost time: 10.072527170181274
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1026207
	speed: 0.1076s/iter; left time: 4633.4237s
	iters: 200, epoch: 9 | loss: 0.0068224
	speed: 0.0190s/iter; left time: 814.5521s
	iters: 300, epoch: 9 | loss: 0.2863924
	speed: 0.0198s/iter; left time: 848.8581s
	iters: 400, epoch: 9 | loss: 0.0110837
	speed: 0.0213s/iter; left time: 910.7772s
Epoch: 9 cost time: 9.979871273040771
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0161206
	speed: 0.1088s/iter; left time: 4634.4467s
	iters: 200, epoch: 10 | loss: 0.0135441
	speed: 0.0199s/iter; left time: 843.8289s
	iters: 300, epoch: 10 | loss: 0.0102743
	speed: 0.0205s/iter; left time: 868.2296s
	iters: 400, epoch: 10 | loss: 0.0018603
	speed: 0.0222s/iter; left time: 940.5331s
Epoch: 10 cost time: 10.209310293197632
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.965122 --> -0.976271).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0638359
	speed: 0.1023s/iter; left time: 4307.5000s
	iters: 200, epoch: 11 | loss: 0.0293242
	speed: 0.0190s/iter; left time: 796.6192s
	iters: 300, epoch: 11 | loss: 0.0023980
	speed: 0.0190s/iter; left time: 797.6568s
	iters: 400, epoch: 11 | loss: 0.0056209
	speed: 0.0192s/iter; left time: 804.2765s
Epoch: 11 cost time: 9.22486138343811
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0040610
	speed: 0.0783s/iter; left time: 3261.2937s
	iters: 200, epoch: 12 | loss: 0.0140459
	speed: 0.0237s/iter; left time: 983.0837s
	iters: 300, epoch: 12 | loss: 0.0005088
	speed: 0.0280s/iter; left time: 1161.5742s
	iters: 400, epoch: 12 | loss: 0.0035558
	speed: 0.0308s/iter; left time: 1272.0333s
Epoch: 12 cost time: 12.504483461380005
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0376249
	speed: 0.1462s/iter; left time: 6018.3879s
	iters: 200, epoch: 13 | loss: 0.0034186
	speed: 0.0310s/iter; left time: 1271.2938s
	iters: 300, epoch: 13 | loss: 0.0037565
	speed: 0.0250s/iter; left time: 1022.3111s
	iters: 400, epoch: 13 | loss: 0.0382774
	speed: 0.0239s/iter; left time: 978.1668s
Epoch: 13 cost time: 12.932059049606323
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0033573
	speed: 0.1213s/iter; left time: 4935.9415s
	iters: 200, epoch: 14 | loss: 0.0031347
	speed: 0.0211s/iter; left time: 857.8237s
	iters: 300, epoch: 14 | loss: 0.0158420
	speed: 0.0224s/iter; left time: 909.0058s
	iters: 400, epoch: 14 | loss: 0.1064803
	speed: 0.0213s/iter; left time: 858.7955s
Epoch: 14 cost time: 10.419935703277588
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3486511
	speed: 0.1021s/iter; left time: 4107.5783s
	iters: 200, epoch: 15 | loss: 0.0013742
	speed: 0.0226s/iter; left time: 906.0139s
	iters: 300, epoch: 15 | loss: 0.0081689
	speed: 0.0230s/iter; left time: 919.0400s
	iters: 400, epoch: 15 | loss: 0.0028622
	speed: 0.0253s/iter; left time: 1012.0811s
Epoch: 15 cost time: 11.641983985900879
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0083675
	speed: 0.1426s/iter; left time: 5670.5426s
	iters: 200, epoch: 16 | loss: 0.0009581
	speed: 0.0282s/iter; left time: 1117.2799s
	iters: 300, epoch: 16 | loss: 0.0138947
	speed: 0.0241s/iter; left time: 952.3560s
	iters: 400, epoch: 16 | loss: 0.0039411
	speed: 0.0243s/iter; left time: 959.9887s
Epoch: 16 cost time: 12.498680591583252
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0020882
	speed: 0.0965s/iter; left time: 3792.2230s
	iters: 200, epoch: 17 | loss: 0.0003990
	speed: 0.0187s/iter; left time: 734.1711s
	iters: 300, epoch: 17 | loss: 0.0050969
	speed: 0.0204s/iter; left time: 798.2941s
	iters: 400, epoch: 17 | loss: 0.0010444
	speed: 0.0196s/iter; left time: 764.2726s
Epoch: 17 cost time: 9.455012798309326
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0327184
	speed: 0.0845s/iter; left time: 3280.1433s
	iters: 200, epoch: 18 | loss: 0.1313285
	speed: 0.0202s/iter; left time: 780.8427s
	iters: 300, epoch: 18 | loss: 0.0111477
	speed: 0.0202s/iter; left time: 778.8393s
	iters: 400, epoch: 18 | loss: 0.0008194
	speed: 0.0209s/iter; left time: 803.9213s
Epoch: 18 cost time: 10.204698324203491
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3033069
	speed: 0.1389s/iter; left time: 5327.2951s
	iters: 200, epoch: 19 | loss: 0.0172050
	speed: 0.0209s/iter; left time: 801.1411s
	iters: 300, epoch: 19 | loss: 0.0043620
	speed: 0.0192s/iter; left time: 733.8960s
	iters: 400, epoch: 19 | loss: 0.0061369
	speed: 0.0187s/iter; left time: 711.4945s
Epoch: 19 cost time: 9.898361682891846
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0146781
	speed: 0.1010s/iter; left time: 3826.1730s
	iters: 200, epoch: 20 | loss: 0.0254783
	speed: 0.0194s/iter; left time: 734.4109s
	iters: 300, epoch: 20 | loss: 0.0010437
	speed: 0.0204s/iter; left time: 767.0719s
	iters: 400, epoch: 20 | loss: 0.0036763
	speed: 0.0208s/iter; left time: 780.4956s
Epoch: 20 cost time: 9.914597034454346
Epoch: 20, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 255714
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6293347
	speed: 0.0353s/iter; left time: 1653.3936s
	iters: 200, epoch: 1 | loss: 0.6980858
	speed: 0.0193s/iter; left time: 900.8513s
	iters: 300, epoch: 1 | loss: 0.5951327
	speed: 0.0217s/iter; left time: 1011.7620s
	iters: 400, epoch: 1 | loss: 0.2301131
	speed: 0.0182s/iter; left time: 847.9527s
Epoch: 1 cost time: 10.834183692932129
Epoch: 1, Steps: 469 | Train Loss: 0.980 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
Validation loss decreased (inf --> -0.877068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2202176
	speed: 0.1033s/iter; left time: 4784.3457s
	iters: 200, epoch: 2 | loss: 0.1783583
	speed: 0.0212s/iter; left time: 979.9940s
	iters: 300, epoch: 2 | loss: 0.2468847
	speed: 0.0218s/iter; left time: 1007.2655s
	iters: 400, epoch: 2 | loss: 0.2334737
	speed: 0.0226s/iter; left time: 1039.7236s
Epoch: 2 cost time: 10.623057842254639
Epoch: 2, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
Validation loss decreased (-0.877068 --> -0.925097).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0553356
	speed: 0.1226s/iter; left time: 5624.0685s
	iters: 200, epoch: 3 | loss: 0.0693607
	speed: 0.0212s/iter; left time: 967.8955s
	iters: 300, epoch: 3 | loss: 0.0261419
	speed: 0.0207s/iter; left time: 943.0172s
	iters: 400, epoch: 3 | loss: 0.1144250
	speed: 0.0194s/iter; left time: 884.8800s
Epoch: 3 cost time: 10.113959550857544
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.925097 --> -0.951971).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0901781
	speed: 0.1098s/iter; left time: 4983.2052s
	iters: 200, epoch: 4 | loss: 0.1311762
	speed: 0.0193s/iter; left time: 875.5231s
	iters: 300, epoch: 4 | loss: 0.3118360
	speed: 0.0178s/iter; left time: 804.1658s
	iters: 400, epoch: 4 | loss: 0.0284421
	speed: 0.0170s/iter; left time: 765.5068s
Epoch: 4 cost time: 9.139029741287231
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0112223
	speed: 0.0897s/iter; left time: 4030.2184s
	iters: 200, epoch: 5 | loss: 0.0084168
	speed: 0.0193s/iter; left time: 862.9373s
	iters: 300, epoch: 5 | loss: 0.0197398
	speed: 0.0209s/iter; left time: 933.3440s
	iters: 400, epoch: 5 | loss: 0.1372852
	speed: 0.0171s/iter; left time: 765.2541s
Epoch: 5 cost time: 9.15265440940857
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.951971 --> -0.958260).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0085933
	speed: 0.1184s/iter; left time: 5262.3313s
	iters: 200, epoch: 6 | loss: 0.0312371
	speed: 0.0206s/iter; left time: 915.7937s
	iters: 300, epoch: 6 | loss: 0.0059844
	speed: 0.0204s/iter; left time: 900.9044s
	iters: 400, epoch: 6 | loss: 0.0114431
	speed: 0.0194s/iter; left time: 856.5568s
Epoch: 6 cost time: 9.948209762573242
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0014249
	speed: 0.1012s/iter; left time: 4452.9587s
	iters: 200, epoch: 7 | loss: 0.1928273
	speed: 0.0173s/iter; left time: 758.6711s
	iters: 300, epoch: 7 | loss: 0.0077310
	speed: 0.0148s/iter; left time: 648.2128s
	iters: 400, epoch: 7 | loss: 0.0104558
	speed: 0.0157s/iter; left time: 686.0360s
Epoch: 7 cost time: 8.097381830215454
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.958260 --> -0.972841).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0045935
	speed: 0.0828s/iter; left time: 3601.2847s
	iters: 200, epoch: 8 | loss: 0.0018487
	speed: 0.0189s/iter; left time: 821.6862s
	iters: 300, epoch: 8 | loss: 0.0263515
	speed: 0.0170s/iter; left time: 738.0769s
	iters: 400, epoch: 8 | loss: 0.0249367
	speed: 0.0179s/iter; left time: 772.3673s
Epoch: 8 cost time: 8.83987545967102
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.973698).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0010846
	speed: 0.0901s/iter; left time: 3876.6362s
	iters: 200, epoch: 9 | loss: 0.0028095
	speed: 0.0185s/iter; left time: 793.6065s
	iters: 300, epoch: 9 | loss: 0.0027683
	speed: 0.0193s/iter; left time: 826.2898s
	iters: 400, epoch: 9 | loss: 0.0311224
	speed: 0.0220s/iter; left time: 940.1255s
Epoch: 9 cost time: 9.972719430923462
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0010461
	speed: 0.1245s/iter; left time: 5301.7528s
	iters: 200, epoch: 10 | loss: 0.0057525
	speed: 0.0196s/iter; left time: 833.4872s
	iters: 300, epoch: 10 | loss: 0.0238355
	speed: 0.0192s/iter; left time: 812.8038s
	iters: 400, epoch: 10 | loss: 0.0118518
	speed: 0.0201s/iter; left time: 850.2150s
Epoch: 10 cost time: 9.75219178199768
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.954 Test Loss: 0.209 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0283871
	speed: 0.0904s/iter; left time: 3806.9924s
	iters: 200, epoch: 11 | loss: 0.0012295
	speed: 0.0208s/iter; left time: 874.8397s
	iters: 300, epoch: 11 | loss: 0.0045734
	speed: 0.0207s/iter; left time: 869.2395s
	iters: 400, epoch: 11 | loss: 0.0915047
	speed: 0.0193s/iter; left time: 807.3962s
Epoch: 11 cost time: 9.632710218429565
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0011113
	speed: 0.1031s/iter; left time: 4291.3412s
	iters: 200, epoch: 12 | loss: 0.0011839
	speed: 0.0178s/iter; left time: 738.9765s
	iters: 300, epoch: 12 | loss: 0.0036964
	speed: 0.0171s/iter; left time: 708.4315s
	iters: 400, epoch: 12 | loss: 0.0057166
	speed: 0.0185s/iter; left time: 764.3304s
Epoch: 12 cost time: 8.859318733215332
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0126439
	speed: 0.1191s/iter; left time: 4902.8579s
	iters: 200, epoch: 13 | loss: 0.2946036
	speed: 0.0205s/iter; left time: 840.8640s
	iters: 300, epoch: 13 | loss: 0.0894011
	speed: 0.0177s/iter; left time: 725.2125s
	iters: 400, epoch: 13 | loss: 0.0124900
	speed: 0.0180s/iter; left time: 737.3859s
Epoch: 13 cost time: 9.336044073104858
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0557480
	speed: 0.0852s/iter; left time: 3468.2015s
	iters: 200, epoch: 14 | loss: 0.0024835
	speed: 0.0208s/iter; left time: 845.0105s
	iters: 300, epoch: 14 | loss: 0.0466983
	speed: 0.0223s/iter; left time: 903.8099s
	iters: 400, epoch: 14 | loss: 0.0111674
	speed: 0.0217s/iter; left time: 878.7606s
Epoch: 14 cost time: 9.945592403411865
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0058591
	speed: 0.0998s/iter; left time: 4016.2017s
	iters: 200, epoch: 15 | loss: 0.3925324
	speed: 0.0221s/iter; left time: 887.0432s
	iters: 300, epoch: 15 | loss: 0.0160052
	speed: 0.0248s/iter; left time: 994.7079s
	iters: 400, epoch: 15 | loss: 0.0033753
	speed: 0.0233s/iter; left time: 931.8706s
Epoch: 15 cost time: 11.038174152374268
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0019476
	speed: 0.1109s/iter; left time: 4411.2811s
	iters: 200, epoch: 16 | loss: 0.2607859
	speed: 0.0187s/iter; left time: 739.7845s
	iters: 300, epoch: 16 | loss: 0.0059484
	speed: 0.0192s/iter; left time: 761.1405s
	iters: 400, epoch: 16 | loss: 0.0239339
	speed: 0.0191s/iter; left time: 752.1846s
Epoch: 16 cost time: 9.33475923538208
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.201 Vali Acc: 0.954 Test Loss: 0.201 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0021808
	speed: 0.1172s/iter; left time: 4606.4957s
	iters: 200, epoch: 17 | loss: 0.0758823
	speed: 0.0238s/iter; left time: 931.0175s
	iters: 300, epoch: 17 | loss: 0.3905073
	speed: 0.0230s/iter; left time: 900.3337s
	iters: 400, epoch: 17 | loss: 0.0014885
	speed: 0.0239s/iter; left time: 933.6597s
Epoch: 17 cost time: 11.61286449432373
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0066101
	speed: 0.1437s/iter; left time: 5580.7974s
	iters: 200, epoch: 18 | loss: 0.0045691
	speed: 0.0246s/iter; left time: 952.3133s
	iters: 300, epoch: 18 | loss: 0.0035268
	speed: 0.0268s/iter; left time: 1035.8422s
	iters: 400, epoch: 18 | loss: 0.0005842
	speed: 0.0282s/iter; left time: 1086.4760s
Epoch: 18 cost time: 13.045074939727783
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9736992567181246
model parameter : 255650
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5699961
	speed: 0.0355s/iter; left time: 1662.9414s
	iters: 200, epoch: 1 | loss: 0.9317425
	speed: 0.0212s/iter; left time: 992.0570s
	iters: 300, epoch: 1 | loss: 0.4363052
	speed: 0.0198s/iter; left time: 923.6102s
	iters: 400, epoch: 1 | loss: 0.4516179
	speed: 0.0197s/iter; left time: 913.7452s
Epoch: 1 cost time: 11.05788254737854
Epoch: 1, Steps: 469 | Train Loss: 0.998 Vali Loss: 0.427 Vali Acc: 0.869 Test Loss: 0.427 Test Acc: 0.869
Validation loss decreased (inf --> -0.868778).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3143825
	speed: 0.1169s/iter; left time: 5415.0624s
	iters: 200, epoch: 2 | loss: 0.1147503
	speed: 0.0280s/iter; left time: 1292.5234s
	iters: 300, epoch: 2 | loss: 0.1275446
	speed: 0.0249s/iter; left time: 1146.7145s
	iters: 400, epoch: 2 | loss: 0.1083576
	speed: 0.0208s/iter; left time: 959.2164s
Epoch: 2 cost time: 11.931681871414185
Epoch: 2, Steps: 469 | Train Loss: 0.206 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
Validation loss decreased (-0.868778 --> -0.927957).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1844073
	speed: 0.0911s/iter; left time: 4177.6470s
	iters: 200, epoch: 3 | loss: 0.0463568
	speed: 0.0197s/iter; left time: 899.8791s
	iters: 300, epoch: 3 | loss: 0.0474762
	speed: 0.0199s/iter; left time: 906.8250s
	iters: 400, epoch: 3 | loss: 0.1322743
	speed: 0.0204s/iter; left time: 928.5770s
Epoch: 3 cost time: 9.661662578582764
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
Validation loss decreased (-0.927957 --> -0.945967).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1027882
	speed: 0.0977s/iter; left time: 4436.3102s
	iters: 200, epoch: 4 | loss: 0.0206072
	speed: 0.0217s/iter; left time: 981.8345s
	iters: 300, epoch: 4 | loss: 0.0226555
	speed: 0.0233s/iter; left time: 1050.8097s
	iters: 400, epoch: 4 | loss: 0.0186061
	speed: 0.0231s/iter; left time: 1043.8888s
Epoch: 4 cost time: 10.6542649269104
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.945967 --> -0.951685).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0794801
	speed: 0.1070s/iter; left time: 4805.2532s
	iters: 200, epoch: 5 | loss: 0.1412285
	speed: 0.0237s/iter; left time: 1062.8733s
	iters: 300, epoch: 5 | loss: 0.0734388
	speed: 0.0240s/iter; left time: 1073.8482s
	iters: 400, epoch: 5 | loss: 0.0425216
	speed: 0.0211s/iter; left time: 939.7808s
Epoch: 5 cost time: 11.033018350601196
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.951685 --> -0.963406).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0668892
	speed: 0.0942s/iter; left time: 4185.7816s
	iters: 200, epoch: 6 | loss: 0.1523892
	speed: 0.0198s/iter; left time: 880.2206s
	iters: 300, epoch: 6 | loss: 0.0038305
	speed: 0.0209s/iter; left time: 925.9041s
	iters: 400, epoch: 6 | loss: 0.0123621
	speed: 0.0221s/iter; left time: 973.9816s
Epoch: 6 cost time: 10.07486867904663
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0076142
	speed: 0.1261s/iter; left time: 5546.8375s
	iters: 200, epoch: 7 | loss: 0.0668471
	speed: 0.0227s/iter; left time: 994.3634s
	iters: 300, epoch: 7 | loss: 0.0451891
	speed: 0.0221s/iter; left time: 966.9087s
	iters: 400, epoch: 7 | loss: 0.0814748
	speed: 0.0240s/iter; left time: 1046.6948s
Epoch: 7 cost time: 11.147722005844116
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0066129
	speed: 0.1456s/iter; left time: 6334.4492s
	iters: 200, epoch: 8 | loss: 0.0874483
	speed: 0.0291s/iter; left time: 1263.1340s
	iters: 300, epoch: 8 | loss: 0.0017914
	speed: 0.0249s/iter; left time: 1076.8115s
	iters: 400, epoch: 8 | loss: 0.3764423
	speed: 0.0265s/iter; left time: 1143.3433s
Epoch: 8 cost time: 13.16105031967163
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.516 Vali Acc: 0.898 Test Loss: 0.516 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0059782
	speed: 0.1236s/iter; left time: 5320.5000s
	iters: 200, epoch: 9 | loss: 0.0051801
	speed: 0.0258s/iter; left time: 1106.2952s
	iters: 300, epoch: 9 | loss: 0.4113314
	speed: 0.0252s/iter; left time: 1079.4943s
	iters: 400, epoch: 9 | loss: 0.0054343
	speed: 0.0209s/iter; left time: 892.4316s
Epoch: 9 cost time: 11.794119358062744
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0061360
	speed: 0.1019s/iter; left time: 4339.8976s
	iters: 200, epoch: 10 | loss: 0.0008320
	speed: 0.0212s/iter; left time: 899.5966s
	iters: 300, epoch: 10 | loss: 0.0050915
	speed: 0.0234s/iter; left time: 991.1090s
	iters: 400, epoch: 10 | loss: 0.0020635
	speed: 0.0248s/iter; left time: 1046.6668s
Epoch: 10 cost time: 11.098254203796387
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
Validation loss decreased (-0.963406 --> -0.965693).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0169896
	speed: 0.1304s/iter; left time: 5492.3297s
	iters: 200, epoch: 11 | loss: 0.0441622
	speed: 0.0204s/iter; left time: 857.9293s
	iters: 300, epoch: 11 | loss: 0.0336843
	speed: 0.0216s/iter; left time: 905.3215s
	iters: 400, epoch: 11 | loss: 0.0022557
	speed: 0.0201s/iter; left time: 838.9305s
Epoch: 11 cost time: 10.043596267700195
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0076264
	speed: 0.0949s/iter; left time: 3949.8338s
	iters: 200, epoch: 12 | loss: 0.0015582
	speed: 0.0187s/iter; left time: 775.9256s
	iters: 300, epoch: 12 | loss: 0.0316358
	speed: 0.0189s/iter; left time: 783.5370s
	iters: 400, epoch: 12 | loss: 0.0135830
	speed: 0.0174s/iter; left time: 718.3630s
Epoch: 12 cost time: 9.026406526565552
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0043346
	speed: 0.0851s/iter; left time: 3504.8875s
	iters: 200, epoch: 13 | loss: 0.0011623
	speed: 0.0189s/iter; left time: 775.0279s
	iters: 300, epoch: 13 | loss: 0.2159098
	speed: 0.0192s/iter; left time: 786.9842s
	iters: 400, epoch: 13 | loss: 0.0623668
	speed: 0.0211s/iter; left time: 861.7912s
Epoch: 13 cost time: 9.843969821929932
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0229199
	speed: 0.1163s/iter; left time: 4732.0693s
	iters: 200, epoch: 14 | loss: 0.0266808
	speed: 0.0177s/iter; left time: 717.5235s
	iters: 300, epoch: 14 | loss: 0.0005997
	speed: 0.0179s/iter; left time: 723.1473s
	iters: 400, epoch: 14 | loss: 0.0876014
	speed: 0.0191s/iter; left time: 770.8256s
Epoch: 14 cost time: 9.391671657562256
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0005480
	speed: 0.1041s/iter; left time: 4190.1697s
	iters: 200, epoch: 15 | loss: 0.1021039
	speed: 0.0215s/iter; left time: 862.1842s
	iters: 300, epoch: 15 | loss: 0.0017756
	speed: 0.0180s/iter; left time: 722.0245s
	iters: 400, epoch: 15 | loss: 0.0005110
	speed: 0.0182s/iter; left time: 726.1646s
Epoch: 15 cost time: 9.669445037841797
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0040101
	speed: 0.1020s/iter; left time: 4054.8443s
	iters: 200, epoch: 16 | loss: 0.0092074
	speed: 0.0242s/iter; left time: 960.0147s
	iters: 300, epoch: 16 | loss: 0.0050708
	speed: 0.0225s/iter; left time: 892.0984s
	iters: 400, epoch: 16 | loss: 0.0015279
	speed: 0.0218s/iter; left time: 859.1374s
Epoch: 16 cost time: 10.792925834655762
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0061194
	speed: 0.1089s/iter; left time: 4279.8256s
	iters: 200, epoch: 17 | loss: 0.0777580
	speed: 0.0182s/iter; left time: 712.7444s
	iters: 300, epoch: 17 | loss: 0.0008174
	speed: 0.0184s/iter; left time: 719.5239s
	iters: 400, epoch: 17 | loss: 0.0120816
	speed: 0.0191s/iter; left time: 743.4830s
Epoch: 17 cost time: 9.199170351028442
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0040738
	speed: 0.0957s/iter; left time: 3714.8164s
	iters: 200, epoch: 18 | loss: 0.1061792
	speed: 0.0184s/iter; left time: 711.2579s
	iters: 300, epoch: 18 | loss: 0.0142578
	speed: 0.0195s/iter; left time: 752.2666s
	iters: 400, epoch: 18 | loss: 0.0021555
	speed: 0.0209s/iter; left time: 805.6541s
Epoch: 18 cost time: 9.540468215942383
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0055878
	speed: 0.1157s/iter; left time: 4437.2157s
	iters: 200, epoch: 19 | loss: 0.0007331
	speed: 0.0220s/iter; left time: 840.9896s
	iters: 300, epoch: 19 | loss: 0.0039731
	speed: 0.0214s/iter; left time: 816.5510s
	iters: 400, epoch: 19 | loss: 0.1190789
	speed: 0.0190s/iter; left time: 723.4645s
Epoch: 19 cost time: 10.295506715774536
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
Validation loss decreased (-0.965693 --> -0.966265).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0034097
	speed: 0.1063s/iter; left time: 4028.5504s
	iters: 200, epoch: 20 | loss: 0.0014851
	speed: 0.0216s/iter; left time: 814.8240s
	iters: 300, epoch: 20 | loss: 0.0011161
	speed: 0.0192s/iter; left time: 723.9799s
	iters: 400, epoch: 20 | loss: 0.0337993
	speed: 0.0187s/iter; left time: 703.3357s
Epoch: 20 cost time: 9.636207342147827
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.966837).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0024264
	speed: 0.0890s/iter; left time: 3331.5742s
	iters: 200, epoch: 21 | loss: 0.1058530
	speed: 0.0159s/iter; left time: 591.7595s
	iters: 300, epoch: 21 | loss: 0.0034545
	speed: 0.0161s/iter; left time: 598.8217s
	iters: 400, epoch: 21 | loss: 0.0038130
	speed: 0.0165s/iter; left time: 611.0218s
Epoch: 21 cost time: 8.08894157409668
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0091401
	speed: 0.1138s/iter; left time: 4205.5599s
	iters: 200, epoch: 22 | loss: 0.3304263
	speed: 0.0199s/iter; left time: 732.1623s
	iters: 300, epoch: 22 | loss: 0.0032049
	speed: 0.0198s/iter; left time: 726.7580s
	iters: 400, epoch: 22 | loss: 0.0049877
	speed: 0.0196s/iter; left time: 719.0773s
Epoch: 22 cost time: 9.793292045593262
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.190 Vali Acc: 0.966 Test Loss: 0.190 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0016651
	speed: 0.1101s/iter; left time: 4015.7830s
	iters: 200, epoch: 23 | loss: 0.0035632
	speed: 0.0210s/iter; left time: 762.6065s
	iters: 300, epoch: 23 | loss: 0.0794278
	speed: 0.0196s/iter; left time: 711.3475s
	iters: 400, epoch: 23 | loss: 0.0593272
	speed: 0.0201s/iter; left time: 725.6914s
Epoch: 23 cost time: 10.00771975517273
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.264 Vali Acc: 0.951 Test Loss: 0.264 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0031462
	speed: 0.0999s/iter; left time: 3599.1445s
	iters: 200, epoch: 24 | loss: 0.0081140
	speed: 0.0173s/iter; left time: 622.6035s
	iters: 300, epoch: 24 | loss: 0.0158329
	speed: 0.0173s/iter; left time: 620.4944s
	iters: 400, epoch: 24 | loss: 0.0027105
	speed: 0.0158s/iter; left time: 565.1859s
Epoch: 24 cost time: 8.233186483383179
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0006176
	speed: 0.0852s/iter; left time: 3026.7763s
	iters: 200, epoch: 25 | loss: 0.0006310
	speed: 0.0205s/iter; left time: 727.1596s
	iters: 300, epoch: 25 | loss: 0.0071075
	speed: 0.0216s/iter; left time: 762.8137s
	iters: 400, epoch: 25 | loss: 0.0198047
	speed: 0.0218s/iter; left time: 766.7617s
Epoch: 25 cost time: 10.516410112380981
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.966837 --> -0.970554).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1237036
	speed: 0.0904s/iter; left time: 3169.1687s
	iters: 200, epoch: 26 | loss: 0.0027516
	speed: 0.0168s/iter; left time: 588.1288s
	iters: 300, epoch: 26 | loss: 0.0242964
	speed: 0.0182s/iter; left time: 635.1860s
	iters: 400, epoch: 26 | loss: 0.0001705
	speed: 0.0181s/iter; left time: 630.1789s
Epoch: 26 cost time: 8.524714469909668
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0020673
	speed: 0.0916s/iter; left time: 3171.1728s
	iters: 200, epoch: 27 | loss: 0.0386658
	speed: 0.0197s/iter; left time: 678.8662s
	iters: 300, epoch: 27 | loss: 0.0008343
	speed: 0.0193s/iter; left time: 665.6466s
	iters: 400, epoch: 27 | loss: 0.0002305
	speed: 0.0202s/iter; left time: 693.5309s
Epoch: 27 cost time: 9.693435192108154
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0016013
	speed: 0.1012s/iter; left time: 3453.8859s
	iters: 200, epoch: 28 | loss: 0.0006705
	speed: 0.0193s/iter; left time: 656.3093s
	iters: 300, epoch: 28 | loss: 0.0005504
	speed: 0.0200s/iter; left time: 678.6610s
	iters: 400, epoch: 28 | loss: 0.0578035
	speed: 0.0202s/iter; left time: 684.4360s
Epoch: 28 cost time: 9.5986807346344
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0022252
	speed: 0.1018s/iter; left time: 3427.9612s
	iters: 200, epoch: 29 | loss: 0.0002899
	speed: 0.0159s/iter; left time: 535.1276s
	iters: 300, epoch: 29 | loss: 0.0019137
	speed: 0.0165s/iter; left time: 551.7180s
	iters: 400, epoch: 29 | loss: 0.0005819
	speed: 0.0175s/iter; left time: 585.4872s
Epoch: 29 cost time: 8.249048709869385
Epoch: 29, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0068810
	speed: 0.0755s/iter; left time: 2507.6915s
	iters: 200, epoch: 30 | loss: 0.0049874
	speed: 0.0211s/iter; left time: 697.2209s
	iters: 300, epoch: 30 | loss: 0.0005915
	speed: 0.0216s/iter; left time: 713.9549s
	iters: 400, epoch: 30 | loss: 0.0141821
	speed: 0.0203s/iter; left time: 667.9063s
Epoch: 30 cost time: 9.797504901885986
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0016840
	speed: 0.1145s/iter; left time: 3747.8785s
	iters: 200, epoch: 31 | loss: 0.0327276
	speed: 0.0223s/iter; left time: 729.2768s
	iters: 300, epoch: 31 | loss: 0.0039457
	speed: 0.0210s/iter; left time: 683.3639s
	iters: 400, epoch: 31 | loss: 0.0021349
	speed: 0.0219s/iter; left time: 710.8885s
Epoch: 31 cost time: 10.686638355255127
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0019316
	speed: 0.1175s/iter; left time: 3790.0163s
	iters: 200, epoch: 32 | loss: 0.0002719
	speed: 0.0236s/iter; left time: 759.8459s
	iters: 300, epoch: 32 | loss: 0.0004557
	speed: 0.0201s/iter; left time: 643.2088s
	iters: 400, epoch: 32 | loss: 0.0009936
	speed: 0.0183s/iter; left time: 583.7749s
Epoch: 32 cost time: 10.187654733657837
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0049397
	speed: 0.0932s/iter; left time: 2963.5838s
	iters: 200, epoch: 33 | loss: 0.0010000
	speed: 0.0229s/iter; left time: 725.5697s
	iters: 300, epoch: 33 | loss: 0.0266253
	speed: 0.0230s/iter; left time: 726.0061s
	iters: 400, epoch: 33 | loss: 0.0007739
	speed: 0.0224s/iter; left time: 704.4870s
Epoch: 33 cost time: 10.69736361503601
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0180463
	speed: 0.1183s/iter; left time: 3706.7957s
	iters: 200, epoch: 34 | loss: 0.0040834
	speed: 0.0213s/iter; left time: 665.9756s
	iters: 300, epoch: 34 | loss: 0.0006665
	speed: 0.0231s/iter; left time: 720.1172s
	iters: 400, epoch: 34 | loss: 0.0003640
	speed: 0.0221s/iter; left time: 686.7587s
Epoch: 34 cost time: 10.727815628051758
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.970554 --> -0.973698).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0012450
	speed: 0.1395s/iter; left time: 4304.2195s
	iters: 200, epoch: 35 | loss: 0.0002438
	speed: 0.0247s/iter; left time: 760.5983s
	iters: 300, epoch: 35 | loss: 0.0036941
	speed: 0.0206s/iter; left time: 632.7734s
	iters: 400, epoch: 35 | loss: 0.0018093
	speed: 0.0208s/iter; left time: 635.0274s
Epoch: 35 cost time: 11.22250747680664
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0023388
	speed: 0.1232s/iter; left time: 3743.1683s
	iters: 200, epoch: 36 | loss: 0.0088533
	speed: 0.0215s/iter; left time: 650.0483s
	iters: 300, epoch: 36 | loss: 0.0003215
	speed: 0.0183s/iter; left time: 552.0381s
	iters: 400, epoch: 36 | loss: 0.0002867
	speed: 0.0181s/iter; left time: 543.1857s
Epoch: 36 cost time: 9.42680835723877
Epoch: 36, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.961 Test Loss: 0.197 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0007833
	speed: 0.0863s/iter; left time: 2580.7107s
	iters: 200, epoch: 37 | loss: 0.0016834
	speed: 0.0244s/iter; left time: 728.6449s
	iters: 300, epoch: 37 | loss: 0.0063859
	speed: 0.0247s/iter; left time: 733.4897s
	iters: 400, epoch: 37 | loss: 0.0007362
	speed: 0.0213s/iter; left time: 630.2308s
Epoch: 37 cost time: 11.214493751525879
Epoch: 37, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0009318
	speed: 0.1107s/iter; left time: 3258.8131s
	iters: 200, epoch: 38 | loss: 0.0009887
	speed: 0.0208s/iter; left time: 608.9881s
	iters: 300, epoch: 38 | loss: 0.0025952
	speed: 0.0204s/iter; left time: 598.0958s
	iters: 400, epoch: 38 | loss: 0.0014774
	speed: 0.0246s/iter; left time: 717.1806s
Epoch: 38 cost time: 10.61750602722168
Epoch: 38, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0002901
	speed: 0.1142s/iter; left time: 3310.3451s
	iters: 200, epoch: 39 | loss: 0.0012682
	speed: 0.0175s/iter; left time: 506.8086s
	iters: 300, epoch: 39 | loss: 0.0480415
	speed: 0.0175s/iter; left time: 503.8038s
	iters: 400, epoch: 39 | loss: 0.0000832
	speed: 0.0181s/iter; left time: 518.1380s
Epoch: 39 cost time: 9.136754274368286
Epoch: 39, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0837029
	speed: 0.0824s/iter; left time: 2349.3101s
	iters: 200, epoch: 40 | loss: 0.4806704
	speed: 0.0265s/iter; left time: 753.6873s
	iters: 300, epoch: 40 | loss: 0.0149670
	speed: 0.0283s/iter; left time: 802.3299s
	iters: 400, epoch: 40 | loss: 0.0005403
	speed: 0.0252s/iter; left time: 710.5419s
Epoch: 40 cost time: 12.492040157318115
Epoch: 40, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0001180
	speed: 0.1369s/iter; left time: 3839.1796s
	iters: 200, epoch: 41 | loss: 0.0003896
	speed: 0.0233s/iter; left time: 650.2850s
	iters: 300, epoch: 41 | loss: 0.0315348
	speed: 0.0214s/iter; left time: 594.5856s
	iters: 400, epoch: 41 | loss: 0.0004841
	speed: 0.0235s/iter; left time: 652.2636s
Epoch: 41 cost time: 11.213497638702393
Epoch: 41, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0002783
	speed: 0.1167s/iter; left time: 3218.8652s
	iters: 200, epoch: 42 | loss: 0.0002185
	speed: 0.0224s/iter; left time: 614.4080s
	iters: 300, epoch: 42 | loss: 0.0000829
	speed: 0.0204s/iter; left time: 557.0361s
	iters: 400, epoch: 42 | loss: 0.0040133
	speed: 0.0185s/iter; left time: 503.2761s
Epoch: 42 cost time: 10.26605749130249
Epoch: 42, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0011926
	speed: 0.0899s/iter; left time: 2435.6800s
	iters: 200, epoch: 43 | loss: 0.0006580
	speed: 0.0222s/iter; left time: 599.2308s
	iters: 300, epoch: 43 | loss: 0.0002312
	speed: 0.0220s/iter; left time: 590.9109s
	iters: 400, epoch: 43 | loss: 0.0005499
	speed: 0.0218s/iter; left time: 583.8900s
Epoch: 43 cost time: 10.594529628753662
Epoch: 43, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975413).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0001946
	speed: 0.1056s/iter; left time: 2812.6429s
	iters: 200, epoch: 44 | loss: 0.0004043
	speed: 0.0211s/iter; left time: 559.4502s
	iters: 300, epoch: 44 | loss: 0.0002779
	speed: 0.0211s/iter; left time: 556.8251s
	iters: 400, epoch: 44 | loss: 0.0185139
	speed: 0.0224s/iter; left time: 589.7162s
Epoch: 44 cost time: 10.384068965911865
Epoch: 44, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.0008441
	speed: 0.1309s/iter; left time: 3424.7904s
	iters: 200, epoch: 45 | loss: 0.0131647
	speed: 0.0222s/iter; left time: 579.2038s
	iters: 300, epoch: 45 | loss: 0.0134227
	speed: 0.0214s/iter; left time: 556.2839s
	iters: 400, epoch: 45 | loss: 0.0070058
	speed: 0.0204s/iter; left time: 528.3823s
Epoch: 45 cost time: 10.389273405075073
Epoch: 45, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0025421
	speed: 0.0921s/iter; left time: 2367.6828s
	iters: 200, epoch: 46 | loss: 0.0003075
	speed: 0.0199s/iter; left time: 508.2804s
	iters: 300, epoch: 46 | loss: 0.0005815
	speed: 0.0210s/iter; left time: 534.2874s
	iters: 400, epoch: 46 | loss: 0.0003539
	speed: 0.0220s/iter; left time: 559.3751s
Epoch: 46 cost time: 10.147473335266113
Epoch: 46, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.0003569
	speed: 0.1162s/iter; left time: 2930.7512s
	iters: 200, epoch: 47 | loss: 0.0003859
	speed: 0.0208s/iter; left time: 523.3349s
	iters: 300, epoch: 47 | loss: 0.0008112
	speed: 0.0234s/iter; left time: 584.8039s
	iters: 400, epoch: 47 | loss: 0.0000404
	speed: 0.0275s/iter; left time: 684.5056s
Epoch: 47 cost time: 11.477951288223267
Epoch: 47, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.0001715
	speed: 0.1203s/iter; left time: 2977.6325s
	iters: 200, epoch: 48 | loss: 0.0012267
	speed: 0.0202s/iter; left time: 498.2253s
	iters: 300, epoch: 48 | loss: 0.0006477
	speed: 0.0221s/iter; left time: 542.1297s
	iters: 400, epoch: 48 | loss: 0.0003515
	speed: 0.0215s/iter; left time: 525.7793s
Epoch: 48 cost time: 10.379750490188599
Epoch: 48, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.975413 --> -0.978272).  Saving model ...
	iters: 100, epoch: 49 | loss: 0.0007422
	speed: 0.1081s/iter; left time: 2626.3059s
	iters: 200, epoch: 49 | loss: 0.0000368
	speed: 0.0183s/iter; left time: 443.4145s
	iters: 300, epoch: 49 | loss: 0.0049552
	speed: 0.0189s/iter; left time: 454.8595s
	iters: 400, epoch: 49 | loss: 0.0114497
	speed: 0.0221s/iter; left time: 529.7707s
Epoch: 49 cost time: 9.96315860748291
Epoch: 49, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 0.0000284
	speed: 0.1116s/iter; left time: 2658.7971s
	iters: 200, epoch: 50 | loss: 0.0012542
	speed: 0.0208s/iter; left time: 492.4337s
	iters: 300, epoch: 50 | loss: 0.0000250
	speed: 0.0214s/iter; left time: 505.2144s
	iters: 400, epoch: 50 | loss: 0.0001169
	speed: 0.0206s/iter; left time: 485.6199s
Epoch: 50 cost time: 10.348731279373169
Epoch: 50, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 51 | loss: 0.0014272
	speed: 0.1093s/iter; left time: 2553.4068s
	iters: 200, epoch: 51 | loss: 0.0027789
	speed: 0.0194s/iter; left time: 450.1044s
	iters: 300, epoch: 51 | loss: 0.0042347
	speed: 0.0185s/iter; left time: 429.4197s
	iters: 400, epoch: 51 | loss: 0.0012217
	speed: 0.0169s/iter; left time: 390.5523s
Epoch: 51 cost time: 8.981513261795044
Epoch: 51, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 52 | loss: 0.0000268
	speed: 0.0807s/iter; left time: 1845.5801s
	iters: 200, epoch: 52 | loss: 0.0013492
	speed: 0.0173s/iter; left time: 393.6962s
	iters: 300, epoch: 52 | loss: 0.0028657
	speed: 0.0166s/iter; left time: 375.4960s
	iters: 400, epoch: 52 | loss: 0.0053588
	speed: 0.0168s/iter; left time: 380.0073s
Epoch: 52 cost time: 8.323827266693115
Epoch: 52, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 53 | loss: 0.0049625
	speed: 0.0881s/iter; left time: 1974.5868s
	iters: 200, epoch: 53 | loss: 0.0020967
	speed: 0.0196s/iter; left time: 438.2260s
	iters: 300, epoch: 53 | loss: 0.0024501
	speed: 0.0196s/iter; left time: 434.4969s
	iters: 400, epoch: 53 | loss: 0.0007044
	speed: 0.0218s/iter; left time: 481.8938s
Epoch: 53 cost time: 10.055102109909058
Epoch: 53, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 54 | loss: 0.0000179
	speed: 0.1005s/iter; left time: 2205.3622s
	iters: 200, epoch: 54 | loss: 0.0000201
	speed: 0.0207s/iter; left time: 451.9360s
	iters: 300, epoch: 54 | loss: 0.0004821
	speed: 0.0201s/iter; left time: 437.2269s
	iters: 400, epoch: 54 | loss: 0.0002117
	speed: 0.0204s/iter; left time: 440.5919s
Epoch: 54 cost time: 9.935783624649048
Epoch: 54, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 55 | loss: 0.3599525
	speed: 0.0947s/iter; left time: 2033.3440s
	iters: 200, epoch: 55 | loss: 0.0000245
	speed: 0.0181s/iter; left time: 387.6817s
	iters: 300, epoch: 55 | loss: 0.0001273
	speed: 0.0186s/iter; left time: 396.2220s
	iters: 400, epoch: 55 | loss: 0.0109465
	speed: 0.0197s/iter; left time: 417.1582s
Epoch: 55 cost time: 9.107036590576172
Epoch: 55, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 56 | loss: 0.0315794
	speed: 0.1178s/iter; left time: 2474.3797s
	iters: 200, epoch: 56 | loss: 0.0085182
	speed: 0.0187s/iter; left time: 391.3639s
	iters: 300, epoch: 56 | loss: 0.0005210
	speed: 0.0193s/iter; left time: 402.0933s
	iters: 400, epoch: 56 | loss: 0.0047208
	speed: 0.0214s/iter; left time: 444.0743s
Epoch: 56 cost time: 9.854703426361084
Epoch: 56, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.266 Vali Acc: 0.959 Test Loss: 0.266 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 57 | loss: 0.0003602
	speed: 0.1220s/iter; left time: 2504.6586s
	iters: 200, epoch: 57 | loss: 0.0576205
	speed: 0.0201s/iter; left time: 410.2668s
	iters: 300, epoch: 57 | loss: 0.0277252
	speed: 0.0206s/iter; left time: 419.7242s
	iters: 400, epoch: 57 | loss: 0.0001587
	speed: 0.0202s/iter; left time: 409.2692s
Epoch: 57 cost time: 10.009390830993652
Epoch: 57, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 58 | loss: 0.0044917
	speed: 0.1276s/iter; left time: 2560.9334s
	iters: 200, epoch: 58 | loss: 0.0004999
	speed: 0.0237s/iter; left time: 473.4187s
	iters: 300, epoch: 58 | loss: 0.0247587
	speed: 0.0234s/iter; left time: 465.5148s
	iters: 400, epoch: 58 | loss: 0.0007653
	speed: 0.0235s/iter; left time: 464.8214s
Epoch: 58 cost time: 11.697171449661255
Epoch: 58, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 255586
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8918349
	speed: 0.0362s/iter; left time: 1694.3136s
	iters: 200, epoch: 1 | loss: 0.9792746
	speed: 0.0206s/iter; left time: 961.4666s
	iters: 300, epoch: 1 | loss: 0.7438841
	speed: 0.0213s/iter; left time: 992.1227s
	iters: 400, epoch: 1 | loss: 0.2428070
	speed: 0.0192s/iter; left time: 890.5948s
Epoch: 1 cost time: 11.230479955673218
Epoch: 1, Steps: 469 | Train Loss: 1.051 Vali Loss: 0.399 Vali Acc: 0.876 Test Loss: 0.399 Test Acc: 0.876
Validation loss decreased (inf --> -0.875639).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1032333
	speed: 0.1026s/iter; left time: 4753.3907s
	iters: 200, epoch: 2 | loss: 0.2314842
	speed: 0.0215s/iter; left time: 994.6380s
	iters: 300, epoch: 2 | loss: 0.1133881
	speed: 0.0230s/iter; left time: 1062.3535s
	iters: 400, epoch: 2 | loss: 0.0436814
	speed: 0.0198s/iter; left time: 913.1682s
Epoch: 2 cost time: 10.222981691360474
Epoch: 2, Steps: 469 | Train Loss: 0.212 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
Validation loss decreased (-0.875639 --> -0.947111).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2575042
	speed: 0.0870s/iter; left time: 3990.7378s
	iters: 200, epoch: 3 | loss: 0.0688991
	speed: 0.0195s/iter; left time: 890.2011s
	iters: 300, epoch: 3 | loss: 0.7122321
	speed: 0.0177s/iter; left time: 809.6288s
	iters: 400, epoch: 3 | loss: 0.0225570
	speed: 0.0168s/iter; left time: 767.0299s
Epoch: 3 cost time: 8.887786149978638
Epoch: 3, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.170 Vali Acc: 0.945 Test Loss: 0.170 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0418342
	speed: 0.0974s/iter; left time: 4419.1146s
	iters: 200, epoch: 4 | loss: 0.0251435
	speed: 0.0194s/iter; left time: 877.9130s
	iters: 300, epoch: 4 | loss: 0.0187746
	speed: 0.0195s/iter; left time: 880.5126s
	iters: 400, epoch: 4 | loss: 0.2413985
	speed: 0.0199s/iter; left time: 896.8326s
Epoch: 4 cost time: 9.614568710327148
Epoch: 4, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
Validation loss decreased (-0.947111 --> -0.955116).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0382483
	speed: 0.1054s/iter; left time: 4735.0152s
	iters: 200, epoch: 5 | loss: 0.1971140
	speed: 0.0189s/iter; left time: 846.6145s
	iters: 300, epoch: 5 | loss: 0.2579854
	speed: 0.0198s/iter; left time: 887.4262s
	iters: 400, epoch: 5 | loss: 0.0846675
	speed: 0.0174s/iter; left time: 778.2207s
Epoch: 5 cost time: 9.314491748809814
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
Validation loss decreased (-0.955116 --> -0.965693).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0419963
	speed: 0.0905s/iter; left time: 4025.3346s
	iters: 200, epoch: 6 | loss: 0.0137285
	speed: 0.0173s/iter; left time: 769.4808s
	iters: 300, epoch: 6 | loss: 0.0325101
	speed: 0.0178s/iter; left time: 786.2765s
	iters: 400, epoch: 6 | loss: 0.2824555
	speed: 0.0170s/iter; left time: 749.5286s
Epoch: 6 cost time: 8.424630880355835
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.968838).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0456322
	speed: 0.0874s/iter; left time: 3844.9481s
	iters: 200, epoch: 7 | loss: 0.0276689
	speed: 0.0216s/iter; left time: 949.8100s
	iters: 300, epoch: 7 | loss: 0.0097576
	speed: 0.0218s/iter; left time: 954.5848s
	iters: 400, epoch: 7 | loss: 0.0070886
	speed: 0.0203s/iter; left time: 886.6126s
Epoch: 7 cost time: 10.359202861785889
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0065020
	speed: 0.1272s/iter; left time: 5535.4111s
	iters: 200, epoch: 8 | loss: 0.0030402
	speed: 0.0246s/iter; left time: 1069.3459s
	iters: 300, epoch: 8 | loss: 0.0147412
	speed: 0.0249s/iter; left time: 1080.3460s
	iters: 400, epoch: 8 | loss: 0.0171383
	speed: 0.0249s/iter; left time: 1074.2173s
Epoch: 8 cost time: 12.205718278884888
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0161026
	speed: 0.1293s/iter; left time: 5567.4030s
	iters: 200, epoch: 9 | loss: 0.0056299
	speed: 0.0238s/iter; left time: 1024.3140s
	iters: 300, epoch: 9 | loss: 0.0233642
	speed: 0.0216s/iter; left time: 925.0431s
	iters: 400, epoch: 9 | loss: 0.0166299
	speed: 0.0192s/iter; left time: 819.7727s
Epoch: 9 cost time: 10.282948970794678
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.970839).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0065428
	speed: 0.1050s/iter; left time: 4469.2008s
	iters: 200, epoch: 10 | loss: 0.0082614
	speed: 0.0221s/iter; left time: 936.9445s
	iters: 300, epoch: 10 | loss: 0.0016764
	speed: 0.0237s/iter; left time: 1003.9210s
	iters: 400, epoch: 10 | loss: 0.0461301
	speed: 0.0230s/iter; left time: 973.4664s
Epoch: 10 cost time: 10.918369770050049
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.972841).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0055757
	speed: 0.1326s/iter; left time: 5585.1284s
	iters: 200, epoch: 11 | loss: 0.0388399
	speed: 0.0193s/iter; left time: 809.8504s
	iters: 300, epoch: 11 | loss: 0.0052484
	speed: 0.0193s/iter; left time: 806.9581s
	iters: 400, epoch: 11 | loss: 0.0007036
	speed: 0.0202s/iter; left time: 843.0620s
Epoch: 11 cost time: 9.863950967788696
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0077588
	speed: 0.1214s/iter; left time: 5053.8150s
	iters: 200, epoch: 12 | loss: 0.0382845
	speed: 0.0227s/iter; left time: 944.5304s
	iters: 300, epoch: 12 | loss: 0.0008916
	speed: 0.0206s/iter; left time: 852.2273s
	iters: 400, epoch: 12 | loss: 0.0022861
	speed: 0.0186s/iter; left time: 769.6337s
Epoch: 12 cost time: 10.422343015670776
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0100522
	speed: 0.0877s/iter; left time: 3611.3011s
	iters: 200, epoch: 13 | loss: 0.0435490
	speed: 0.0166s/iter; left time: 683.5060s
	iters: 300, epoch: 13 | loss: 0.0017564
	speed: 0.0172s/iter; left time: 704.1157s
	iters: 400, epoch: 13 | loss: 0.0069044
	speed: 0.0170s/iter; left time: 693.3310s
Epoch: 13 cost time: 8.497408151626587
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0179880
	speed: 0.1002s/iter; left time: 4078.4784s
	iters: 200, epoch: 14 | loss: 0.0051006
	speed: 0.0186s/iter; left time: 755.9564s
	iters: 300, epoch: 14 | loss: 0.0036296
	speed: 0.0189s/iter; left time: 765.0615s
	iters: 400, epoch: 14 | loss: 0.0182346
	speed: 0.0184s/iter; left time: 742.7878s
Epoch: 14 cost time: 9.21389126777649
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0018002
	speed: 0.1141s/iter; left time: 4590.2262s
	iters: 200, epoch: 15 | loss: 0.0037350
	speed: 0.0271s/iter; left time: 1085.7138s
	iters: 300, epoch: 15 | loss: 0.0016605
	speed: 0.0244s/iter; left time: 978.6584s
	iters: 400, epoch: 15 | loss: 0.0059872
	speed: 0.0196s/iter; left time: 782.2247s
Epoch: 15 cost time: 11.21773362159729
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0045320
	speed: 0.1076s/iter; left time: 4280.4957s
	iters: 200, epoch: 16 | loss: 0.0021231
	speed: 0.0201s/iter; left time: 798.5054s
	iters: 300, epoch: 16 | loss: 0.0009596
	speed: 0.0227s/iter; left time: 897.7785s
	iters: 400, epoch: 16 | loss: 0.0015173
	speed: 0.0206s/iter; left time: 813.2249s
Epoch: 16 cost time: 10.47142481803894
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0028724
	speed: 0.1236s/iter; left time: 4855.6445s
	iters: 200, epoch: 17 | loss: 0.0018509
	speed: 0.0303s/iter; left time: 1186.3120s
	iters: 300, epoch: 17 | loss: 0.0111339
	speed: 0.0251s/iter; left time: 982.2532s
	iters: 400, epoch: 17 | loss: 0.0059999
	speed: 0.0212s/iter; left time: 827.8101s
Epoch: 17 cost time: 12.470032691955566
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0011607
	speed: 0.1104s/iter; left time: 4284.7503s
	iters: 200, epoch: 18 | loss: 0.0146950
	speed: 0.0202s/iter; left time: 781.4892s
	iters: 300, epoch: 18 | loss: 0.0024131
	speed: 0.0214s/iter; left time: 827.9314s
	iters: 400, epoch: 18 | loss: 0.0078767
	speed: 0.0226s/iter; left time: 870.5834s
Epoch: 18 cost time: 10.483393907546997
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0025029
	speed: 0.1057s/iter; left time: 4056.2605s
	iters: 200, epoch: 19 | loss: 0.3148197
	speed: 0.0203s/iter; left time: 776.6890s
	iters: 300, epoch: 19 | loss: 0.0282622
	speed: 0.0192s/iter; left time: 731.6812s
	iters: 400, epoch: 19 | loss: 0.0081688
	speed: 0.0173s/iter; left time: 657.8208s
Epoch: 19 cost time: 9.152654647827148
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0180561
	speed: 0.1033s/iter; left time: 3914.6394s
	iters: 200, epoch: 20 | loss: 0.0055911
	speed: 0.0230s/iter; left time: 868.8011s
	iters: 300, epoch: 20 | loss: 0.0019081
	speed: 0.0237s/iter; left time: 892.0662s
	iters: 400, epoch: 20 | loss: 0.0033964
	speed: 0.0207s/iter; left time: 776.6098s
Epoch: 20 cost time: 10.961536407470703
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 253666
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6362780
	speed: 0.0380s/iter; left time: 1777.9155s
	iters: 200, epoch: 1 | loss: 0.9145930
	speed: 0.0193s/iter; left time: 900.8179s
	iters: 300, epoch: 1 | loss: 0.5116861
	speed: 0.0184s/iter; left time: 858.3192s
	iters: 400, epoch: 1 | loss: 0.5888923
	speed: 0.0184s/iter; left time: 853.9670s
Epoch: 1 cost time: 10.746177673339844
Epoch: 1, Steps: 469 | Train Loss: 0.992 Vali Loss: 0.395 Vali Acc: 0.879 Test Loss: 0.395 Test Acc: 0.879
Validation loss decreased (inf --> -0.878498).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4565206
	speed: 0.0850s/iter; left time: 3935.9397s
	iters: 200, epoch: 2 | loss: 0.4458753
	speed: 0.0180s/iter; left time: 830.4751s
	iters: 300, epoch: 2 | loss: 0.2169076
	speed: 0.0220s/iter; left time: 1015.1537s
	iters: 400, epoch: 2 | loss: 0.1056029
	speed: 0.0212s/iter; left time: 974.8919s
Epoch: 2 cost time: 9.63707447052002
Epoch: 2, Steps: 469 | Train Loss: 0.226 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.878498 --> -0.925098).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2745347
	speed: 0.1126s/iter; left time: 5163.0081s
	iters: 200, epoch: 3 | loss: 0.1334023
	speed: 0.0220s/iter; left time: 1006.8754s
	iters: 300, epoch: 3 | loss: 0.2686579
	speed: 0.0219s/iter; left time: 1000.2936s
	iters: 400, epoch: 3 | loss: 0.1631793
	speed: 0.0225s/iter; left time: 1024.7228s
Epoch: 3 cost time: 10.485037088394165
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.925098 --> -0.943680).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0616340
	speed: 0.1214s/iter; left time: 5512.1293s
	iters: 200, epoch: 4 | loss: 0.0427462
	speed: 0.0287s/iter; left time: 1298.4579s
	iters: 300, epoch: 4 | loss: 0.0561446
	speed: 0.0269s/iter; left time: 1217.3454s
	iters: 400, epoch: 4 | loss: 0.0953378
	speed: 0.0225s/iter; left time: 1015.7179s
Epoch: 4 cost time: 12.335044384002686
Epoch: 4, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
Validation loss decreased (-0.943680 --> -0.950255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0714466
	speed: 0.0775s/iter; left time: 3482.5020s
	iters: 200, epoch: 5 | loss: 0.2805912
	speed: 0.0192s/iter; left time: 862.5112s
	iters: 300, epoch: 5 | loss: 0.0654203
	speed: 0.0228s/iter; left time: 1018.7577s
	iters: 400, epoch: 5 | loss: 0.0536125
	speed: 0.0238s/iter; left time: 1060.9451s
Epoch: 5 cost time: 10.093904972076416
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.210 Vali Acc: 0.934 Test Loss: 0.210 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0300798
	speed: 0.1208s/iter; left time: 5369.0505s
	iters: 200, epoch: 6 | loss: 0.0528966
	speed: 0.0208s/iter; left time: 921.6494s
	iters: 300, epoch: 6 | loss: 0.0282889
	speed: 0.0202s/iter; left time: 896.0609s
	iters: 400, epoch: 6 | loss: 0.0141016
	speed: 0.0198s/iter; left time: 872.2413s
Epoch: 6 cost time: 9.990488290786743
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.950255 --> -0.962263).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0099451
	speed: 0.1024s/iter; left time: 4505.3436s
	iters: 200, epoch: 7 | loss: 0.0347071
	speed: 0.0205s/iter; left time: 900.0491s
	iters: 300, epoch: 7 | loss: 0.5707023
	speed: 0.0177s/iter; left time: 775.3572s
	iters: 400, epoch: 7 | loss: 0.0036058
	speed: 0.0191s/iter; left time: 832.6747s
Epoch: 7 cost time: 9.445546627044678
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0796057
	speed: 0.0857s/iter; left time: 3730.5233s
	iters: 200, epoch: 8 | loss: 0.0079910
	speed: 0.0176s/iter; left time: 765.1807s
	iters: 300, epoch: 8 | loss: 0.0050563
	speed: 0.0176s/iter; left time: 764.3407s
	iters: 400, epoch: 8 | loss: 0.0101988
	speed: 0.0188s/iter; left time: 812.1484s
Epoch: 8 cost time: 9.070486545562744
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.962263 --> -0.969696).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0091625
	speed: 0.1295s/iter; left time: 5573.8304s
	iters: 200, epoch: 9 | loss: 0.0268558
	speed: 0.0221s/iter; left time: 947.8932s
	iters: 300, epoch: 9 | loss: 0.0466846
	speed: 0.0202s/iter; left time: 865.8989s
	iters: 400, epoch: 9 | loss: 0.1094330
	speed: 0.0195s/iter; left time: 835.3981s
Epoch: 9 cost time: 10.525051832199097
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0033219
	speed: 0.1179s/iter; left time: 5019.3615s
	iters: 200, epoch: 10 | loss: 0.0013881
	speed: 0.0215s/iter; left time: 912.3722s
	iters: 300, epoch: 10 | loss: 0.0189628
	speed: 0.0201s/iter; left time: 852.1359s
	iters: 400, epoch: 10 | loss: 0.0860455
	speed: 0.0183s/iter; left time: 775.7962s
Epoch: 10 cost time: 9.897893905639648
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.969696 --> -0.976557).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0300887
	speed: 0.0974s/iter; left time: 4101.9426s
	iters: 200, epoch: 11 | loss: 0.0383846
	speed: 0.0225s/iter; left time: 947.2281s
	iters: 300, epoch: 11 | loss: 0.0014967
	speed: 0.0213s/iter; left time: 891.2309s
	iters: 400, epoch: 11 | loss: 0.0021359
	speed: 0.0194s/iter; left time: 810.5117s
Epoch: 11 cost time: 10.418709516525269
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1894440
	speed: 0.1265s/iter; left time: 5268.5785s
	iters: 200, epoch: 12 | loss: 0.0005227
	speed: 0.0285s/iter; left time: 1185.9365s
	iters: 300, epoch: 12 | loss: 0.1290078
	speed: 0.0239s/iter; left time: 989.2452s
	iters: 400, epoch: 12 | loss: 0.0895602
	speed: 0.0228s/iter; left time: 944.1565s
Epoch: 12 cost time: 12.50226879119873
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0170184
	speed: 0.1232s/iter; left time: 5074.4953s
	iters: 200, epoch: 13 | loss: 0.0018188
	speed: 0.0281s/iter; left time: 1155.3482s
	iters: 300, epoch: 13 | loss: 0.1261225
	speed: 0.0263s/iter; left time: 1077.8078s
	iters: 400, epoch: 13 | loss: 0.0095180
	speed: 0.0221s/iter; left time: 904.7232s
Epoch: 13 cost time: 12.210373163223267
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0030396
	speed: 0.1113s/iter; left time: 4529.0174s
	iters: 200, epoch: 14 | loss: 0.0353557
	speed: 0.0201s/iter; left time: 816.2133s
	iters: 300, epoch: 14 | loss: 0.0036657
	speed: 0.0207s/iter; left time: 837.9430s
	iters: 400, epoch: 14 | loss: 0.0037933
	speed: 0.0224s/iter; left time: 904.1424s
Epoch: 14 cost time: 10.722521543502808
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0048870
	speed: 0.1118s/iter; left time: 4499.1768s
	iters: 200, epoch: 15 | loss: 0.0379716
	speed: 0.0208s/iter; left time: 835.0675s
	iters: 300, epoch: 15 | loss: 0.0096281
	speed: 0.0209s/iter; left time: 838.0841s
	iters: 400, epoch: 15 | loss: 0.0026120
	speed: 0.0206s/iter; left time: 822.6254s
Epoch: 15 cost time: 10.243655920028687
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0604144
	speed: 0.1072s/iter; left time: 4264.1804s
	iters: 200, epoch: 16 | loss: 0.1335309
	speed: 0.0199s/iter; left time: 787.4317s
	iters: 300, epoch: 16 | loss: 0.0054911
	speed: 0.0188s/iter; left time: 742.8255s
	iters: 400, epoch: 16 | loss: 0.0017473
	speed: 0.0179s/iter; left time: 705.9366s
Epoch: 16 cost time: 9.437378406524658
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0011716
	speed: 0.0782s/iter; left time: 3072.6171s
	iters: 200, epoch: 17 | loss: 0.2260440
	speed: 0.0191s/iter; left time: 748.7388s
	iters: 300, epoch: 17 | loss: 0.0041700
	speed: 0.0207s/iter; left time: 809.3196s
	iters: 400, epoch: 17 | loss: 0.0099358
	speed: 0.0211s/iter; left time: 821.4098s
Epoch: 17 cost time: 9.754035711288452
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977986).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0025151
	speed: 0.1042s/iter; left time: 4044.2734s
	iters: 200, epoch: 18 | loss: 0.0019382
	speed: 0.0229s/iter; left time: 888.4622s
	iters: 300, epoch: 18 | loss: 0.0033374
	speed: 0.0221s/iter; left time: 855.0837s
	iters: 400, epoch: 18 | loss: 0.0061829
	speed: 0.0246s/iter; left time: 948.7370s
Epoch: 18 cost time: 10.982645750045776
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0005308
	speed: 0.1152s/iter; left time: 4420.4420s
	iters: 200, epoch: 19 | loss: 0.0502076
	speed: 0.0242s/iter; left time: 924.2924s
	iters: 300, epoch: 19 | loss: 0.0054186
	speed: 0.0235s/iter; left time: 895.3670s
	iters: 400, epoch: 19 | loss: 0.0102416
	speed: 0.0214s/iter; left time: 813.4032s
Epoch: 19 cost time: 11.078516006469727
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0042935
	speed: 0.0930s/iter; left time: 3524.0031s
	iters: 200, epoch: 20 | loss: 0.0018624
	speed: 0.0200s/iter; left time: 754.0396s
	iters: 300, epoch: 20 | loss: 0.0011300
	speed: 0.0212s/iter; left time: 797.5912s
	iters: 400, epoch: 20 | loss: 0.0005760
	speed: 0.0218s/iter; left time: 819.5987s
Epoch: 20 cost time: 10.176769733428955
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0421048
	speed: 0.1288s/iter; left time: 4820.6173s
	iters: 200, epoch: 21 | loss: 0.0005467
	speed: 0.0263s/iter; left time: 979.8441s
	iters: 300, epoch: 21 | loss: 0.0045182
	speed: 0.0284s/iter; left time: 1056.2635s
	iters: 400, epoch: 21 | loss: 0.1498691
	speed: 0.0266s/iter; left time: 987.0902s
Epoch: 21 cost time: 13.3484365940094
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0040855
	speed: 0.1424s/iter; left time: 5263.4333s
	iters: 200, epoch: 22 | loss: 0.0091336
	speed: 0.0280s/iter; left time: 1031.7345s
	iters: 300, epoch: 22 | loss: 0.0018152
	speed: 0.0268s/iter; left time: 983.9887s
	iters: 400, epoch: 22 | loss: 0.0018070
	speed: 0.0254s/iter; left time: 930.3321s
Epoch: 22 cost time: 12.4532630443573
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0034397
	speed: 0.1257s/iter; left time: 4587.1250s
	iters: 200, epoch: 23 | loss: 0.0020689
	speed: 0.0186s/iter; left time: 678.2443s
	iters: 300, epoch: 23 | loss: 0.0132028
	speed: 0.0178s/iter; left time: 645.1803s
	iters: 400, epoch: 23 | loss: 0.0004883
	speed: 0.0174s/iter; left time: 628.1497s
Epoch: 23 cost time: 9.139694213867188
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0006755
	speed: 0.0967s/iter; left time: 3482.2828s
	iters: 200, epoch: 24 | loss: 0.0037047
	speed: 0.0253s/iter; left time: 909.5555s
	iters: 300, epoch: 24 | loss: 0.0006511
	speed: 0.0270s/iter; left time: 968.6709s
	iters: 400, epoch: 24 | loss: 0.0494466
	speed: 0.0242s/iter; left time: 862.6483s
Epoch: 24 cost time: 11.8027925491333
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0026739
	speed: 0.1033s/iter; left time: 3671.1999s
	iters: 200, epoch: 25 | loss: 0.0025628
	speed: 0.0208s/iter; left time: 736.3618s
	iters: 300, epoch: 25 | loss: 0.2306208
	speed: 0.0226s/iter; left time: 798.9088s
	iters: 400, epoch: 25 | loss: 0.0005478
	speed: 0.0213s/iter; left time: 751.3961s
Epoch: 25 cost time: 10.374361038208008
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0019601
	speed: 0.1121s/iter; left time: 3931.9739s
	iters: 200, epoch: 26 | loss: 0.0022873
	speed: 0.0170s/iter; left time: 596.0264s
	iters: 300, epoch: 26 | loss: 0.0003818
	speed: 0.0183s/iter; left time: 638.1065s
	iters: 400, epoch: 26 | loss: 0.0183356
	speed: 0.0184s/iter; left time: 640.5782s
Epoch: 26 cost time: 8.838968992233276
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0021167
	speed: 0.0898s/iter; left time: 3106.5473s
	iters: 200, epoch: 27 | loss: 0.0011102
	speed: 0.0245s/iter; left time: 844.1994s
	iters: 300, epoch: 27 | loss: 0.1873211
	speed: 0.0289s/iter; left time: 995.9881s
	iters: 400, epoch: 27 | loss: 0.0010854
	speed: 0.0285s/iter; left time: 979.2367s
Epoch: 27 cost time: 12.694147825241089
Epoch: 27, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 253634
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5650343
	speed: 0.0350s/iter; left time: 1638.6510s
	iters: 200, epoch: 1 | loss: 0.9593254
	speed: 0.0201s/iter; left time: 936.9812s
	iters: 300, epoch: 1 | loss: 0.6821938
	speed: 0.0194s/iter; left time: 902.2985s
	iters: 400, epoch: 1 | loss: 0.4855040
	speed: 0.0197s/iter; left time: 913.7484s
Epoch: 1 cost time: 10.883504629135132
Epoch: 1, Steps: 469 | Train Loss: 1.083 Vali Loss: 0.429 Vali Acc: 0.883 Test Loss: 0.429 Test Acc: 0.883
Validation loss decreased (inf --> -0.882500).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1521163
	speed: 0.0941s/iter; left time: 4359.3891s
	iters: 200, epoch: 2 | loss: 0.1072508
	speed: 0.0172s/iter; left time: 794.3162s
	iters: 300, epoch: 2 | loss: 0.1837962
	speed: 0.0208s/iter; left time: 958.7365s
	iters: 400, epoch: 2 | loss: 0.1578722
	speed: 0.0214s/iter; left time: 987.1465s
Epoch: 2 cost time: 9.530991315841675
Epoch: 2, Steps: 469 | Train Loss: 0.238 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
Validation loss decreased (-0.882500 --> -0.920238).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0485631
	speed: 0.1220s/iter; left time: 5597.5580s
	iters: 200, epoch: 3 | loss: 0.1873219
	speed: 0.0243s/iter; left time: 1113.7155s
	iters: 300, epoch: 3 | loss: 0.0532915
	speed: 0.0219s/iter; left time: 1000.3528s
	iters: 400, epoch: 3 | loss: 0.0283415
	speed: 0.0235s/iter; left time: 1068.5745s
Epoch: 3 cost time: 11.289415836334229
Epoch: 3, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.920238 --> -0.957974).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3930274
	speed: 0.1185s/iter; left time: 5378.5157s
	iters: 200, epoch: 4 | loss: 0.0185691
	speed: 0.0231s/iter; left time: 1046.4601s
	iters: 300, epoch: 4 | loss: 0.0125106
	speed: 0.0214s/iter; left time: 967.6590s
	iters: 400, epoch: 4 | loss: 0.1486681
	speed: 0.0198s/iter; left time: 892.8741s
Epoch: 4 cost time: 10.226460218429565
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0580461
	speed: 0.0761s/iter; left time: 3419.1760s
	iters: 200, epoch: 5 | loss: 0.0432815
	speed: 0.0161s/iter; left time: 721.9533s
	iters: 300, epoch: 5 | loss: 0.0174065
	speed: 0.0177s/iter; left time: 793.2662s
	iters: 400, epoch: 5 | loss: 0.0741757
	speed: 0.0178s/iter; left time: 795.6897s
Epoch: 5 cost time: 8.440322875976562
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.957974 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0292701
	speed: 0.0894s/iter; left time: 3975.2378s
	iters: 200, epoch: 6 | loss: 0.5768368
	speed: 0.0190s/iter; left time: 841.1499s
	iters: 300, epoch: 6 | loss: 0.0862686
	speed: 0.0187s/iter; left time: 829.6083s
	iters: 400, epoch: 6 | loss: 0.0255451
	speed: 0.0191s/iter; left time: 845.3824s
Epoch: 6 cost time: 9.303643703460693
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.970839).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0108195
	speed: 0.1230s/iter; left time: 5408.5299s
	iters: 200, epoch: 7 | loss: 0.0052779
	speed: 0.0238s/iter; left time: 1042.5503s
	iters: 300, epoch: 7 | loss: 0.1558469
	speed: 0.0228s/iter; left time: 997.8385s
	iters: 400, epoch: 7 | loss: 0.1145123
	speed: 0.0202s/iter; left time: 881.6204s
Epoch: 7 cost time: 11.17880654335022
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0245274
	speed: 0.1062s/iter; left time: 4622.6724s
	iters: 200, epoch: 8 | loss: 0.0203051
	speed: 0.0212s/iter; left time: 920.4028s
	iters: 300, epoch: 8 | loss: 0.0082983
	speed: 0.0213s/iter; left time: 923.7544s
	iters: 400, epoch: 8 | loss: 0.0533729
	speed: 0.0217s/iter; left time: 936.1020s
Epoch: 8 cost time: 10.385441303253174
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0521977
	speed: 0.0915s/iter; left time: 3938.3557s
	iters: 200, epoch: 9 | loss: 0.0342136
	speed: 0.0218s/iter; left time: 935.4917s
	iters: 300, epoch: 9 | loss: 0.0252076
	speed: 0.0215s/iter; left time: 920.1540s
	iters: 400, epoch: 9 | loss: 0.0294423
	speed: 0.0219s/iter; left time: 937.4960s
Epoch: 9 cost time: 10.302032709121704
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0085123
	speed: 0.1307s/iter; left time: 5564.3911s
	iters: 200, epoch: 10 | loss: 0.0086926
	speed: 0.0214s/iter; left time: 908.2052s
	iters: 300, epoch: 10 | loss: 0.0030050
	speed: 0.0199s/iter; left time: 843.5109s
	iters: 400, epoch: 10 | loss: 0.0703177
	speed: 0.0204s/iter; left time: 863.4585s
Epoch: 10 cost time: 10.63491153717041
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3043487
	speed: 0.1287s/iter; left time: 5419.0461s
	iters: 200, epoch: 11 | loss: 0.0141363
	speed: 0.0231s/iter; left time: 972.2370s
	iters: 300, epoch: 11 | loss: 0.3411744
	speed: 0.0223s/iter; left time: 932.5809s
	iters: 400, epoch: 11 | loss: 0.0212157
	speed: 0.0200s/iter; left time: 834.3758s
Epoch: 11 cost time: 10.74362063407898
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0083329
	speed: 0.0908s/iter; left time: 3780.8318s
	iters: 200, epoch: 12 | loss: 0.0054352
	speed: 0.0181s/iter; left time: 753.2138s
	iters: 300, epoch: 12 | loss: 0.0029934
	speed: 0.0165s/iter; left time: 685.2367s
	iters: 400, epoch: 12 | loss: 0.0435369
	speed: 0.0173s/iter; left time: 715.5347s
Epoch: 12 cost time: 8.658182859420776
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0004528
	speed: 0.1056s/iter; left time: 4348.3367s
	iters: 200, epoch: 13 | loss: 0.0103608
	speed: 0.0200s/iter; left time: 821.9737s
	iters: 300, epoch: 13 | loss: 0.0136365
	speed: 0.0190s/iter; left time: 779.6078s
	iters: 400, epoch: 13 | loss: 0.0168888
	speed: 0.0187s/iter; left time: 765.6843s
Epoch: 13 cost time: 9.515193223953247
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0012451
	speed: 0.1102s/iter; left time: 4485.7592s
	iters: 200, epoch: 14 | loss: 0.0215717
	speed: 0.0218s/iter; left time: 886.6183s
	iters: 300, epoch: 14 | loss: 0.0068940
	speed: 0.0197s/iter; left time: 795.9339s
	iters: 400, epoch: 14 | loss: 0.1910194
	speed: 0.0185s/iter; left time: 747.9540s
Epoch: 14 cost time: 9.727646589279175
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0045707
	speed: 0.0870s/iter; left time: 3499.0972s
	iters: 200, epoch: 15 | loss: 0.0322704
	speed: 0.0162s/iter; left time: 648.7004s
	iters: 300, epoch: 15 | loss: 0.0018630
	speed: 0.0157s/iter; left time: 628.4341s
	iters: 400, epoch: 15 | loss: 0.0024768
	speed: 0.0167s/iter; left time: 668.3217s
Epoch: 15 cost time: 8.019038915634155
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0027924
	speed: 0.0913s/iter; left time: 3630.6333s
	iters: 200, epoch: 16 | loss: 0.0008282
	speed: 0.0223s/iter; left time: 882.6404s
	iters: 300, epoch: 16 | loss: 0.0012912
	speed: 0.0214s/iter; left time: 847.2081s
	iters: 400, epoch: 16 | loss: 0.0074670
	speed: 0.0221s/iter; left time: 870.5147s
Epoch: 16 cost time: 10.461382865905762
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9708404802744426
model parameter : 253602
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4269375
	speed: 0.0342s/iter; left time: 1601.9803s
	iters: 200, epoch: 1 | loss: 0.8364866
	speed: 0.0202s/iter; left time: 942.7168s
	iters: 300, epoch: 1 | loss: 0.5016840
	speed: 0.0196s/iter; left time: 914.2281s
	iters: 400, epoch: 1 | loss: 0.4632864
	speed: 0.0208s/iter; left time: 968.4094s
Epoch: 1 cost time: 10.896649360656738
Epoch: 1, Steps: 469 | Train Loss: 1.023 Vali Loss: 0.453 Vali Acc: 0.851 Test Loss: 0.453 Test Acc: 0.851
Validation loss decreased (inf --> -0.851339).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2839363
	speed: 0.1045s/iter; left time: 4842.7045s
	iters: 200, epoch: 2 | loss: 0.2723143
	speed: 0.0201s/iter; left time: 929.3627s
	iters: 300, epoch: 2 | loss: 0.3413826
	speed: 0.0207s/iter; left time: 954.7746s
	iters: 400, epoch: 2 | loss: 0.0810850
	speed: 0.0210s/iter; left time: 965.3293s
Epoch: 2 cost time: 10.059558629989624
Epoch: 2, Steps: 469 | Train Loss: 0.253 Vali Loss: 0.232 Vali Acc: 0.927 Test Loss: 0.232 Test Acc: 0.927
Validation loss decreased (-0.851339 --> -0.926813).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2740005
	speed: 0.1211s/iter; left time: 5555.6036s
	iters: 200, epoch: 3 | loss: 0.2509865
	speed: 0.0205s/iter; left time: 938.9478s
	iters: 300, epoch: 3 | loss: 0.0560273
	speed: 0.0231s/iter; left time: 1052.5739s
	iters: 400, epoch: 3 | loss: 0.0952033
	speed: 0.0259s/iter; left time: 1180.9627s
Epoch: 3 cost time: 11.154979467391968
Epoch: 3, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.926813 --> -0.957689).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1021815
	speed: 0.1153s/iter; left time: 5234.1347s
	iters: 200, epoch: 4 | loss: 0.3461227
	speed: 0.0191s/iter; left time: 865.9858s
	iters: 300, epoch: 4 | loss: 0.0869502
	speed: 0.0188s/iter; left time: 851.5186s
	iters: 400, epoch: 4 | loss: 0.0605826
	speed: 0.0198s/iter; left time: 891.9880s
Epoch: 4 cost time: 9.528350830078125
Epoch: 4, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0369227
	speed: 0.0960s/iter; left time: 4314.3797s
	iters: 200, epoch: 5 | loss: 0.1096590
	speed: 0.0187s/iter; left time: 838.0341s
	iters: 300, epoch: 5 | loss: 0.0670938
	speed: 0.0211s/iter; left time: 944.4022s
	iters: 400, epoch: 5 | loss: 0.0226086
	speed: 0.0210s/iter; left time: 938.6854s
Epoch: 5 cost time: 9.471990585327148
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.957689 --> -0.970268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0155470
	speed: 0.0938s/iter; left time: 4168.0574s
	iters: 200, epoch: 6 | loss: 0.0057199
	speed: 0.0163s/iter; left time: 721.3094s
	iters: 300, epoch: 6 | loss: 0.0337257
	speed: 0.0167s/iter; left time: 738.6549s
	iters: 400, epoch: 6 | loss: 0.1693894
	speed: 0.0179s/iter; left time: 790.7532s
Epoch: 6 cost time: 8.495622158050537
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.167 Vali Acc: 0.947 Test Loss: 0.167 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0033308
	speed: 0.0961s/iter; left time: 4226.0924s
	iters: 200, epoch: 7 | loss: 0.0113710
	speed: 0.0197s/iter; left time: 864.2808s
	iters: 300, epoch: 7 | loss: 0.0089260
	speed: 0.0202s/iter; left time: 883.1765s
	iters: 400, epoch: 7 | loss: 0.0032700
	speed: 0.0207s/iter; left time: 902.1942s
Epoch: 7 cost time: 9.742292165756226
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4125428
	speed: 0.1015s/iter; left time: 4417.9027s
	iters: 200, epoch: 8 | loss: 0.0030994
	speed: 0.0251s/iter; left time: 1089.1161s
	iters: 300, epoch: 8 | loss: 0.0015835
	speed: 0.0276s/iter; left time: 1194.9019s
	iters: 400, epoch: 8 | loss: 0.0098526
	speed: 0.0247s/iter; left time: 1066.1816s
Epoch: 8 cost time: 12.299738883972168
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0186303
	speed: 0.0977s/iter; left time: 4205.3397s
	iters: 200, epoch: 9 | loss: 0.0044752
	speed: 0.0216s/iter; left time: 926.3430s
	iters: 300, epoch: 9 | loss: 0.0025805
	speed: 0.0203s/iter; left time: 871.5175s
	iters: 400, epoch: 9 | loss: 0.0085730
	speed: 0.0215s/iter; left time: 918.8142s
Epoch: 9 cost time: 10.237802743911743
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0319827
	speed: 0.1147s/iter; left time: 4885.6090s
	iters: 200, epoch: 10 | loss: 0.4851428
	speed: 0.0244s/iter; left time: 1037.5483s
	iters: 300, epoch: 10 | loss: 0.0016507
	speed: 0.0230s/iter; left time: 975.9470s
	iters: 400, epoch: 10 | loss: 0.0089919
	speed: 0.0266s/iter; left time: 1123.6587s
Epoch: 10 cost time: 11.73947787284851
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0418299
	speed: 0.1373s/iter; left time: 5782.8861s
	iters: 200, epoch: 11 | loss: 0.0056769
	speed: 0.0286s/iter; left time: 1200.0421s
	iters: 300, epoch: 11 | loss: 0.0335143
	speed: 0.0227s/iter; left time: 951.5375s
	iters: 400, epoch: 11 | loss: 0.2908458
	speed: 0.0235s/iter; left time: 982.3112s
Epoch: 11 cost time: 11.923183679580688
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0018742
	speed: 0.0982s/iter; left time: 4089.2675s
	iters: 200, epoch: 12 | loss: 0.0682981
	speed: 0.0202s/iter; left time: 841.0850s
	iters: 300, epoch: 12 | loss: 0.0009525
	speed: 0.0189s/iter; left time: 781.3676s
	iters: 400, epoch: 12 | loss: 0.0045818
	speed: 0.0178s/iter; left time: 736.9287s
Epoch: 12 cost time: 9.326547145843506
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1020338
	speed: 0.1088s/iter; left time: 4479.8839s
	iters: 200, epoch: 13 | loss: 0.0108716
	speed: 0.0213s/iter; left time: 874.4478s
	iters: 300, epoch: 13 | loss: 0.0029149
	speed: 0.0211s/iter; left time: 863.8819s
	iters: 400, epoch: 13 | loss: 0.0439091
	speed: 0.0226s/iter; left time: 924.9912s
Epoch: 13 cost time: 10.789616823196411
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.970268 --> -0.974842).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0275946
	speed: 0.1148s/iter; left time: 4672.3928s
	iters: 200, epoch: 14 | loss: 0.0083253
	speed: 0.0240s/iter; left time: 974.4448s
	iters: 300, epoch: 14 | loss: 0.0039391
	speed: 0.0257s/iter; left time: 1041.0450s
	iters: 400, epoch: 14 | loss: 0.0678860
	speed: 0.0257s/iter; left time: 1037.7717s
Epoch: 14 cost time: 11.849149942398071
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0126969
	speed: 0.0975s/iter; left time: 3921.2921s
	iters: 200, epoch: 15 | loss: 0.0437269
	speed: 0.0186s/iter; left time: 745.1448s
	iters: 300, epoch: 15 | loss: 0.2201427
	speed: 0.0239s/iter; left time: 956.9413s
	iters: 400, epoch: 15 | loss: 0.0053819
	speed: 0.0284s/iter; left time: 1133.9239s
Epoch: 15 cost time: 11.3606858253479
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.974842 --> -0.978558).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0020351
	speed: 0.1311s/iter; left time: 5212.4749s
	iters: 200, epoch: 16 | loss: 0.0326892
	speed: 0.0217s/iter; left time: 861.6914s
	iters: 300, epoch: 16 | loss: 0.0007252
	speed: 0.0240s/iter; left time: 947.9625s
	iters: 400, epoch: 16 | loss: 0.0050148
	speed: 0.0260s/iter; left time: 1025.4823s
Epoch: 16 cost time: 12.206369876861572
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0049250
	speed: 0.1553s/iter; left time: 6103.0722s
	iters: 200, epoch: 17 | loss: 0.0231953
	speed: 0.0192s/iter; left time: 753.5103s
	iters: 300, epoch: 17 | loss: 0.0871599
	speed: 0.0194s/iter; left time: 758.5942s
	iters: 400, epoch: 17 | loss: 0.0486201
	speed: 0.0214s/iter; left time: 834.6183s
Epoch: 17 cost time: 10.286226987838745
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0023830
	speed: 0.1181s/iter; left time: 4584.0066s
	iters: 200, epoch: 18 | loss: 0.0015485
	speed: 0.0247s/iter; left time: 955.7379s
	iters: 300, epoch: 18 | loss: 0.0044795
	speed: 0.0261s/iter; left time: 1006.6369s
	iters: 400, epoch: 18 | loss: 0.0734699
	speed: 0.0283s/iter; left time: 1092.0929s
Epoch: 18 cost time: 12.547028303146362
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4649418
	speed: 0.1359s/iter; left time: 5214.2002s
	iters: 200, epoch: 19 | loss: 0.0067854
	speed: 0.0222s/iter; left time: 849.6977s
	iters: 300, epoch: 19 | loss: 0.0012471
	speed: 0.0250s/iter; left time: 953.1121s
	iters: 400, epoch: 19 | loss: 0.0009769
	speed: 0.0250s/iter; left time: 953.0070s
Epoch: 19 cost time: 11.6254141330719
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.978558 --> -0.982561).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0052781
	speed: 0.1130s/iter; left time: 4281.0530s
	iters: 200, epoch: 20 | loss: 0.0037263
	speed: 0.0185s/iter; left time: 700.2747s
	iters: 300, epoch: 20 | loss: 0.0024445
	speed: 0.0184s/iter; left time: 692.7765s
	iters: 400, epoch: 20 | loss: 0.0023318
	speed: 0.0174s/iter; left time: 653.8193s
Epoch: 20 cost time: 8.744922161102295
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2069456
	speed: 0.0931s/iter; left time: 3484.9274s
	iters: 200, epoch: 21 | loss: 0.0024297
	speed: 0.0222s/iter; left time: 829.0600s
	iters: 300, epoch: 21 | loss: 0.0512725
	speed: 0.0244s/iter; left time: 908.9616s
	iters: 400, epoch: 21 | loss: 0.0081843
	speed: 0.0212s/iter; left time: 785.8905s
Epoch: 21 cost time: 10.746542930603027
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0030636
	speed: 0.1077s/iter; left time: 3979.7382s
	iters: 200, epoch: 22 | loss: 0.0103945
	speed: 0.0218s/iter; left time: 802.7137s
	iters: 300, epoch: 22 | loss: 0.0014853
	speed: 0.0247s/iter; left time: 909.3165s
	iters: 400, epoch: 22 | loss: 0.0843612
	speed: 0.0240s/iter; left time: 879.3762s
Epoch: 22 cost time: 11.084213256835938
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0003617
	speed: 0.0917s/iter; left time: 3345.7001s
	iters: 200, epoch: 23 | loss: 0.0117959
	speed: 0.0181s/iter; left time: 659.3241s
	iters: 300, epoch: 23 | loss: 0.0164222
	speed: 0.0195s/iter; left time: 706.6827s
	iters: 400, epoch: 23 | loss: 0.0021501
	speed: 0.0185s/iter; left time: 670.5979s
Epoch: 23 cost time: 9.162755250930786
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0075304
	speed: 0.1068s/iter; left time: 3847.9931s
	iters: 200, epoch: 24 | loss: 0.0003988
	speed: 0.0205s/iter; left time: 737.9779s
	iters: 300, epoch: 24 | loss: 0.0002641
	speed: 0.0232s/iter; left time: 829.4010s
	iters: 400, epoch: 24 | loss: 0.0008163
	speed: 0.0239s/iter; left time: 852.8169s
Epoch: 24 cost time: 10.833462715148926
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0086369
	speed: 0.1203s/iter; left time: 4276.1108s
	iters: 200, epoch: 25 | loss: 0.0044900
	speed: 0.0270s/iter; left time: 955.7355s
	iters: 300, epoch: 25 | loss: 0.0026507
	speed: 0.0276s/iter; left time: 977.0484s
	iters: 400, epoch: 25 | loss: 0.0043098
	speed: 0.0223s/iter; left time: 784.9058s
Epoch: 25 cost time: 11.949976921081543
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0034472
	speed: 0.1101s/iter; left time: 3861.2655s
	iters: 200, epoch: 26 | loss: 0.0005020
	speed: 0.0194s/iter; left time: 677.5120s
	iters: 300, epoch: 26 | loss: 0.0045580
	speed: 0.0212s/iter; left time: 738.0789s
	iters: 400, epoch: 26 | loss: 0.0016825
	speed: 0.0234s/iter; left time: 814.8885s
Epoch: 26 cost time: 10.378976345062256
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0004410
	speed: 0.1339s/iter; left time: 4633.5460s
	iters: 200, epoch: 27 | loss: 0.0016296
	speed: 0.0268s/iter; left time: 925.5149s
	iters: 300, epoch: 27 | loss: 0.0003383
	speed: 0.0256s/iter; left time: 879.3938s
	iters: 400, epoch: 27 | loss: 0.0011846
	speed: 0.0268s/iter; left time: 919.3707s
Epoch: 27 cost time: 12.859871625900269
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0019263
	speed: 0.1567s/iter; left time: 5347.8769s
	iters: 200, epoch: 28 | loss: 0.0012541
	speed: 0.0266s/iter; left time: 904.7490s
	iters: 300, epoch: 28 | loss: 0.0015217
	speed: 0.0185s/iter; left time: 629.0982s
	iters: 400, epoch: 28 | loss: 0.0007741
	speed: 0.0182s/iter; left time: 614.4845s
Epoch: 28 cost time: 11.135133504867554
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0034495
	speed: 0.0876s/iter; left time: 2950.9513s
	iters: 200, epoch: 29 | loss: 0.0001616
	speed: 0.0166s/iter; left time: 556.3951s
	iters: 300, epoch: 29 | loss: 0.0521249
	speed: 0.0177s/iter; left time: 591.7570s
	iters: 400, epoch: 29 | loss: 0.0059985
	speed: 0.0230s/iter; left time: 768.7913s
Epoch: 29 cost time: 9.729856014251709
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982847).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0006212
	speed: 0.1131s/iter; left time: 3754.6331s
	iters: 200, epoch: 30 | loss: 0.0022342
	speed: 0.0201s/iter; left time: 664.0691s
	iters: 300, epoch: 30 | loss: 0.0000689
	speed: 0.0212s/iter; left time: 700.8320s
	iters: 400, epoch: 30 | loss: 0.0089230
	speed: 0.0218s/iter; left time: 718.1968s
Epoch: 30 cost time: 10.5316641330719
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0346649
	speed: 0.1295s/iter; left time: 4237.8492s
	iters: 200, epoch: 31 | loss: 0.1011953
	speed: 0.0176s/iter; left time: 575.7264s
	iters: 300, epoch: 31 | loss: 0.0032512
	speed: 0.0182s/iter; left time: 590.4426s
	iters: 400, epoch: 31 | loss: 0.0023022
	speed: 0.0191s/iter; left time: 620.4467s
Epoch: 31 cost time: 9.252065420150757
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0003016
	speed: 0.0934s/iter; left time: 3011.9386s
	iters: 200, epoch: 32 | loss: 0.0191432
	speed: 0.0204s/iter; left time: 657.5314s
	iters: 300, epoch: 32 | loss: 0.0001692
	speed: 0.0202s/iter; left time: 647.0584s
	iters: 400, epoch: 32 | loss: 0.0685208
	speed: 0.0207s/iter; left time: 662.4688s
Epoch: 32 cost time: 10.155301570892334
Epoch: 32, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0020373
	speed: 0.1488s/iter; left time: 4732.1129s
	iters: 200, epoch: 33 | loss: 0.0004473
	speed: 0.0212s/iter; left time: 672.7966s
	iters: 300, epoch: 33 | loss: 0.0014095
	speed: 0.0206s/iter; left time: 652.2515s
	iters: 400, epoch: 33 | loss: 0.0004244
	speed: 0.0194s/iter; left time: 611.1064s
Epoch: 33 cost time: 10.431403398513794
Epoch: 33, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0008069
	speed: 0.1163s/iter; left time: 3641.9390s
	iters: 200, epoch: 34 | loss: 0.0151661
	speed: 0.0182s/iter; left time: 566.9665s
	iters: 300, epoch: 34 | loss: 0.0004297
	speed: 0.0185s/iter; left time: 575.6062s
	iters: 400, epoch: 34 | loss: 0.0130085
	speed: 0.0183s/iter; left time: 568.3432s
Epoch: 34 cost time: 9.518874645233154
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0012004
	speed: 0.1173s/iter; left time: 3618.8788s
	iters: 200, epoch: 35 | loss: 0.0003202
	speed: 0.0226s/iter; left time: 696.3307s
	iters: 300, epoch: 35 | loss: 0.0056063
	speed: 0.0245s/iter; left time: 749.8607s
	iters: 400, epoch: 35 | loss: 0.0029058
	speed: 0.0237s/iter; left time: 725.0899s
Epoch: 35 cost time: 11.665822505950928
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0032090
	speed: 0.1528s/iter; left time: 4644.0200s
	iters: 200, epoch: 36 | loss: 0.0467705
	speed: 0.0218s/iter; left time: 661.0314s
	iters: 300, epoch: 36 | loss: 0.0008582
	speed: 0.0226s/iter; left time: 681.4214s
	iters: 400, epoch: 36 | loss: 0.0002134
	speed: 0.0238s/iter; left time: 715.9676s
Epoch: 36 cost time: 11.746300220489502
Epoch: 36, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0096089
	speed: 0.1094s/iter; left time: 3271.6938s
	iters: 200, epoch: 37 | loss: 0.0017120
	speed: 0.0183s/iter; left time: 544.6339s
	iters: 300, epoch: 37 | loss: 0.0064599
	speed: 0.0197s/iter; left time: 586.1982s
	iters: 400, epoch: 37 | loss: 0.0006987
	speed: 0.0218s/iter; left time: 646.5368s
Epoch: 37 cost time: 10.009066343307495
Epoch: 37, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0017142
	speed: 0.1199s/iter; left time: 3532.0552s
	iters: 200, epoch: 38 | loss: 0.0000488
	speed: 0.0225s/iter; left time: 661.2087s
	iters: 300, epoch: 38 | loss: 0.0007221
	speed: 0.0240s/iter; left time: 700.5220s
	iters: 400, epoch: 38 | loss: 0.0003236
	speed: 0.0264s/iter; left time: 770.3304s
Epoch: 38 cost time: 11.790359497070312
Epoch: 38, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0018649
	speed: 0.1184s/iter; left time: 3430.7952s
	iters: 200, epoch: 39 | loss: 0.0245778
	speed: 0.0195s/iter; left time: 564.2275s
	iters: 300, epoch: 39 | loss: 0.0013715
	speed: 0.0181s/iter; left time: 519.7072s
	iters: 400, epoch: 39 | loss: 0.0006276
	speed: 0.0163s/iter; left time: 468.5027s
Epoch: 39 cost time: 9.07978081703186
Epoch: 39, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 253570
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7696385
	speed: 0.0461s/iter; left time: 2158.1219s
	iters: 200, epoch: 1 | loss: 1.1140394
	speed: 0.0280s/iter; left time: 1307.7088s
	iters: 300, epoch: 1 | loss: 0.9258569
	speed: 0.0264s/iter; left time: 1230.9324s
	iters: 400, epoch: 1 | loss: 0.4182362
	speed: 0.0254s/iter; left time: 1180.4396s
Epoch: 1 cost time: 14.097508430480957
Epoch: 1, Steps: 469 | Train Loss: 1.150 Vali Loss: 0.458 Vali Acc: 0.894 Test Loss: 0.458 Test Acc: 0.894
Validation loss decreased (inf --> -0.893935).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3356496
	speed: 0.1058s/iter; left time: 4900.6139s
	iters: 200, epoch: 2 | loss: 0.3161468
	speed: 0.0220s/iter; left time: 1015.1973s
	iters: 300, epoch: 2 | loss: 0.1124605
	speed: 0.0238s/iter; left time: 1098.8093s
	iters: 400, epoch: 2 | loss: 0.1218429
	speed: 0.0237s/iter; left time: 1092.6984s
Epoch: 2 cost time: 11.306593418121338
Epoch: 2, Steps: 469 | Train Loss: 0.249 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.893935 --> -0.946253).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1900716
	speed: 0.1202s/iter; left time: 5514.2147s
	iters: 200, epoch: 3 | loss: 0.2721310
	speed: 0.0222s/iter; left time: 1017.9083s
	iters: 300, epoch: 3 | loss: 0.0859556
	speed: 0.0272s/iter; left time: 1243.1367s
	iters: 400, epoch: 3 | loss: 0.0525706
	speed: 0.0226s/iter; left time: 1028.8730s
Epoch: 3 cost time: 11.329539060592651
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0208963
	speed: 0.1272s/iter; left time: 5772.9565s
	iters: 200, epoch: 4 | loss: 0.0593138
	speed: 0.0221s/iter; left time: 1003.1769s
	iters: 300, epoch: 4 | loss: 0.0077684
	speed: 0.0239s/iter; left time: 1080.7202s
	iters: 400, epoch: 4 | loss: 0.0517875
	speed: 0.0226s/iter; left time: 1020.0160s
Epoch: 4 cost time: 10.964160442352295
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
Validation loss decreased (-0.946253 --> -0.946253).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1118274
	speed: 0.1037s/iter; left time: 4658.1550s
	iters: 200, epoch: 5 | loss: 0.0266937
	speed: 0.0182s/iter; left time: 814.2632s
	iters: 300, epoch: 5 | loss: 0.0354883
	speed: 0.0178s/iter; left time: 798.1444s
	iters: 400, epoch: 5 | loss: 0.0117832
	speed: 0.0175s/iter; left time: 780.1388s
Epoch: 5 cost time: 8.944034099578857
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.946253 --> -0.956831).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1322808
	speed: 0.1287s/iter; left time: 5722.9941s
	iters: 200, epoch: 6 | loss: 0.0602390
	speed: 0.0226s/iter; left time: 1000.9243s
	iters: 300, epoch: 6 | loss: 0.0623321
	speed: 0.0249s/iter; left time: 1103.9626s
	iters: 400, epoch: 6 | loss: 0.0178490
	speed: 0.0244s/iter; left time: 1078.8804s
Epoch: 6 cost time: 11.563010215759277
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2018979
	speed: 0.1276s/iter; left time: 5611.0647s
	iters: 200, epoch: 7 | loss: 0.0105032
	speed: 0.0207s/iter; left time: 909.0742s
	iters: 300, epoch: 7 | loss: 0.1441137
	speed: 0.0194s/iter; left time: 850.1659s
	iters: 400, epoch: 7 | loss: 0.4779626
	speed: 0.0189s/iter; left time: 826.5735s
Epoch: 7 cost time: 10.013502359390259
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.956831 --> -0.967409).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0167287
	speed: 0.1215s/iter; left time: 5285.7804s
	iters: 200, epoch: 8 | loss: 0.0359368
	speed: 0.0187s/iter; left time: 810.0230s
	iters: 300, epoch: 8 | loss: 0.0290586
	speed: 0.0188s/iter; left time: 814.3839s
	iters: 400, epoch: 8 | loss: 0.0029714
	speed: 0.0234s/iter; left time: 1011.0030s
Epoch: 8 cost time: 10.013779640197754
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0022592
	speed: 0.1416s/iter; left time: 6096.5645s
	iters: 200, epoch: 9 | loss: 0.0465908
	speed: 0.0249s/iter; left time: 1071.0740s
	iters: 300, epoch: 9 | loss: 0.0026020
	speed: 0.0284s/iter; left time: 1217.9179s
	iters: 400, epoch: 9 | loss: 0.0671812
	speed: 0.0223s/iter; left time: 955.2731s
Epoch: 9 cost time: 12.69272494316101
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.967409 --> -0.971697).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0024433
	speed: 0.1558s/iter; left time: 6636.0687s
	iters: 200, epoch: 10 | loss: 0.0070016
	speed: 0.0267s/iter; left time: 1132.5842s
	iters: 300, epoch: 10 | loss: 0.0306671
	speed: 0.0225s/iter; left time: 953.2136s
	iters: 400, epoch: 10 | loss: 0.0523529
	speed: 0.0191s/iter; left time: 807.0549s
Epoch: 10 cost time: 11.451108455657959
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1522078
	speed: 0.0800s/iter; left time: 3367.9736s
	iters: 200, epoch: 11 | loss: 0.0863204
	speed: 0.0228s/iter; left time: 959.3285s
	iters: 300, epoch: 11 | loss: 0.0042624
	speed: 0.0228s/iter; left time: 954.4514s
	iters: 400, epoch: 11 | loss: 0.1571220
	speed: 0.0232s/iter; left time: 971.5827s
Epoch: 11 cost time: 10.564305067062378
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0051705
	speed: 0.1300s/iter; left time: 5415.1039s
	iters: 200, epoch: 12 | loss: 0.0094897
	speed: 0.0256s/iter; left time: 1062.9267s
	iters: 300, epoch: 12 | loss: 0.0011601
	speed: 0.0250s/iter; left time: 1037.0575s
	iters: 400, epoch: 12 | loss: 0.0045888
	speed: 0.0250s/iter; left time: 1032.3222s
Epoch: 12 cost time: 11.918668031692505
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0074051
	speed: 0.1009s/iter; left time: 4154.6284s
	iters: 200, epoch: 13 | loss: 0.0016523
	speed: 0.0207s/iter; left time: 848.6304s
	iters: 300, epoch: 13 | loss: 0.0011336
	speed: 0.0172s/iter; left time: 703.1282s
	iters: 400, epoch: 13 | loss: 0.0041873
	speed: 0.0184s/iter; left time: 750.9798s
Epoch: 13 cost time: 9.273810386657715
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0016428
	speed: 0.1048s/iter; left time: 4264.4753s
	iters: 200, epoch: 14 | loss: 0.0050225
	speed: 0.0226s/iter; left time: 917.2671s
	iters: 300, epoch: 14 | loss: 0.0011127
	speed: 0.0247s/iter; left time: 999.4100s
	iters: 400, epoch: 14 | loss: 0.0135365
	speed: 0.0220s/iter; left time: 889.6517s
Epoch: 14 cost time: 11.317348003387451
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972555).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0081427
	speed: 0.1186s/iter; left time: 4772.0966s
	iters: 200, epoch: 15 | loss: 0.0022226
	speed: 0.0231s/iter; left time: 925.5954s
	iters: 300, epoch: 15 | loss: 0.0005933
	speed: 0.0213s/iter; left time: 851.8942s
	iters: 400, epoch: 15 | loss: 0.0076161
	speed: 0.0206s/iter; left time: 821.1964s
Epoch: 15 cost time: 10.422026872634888
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0021163
	speed: 0.1121s/iter; left time: 4456.9897s
	iters: 200, epoch: 16 | loss: 0.0133050
	speed: 0.0236s/iter; left time: 936.6072s
	iters: 300, epoch: 16 | loss: 0.0011166
	speed: 0.0222s/iter; left time: 879.0729s
	iters: 400, epoch: 16 | loss: 0.0035933
	speed: 0.0221s/iter; left time: 873.5977s
Epoch: 16 cost time: 11.12588119506836
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0050286
	speed: 0.1562s/iter; left time: 6138.3711s
	iters: 200, epoch: 17 | loss: 0.0078584
	speed: 0.0215s/iter; left time: 843.6690s
	iters: 300, epoch: 17 | loss: 0.0179005
	speed: 0.0215s/iter; left time: 841.0772s
	iters: 400, epoch: 17 | loss: 0.0072993
	speed: 0.0265s/iter; left time: 1032.6118s
Epoch: 17 cost time: 11.860955953598022
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1758991
	speed: 0.1305s/iter; left time: 5067.3982s
	iters: 200, epoch: 18 | loss: 0.0010168
	speed: 0.0231s/iter; left time: 896.4875s
	iters: 300, epoch: 18 | loss: 0.0342635
	speed: 0.0252s/iter; left time: 973.8706s
	iters: 400, epoch: 18 | loss: 0.0007236
	speed: 0.0236s/iter; left time: 909.0131s
Epoch: 18 cost time: 11.543171644210815
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1156620
	speed: 0.1115s/iter; left time: 4278.4197s
	iters: 200, epoch: 19 | loss: 0.0006674
	speed: 0.0199s/iter; left time: 762.0003s
	iters: 300, epoch: 19 | loss: 0.0030951
	speed: 0.0239s/iter; left time: 912.4423s
	iters: 400, epoch: 19 | loss: 0.0806322
	speed: 0.0266s/iter; left time: 1012.4192s
Epoch: 19 cost time: 11.078031063079834
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0015975
	speed: 0.1239s/iter; left time: 4692.9895s
	iters: 200, epoch: 20 | loss: 0.0783071
	speed: 0.0232s/iter; left time: 877.2526s
	iters: 300, epoch: 20 | loss: 0.0019806
	speed: 0.0235s/iter; left time: 885.0588s
	iters: 400, epoch: 20 | loss: 0.0014202
	speed: 0.0239s/iter; left time: 897.4122s
Epoch: 20 cost time: 11.173599243164062
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0481233
	speed: 0.1225s/iter; left time: 4582.4049s
	iters: 200, epoch: 21 | loss: 0.0004845
	speed: 0.0175s/iter; left time: 653.3303s
	iters: 300, epoch: 21 | loss: 0.0802563
	speed: 0.0179s/iter; left time: 667.4606s
	iters: 400, epoch: 21 | loss: 0.0024630
	speed: 0.0173s/iter; left time: 642.3639s
Epoch: 21 cost time: 8.755489826202393
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0056957
	speed: 0.0793s/iter; left time: 2930.7924s
	iters: 200, epoch: 22 | loss: 0.0032084
	speed: 0.0242s/iter; left time: 890.4631s
	iters: 300, epoch: 22 | loss: 0.1057217
	speed: 0.0226s/iter; left time: 831.5847s
	iters: 400, epoch: 22 | loss: 0.0895056
	speed: 0.0220s/iter; left time: 807.9293s
Epoch: 22 cost time: 11.086307287216187
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0050058
	speed: 0.1280s/iter; left time: 4669.4547s
	iters: 200, epoch: 23 | loss: 0.0305733
	speed: 0.0328s/iter; left time: 1193.2195s
	iters: 300, epoch: 23 | loss: 0.0013642
	speed: 0.0320s/iter; left time: 1160.0048s
	iters: 400, epoch: 23 | loss: 0.0055294
	speed: 0.0277s/iter; left time: 1001.5685s
Epoch: 23 cost time: 13.965924978256226
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.972555 --> -0.978844).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0003552
	speed: 0.1050s/iter; left time: 3781.4702s
	iters: 200, epoch: 24 | loss: 0.1851282
	speed: 0.0188s/iter; left time: 675.1523s
	iters: 300, epoch: 24 | loss: 0.0003114
	speed: 0.0177s/iter; left time: 634.1681s
	iters: 400, epoch: 24 | loss: 0.0004523
	speed: 0.0208s/iter; left time: 741.7437s
Epoch: 24 cost time: 9.53200650215149
Epoch: 24, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0022212
	speed: 0.1311s/iter; left time: 4660.8273s
	iters: 200, epoch: 25 | loss: 0.0007840
	speed: 0.0223s/iter; left time: 791.8905s
	iters: 300, epoch: 25 | loss: 0.0010601
	speed: 0.0224s/iter; left time: 791.6069s
	iters: 400, epoch: 25 | loss: 0.0015142
	speed: 0.0222s/iter; left time: 781.1254s
Epoch: 25 cost time: 10.889946937561035
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0029827
	speed: 0.1295s/iter; left time: 4542.2214s
	iters: 200, epoch: 26 | loss: 0.0021067
	speed: 0.0207s/iter; left time: 723.7390s
	iters: 300, epoch: 26 | loss: 0.0018545
	speed: 0.0209s/iter; left time: 727.2077s
	iters: 400, epoch: 26 | loss: 0.0227942
	speed: 0.0186s/iter; left time: 647.4834s
Epoch: 26 cost time: 9.795139074325562
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0002654
	speed: 0.1166s/iter; left time: 4036.0132s
	iters: 200, epoch: 27 | loss: 0.0032039
	speed: 0.0253s/iter; left time: 873.0062s
	iters: 300, epoch: 27 | loss: 0.0012671
	speed: 0.0273s/iter; left time: 940.5654s
	iters: 400, epoch: 27 | loss: 0.0014111
	speed: 0.0254s/iter; left time: 871.6621s
Epoch: 27 cost time: 12.899269819259644
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0065812
	speed: 0.1157s/iter; left time: 3949.7479s
	iters: 200, epoch: 28 | loss: 0.0002576
	speed: 0.0228s/iter; left time: 775.7531s
	iters: 300, epoch: 28 | loss: 0.0008286
	speed: 0.0249s/iter; left time: 844.6873s
	iters: 400, epoch: 28 | loss: 0.0016745
	speed: 0.0251s/iter; left time: 849.8639s
Epoch: 28 cost time: 11.513469934463501
Epoch: 28, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0037417
	speed: 0.1137s/iter; left time: 3829.8300s
	iters: 200, epoch: 29 | loss: 0.0017785
	speed: 0.0286s/iter; left time: 959.9962s
	iters: 300, epoch: 29 | loss: 0.0009378
	speed: 0.0252s/iter; left time: 842.0770s
	iters: 400, epoch: 29 | loss: 0.0005838
	speed: 0.0224s/iter; left time: 747.0536s
Epoch: 29 cost time: 12.021581172943115
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0050975
	speed: 0.0921s/iter; left time: 3057.2551s
	iters: 200, epoch: 30 | loss: 0.0013810
	speed: 0.0189s/iter; left time: 624.5378s
	iters: 300, epoch: 30 | loss: 0.0869153
	speed: 0.0193s/iter; left time: 636.3899s
	iters: 400, epoch: 30 | loss: 0.0068635
	speed: 0.0221s/iter; left time: 727.0828s
Epoch: 30 cost time: 9.611847400665283
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0013661
	speed: 0.1092s/iter; left time: 3572.7124s
	iters: 200, epoch: 31 | loss: 0.0006226
	speed: 0.0277s/iter; left time: 903.2870s
	iters: 300, epoch: 31 | loss: 0.0004231
	speed: 0.0229s/iter; left time: 746.1521s
	iters: 400, epoch: 31 | loss: 0.0412715
	speed: 0.0217s/iter; left time: 704.0298s
Epoch: 31 cost time: 11.942163467407227
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0006140
	speed: 0.1292s/iter; left time: 4169.4243s
	iters: 200, epoch: 32 | loss: 0.0007495
	speed: 0.0225s/iter; left time: 722.8773s
	iters: 300, epoch: 32 | loss: 0.0116431
	speed: 0.0176s/iter; left time: 563.6894s
	iters: 400, epoch: 32 | loss: 0.0006072
	speed: 0.0183s/iter; left time: 584.9892s
Epoch: 32 cost time: 9.799795389175415
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0001794
	speed: 0.1003s/iter; left time: 3187.9664s
	iters: 200, epoch: 33 | loss: 0.0009233
	speed: 0.0247s/iter; left time: 781.7691s
	iters: 300, epoch: 33 | loss: 0.1146110
	speed: 0.0207s/iter; left time: 655.5543s
	iters: 400, epoch: 33 | loss: 0.0236724
	speed: 0.0261s/iter; left time: 820.6799s
Epoch: 33 cost time: 12.27336311340332
Epoch: 33, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 153826
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5436091
	speed: 0.0332s/iter; left time: 1555.4490s
	iters: 200, epoch: 1 | loss: 0.6988951
	speed: 0.0187s/iter; left time: 871.5397s
	iters: 300, epoch: 1 | loss: 0.8206298
	speed: 0.0163s/iter; left time: 758.8567s
	iters: 400, epoch: 1 | loss: 0.5557256
	speed: 0.0186s/iter; left time: 866.6878s
Epoch: 1 cost time: 10.14773440361023
Epoch: 1, Steps: 469 | Train Loss: 1.069 Vali Loss: 0.443 Vali Acc: 0.860 Test Loss: 0.443 Test Acc: 0.860
Validation loss decreased (inf --> -0.860201).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2204885
	speed: 0.1029s/iter; left time: 4768.2839s
	iters: 200, epoch: 2 | loss: 0.0992707
	speed: 0.0171s/iter; left time: 789.1956s
	iters: 300, epoch: 2 | loss: 0.2106234
	speed: 0.0184s/iter; left time: 848.7409s
	iters: 400, epoch: 2 | loss: 0.1268489
	speed: 0.0185s/iter; left time: 849.4977s
Epoch: 2 cost time: 8.769927501678467
Epoch: 2, Steps: 469 | Train Loss: 0.248 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
Validation loss decreased (-0.860201 --> -0.913091).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0838326
	speed: 0.1139s/iter; left time: 5225.1057s
	iters: 200, epoch: 3 | loss: 0.0797722
	speed: 0.0232s/iter; left time: 1061.5307s
	iters: 300, epoch: 3 | loss: 0.0399198
	speed: 0.0231s/iter; left time: 1056.0569s
	iters: 400, epoch: 3 | loss: 0.0304926
	speed: 0.0206s/iter; left time: 939.0409s
Epoch: 3 cost time: 10.960866689682007
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.913091 --> -0.949684).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1365630
	speed: 0.1149s/iter; left time: 5217.5467s
	iters: 200, epoch: 4 | loss: 0.0785348
	speed: 0.0235s/iter; left time: 1062.5060s
	iters: 300, epoch: 4 | loss: 0.0627787
	speed: 0.0231s/iter; left time: 1042.0138s
	iters: 400, epoch: 4 | loss: 0.0197463
	speed: 0.0214s/iter; left time: 966.1536s
Epoch: 4 cost time: 10.663621664047241
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.949684 --> -0.956831).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0246214
	speed: 0.0965s/iter; left time: 4336.1238s
	iters: 200, epoch: 5 | loss: 0.0192541
	speed: 0.0224s/iter; left time: 1005.9355s
	iters: 300, epoch: 5 | loss: 0.2034610
	speed: 0.0208s/iter; left time: 932.3336s
	iters: 400, epoch: 5 | loss: 0.0060002
	speed: 0.0227s/iter; left time: 1011.6042s
Epoch: 5 cost time: 10.48938250541687
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0276219
	speed: 0.1248s/iter; left time: 5546.2988s
	iters: 200, epoch: 6 | loss: 0.1152004
	speed: 0.0210s/iter; left time: 932.7032s
	iters: 300, epoch: 6 | loss: 0.0015690
	speed: 0.0201s/iter; left time: 887.6865s
	iters: 400, epoch: 6 | loss: 0.0453120
	speed: 0.0198s/iter; left time: 872.2483s
Epoch: 6 cost time: 10.303258419036865
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0062708
	speed: 0.1110s/iter; left time: 4881.5108s
	iters: 200, epoch: 7 | loss: 0.0302017
	speed: 0.0196s/iter; left time: 860.0859s
	iters: 300, epoch: 7 | loss: 0.2649108
	speed: 0.0207s/iter; left time: 906.6385s
	iters: 400, epoch: 7 | loss: 0.0025784
	speed: 0.0239s/iter; left time: 1045.1035s
Epoch: 7 cost time: 10.590198993682861
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0305199
	speed: 0.1117s/iter; left time: 4862.8520s
	iters: 200, epoch: 8 | loss: 0.0102353
	speed: 0.0212s/iter; left time: 919.8962s
	iters: 300, epoch: 8 | loss: 0.0068247
	speed: 0.0212s/iter; left time: 919.7885s
	iters: 400, epoch: 8 | loss: 0.4137812
	speed: 0.0214s/iter; left time: 923.7734s
Epoch: 8 cost time: 10.404001235961914
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.956831 --> -0.964264).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0697199
	speed: 0.1080s/iter; left time: 4649.6647s
	iters: 200, epoch: 9 | loss: 0.0030084
	speed: 0.0178s/iter; left time: 765.0561s
	iters: 300, epoch: 9 | loss: 0.3121594
	speed: 0.0204s/iter; left time: 874.6011s
	iters: 400, epoch: 9 | loss: 0.0042284
	speed: 0.0215s/iter; left time: 920.2852s
Epoch: 9 cost time: 9.764501094818115
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0730000
	speed: 0.0967s/iter; left time: 4119.5591s
	iters: 200, epoch: 10 | loss: 0.0430328
	speed: 0.0221s/iter; left time: 938.4947s
	iters: 300, epoch: 10 | loss: 0.0172198
	speed: 0.0209s/iter; left time: 887.2589s
	iters: 400, epoch: 10 | loss: 0.0040859
	speed: 0.0201s/iter; left time: 850.2404s
Epoch: 10 cost time: 10.290097713470459
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0258220
	speed: 0.0990s/iter; left time: 4168.9067s
	iters: 200, epoch: 11 | loss: 0.0713091
	speed: 0.0222s/iter; left time: 932.8665s
	iters: 300, epoch: 11 | loss: 0.0115633
	speed: 0.0212s/iter; left time: 886.9706s
	iters: 400, epoch: 11 | loss: 0.4116389
	speed: 0.0213s/iter; left time: 890.9688s
Epoch: 11 cost time: 10.38766622543335
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.964264 --> -0.974556).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0012186
	speed: 0.0826s/iter; left time: 3440.1150s
	iters: 200, epoch: 12 | loss: 0.0268734
	speed: 0.0184s/iter; left time: 763.1132s
	iters: 300, epoch: 12 | loss: 0.1049353
	speed: 0.0207s/iter; left time: 858.6426s
	iters: 400, epoch: 12 | loss: 0.0065515
	speed: 0.0214s/iter; left time: 886.0564s
Epoch: 12 cost time: 9.54758882522583
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.954 Test Loss: 0.229 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1160313
	speed: 0.1032s/iter; left time: 4250.1005s
	iters: 200, epoch: 13 | loss: 0.0042507
	speed: 0.0244s/iter; left time: 1002.4228s
	iters: 300, epoch: 13 | loss: 0.0006652
	speed: 0.0230s/iter; left time: 944.0121s
	iters: 400, epoch: 13 | loss: 0.0120305
	speed: 0.0232s/iter; left time: 949.8215s
Epoch: 13 cost time: 11.288179874420166
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0181477
	speed: 0.1203s/iter; left time: 4897.3884s
	iters: 200, epoch: 14 | loss: 0.0178121
	speed: 0.0210s/iter; left time: 853.5334s
	iters: 300, epoch: 14 | loss: 0.0162125
	speed: 0.0201s/iter; left time: 815.5468s
	iters: 400, epoch: 14 | loss: 0.0026009
	speed: 0.0205s/iter; left time: 830.1799s
Epoch: 14 cost time: 10.12757921218872
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1079577
	speed: 0.1112s/iter; left time: 4474.4204s
	iters: 200, epoch: 15 | loss: 0.0011357
	speed: 0.0192s/iter; left time: 771.3214s
	iters: 300, epoch: 15 | loss: 0.0054654
	speed: 0.0195s/iter; left time: 779.7205s
	iters: 400, epoch: 15 | loss: 0.0014660
	speed: 0.0173s/iter; left time: 689.3491s
Epoch: 15 cost time: 9.185111284255981
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0018816
	speed: 0.0856s/iter; left time: 3404.7780s
	iters: 200, epoch: 16 | loss: 0.0039324
	speed: 0.0225s/iter; left time: 892.9361s
	iters: 300, epoch: 16 | loss: 0.0042026
	speed: 0.0256s/iter; left time: 1013.6194s
	iters: 400, epoch: 16 | loss: 0.0230875
	speed: 0.0244s/iter; left time: 963.9433s
Epoch: 16 cost time: 10.939093828201294
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1382328
	speed: 0.1113s/iter; left time: 4374.1819s
	iters: 200, epoch: 17 | loss: 0.0009285
	speed: 0.0223s/iter; left time: 873.8670s
	iters: 300, epoch: 17 | loss: 0.0003759
	speed: 0.0222s/iter; left time: 867.8773s
	iters: 400, epoch: 17 | loss: 0.0014545
	speed: 0.0200s/iter; left time: 779.9423s
Epoch: 17 cost time: 10.728163719177246
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0494172
	speed: 0.0978s/iter; left time: 3797.2721s
	iters: 200, epoch: 18 | loss: 0.0131147
	speed: 0.0170s/iter; left time: 658.7859s
	iters: 300, epoch: 18 | loss: 0.0010974
	speed: 0.0198s/iter; left time: 766.5564s
	iters: 400, epoch: 18 | loss: 0.0544640
	speed: 0.0189s/iter; left time: 726.4485s
Epoch: 18 cost time: 8.884140968322754
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0307870
	speed: 0.0809s/iter; left time: 3102.2770s
	iters: 200, epoch: 19 | loss: 0.0004966
	speed: 0.0175s/iter; left time: 669.2824s
	iters: 300, epoch: 19 | loss: 0.0013342
	speed: 0.0178s/iter; left time: 680.9046s
	iters: 400, epoch: 19 | loss: 0.0022111
	speed: 0.0208s/iter; left time: 790.7443s
Epoch: 19 cost time: 9.037991285324097
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0004589
	speed: 0.1174s/iter; left time: 4447.8324s
	iters: 200, epoch: 20 | loss: 0.0605838
	speed: 0.0215s/iter; left time: 810.8255s
	iters: 300, epoch: 20 | loss: 0.0036929
	speed: 0.0206s/iter; left time: 774.7395s
	iters: 400, epoch: 20 | loss: 0.1321822
	speed: 0.0226s/iter; left time: 850.8693s
Epoch: 20 cost time: 10.656493902206421
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1079065
	speed: 0.1271s/iter; left time: 4754.6671s
	iters: 200, epoch: 21 | loss: 0.0057222
	speed: 0.0220s/iter; left time: 822.4132s
	iters: 300, epoch: 21 | loss: 0.0008933
	speed: 0.0206s/iter; left time: 768.3521s
	iters: 400, epoch: 21 | loss: 0.0004260
	speed: 0.0173s/iter; left time: 642.0588s
Epoch: 21 cost time: 10.105918169021606
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 153794
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7015516
	speed: 0.0386s/iter; left time: 1807.9468s
	iters: 200, epoch: 1 | loss: 1.1054422
	speed: 0.0195s/iter; left time: 908.5034s
	iters: 300, epoch: 1 | loss: 0.9309807
	speed: 0.0193s/iter; left time: 899.3932s
	iters: 400, epoch: 1 | loss: 0.4163380
	speed: 0.0184s/iter; left time: 854.4445s
Epoch: 1 cost time: 10.971524953842163
Epoch: 1, Steps: 469 | Train Loss: 1.109 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
Validation loss decreased (inf --> -0.871922).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4448085
	speed: 0.1118s/iter; left time: 5181.0365s
	iters: 200, epoch: 2 | loss: 0.3319213
	speed: 0.0231s/iter; left time: 1065.9114s
	iters: 300, epoch: 2 | loss: 0.0788951
	speed: 0.0201s/iter; left time: 928.0006s
	iters: 400, epoch: 2 | loss: 0.1509536
	speed: 0.0175s/iter; left time: 806.9836s
Epoch: 2 cost time: 9.719236850738525
Epoch: 2, Steps: 469 | Train Loss: 0.249 Vali Loss: 0.262 Vali Acc: 0.919 Test Loss: 0.262 Test Acc: 0.919
Validation loss decreased (-0.871922 --> -0.918808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3723027
	speed: 0.0958s/iter; left time: 4393.2325s
	iters: 200, epoch: 3 | loss: 0.1692055
	speed: 0.0232s/iter; left time: 1062.8315s
	iters: 300, epoch: 3 | loss: 0.1253408
	speed: 0.0185s/iter; left time: 845.7690s
	iters: 400, epoch: 3 | loss: 0.0332136
	speed: 0.0169s/iter; left time: 768.9317s
Epoch: 3 cost time: 10.030152320861816
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.918808 --> -0.955687).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1757433
	speed: 0.1042s/iter; left time: 4728.9236s
	iters: 200, epoch: 4 | loss: 0.0151766
	speed: 0.0233s/iter; left time: 1055.7211s
	iters: 300, epoch: 4 | loss: 0.0166373
	speed: 0.0236s/iter; left time: 1067.0211s
	iters: 400, epoch: 4 | loss: 0.0330671
	speed: 0.0205s/iter; left time: 924.4698s
Epoch: 4 cost time: 10.757837057113647
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3343213
	speed: 0.1009s/iter; left time: 4534.5561s
	iters: 200, epoch: 5 | loss: 0.0136103
	speed: 0.0217s/iter; left time: 970.8028s
	iters: 300, epoch: 5 | loss: 0.0129005
	speed: 0.0199s/iter; left time: 891.4499s
	iters: 400, epoch: 5 | loss: 0.0245644
	speed: 0.0227s/iter; left time: 1013.4628s
Epoch: 5 cost time: 10.370856523513794
Epoch: 5, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.955687 --> -0.964550).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0084887
	speed: 0.1139s/iter; left time: 5065.1579s
	iters: 200, epoch: 6 | loss: 0.0419514
	speed: 0.0184s/iter; left time: 815.4623s
	iters: 300, epoch: 6 | loss: 0.0087309
	speed: 0.0212s/iter; left time: 938.9210s
	iters: 400, epoch: 6 | loss: 0.0129241
	speed: 0.0226s/iter; left time: 998.3435s
Epoch: 6 cost time: 10.36566424369812
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0062381
	speed: 0.1338s/iter; left time: 5886.6420s
	iters: 200, epoch: 7 | loss: 0.0160936
	speed: 0.0211s/iter; left time: 926.7808s
	iters: 300, epoch: 7 | loss: 0.0048439
	speed: 0.0222s/iter; left time: 973.2999s
	iters: 400, epoch: 7 | loss: 0.0154569
	speed: 0.0232s/iter; left time: 1014.3409s
Epoch: 7 cost time: 11.042141199111938
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0039003
	speed: 0.1393s/iter; left time: 6063.6618s
	iters: 200, epoch: 8 | loss: 0.0531140
	speed: 0.0207s/iter; left time: 896.8551s
	iters: 300, epoch: 8 | loss: 0.0019530
	speed: 0.0173s/iter; left time: 748.5742s
	iters: 400, epoch: 8 | loss: 0.0138185
	speed: 0.0165s/iter; left time: 711.0527s
Epoch: 8 cost time: 8.934844970703125
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.964 Test Loss: 0.160 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0026341
	speed: 0.0786s/iter; left time: 3383.7320s
	iters: 200, epoch: 9 | loss: 0.0069089
	speed: 0.0210s/iter; left time: 900.3826s
	iters: 300, epoch: 9 | loss: 0.0081429
	speed: 0.0206s/iter; left time: 882.8743s
	iters: 400, epoch: 9 | loss: 0.0068844
	speed: 0.0187s/iter; left time: 798.3396s
Epoch: 9 cost time: 9.524911880493164
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
Validation loss decreased (-0.964550 --> -0.965979).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0724583
	speed: 0.1013s/iter; left time: 4312.1600s
	iters: 200, epoch: 10 | loss: 0.0095323
	speed: 0.0207s/iter; left time: 878.5762s
	iters: 300, epoch: 10 | loss: 0.0052449
	speed: 0.0204s/iter; left time: 864.5715s
	iters: 400, epoch: 10 | loss: 0.0029194
	speed: 0.0224s/iter; left time: 947.7139s
Epoch: 10 cost time: 10.240787982940674
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0045031
	speed: 0.0894s/iter; left time: 3763.4545s
	iters: 200, epoch: 11 | loss: 0.0133360
	speed: 0.0171s/iter; left time: 720.1020s
	iters: 300, epoch: 11 | loss: 0.0095146
	speed: 0.0162s/iter; left time: 681.0000s
	iters: 400, epoch: 11 | loss: 0.0506894
	speed: 0.0175s/iter; left time: 731.4491s
Epoch: 11 cost time: 8.375300645828247
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.965979 --> -0.975699).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0021667
	speed: 0.0924s/iter; left time: 3849.2327s
	iters: 200, epoch: 12 | loss: 0.0057806
	speed: 0.0197s/iter; left time: 818.8393s
	iters: 300, epoch: 12 | loss: 0.0031423
	speed: 0.0190s/iter; left time: 787.0494s
	iters: 400, epoch: 12 | loss: 0.0299197
	speed: 0.0181s/iter; left time: 746.6021s
Epoch: 12 cost time: 9.392907619476318
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2039583
	speed: 0.1370s/iter; left time: 5641.4718s
	iters: 200, epoch: 13 | loss: 0.0019400
	speed: 0.0215s/iter; left time: 883.4537s
	iters: 300, epoch: 13 | loss: 0.2015260
	speed: 0.0180s/iter; left time: 739.1567s
	iters: 400, epoch: 13 | loss: 0.0030757
	speed: 0.0192s/iter; left time: 785.5510s
Epoch: 13 cost time: 10.277296781539917
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0063842
	speed: 0.0975s/iter; left time: 3966.7088s
	iters: 200, epoch: 14 | loss: 0.0324582
	speed: 0.0171s/iter; left time: 693.2885s
	iters: 300, epoch: 14 | loss: 0.0702249
	speed: 0.0168s/iter; left time: 679.7383s
	iters: 400, epoch: 14 | loss: 0.0005360
	speed: 0.0188s/iter; left time: 761.2116s
Epoch: 14 cost time: 8.890741109848022
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2002741
	speed: 0.1061s/iter; left time: 4267.9674s
	iters: 200, epoch: 15 | loss: 0.0020447
	speed: 0.0225s/iter; left time: 903.9686s
	iters: 300, epoch: 15 | loss: 0.0600953
	speed: 0.0230s/iter; left time: 921.1221s
	iters: 400, epoch: 15 | loss: 0.3647195
	speed: 0.0216s/iter; left time: 862.4883s
Epoch: 15 cost time: 10.724008083343506
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0008423
	speed: 0.1027s/iter; left time: 4082.6953s
	iters: 200, epoch: 16 | loss: 0.0370280
	speed: 0.0182s/iter; left time: 721.7950s
	iters: 300, epoch: 16 | loss: 0.0318200
	speed: 0.0174s/iter; left time: 688.6312s
	iters: 400, epoch: 16 | loss: 0.0090721
	speed: 0.0168s/iter; left time: 664.2987s
Epoch: 16 cost time: 8.599008560180664
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.963 Test Loss: 0.243 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0004586
	speed: 0.0857s/iter; left time: 3369.2152s
	iters: 200, epoch: 17 | loss: 0.0727641
	speed: 0.0219s/iter; left time: 858.6659s
	iters: 300, epoch: 17 | loss: 0.0019118
	speed: 0.0219s/iter; left time: 858.0264s
	iters: 400, epoch: 17 | loss: 0.0021513
	speed: 0.0234s/iter; left time: 914.2561s
Epoch: 17 cost time: 10.62393593788147
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0006897
	speed: 0.1134s/iter; left time: 4402.7663s
	iters: 200, epoch: 18 | loss: 0.0016805
	speed: 0.0211s/iter; left time: 818.5182s
	iters: 300, epoch: 18 | loss: 0.0004920
	speed: 0.0202s/iter; left time: 781.5596s
	iters: 400, epoch: 18 | loss: 0.0004986
	speed: 0.0209s/iter; left time: 805.1566s
Epoch: 18 cost time: 10.013070821762085
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2820786
	speed: 0.0784s/iter; left time: 3007.7945s
	iters: 200, epoch: 19 | loss: 0.0771532
	speed: 0.0189s/iter; left time: 722.4123s
	iters: 300, epoch: 19 | loss: 0.0004965
	speed: 0.0198s/iter; left time: 756.7683s
	iters: 400, epoch: 19 | loss: 0.0011853
	speed: 0.0180s/iter; left time: 686.6265s
Epoch: 19 cost time: 9.029764890670776
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976557).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0006268
	speed: 0.0999s/iter; left time: 3786.3984s
	iters: 200, epoch: 20 | loss: 0.1527427
	speed: 0.0228s/iter; left time: 861.2250s
	iters: 300, epoch: 20 | loss: 0.0067398
	speed: 0.0200s/iter; left time: 752.6153s
	iters: 400, epoch: 20 | loss: 0.0006330
	speed: 0.0227s/iter; left time: 853.9040s
Epoch: 20 cost time: 10.620336055755615
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0101877
	speed: 0.0989s/iter; left time: 3700.5864s
	iters: 200, epoch: 21 | loss: 0.0036504
	speed: 0.0179s/iter; left time: 669.8468s
	iters: 300, epoch: 21 | loss: 0.0006177
	speed: 0.0191s/iter; left time: 710.4075s
	iters: 400, epoch: 21 | loss: 0.0002340
	speed: 0.0218s/iter; left time: 808.0975s
Epoch: 21 cost time: 9.543231010437012
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0199632
	speed: 0.0898s/iter; left time: 3317.4873s
	iters: 200, epoch: 22 | loss: 0.0003622
	speed: 0.0234s/iter; left time: 864.0541s
	iters: 300, epoch: 22 | loss: 0.0015027
	speed: 0.0212s/iter; left time: 778.3395s
	iters: 400, epoch: 22 | loss: 0.0563864
	speed: 0.0205s/iter; left time: 751.1509s
Epoch: 22 cost time: 10.33479928970337
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0140082
	speed: 0.1158s/iter; left time: 4223.0692s
	iters: 200, epoch: 23 | loss: 0.0009794
	speed: 0.0234s/iter; left time: 850.5995s
	iters: 300, epoch: 23 | loss: 0.0003765
	speed: 0.0213s/iter; left time: 772.8390s
	iters: 400, epoch: 23 | loss: 0.0033887
	speed: 0.0205s/iter; left time: 740.1994s
Epoch: 23 cost time: 10.568289518356323
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0001319
	speed: 0.0742s/iter; left time: 2672.5286s
	iters: 200, epoch: 24 | loss: 0.0075558
	speed: 0.0173s/iter; left time: 622.0591s
	iters: 300, epoch: 24 | loss: 0.0009268
	speed: 0.0186s/iter; left time: 666.1492s
	iters: 400, epoch: 24 | loss: 0.0345703
	speed: 0.0186s/iter; left time: 664.4512s
Epoch: 24 cost time: 8.7789888381958
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0012728
	speed: 0.0920s/iter; left time: 3269.2287s
	iters: 200, epoch: 25 | loss: 0.0006400
	speed: 0.0211s/iter; left time: 749.1951s
	iters: 300, epoch: 25 | loss: 0.0025952
	speed: 0.0236s/iter; left time: 834.3897s
	iters: 400, epoch: 25 | loss: 0.0191532
	speed: 0.0242s/iter; left time: 851.3204s
Epoch: 25 cost time: 10.970657587051392
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1490269
	speed: 0.1114s/iter; left time: 3906.7186s
	iters: 200, epoch: 26 | loss: 0.0038945
	speed: 0.0176s/iter; left time: 616.7203s
	iters: 300, epoch: 26 | loss: 0.0008621
	speed: 0.0177s/iter; left time: 617.2508s
	iters: 400, epoch: 26 | loss: 0.0009379
	speed: 0.0168s/iter; left time: 583.6178s
Epoch: 26 cost time: 8.926142692565918
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0055736
	speed: 0.0736s/iter; left time: 2545.9158s
	iters: 200, epoch: 27 | loss: 0.0022593
	speed: 0.0171s/iter; left time: 591.0953s
	iters: 300, epoch: 27 | loss: 0.0004662
	speed: 0.0195s/iter; left time: 671.0101s
	iters: 400, epoch: 27 | loss: 0.0362600
	speed: 0.0202s/iter; left time: 692.7360s
Epoch: 27 cost time: 8.981011867523193
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0054907
	speed: 0.1202s/iter; left time: 4104.2878s
	iters: 200, epoch: 28 | loss: 0.0048204
	speed: 0.0276s/iter; left time: 938.7434s
	iters: 300, epoch: 28 | loss: 0.0004444
	speed: 0.0273s/iter; left time: 927.0825s
	iters: 400, epoch: 28 | loss: 0.0007900
	speed: 0.0257s/iter; left time: 871.2941s
Epoch: 28 cost time: 12.852788925170898
Epoch: 28, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0959712
	speed: 0.1228s/iter; left time: 4135.1041s
	iters: 200, epoch: 29 | loss: 0.0070220
	speed: 0.0197s/iter; left time: 661.7341s
	iters: 300, epoch: 29 | loss: 0.0026581
	speed: 0.0177s/iter; left time: 592.4238s
	iters: 400, epoch: 29 | loss: 0.0015309
	speed: 0.0179s/iter; left time: 596.3526s
Epoch: 29 cost time: 9.128998041152954
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0660472
	speed: 0.0881s/iter; left time: 2924.1457s
	iters: 200, epoch: 30 | loss: 0.0002021
	speed: 0.0216s/iter; left time: 715.4731s
	iters: 300, epoch: 30 | loss: 0.0000978
	speed: 0.0232s/iter; left time: 764.6813s
	iters: 400, epoch: 30 | loss: 0.2635179
	speed: 0.0224s/iter; left time: 737.2500s
Epoch: 30 cost time: 11.002896308898926
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0321751
	speed: 0.1152s/iter; left time: 3771.4031s
	iters: 200, epoch: 31 | loss: 0.0041968
	speed: 0.0246s/iter; left time: 803.7201s
	iters: 300, epoch: 31 | loss: 0.0012884
	speed: 0.0267s/iter; left time: 867.3358s
	iters: 400, epoch: 31 | loss: 0.0006969
	speed: 0.0238s/iter; left time: 770.5692s
Epoch: 31 cost time: 11.832314014434814
Epoch: 31, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.978272).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0001840
	speed: 0.0939s/iter; left time: 3029.3731s
	iters: 200, epoch: 32 | loss: 0.1332426
	speed: 0.0171s/iter; left time: 549.4512s
	iters: 300, epoch: 32 | loss: 0.0002027
	speed: 0.0168s/iter; left time: 537.9167s
	iters: 400, epoch: 32 | loss: 0.0621371
	speed: 0.0165s/iter; left time: 527.2379s
Epoch: 32 cost time: 8.314862489700317
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0006615
	speed: 0.0917s/iter; left time: 2914.6833s
	iters: 200, epoch: 33 | loss: 0.0001544
	speed: 0.0228s/iter; left time: 723.1970s
	iters: 300, epoch: 33 | loss: 0.0008564
	speed: 0.0210s/iter; left time: 663.7700s
	iters: 400, epoch: 33 | loss: 0.0019268
	speed: 0.0197s/iter; left time: 620.6065s
Epoch: 33 cost time: 10.398318529129028
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0598266
	speed: 0.1081s/iter; left time: 3386.6595s
	iters: 200, epoch: 34 | loss: 0.0004197
	speed: 0.0199s/iter; left time: 620.3180s
	iters: 300, epoch: 34 | loss: 0.0035767
	speed: 0.0179s/iter; left time: 557.6485s
	iters: 400, epoch: 34 | loss: 0.0002226
	speed: 0.0181s/iter; left time: 561.2679s
Epoch: 34 cost time: 9.607264518737793
Epoch: 34, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0001363
	speed: 0.0681s/iter; left time: 2100.1404s
	iters: 200, epoch: 35 | loss: 0.0005603
	speed: 0.0166s/iter; left time: 509.6730s
	iters: 300, epoch: 35 | loss: 0.0002092
	speed: 0.0175s/iter; left time: 537.9152s
	iters: 400, epoch: 35 | loss: 0.0038327
	speed: 0.0221s/iter; left time: 675.0140s
Epoch: 35 cost time: 9.15447735786438
Epoch: 35, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0006019
	speed: 0.1046s/iter; left time: 3178.0432s
	iters: 200, epoch: 36 | loss: 0.0003435
	speed: 0.0213s/iter; left time: 646.2235s
	iters: 300, epoch: 36 | loss: 0.0017375
	speed: 0.0245s/iter; left time: 739.5531s
	iters: 400, epoch: 36 | loss: 0.0009443
	speed: 0.0227s/iter; left time: 683.4483s
Epoch: 36 cost time: 10.905263423919678
Epoch: 36, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0022537
	speed: 0.1231s/iter; left time: 3681.7750s
	iters: 200, epoch: 37 | loss: 0.0001013
	speed: 0.0175s/iter; left time: 520.3849s
	iters: 300, epoch: 37 | loss: 0.0001184
	speed: 0.0177s/iter; left time: 525.2916s
	iters: 400, epoch: 37 | loss: 0.0002548
	speed: 0.0203s/iter; left time: 600.1046s
Epoch: 37 cost time: 9.429545164108276
Epoch: 37, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0044806
	speed: 0.0974s/iter; left time: 2868.3966s
	iters: 200, epoch: 38 | loss: 0.0028372
	speed: 0.0185s/iter; left time: 541.5304s
	iters: 300, epoch: 38 | loss: 0.0013103
	speed: 0.0207s/iter; left time: 606.2739s
	iters: 400, epoch: 38 | loss: 0.0003355
	speed: 0.0208s/iter; left time: 605.8171s
Epoch: 38 cost time: 9.585253715515137
Epoch: 38, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000538
	speed: 0.1135s/iter; left time: 3290.3455s
	iters: 200, epoch: 39 | loss: 0.0017298
	speed: 0.0188s/iter; left time: 543.7526s
	iters: 300, epoch: 39 | loss: 0.0224368
	speed: 0.0190s/iter; left time: 545.6594s
	iters: 400, epoch: 39 | loss: 0.0203697
	speed: 0.0185s/iter; left time: 530.8188s
Epoch: 39 cost time: 9.256992101669312
Epoch: 39, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0007294
	speed: 0.0794s/iter; left time: 2264.8436s
	iters: 200, epoch: 40 | loss: 0.0001145
	speed: 0.0175s/iter; left time: 496.6173s
	iters: 300, epoch: 40 | loss: 0.0074883
	speed: 0.0176s/iter; left time: 499.1393s
	iters: 400, epoch: 40 | loss: 0.0004429
	speed: 0.0199s/iter; left time: 561.1951s
Epoch: 40 cost time: 8.699217319488525
Epoch: 40, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0001438
	speed: 0.0980s/iter; left time: 2748.9028s
	iters: 200, epoch: 41 | loss: 0.0445271
	speed: 0.0200s/iter; left time: 559.8466s
	iters: 300, epoch: 41 | loss: 0.0007607
	speed: 0.0223s/iter; left time: 621.7316s
	iters: 400, epoch: 41 | loss: 0.0078945
	speed: 0.0211s/iter; left time: 585.0339s
Epoch: 41 cost time: 10.363040924072266
Epoch: 41, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 153762
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9299319
	speed: 0.0339s/iter; left time: 1585.0271s
	iters: 200, epoch: 1 | loss: 1.1658139
	speed: 0.0169s/iter; left time: 788.7032s
	iters: 300, epoch: 1 | loss: 0.7871514
	speed: 0.0167s/iter; left time: 777.3354s
	iters: 400, epoch: 1 | loss: 0.6105971
	speed: 0.0177s/iter; left time: 823.0106s
Epoch: 1 cost time: 9.891377210617065
Epoch: 1, Steps: 469 | Train Loss: 1.197 Vali Loss: 0.447 Vali Acc: 0.857 Test Loss: 0.447 Test Acc: 0.857
Validation loss decreased (inf --> -0.857057).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5691104
	speed: 0.1029s/iter; left time: 4768.8845s
	iters: 200, epoch: 2 | loss: 0.2041452
	speed: 0.0228s/iter; left time: 1053.4836s
	iters: 300, epoch: 2 | loss: 0.2585171
	speed: 0.0220s/iter; left time: 1015.1117s
	iters: 400, epoch: 2 | loss: 0.2736401
	speed: 0.0196s/iter; left time: 903.8811s
Epoch: 2 cost time: 10.580243110656738
Epoch: 2, Steps: 469 | Train Loss: 0.257 Vali Loss: 0.306 Vali Acc: 0.904 Test Loss: 0.306 Test Acc: 0.904
Validation loss decreased (-0.857057 --> -0.904228).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3274997
	speed: 0.0947s/iter; left time: 4344.0822s
	iters: 200, epoch: 3 | loss: 0.0475003
	speed: 0.0197s/iter; left time: 902.5280s
	iters: 300, epoch: 3 | loss: 0.4843885
	speed: 0.0185s/iter; left time: 846.1980s
	iters: 400, epoch: 3 | loss: 0.1164941
	speed: 0.0164s/iter; left time: 745.3902s
Epoch: 3 cost time: 8.934325456619263
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.174 Vali Acc: 0.947 Test Loss: 0.174 Test Acc: 0.947
Validation loss decreased (-0.904228 --> -0.947111).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0903983
	speed: 0.0788s/iter; left time: 3577.4965s
	iters: 200, epoch: 4 | loss: 0.0181935
	speed: 0.0187s/iter; left time: 846.9038s
	iters: 300, epoch: 4 | loss: 0.0106285
	speed: 0.0197s/iter; left time: 890.1337s
	iters: 400, epoch: 4 | loss: 0.1324143
	speed: 0.0184s/iter; left time: 828.9293s
Epoch: 4 cost time: 9.14320421218872
Epoch: 4, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.947111 --> -0.961119).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0389872
	speed: 0.0939s/iter; left time: 4216.8641s
	iters: 200, epoch: 5 | loss: 0.0101320
	speed: 0.0199s/iter; left time: 892.8902s
	iters: 300, epoch: 5 | loss: 0.0370105
	speed: 0.0194s/iter; left time: 868.8123s
	iters: 400, epoch: 5 | loss: 0.0068279
	speed: 0.0178s/iter; left time: 796.5128s
Epoch: 5 cost time: 9.319278717041016
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.961119 --> -0.963120).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0746262
	speed: 0.1073s/iter; left time: 4769.5482s
	iters: 200, epoch: 6 | loss: 0.0262688
	speed: 0.0186s/iter; left time: 824.5778s
	iters: 300, epoch: 6 | loss: 0.0050184
	speed: 0.0167s/iter; left time: 738.5746s
	iters: 400, epoch: 6 | loss: 0.2398633
	speed: 0.0157s/iter; left time: 695.1877s
Epoch: 6 cost time: 8.59336543083191
Epoch: 6, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.963120 --> -0.963692).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0115378
	speed: 0.0767s/iter; left time: 3373.0742s
	iters: 200, epoch: 7 | loss: 0.0355910
	speed: 0.0172s/iter; left time: 755.0856s
	iters: 300, epoch: 7 | loss: 0.0528733
	speed: 0.0163s/iter; left time: 715.1711s
	iters: 400, epoch: 7 | loss: 0.1100427
	speed: 0.0169s/iter; left time: 739.2183s
Epoch: 7 cost time: 8.148167133331299
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0551912
	speed: 0.0882s/iter; left time: 3837.7434s
	iters: 200, epoch: 8 | loss: 0.0010615
	speed: 0.0179s/iter; left time: 776.2425s
	iters: 300, epoch: 8 | loss: 0.0010797
	speed: 0.0189s/iter; left time: 818.9205s
	iters: 400, epoch: 8 | loss: 0.0188941
	speed: 0.0192s/iter; left time: 831.6165s
Epoch: 8 cost time: 9.24205756187439
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2770807
	speed: 0.1006s/iter; left time: 4331.7896s
	iters: 200, epoch: 9 | loss: 0.0023809
	speed: 0.0183s/iter; left time: 785.7144s
	iters: 300, epoch: 9 | loss: 0.0028403
	speed: 0.0187s/iter; left time: 802.0307s
	iters: 400, epoch: 9 | loss: 0.0201840
	speed: 0.0186s/iter; left time: 796.0734s
Epoch: 9 cost time: 9.09478497505188
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.963692 --> -0.967409).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0036101
	speed: 0.0932s/iter; left time: 3968.3460s
	iters: 200, epoch: 10 | loss: 0.0040705
	speed: 0.0178s/iter; left time: 756.2937s
	iters: 300, epoch: 10 | loss: 0.0424109
	speed: 0.0214s/iter; left time: 908.4287s
	iters: 400, epoch: 10 | loss: 0.0041371
	speed: 0.0236s/iter; left time: 996.0726s
Epoch: 10 cost time: 9.793734073638916
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0009113
	speed: 0.1103s/iter; left time: 4645.1813s
	iters: 200, epoch: 11 | loss: 0.0104767
	speed: 0.0177s/iter; left time: 743.0139s
	iters: 300, epoch: 11 | loss: 0.0045327
	speed: 0.0190s/iter; left time: 797.3031s
	iters: 400, epoch: 11 | loss: 0.0351512
	speed: 0.0209s/iter; left time: 872.1426s
Epoch: 11 cost time: 9.429187297821045
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0077703
	speed: 0.1140s/iter; left time: 4747.0950s
	iters: 200, epoch: 12 | loss: 0.0640717
	speed: 0.0175s/iter; left time: 727.9595s
	iters: 300, epoch: 12 | loss: 0.0007349
	speed: 0.0196s/iter; left time: 814.2576s
	iters: 400, epoch: 12 | loss: 0.0059899
	speed: 0.0211s/iter; left time: 872.4876s
Epoch: 12 cost time: 9.316240072250366
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0022964
	speed: 0.0845s/iter; left time: 3477.2427s
	iters: 200, epoch: 13 | loss: 0.0016121
	speed: 0.0163s/iter; left time: 670.3017s
	iters: 300, epoch: 13 | loss: 0.0040995
	speed: 0.0196s/iter; left time: 801.6985s
	iters: 400, epoch: 13 | loss: 0.0009470
	speed: 0.0206s/iter; left time: 842.2803s
Epoch: 13 cost time: 8.995895624160767
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0031142
	speed: 0.1119s/iter; left time: 4553.6136s
	iters: 200, epoch: 14 | loss: 0.0135993
	speed: 0.0199s/iter; left time: 806.0919s
	iters: 300, epoch: 14 | loss: 0.0007139
	speed: 0.0202s/iter; left time: 818.6416s
	iters: 400, epoch: 14 | loss: 0.0025182
	speed: 0.0217s/iter; left time: 875.9487s
Epoch: 14 cost time: 10.128923654556274
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.969410).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0013681
	speed: 0.0982s/iter; left time: 3951.8207s
	iters: 200, epoch: 15 | loss: 0.0477531
	speed: 0.0203s/iter; left time: 815.9631s
	iters: 300, epoch: 15 | loss: 0.3849175
	speed: 0.0176s/iter; left time: 703.9483s
	iters: 400, epoch: 15 | loss: 0.0074680
	speed: 0.0174s/iter; left time: 695.6728s
Epoch: 15 cost time: 9.18498182296753
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.972269).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0007560
	speed: 0.0947s/iter; left time: 3764.4113s
	iters: 200, epoch: 16 | loss: 0.0031591
	speed: 0.0192s/iter; left time: 763.2895s
	iters: 300, epoch: 16 | loss: 0.0039265
	speed: 0.0202s/iter; left time: 798.3429s
	iters: 400, epoch: 16 | loss: 0.1665419
	speed: 0.0169s/iter; left time: 668.8205s
Epoch: 16 cost time: 9.115533590316772
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972269 --> -0.974270).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0259556
	speed: 0.0723s/iter; left time: 2840.8187s
	iters: 200, epoch: 17 | loss: 0.0009147
	speed: 0.0160s/iter; left time: 625.4074s
	iters: 300, epoch: 17 | loss: 0.0554735
	speed: 0.0165s/iter; left time: 643.4410s
	iters: 400, epoch: 17 | loss: 0.0194488
	speed: 0.0162s/iter; left time: 632.1802s
Epoch: 17 cost time: 7.872116327285767
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0048944
	speed: 0.0846s/iter; left time: 3283.0434s
	iters: 200, epoch: 18 | loss: 0.0351284
	speed: 0.0191s/iter; left time: 738.3171s
	iters: 300, epoch: 18 | loss: 0.0366505
	speed: 0.0182s/iter; left time: 703.0039s
	iters: 400, epoch: 18 | loss: 0.0033519
	speed: 0.0180s/iter; left time: 693.3722s
Epoch: 18 cost time: 9.117464780807495
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2489869
	speed: 0.1060s/iter; left time: 4066.2253s
	iters: 200, epoch: 19 | loss: 0.0999476
	speed: 0.0197s/iter; left time: 755.5393s
	iters: 300, epoch: 19 | loss: 0.0047209
	speed: 0.0203s/iter; left time: 775.1790s
	iters: 400, epoch: 19 | loss: 0.1599969
	speed: 0.0201s/iter; left time: 766.7369s
Epoch: 19 cost time: 9.884748220443726
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.978558).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0008174
	speed: 0.0908s/iter; left time: 3439.2381s
	iters: 200, epoch: 20 | loss: 0.0085885
	speed: 0.0159s/iter; left time: 600.3689s
	iters: 300, epoch: 20 | loss: 0.0066319
	speed: 0.0158s/iter; left time: 594.4174s
	iters: 400, epoch: 20 | loss: 0.0011603
	speed: 0.0172s/iter; left time: 648.2024s
Epoch: 20 cost time: 8.02831244468689
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0010284
	speed: 0.0813s/iter; left time: 3041.5017s
	iters: 200, epoch: 21 | loss: 0.0018981
	speed: 0.0206s/iter; left time: 767.5821s
	iters: 300, epoch: 21 | loss: 0.0060018
	speed: 0.0197s/iter; left time: 734.2216s
	iters: 400, epoch: 21 | loss: 0.3547027
	speed: 0.0168s/iter; left time: 624.4324s
Epoch: 21 cost time: 9.373050689697266
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0049871
	speed: 0.0851s/iter; left time: 3144.5105s
	iters: 200, epoch: 22 | loss: 0.0027501
	speed: 0.0192s/iter; left time: 707.9806s
	iters: 300, epoch: 22 | loss: 0.0801048
	speed: 0.0181s/iter; left time: 665.1020s
	iters: 400, epoch: 22 | loss: 0.0036860
	speed: 0.0169s/iter; left time: 620.4071s
Epoch: 22 cost time: 8.715867519378662
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0068623
	speed: 0.0719s/iter; left time: 2621.7112s
	iters: 200, epoch: 23 | loss: 0.0090248
	speed: 0.0171s/iter; left time: 623.0410s
	iters: 300, epoch: 23 | loss: 0.0007097
	speed: 0.0187s/iter; left time: 677.8500s
	iters: 400, epoch: 23 | loss: 0.0015550
	speed: 0.0189s/iter; left time: 682.7984s
Epoch: 23 cost time: 8.688049793243408
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0003288
	speed: 0.1125s/iter; left time: 4052.7485s
	iters: 200, epoch: 24 | loss: 0.0007752
	speed: 0.0194s/iter; left time: 697.4971s
	iters: 300, epoch: 24 | loss: 0.1812685
	speed: 0.0186s/iter; left time: 665.6865s
	iters: 400, epoch: 24 | loss: 0.0026459
	speed: 0.0180s/iter; left time: 643.7218s
Epoch: 24 cost time: 9.191817998886108
Epoch: 24, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0030341
	speed: 0.0976s/iter; left time: 3467.9387s
	iters: 200, epoch: 25 | loss: 0.0012595
	speed: 0.0215s/iter; left time: 762.9640s
	iters: 300, epoch: 25 | loss: 0.0022935
	speed: 0.0205s/iter; left time: 725.2186s
	iters: 400, epoch: 25 | loss: 0.0043053
	speed: 0.0204s/iter; left time: 719.5095s
Epoch: 25 cost time: 10.215144872665405
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0015326
	speed: 0.0973s/iter; left time: 3411.8305s
	iters: 200, epoch: 26 | loss: 0.0040351
	speed: 0.0207s/iter; left time: 723.2562s
	iters: 300, epoch: 26 | loss: 0.0005322
	speed: 0.0187s/iter; left time: 652.6568s
	iters: 400, epoch: 26 | loss: 0.0145833
	speed: 0.0205s/iter; left time: 713.4129s
Epoch: 26 cost time: 9.474057674407959
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0040266
	speed: 0.0949s/iter; left time: 3284.7939s
	iters: 200, epoch: 27 | loss: 0.0011777
	speed: 0.0208s/iter; left time: 718.8440s
	iters: 300, epoch: 27 | loss: 0.0836570
	speed: 0.0198s/iter; left time: 679.7828s
	iters: 400, epoch: 27 | loss: 0.0038383
	speed: 0.0207s/iter; left time: 709.8558s
Epoch: 27 cost time: 9.961227178573608
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0001481
	speed: 0.1007s/iter; left time: 3438.9899s
	iters: 200, epoch: 28 | loss: 0.0057677
	speed: 0.0211s/iter; left time: 718.5768s
	iters: 300, epoch: 28 | loss: 0.0004549
	speed: 0.0210s/iter; left time: 713.8016s
	iters: 400, epoch: 28 | loss: 0.0017444
	speed: 0.0200s/iter; left time: 676.5157s
Epoch: 28 cost time: 9.839392900466919
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0021747
	speed: 0.0830s/iter; left time: 2793.0882s
	iters: 200, epoch: 29 | loss: 0.0020437
	speed: 0.0171s/iter; left time: 574.1097s
	iters: 300, epoch: 29 | loss: 0.0018552
	speed: 0.0179s/iter; left time: 598.0753s
	iters: 400, epoch: 29 | loss: 0.0003395
	speed: 0.0194s/iter; left time: 645.9353s
Epoch: 29 cost time: 8.725982427597046
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 153730
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8612744
	speed: 0.0322s/iter; left time: 1508.4874s
	iters: 200, epoch: 1 | loss: 1.1742454
	speed: 0.0192s/iter; left time: 895.9044s
	iters: 300, epoch: 1 | loss: 0.9217409
	speed: 0.0191s/iter; left time: 890.9490s
	iters: 400, epoch: 1 | loss: 0.6549916
	speed: 0.0198s/iter; left time: 919.1618s
Epoch: 1 cost time: 10.520805358886719
Epoch: 1, Steps: 469 | Train Loss: 1.187 Vali Loss: 0.468 Vali Acc: 0.851 Test Loss: 0.468 Test Acc: 0.851
Validation loss decreased (inf --> -0.851053).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2980779
	speed: 0.0987s/iter; left time: 4575.2382s
	iters: 200, epoch: 2 | loss: 0.3119991
	speed: 0.0173s/iter; left time: 801.8784s
	iters: 300, epoch: 2 | loss: 0.1003171
	speed: 0.0175s/iter; left time: 806.4778s
	iters: 400, epoch: 2 | loss: 0.1361141
	speed: 0.0191s/iter; left time: 878.6238s
Epoch: 2 cost time: 8.78890585899353
Epoch: 2, Steps: 469 | Train Loss: 0.255 Vali Loss: 0.282 Vali Acc: 0.914 Test Loss: 0.282 Test Acc: 0.914
Validation loss decreased (-0.851053 --> -0.913948).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0363039
	speed: 0.1165s/iter; left time: 5345.1710s
	iters: 200, epoch: 3 | loss: 0.0347771
	speed: 0.0229s/iter; left time: 1047.9303s
	iters: 300, epoch: 3 | loss: 0.0693777
	speed: 0.0218s/iter; left time: 995.4582s
	iters: 400, epoch: 3 | loss: 0.2969535
	speed: 0.0239s/iter; left time: 1088.2117s
Epoch: 3 cost time: 11.929791450500488
Epoch: 3, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.207 Vali Acc: 0.940 Test Loss: 0.207 Test Acc: 0.940
Validation loss decreased (-0.913948 --> -0.940250).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0161252
	speed: 0.1422s/iter; left time: 6453.2491s
	iters: 200, epoch: 4 | loss: 0.0231157
	speed: 0.0248s/iter; left time: 1121.6216s
	iters: 300, epoch: 4 | loss: 0.0934668
	speed: 0.0219s/iter; left time: 989.4994s
	iters: 400, epoch: 4 | loss: 0.2578766
	speed: 0.0177s/iter; left time: 799.8961s
Epoch: 4 cost time: 10.87515115737915
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940250 --> -0.941107).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0092932
	speed: 0.0739s/iter; left time: 3318.1132s
	iters: 200, epoch: 5 | loss: 0.0386775
	speed: 0.0170s/iter; left time: 763.9778s
	iters: 300, epoch: 5 | loss: 0.0728668
	speed: 0.0161s/iter; left time: 720.9431s
	iters: 400, epoch: 5 | loss: 0.0983648
	speed: 0.0174s/iter; left time: 778.7042s
Epoch: 5 cost time: 8.250588417053223
Epoch: 5, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.941107 --> -0.965407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0129307
	speed: 0.0945s/iter; left time: 4199.7705s
	iters: 200, epoch: 6 | loss: 0.0169763
	speed: 0.0200s/iter; left time: 887.9582s
	iters: 300, epoch: 6 | loss: 0.1248203
	speed: 0.0199s/iter; left time: 880.8046s
	iters: 400, epoch: 6 | loss: 0.0418170
	speed: 0.0192s/iter; left time: 846.1940s
Epoch: 6 cost time: 9.643205165863037
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1344761
	speed: 0.1086s/iter; left time: 4775.0588s
	iters: 200, epoch: 7 | loss: 0.0080292
	speed: 0.0191s/iter; left time: 839.6215s
	iters: 300, epoch: 7 | loss: 0.0260815
	speed: 0.0177s/iter; left time: 774.9556s
	iters: 400, epoch: 7 | loss: 0.0094990
	speed: 0.0167s/iter; left time: 727.8921s
Epoch: 7 cost time: 8.73637843132019
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0037962
	speed: 0.0843s/iter; left time: 3668.9406s
	iters: 200, epoch: 8 | loss: 0.2072830
	speed: 0.0171s/iter; left time: 742.4522s
	iters: 300, epoch: 8 | loss: 0.0943896
	speed: 0.0176s/iter; left time: 761.9877s
	iters: 400, epoch: 8 | loss: 0.0040690
	speed: 0.0183s/iter; left time: 790.1943s
Epoch: 8 cost time: 9.07619309425354
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0029694
	speed: 0.1165s/iter; left time: 5016.7816s
	iters: 200, epoch: 9 | loss: 0.0018868
	speed: 0.0229s/iter; left time: 983.3102s
	iters: 300, epoch: 9 | loss: 0.1930267
	speed: 0.0218s/iter; left time: 933.8031s
	iters: 400, epoch: 9 | loss: 0.0022247
	speed: 0.0206s/iter; left time: 879.0411s
Epoch: 9 cost time: 10.50146198272705
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0228898
	speed: 0.1057s/iter; left time: 4501.7280s
	iters: 200, epoch: 10 | loss: 0.1006115
	speed: 0.0224s/iter; left time: 952.4308s
	iters: 300, epoch: 10 | loss: 0.0694066
	speed: 0.0221s/iter; left time: 936.3558s
	iters: 400, epoch: 10 | loss: 0.0015887
	speed: 0.0222s/iter; left time: 936.7617s
Epoch: 10 cost time: 10.414269208908081
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0210350
	speed: 0.0836s/iter; left time: 3519.4801s
	iters: 200, epoch: 11 | loss: 0.0014363
	speed: 0.0189s/iter; left time: 793.4980s
	iters: 300, epoch: 11 | loss: 0.0088732
	speed: 0.0211s/iter; left time: 885.2871s
	iters: 400, epoch: 11 | loss: 0.0585433
	speed: 0.0173s/iter; left time: 723.7975s
Epoch: 11 cost time: 9.246712923049927
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0365147
	speed: 0.0751s/iter; left time: 3126.5472s
	iters: 200, epoch: 12 | loss: 0.0152330
	speed: 0.0181s/iter; left time: 753.6405s
	iters: 300, epoch: 12 | loss: 0.0009752
	speed: 0.0189s/iter; left time: 783.2920s
	iters: 400, epoch: 12 | loss: 0.0234760
	speed: 0.0223s/iter; left time: 920.6614s
Epoch: 12 cost time: 9.937925338745117
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.965407 --> -0.968552).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0861466
	speed: 0.1175s/iter; left time: 4838.6951s
	iters: 200, epoch: 13 | loss: 0.0235558
	speed: 0.0201s/iter; left time: 825.1584s
	iters: 300, epoch: 13 | loss: 0.0551693
	speed: 0.0203s/iter; left time: 829.8036s
	iters: 400, epoch: 13 | loss: 0.0292501
	speed: 0.0184s/iter; left time: 750.4675s
Epoch: 13 cost time: 9.816914319992065
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0025147
	speed: 0.0808s/iter; left time: 3289.0313s
	iters: 200, epoch: 14 | loss: 0.0198759
	speed: 0.0169s/iter; left time: 684.2860s
	iters: 300, epoch: 14 | loss: 0.0025534
	speed: 0.0173s/iter; left time: 700.3976s
	iters: 400, epoch: 14 | loss: 0.0055326
	speed: 0.0191s/iter; left time: 771.5677s
Epoch: 14 cost time: 8.6996431350708
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006870
	speed: 0.1051s/iter; left time: 4228.5610s
	iters: 200, epoch: 15 | loss: 0.0902558
	speed: 0.0191s/iter; left time: 765.9998s
	iters: 300, epoch: 15 | loss: 0.0020663
	speed: 0.0189s/iter; left time: 755.3729s
	iters: 400, epoch: 15 | loss: 0.5381017
	speed: 0.0211s/iter; left time: 842.6035s
Epoch: 15 cost time: 9.850839376449585
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.968552 --> -0.974556).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0027475
	speed: 0.1116s/iter; left time: 4438.7708s
	iters: 200, epoch: 16 | loss: 0.0014905
	speed: 0.0184s/iter; left time: 728.9511s
	iters: 300, epoch: 16 | loss: 0.0048838
	speed: 0.0192s/iter; left time: 760.9733s
	iters: 400, epoch: 16 | loss: 0.1848108
	speed: 0.0183s/iter; left time: 721.5829s
Epoch: 16 cost time: 9.00683879852295
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0010137
	speed: 0.0765s/iter; left time: 3006.4811s
	iters: 200, epoch: 17 | loss: 0.0008465
	speed: 0.0200s/iter; left time: 785.2369s
	iters: 300, epoch: 17 | loss: 0.3432668
	speed: 0.0208s/iter; left time: 814.4684s
	iters: 400, epoch: 17 | loss: 0.0005833
	speed: 0.0205s/iter; left time: 800.1002s
Epoch: 17 cost time: 9.899409055709839
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0015458
	speed: 0.1151s/iter; left time: 4469.6761s
	iters: 200, epoch: 18 | loss: 0.0028079
	speed: 0.0195s/iter; left time: 754.8656s
	iters: 300, epoch: 18 | loss: 0.0100826
	speed: 0.0191s/iter; left time: 736.3015s
	iters: 400, epoch: 18 | loss: 0.0068513
	speed: 0.0212s/iter; left time: 817.8345s
Epoch: 18 cost time: 9.828097105026245
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0095303
	speed: 0.1069s/iter; left time: 4101.7606s
	iters: 200, epoch: 19 | loss: 0.0029870
	speed: 0.0195s/iter; left time: 746.3751s
	iters: 300, epoch: 19 | loss: 0.0395070
	speed: 0.0184s/iter; left time: 700.6871s
	iters: 400, epoch: 19 | loss: 0.0253946
	speed: 0.0184s/iter; left time: 699.2500s
Epoch: 19 cost time: 9.413267850875854
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0288893
	speed: 0.0956s/iter; left time: 3622.5525s
	iters: 200, epoch: 20 | loss: 0.0016179
	speed: 0.0160s/iter; left time: 604.7841s
	iters: 300, epoch: 20 | loss: 0.0066446
	speed: 0.0204s/iter; left time: 767.2466s
	iters: 400, epoch: 20 | loss: 0.0000970
	speed: 0.0207s/iter; left time: 779.3774s
Epoch: 20 cost time: 9.330951452255249
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0008954
	speed: 0.1213s/iter; left time: 4539.1243s
	iters: 200, epoch: 21 | loss: 0.4585687
	speed: 0.0218s/iter; left time: 815.4618s
	iters: 300, epoch: 21 | loss: 0.0049575
	speed: 0.0228s/iter; left time: 847.5192s
	iters: 400, epoch: 21 | loss: 0.0005496
	speed: 0.0213s/iter; left time: 790.5475s
Epoch: 21 cost time: 10.724181652069092
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0005566
	speed: 0.1235s/iter; left time: 4562.5437s
	iters: 200, epoch: 22 | loss: 0.0023082
	speed: 0.0175s/iter; left time: 643.4203s
	iters: 300, epoch: 22 | loss: 0.0005893
	speed: 0.0173s/iter; left time: 636.7329s
	iters: 400, epoch: 22 | loss: 0.0033123
	speed: 0.0185s/iter; left time: 677.0108s
Epoch: 22 cost time: 9.00237226486206
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.976557).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0011276
	speed: 0.0896s/iter; left time: 3270.4061s
	iters: 200, epoch: 23 | loss: 0.0007658
	speed: 0.0200s/iter; left time: 726.2941s
	iters: 300, epoch: 23 | loss: 0.0004979
	speed: 0.0186s/iter; left time: 676.0773s
	iters: 400, epoch: 23 | loss: 0.0014871
	speed: 0.0205s/iter; left time: 740.4364s
Epoch: 23 cost time: 9.67173981666565
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1251687
	speed: 0.1150s/iter; left time: 4140.4343s
	iters: 200, epoch: 24 | loss: 0.0009184
	speed: 0.0210s/iter; left time: 754.2512s
	iters: 300, epoch: 24 | loss: 0.0025329
	speed: 0.0180s/iter; left time: 644.2344s
	iters: 400, epoch: 24 | loss: 0.0000512
	speed: 0.0187s/iter; left time: 666.3831s
Epoch: 24 cost time: 9.575834512710571
Epoch: 24, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1721982
	speed: 0.1244s/iter; left time: 4421.4396s
	iters: 200, epoch: 25 | loss: 0.0007344
	speed: 0.0209s/iter; left time: 739.5470s
	iters: 300, epoch: 25 | loss: 0.0046653
	speed: 0.0173s/iter; left time: 612.0178s
	iters: 400, epoch: 25 | loss: 0.0162613
	speed: 0.0188s/iter; left time: 663.6745s
Epoch: 25 cost time: 9.62761640548706
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0008662
	speed: 0.0995s/iter; left time: 3488.8340s
	iters: 200, epoch: 26 | loss: 0.0022275
	speed: 0.0186s/iter; left time: 650.0638s
	iters: 300, epoch: 26 | loss: 0.0100941
	speed: 0.0202s/iter; left time: 703.6942s
	iters: 400, epoch: 26 | loss: 0.0007031
	speed: 0.0192s/iter; left time: 668.1286s
Epoch: 26 cost time: 9.285212755203247
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0007463
	speed: 0.0978s/iter; left time: 3383.8077s
	iters: 200, epoch: 27 | loss: 0.0216504
	speed: 0.0203s/iter; left time: 701.2113s
	iters: 300, epoch: 27 | loss: 0.0001022
	speed: 0.0212s/iter; left time: 729.7855s
	iters: 400, epoch: 27 | loss: 0.0882175
	speed: 0.0197s/iter; left time: 676.2322s
Epoch: 27 cost time: 9.545770168304443
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0001728
	speed: 0.0785s/iter; left time: 2680.9054s
	iters: 200, epoch: 28 | loss: 0.0007125
	speed: 0.0180s/iter; left time: 612.7236s
	iters: 300, epoch: 28 | loss: 0.0003710
	speed: 0.0161s/iter; left time: 546.9118s
	iters: 400, epoch: 28 | loss: 0.0162933
	speed: 0.0174s/iter; left time: 587.3786s
Epoch: 28 cost time: 8.383148908615112
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0133901
	speed: 0.0840s/iter; left time: 2829.8651s
	iters: 200, epoch: 29 | loss: 0.1914175
	speed: 0.0164s/iter; left time: 549.2950s
	iters: 300, epoch: 29 | loss: 0.0026527
	speed: 0.0165s/iter; left time: 552.5881s
	iters: 400, epoch: 29 | loss: 0.0009798
	speed: 0.0163s/iter; left time: 544.5522s
Epoch: 29 cost time: 8.07270884513855
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0008248
	speed: 0.0993s/iter; left time: 3296.1662s
	iters: 200, epoch: 30 | loss: 0.0008548
	speed: 0.0195s/iter; left time: 644.2528s
	iters: 300, epoch: 30 | loss: 0.0007490
	speed: 0.0173s/iter; left time: 571.7263s
	iters: 400, epoch: 30 | loss: 0.0028817
	speed: 0.0167s/iter; left time: 549.2736s
Epoch: 30 cost time: 8.85827350616455
Epoch: 30, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0008492
	speed: 0.0906s/iter; left time: 2967.0428s
	iters: 200, epoch: 31 | loss: 0.0006324
	speed: 0.0173s/iter; left time: 563.4480s
	iters: 300, epoch: 31 | loss: 0.0040092
	speed: 0.0177s/iter; left time: 575.5135s
	iters: 400, epoch: 31 | loss: 0.0084987
	speed: 0.0201s/iter; left time: 652.4387s
Epoch: 31 cost time: 9.205307722091675
Epoch: 31, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0312940
	speed: 0.1097s/iter; left time: 3539.4436s
	iters: 200, epoch: 32 | loss: 0.0019831
	speed: 0.0207s/iter; left time: 664.7886s
	iters: 300, epoch: 32 | loss: 0.0005025
	speed: 0.0193s/iter; left time: 618.8956s
	iters: 400, epoch: 32 | loss: 0.0000531
	speed: 0.0203s/iter; left time: 649.5658s
Epoch: 32 cost time: 9.676028966903687
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 103906
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7435973
	speed: 0.0398s/iter; left time: 1860.9982s
	iters: 200, epoch: 1 | loss: 1.1858358
	speed: 0.0212s/iter; left time: 991.5274s
	iters: 300, epoch: 1 | loss: 0.6343137
	speed: 0.0218s/iter; left time: 1017.8076s
	iters: 400, epoch: 1 | loss: 0.8300699
	speed: 0.0205s/iter; left time: 954.8779s
Epoch: 1 cost time: 11.831530094146729
Epoch: 1, Steps: 469 | Train Loss: 1.161 Vali Loss: 0.539 Vali Acc: 0.829 Test Loss: 0.539 Test Acc: 0.829
Validation loss decreased (inf --> -0.829326).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3958425
	speed: 0.1022s/iter; left time: 4733.8540s
	iters: 200, epoch: 2 | loss: 0.3280372
	speed: 0.0166s/iter; left time: 765.4530s
	iters: 300, epoch: 2 | loss: 0.1180019
	speed: 0.0173s/iter; left time: 799.2973s
	iters: 400, epoch: 2 | loss: 0.2739493
	speed: 0.0177s/iter; left time: 816.5431s
Epoch: 2 cost time: 8.713512420654297
Epoch: 2, Steps: 469 | Train Loss: 0.289 Vali Loss: 0.300 Vali Acc: 0.908 Test Loss: 0.300 Test Acc: 0.908
Validation loss decreased (-0.829326 --> -0.908230).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0841331
	speed: 0.1032s/iter; left time: 4734.2035s
	iters: 200, epoch: 3 | loss: 0.3188995
	speed: 0.0204s/iter; left time: 935.0955s
	iters: 300, epoch: 3 | loss: 0.2032993
	speed: 0.0197s/iter; left time: 897.3746s
	iters: 400, epoch: 3 | loss: 0.2985227
	speed: 0.0205s/iter; left time: 931.9335s
Epoch: 3 cost time: 9.798356056213379
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.908230 --> -0.956545).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0238881
	speed: 0.0994s/iter; left time: 4510.4754s
	iters: 200, epoch: 4 | loss: 0.0309196
	speed: 0.0205s/iter; left time: 929.2031s
	iters: 300, epoch: 4 | loss: 0.0950752
	speed: 0.0204s/iter; left time: 921.1888s
	iters: 400, epoch: 4 | loss: 0.0159396
	speed: 0.0173s/iter; left time: 780.7367s
Epoch: 4 cost time: 9.613423824310303
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0688879
	speed: 0.0858s/iter; left time: 3855.4071s
	iters: 200, epoch: 5 | loss: 0.0066857
	speed: 0.0202s/iter; left time: 907.5011s
	iters: 300, epoch: 5 | loss: 0.0264367
	speed: 0.0182s/iter; left time: 812.6125s
	iters: 400, epoch: 5 | loss: 0.2030101
	speed: 0.0180s/iter; left time: 802.4786s
Epoch: 5 cost time: 9.304436445236206
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0257650
	speed: 0.1142s/iter; left time: 5077.0007s
	iters: 200, epoch: 6 | loss: 0.0720643
	speed: 0.0222s/iter; left time: 984.2373s
	iters: 300, epoch: 6 | loss: 0.0017245
	speed: 0.0258s/iter; left time: 1142.5837s
	iters: 400, epoch: 6 | loss: 0.0336402
	speed: 0.0245s/iter; left time: 1082.6037s
Epoch: 6 cost time: 11.517584085464478
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0416702
	speed: 0.1144s/iter; left time: 5031.5696s
	iters: 200, epoch: 7 | loss: 0.0250663
	speed: 0.0211s/iter; left time: 925.4217s
	iters: 300, epoch: 7 | loss: 0.0288588
	speed: 0.0226s/iter; left time: 989.5760s
	iters: 400, epoch: 7 | loss: 0.0687060
	speed: 0.0208s/iter; left time: 908.1579s
Epoch: 7 cost time: 10.625345230102539
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0018361
	speed: 0.1000s/iter; left time: 4352.4418s
	iters: 200, epoch: 8 | loss: 0.0052679
	speed: 0.0203s/iter; left time: 880.7068s
	iters: 300, epoch: 8 | loss: 0.0233014
	speed: 0.0207s/iter; left time: 896.4948s
	iters: 400, epoch: 8 | loss: 0.2586523
	speed: 0.0211s/iter; left time: 909.8899s
Epoch: 8 cost time: 10.214677095413208
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0048530
	speed: 0.0915s/iter; left time: 3940.1334s
	iters: 200, epoch: 9 | loss: 0.0090745
	speed: 0.0196s/iter; left time: 839.7330s
	iters: 300, epoch: 9 | loss: 0.1162579
	speed: 0.0202s/iter; left time: 866.9853s
	iters: 400, epoch: 9 | loss: 0.0115943
	speed: 0.0211s/iter; left time: 901.6100s
Epoch: 9 cost time: 9.548089981079102
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
Validation loss decreased (-0.956545 --> -0.959976).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0048081
	speed: 0.0998s/iter; left time: 4251.1481s
	iters: 200, epoch: 10 | loss: 0.0051008
	speed: 0.0202s/iter; left time: 857.0744s
	iters: 300, epoch: 10 | loss: 0.0534684
	speed: 0.0208s/iter; left time: 882.2000s
	iters: 400, epoch: 10 | loss: 0.0136333
	speed: 0.0220s/iter; left time: 928.1287s
Epoch: 10 cost time: 10.051379442214966
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0170359
	speed: 0.1001s/iter; left time: 4213.9914s
	iters: 200, epoch: 11 | loss: 0.0042525
	speed: 0.0207s/iter; left time: 869.9769s
	iters: 300, epoch: 11 | loss: 0.0362328
	speed: 0.0198s/iter; left time: 830.3280s
	iters: 400, epoch: 11 | loss: 0.0052384
	speed: 0.0175s/iter; left time: 733.1970s
Epoch: 11 cost time: 10.031141757965088
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.959976 --> -0.974842).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0013921
	speed: 0.1131s/iter; left time: 4709.8556s
	iters: 200, epoch: 12 | loss: 0.5491481
	speed: 0.0243s/iter; left time: 1009.7639s
	iters: 300, epoch: 12 | loss: 0.0078415
	speed: 0.0226s/iter; left time: 937.4533s
	iters: 400, epoch: 12 | loss: 0.0141459
	speed: 0.0216s/iter; left time: 892.5841s
Epoch: 12 cost time: 11.253664493560791
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0009893
	speed: 0.1247s/iter; left time: 5132.2206s
	iters: 200, epoch: 13 | loss: 0.0240154
	speed: 0.0250s/iter; left time: 1024.9582s
	iters: 300, epoch: 13 | loss: 0.0340652
	speed: 0.0238s/iter; left time: 973.1372s
	iters: 400, epoch: 13 | loss: 0.0039147
	speed: 0.0218s/iter; left time: 889.3813s
Epoch: 13 cost time: 11.623843431472778
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0085159
	speed: 0.1259s/iter; left time: 5125.9362s
	iters: 200, epoch: 14 | loss: 0.0264794
	speed: 0.0201s/iter; left time: 815.9419s
	iters: 300, epoch: 14 | loss: 0.0037137
	speed: 0.0208s/iter; left time: 843.0284s
	iters: 400, epoch: 14 | loss: 0.0056734
	speed: 0.0198s/iter; left time: 798.1864s
Epoch: 14 cost time: 9.810586214065552
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0064572
	speed: 0.0825s/iter; left time: 3318.4413s
	iters: 200, epoch: 15 | loss: 0.0006029
	speed: 0.0202s/iter; left time: 812.1190s
	iters: 300, epoch: 15 | loss: 0.0032041
	speed: 0.0205s/iter; left time: 819.3591s
	iters: 400, epoch: 15 | loss: 0.0045534
	speed: 0.0218s/iter; left time: 870.0063s
Epoch: 15 cost time: 10.00028681755066
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0058469
	speed: 0.1051s/iter; left time: 4179.4446s
	iters: 200, epoch: 16 | loss: 0.0005024
	speed: 0.0204s/iter; left time: 808.5409s
	iters: 300, epoch: 16 | loss: 0.0003797
	speed: 0.0199s/iter; left time: 788.0849s
	iters: 400, epoch: 16 | loss: 0.0664839
	speed: 0.0211s/iter; left time: 831.6815s
Epoch: 16 cost time: 9.91257929801941
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0482774
	speed: 0.0885s/iter; left time: 3478.6496s
	iters: 200, epoch: 17 | loss: 0.4512448
	speed: 0.0168s/iter; left time: 659.9401s
	iters: 300, epoch: 17 | loss: 0.1013536
	speed: 0.0168s/iter; left time: 655.9179s
	iters: 400, epoch: 17 | loss: 0.0009761
	speed: 0.0164s/iter; left time: 638.1408s
Epoch: 17 cost time: 8.212623834609985
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0086668
	speed: 0.1163s/iter; left time: 4514.8029s
	iters: 200, epoch: 18 | loss: 0.0094022
	speed: 0.0217s/iter; left time: 838.5129s
	iters: 300, epoch: 18 | loss: 0.0072099
	speed: 0.0214s/iter; left time: 825.1709s
	iters: 400, epoch: 18 | loss: 0.0113896
	speed: 0.0221s/iter; left time: 852.2910s
Epoch: 18 cost time: 10.779170751571655
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.976843).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0007603
	speed: 0.1137s/iter; left time: 4360.2856s
	iters: 200, epoch: 19 | loss: 0.0023392
	speed: 0.0215s/iter; left time: 823.2935s
	iters: 300, epoch: 19 | loss: 0.0223530
	speed: 0.0201s/iter; left time: 765.9102s
	iters: 400, epoch: 19 | loss: 0.1492063
	speed: 0.0192s/iter; left time: 731.5469s
Epoch: 19 cost time: 9.939592838287354
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.980845).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0050365
	speed: 0.0895s/iter; left time: 3389.4384s
	iters: 200, epoch: 20 | loss: 0.0009379
	speed: 0.0205s/iter; left time: 773.4851s
	iters: 300, epoch: 20 | loss: 0.0003662
	speed: 0.0207s/iter; left time: 782.0457s
	iters: 400, epoch: 20 | loss: 0.1454373
	speed: 0.0188s/iter; left time: 708.1861s
Epoch: 20 cost time: 9.729499101638794
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1589634
	speed: 0.1021s/iter; left time: 3819.1315s
	iters: 200, epoch: 21 | loss: 0.0003237
	speed: 0.0209s/iter; left time: 781.2091s
	iters: 300, epoch: 21 | loss: 0.0315769
	speed: 0.0214s/iter; left time: 795.0561s
	iters: 400, epoch: 21 | loss: 0.0032206
	speed: 0.0211s/iter; left time: 782.9671s
Epoch: 21 cost time: 10.149649381637573
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0010223
	speed: 0.0914s/iter; left time: 3377.4814s
	iters: 200, epoch: 22 | loss: 0.0163768
	speed: 0.0248s/iter; left time: 912.2688s
	iters: 300, epoch: 22 | loss: 0.0030682
	speed: 0.0201s/iter; left time: 740.4488s
	iters: 400, epoch: 22 | loss: 0.0006894
	speed: 0.0186s/iter; left time: 681.7155s
Epoch: 22 cost time: 9.97326111793518
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0031619
	speed: 0.0827s/iter; left time: 3017.7400s
	iters: 200, epoch: 23 | loss: 0.0040724
	speed: 0.0167s/iter; left time: 608.1073s
	iters: 300, epoch: 23 | loss: 0.0010326
	speed: 0.0183s/iter; left time: 662.6176s
	iters: 400, epoch: 23 | loss: 0.0062983
	speed: 0.0180s/iter; left time: 651.7626s
Epoch: 23 cost time: 8.722687482833862
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0024874
	speed: 0.1068s/iter; left time: 3846.4444s
	iters: 200, epoch: 24 | loss: 0.0005720
	speed: 0.0200s/iter; left time: 719.8590s
	iters: 300, epoch: 24 | loss: 0.0153109
	speed: 0.0201s/iter; left time: 720.0801s
	iters: 400, epoch: 24 | loss: 0.0023135
	speed: 0.0196s/iter; left time: 698.7806s
Epoch: 24 cost time: 10.130146026611328
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0048435
	speed: 0.1356s/iter; left time: 4821.5013s
	iters: 200, epoch: 25 | loss: 0.0018877
	speed: 0.0237s/iter; left time: 839.0243s
	iters: 300, epoch: 25 | loss: 0.0004281
	speed: 0.0225s/iter; left time: 795.9019s
	iters: 400, epoch: 25 | loss: 0.0004997
	speed: 0.0208s/iter; left time: 733.5725s
Epoch: 25 cost time: 11.27422046661377
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0005880
	speed: 0.1099s/iter; left time: 3856.2509s
	iters: 200, epoch: 26 | loss: 0.0016926
	speed: 0.0194s/iter; left time: 677.4745s
	iters: 300, epoch: 26 | loss: 0.0006363
	speed: 0.0190s/iter; left time: 663.1970s
	iters: 400, epoch: 26 | loss: 0.0118099
	speed: 0.0229s/iter; left time: 795.5071s
Epoch: 26 cost time: 10.16744613647461
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0011383
	speed: 0.1314s/iter; left time: 4546.7464s
	iters: 200, epoch: 27 | loss: 0.0040993
	speed: 0.0193s/iter; left time: 666.7752s
	iters: 300, epoch: 27 | loss: 0.0012846
	speed: 0.0195s/iter; left time: 672.3194s
	iters: 400, epoch: 27 | loss: 0.0014671
	speed: 0.0209s/iter; left time: 717.1826s
Epoch: 27 cost time: 10.315506935119629
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0012091
	speed: 0.1030s/iter; left time: 3515.4612s
	iters: 200, epoch: 28 | loss: 0.0448890
	speed: 0.0193s/iter; left time: 655.2431s
	iters: 300, epoch: 28 | loss: 0.0070293
	speed: 0.0213s/iter; left time: 723.6976s
	iters: 400, epoch: 28 | loss: 0.0000791
	speed: 0.0196s/iter; left time: 661.9681s
Epoch: 28 cost time: 9.70272183418274
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0602171
	speed: 0.0872s/iter; left time: 2937.5779s
	iters: 200, epoch: 29 | loss: 0.0010063
	speed: 0.0182s/iter; left time: 609.8890s
	iters: 300, epoch: 29 | loss: 0.0007230
	speed: 0.0181s/iter; left time: 606.7352s
	iters: 400, epoch: 29 | loss: 0.0024187
	speed: 0.0187s/iter; left time: 623.5068s
Epoch: 29 cost time: 9.0150306224823
Epoch: 29, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 103874
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7175679
	speed: 0.0292s/iter; left time: 1366.2179s
	iters: 200, epoch: 1 | loss: 1.2724818
	speed: 0.0197s/iter; left time: 918.6193s
	iters: 300, epoch: 1 | loss: 0.5806585
	speed: 0.0198s/iter; left time: 922.7061s
	iters: 400, epoch: 1 | loss: 0.9766899
	speed: 0.0221s/iter; left time: 1025.9756s
Epoch: 1 cost time: 10.52092957496643
Epoch: 1, Steps: 469 | Train Loss: 1.173 Vali Loss: 0.521 Vali Acc: 0.862 Test Loss: 0.521 Test Acc: 0.862
Validation loss decreased (inf --> -0.862488).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7004667
	speed: 0.0909s/iter; left time: 4210.3442s
	iters: 200, epoch: 2 | loss: 0.2898020
	speed: 0.0209s/iter; left time: 967.3059s
	iters: 300, epoch: 2 | loss: 0.1413565
	speed: 0.0185s/iter; left time: 852.5596s
	iters: 400, epoch: 2 | loss: 0.0992872
	speed: 0.0173s/iter; left time: 796.8932s
Epoch: 2 cost time: 9.308753490447998
Epoch: 2, Steps: 469 | Train Loss: 0.289 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
Validation loss decreased (-0.862488 --> -0.899082).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0747385
	speed: 0.1006s/iter; left time: 4613.4557s
	iters: 200, epoch: 3 | loss: 0.2569086
	speed: 0.0205s/iter; left time: 936.9697s
	iters: 300, epoch: 3 | loss: 0.0805430
	speed: 0.0184s/iter; left time: 842.1610s
	iters: 400, epoch: 3 | loss: 0.0765267
	speed: 0.0170s/iter; left time: 773.2681s
Epoch: 3 cost time: 9.058112859725952
Epoch: 3, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.899082 --> -0.949398).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1595601
	speed: 0.0997s/iter; left time: 4525.8401s
	iters: 200, epoch: 4 | loss: 0.1518400
	speed: 0.0219s/iter; left time: 992.8885s
	iters: 300, epoch: 4 | loss: 0.0212864
	speed: 0.0201s/iter; left time: 906.6275s
	iters: 400, epoch: 4 | loss: 0.1223469
	speed: 0.0180s/iter; left time: 810.7101s
Epoch: 4 cost time: 9.873871326446533
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.949398 --> -0.956259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0456630
	speed: 0.1211s/iter; left time: 5441.8688s
	iters: 200, epoch: 5 | loss: 0.1033714
	speed: 0.0210s/iter; left time: 941.6460s
	iters: 300, epoch: 5 | loss: 0.0356211
	speed: 0.0217s/iter; left time: 969.8730s
	iters: 400, epoch: 5 | loss: 0.0877706
	speed: 0.0214s/iter; left time: 955.0095s
Epoch: 5 cost time: 10.655538558959961
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.956259 --> -0.957689).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0309024
	speed: 0.0910s/iter; left time: 4046.9532s
	iters: 200, epoch: 6 | loss: 0.0406715
	speed: 0.0167s/iter; left time: 740.3803s
	iters: 300, epoch: 6 | loss: 0.0092073
	speed: 0.0171s/iter; left time: 756.0738s
	iters: 400, epoch: 6 | loss: 0.2000255
	speed: 0.0182s/iter; left time: 802.8194s
Epoch: 6 cost time: 8.3892662525177
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0130510
	speed: 0.0812s/iter; left time: 3571.7880s
	iters: 200, epoch: 7 | loss: 0.0024059
	speed: 0.0198s/iter; left time: 870.7966s
	iters: 300, epoch: 7 | loss: 0.0351458
	speed: 0.0197s/iter; left time: 864.1137s
	iters: 400, epoch: 7 | loss: 0.0220269
	speed: 0.0212s/iter; left time: 927.5091s
Epoch: 7 cost time: 9.95344066619873
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.957689 --> -0.962835).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0035496
	speed: 0.1025s/iter; left time: 4460.2362s
	iters: 200, epoch: 8 | loss: 0.0022077
	speed: 0.0182s/iter; left time: 788.8001s
	iters: 300, epoch: 8 | loss: 0.0272936
	speed: 0.0180s/iter; left time: 780.6037s
	iters: 400, epoch: 8 | loss: 0.0021099
	speed: 0.0193s/iter; left time: 832.2113s
Epoch: 8 cost time: 9.152577877044678
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0022836
	speed: 0.0991s/iter; left time: 4266.8903s
	iters: 200, epoch: 9 | loss: 0.0031195
	speed: 0.0185s/iter; left time: 792.7856s
	iters: 300, epoch: 9 | loss: 0.0107911
	speed: 0.0188s/iter; left time: 805.8131s
	iters: 400, epoch: 9 | loss: 0.0040532
	speed: 0.0178s/iter; left time: 762.8122s
Epoch: 9 cost time: 9.021803617477417
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0048630
	speed: 0.1092s/iter; left time: 4650.0179s
	iters: 200, epoch: 10 | loss: 0.0053511
	speed: 0.0181s/iter; left time: 767.0014s
	iters: 300, epoch: 10 | loss: 0.0026742
	speed: 0.0189s/iter; left time: 800.5327s
	iters: 400, epoch: 10 | loss: 0.1637616
	speed: 0.0184s/iter; left time: 776.6574s
Epoch: 10 cost time: 9.219560623168945
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.962835 --> -0.970554).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0023772
	speed: 0.1033s/iter; left time: 4348.8232s
	iters: 200, epoch: 11 | loss: 0.0086123
	speed: 0.0197s/iter; left time: 825.8628s
	iters: 300, epoch: 11 | loss: 0.0139377
	speed: 0.0194s/iter; left time: 811.3226s
	iters: 400, epoch: 11 | loss: 0.0080684
	speed: 0.0175s/iter; left time: 732.0624s
Epoch: 11 cost time: 9.146638631820679
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.970554 --> -0.973698).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0050090
	speed: 0.0871s/iter; left time: 3628.2266s
	iters: 200, epoch: 12 | loss: 0.0899708
	speed: 0.0200s/iter; left time: 831.5245s
	iters: 300, epoch: 12 | loss: 0.0081966
	speed: 0.0192s/iter; left time: 794.5056s
	iters: 400, epoch: 12 | loss: 0.1826489
	speed: 0.0171s/iter; left time: 708.6326s
Epoch: 12 cost time: 9.134839534759521
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0017761
	speed: 0.0861s/iter; left time: 3544.5464s
	iters: 200, epoch: 13 | loss: 0.1880144
	speed: 0.0188s/iter; left time: 770.8581s
	iters: 300, epoch: 13 | loss: 0.0038494
	speed: 0.0191s/iter; left time: 781.0768s
	iters: 400, epoch: 13 | loss: 0.0024276
	speed: 0.0171s/iter; left time: 697.4150s
Epoch: 13 cost time: 8.794448137283325
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0009094
	speed: 0.0995s/iter; left time: 4051.0558s
	iters: 200, epoch: 14 | loss: 0.0028128
	speed: 0.0174s/iter; left time: 705.8894s
	iters: 300, epoch: 14 | loss: 0.0291677
	speed: 0.0166s/iter; left time: 670.8652s
	iters: 400, epoch: 14 | loss: 0.0766722
	speed: 0.0157s/iter; left time: 633.3617s
Epoch: 14 cost time: 8.413315296173096
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0104685
	speed: 0.0810s/iter; left time: 3257.3514s
	iters: 200, epoch: 15 | loss: 0.0011760
	speed: 0.0166s/iter; left time: 667.9809s
	iters: 300, epoch: 15 | loss: 0.3144749
	speed: 0.0161s/iter; left time: 645.3245s
	iters: 400, epoch: 15 | loss: 0.0023785
	speed: 0.0166s/iter; left time: 663.4408s
Epoch: 15 cost time: 8.036009550094604
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0029541
	speed: 0.0964s/iter; left time: 3833.2301s
	iters: 200, epoch: 16 | loss: 0.2077162
	speed: 0.0208s/iter; left time: 824.1855s
	iters: 300, epoch: 16 | loss: 0.0027553
	speed: 0.0201s/iter; left time: 796.7088s
	iters: 400, epoch: 16 | loss: 0.0028935
	speed: 0.0201s/iter; left time: 792.2502s
Epoch: 16 cost time: 10.017487049102783
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0004864
	speed: 0.1144s/iter; left time: 4494.1048s
	iters: 200, epoch: 17 | loss: 0.0007736
	speed: 0.0191s/iter; left time: 749.6839s
	iters: 300, epoch: 17 | loss: 0.0281774
	speed: 0.0182s/iter; left time: 711.1061s
	iters: 400, epoch: 17 | loss: 0.0003203
	speed: 0.0194s/iter; left time: 755.9607s
Epoch: 17 cost time: 9.618779420852661
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0029919
	speed: 0.0934s/iter; left time: 3626.2493s
	iters: 200, epoch: 18 | loss: 0.0635348
	speed: 0.0172s/iter; left time: 667.9202s
	iters: 300, epoch: 18 | loss: 0.0372673
	speed: 0.0201s/iter; left time: 774.5004s
	iters: 400, epoch: 18 | loss: 0.0005829
	speed: 0.0218s/iter; left time: 840.2178s
Epoch: 18 cost time: 9.539863109588623
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002714
	speed: 0.1129s/iter; left time: 4331.7651s
	iters: 200, epoch: 19 | loss: 0.0020823
	speed: 0.0209s/iter; left time: 800.8401s
	iters: 300, epoch: 19 | loss: 0.0017911
	speed: 0.0222s/iter; left time: 847.2767s
	iters: 400, epoch: 19 | loss: 0.0031697
	speed: 0.0228s/iter; left time: 866.0633s
Epoch: 19 cost time: 10.548048973083496
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0119790
	speed: 0.1052s/iter; left time: 3985.0356s
	iters: 200, epoch: 20 | loss: 0.0005811
	speed: 0.0221s/iter; left time: 833.6651s
	iters: 300, epoch: 20 | loss: 0.0008307
	speed: 0.0224s/iter; left time: 844.5467s
	iters: 400, epoch: 20 | loss: 0.0004860
	speed: 0.0218s/iter; left time: 817.8579s
Epoch: 20 cost time: 10.300979375839233
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0043306
	speed: 0.0911s/iter; left time: 3408.7597s
	iters: 200, epoch: 21 | loss: 0.0013717
	speed: 0.0188s/iter; left time: 702.4475s
	iters: 300, epoch: 21 | loss: 0.0003897
	speed: 0.0179s/iter; left time: 665.0825s
	iters: 400, epoch: 21 | loss: 0.0123484
	speed: 0.0166s/iter; left time: 615.0139s
Epoch: 21 cost time: 8.716713905334473
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9736992567181246
model parameter : 103842
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0627484
	speed: 0.0371s/iter; left time: 1737.0157s
	iters: 200, epoch: 1 | loss: 1.1946355
	speed: 0.0265s/iter; left time: 1239.2426s
	iters: 300, epoch: 1 | loss: 0.7989300
	speed: 0.0210s/iter; left time: 980.8246s
	iters: 400, epoch: 1 | loss: 0.5822411
	speed: 0.0199s/iter; left time: 926.7448s
Epoch: 1 cost time: 11.758310556411743
Epoch: 1, Steps: 469 | Train Loss: 1.227 Vali Loss: 0.487 Vali Acc: 0.852 Test Loss: 0.487 Test Acc: 0.852
Validation loss decreased (inf --> -0.851625).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2136612
	speed: 0.0761s/iter; left time: 3523.9183s
	iters: 200, epoch: 2 | loss: 0.4329640
	speed: 0.0198s/iter; left time: 915.6143s
	iters: 300, epoch: 2 | loss: 0.3532553
	speed: 0.0201s/iter; left time: 929.1830s
	iters: 400, epoch: 2 | loss: 0.2106781
	speed: 0.0193s/iter; left time: 889.8913s
Epoch: 2 cost time: 9.511258363723755
Epoch: 2, Steps: 469 | Train Loss: 0.289 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
Validation loss decreased (-0.851625 --> -0.915949).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3178874
	speed: 0.1267s/iter; left time: 5811.1869s
	iters: 200, epoch: 3 | loss: 0.0438176
	speed: 0.0203s/iter; left time: 927.9603s
	iters: 300, epoch: 3 | loss: 0.0695503
	speed: 0.0209s/iter; left time: 953.1124s
	iters: 400, epoch: 3 | loss: 0.3895431
	speed: 0.0202s/iter; left time: 919.3625s
Epoch: 3 cost time: 10.194721221923828
Epoch: 3, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.915949 --> -0.940821).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0372242
	speed: 0.1053s/iter; left time: 4778.0281s
	iters: 200, epoch: 4 | loss: 0.0579318
	speed: 0.0189s/iter; left time: 858.0779s
	iters: 300, epoch: 4 | loss: 0.0210065
	speed: 0.0185s/iter; left time: 836.8782s
	iters: 400, epoch: 4 | loss: 0.0892203
	speed: 0.0202s/iter; left time: 910.6107s
Epoch: 4 cost time: 9.622925043106079
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (-0.940821 --> -0.957689).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0673361
	speed: 0.1016s/iter; left time: 4565.1510s
	iters: 200, epoch: 5 | loss: 0.0176514
	speed: 0.0182s/iter; left time: 817.2445s
	iters: 300, epoch: 5 | loss: 0.0531674
	speed: 0.0175s/iter; left time: 783.6840s
	iters: 400, epoch: 5 | loss: 0.0412273
	speed: 0.0180s/iter; left time: 802.6221s
Epoch: 5 cost time: 8.814870834350586
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0937774
	speed: 0.1032s/iter; left time: 4585.9648s
	iters: 200, epoch: 6 | loss: 0.0158657
	speed: 0.0204s/iter; left time: 905.1993s
	iters: 300, epoch: 6 | loss: 0.1301425
	speed: 0.0203s/iter; left time: 899.6044s
	iters: 400, epoch: 6 | loss: 0.0118086
	speed: 0.0187s/iter; left time: 827.8244s
Epoch: 6 cost time: 9.899234056472778
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.957689 --> -0.965122).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0035457
	speed: 0.1086s/iter; left time: 4778.3842s
	iters: 200, epoch: 7 | loss: 0.2104741
	speed: 0.0181s/iter; left time: 795.6916s
	iters: 300, epoch: 7 | loss: 0.0093059
	speed: 0.0172s/iter; left time: 751.8677s
	iters: 400, epoch: 7 | loss: 0.0641129
	speed: 0.0184s/iter; left time: 805.9294s
Epoch: 7 cost time: 9.14557933807373
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.965122 --> -0.974842).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0293249
	speed: 0.0896s/iter; left time: 3898.6356s
	iters: 200, epoch: 8 | loss: 0.3495154
	speed: 0.0166s/iter; left time: 721.9174s
	iters: 300, epoch: 8 | loss: 0.0173519
	speed: 0.0191s/iter; left time: 827.5877s
	iters: 400, epoch: 8 | loss: 0.0421255
	speed: 0.0212s/iter; left time: 915.0032s
Epoch: 8 cost time: 9.441731452941895
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0123090
	speed: 0.1126s/iter; left time: 4845.4756s
	iters: 200, epoch: 9 | loss: 0.0483204
	speed: 0.0219s/iter; left time: 938.8056s
	iters: 300, epoch: 9 | loss: 0.0278881
	speed: 0.0226s/iter; left time: 967.2868s
	iters: 400, epoch: 9 | loss: 0.0239843
	speed: 0.0250s/iter; left time: 1067.8086s
Epoch: 9 cost time: 10.801666975021362
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0016916
	speed: 0.1012s/iter; left time: 4310.0042s
	iters: 200, epoch: 10 | loss: 0.0315914
	speed: 0.0196s/iter; left time: 832.4335s
	iters: 300, epoch: 10 | loss: 0.0305909
	speed: 0.0206s/iter; left time: 874.7977s
	iters: 400, epoch: 10 | loss: 0.0104897
	speed: 0.0191s/iter; left time: 806.9626s
Epoch: 10 cost time: 9.665292978286743
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.976843).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0025236
	speed: 0.0908s/iter; left time: 3822.1195s
	iters: 200, epoch: 11 | loss: 0.0615885
	speed: 0.0202s/iter; left time: 847.4724s
	iters: 300, epoch: 11 | loss: 0.0208728
	speed: 0.0186s/iter; left time: 778.0345s
	iters: 400, epoch: 11 | loss: 0.0601546
	speed: 0.0189s/iter; left time: 790.1302s
Epoch: 11 cost time: 9.472749710083008
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0080041
	speed: 0.0988s/iter; left time: 4112.4029s
	iters: 200, epoch: 12 | loss: 0.0069092
	speed: 0.0179s/iter; left time: 743.4186s
	iters: 300, epoch: 12 | loss: 0.0319497
	speed: 0.0168s/iter; left time: 697.4837s
	iters: 400, epoch: 12 | loss: 0.0033316
	speed: 0.0172s/iter; left time: 712.7045s
Epoch: 12 cost time: 8.736803770065308
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0091097
	speed: 0.0943s/iter; left time: 3883.7553s
	iters: 200, epoch: 13 | loss: 0.2528687
	speed: 0.0176s/iter; left time: 721.9658s
	iters: 300, epoch: 13 | loss: 0.0025853
	speed: 0.0157s/iter; left time: 643.6805s
	iters: 400, epoch: 13 | loss: 0.0109278
	speed: 0.0159s/iter; left time: 649.9937s
Epoch: 13 cost time: 8.321559190750122
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0008546
	speed: 0.0736s/iter; left time: 2996.8084s
	iters: 200, epoch: 14 | loss: 0.0011637
	speed: 0.0179s/iter; left time: 727.2560s
	iters: 300, epoch: 14 | loss: 0.0013671
	speed: 0.0175s/iter; left time: 707.9103s
	iters: 400, epoch: 14 | loss: 0.0143562
	speed: 0.0180s/iter; left time: 726.4265s
Epoch: 14 cost time: 8.670770645141602
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0373021
	speed: 0.0935s/iter; left time: 3760.0436s
	iters: 200, epoch: 15 | loss: 0.0285779
	speed: 0.0194s/iter; left time: 779.9285s
	iters: 300, epoch: 15 | loss: 0.0010801
	speed: 0.0191s/iter; left time: 764.1009s
	iters: 400, epoch: 15 | loss: 0.0059282
	speed: 0.0192s/iter; left time: 767.6460s
Epoch: 15 cost time: 9.414707899093628
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0047121
	speed: 0.0951s/iter; left time: 3780.7518s
	iters: 200, epoch: 16 | loss: 0.0034803
	speed: 0.0169s/iter; left time: 668.5949s
	iters: 300, epoch: 16 | loss: 0.0029421
	speed: 0.0160s/iter; left time: 633.3977s
	iters: 400, epoch: 16 | loss: 0.4630764
	speed: 0.0162s/iter; left time: 638.2796s
Epoch: 16 cost time: 8.084479570388794
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0008126
	speed: 0.0858s/iter; left time: 3370.0411s
	iters: 200, epoch: 17 | loss: 0.2192580
	speed: 0.0197s/iter; left time: 773.9356s
	iters: 300, epoch: 17 | loss: 0.0058024
	speed: 0.0206s/iter; left time: 806.0283s
	iters: 400, epoch: 17 | loss: 0.0025230
	speed: 0.0175s/iter; left time: 683.5565s
Epoch: 17 cost time: 9.28878116607666
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0010231
	speed: 0.1064s/iter; left time: 4133.1888s
	iters: 200, epoch: 18 | loss: 0.0008709
	speed: 0.0221s/iter; left time: 857.0800s
	iters: 300, epoch: 18 | loss: 0.0170011
	speed: 0.0207s/iter; left time: 801.4568s
	iters: 400, epoch: 18 | loss: 0.1131418
	speed: 0.0203s/iter; left time: 781.3975s
Epoch: 18 cost time: 10.375697374343872
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0034312
	speed: 0.1041s/iter; left time: 3992.5563s
	iters: 200, epoch: 19 | loss: 0.0563057
	speed: 0.0150s/iter; left time: 574.8859s
	iters: 300, epoch: 19 | loss: 0.0030241
	speed: 0.0171s/iter; left time: 653.0908s
	iters: 400, epoch: 19 | loss: 0.0007682
	speed: 0.0170s/iter; left time: 647.4751s
Epoch: 19 cost time: 8.450661897659302
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0203951
	speed: 0.0765s/iter; left time: 2896.8560s
	iters: 200, epoch: 20 | loss: 0.0772824
	speed: 0.0175s/iter; left time: 659.8312s
	iters: 300, epoch: 20 | loss: 0.0446456
	speed: 0.0162s/iter; left time: 609.4769s
	iters: 400, epoch: 20 | loss: 0.0045362
	speed: 0.0178s/iter; left time: 670.4961s
Epoch: 20 cost time: 8.59364938735962
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 103810
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1335988
	speed: 0.0409s/iter; left time: 1914.2516s
	iters: 200, epoch: 1 | loss: 1.2435696
	speed: 0.0219s/iter; left time: 1024.8213s
	iters: 300, epoch: 1 | loss: 0.7516714
	speed: 0.0178s/iter; left time: 830.0049s
	iters: 400, epoch: 1 | loss: 0.6865034
	speed: 0.0196s/iter; left time: 911.9980s
Epoch: 1 cost time: 11.397264242172241
Epoch: 1, Steps: 469 | Train Loss: 1.282 Vali Loss: 0.546 Vali Acc: 0.840 Test Loss: 0.546 Test Acc: 0.840
Validation loss decreased (inf --> -0.840475).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2875570
	speed: 0.0880s/iter; left time: 4078.1191s
	iters: 200, epoch: 2 | loss: 0.5519596
	speed: 0.0201s/iter; left time: 930.7520s
	iters: 300, epoch: 2 | loss: 0.5935928
	speed: 0.0175s/iter; left time: 805.7760s
	iters: 400, epoch: 2 | loss: 0.1283521
	speed: 0.0177s/iter; left time: 815.8676s
Epoch: 2 cost time: 9.041479110717773
Epoch: 2, Steps: 469 | Train Loss: 0.313 Vali Loss: 0.290 Vali Acc: 0.907 Test Loss: 0.290 Test Acc: 0.907
Validation loss decreased (-0.840475 --> -0.907087).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0529282
	speed: 0.1054s/iter; left time: 4835.2027s
	iters: 200, epoch: 3 | loss: 0.0445319
	speed: 0.0189s/iter; left time: 862.8871s
	iters: 300, epoch: 3 | loss: 0.1086736
	speed: 0.0203s/iter; left time: 929.1323s
	iters: 400, epoch: 3 | loss: 0.1414075
	speed: 0.0197s/iter; left time: 895.8047s
Epoch: 3 cost time: 9.651263952255249
Epoch: 3, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
Validation loss decreased (-0.907087 --> -0.934532).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0697011
	speed: 0.1006s/iter; left time: 4566.0600s
	iters: 200, epoch: 4 | loss: 0.0469344
	speed: 0.0191s/iter; left time: 865.9936s
	iters: 300, epoch: 4 | loss: 0.2503895
	speed: 0.0218s/iter; left time: 985.3558s
	iters: 400, epoch: 4 | loss: 0.0363884
	speed: 0.0210s/iter; left time: 948.9767s
Epoch: 4 cost time: 9.839426517486572
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.934532 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0557149
	speed: 0.1041s/iter; left time: 4675.7994s
	iters: 200, epoch: 5 | loss: 0.0056661
	speed: 0.0181s/iter; left time: 812.1808s
	iters: 300, epoch: 5 | loss: 0.0101057
	speed: 0.0162s/iter; left time: 724.7865s
	iters: 400, epoch: 5 | loss: 0.0790845
	speed: 0.0161s/iter; left time: 717.4040s
Epoch: 5 cost time: 8.459925174713135
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.963120 --> -0.963692).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0112603
	speed: 0.0868s/iter; left time: 3858.2078s
	iters: 200, epoch: 6 | loss: 0.0077684
	speed: 0.0200s/iter; left time: 888.5158s
	iters: 300, epoch: 6 | loss: 0.0893772
	speed: 0.0192s/iter; left time: 847.8785s
	iters: 400, epoch: 6 | loss: 0.0112724
	speed: 0.0181s/iter; left time: 798.5597s
Epoch: 6 cost time: 9.221420049667358
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0580111
	speed: 0.0907s/iter; left time: 3987.7953s
	iters: 200, epoch: 7 | loss: 0.0483861
	speed: 0.0210s/iter; left time: 922.8844s
	iters: 300, epoch: 7 | loss: 0.0058966
	speed: 0.0197s/iter; left time: 862.8175s
	iters: 400, epoch: 7 | loss: 0.0290456
	speed: 0.0183s/iter; left time: 800.1377s
Epoch: 7 cost time: 9.523277521133423
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.963692 --> -0.964836).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0736095
	speed: 0.0733s/iter; left time: 3190.8169s
	iters: 200, epoch: 8 | loss: 0.0083603
	speed: 0.0174s/iter; left time: 753.7107s
	iters: 300, epoch: 8 | loss: 0.0623450
	speed: 0.0185s/iter; left time: 800.5683s
	iters: 400, epoch: 8 | loss: 0.0504005
	speed: 0.0209s/iter; left time: 904.4420s
Epoch: 8 cost time: 9.12896203994751
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.964836 --> -0.970267).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0800784
	speed: 0.0983s/iter; left time: 4230.1756s
	iters: 200, epoch: 9 | loss: 0.0009073
	speed: 0.0201s/iter; left time: 862.8712s
	iters: 300, epoch: 9 | loss: 0.0034518
	speed: 0.0203s/iter; left time: 870.6166s
	iters: 400, epoch: 9 | loss: 0.0041227
	speed: 0.0213s/iter; left time: 909.2549s
Epoch: 9 cost time: 9.74647855758667
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.955 Test Loss: 0.205 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0107874
	speed: 0.0949s/iter; left time: 4042.0224s
	iters: 200, epoch: 10 | loss: 0.0017853
	speed: 0.0180s/iter; left time: 764.5434s
	iters: 300, epoch: 10 | loss: 0.0299875
	speed: 0.0170s/iter; left time: 719.5904s
	iters: 400, epoch: 10 | loss: 0.0117938
	speed: 0.0162s/iter; left time: 686.6763s
Epoch: 10 cost time: 8.48660659790039
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0109285
	speed: 0.0688s/iter; left time: 2895.4244s
	iters: 200, epoch: 11 | loss: 0.0031150
	speed: 0.0179s/iter; left time: 753.4286s
	iters: 300, epoch: 11 | loss: 0.0245317
	speed: 0.0192s/iter; left time: 805.4643s
	iters: 400, epoch: 11 | loss: 0.0854922
	speed: 0.0188s/iter; left time: 786.0530s
Epoch: 11 cost time: 9.012647151947021
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0047693
	speed: 0.1020s/iter; left time: 4248.3780s
	iters: 200, epoch: 12 | loss: 0.0057640
	speed: 0.0221s/iter; left time: 917.8071s
	iters: 300, epoch: 12 | loss: 0.0362555
	speed: 0.0222s/iter; left time: 918.8265s
	iters: 400, epoch: 12 | loss: 0.0084573
	speed: 0.0225s/iter; left time: 928.3632s
Epoch: 12 cost time: 10.62601637840271
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0309113
	speed: 0.1047s/iter; left time: 4310.4340s
	iters: 200, epoch: 13 | loss: 0.0459268
	speed: 0.0201s/iter; left time: 827.1363s
	iters: 300, epoch: 13 | loss: 0.0159586
	speed: 0.0211s/iter; left time: 864.6950s
	iters: 400, epoch: 13 | loss: 0.0138992
	speed: 0.0200s/iter; left time: 817.3283s
Epoch: 13 cost time: 9.763046979904175
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0022891
	speed: 0.0761s/iter; left time: 3097.4987s
	iters: 200, epoch: 14 | loss: 0.0585572
	speed: 0.0150s/iter; left time: 610.6014s
	iters: 300, epoch: 14 | loss: 0.0003591
	speed: 0.0163s/iter; left time: 660.6752s
	iters: 400, epoch: 14 | loss: 0.0077562
	speed: 0.0161s/iter; left time: 651.5615s
Epoch: 14 cost time: 7.817563533782959
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0014818
	speed: 0.0947s/iter; left time: 3811.3386s
	iters: 200, epoch: 15 | loss: 0.0003598
	speed: 0.0210s/iter; left time: 843.5284s
	iters: 300, epoch: 15 | loss: 0.0234884
	speed: 0.0192s/iter; left time: 767.2398s
	iters: 400, epoch: 15 | loss: 0.0017847
	speed: 0.0169s/iter; left time: 676.6252s
Epoch: 15 cost time: 9.245086431503296
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.970267 --> -0.974842).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0010313
	speed: 0.0982s/iter; left time: 3904.0950s
	iters: 200, epoch: 16 | loss: 0.0551844
	speed: 0.0183s/iter; left time: 724.6779s
	iters: 300, epoch: 16 | loss: 0.0050910
	speed: 0.0190s/iter; left time: 751.1054s
	iters: 400, epoch: 16 | loss: 0.0114808
	speed: 0.0156s/iter; left time: 617.0909s
Epoch: 16 cost time: 8.662256956100464
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0061055
	speed: 0.0878s/iter; left time: 3450.0774s
	iters: 200, epoch: 17 | loss: 0.0029500
	speed: 0.0187s/iter; left time: 733.8996s
	iters: 300, epoch: 17 | loss: 0.1018656
	speed: 0.0170s/iter; left time: 666.1693s
	iters: 400, epoch: 17 | loss: 0.0023449
	speed: 0.0184s/iter; left time: 718.4366s
Epoch: 17 cost time: 9.079643249511719
Epoch: 17, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0008385
	speed: 0.1075s/iter; left time: 4175.0434s
	iters: 200, epoch: 18 | loss: 0.0014694
	speed: 0.0212s/iter; left time: 821.0544s
	iters: 300, epoch: 18 | loss: 0.0265995
	speed: 0.0207s/iter; left time: 797.8766s
	iters: 400, epoch: 18 | loss: 0.0270372
	speed: 0.0200s/iter; left time: 769.0424s
Epoch: 18 cost time: 10.375235080718994
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0002166
	speed: 0.1049s/iter; left time: 4022.7552s
	iters: 200, epoch: 19 | loss: 0.0034208
	speed: 0.0178s/iter; left time: 679.1479s
	iters: 300, epoch: 19 | loss: 0.0045151
	speed: 0.0167s/iter; left time: 638.6730s
	iters: 400, epoch: 19 | loss: 0.0131179
	speed: 0.0168s/iter; left time: 641.1116s
Epoch: 19 cost time: 8.660109043121338
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0007180
	speed: 0.0911s/iter; left time: 3451.4238s
	iters: 200, epoch: 20 | loss: 0.3306476
	speed: 0.0172s/iter; left time: 649.5432s
	iters: 300, epoch: 20 | loss: 0.0017056
	speed: 0.0183s/iter; left time: 688.2357s
	iters: 400, epoch: 20 | loss: 0.0887547
	speed: 0.0206s/iter; left time: 775.9085s
Epoch: 20 cost time: 9.235685586929321
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0009156
	speed: 0.1090s/iter; left time: 4079.0412s
	iters: 200, epoch: 21 | loss: 0.0006240
	speed: 0.0225s/iter; left time: 839.5173s
	iters: 300, epoch: 21 | loss: 0.0030765
	speed: 0.0216s/iter; left time: 805.1495s
	iters: 400, epoch: 21 | loss: 0.1633739
	speed: 0.0229s/iter; left time: 849.4145s
Epoch: 21 cost time: 10.785345315933228
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975985).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0003309
	speed: 0.0945s/iter; left time: 3493.2477s
	iters: 200, epoch: 22 | loss: 0.0011987
	speed: 0.0165s/iter; left time: 609.1851s
	iters: 300, epoch: 22 | loss: 0.0004943
	speed: 0.0183s/iter; left time: 672.8616s
	iters: 400, epoch: 22 | loss: 0.0012627
	speed: 0.0186s/iter; left time: 682.0805s
Epoch: 22 cost time: 8.683419466018677
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0004506
	speed: 0.0689s/iter; left time: 2513.6894s
	iters: 200, epoch: 23 | loss: 0.1589967
	speed: 0.0175s/iter; left time: 635.2941s
	iters: 300, epoch: 23 | loss: 0.0020074
	speed: 0.0200s/iter; left time: 727.1356s
	iters: 400, epoch: 23 | loss: 0.0043696
	speed: 0.0208s/iter; left time: 753.0543s
Epoch: 23 cost time: 9.560233354568481
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0005084
	speed: 0.1117s/iter; left time: 4021.3825s
	iters: 200, epoch: 24 | loss: 0.0005897
	speed: 0.0206s/iter; left time: 738.7116s
	iters: 300, epoch: 24 | loss: 0.0058482
	speed: 0.0221s/iter; left time: 791.5249s
	iters: 400, epoch: 24 | loss: 0.0004452
	speed: 0.0249s/iter; left time: 888.7807s
Epoch: 24 cost time: 11.055354118347168
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0003241
	speed: 0.1248s/iter; left time: 4437.3972s
	iters: 200, epoch: 25 | loss: 0.0005478
	speed: 0.0193s/iter; left time: 683.0731s
	iters: 300, epoch: 25 | loss: 0.0013639
	speed: 0.0207s/iter; left time: 733.3683s
	iters: 400, epoch: 25 | loss: 0.0180791
	speed: 0.0213s/iter; left time: 752.3710s
Epoch: 25 cost time: 10.138329267501831
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0008037
	speed: 0.1119s/iter; left time: 3925.9003s
	iters: 200, epoch: 26 | loss: 0.0112865
	speed: 0.0205s/iter; left time: 715.6312s
	iters: 300, epoch: 26 | loss: 0.0228620
	speed: 0.0201s/iter; left time: 702.1776s
	iters: 400, epoch: 26 | loss: 0.0020922
	speed: 0.0230s/iter; left time: 798.8542s
Epoch: 26 cost time: 10.688951253890991
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0005969
	speed: 0.1234s/iter; left time: 4270.0114s
	iters: 200, epoch: 27 | loss: 0.0005028
	speed: 0.0282s/iter; left time: 974.1296s
	iters: 300, epoch: 27 | loss: 0.0000755
	speed: 0.0268s/iter; left time: 921.7838s
	iters: 400, epoch: 27 | loss: 0.0942528
	speed: 0.0222s/iter; left time: 762.9643s
Epoch: 27 cost time: 12.148550271987915
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.2747217
	speed: 0.0948s/iter; left time: 3237.3043s
	iters: 200, epoch: 28 | loss: 0.0405546
	speed: 0.0221s/iter; left time: 752.4714s
	iters: 300, epoch: 28 | loss: 0.0004361
	speed: 0.0231s/iter; left time: 782.9924s
	iters: 400, epoch: 28 | loss: 0.3789748
	speed: 0.0234s/iter; left time: 791.8539s
Epoch: 28 cost time: 10.87266230583191
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0024425
	speed: 0.1217s/iter; left time: 4096.4774s
	iters: 200, epoch: 29 | loss: 0.0009737
	speed: 0.0184s/iter; left time: 618.5047s
	iters: 300, epoch: 29 | loss: 0.0009204
	speed: 0.0202s/iter; left time: 674.4845s
	iters: 400, epoch: 29 | loss: 0.0006943
	speed: 0.0212s/iter; left time: 708.3653s
Epoch: 29 cost time: 10.006560564041138
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0002821
	speed: 0.0994s/iter; left time: 3299.4833s
	iters: 200, epoch: 30 | loss: 0.0017494
	speed: 0.0166s/iter; left time: 550.8299s
	iters: 300, epoch: 30 | loss: 0.0002304
	speed: 0.0176s/iter; left time: 581.6256s
	iters: 400, epoch: 30 | loss: 0.0004511
	speed: 0.0177s/iter; left time: 580.7062s
Epoch: 30 cost time: 8.48429274559021
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0003569
	speed: 0.0892s/iter; left time: 2919.0226s
	iters: 200, epoch: 31 | loss: 0.0005045
	speed: 0.0214s/iter; left time: 696.7884s
	iters: 300, epoch: 31 | loss: 0.0045961
	speed: 0.0200s/iter; left time: 649.9797s
	iters: 400, epoch: 31 | loss: 0.0019943
	speed: 0.0200s/iter; left time: 648.8597s
Epoch: 31 cost time: 10.07056975364685
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 78946
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7053376
	speed: 0.0341s/iter; left time: 1597.8067s
	iters: 200, epoch: 1 | loss: 1.1808187
	speed: 0.0183s/iter; left time: 854.3741s
	iters: 300, epoch: 1 | loss: 0.8457049
	speed: 0.0186s/iter; left time: 866.7174s
	iters: 400, epoch: 1 | loss: 0.6171980
	speed: 0.0186s/iter; left time: 863.9857s
Epoch: 1 cost time: 10.222672700881958
Epoch: 1, Steps: 469 | Train Loss: 1.249 Vali Loss: 0.586 Vali Acc: 0.820 Test Loss: 0.586 Test Acc: 0.820
Validation loss decreased (inf --> -0.820463).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2459179
	speed: 0.0998s/iter; left time: 4623.2143s
	iters: 200, epoch: 2 | loss: 0.5301508
	speed: 0.0198s/iter; left time: 915.4534s
	iters: 300, epoch: 2 | loss: 0.0951249
	speed: 0.0212s/iter; left time: 977.4022s
	iters: 400, epoch: 2 | loss: 0.2517393
	speed: 0.0198s/iter; left time: 910.7625s
Epoch: 2 cost time: 10.155596256256104
Epoch: 2, Steps: 469 | Train Loss: 0.311 Vali Loss: 0.318 Vali Acc: 0.893 Test Loss: 0.318 Test Acc: 0.893
Validation loss decreased (-0.820463 --> -0.892793).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0908552
	speed: 0.1246s/iter; left time: 5714.1451s
	iters: 200, epoch: 3 | loss: 0.3820238
	speed: 0.0193s/iter; left time: 883.3977s
	iters: 300, epoch: 3 | loss: 0.4223109
	speed: 0.0189s/iter; left time: 863.3479s
	iters: 400, epoch: 3 | loss: 0.2168600
	speed: 0.0199s/iter; left time: 906.2548s
Epoch: 3 cost time: 9.993914365768433
Epoch: 3, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.892793 --> -0.939392).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1049179
	speed: 0.0939s/iter; left time: 4261.0920s
	iters: 200, epoch: 4 | loss: 0.2467085
	speed: 0.0178s/iter; left time: 806.3319s
	iters: 300, epoch: 4 | loss: 0.0185565
	speed: 0.0191s/iter; left time: 863.2259s
	iters: 400, epoch: 4 | loss: 0.0795558
	speed: 0.0184s/iter; left time: 828.2262s
Epoch: 4 cost time: 9.09973406791687
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.939392 --> -0.957403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0178115
	speed: 0.0899s/iter; left time: 4040.3355s
	iters: 200, epoch: 5 | loss: 0.1053235
	speed: 0.0177s/iter; left time: 794.2088s
	iters: 300, epoch: 5 | loss: 0.0386953
	speed: 0.0173s/iter; left time: 774.1346s
	iters: 400, epoch: 5 | loss: 0.0111156
	speed: 0.0170s/iter; left time: 758.2830s
Epoch: 5 cost time: 8.593898296356201
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.957403 --> -0.957403).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0181099
	speed: 0.0764s/iter; left time: 3398.6026s
	iters: 200, epoch: 6 | loss: 0.0338332
	speed: 0.0214s/iter; left time: 949.0581s
	iters: 300, epoch: 6 | loss: 0.0652612
	speed: 0.0203s/iter; left time: 898.0988s
	iters: 400, epoch: 6 | loss: 0.0054699
	speed: 0.0212s/iter; left time: 937.4029s
Epoch: 6 cost time: 10.1091787815094
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.957403 --> -0.969410).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0473298
	speed: 0.0953s/iter; left time: 4192.2876s
	iters: 200, epoch: 7 | loss: 0.0165174
	speed: 0.0220s/iter; left time: 967.0372s
	iters: 300, epoch: 7 | loss: 0.0061577
	speed: 0.0230s/iter; left time: 1007.8385s
	iters: 400, epoch: 7 | loss: 0.0370904
	speed: 0.0227s/iter; left time: 989.6270s
Epoch: 7 cost time: 10.513852596282959
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0674205
	speed: 0.0923s/iter; left time: 4014.7942s
	iters: 200, epoch: 8 | loss: 0.0206676
	speed: 0.0185s/iter; left time: 802.4375s
	iters: 300, epoch: 8 | loss: 0.3847809
	speed: 0.0190s/iter; left time: 823.0554s
	iters: 400, epoch: 8 | loss: 0.0064533
	speed: 0.0189s/iter; left time: 814.7680s
Epoch: 8 cost time: 9.242303133010864
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0173365
	speed: 0.1150s/iter; left time: 4951.9560s
	iters: 200, epoch: 9 | loss: 0.0160162
	speed: 0.0199s/iter; left time: 855.0268s
	iters: 300, epoch: 9 | loss: 0.0019081
	speed: 0.0193s/iter; left time: 826.3444s
	iters: 400, epoch: 9 | loss: 0.0030889
	speed: 0.0182s/iter; left time: 776.4155s
Epoch: 9 cost time: 9.590048551559448
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0023375
	speed: 0.1071s/iter; left time: 4558.4864s
	iters: 200, epoch: 10 | loss: 0.0135892
	speed: 0.0224s/iter; left time: 951.7332s
	iters: 300, epoch: 10 | loss: 0.2119362
	speed: 0.0183s/iter; left time: 773.5744s
	iters: 400, epoch: 10 | loss: 0.0146420
	speed: 0.0192s/iter; left time: 813.3146s
Epoch: 10 cost time: 10.084599018096924
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0046597
	speed: 0.1038s/iter; left time: 4369.2870s
	iters: 200, epoch: 11 | loss: 0.0079366
	speed: 0.0228s/iter; left time: 957.4783s
	iters: 300, epoch: 11 | loss: 0.0011634
	speed: 0.0205s/iter; left time: 861.1271s
	iters: 400, epoch: 11 | loss: 0.0237991
	speed: 0.0207s/iter; left time: 863.5080s
Epoch: 11 cost time: 10.439209461212158
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0102941
	speed: 0.1038s/iter; left time: 4321.2893s
	iters: 200, epoch: 12 | loss: 0.0119287
	speed: 0.0219s/iter; left time: 908.1197s
	iters: 300, epoch: 12 | loss: 0.1100613
	speed: 0.0190s/iter; left time: 788.8725s
	iters: 400, epoch: 12 | loss: 0.0130451
	speed: 0.0196s/iter; left time: 810.5018s
Epoch: 12 cost time: 9.93654203414917
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0049238
	speed: 0.0955s/iter; left time: 3933.9301s
	iters: 200, epoch: 13 | loss: 0.0005077
	speed: 0.0173s/iter; left time: 710.5678s
	iters: 300, epoch: 13 | loss: 0.0014287
	speed: 0.0170s/iter; left time: 695.5345s
	iters: 400, epoch: 13 | loss: 0.0144457
	speed: 0.0171s/iter; left time: 697.6088s
Epoch: 13 cost time: 8.526337623596191
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0210307
	speed: 0.0788s/iter; left time: 3207.0844s
	iters: 200, epoch: 14 | loss: 0.0030882
	speed: 0.0178s/iter; left time: 724.0531s
	iters: 300, epoch: 14 | loss: 0.0964852
	speed: 0.0184s/iter; left time: 746.6518s
	iters: 400, epoch: 14 | loss: 0.0931977
	speed: 0.0201s/iter; left time: 810.2076s
Epoch: 14 cost time: 9.334634780883789
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0918834
	speed: 0.1171s/iter; left time: 4713.1332s
	iters: 200, epoch: 15 | loss: 0.0010685
	speed: 0.0243s/iter; left time: 974.7239s
	iters: 300, epoch: 15 | loss: 0.0021410
	speed: 0.0248s/iter; left time: 993.3393s
	iters: 400, epoch: 15 | loss: 0.3134743
	speed: 0.0255s/iter; left time: 1017.3151s
Epoch: 15 cost time: 11.562853336334229
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0035573
	speed: 0.1150s/iter; left time: 4572.3191s
	iters: 200, epoch: 16 | loss: 0.0075529
	speed: 0.0204s/iter; left time: 811.0660s
	iters: 300, epoch: 16 | loss: 0.0012420
	speed: 0.0215s/iter; left time: 849.7469s
	iters: 400, epoch: 16 | loss: 0.0044313
	speed: 0.0218s/iter; left time: 858.8047s
Epoch: 16 cost time: 10.492823839187622
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9694110920526015
model parameter : 78914
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8844634
	speed: 0.0384s/iter; left time: 1797.3498s
	iters: 200, epoch: 1 | loss: 1.0679325
	speed: 0.0206s/iter; left time: 962.5540s
	iters: 300, epoch: 1 | loss: 0.8021404
	speed: 0.0202s/iter; left time: 939.5396s
	iters: 400, epoch: 1 | loss: 0.7380356
	speed: 0.0194s/iter; left time: 902.2415s
Epoch: 1 cost time: 11.347310066223145
Epoch: 1, Steps: 469 | Train Loss: 1.326 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
Validation loss decreased (inf --> -0.814745).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6072552
	speed: 0.1123s/iter; left time: 5202.8632s
	iters: 200, epoch: 2 | loss: 0.2875331
	speed: 0.0212s/iter; left time: 978.5460s
	iters: 300, epoch: 2 | loss: 0.3903843
	speed: 0.0204s/iter; left time: 942.6075s
	iters: 400, epoch: 2 | loss: 0.1431718
	speed: 0.0196s/iter; left time: 901.8987s
Epoch: 2 cost time: 10.242009401321411
Epoch: 2, Steps: 469 | Train Loss: 0.319 Vali Loss: 0.315 Vali Acc: 0.899 Test Loss: 0.315 Test Acc: 0.899
Validation loss decreased (-0.814745 --> -0.899082).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0774652
	speed: 0.1017s/iter; left time: 4665.1568s
	iters: 200, epoch: 3 | loss: 0.0599229
	speed: 0.0178s/iter; left time: 812.6497s
	iters: 300, epoch: 3 | loss: 0.0663939
	speed: 0.0180s/iter; left time: 821.9067s
	iters: 400, epoch: 3 | loss: 0.0855120
	speed: 0.0174s/iter; left time: 794.9500s
Epoch: 3 cost time: 8.729578971862793
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.197 Vali Acc: 0.934 Test Loss: 0.197 Test Acc: 0.934
Validation loss decreased (-0.899082 --> -0.933960).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0486284
	speed: 0.0850s/iter; left time: 3858.6763s
	iters: 200, epoch: 4 | loss: 0.1476485
	speed: 0.0215s/iter; left time: 971.8812s
	iters: 300, epoch: 4 | loss: 0.1079063
	speed: 0.0199s/iter; left time: 897.5497s
	iters: 400, epoch: 4 | loss: 0.2274637
	speed: 0.0208s/iter; left time: 938.7447s
Epoch: 4 cost time: 9.833536148071289
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0281089
	speed: 0.1087s/iter; left time: 4884.6532s
	iters: 200, epoch: 5 | loss: 0.0307152
	speed: 0.0212s/iter; left time: 951.4936s
	iters: 300, epoch: 5 | loss: 0.0363684
	speed: 0.0211s/iter; left time: 945.2119s
	iters: 400, epoch: 5 | loss: 0.0912172
	speed: 0.0201s/iter; left time: 898.4643s
Epoch: 5 cost time: 10.227601289749146
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.933960 --> -0.964550).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0177800
	speed: 0.0951s/iter; left time: 4228.6414s
	iters: 200, epoch: 6 | loss: 0.0800399
	speed: 0.0185s/iter; left time: 818.4352s
	iters: 300, epoch: 6 | loss: 0.0586486
	speed: 0.0184s/iter; left time: 812.7480s
	iters: 400, epoch: 6 | loss: 0.0249744
	speed: 0.0203s/iter; left time: 897.9342s
Epoch: 6 cost time: 9.315828323364258
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0081944
	speed: 0.1056s/iter; left time: 4644.2294s
	iters: 200, epoch: 7 | loss: 0.0928108
	speed: 0.0181s/iter; left time: 792.8016s
	iters: 300, epoch: 7 | loss: 0.3347457
	speed: 0.0186s/iter; left time: 814.1552s
	iters: 400, epoch: 7 | loss: 0.4436809
	speed: 0.0195s/iter; left time: 854.0112s
Epoch: 7 cost time: 9.513663291931152
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0445435
	speed: 0.1107s/iter; left time: 4817.6744s
	iters: 200, epoch: 8 | loss: 0.0166451
	speed: 0.0169s/iter; left time: 734.4318s
	iters: 300, epoch: 8 | loss: 0.0174615
	speed: 0.0169s/iter; left time: 729.9898s
	iters: 400, epoch: 8 | loss: 0.0025349
	speed: 0.0172s/iter; left time: 743.4137s
Epoch: 8 cost time: 8.574434041976929
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.964550 --> -0.970268).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0022235
	speed: 0.0894s/iter; left time: 3848.7179s
	iters: 200, epoch: 9 | loss: 0.0153494
	speed: 0.0192s/iter; left time: 823.4455s
	iters: 300, epoch: 9 | loss: 0.0078408
	speed: 0.0196s/iter; left time: 840.3191s
	iters: 400, epoch: 9 | loss: 0.0042024
	speed: 0.0210s/iter; left time: 899.6493s
Epoch: 9 cost time: 9.538485527038574
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.970268 --> -0.970839).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0030401
	speed: 0.1025s/iter; left time: 4365.5652s
	iters: 200, epoch: 10 | loss: 0.0087573
	speed: 0.0201s/iter; left time: 855.5322s
	iters: 300, epoch: 10 | loss: 0.0597140
	speed: 0.0202s/iter; left time: 854.3992s
	iters: 400, epoch: 10 | loss: 0.0027097
	speed: 0.0181s/iter; left time: 766.3332s
Epoch: 10 cost time: 9.377556324005127
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.970839 --> -0.971411).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0080551
	speed: 0.0718s/iter; left time: 3024.3847s
	iters: 200, epoch: 11 | loss: 0.0006695
	speed: 0.0184s/iter; left time: 774.5385s
	iters: 300, epoch: 11 | loss: 0.0014982
	speed: 0.0199s/iter; left time: 834.9903s
	iters: 400, epoch: 11 | loss: 0.0029154
	speed: 0.0215s/iter; left time: 899.1240s
Epoch: 11 cost time: 9.835335493087769
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0155463
	speed: 0.1175s/iter; left time: 4893.7786s
	iters: 200, epoch: 12 | loss: 0.2274791
	speed: 0.0214s/iter; left time: 888.4348s
	iters: 300, epoch: 12 | loss: 0.3098234
	speed: 0.0233s/iter; left time: 964.7754s
	iters: 400, epoch: 12 | loss: 0.0175173
	speed: 0.0283s/iter; left time: 1168.6541s
Epoch: 12 cost time: 11.505433082580566
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.971411 --> -0.971411).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0464604
	speed: 0.1181s/iter; left time: 4863.4685s
	iters: 200, epoch: 13 | loss: 0.0046524
	speed: 0.0228s/iter; left time: 938.1302s
	iters: 300, epoch: 13 | loss: 0.0009613
	speed: 0.0202s/iter; left time: 825.9934s
	iters: 400, epoch: 13 | loss: 0.0195902
	speed: 0.0181s/iter; left time: 738.4220s
Epoch: 13 cost time: 10.04343318939209
Epoch: 13, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0016515
	speed: 0.1085s/iter; left time: 4416.9705s
	iters: 200, epoch: 14 | loss: 0.0050508
	speed: 0.0210s/iter; left time: 852.6640s
	iters: 300, epoch: 14 | loss: 0.0165834
	speed: 0.0203s/iter; left time: 822.5568s
	iters: 400, epoch: 14 | loss: 0.0031729
	speed: 0.0234s/iter; left time: 944.0604s
Epoch: 14 cost time: 10.856875658035278
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0723643
	speed: 0.1163s/iter; left time: 4679.6199s
	iters: 200, epoch: 15 | loss: 0.0581376
	speed: 0.0206s/iter; left time: 828.5657s
	iters: 300, epoch: 15 | loss: 0.0012042
	speed: 0.0224s/iter; left time: 898.3414s
	iters: 400, epoch: 15 | loss: 0.0013887
	speed: 0.0233s/iter; left time: 929.5382s
Epoch: 15 cost time: 10.833195447921753
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1819438
	speed: 0.0947s/iter; left time: 3765.7952s
	iters: 200, epoch: 16 | loss: 0.0125770
	speed: 0.0172s/iter; left time: 681.8451s
	iters: 300, epoch: 16 | loss: 0.0490109
	speed: 0.0180s/iter; left time: 712.2866s
	iters: 400, epoch: 16 | loss: 0.0684846
	speed: 0.0201s/iter; left time: 793.2474s
Epoch: 16 cost time: 9.015732526779175
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0028649
	speed: 0.0834s/iter; left time: 3276.1939s
	iters: 200, epoch: 17 | loss: 0.0002838
	speed: 0.0184s/iter; left time: 720.8325s
	iters: 300, epoch: 17 | loss: 0.0053374
	speed: 0.0207s/iter; left time: 810.1327s
	iters: 400, epoch: 17 | loss: 0.0004468
	speed: 0.0227s/iter; left time: 885.0981s
Epoch: 17 cost time: 10.0769624710083
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.953 Test Loss: 0.250 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0094894
	speed: 0.1151s/iter; left time: 4467.9555s
	iters: 200, epoch: 18 | loss: 0.0003871
	speed: 0.0226s/iter; left time: 874.8595s
	iters: 300, epoch: 18 | loss: 0.0558844
	speed: 0.0220s/iter; left time: 848.9930s
	iters: 400, epoch: 18 | loss: 0.0230298
	speed: 0.0226s/iter; left time: 872.0358s
Epoch: 18 cost time: 10.818640947341919
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0031224
	speed: 0.1178s/iter; left time: 4519.3520s
	iters: 200, epoch: 19 | loss: 0.0022322
	speed: 0.0183s/iter; left time: 699.3934s
	iters: 300, epoch: 19 | loss: 0.1213605
	speed: 0.0191s/iter; left time: 730.3756s
	iters: 400, epoch: 19 | loss: 0.0202598
	speed: 0.0197s/iter; left time: 750.9603s
Epoch: 19 cost time: 9.436529636383057
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0082839
	speed: 0.1045s/iter; left time: 3958.6649s
	iters: 200, epoch: 20 | loss: 0.0827042
	speed: 0.0205s/iter; left time: 776.3214s
	iters: 300, epoch: 20 | loss: 0.0039764
	speed: 0.0228s/iter; left time: 859.8505s
	iters: 400, epoch: 20 | loss: 0.0082631
	speed: 0.0227s/iter; left time: 853.1117s
Epoch: 20 cost time: 10.407563209533691
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0086983
	speed: 0.1117s/iter; left time: 4180.8264s
	iters: 200, epoch: 21 | loss: 0.0014344
	speed: 0.0209s/iter; left time: 779.3052s
	iters: 300, epoch: 21 | loss: 0.0245291
	speed: 0.0195s/iter; left time: 726.2724s
	iters: 400, epoch: 21 | loss: 0.0019960
	speed: 0.0224s/iter; left time: 833.0023s
Epoch: 21 cost time: 10.137843370437622
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0026020
	speed: 0.0943s/iter; left time: 3483.0883s
	iters: 200, epoch: 22 | loss: 0.0006931
	speed: 0.0179s/iter; left time: 657.9133s
	iters: 300, epoch: 22 | loss: 0.0031252
	speed: 0.0179s/iter; left time: 658.0402s
	iters: 400, epoch: 22 | loss: 0.0135923
	speed: 0.0166s/iter; left time: 606.9622s
Epoch: 22 cost time: 8.435266971588135
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.971411 --> -0.977701).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0001840
	speed: 0.0929s/iter; left time: 3387.5991s
	iters: 200, epoch: 23 | loss: 0.0008791
	speed: 0.0217s/iter; left time: 791.2108s
	iters: 300, epoch: 23 | loss: 0.0040947
	speed: 0.0204s/iter; left time: 738.5575s
	iters: 400, epoch: 23 | loss: 0.0566836
	speed: 0.0211s/iter; left time: 763.2996s
Epoch: 23 cost time: 10.37037444114685
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0197590
	speed: 0.1054s/iter; left time: 3795.6096s
	iters: 200, epoch: 24 | loss: 0.0013275
	speed: 0.0229s/iter; left time: 822.1097s
	iters: 300, epoch: 24 | loss: 0.0002659
	speed: 0.0207s/iter; left time: 741.3999s
	iters: 400, epoch: 24 | loss: 0.0018472
	speed: 0.0206s/iter; left time: 733.9866s
Epoch: 24 cost time: 10.552602052688599
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0283693
	speed: 0.0858s/iter; left time: 3050.3950s
	iters: 200, epoch: 25 | loss: 0.0015213
	speed: 0.0190s/iter; left time: 675.0177s
	iters: 300, epoch: 25 | loss: 0.0752007
	speed: 0.0196s/iter; left time: 692.1812s
	iters: 400, epoch: 25 | loss: 0.0004096
	speed: 0.0227s/iter; left time: 801.7556s
Epoch: 25 cost time: 9.769372463226318
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0017021
	speed: 0.1046s/iter; left time: 3668.5867s
	iters: 200, epoch: 26 | loss: 0.0011424
	speed: 0.0233s/iter; left time: 813.5658s
	iters: 300, epoch: 26 | loss: 0.0015015
	speed: 0.0241s/iter; left time: 839.6408s
	iters: 400, epoch: 26 | loss: 0.0688313
	speed: 0.0228s/iter; left time: 793.1155s
Epoch: 26 cost time: 11.199405193328857
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0035359
	speed: 0.1301s/iter; left time: 4501.2169s
	iters: 200, epoch: 27 | loss: 0.0009570
	speed: 0.0220s/iter; left time: 758.6381s
	iters: 300, epoch: 27 | loss: 0.0084546
	speed: 0.0177s/iter; left time: 609.2151s
	iters: 400, epoch: 27 | loss: 0.0024941
	speed: 0.0170s/iter; left time: 583.9282s
Epoch: 27 cost time: 9.615504741668701
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0045126
	speed: 0.0846s/iter; left time: 2887.0039s
	iters: 200, epoch: 28 | loss: 0.0359720
	speed: 0.0228s/iter; left time: 774.9691s
	iters: 300, epoch: 28 | loss: 0.0007707
	speed: 0.0216s/iter; left time: 731.7765s
	iters: 400, epoch: 28 | loss: 0.0004666
	speed: 0.0216s/iter; left time: 731.4306s
Epoch: 28 cost time: 10.456154346466064
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0009298
	speed: 0.1065s/iter; left time: 3585.4495s
	iters: 200, epoch: 29 | loss: 0.0095016
	speed: 0.0226s/iter; left time: 757.6903s
	iters: 300, epoch: 29 | loss: 0.0008617
	speed: 0.0245s/iter; left time: 819.9155s
	iters: 400, epoch: 29 | loss: 0.3541254
	speed: 0.0260s/iter; left time: 867.6593s
Epoch: 29 cost time: 11.459380865097046
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0001853
	speed: 0.0855s/iter; left time: 2838.1525s
	iters: 200, epoch: 30 | loss: 0.0015966
	speed: 0.0179s/iter; left time: 593.6998s
	iters: 300, epoch: 30 | loss: 0.0313672
	speed: 0.0196s/iter; left time: 645.5412s
	iters: 400, epoch: 30 | loss: 0.0015302
	speed: 0.0229s/iter; left time: 752.3740s
Epoch: 30 cost time: 9.839393377304077
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.977701 --> -0.978272).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0002434
	speed: 0.1137s/iter; left time: 3720.0540s
	iters: 200, epoch: 31 | loss: 0.0275853
	speed: 0.0234s/iter; left time: 762.8396s
	iters: 300, epoch: 31 | loss: 0.0007053
	speed: 0.0232s/iter; left time: 755.9221s
	iters: 400, epoch: 31 | loss: 0.0016239
	speed: 0.0240s/iter; left time: 779.9364s
Epoch: 31 cost time: 11.337957620620728
Epoch: 31, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0001674
	speed: 0.1217s/iter; left time: 3924.7817s
	iters: 200, epoch: 32 | loss: 0.0003013
	speed: 0.0203s/iter; left time: 651.6076s
	iters: 300, epoch: 32 | loss: 0.0486140
	speed: 0.0174s/iter; left time: 557.3153s
	iters: 400, epoch: 32 | loss: 0.0009259
	speed: 0.0175s/iter; left time: 558.6031s
Epoch: 32 cost time: 9.390889406204224
Epoch: 32, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0004530
	speed: 0.0984s/iter; left time: 3127.0312s
	iters: 200, epoch: 33 | loss: 0.0008814
	speed: 0.0179s/iter; left time: 567.1007s
	iters: 300, epoch: 33 | loss: 0.0016713
	speed: 0.0190s/iter; left time: 599.7621s
	iters: 400, epoch: 33 | loss: 0.1223298
	speed: 0.0192s/iter; left time: 603.5058s
Epoch: 33 cost time: 9.460238218307495
Epoch: 33, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0039823
	speed: 0.1239s/iter; left time: 3880.6014s
	iters: 200, epoch: 34 | loss: 0.0018655
	speed: 0.0212s/iter; left time: 661.7414s
	iters: 300, epoch: 34 | loss: 0.0002923
	speed: 0.0195s/iter; left time: 607.1947s
	iters: 400, epoch: 34 | loss: 0.0009460
	speed: 0.0204s/iter; left time: 632.1112s
Epoch: 34 cost time: 9.955796480178833
Epoch: 34, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.190 Vali Acc: 0.968 Test Loss: 0.190 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0044336
	speed: 0.0872s/iter; left time: 2690.2200s
	iters: 200, epoch: 35 | loss: 0.0012129
	speed: 0.0168s/iter; left time: 517.4557s
	iters: 300, epoch: 35 | loss: 0.0004091
	speed: 0.0169s/iter; left time: 517.8717s
	iters: 400, epoch: 35 | loss: 0.0002238
	speed: 0.0175s/iter; left time: 534.8701s
Epoch: 35 cost time: 8.35709547996521
Epoch: 35, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.978272 --> -0.978272).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0912063
	speed: 0.0916s/iter; left time: 2784.1634s
	iters: 200, epoch: 36 | loss: 0.0059147
	speed: 0.0187s/iter; left time: 566.8650s
	iters: 300, epoch: 36 | loss: 0.0008964
	speed: 0.0185s/iter; left time: 558.6953s
	iters: 400, epoch: 36 | loss: 0.1921883
	speed: 0.0184s/iter; left time: 552.4541s
Epoch: 36 cost time: 9.027830123901367
Epoch: 36, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0035332
	speed: 0.1014s/iter; left time: 3034.1368s
	iters: 200, epoch: 37 | loss: 0.0004248
	speed: 0.0202s/iter; left time: 602.0047s
	iters: 300, epoch: 37 | loss: 0.0005576
	speed: 0.0216s/iter; left time: 641.5647s
	iters: 400, epoch: 37 | loss: 0.0001763
	speed: 0.0202s/iter; left time: 598.0391s
Epoch: 37 cost time: 9.79932188987732
Epoch: 37, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000609
	speed: 0.0856s/iter; left time: 2519.9360s
	iters: 200, epoch: 38 | loss: 0.0209766
	speed: 0.0177s/iter; left time: 518.4188s
	iters: 300, epoch: 38 | loss: 0.0021059
	speed: 0.0190s/iter; left time: 556.6142s
	iters: 400, epoch: 38 | loss: 0.0004622
	speed: 0.0188s/iter; left time: 546.8848s
Epoch: 38 cost time: 8.886790752410889
Epoch: 38, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0014215
	speed: 0.1102s/iter; left time: 3193.9929s
	iters: 200, epoch: 39 | loss: 0.0012542
	speed: 0.0206s/iter; left time: 595.1312s
	iters: 300, epoch: 39 | loss: 0.0001731
	speed: 0.0204s/iter; left time: 587.1162s
	iters: 400, epoch: 39 | loss: 0.0002938
	speed: 0.0199s/iter; left time: 570.4684s
Epoch: 39 cost time: 9.947511672973633
Epoch: 39, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0076289
	speed: 0.1169s/iter; left time: 3331.7193s
	iters: 200, epoch: 40 | loss: 0.0002831
	speed: 0.0205s/iter; left time: 583.3326s
	iters: 300, epoch: 40 | loss: 0.3083201
	speed: 0.0208s/iter; left time: 589.7032s
	iters: 400, epoch: 40 | loss: 0.0120133
	speed: 0.0219s/iter; left time: 616.9892s
Epoch: 40 cost time: 10.246224641799927
Epoch: 40, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000626
	speed: 0.0961s/iter; left time: 2693.7789s
	iters: 200, epoch: 41 | loss: 0.0157041
	speed: 0.0179s/iter; left time: 501.0978s
	iters: 300, epoch: 41 | loss: 0.0015381
	speed: 0.0181s/iter; left time: 503.6552s
	iters: 400, epoch: 41 | loss: 0.0021644
	speed: 0.0186s/iter; left time: 515.4894s
Epoch: 41 cost time: 8.826843500137329
Epoch: 41, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0008213
	speed: 0.0956s/iter; left time: 2636.5150s
	iters: 200, epoch: 42 | loss: 0.0013532
	speed: 0.0193s/iter; left time: 531.0565s
	iters: 300, epoch: 42 | loss: 0.0028641
	speed: 0.0208s/iter; left time: 570.4086s
	iters: 400, epoch: 42 | loss: 0.0001960
	speed: 0.0212s/iter; left time: 576.9421s
Epoch: 42 cost time: 9.81689977645874
Epoch: 42, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0009938
	speed: 0.1001s/iter; left time: 2713.9898s
	iters: 200, epoch: 43 | loss: 0.0002255
	speed: 0.0238s/iter; left time: 642.0426s
	iters: 300, epoch: 43 | loss: 0.0003040
	speed: 0.0214s/iter; left time: 576.8636s
	iters: 400, epoch: 43 | loss: 0.0105563
	speed: 0.0194s/iter; left time: 520.2136s
Epoch: 43 cost time: 10.219267129898071
Epoch: 43, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0001062
	speed: 0.0883s/iter; left time: 2350.7707s
	iters: 200, epoch: 44 | loss: 0.0005576
	speed: 0.0200s/iter; left time: 531.2806s
	iters: 300, epoch: 44 | loss: 0.0010317
	speed: 0.0194s/iter; left time: 512.8373s
	iters: 400, epoch: 44 | loss: 0.0004682
	speed: 0.0205s/iter; left time: 540.7329s
Epoch: 44 cost time: 9.846361637115479
Epoch: 44, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0559306
	speed: 0.0928s/iter; left time: 2427.1290s
	iters: 200, epoch: 45 | loss: 0.0002281
	speed: 0.0230s/iter; left time: 599.2539s
	iters: 300, epoch: 45 | loss: 0.0070151
	speed: 0.0196s/iter; left time: 509.6706s
	iters: 400, epoch: 45 | loss: 0.0002082
	speed: 0.0192s/iter; left time: 496.8197s
Epoch: 45 cost time: 10.055081605911255
Epoch: 45, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 78882
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9613571
	speed: 0.0279s/iter; left time: 1304.0079s
	iters: 200, epoch: 1 | loss: 1.2217097
	speed: 0.0154s/iter; left time: 720.2936s
	iters: 300, epoch: 1 | loss: 1.1903179
	speed: 0.0157s/iter; left time: 732.7916s
	iters: 400, epoch: 1 | loss: 0.5230395
	speed: 0.0162s/iter; left time: 754.3431s
Epoch: 1 cost time: 8.690003633499146
Epoch: 1, Steps: 469 | Train Loss: 1.302 Vali Loss: 0.542 Vali Acc: 0.824 Test Loss: 0.542 Test Acc: 0.824
Validation loss decreased (inf --> -0.823608).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5611417
	speed: 0.0756s/iter; left time: 3500.5869s
	iters: 200, epoch: 2 | loss: 0.3909467
	speed: 0.0177s/iter; left time: 816.5173s
	iters: 300, epoch: 2 | loss: 0.4754217
	speed: 0.0183s/iter; left time: 846.0019s
	iters: 400, epoch: 2 | loss: 0.3604685
	speed: 0.0180s/iter; left time: 827.8504s
Epoch: 2 cost time: 8.514352321624756
Epoch: 2, Steps: 469 | Train Loss: 0.304 Vali Loss: 0.283 Vali Acc: 0.916 Test Loss: 0.283 Test Acc: 0.916
Validation loss decreased (-0.823608 --> -0.915949).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4569554
	speed: 0.1018s/iter; left time: 4670.6752s
	iters: 200, epoch: 3 | loss: 0.0806652
	speed: 0.0199s/iter; left time: 909.7883s
	iters: 300, epoch: 3 | loss: 0.2128588
	speed: 0.0197s/iter; left time: 899.0394s
	iters: 400, epoch: 3 | loss: 0.2322064
	speed: 0.0217s/iter; left time: 987.2284s
Epoch: 3 cost time: 10.16364574432373
Epoch: 3, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.915949 --> -0.936819).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0276189
	speed: 0.0812s/iter; left time: 3688.1578s
	iters: 200, epoch: 4 | loss: 0.0273628
	speed: 0.0163s/iter; left time: 737.7685s
	iters: 300, epoch: 4 | loss: 0.0683687
	speed: 0.0164s/iter; left time: 742.3312s
	iters: 400, epoch: 4 | loss: 0.0273490
	speed: 0.0157s/iter; left time: 709.4442s
Epoch: 4 cost time: 7.898607492446899
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.936819 --> -0.964550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0184500
	speed: 0.0804s/iter; left time: 3613.6435s
	iters: 200, epoch: 5 | loss: 0.0469914
	speed: 0.0194s/iter; left time: 869.4480s
	iters: 300, epoch: 5 | loss: 0.0280635
	speed: 0.0208s/iter; left time: 931.4910s
	iters: 400, epoch: 5 | loss: 0.0366087
	speed: 0.0228s/iter; left time: 1017.6820s
Epoch: 5 cost time: 10.16584849357605
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2393191
	speed: 0.1210s/iter; left time: 5377.9998s
	iters: 200, epoch: 6 | loss: 0.1185624
	speed: 0.0214s/iter; left time: 950.6061s
	iters: 300, epoch: 6 | loss: 0.0260884
	speed: 0.0221s/iter; left time: 980.0698s
	iters: 400, epoch: 6 | loss: 0.0443795
	speed: 0.0210s/iter; left time: 929.0047s
Epoch: 6 cost time: 10.471358299255371
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0044107
	speed: 0.1046s/iter; left time: 4602.2140s
	iters: 200, epoch: 7 | loss: 0.0240119
	speed: 0.0180s/iter; left time: 789.5589s
	iters: 300, epoch: 7 | loss: 0.0066504
	speed: 0.0182s/iter; left time: 797.6382s
	iters: 400, epoch: 7 | loss: 0.0077309
	speed: 0.0212s/iter; left time: 927.1738s
Epoch: 7 cost time: 9.533913612365723
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.964550 --> -0.970268).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0203236
	speed: 0.1221s/iter; left time: 5314.2944s
	iters: 200, epoch: 8 | loss: 0.0366167
	speed: 0.0215s/iter; left time: 932.6295s
	iters: 300, epoch: 8 | loss: 0.0344422
	speed: 0.0203s/iter; left time: 877.8855s
	iters: 400, epoch: 8 | loss: 0.0414139
	speed: 0.0202s/iter; left time: 871.1448s
Epoch: 8 cost time: 10.42772889137268
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0238392
	speed: 0.0995s/iter; left time: 4281.8467s
	iters: 200, epoch: 9 | loss: 0.0119256
	speed: 0.0212s/iter; left time: 908.6384s
	iters: 300, epoch: 9 | loss: 0.0024920
	speed: 0.0176s/iter; left time: 754.2765s
	iters: 400, epoch: 9 | loss: 0.1087132
	speed: 0.0167s/iter; left time: 712.8709s
Epoch: 9 cost time: 9.218183040618896
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0077890
	speed: 0.0845s/iter; left time: 3596.9860s
	iters: 200, epoch: 10 | loss: 0.0169313
	speed: 0.0177s/iter; left time: 751.4878s
	iters: 300, epoch: 10 | loss: 0.0016786
	speed: 0.0179s/iter; left time: 756.5105s
	iters: 400, epoch: 10 | loss: 0.0220678
	speed: 0.0167s/iter; left time: 704.4710s
Epoch: 10 cost time: 8.598169088363647
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0026911
	speed: 0.0917s/iter; left time: 3859.6934s
	iters: 200, epoch: 11 | loss: 0.0168098
	speed: 0.0183s/iter; left time: 770.2942s
	iters: 300, epoch: 11 | loss: 0.0686386
	speed: 0.0175s/iter; left time: 732.6241s
	iters: 400, epoch: 11 | loss: 0.1320119
	speed: 0.0169s/iter; left time: 704.5177s
Epoch: 11 cost time: 8.568926095962524
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0030266
	speed: 0.1017s/iter; left time: 4233.5784s
	iters: 200, epoch: 12 | loss: 0.0090007
	speed: 0.0154s/iter; left time: 640.0969s
	iters: 300, epoch: 12 | loss: 0.0087730
	speed: 0.0159s/iter; left time: 660.9759s
	iters: 400, epoch: 12 | loss: 0.0068027
	speed: 0.0170s/iter; left time: 702.0582s
Epoch: 12 cost time: 8.130340099334717
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0060431
	speed: 0.1059s/iter; left time: 4362.2575s
	iters: 200, epoch: 13 | loss: 0.0323447
	speed: 0.0170s/iter; left time: 698.8134s
	iters: 300, epoch: 13 | loss: 0.0009796
	speed: 0.0177s/iter; left time: 725.8666s
	iters: 400, epoch: 13 | loss: 0.0022373
	speed: 0.0203s/iter; left time: 830.7310s
Epoch: 13 cost time: 9.034491777420044
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0051827
	speed: 0.1079s/iter; left time: 4391.7226s
	iters: 200, epoch: 14 | loss: 0.0042435
	speed: 0.0185s/iter; left time: 752.2601s
	iters: 300, epoch: 14 | loss: 0.0490179
	speed: 0.0201s/iter; left time: 816.0520s
	iters: 400, epoch: 14 | loss: 0.0027751
	speed: 0.0203s/iter; left time: 821.5273s
Epoch: 14 cost time: 9.515382766723633
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972840).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0034346
	speed: 0.1007s/iter; left time: 4052.8242s
	iters: 200, epoch: 15 | loss: 0.0003652
	speed: 0.0167s/iter; left time: 671.7816s
	iters: 300, epoch: 15 | loss: 0.0007775
	speed: 0.0176s/iter; left time: 704.2498s
	iters: 400, epoch: 15 | loss: 0.0187986
	speed: 0.0164s/iter; left time: 654.2612s
Epoch: 15 cost time: 8.570192575454712
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0099071
	speed: 0.0732s/iter; left time: 2912.7940s
	iters: 200, epoch: 16 | loss: 0.0373626
	speed: 0.0162s/iter; left time: 642.4845s
	iters: 300, epoch: 16 | loss: 0.1811282
	speed: 0.0176s/iter; left time: 697.2835s
	iters: 400, epoch: 16 | loss: 0.0015283
	speed: 0.0192s/iter; left time: 758.6947s
Epoch: 16 cost time: 8.540072202682495
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0096821
	speed: 0.0724s/iter; left time: 2844.7545s
	iters: 200, epoch: 17 | loss: 0.0829446
	speed: 0.0166s/iter; left time: 649.1898s
	iters: 300, epoch: 17 | loss: 0.0005542
	speed: 0.0160s/iter; left time: 624.5686s
	iters: 400, epoch: 17 | loss: 0.0043720
	speed: 0.0180s/iter; left time: 701.3286s
Epoch: 17 cost time: 8.187050819396973
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0085586
	speed: 0.0768s/iter; left time: 2981.5651s
	iters: 200, epoch: 18 | loss: 0.0003104
	speed: 0.0155s/iter; left time: 599.0781s
	iters: 300, epoch: 18 | loss: 0.0070807
	speed: 0.0160s/iter; left time: 619.2757s
	iters: 400, epoch: 18 | loss: 0.0106599
	speed: 0.0167s/iter; left time: 643.6419s
Epoch: 18 cost time: 8.012899398803711
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0253377
	speed: 0.1070s/iter; left time: 4105.8407s
	iters: 200, epoch: 19 | loss: 0.0721659
	speed: 0.0214s/iter; left time: 819.4710s
	iters: 300, epoch: 19 | loss: 0.0013598
	speed: 0.0216s/iter; left time: 824.9579s
	iters: 400, epoch: 19 | loss: 0.0119629
	speed: 0.0191s/iter; left time: 726.6602s
Epoch: 19 cost time: 10.035272598266602
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.973412).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0115064
	speed: 0.1085s/iter; left time: 4110.8323s
	iters: 200, epoch: 20 | loss: 0.0212312
	speed: 0.0197s/iter; left time: 742.5780s
	iters: 300, epoch: 20 | loss: 0.0366640
	speed: 0.0190s/iter; left time: 715.3399s
	iters: 400, epoch: 20 | loss: 0.0009863
	speed: 0.0189s/iter; left time: 710.5000s
Epoch: 20 cost time: 9.503908634185791
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0023990
	speed: 0.0940s/iter; left time: 3517.3115s
	iters: 200, epoch: 21 | loss: 0.0028609
	speed: 0.0185s/iter; left time: 689.3930s
	iters: 300, epoch: 21 | loss: 0.0011535
	speed: 0.0198s/iter; left time: 737.4695s
	iters: 400, epoch: 21 | loss: 0.0002102
	speed: 0.0212s/iter; left time: 788.6279s
Epoch: 21 cost time: 9.468121767044067
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0010573
	speed: 0.0917s/iter; left time: 3389.1419s
	iters: 200, epoch: 22 | loss: 0.3468703
	speed: 0.0193s/iter; left time: 712.2157s
	iters: 300, epoch: 22 | loss: 0.0049853
	speed: 0.0198s/iter; left time: 726.5490s
	iters: 400, epoch: 22 | loss: 0.0099938
	speed: 0.0189s/iter; left time: 692.0370s
Epoch: 22 cost time: 9.31344985961914
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0009928
	speed: 0.0909s/iter; left time: 3315.7944s
	iters: 200, epoch: 23 | loss: 0.0019620
	speed: 0.0183s/iter; left time: 664.2756s
	iters: 300, epoch: 23 | loss: 0.1522414
	speed: 0.0193s/iter; left time: 700.1220s
	iters: 400, epoch: 23 | loss: 0.0533312
	speed: 0.0187s/iter; left time: 675.7760s
Epoch: 23 cost time: 9.064511060714722
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0012963
	speed: 0.0961s/iter; left time: 3459.7337s
	iters: 200, epoch: 24 | loss: 0.0015002
	speed: 0.0165s/iter; left time: 591.0285s
	iters: 300, epoch: 24 | loss: 0.0540177
	speed: 0.0152s/iter; left time: 546.1342s
	iters: 400, epoch: 24 | loss: 0.0008894
	speed: 0.0163s/iter; left time: 583.8016s
Epoch: 24 cost time: 7.929785966873169
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0053748
	speed: 0.0753s/iter; left time: 2677.3648s
	iters: 200, epoch: 25 | loss: 0.0046546
	speed: 0.0188s/iter; left time: 667.5333s
	iters: 300, epoch: 25 | loss: 0.1360286
	speed: 0.0174s/iter; left time: 616.1597s
	iters: 400, epoch: 25 | loss: 0.0007834
	speed: 0.0164s/iter; left time: 578.5119s
Epoch: 25 cost time: 8.52183485031128
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0016036
	speed: 0.0741s/iter; left time: 2598.5196s
	iters: 200, epoch: 26 | loss: 0.0006827
	speed: 0.0206s/iter; left time: 720.4829s
	iters: 300, epoch: 26 | loss: 0.0003199
	speed: 0.0224s/iter; left time: 780.9282s
	iters: 400, epoch: 26 | loss: 0.0004075
	speed: 0.0242s/iter; left time: 839.9864s
Epoch: 26 cost time: 10.309311866760254
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.976843).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0005774
	speed: 0.0938s/iter; left time: 3247.4328s
	iters: 200, epoch: 27 | loss: 0.0004635
	speed: 0.0178s/iter; left time: 613.3481s
	iters: 300, epoch: 27 | loss: 0.0023716
	speed: 0.0171s/iter; left time: 589.7933s
	iters: 400, epoch: 27 | loss: 0.0009648
	speed: 0.0161s/iter; left time: 553.1082s
Epoch: 27 cost time: 8.44243597984314
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0201904
	speed: 0.0709s/iter; left time: 2421.0386s
	iters: 200, epoch: 28 | loss: 0.0004541
	speed: 0.0154s/iter; left time: 522.5437s
	iters: 300, epoch: 28 | loss: 0.0009811
	speed: 0.0181s/iter; left time: 613.4491s
	iters: 400, epoch: 28 | loss: 0.0014542
	speed: 0.0184s/iter; left time: 622.1594s
Epoch: 28 cost time: 8.289659261703491
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976843 --> -0.980274).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0195283
	speed: 0.1016s/iter; left time: 3421.0719s
	iters: 200, epoch: 29 | loss: 0.0023639
	speed: 0.0176s/iter; left time: 592.2858s
	iters: 300, epoch: 29 | loss: 0.0102637
	speed: 0.0185s/iter; left time: 619.2206s
	iters: 400, epoch: 29 | loss: 0.0007953
	speed: 0.0182s/iter; left time: 607.3932s
Epoch: 29 cost time: 8.900270938873291
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0026685
	speed: 0.0935s/iter; left time: 3104.1965s
	iters: 200, epoch: 30 | loss: 0.0015923
	speed: 0.0166s/iter; left time: 548.4087s
	iters: 300, epoch: 30 | loss: 0.0001751
	speed: 0.0152s/iter; left time: 501.7592s
	iters: 400, epoch: 30 | loss: 0.0066362
	speed: 0.0152s/iter; left time: 500.3478s
Epoch: 30 cost time: 8.021146059036255
Epoch: 30, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0063227
	speed: 0.0708s/iter; left time: 2318.4746s
	iters: 200, epoch: 31 | loss: 0.0016503
	speed: 0.0160s/iter; left time: 523.2465s
	iters: 300, epoch: 31 | loss: 0.0065060
	speed: 0.0164s/iter; left time: 534.5060s
	iters: 400, epoch: 31 | loss: 0.0002401
	speed: 0.0166s/iter; left time: 539.8997s
Epoch: 31 cost time: 7.8677895069122314
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0003941
	speed: 0.0854s/iter; left time: 2754.4457s
	iters: 200, epoch: 32 | loss: 0.0780088
	speed: 0.0178s/iter; left time: 572.7504s
	iters: 300, epoch: 32 | loss: 0.0002746
	speed: 0.0189s/iter; left time: 605.5397s
	iters: 400, epoch: 32 | loss: 0.0110437
	speed: 0.0197s/iter; left time: 630.3982s
Epoch: 32 cost time: 9.015540599822998
Epoch: 32, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0019599
	speed: 0.1084s/iter; left time: 3447.0431s
	iters: 200, epoch: 33 | loss: 0.0003589
	speed: 0.0212s/iter; left time: 672.6901s
	iters: 300, epoch: 33 | loss: 0.0132794
	speed: 0.0236s/iter; left time: 744.5362s
	iters: 400, epoch: 33 | loss: 0.1135190
	speed: 0.0203s/iter; left time: 640.2975s
Epoch: 33 cost time: 10.379604578018188
Epoch: 33, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0013032
	speed: 0.0921s/iter; left time: 2885.4692s
	iters: 200, epoch: 34 | loss: 0.0205622
	speed: 0.0171s/iter; left time: 535.4605s
	iters: 300, epoch: 34 | loss: 0.0105569
	speed: 0.0186s/iter; left time: 577.8230s
	iters: 400, epoch: 34 | loss: 0.0048929
	speed: 0.0182s/iter; left time: 564.6343s
Epoch: 34 cost time: 8.990015745162964
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0810868
	speed: 0.1141s/iter; left time: 3520.2568s
	iters: 200, epoch: 35 | loss: 0.0007819
	speed: 0.0239s/iter; left time: 734.6318s
	iters: 300, epoch: 35 | loss: 0.0001987
	speed: 0.0238s/iter; left time: 730.0314s
	iters: 400, epoch: 35 | loss: 0.0007481
	speed: 0.0251s/iter; left time: 766.8917s
Epoch: 35 cost time: 12.037627935409546
Epoch: 35, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0015811
	speed: 0.1183s/iter; left time: 3595.7482s
	iters: 200, epoch: 36 | loss: 0.0023077
	speed: 0.0197s/iter; left time: 596.7362s
	iters: 300, epoch: 36 | loss: 0.0451354
	speed: 0.0199s/iter; left time: 599.8055s
	iters: 400, epoch: 36 | loss: 0.0007783
	speed: 0.0191s/iter; left time: 574.2652s
Epoch: 36 cost time: 9.542836427688599
Epoch: 36, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0345464
	speed: 0.0957s/iter; left time: 2862.0908s
	iters: 200, epoch: 37 | loss: 0.0001832
	speed: 0.0191s/iter; left time: 570.2049s
	iters: 300, epoch: 37 | loss: 0.0014413
	speed: 0.0175s/iter; left time: 519.8449s
	iters: 400, epoch: 37 | loss: 0.1817007
	speed: 0.0176s/iter; left time: 520.7850s
Epoch: 37 cost time: 9.05628252029419
Epoch: 37, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0021821
	speed: 0.1045s/iter; left time: 3077.2186s
	iters: 200, epoch: 38 | loss: 0.0013246
	speed: 0.0186s/iter; left time: 544.6316s
	iters: 300, epoch: 38 | loss: 0.0240638
	speed: 0.0180s/iter; left time: 525.5273s
	iters: 400, epoch: 38 | loss: 0.0003416
	speed: 0.0184s/iter; left time: 536.3606s
Epoch: 38 cost time: 9.267463445663452
Epoch: 38, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_Crossformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 78850
model size : 0.98MB
