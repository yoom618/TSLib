Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7838571071624756
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.275 Vali Acc: 0.377 Test Loss: 1.275 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 1.153425693511963
Epoch: 2, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.028 Vali Acc: 0.507 Test Loss: 1.028 Test Acc: 0.507
Validation loss decreased (-0.376799 --> -0.507236).  Saving model ...
Epoch: 3 cost time: 1.3920106887817383
Epoch: 3, Steps: 9 | Train Loss: 0.912 Vali Loss: 0.931 Vali Acc: 0.486 Test Loss: 0.931 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3656384944915771
Epoch: 4, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
Validation loss decreased (-0.507236 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 1.2398746013641357
Epoch: 5, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.692 Vali Acc: 0.717 Test Loss: 0.692 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1554231643676758
Epoch: 6, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.717 Vali Acc: 0.703 Test Loss: 0.717 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.21152925491333
Epoch: 7, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.2516982555389404
Epoch: 8, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 1.2124626636505127
Epoch: 9, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.637 Vali Acc: 0.746 Test Loss: 0.637 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2039248943328857
Epoch: 10, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.497 Vali Acc: 0.790 Test Loss: 0.497 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1423840522766113
Epoch: 11, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.732 Vali Acc: 0.804 Test Loss: 0.732 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 1.0864171981811523
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.804341 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 1.1501491069793701
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1546809673309326
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1060059070587158
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.815 Vali Acc: 0.826 Test Loss: 0.815 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2428114414215088
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1701698303222656
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0926499366760254
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.729 Vali Acc: 0.812 Test Loss: 0.729 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1492040157318115
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.792 Vali Acc: 0.797 Test Loss: 0.792 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1783349514007568
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3820264339447021
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.249 Vali Acc: 0.652 Test Loss: 1.249 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1610913276672363
Epoch: 22, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.529 Vali Acc: 0.797 Test Loss: 0.529 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 14310208
model size : 59.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.90425705909729
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.297 Vali Acc: 0.312 Test Loss: 1.297 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.3193206787109375
Epoch: 2, Steps: 9 | Train Loss: 1.135 Vali Loss: 0.970 Vali Acc: 0.572 Test Loss: 0.970 Test Acc: 0.572
Validation loss decreased (-0.311581 --> -0.572454).  Saving model ...
Epoch: 3 cost time: 1.382965087890625
Epoch: 3, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.869 Vali Acc: 0.529 Test Loss: 0.869 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3909156322479248
Epoch: 4, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.809 Vali Acc: 0.630 Test Loss: 0.809 Test Acc: 0.630
Validation loss decreased (-0.572454 --> -0.630427).  Saving model ...
Epoch: 5 cost time: 1.5376238822937012
Epoch: 5, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
Validation loss decreased (-0.630427 --> -0.760863).  Saving model ...
Epoch: 6 cost time: 1.2889955043792725
Epoch: 6, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.759 Vali Acc: 0.754 Test Loss: 0.759 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2639970779418945
Epoch: 7, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.658 Vali Acc: 0.768 Test Loss: 0.658 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.2904765605926514
Epoch: 8, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.783 Vali Acc: 0.696 Test Loss: 0.783 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.307466745376587
Epoch: 9, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.716 Vali Acc: 0.746 Test Loss: 0.716 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2583520412445068
Epoch: 10, Steps: 9 | Train Loss: 0.129 Vali Loss: 1.007 Vali Acc: 0.710 Test Loss: 1.007 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4024887084960938
Epoch: 11, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.768 Vali Acc: 0.739 Test Loss: 0.768 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2178218364715576
Epoch: 12, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.768109 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 1.2511467933654785
Epoch: 13, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 1.2902147769927979
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4486720561981201
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.649 Vali Acc: 0.826 Test Loss: 0.649 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2737951278686523
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 1.402433156967163
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869560).  Saving model ...
Epoch: 18 cost time: 1.291949987411499
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.877 Test Loss: 0.528 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 19 cost time: 1.3267583847045898
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2827510833740234
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 21 cost time: 1.3136119842529297
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3207154273986816
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3302125930786133
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.877 Test Loss: 0.513 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.186509370803833
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.884 Test Loss: 0.498 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.373847484588623
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.884 Test Loss: 0.489 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3544940948486328
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.338033676147461
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.884 Test Loss: 0.492 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.458752155303955
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.877 Test Loss: 0.502 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4196515083312988
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.877 Test Loss: 0.514 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4898934364318848
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.877 Test Loss: 0.517 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 14301248
model size : 59.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5241811275482178
Epoch: 1, Steps: 9 | Train Loss: 1.504 Vali Loss: 1.423 Vali Acc: 0.355 Test Loss: 1.423 Test Acc: 0.355
Validation loss decreased (inf --> -0.355058).  Saving model ...
Epoch: 2 cost time: 1.331498622894287
Epoch: 2, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.355058 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 1.2140026092529297
Epoch: 3, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.885 Vali Acc: 0.645 Test Loss: 0.885 Test Acc: 0.645
Validation loss decreased (-0.514481 --> -0.644919).  Saving model ...
Epoch: 4 cost time: 1.3442490100860596
Epoch: 4, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.910 Vali Acc: 0.601 Test Loss: 0.910 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4557349681854248
Epoch: 5, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.885 Vali Acc: 0.630 Test Loss: 0.885 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4705638885498047
Epoch: 6, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.779 Vali Acc: 0.732 Test Loss: 0.779 Test Acc: 0.732
Validation loss decreased (-0.644919 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 1.3165242671966553
Epoch: 7, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.661 Vali Acc: 0.754 Test Loss: 0.661 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 1.4189889430999756
Epoch: 8, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.740 Vali Acc: 0.696 Test Loss: 0.740 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5712177753448486
Epoch: 9, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.287992000579834
Epoch: 10, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.608 Vali Acc: 0.768 Test Loss: 0.608 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.479640245437622
Epoch: 11, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 12 cost time: 1.3353691101074219
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.658 Vali Acc: 0.775 Test Loss: 0.658 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4820284843444824
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
Validation loss decreased (-0.804343 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 1.6355023384094238
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6225264072418213
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4005789756774902
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.687760829925537
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4888339042663574
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.848 Test Loss: 0.660 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6394476890563965
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.862 Test Loss: 0.483 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 1.6185989379882812
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.504915475845337
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.855 Test Loss: 0.588 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4743068218231201
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 23 cost time: 1.8052425384521484
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4244463443756104
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5196404457092285
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.870 Test Loss: 0.579 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3297014236450195
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4548993110656738
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4009439945220947
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.870 Test Loss: 0.553 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4970953464508057
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.870 Test Loss: 0.551 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4785621166229248
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.870 Test Loss: 0.580 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.725029706954956
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.870 Test Loss: 0.579 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.480346918106079
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.877 Test Loss: 0.556 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 33 cost time: 1.534327507019043
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.877 Test Loss: 0.560 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.443617820739746
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6372244358062744
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.870 Test Loss: 0.582 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5507755279541016
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.870 Test Loss: 0.607 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5882039070129395
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3973455429077148
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.870 Test Loss: 0.580 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.561591386795044
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.877 Test Loss: 0.596 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3705461025238037
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.862 Test Loss: 0.600 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3838400840759277
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.862 Test Loss: 0.608 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.798302412033081
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.862 Test Loss: 0.625 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 14292288
model size : 59.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.428319215774536
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.406 Vali Acc: 0.529 Test Loss: 1.406 Test Acc: 0.529
Validation loss decreased (inf --> -0.528971).  Saving model ...
Epoch: 2 cost time: 1.3703527450561523
Epoch: 2, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.222 Vali Acc: 0.399 Test Loss: 1.222 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.302302360534668
Epoch: 3, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.906 Vali Acc: 0.623 Test Loss: 0.906 Test Acc: 0.623
Validation loss decreased (-0.528971 --> -0.623179).  Saving model ...
Epoch: 4 cost time: 1.4332952499389648
Epoch: 4, Steps: 9 | Train Loss: 0.668 Vali Loss: 0.809 Vali Acc: 0.667 Test Loss: 0.809 Test Acc: 0.667
Validation loss decreased (-0.623179 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 1.6943004131317139
Epoch: 5, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.656 Vali Acc: 0.681 Test Loss: 0.656 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681153).  Saving model ...
Epoch: 6 cost time: 1.6206655502319336
Epoch: 6, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.570 Vali Acc: 0.797 Test Loss: 0.570 Test Acc: 0.797
Validation loss decreased (-0.681153 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 1.4803221225738525
Epoch: 7, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.554 Vali Acc: 0.797 Test Loss: 0.554 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 8 cost time: 1.5090084075927734
Epoch: 8, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.611 Vali Acc: 0.703 Test Loss: 0.611 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6312065124511719
Epoch: 9, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4999310970306396
Epoch: 10, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 1.7617108821868896
Epoch: 11, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.831 Vali Acc: 0.783 Test Loss: 0.831 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5879974365234375
Epoch: 12, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.731 Vali Acc: 0.790 Test Loss: 0.731 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7682809829711914
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 1.766510248184204
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4370465278625488
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.705 Vali Acc: 0.841 Test Loss: 0.705 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7204463481903076
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8472387790679932
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.826 Test Loss: 0.762 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0827388763427734
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.862 Test Loss: 0.606 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 1.7410697937011719
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5754189491271973
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.855 Test Loss: 0.616 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6088306903839111
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.848 Test Loss: 0.627 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6731979846954346
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8716681003570557
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.855 Test Loss: 0.614 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7189223766326904
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.848 Test Loss: 0.628 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5231821537017822
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.862 Test Loss: 0.604 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 26 cost time: 1.3904259204864502
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.862 Test Loss: 0.615 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6142628192901611
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.870 Test Loss: 0.633 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869559).  Saving model ...
Epoch: 28 cost time: 1.5192265510559082
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.870 Test Loss: 0.632 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869559).  Saving model ...
Epoch: 29 cost time: 1.5883970260620117
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.862 Test Loss: 0.631 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6239314079284668
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.862 Test Loss: 0.641 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4149138927459717
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.862 Test Loss: 0.646 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6890077590942383
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.862 Test Loss: 0.637 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8929564952850342
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.862 Test Loss: 0.627 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.486269474029541
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.862 Test Loss: 0.639 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.581847906112671
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.862 Test Loss: 0.637 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.581603765487671
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.862 Test Loss: 0.629 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.6103765964508057
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.870 Test Loss: 0.641 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.520878791809082
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.870 Test Loss: 0.647 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 14283328
model size : 59.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5172970294952393
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.392 Vali Acc: 0.355 Test Loss: 1.392 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.4497060775756836
Epoch: 2, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.355059 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.781130313873291
Epoch: 3, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.876 Vali Acc: 0.594 Test Loss: 0.876 Test Acc: 0.594
Validation loss decreased (-0.499988 --> -0.594194).  Saving model ...
Epoch: 4 cost time: 1.6478936672210693
Epoch: 4, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.885 Vali Acc: 0.565 Test Loss: 0.885 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7625410556793213
Epoch: 5, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
Validation loss decreased (-0.594194 --> -0.746371).  Saving model ...
Epoch: 6 cost time: 1.6229779720306396
Epoch: 6, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.710 Vali Acc: 0.681 Test Loss: 0.710 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.776642084121704
Epoch: 7, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.677 Vali Acc: 0.703 Test Loss: 0.677 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8660528659820557
Epoch: 8, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.534 Vali Acc: 0.797 Test Loss: 0.534 Test Acc: 0.797
Validation loss decreased (-0.746371 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 1.7340271472930908
Epoch: 9, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.530 Vali Acc: 0.768 Test Loss: 0.530 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6430222988128662
Epoch: 10, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.791 Vali Acc: 0.659 Test Loss: 0.791 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6334304809570312
Epoch: 11, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.500 Vali Acc: 0.812 Test Loss: 0.500 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 1.5821068286895752
Epoch: 12, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.974 Vali Acc: 0.710 Test Loss: 0.974 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8294401168823242
Epoch: 13, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.7230103015899658
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5362880229949951
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5920166969299316
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.5565357208251953
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 1.6645441055297852
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 1.8351397514343262
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3650355339050293
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6591579914093018
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4879822731018066
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6927690505981445
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.862 Test Loss: 0.518 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7503979206085205
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5378367900848389
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6996955871582031
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8589973449707031
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5950331687927246
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 11946304
model size : 50.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1733484268188477
Epoch: 1, Steps: 9 | Train Loss: 1.497 Vali Loss: 1.350 Vali Acc: 0.275 Test Loss: 1.350 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.5658142566680908
Epoch: 2, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.187 Vali Acc: 0.435 Test Loss: 1.187 Test Acc: 0.435
Validation loss decreased (-0.275349 --> -0.434771).  Saving model ...
Epoch: 3 cost time: 1.976053237915039
Epoch: 3, Steps: 9 | Train Loss: 0.943 Vali Loss: 0.917 Vali Acc: 0.435 Test Loss: 0.917 Test Acc: 0.435
Validation loss decreased (-0.434771 --> -0.434773).  Saving model ...
Epoch: 4 cost time: 1.8507928848266602
Epoch: 4, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.713 Vali Acc: 0.688 Test Loss: 0.713 Test Acc: 0.688
Validation loss decreased (-0.434773 --> -0.688399).  Saving model ...
Epoch: 5 cost time: 1.5510506629943848
Epoch: 5, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.801 Vali Acc: 0.630 Test Loss: 0.801 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.549379587173462
Epoch: 6, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.713 Vali Acc: 0.696 Test Loss: 0.713 Test Acc: 0.696
Validation loss decreased (-0.688399 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.9842026233673096
Epoch: 7, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.930 Vali Acc: 0.688 Test Loss: 0.930 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.873610019683838
Epoch: 8, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.554 Vali Acc: 0.761 Test Loss: 0.554 Test Acc: 0.761
Validation loss decreased (-0.695645 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.4979419708251953
Epoch: 9, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.539 Vali Acc: 0.754 Test Loss: 0.539 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4601428508758545
Epoch: 10, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
Validation loss decreased (-0.760864 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 1.769071340560913
Epoch: 11, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.670 Vali Acc: 0.710 Test Loss: 0.670 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9303102493286133
Epoch: 12, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 1.3575177192687988
Epoch: 13, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.828 Vali Acc: 0.746 Test Loss: 0.828 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7376012802124023
Epoch: 14, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6133744716644287
Epoch: 15, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.588 Vali Acc: 0.790 Test Loss: 0.588 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5413341522216797
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.854 Vali Acc: 0.761 Test Loss: 0.854 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4610373973846436
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4938197135925293
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.668 Vali Acc: 0.804 Test Loss: 0.668 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.830883264541626
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9221341609954834
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 1.5181779861450195
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8581230640411377
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7472076416015625
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 24 cost time: 1.9867489337921143
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9098360538482666
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6301243305206299
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 27 cost time: 1.640505313873291
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8349223136901855
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.862 Test Loss: 0.544 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1289491653442383
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7012460231781006
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.862 Test Loss: 0.548 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6282851696014404
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.862 Test Loss: 0.555 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6289324760437012
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.862 Test Loss: 0.552 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.772636890411377
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.862 Test Loss: 0.558 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6209685802459717
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.862 Test Loss: 0.563 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.722933292388916
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.862 Test Loss: 0.565 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6761956214904785
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.855 Test Loss: 0.561 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 11937344
model size : 50.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.199358224868774
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.462 Vali Acc: 0.268 Test Loss: 1.462 Test Acc: 0.268
Validation loss decreased (inf --> -0.268101).  Saving model ...
Epoch: 2 cost time: 1.7537500858306885
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.069 Vali Acc: 0.536 Test Loss: 1.069 Test Acc: 0.536
Validation loss decreased (-0.268101 --> -0.536221).  Saving model ...
Epoch: 3 cost time: 1.5072319507598877
Epoch: 3, Steps: 9 | Train Loss: 0.890 Vali Loss: 0.962 Vali Acc: 0.486 Test Loss: 0.962 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6466825008392334
Epoch: 4, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.942 Vali Acc: 0.659 Test Loss: 0.942 Test Acc: 0.659
Validation loss decreased (-0.536221 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.5717511177062988
Epoch: 5, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.851 Vali Acc: 0.558 Test Loss: 0.851 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4297144412994385
Epoch: 6, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.677 Vali Acc: 0.674 Test Loss: 0.677 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673906).  Saving model ...
Epoch: 7 cost time: 1.4769787788391113
Epoch: 7, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
Validation loss decreased (-0.673906 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.3312640190124512
Epoch: 8, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 1.4697341918945312
Epoch: 9, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.528 Vali Acc: 0.768 Test Loss: 0.528 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3701081275939941
Epoch: 10, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.750 Vali Acc: 0.768 Test Loss: 0.750 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.32509183883667
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
Validation loss decreased (-0.775357 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 1.4828662872314453
Epoch: 12, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.640 Vali Acc: 0.761 Test Loss: 0.640 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4577147960662842
Epoch: 13, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5271286964416504
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5535531044006348
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.816 Vali Acc: 0.783 Test Loss: 0.816 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.572227954864502
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6038658618927002
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.643 Vali Acc: 0.761 Test Loss: 0.643 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.419632911682129
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 19 cost time: 1.3362069129943848
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 1.5701391696929932
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
Validation loss decreased (-0.833328 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 1.5212595462799072
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.899 Test Loss: 0.424 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898546).  Saving model ...
Epoch: 22 cost time: 1.9772241115570068
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.884 Test Loss: 0.451 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6033871173858643
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3951084613800049
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5441765785217285
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6743478775024414
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5790061950683594
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.549170970916748
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.479705572128296
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5474638938903809
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5791528224945068
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 11928384
model size : 50.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.440760850906372
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.383 Vali Acc: 0.362 Test Loss: 1.383 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.4288454055786133
Epoch: 2, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.069 Vali Acc: 0.514 Test Loss: 1.069 Test Acc: 0.514
Validation loss decreased (-0.362305 --> -0.514482).  Saving model ...
Epoch: 3 cost time: 1.5411367416381836
Epoch: 3, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.879 Vali Acc: 0.623 Test Loss: 0.879 Test Acc: 0.623
Validation loss decreased (-0.514482 --> -0.623180).  Saving model ...
Epoch: 4 cost time: 1.482173204421997
Epoch: 4, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.844 Vali Acc: 0.623 Test Loss: 0.844 Test Acc: 0.623
Validation loss decreased (-0.623180 --> -0.623180).  Saving model ...
Epoch: 5 cost time: 1.4821882247924805
Epoch: 5, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.664 Vali Acc: 0.710 Test Loss: 0.664 Test Acc: 0.710
Validation loss decreased (-0.623180 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.3926243782043457
Epoch: 6, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.817 Vali Acc: 0.725 Test Loss: 0.817 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.2986729145050049
Epoch: 7, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.609 Vali Acc: 0.790 Test Loss: 0.609 Test Acc: 0.790
Validation loss decreased (-0.724630 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 1.350287914276123
Epoch: 8, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 1.832273006439209
Epoch: 9, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.770 Vali Acc: 0.732 Test Loss: 0.770 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5433228015899658
Epoch: 10, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4385569095611572
Epoch: 11, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 1.354679822921753
Epoch: 12, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.679 Vali Acc: 0.819 Test Loss: 0.679 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5635261535644531
Epoch: 13, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.799 Vali Acc: 0.797 Test Loss: 0.799 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5447587966918945
Epoch: 14, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.757 Vali Acc: 0.790 Test Loss: 0.757 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7693312168121338
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.776 Vali Acc: 0.819 Test Loss: 0.776 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5971052646636963
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.700 Vali Acc: 0.848 Test Loss: 0.700 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847819).  Saving model ...
Epoch: 17 cost time: 1.4032924175262451
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.664 Vali Acc: 0.848 Test Loss: 0.664 Test Acc: 0.848
Validation loss decreased (-0.847819 --> -0.847819).  Saving model ...
Epoch: 18 cost time: 1.3024532794952393
Epoch: 18, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4033091068267822
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
Validation loss decreased (-0.847819 --> -0.855066).  Saving model ...
Epoch: 20 cost time: 1.466763973236084
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.524329662322998
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.625 Vali Acc: 0.848 Test Loss: 0.625 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6184985637664795
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6574280261993408
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862313).  Saving model ...
Epoch: 24 cost time: 1.5263078212738037
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 25 cost time: 1.5241928100585938
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.699 Vali Acc: 0.833 Test Loss: 0.699 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6488044261932373
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5792675018310547
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.788 Vali Acc: 0.819 Test Loss: 0.788 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.767915964126587
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4533135890960693
Epoch: 29, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.989 Vali Acc: 0.703 Test Loss: 0.989 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5223870277404785
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.653 Vali Acc: 0.797 Test Loss: 0.653 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6909902095794678
Epoch: 31, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.955 Vali Acc: 0.790 Test Loss: 0.955 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5252983570098877
Epoch: 32, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.523376226425171
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5533936023712158
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 11919424
model size : 50.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.832815408706665
Epoch: 1, Steps: 9 | Train Loss: 1.431 Vali Loss: 1.332 Vali Acc: 0.333 Test Loss: 1.332 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.729783296585083
Epoch: 2, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.088 Vali Acc: 0.514 Test Loss: 1.088 Test Acc: 0.514
Validation loss decreased (-0.333320 --> -0.514482).  Saving model ...
Epoch: 3 cost time: 1.812157154083252
Epoch: 3, Steps: 9 | Train Loss: 0.880 Vali Loss: 0.858 Vali Acc: 0.630 Test Loss: 0.858 Test Acc: 0.630
Validation loss decreased (-0.514482 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 1.7226672172546387
Epoch: 4, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.774 Vali Acc: 0.688 Test Loss: 0.774 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688398).  Saving model ...
Epoch: 5 cost time: 1.736863374710083
Epoch: 5, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.701 Vali Acc: 0.710 Test Loss: 0.701 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.9609038829803467
Epoch: 6, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.667 Vali Acc: 0.688 Test Loss: 0.667 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6614866256713867
Epoch: 7, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 1.6969101428985596
Epoch: 8, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.651 Vali Acc: 0.797 Test Loss: 0.651 Test Acc: 0.797
Validation loss decreased (-0.731878 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 1.5439095497131348
Epoch: 9, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.718 Vali Acc: 0.790 Test Loss: 0.718 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7458417415618896
Epoch: 10, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.703 Vali Acc: 0.754 Test Loss: 0.703 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6564419269561768
Epoch: 11, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.6911985874176025
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.783 Vali Acc: 0.797 Test Loss: 0.783 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8457164764404297
Epoch: 13, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.803 Vali Acc: 0.797 Test Loss: 0.803 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8529040813446045
Epoch: 14, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 1.6318795680999756
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.847820).  Saving model ...
Epoch: 16 cost time: 1.5651381015777588
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.448 Vali Acc: 0.812 Test Loss: 0.448 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5981321334838867
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.701 Vali Acc: 0.855 Test Loss: 0.701 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855065).  Saving model ...
Epoch: 18 cost time: 1.5446834564208984
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 1.7403016090393066
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 20 cost time: 1.8703322410583496
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.855 Test Loss: 0.633 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.824244737625122
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.504 Vali Acc: 0.819 Test Loss: 0.504 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.554474115371704
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.848 Test Loss: 0.668 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.404209852218628
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6277036666870117
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.842 Vali Acc: 0.812 Test Loss: 0.842 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0522994995117188
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9453811645507812
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.094 Vali Acc: 0.609 Test Loss: 1.094 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.47233247756958
Epoch: 27, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4897143840789795
Epoch: 28, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.849 Vali Acc: 0.819 Test Loss: 0.849 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8353016376495361
Epoch: 29, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.862 Test Loss: 0.517 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 10764352
model size : 46.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.887974262237549
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.764249563217163
Epoch: 2, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.061 Vali Acc: 0.486 Test Loss: 1.061 Test Acc: 0.486
Validation loss decreased (-0.333320 --> -0.485497).  Saving model ...
Epoch: 3 cost time: 1.4540824890136719
Epoch: 3, Steps: 9 | Train Loss: 0.940 Vali Loss: 0.877 Vali Acc: 0.601 Test Loss: 0.877 Test Acc: 0.601
Validation loss decreased (-0.485497 --> -0.601441).  Saving model ...
Epoch: 4 cost time: 1.6182911396026611
Epoch: 4, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.850 Vali Acc: 0.659 Test Loss: 0.850 Test Acc: 0.659
Validation loss decreased (-0.601441 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 1.386817455291748
Epoch: 5, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.690 Vali Acc: 0.659 Test Loss: 0.690 Test Acc: 0.659
Validation loss decreased (-0.659412 --> -0.659413).  Saving model ...
Epoch: 6 cost time: 1.39253568649292
Epoch: 6, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
Validation loss decreased (-0.659413 --> -0.775357).  Saving model ...
Epoch: 7 cost time: 1.5260059833526611
Epoch: 7, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5481512546539307
Epoch: 8, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 1.5668673515319824
Epoch: 9, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6888010501861572
Epoch: 10, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.756 Vali Acc: 0.804 Test Loss: 0.756 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804340).  Saving model ...
Epoch: 11 cost time: 1.3939969539642334
Epoch: 11, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.543 Vali Acc: 0.790 Test Loss: 0.543 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2964258193969727
Epoch: 12, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 1.6611225605010986
Epoch: 13, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.844 Vali Acc: 0.768 Test Loss: 0.844 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6574149131774902
Epoch: 14, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6090960502624512
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.427 Vali Acc: 0.826 Test Loss: 0.427 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 16 cost time: 1.4056596755981445
Epoch: 16, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.701 Vali Acc: 0.826 Test Loss: 0.701 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4320318698883057
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.714 Vali Acc: 0.826 Test Loss: 0.714 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4115581512451172
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
Validation loss decreased (-0.826083 --> -0.869562).  Saving model ...
Epoch: 19 cost time: 1.5918679237365723
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.855 Test Loss: 0.614 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6672687530517578
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5949647426605225
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.291123867034912
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4965434074401855
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4918363094329834
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.877 Test Loss: 0.458 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876807).  Saving model ...
Epoch: 25 cost time: 1.3914499282836914
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4661474227905273
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.877 Test Loss: 0.490 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.605644702911377
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.877 Test Loss: 0.493 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5293374061584473
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.358421802520752
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.877 Test Loss: 0.480 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.351830244064331
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.542522668838501
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.877 Test Loss: 0.477 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.421649694442749
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.877 Test Loss: 0.506 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.689953327178955
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.877 Test Loss: 0.499 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6494140625
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.877 Test Loss: 0.483 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 10755392
model size : 46.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7082884311676025
Epoch: 1, Steps: 9 | Train Loss: 1.484 Vali Loss: 1.332 Vali Acc: 0.297 Test Loss: 1.332 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.6079695224761963
Epoch: 2, Steps: 9 | Train Loss: 1.235 Vali Loss: 1.091 Vali Acc: 0.543 Test Loss: 1.091 Test Acc: 0.543
Validation loss decreased (-0.297088 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 1.44572114944458
Epoch: 3, Steps: 9 | Train Loss: 0.965 Vali Loss: 1.051 Vali Acc: 0.464 Test Loss: 1.051 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4690070152282715
Epoch: 4, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.788 Vali Acc: 0.667 Test Loss: 0.788 Test Acc: 0.667
Validation loss decreased (-0.543467 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 1.6003499031066895
Epoch: 5, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
Validation loss decreased (-0.666659 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 1.9425883293151855
Epoch: 6, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.707 Vali Acc: 0.681 Test Loss: 0.707 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7193324565887451
Epoch: 7, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.752 Vali Acc: 0.674 Test Loss: 0.752 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4509525299072266
Epoch: 8, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.674 Vali Acc: 0.754 Test Loss: 0.674 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 1.67745041847229
Epoch: 9, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7097034454345703
Epoch: 10, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.492 Vali Acc: 0.775 Test Loss: 0.492 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.532740592956543
Epoch: 11, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.491 Vali Acc: 0.768 Test Loss: 0.491 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4195661544799805
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782604).  Saving model ...
Epoch: 13 cost time: 1.4934844970703125
Epoch: 13, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
Validation loss decreased (-0.782604 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 1.3969104290008545
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.645 Vali Acc: 0.739 Test Loss: 0.645 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.60306978225708
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.848 Test Loss: 0.556 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.6025750637054443
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.587 Vali Acc: 0.826 Test Loss: 0.587 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4520971775054932
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.436084508895874
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6325364112854004
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.4990172386169434
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.841 Test Loss: 0.631 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3334887027740479
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4487099647521973
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4791479110717773
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4533343315124512
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.870 Test Loss: 0.554 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5596983432769775
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.404858112335205
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4321086406707764
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5332746505737305
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5704472064971924
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.855 Test Loss: 0.531 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 10746432
model size : 46.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3170406818389893
Epoch: 1, Steps: 9 | Train Loss: 1.482 Vali Loss: 1.491 Vali Acc: 0.297 Test Loss: 1.491 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 1.4453010559082031
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.141 Vali Acc: 0.536 Test Loss: 1.141 Test Acc: 0.536
Validation loss decreased (-0.297087 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 1.5877914428710938
Epoch: 3, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.967 Vali Acc: 0.630 Test Loss: 0.967 Test Acc: 0.630
Validation loss decreased (-0.536220 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 1.6749169826507568
Epoch: 4, Steps: 9 | Train Loss: 0.736 Vali Loss: 0.764 Vali Acc: 0.667 Test Loss: 0.764 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 1.719221591949463
Epoch: 5, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.685 Vali Acc: 0.710 Test Loss: 0.685 Test Acc: 0.710
Validation loss decreased (-0.666659 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.7340373992919922
Epoch: 6, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.732 Vali Acc: 0.645 Test Loss: 0.732 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0089261531829834
Epoch: 7, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.669 Vali Acc: 0.754 Test Loss: 0.669 Test Acc: 0.754
Validation loss decreased (-0.710138 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 1.6378090381622314
Epoch: 8, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
Validation loss decreased (-0.753616 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 1.7506444454193115
Epoch: 9, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5019347667694092
Epoch: 10, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.458 Vali Acc: 0.804 Test Loss: 0.458 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8764703273773193
Epoch: 11, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.493 Vali Acc: 0.797 Test Loss: 0.493 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7304480075836182
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.485 Vali Acc: 0.775 Test Loss: 0.485 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6632928848266602
Epoch: 13, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6275434494018555
Epoch: 14, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7333803176879883
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.438793659210205
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 1.7729182243347168
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.545 Vali Acc: 0.848 Test Loss: 0.545 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 1.6039321422576904
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 1.4431588649749756
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.046809673309326
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8823394775390625
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7400543689727783
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7973017692565918
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5381989479064941
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.719442367553711
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5961830615997314
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9713308811187744
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5270864963531494
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 10737472
model size : 46.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2228710651397705
Epoch: 1, Steps: 9 | Train Loss: 1.496 Vali Loss: 1.461 Vali Acc: 0.275 Test Loss: 1.461 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.5781030654907227
Epoch: 2, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.200 Vali Acc: 0.551 Test Loss: 1.200 Test Acc: 0.551
Validation loss decreased (-0.275348 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 1.602876901626587
Epoch: 3, Steps: 9 | Train Loss: 0.979 Vali Loss: 0.929 Vali Acc: 0.565 Test Loss: 0.929 Test Acc: 0.565
Validation loss decreased (-0.550713 --> -0.565208).  Saving model ...
Epoch: 4 cost time: 1.4904844760894775
Epoch: 4, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.774 Vali Acc: 0.681 Test Loss: 0.774 Test Acc: 0.681
Validation loss decreased (-0.565208 --> -0.681152).  Saving model ...
Epoch: 5 cost time: 1.4649016857147217
Epoch: 5, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.762 Vali Acc: 0.659 Test Loss: 0.762 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5107860565185547
Epoch: 6, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.661 Vali Acc: 0.739 Test Loss: 0.661 Test Acc: 0.739
Validation loss decreased (-0.681152 --> -0.739124).  Saving model ...
Epoch: 7 cost time: 1.4413671493530273
Epoch: 7, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.553 Vali Acc: 0.768 Test Loss: 0.553 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 1.7025666236877441
Epoch: 8, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.720 Vali Acc: 0.681 Test Loss: 0.720 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5603609085083008
Epoch: 9, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.750955581665039
Epoch: 10, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.768 Vali Acc: 0.732 Test Loss: 0.768 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.776909351348877
Epoch: 11, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.768110 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.6827075481414795
Epoch: 12, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.602 Vali Acc: 0.739 Test Loss: 0.602 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.780327320098877
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.637 Vali Acc: 0.790 Test Loss: 0.637 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4709348678588867
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7633461952209473
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9678854942321777
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8963894844055176
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 1.5056798458099365
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5610592365264893
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6707417964935303
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.870 Test Loss: 0.553 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 1.8195784091949463
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.870 Test Loss: 0.528 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 22 cost time: 1.7515692710876465
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.862 Test Loss: 0.563 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4636540412902832
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.662506103515625
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.870 Test Loss: 0.518 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 25 cost time: 2.0196874141693115
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.870 Test Loss: 0.548 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7595398426055908
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.870 Test Loss: 0.559 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6347503662109375
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.862 Test Loss: 0.549 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7860162258148193
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.870 Test Loss: 0.532 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.920436143875122
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.870 Test Loss: 0.548 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7418513298034668
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7751743793487549
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.870 Test Loss: 0.555 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6711585521697998
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.870 Test Loss: 0.560 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.7670948505401611
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.916802167892456
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.870 Test Loss: 0.558 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 10173376
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.318173885345459
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.241 Vali Acc: 0.406 Test Loss: 1.241 Test Acc: 0.406
Validation loss decreased (inf --> -0.405785).  Saving model ...
Epoch: 2 cost time: 1.630842685699463
Epoch: 2, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.081 Vali Acc: 0.529 Test Loss: 1.081 Test Acc: 0.529
Validation loss decreased (-0.405785 --> -0.528975).  Saving model ...
Epoch: 3 cost time: 1.6621675491333008
Epoch: 3, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.041 Vali Acc: 0.457 Test Loss: 1.041 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.590303659439087
Epoch: 4, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.815 Vali Acc: 0.638 Test Loss: 0.815 Test Acc: 0.638
Validation loss decreased (-0.528975 --> -0.637673).  Saving model ...
Epoch: 5 cost time: 1.642624855041504
Epoch: 5, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.720 Vali Acc: 0.630 Test Loss: 0.720 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5115716457366943
Epoch: 6, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.667 Vali Acc: 0.703 Test Loss: 0.667 Test Acc: 0.703
Validation loss decreased (-0.637673 --> -0.702892).  Saving model ...
Epoch: 7 cost time: 1.5394341945648193
Epoch: 7, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.702892 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 1.47013521194458
Epoch: 8, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.911 Vali Acc: 0.703 Test Loss: 0.911 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5876269340515137
Epoch: 9, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4413628578186035
Epoch: 10, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.616 Vali Acc: 0.754 Test Loss: 0.616 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7432103157043457
Epoch: 11, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.553 Vali Acc: 0.790 Test Loss: 0.553 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 12 cost time: 1.6019086837768555
Epoch: 12, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.574 Vali Acc: 0.848 Test Loss: 0.574 Test Acc: 0.848
Validation loss decreased (-0.789850 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 1.6861042976379395
Epoch: 13, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.745823860168457
Epoch: 14, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.640 Vali Acc: 0.790 Test Loss: 0.640 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7564406394958496
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7831790447235107
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8888938426971436
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.608 Vali Acc: 0.848 Test Loss: 0.608 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7587785720825195
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 1.8097293376922607
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.9004173278808594
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.853121280670166
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.855 Test Loss: 0.597 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.764575719833374
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.425095558166504
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.862 Test Loss: 0.508 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7818446159362793
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.877697467803955
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6847333908081055
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7718019485473633
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.855 Test Loss: 0.559 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8175456523895264
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.862 Test Loss: 0.558 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8446197509765625
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 10164416
model size : 43.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3849263191223145
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.420 Vali Acc: 0.239 Test Loss: 1.420 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.4764339923858643
Epoch: 2, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.108 Vali Acc: 0.442 Test Loss: 1.108 Test Acc: 0.442
Validation loss decreased (-0.239116 --> -0.442018).  Saving model ...
Epoch: 3 cost time: 1.550523281097412
Epoch: 3, Steps: 9 | Train Loss: 0.907 Vali Loss: 0.853 Vali Acc: 0.616 Test Loss: 0.853 Test Acc: 0.616
Validation loss decreased (-0.442018 --> -0.615933).  Saving model ...
Epoch: 4 cost time: 1.7042300701141357
Epoch: 4, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.779 Vali Acc: 0.681 Test Loss: 0.779 Test Acc: 0.681
Validation loss decreased (-0.615933 --> -0.681152).  Saving model ...
Epoch: 5 cost time: 1.7689013481140137
Epoch: 5, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.702 Vali Acc: 0.725 Test Loss: 0.702 Test Acc: 0.725
Validation loss decreased (-0.681152 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.5375797748565674
Epoch: 6, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.824 Vali Acc: 0.638 Test Loss: 0.824 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3608179092407227
Epoch: 7, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.639 Vali Acc: 0.754 Test Loss: 0.639 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 1.5392439365386963
Epoch: 8, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.690 Vali Acc: 0.681 Test Loss: 0.690 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5462043285369873
Epoch: 9, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.5671954154968262
Epoch: 10, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.378450632095337
Epoch: 11, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.455970048904419
Epoch: 12, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.602 Vali Acc: 0.739 Test Loss: 0.602 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4220075607299805
Epoch: 13, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.717 Vali Acc: 0.768 Test Loss: 0.717 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.682596206665039
Epoch: 14, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6488983631134033
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 1.4358971118927002
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.481665849685669
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.648 Vali Acc: 0.797 Test Loss: 0.648 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5155518054962158
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5139226913452148
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.562636375427246
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.790 Test Loss: 0.648 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8787896633148193
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.599046230316162
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7307219505310059
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6134796142578125
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5876052379608154
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.855 Test Loss: 0.538 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 10155456
model size : 43.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.587625026702881
Epoch: 1, Steps: 9 | Train Loss: 1.548 Vali Loss: 1.363 Vali Acc: 0.420 Test Loss: 1.363 Test Acc: 0.420
Validation loss decreased (inf --> -0.420276).  Saving model ...
Epoch: 2 cost time: 1.5136301517486572
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.196 Vali Acc: 0.413 Test Loss: 1.196 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9396312236785889
Epoch: 3, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.908 Vali Acc: 0.609 Test Loss: 0.908 Test Acc: 0.609
Validation loss decreased (-0.420276 --> -0.608687).  Saving model ...
Epoch: 4 cost time: 1.9067673683166504
Epoch: 4, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.820 Vali Acc: 0.638 Test Loss: 0.820 Test Acc: 0.638
Validation loss decreased (-0.608687 --> -0.637673).  Saving model ...
Epoch: 5 cost time: 1.505030870437622
Epoch: 5, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.740 Vali Acc: 0.623 Test Loss: 0.740 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6409633159637451
Epoch: 6, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.674 Vali Acc: 0.746 Test Loss: 0.674 Test Acc: 0.746
Validation loss decreased (-0.637673 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.6274218559265137
Epoch: 7, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5364265441894531
Epoch: 8, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.714 Vali Acc: 0.674 Test Loss: 0.714 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9179341793060303
Epoch: 9, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.652 Vali Acc: 0.725 Test Loss: 0.652 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3808043003082275
Epoch: 10, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.486 Vali Acc: 0.804 Test Loss: 0.486 Test Acc: 0.804
Validation loss decreased (-0.746370 --> -0.804343).  Saving model ...
Epoch: 11 cost time: 1.5377380847930908
Epoch: 11, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 1.9161124229431152
Epoch: 12, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6943073272705078
Epoch: 13, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.721 Vali Acc: 0.768 Test Loss: 0.721 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4929766654968262
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.606 Vali Acc: 0.797 Test Loss: 0.606 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4938545227050781
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.599 Vali Acc: 0.790 Test Loss: 0.599 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5135631561279297
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.469055414199829
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.841 Test Loss: 0.643 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840573).  Saving model ...
Epoch: 18 cost time: 1.916426181793213
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.804 Test Loss: 0.636 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5713787078857422
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.860 Vali Acc: 0.812 Test Loss: 0.860 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4960665702819824
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.714 Vali Acc: 0.848 Test Loss: 0.714 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847819).  Saving model ...
Epoch: 21 cost time: 1.4926464557647705
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.876 Vali Acc: 0.732 Test Loss: 0.876 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.871572732925415
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.182 Vali Acc: 0.754 Test Loss: 1.182 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.631352424621582
Epoch: 23, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6186068058013916
Epoch: 24, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.942 Vali Acc: 0.790 Test Loss: 0.942 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.476757287979126
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.487 Vali Acc: 0.870 Test Loss: 0.487 Test Acc: 0.870
Validation loss decreased (-0.847819 --> -0.869560).  Saving model ...
Epoch: 26 cost time: 1.356377124786377
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7372281551361084
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.919 Vali Acc: 0.826 Test Loss: 0.919 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7243056297302246
Epoch: 28, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5177466869354248
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
Validation loss decreased (-0.869560 --> -0.891300).  Saving model ...
Epoch: 30 cost time: 1.4882299900054932
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9698264598846436
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6326568126678467
Epoch: 32, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.564 Vali Acc: 0.790 Test Loss: 1.564 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5651650428771973
Epoch: 33, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.502169132232666
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.535 Vali Acc: 0.848 Test Loss: 0.535 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.624943733215332
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7237052917480469
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.841588020324707
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.884 Test Loss: 0.512 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.8301606178283691
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.884 Test Loss: 0.543 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.5228033065795898
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.884 Test Loss: 0.533 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 10146496
model size : 43.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5536012649536133
Epoch: 1, Steps: 9 | Train Loss: 1.565 Vali Loss: 1.465 Vali Acc: 0.210 Test Loss: 1.465 Test Acc: 0.210
Validation loss decreased (inf --> -0.210130).  Saving model ...
Epoch: 2 cost time: 1.786705732345581
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.240 Vali Acc: 0.413 Test Loss: 1.240 Test Acc: 0.413
Validation loss decreased (-0.210130 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.571042776107788
Epoch: 3, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.055 Vali Acc: 0.464 Test Loss: 1.055 Test Acc: 0.464
Validation loss decreased (-0.413031 --> -0.463758).  Saving model ...
Epoch: 4 cost time: 1.7349722385406494
Epoch: 4, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.999 Vali Acc: 0.565 Test Loss: 0.999 Test Acc: 0.565
Validation loss decreased (-0.463758 --> -0.565207).  Saving model ...
Epoch: 5 cost time: 1.5318689346313477
Epoch: 5, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.826 Vali Acc: 0.623 Test Loss: 0.826 Test Acc: 0.623
Validation loss decreased (-0.565207 --> -0.623180).  Saving model ...
Epoch: 6 cost time: 1.596127986907959
Epoch: 6, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
Validation loss decreased (-0.623180 --> -0.717384).  Saving model ...
Epoch: 7 cost time: 1.4615757465362549
Epoch: 7, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 1.7107737064361572
Epoch: 8, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 1.6300065517425537
Epoch: 9, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7388393878936768
Epoch: 10, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.679 Vali Acc: 0.739 Test Loss: 0.679 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7518348693847656
Epoch: 11, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 12 cost time: 1.6960244178771973
Epoch: 12, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.581 Vali Acc: 0.797 Test Loss: 0.581 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.468355655670166
Epoch: 13, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.468 Vali Acc: 0.790 Test Loss: 0.468 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7809834480285645
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 1.7154204845428467
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.523 Vali Acc: 0.797 Test Loss: 0.523 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8115463256835938
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7090423107147217
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.493 Vali Acc: 0.804 Test Loss: 0.493 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.51698637008667
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 1.5854637622833252
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 20 cost time: 1.8097577095031738
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 1.6698157787322998
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5400934219360352
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 1.3361265659332275
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5834097862243652
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6112730503082275
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6988580226898193
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7725369930267334
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7655456066131592
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.79945707321167
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9644405841827393
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6472737789154053
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6076698303222656
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 4800448
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.351120948791504
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.372 Vali Acc: 0.326 Test Loss: 1.372 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 2.0313191413879395
Epoch: 2, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.163 Vali Acc: 0.493 Test Loss: 1.163 Test Acc: 0.493
Validation loss decreased (-0.326073 --> -0.492742).  Saving model ...
Epoch: 3 cost time: 1.8692066669464111
Epoch: 3, Steps: 9 | Train Loss: 0.976 Vali Loss: 0.966 Vali Acc: 0.609 Test Loss: 0.966 Test Acc: 0.609
Validation loss decreased (-0.492742 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 1.6350605487823486
Epoch: 4, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.799 Vali Acc: 0.703 Test Loss: 0.799 Test Acc: 0.703
Validation loss decreased (-0.608686 --> -0.702891).  Saving model ...
Epoch: 5 cost time: 1.5748026371002197
Epoch: 5, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.683 Vali Acc: 0.725 Test Loss: 0.683 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.5328545570373535
Epoch: 6, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.678 Vali Acc: 0.696 Test Loss: 0.678 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9507460594177246
Epoch: 7, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.655 Vali Acc: 0.696 Test Loss: 0.655 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.546032190322876
Epoch: 8, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 9 cost time: 1.7125523090362549
Epoch: 9, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
Validation loss decreased (-0.746370 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 1.7625832557678223
Epoch: 10, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 1.5615828037261963
Epoch: 11, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 1.8148415088653564
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4948220252990723
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 1.6218655109405518
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.471 Vali Acc: 0.812 Test Loss: 0.471 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5667970180511475
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6974213123321533
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 1.6819148063659668
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4136981964111328
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3755998611450195
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6642062664031982
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.788835048675537
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8860273361206055
Epoch: 22, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
Validation loss decreased (-0.869561 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 1.467207908630371
Epoch: 23, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.462 Vali Acc: 0.797 Test Loss: 0.462 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.506091594696045
Epoch: 24, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.740 Vali Acc: 0.797 Test Loss: 0.740 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.515944242477417
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 26 cost time: 1.908003807067871
Epoch: 26, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.335 Vali Acc: 0.848 Test Loss: 0.335 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0316340923309326
Epoch: 27, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6204416751861572
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.563 Vali Acc: 0.870 Test Loss: 0.563 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5249147415161133
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5909841060638428
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6337425708770752
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7540545463562012
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4579885005950928
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7063541412353516
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8450210094451904
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 4795968
model size : 20.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.976344585418701
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.295 Vali Acc: 0.420 Test Loss: 1.295 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.5020933151245117
Epoch: 2, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.100 Vali Acc: 0.449 Test Loss: 1.100 Test Acc: 0.449
Validation loss decreased (-0.420277 --> -0.449264).  Saving model ...
Epoch: 3 cost time: 1.7485792636871338
Epoch: 3, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.997 Vali Acc: 0.601 Test Loss: 0.997 Test Acc: 0.601
Validation loss decreased (-0.449264 --> -0.601439).  Saving model ...
Epoch: 4 cost time: 1.8108899593353271
Epoch: 4, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.824 Vali Acc: 0.652 Test Loss: 0.824 Test Acc: 0.652
Validation loss decreased (-0.601439 --> -0.652166).  Saving model ...
Epoch: 5 cost time: 1.8492820262908936
Epoch: 5, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.714 Vali Acc: 0.725 Test Loss: 0.714 Test Acc: 0.725
Validation loss decreased (-0.652166 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.5149166584014893
Epoch: 6, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.638 Vali Acc: 0.710 Test Loss: 0.638 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.602785587310791
Epoch: 7, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.578 Vali Acc: 0.768 Test Loss: 0.578 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 1.5981707572937012
Epoch: 8, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.708 Vali Acc: 0.732 Test Loss: 0.708 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7623445987701416
Epoch: 9, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
Validation loss decreased (-0.768110 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 1.5953991413116455
Epoch: 10, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.653 Vali Acc: 0.768 Test Loss: 0.653 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7183763980865479
Epoch: 11, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.665 Vali Acc: 0.797 Test Loss: 0.665 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.658672571182251
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.601 Vali Acc: 0.790 Test Loss: 0.601 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5446064472198486
Epoch: 13, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 1.6019313335418701
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.464021921157837
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5356826782226562
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.368 Vali Acc: 0.848 Test Loss: 0.368 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 1.6628479957580566
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6922752857208252
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.436 Vali Acc: 0.804 Test Loss: 0.436 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7263610363006592
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5248222351074219
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 1.5828301906585693
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7439875602722168
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9860618114471436
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.703 Vali Acc: 0.819 Test Loss: 0.703 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7962453365325928
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.740 Vali Acc: 0.812 Test Loss: 0.740 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5119996070861816
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.804 Test Loss: 0.559 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6047263145446777
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9056000709533691
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7602555751800537
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.506 Vali Acc: 0.884 Test Loss: 0.506 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884053).  Saving model ...
Epoch: 29 cost time: 1.9627368450164795
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.647897720336914
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6126234531402588
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8108909130096436
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.884 Test Loss: 0.505 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 33 cost time: 1.8355085849761963
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 34 cost time: 1.7603414058685303
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5118463039398193
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6754529476165771
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.877 Test Loss: 0.509 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7473888397216797
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.884 Test Loss: 0.509 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8320298194885254
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.877 Test Loss: 0.503 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8745133876800537
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6150734424591064
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4769549369812012
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.9736735820770264
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.673919916152954
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 4791488
model size : 20.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9513659477233887
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.396 Vali Acc: 0.232 Test Loss: 1.396 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.6468548774719238
Epoch: 2, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.214 Vali Acc: 0.377 Test Loss: 1.214 Test Acc: 0.377
Validation loss decreased (-0.231870 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 1.5535783767700195
Epoch: 3, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
Validation loss decreased (-0.376799 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.7822930812835693
Epoch: 4, Steps: 9 | Train Loss: 0.835 Vali Loss: 0.862 Vali Acc: 0.572 Test Loss: 0.862 Test Acc: 0.572
Validation loss decreased (-0.514482 --> -0.572455).  Saving model ...
Epoch: 5 cost time: 1.6905062198638916
Epoch: 5, Steps: 9 | Train Loss: 0.641 Vali Loss: 0.752 Vali Acc: 0.638 Test Loss: 0.752 Test Acc: 0.638
Validation loss decreased (-0.572455 --> -0.637674).  Saving model ...
Epoch: 6 cost time: 1.609278917312622
Epoch: 6, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.721 Vali Acc: 0.681 Test Loss: 0.721 Test Acc: 0.681
Validation loss decreased (-0.637674 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 1.4918694496154785
Epoch: 7, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.738 Vali Acc: 0.616 Test Loss: 0.738 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5940234661102295
Epoch: 8, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.700 Vali Acc: 0.710 Test Loss: 0.700 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 1.574340581893921
Epoch: 9, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.664 Vali Acc: 0.761 Test Loss: 0.664 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760863).  Saving model ...
Epoch: 10 cost time: 1.709993600845337
Epoch: 10, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.760863 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 1.6930394172668457
Epoch: 11, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.577 Vali Acc: 0.797 Test Loss: 0.577 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6684114933013916
Epoch: 12, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7216112613677979
Epoch: 13, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.798227071762085
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 1.5608396530151367
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7993950843811035
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.353 Vali Acc: 0.855 Test Loss: 0.353 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 17 cost time: 1.8083984851837158
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6717979907989502
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 1.795379638671875
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 1.763746976852417
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.466576337814331
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.686077356338501
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 1.4341223239898682
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5395209789276123
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.891 Test Loss: 0.434 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5366089344024658
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 1.5191831588745117
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5221092700958252
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.891 Test Loss: 0.423 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.47011137008667
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7695770263671875
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.716398000717163
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.796140432357788
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4887754917144775
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7210261821746826
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.891 Test Loss: 0.394 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4814107418060303
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.891 Test Loss: 0.425 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7022311687469482
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 36 cost time: 1.7096986770629883
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.899 Test Loss: 0.403 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0638811588287354
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.899 Test Loss: 0.399 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4608192443847656
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.899 Test Loss: 0.417 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.688298225402832
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9806420803070068
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.899 Test Loss: 0.396 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.239403009414673
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.397 Vali Acc: 0.899 Test Loss: 0.397 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6161115169525146
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.899 Test Loss: 0.429 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.967712640762329
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.899 Test Loss: 0.411 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6325852870941162
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.899 Test Loss: 0.424 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.8061158657073975
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.899 Test Loss: 0.393 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 4787008
model size : 20.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5425095558166504
Epoch: 1, Steps: 9 | Train Loss: 1.512 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 2.100191354751587
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.224624 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 2.0743958950042725
Epoch: 3, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.050 Vali Acc: 0.514 Test Loss: 1.050 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.6160609722137451
Epoch: 4, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.898 Vali Acc: 0.630 Test Loss: 0.898 Test Acc: 0.630
Validation loss decreased (-0.514482 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 1.9095993041992188
Epoch: 5, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.792 Vali Acc: 0.601 Test Loss: 0.792 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6962130069732666
Epoch: 6, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.707 Vali Acc: 0.696 Test Loss: 0.707 Test Acc: 0.696
Validation loss decreased (-0.630426 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.8058507442474365
Epoch: 7, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.711 Vali Acc: 0.659 Test Loss: 0.711 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6220910549163818
Epoch: 8, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.695645 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.9004371166229248
Epoch: 9, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
Validation loss decreased (-0.760864 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 1.6262428760528564
Epoch: 10, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.510 Vali Acc: 0.797 Test Loss: 0.510 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8857147693634033
Epoch: 11, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 1.5529823303222656
Epoch: 12, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.565 Vali Acc: 0.790 Test Loss: 0.565 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6592764854431152
Epoch: 13, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5792486667633057
Epoch: 14, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9672582149505615
Epoch: 15, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 1.5736110210418701
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0423030853271484
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.355 Vali Acc: 0.855 Test Loss: 0.355 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 18 cost time: 1.714780330657959
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6901319026947021
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.327 Vali Acc: 0.870 Test Loss: 0.327 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 20 cost time: 1.766418218612671
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.602527141571045
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5306763648986816
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5510268211364746
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 1.7182955741882324
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5900702476501465
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 26 cost time: 1.6643002033233643
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7400891780853271
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.722923755645752
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.778028964996338
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.705944299697876
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.946796178817749
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9037830829620361
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8268463611602783
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6497764587402344
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6871635913848877
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 3616192
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.683971405029297
Epoch: 1, Steps: 9 | Train Loss: 1.512 Vali Loss: 1.382 Vali Acc: 0.268 Test Loss: 1.382 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.5836565494537354
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.231 Vali Acc: 0.449 Test Loss: 1.231 Test Acc: 0.449
Validation loss decreased (-0.268102 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.7058744430541992
Epoch: 3, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.078 Vali Acc: 0.471 Test Loss: 1.078 Test Acc: 0.471
Validation loss decreased (-0.449263 --> -0.471004).  Saving model ...
Epoch: 4 cost time: 1.752227544784546
Epoch: 4, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.927 Vali Acc: 0.638 Test Loss: 0.927 Test Acc: 0.638
Validation loss decreased (-0.471004 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 1.64878511428833
Epoch: 5, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.813 Vali Acc: 0.616 Test Loss: 0.813 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4835264682769775
Epoch: 6, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.696 Vali Acc: 0.703 Test Loss: 0.696 Test Acc: 0.703
Validation loss decreased (-0.637672 --> -0.702892).  Saving model ...
Epoch: 7 cost time: 1.5922503471374512
Epoch: 7, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.665 Vali Acc: 0.739 Test Loss: 0.665 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.6563012599945068
Epoch: 8, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5972919464111328
Epoch: 9, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.537 Vali Acc: 0.797 Test Loss: 0.537 Test Acc: 0.797
Validation loss decreased (-0.739124 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.5410058498382568
Epoch: 10, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.624 Vali Acc: 0.754 Test Loss: 0.624 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8012995719909668
Epoch: 11, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.394 Vali Acc: 0.841 Test Loss: 0.394 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840576).  Saving model ...
Epoch: 12 cost time: 1.636672019958496
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.487 Vali Acc: 0.797 Test Loss: 0.487 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6191809177398682
Epoch: 13, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.416 Vali Acc: 0.826 Test Loss: 0.416 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.601527452468872
Epoch: 14, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.618 Vali Acc: 0.797 Test Loss: 0.618 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5497913360595703
Epoch: 15, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.344 Vali Acc: 0.841 Test Loss: 0.344 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 1.6951720714569092
Epoch: 16, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.481 Vali Acc: 0.797 Test Loss: 0.481 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8689186573028564
Epoch: 17, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.301 Vali Acc: 0.877 Test Loss: 0.301 Test Acc: 0.877
Validation loss decreased (-0.840576 --> -0.876809).  Saving model ...
Epoch: 18 cost time: 1.519956350326538
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.317 Vali Acc: 0.877 Test Loss: 0.317 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4135994911193848
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.600081443786621
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6215503215789795
Epoch: 21, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.480 Vali Acc: 0.812 Test Loss: 0.480 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0984675884246826
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.520 Vali Acc: 0.870 Test Loss: 0.520 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.894294261932373
Epoch: 23, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884055).  Saving model ...
Epoch: 24 cost time: 1.5132412910461426
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6315617561340332
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9935650825500488
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8850653171539307
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7390527725219727
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 29 cost time: 1.6516780853271484
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7060155868530273
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7220473289489746
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6360394954681396
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5784125328063965
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5197951793670654
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.884 Test Loss: 0.352 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.978365182876587
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3822813034057617
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5989649295806885
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7674202919006348
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 3611712
model size : 16.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.759356737136841
Epoch: 1, Steps: 9 | Train Loss: 1.594 Vali Loss: 1.291 Vali Acc: 0.420 Test Loss: 1.291 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.4866282939910889
Epoch: 2, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.156 Vali Acc: 0.507 Test Loss: 1.156 Test Acc: 0.507
Validation loss decreased (-0.420277 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.4318997859954834
Epoch: 3, Steps: 9 | Train Loss: 1.160 Vali Loss: 0.973 Vali Acc: 0.551 Test Loss: 0.973 Test Acc: 0.551
Validation loss decreased (-0.507235 --> -0.550715).  Saving model ...
Epoch: 4 cost time: 1.7386126518249512
Epoch: 4, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.846 Vali Acc: 0.681 Test Loss: 0.846 Test Acc: 0.681
Validation loss decreased (-0.550715 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 1.6415190696716309
Epoch: 5, Steps: 9 | Train Loss: 0.693 Vali Loss: 0.745 Vali Acc: 0.659 Test Loss: 0.745 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.561628818511963
Epoch: 6, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.691 Vali Acc: 0.681 Test Loss: 0.691 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681153).  Saving model ...
Epoch: 7 cost time: 1.731835126876831
Epoch: 7, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.655 Vali Acc: 0.645 Test Loss: 0.655 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5869596004486084
Epoch: 8, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.672 Vali Acc: 0.688 Test Loss: 0.672 Test Acc: 0.688
Validation loss decreased (-0.681153 --> -0.688399).  Saving model ...
Epoch: 9 cost time: 1.543888807296753
Epoch: 9, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.644 Vali Acc: 0.696 Test Loss: 0.644 Test Acc: 0.696
Validation loss decreased (-0.688399 --> -0.695646).  Saving model ...
Epoch: 10 cost time: 1.6105101108551025
Epoch: 10, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.526 Vali Acc: 0.790 Test Loss: 0.526 Test Acc: 0.790
Validation loss decreased (-0.695646 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 1.5142841339111328
Epoch: 11, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.487 Vali Acc: 0.783 Test Loss: 0.487 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7284998893737793
Epoch: 12, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.618 Vali Acc: 0.848 Test Loss: 0.618 Test Acc: 0.848
Validation loss decreased (-0.789850 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 1.7946515083312988
Epoch: 13, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8968777656555176
Epoch: 14, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.729321002960205
Epoch: 15, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.490490436553955
Epoch: 16, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 1.4498012065887451
Epoch: 17, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 1.7774021625518799
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.8383569717407227
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 1.4912071228027344
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 1.7149710655212402
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.592599630355835
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.439 Vali Acc: 0.870 Test Loss: 0.439 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 1.9499690532684326
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4654970169067383
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9008769989013672
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 1.781684160232544
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6370432376861572
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6310932636260986
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4939360618591309
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.396371841430664
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6575379371643066
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5088691711425781
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.685333490371704
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3930151462554932
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.680281400680542
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 3607232
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4382238388061523
Epoch: 1, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.273 Vali Acc: 0.355 Test Loss: 1.273 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 1.660531759262085
Epoch: 2, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.043 Vali Acc: 0.565 Test Loss: 1.043 Test Acc: 0.565
Validation loss decreased (-0.355060 --> -0.565207).  Saving model ...
Epoch: 3 cost time: 1.8129558563232422
Epoch: 3, Steps: 9 | Train Loss: 1.001 Vali Loss: 0.926 Vali Acc: 0.609 Test Loss: 0.926 Test Acc: 0.609
Validation loss decreased (-0.565207 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 1.7698633670806885
Epoch: 4, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.871 Vali Acc: 0.645 Test Loss: 0.871 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644919).  Saving model ...
Epoch: 5 cost time: 1.6957941055297852
Epoch: 5, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.796 Vali Acc: 0.645 Test Loss: 0.796 Test Acc: 0.645
Validation loss decreased (-0.644919 --> -0.644920).  Saving model ...
Epoch: 6 cost time: 1.663116693496704
Epoch: 6, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.703 Vali Acc: 0.710 Test Loss: 0.703 Test Acc: 0.710
Validation loss decreased (-0.644920 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.7923874855041504
Epoch: 7, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.670 Vali Acc: 0.725 Test Loss: 0.670 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 8 cost time: 2.0604896545410156
Epoch: 8, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.581 Vali Acc: 0.761 Test Loss: 0.581 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.67342209815979
Epoch: 9, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.645 Vali Acc: 0.746 Test Loss: 0.645 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5584287643432617
Epoch: 10, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.606 Vali Acc: 0.739 Test Loss: 0.606 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8282642364501953
Epoch: 11, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5627989768981934
Epoch: 12, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.676 Vali Acc: 0.739 Test Loss: 0.676 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.055992603302002
Epoch: 13, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
Validation loss decreased (-0.760864 --> -0.869560).  Saving model ...
Epoch: 14 cost time: 1.687906265258789
Epoch: 14, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.545 Vali Acc: 0.761 Test Loss: 0.545 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.850980520248413
Epoch: 15, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8964171409606934
Epoch: 16, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.598 Vali Acc: 0.826 Test Loss: 0.598 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.735825777053833
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 1.8411519527435303
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 1.738083839416504
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.009899139404297
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.104649066925049
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8528201580047607
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.439 Vali Acc: 0.884 Test Loss: 0.439 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6376094818115234
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.774430751800537
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.945338487625122
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1305465698242188
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8834724426269531
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7226977348327637
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 3602752
model size : 16.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.550544023513794
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.369 Vali Acc: 0.261 Test Loss: 1.369 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.7273988723754883
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.244 Vali Acc: 0.449 Test Loss: 1.244 Test Acc: 0.449
Validation loss decreased (-0.260856 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.5483384132385254
Epoch: 3, Steps: 9 | Train Loss: 1.180 Vali Loss: 1.135 Vali Acc: 0.478 Test Loss: 1.135 Test Acc: 0.478
Validation loss decreased (-0.449263 --> -0.478250).  Saving model ...
Epoch: 4 cost time: 1.648118257522583
Epoch: 4, Steps: 9 | Train Loss: 0.971 Vali Loss: 1.032 Vali Acc: 0.587 Test Loss: 1.032 Test Acc: 0.587
Validation loss decreased (-0.478250 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 1.7574758529663086
Epoch: 5, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.900 Vali Acc: 0.609 Test Loss: 0.900 Test Acc: 0.609
Validation loss decreased (-0.586946 --> -0.608687).  Saving model ...
Epoch: 6 cost time: 1.4967331886291504
Epoch: 6, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.815 Vali Acc: 0.609 Test Loss: 0.815 Test Acc: 0.609
Validation loss decreased (-0.608687 --> -0.608688).  Saving model ...
Epoch: 7 cost time: 1.6487138271331787
Epoch: 7, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.733 Vali Acc: 0.652 Test Loss: 0.733 Test Acc: 0.652
Validation loss decreased (-0.608688 --> -0.652167).  Saving model ...
Epoch: 8 cost time: 1.571387529373169
Epoch: 8, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.692 Vali Acc: 0.703 Test Loss: 0.692 Test Acc: 0.703
Validation loss decreased (-0.652167 --> -0.702892).  Saving model ...
Epoch: 9 cost time: 1.6871423721313477
Epoch: 9, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.652 Vali Acc: 0.790 Test Loss: 0.652 Test Acc: 0.790
Validation loss decreased (-0.702892 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.661567211151123
Epoch: 10, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 1.6093850135803223
Epoch: 11, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.567 Vali Acc: 0.768 Test Loss: 0.567 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5238311290740967
Epoch: 12, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 1.498915672302246
Epoch: 13, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.529 Vali Acc: 0.754 Test Loss: 0.529 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5895013809204102
Epoch: 14, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 1.653149127960205
Epoch: 15, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.505 Vali Acc: 0.819 Test Loss: 0.505 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5646400451660156
Epoch: 16, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.427 Vali Acc: 0.819 Test Loss: 0.427 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.543461799621582
Epoch: 17, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.53663969039917
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.5539264678955078
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4733645915985107
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 1.5776009559631348
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 22 cost time: 1.746337652206421
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9553356170654297
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5304391384124756
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9046378135681152
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8009381294250488
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.061450719833374
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6365163326263428
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7393715381622314
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.855 Test Loss: 0.578 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.672938346862793
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5143983364105225
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 3024064
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.272960186004639
Epoch: 1, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.358 Vali Acc: 0.290 Test Loss: 1.358 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.9524807929992676
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.236 Vali Acc: 0.348 Test Loss: 1.236 Test Acc: 0.348
Validation loss decreased (-0.289841 --> -0.347814).  Saving model ...
Epoch: 3 cost time: 1.8955461978912354
Epoch: 3, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.078 Vali Acc: 0.551 Test Loss: 1.078 Test Acc: 0.551
Validation loss decreased (-0.347814 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 2.076301336288452
Epoch: 4, Steps: 9 | Train Loss: 0.896 Vali Loss: 0.926 Vali Acc: 0.638 Test Loss: 0.926 Test Acc: 0.638
Validation loss decreased (-0.550714 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 1.7573401927947998
Epoch: 5, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.780 Vali Acc: 0.696 Test Loss: 0.780 Test Acc: 0.696
Validation loss decreased (-0.637672 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 1.9090886116027832
Epoch: 6, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.735 Vali Acc: 0.703 Test Loss: 0.735 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.8218715190887451
Epoch: 7, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.6244630813598633
Epoch: 8, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.599 Vali Acc: 0.754 Test Loss: 0.599 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.871861219406128
Epoch: 9, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.616 Vali Acc: 0.732 Test Loss: 0.616 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7850656509399414
Epoch: 10, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 1.71364164352417
Epoch: 11, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 1.7695791721343994
Epoch: 12, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.522132158279419
Epoch: 13, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.580 Vali Acc: 0.761 Test Loss: 0.580 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.013047933578491
Epoch: 14, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782602).  Saving model ...
Epoch: 15 cost time: 2.055349111557007
Epoch: 15, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 16 cost time: 1.3367671966552734
Epoch: 16, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.551 Vali Acc: 0.804 Test Loss: 0.551 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 1.4364933967590332
Epoch: 17, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 18 cost time: 1.5576434135437012
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.8621506690979004
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.705125331878662
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.9085133075714111
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4556210041046143
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6134095191955566
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.744931697845459
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0476555824279785
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8871092796325684
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7165429592132568
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9797587394714355
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9450697898864746
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.72306227684021
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.855 Test Loss: 0.458 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 3019584
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.267420768737793
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.398 Vali Acc: 0.283 Test Loss: 1.398 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.6903421878814697
Epoch: 2, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.235 Vali Acc: 0.464 Test Loss: 1.235 Test Acc: 0.464
Validation loss decreased (-0.282595 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 1.6722683906555176
Epoch: 3, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.083 Vali Acc: 0.558 Test Loss: 1.083 Test Acc: 0.558
Validation loss decreased (-0.463756 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.5104782581329346
Epoch: 4, Steps: 9 | Train Loss: 0.984 Vali Loss: 0.923 Vali Acc: 0.652 Test Loss: 0.923 Test Acc: 0.652
Validation loss decreased (-0.557960 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 1.6072735786437988
Epoch: 5, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.842 Vali Acc: 0.601 Test Loss: 0.842 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5911691188812256
Epoch: 6, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.741 Vali Acc: 0.638 Test Loss: 0.741 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5766608715057373
Epoch: 7, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.712 Vali Acc: 0.703 Test Loss: 0.712 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 1.5667381286621094
Epoch: 8, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.5285718441009521
Epoch: 9, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.677 Vali Acc: 0.754 Test Loss: 0.677 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 1.6011455059051514
Epoch: 10, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.533 Vali Acc: 0.790 Test Loss: 0.533 Test Acc: 0.790
Validation loss decreased (-0.753616 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 1.7624006271362305
Epoch: 11, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.528641700744629
Epoch: 12, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811590).  Saving model ...
Epoch: 13 cost time: 1.5448439121246338
Epoch: 13, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.538 Vali Acc: 0.804 Test Loss: 0.538 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5236997604370117
Epoch: 14, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 1.9141120910644531
Epoch: 15, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.8784077167510986
Epoch: 16, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 1.5690860748291016
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.407 Vali Acc: 0.848 Test Loss: 0.407 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5903377532958984
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.460862636566162
Epoch: 19, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4729878902435303
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7314989566802979
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.630553960800171
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869560).  Saving model ...
Epoch: 23 cost time: 1.678621768951416
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.547922134399414
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 1.5776619911193848
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7202510833740234
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.891 Test Loss: 0.449 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 27 cost time: 1.7650344371795654
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3633511066436768
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.855 Test Loss: 0.495 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5355346202850342
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.891 Test Loss: 0.451 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6203022003173828
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.884 Test Loss: 0.454 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4794986248016357
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4456570148468018
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.501051425933838
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.884 Test Loss: 0.458 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5321593284606934
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6828086376190186
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.884 Test Loss: 0.471 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.8256704807281494
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.884 Test Loss: 0.493 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 3015104
model size : 14.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6896369457244873
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.342 Vali Acc: 0.326 Test Loss: 1.342 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.618988037109375
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.218 Vali Acc: 0.413 Test Loss: 1.218 Test Acc: 0.413
Validation loss decreased (-0.326074 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.4981622695922852
Epoch: 3, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.051 Vali Acc: 0.609 Test Loss: 1.051 Test Acc: 0.609
Validation loss decreased (-0.413031 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 1.7779347896575928
Epoch: 4, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.942 Vali Acc: 0.623 Test Loss: 0.942 Test Acc: 0.623
Validation loss decreased (-0.608685 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 1.860483169555664
Epoch: 5, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.799 Vali Acc: 0.688 Test Loss: 0.799 Test Acc: 0.688
Validation loss decreased (-0.623179 --> -0.688398).  Saving model ...
Epoch: 6 cost time: 1.5131785869598389
Epoch: 6, Steps: 9 | Train Loss: 0.637 Vali Loss: 0.760 Vali Acc: 0.659 Test Loss: 0.760 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.591536045074463
Epoch: 7, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.709 Vali Acc: 0.696 Test Loss: 0.709 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.5908846855163574
Epoch: 8, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.620 Vali Acc: 0.768 Test Loss: 0.620 Test Acc: 0.768
Validation loss decreased (-0.695645 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 1.6366174221038818
Epoch: 9, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.669 Vali Acc: 0.725 Test Loss: 0.669 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9573032855987549
Epoch: 10, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.742 Vali Acc: 0.754 Test Loss: 0.742 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6587395668029785
Epoch: 11, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.590 Vali Acc: 0.725 Test Loss: 0.590 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6170997619628906
Epoch: 12, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.719 Vali Acc: 0.804 Test Loss: 0.719 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804341).  Saving model ...
Epoch: 13 cost time: 1.5771355628967285
Epoch: 13, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.556 Vali Acc: 0.790 Test Loss: 0.556 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.542229413986206
Epoch: 14, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 1.8768863677978516
Epoch: 15, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.636 Vali Acc: 0.790 Test Loss: 0.636 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8298454284667969
Epoch: 16, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.465 Vali Acc: 0.804 Test Loss: 0.465 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.516214370727539
Epoch: 17, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 1.671644926071167
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6966722011566162
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9064280986785889
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 1.5220906734466553
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 22 cost time: 1.48414945602417
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6699745655059814
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6882729530334473
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.690737009048462
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4563322067260742
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3732702732086182
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 28 cost time: 1.6429572105407715
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.848 Test Loss: 0.551 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6595463752746582
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 30 cost time: 1.5600855350494385
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.877 Test Loss: 0.442 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5534002780914307
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6192450523376465
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8691585063934326
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6594951152801514
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.891 Test Loss: 0.453 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.38142991065979
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5243861675262451
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.891 Test Loss: 0.429 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7755897045135498
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.884 Test Loss: 0.453 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.028235673904419
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.884 Test Loss: 0.458 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7442312240600586
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.884 Test Loss: 0.443 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 3010624
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.793400526046753
Epoch: 1, Steps: 9 | Train Loss: 1.555 Vali Loss: 1.435 Vali Acc: 0.268 Test Loss: 1.435 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 2.1198792457580566
Epoch: 2, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.264 Vali Acc: 0.442 Test Loss: 1.264 Test Acc: 0.442
Validation loss decreased (-0.268102 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 1.9665718078613281
Epoch: 3, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.137 Vali Acc: 0.471 Test Loss: 1.137 Test Acc: 0.471
Validation loss decreased (-0.442016 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 1.9421825408935547
Epoch: 4, Steps: 9 | Train Loss: 1.000 Vali Loss: 0.975 Vali Acc: 0.558 Test Loss: 0.975 Test Acc: 0.558
Validation loss decreased (-0.471003 --> -0.557961).  Saving model ...
Epoch: 5 cost time: 1.9545228481292725
Epoch: 5, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.864 Vali Acc: 0.616 Test Loss: 0.864 Test Acc: 0.616
Validation loss decreased (-0.557961 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 2.10954213142395
Epoch: 6, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.785 Vali Acc: 0.667 Test Loss: 0.785 Test Acc: 0.667
Validation loss decreased (-0.615933 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 2.122110366821289
Epoch: 7, Steps: 9 | Train Loss: 0.597 Vali Loss: 0.815 Vali Acc: 0.558 Test Loss: 0.815 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7638485431671143
Epoch: 8, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.691 Vali Acc: 0.681 Test Loss: 0.691 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681153).  Saving model ...
Epoch: 9 cost time: 1.933354377746582
Epoch: 9, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.647 Vali Acc: 0.725 Test Loss: 0.647 Test Acc: 0.725
Validation loss decreased (-0.681153 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.8318657875061035
Epoch: 10, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.671 Vali Acc: 0.696 Test Loss: 0.671 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2663304805755615
Epoch: 11, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 12 cost time: 2.0471370220184326
Epoch: 12, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.592 Vali Acc: 0.754 Test Loss: 0.592 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8325421810150146
Epoch: 13, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 1.9130206108093262
Epoch: 14, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.509 Vali Acc: 0.804 Test Loss: 0.509 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 1.884598970413208
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.8896887302398682
Epoch: 16, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 2.168360948562622
Epoch: 17, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 2.065659761428833
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.7932822704315186
Epoch: 19, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.7834851741790771
Epoch: 20, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7946240901947021
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 1.8586819171905518
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6851801872253418
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8566248416900635
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.77703857421875
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2429771423339844
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 1.8643686771392822
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8750853538513184
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.848541021347046
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8701560497283936
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 31 cost time: 1.7497742176055908
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.877 Test Loss: 0.472 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5731854438781738
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.891 Test Loss: 0.464 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.876098871231079
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.468 Vali Acc: 0.884 Test Loss: 0.468 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9595065116882324
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.542325019836426
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.891 Test Loss: 0.469 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8619263172149658
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7178223133087158
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.884 Test Loss: 0.483 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.950075626373291
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.488698959350586
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.884 Test Loss: 0.467 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.033820629119873
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.884 Test Loss: 0.466 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2728000
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.907613515853882
Epoch: 1, Steps: 9 | Train Loss: 1.512 Vali Loss: 1.426 Vali Acc: 0.138 Test Loss: 1.426 Test Acc: 0.138
Validation loss decreased (inf --> -0.137667).  Saving model ...
Epoch: 2 cost time: 2.165781259536743
Epoch: 2, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.304 Vali Acc: 0.304 Test Loss: 1.304 Test Acc: 0.304
Validation loss decreased (-0.137667 --> -0.304335).  Saving model ...
Epoch: 3 cost time: 2.816211462020874
Epoch: 3, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.164 Vali Acc: 0.471 Test Loss: 1.164 Test Acc: 0.471
Validation loss decreased (-0.304335 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 1.8046963214874268
Epoch: 4, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.044 Vali Acc: 0.601 Test Loss: 1.044 Test Acc: 0.601
Validation loss decreased (-0.471003 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.9236900806427002
Epoch: 5, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.967 Vali Acc: 0.572 Test Loss: 0.967 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8703033924102783
Epoch: 6, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.864 Vali Acc: 0.681 Test Loss: 0.864 Test Acc: 0.681
Validation loss decreased (-0.601439 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 2.4970431327819824
Epoch: 7, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.737 Vali Acc: 0.696 Test Loss: 0.737 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 2.024754285812378
Epoch: 8, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.750 Vali Acc: 0.681 Test Loss: 0.750 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5887575149536133
Epoch: 9, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.759 Vali Acc: 0.638 Test Loss: 0.759 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.821500539779663
Epoch: 10, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.719 Vali Acc: 0.703 Test Loss: 0.719 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 11 cost time: 1.8952648639678955
Epoch: 11, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
Validation loss decreased (-0.702891 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 2.320063829421997
Epoch: 12, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.8416311740875244
Epoch: 13, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.826378583908081
Epoch: 14, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.637 Vali Acc: 0.768 Test Loss: 0.637 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6036064624786377
Epoch: 15, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 2.178680658340454
Epoch: 16, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.585 Vali Acc: 0.768 Test Loss: 0.585 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6430935859680176
Epoch: 17, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811588).  Saving model ...
Epoch: 18 cost time: 1.9787497520446777
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.6191515922546387
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 2.3157660961151123
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0599639415740967
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.610 Vali Acc: 0.797 Test Loss: 0.610 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2720794677734375
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 23 cost time: 2.125530481338501
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 24 cost time: 1.8196313381195068
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.855 Test Loss: 0.614 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 25 cost time: 2.0632617473602295
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 26 cost time: 2.0108118057250977
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.848 Test Loss: 0.593 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8195295333862305
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.632 Vali Acc: 0.848 Test Loss: 0.632 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7208261489868164
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.855 Test Loss: 0.642 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5566565990447998
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.855 Test Loss: 0.646 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7769081592559814
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.855 Test Loss: 0.639 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8913288116455078
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.855 Test Loss: 0.633 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9628310203552246
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.862 Test Loss: 0.661 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862312).  Saving model ...
Epoch: 33 cost time: 1.6646008491516113
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.862 Test Loss: 0.665 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0286927223205566
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.855 Test Loss: 0.634 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.995542049407959
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.855 Test Loss: 0.648 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.599147081375122
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.862 Test Loss: 0.665 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.1813411712646484
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.855 Test Loss: 0.666 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.444302558898926
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.862 Test Loss: 0.672 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.215131998062134
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.862 Test Loss: 0.695 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.9065122604370117
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.862 Test Loss: 0.688 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.099954843521118
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.862 Test Loss: 0.689 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.437495470046997
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.862 Test Loss: 0.674 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 2723520
model size : 13.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.001643657684326
Epoch: 1, Steps: 9 | Train Loss: 1.602 Vali Loss: 1.436 Vali Acc: 0.174 Test Loss: 1.436 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 1.3910894393920898
Epoch: 2, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.340 Vali Acc: 0.261 Test Loss: 1.340 Test Acc: 0.261
Validation loss decreased (-0.173899 --> -0.260856).  Saving model ...
Epoch: 3 cost time: 1.8239192962646484
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.188 Vali Acc: 0.594 Test Loss: 1.188 Test Acc: 0.594
Validation loss decreased (-0.260856 --> -0.594191).  Saving model ...
Epoch: 4 cost time: 1.9048876762390137
Epoch: 4, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.026 Vali Acc: 0.529 Test Loss: 1.026 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6039979457855225
Epoch: 5, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.846 Vali Acc: 0.659 Test Loss: 0.846 Test Acc: 0.659
Validation loss decreased (-0.594191 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 1.919895887374878
Epoch: 6, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.748 Vali Acc: 0.667 Test Loss: 0.748 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 1.5542149543762207
Epoch: 7, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.744 Vali Acc: 0.703 Test Loss: 0.744 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 1.5581433773040771
Epoch: 8, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.8099100589752197
Epoch: 9, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.654 Vali Acc: 0.754 Test Loss: 0.654 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 1.6062448024749756
Epoch: 10, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 11 cost time: 1.7055909633636475
Epoch: 11, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.594 Vali Acc: 0.768 Test Loss: 0.594 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 1.5434544086456299
Epoch: 12, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.563 Vali Acc: 0.797 Test Loss: 0.563 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.7121822834014893
Epoch: 13, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.553 Vali Acc: 0.804 Test Loss: 0.553 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 1.6305181980133057
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.497 Vali Acc: 0.790 Test Loss: 0.497 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7074971199035645
Epoch: 15, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.8903465270996094
Epoch: 16, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.424 Vali Acc: 0.797 Test Loss: 0.424 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7238869667053223
Epoch: 17, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840575).  Saving model ...
Epoch: 18 cost time: 1.7293472290039062
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.607 Vali Acc: 0.797 Test Loss: 0.607 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7884631156921387
Epoch: 19, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.526170015335083
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 21 cost time: 2.0371546745300293
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6728355884552002
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 23 cost time: 1.7228035926818848
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9276454448699951
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.81178617477417
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.415 Vali Acc: 0.884 Test Loss: 0.415 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7983033657073975
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.757993459701538
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6834139823913574
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.660013198852539
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.891 Test Loss: 0.428 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6229040622711182
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.877 Test Loss: 0.461 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.96229887008667
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6059434413909912
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2719040
model size : 13.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.468142509460449
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.350 Vali Acc: 0.348 Test Loss: 1.350 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.5959877967834473
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.223 Vali Acc: 0.362 Test Loss: 1.223 Test Acc: 0.362
Validation loss decreased (-0.347813 --> -0.362307).  Saving model ...
Epoch: 3 cost time: 2.2090866565704346
Epoch: 3, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.085 Vali Acc: 0.565 Test Loss: 1.085 Test Acc: 0.565
Validation loss decreased (-0.362307 --> -0.565207).  Saving model ...
Epoch: 4 cost time: 2.395571708679199
Epoch: 4, Steps: 9 | Train Loss: 0.896 Vali Loss: 0.971 Vali Acc: 0.594 Test Loss: 0.971 Test Acc: 0.594
Validation loss decreased (-0.565207 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 2.1802494525909424
Epoch: 5, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.838 Vali Acc: 0.630 Test Loss: 0.838 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630426).  Saving model ...
Epoch: 6 cost time: 1.7058594226837158
Epoch: 6, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.717 Vali Acc: 0.688 Test Loss: 0.717 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688399).  Saving model ...
Epoch: 7 cost time: 2.411173105239868
Epoch: 7, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.716 Vali Acc: 0.652 Test Loss: 0.716 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.798804759979248
Epoch: 8, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.655 Vali Acc: 0.739 Test Loss: 0.655 Test Acc: 0.739
Validation loss decreased (-0.688399 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 2.331603527069092
Epoch: 9, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 10 cost time: 2.141533374786377
Epoch: 10, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.631 Vali Acc: 0.696 Test Loss: 0.631 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.12931489944458
Epoch: 11, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 2.0595481395721436
Epoch: 12, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0210981369018555
Epoch: 13, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.473 Vali Acc: 0.804 Test Loss: 0.473 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 2.094428777694702
Epoch: 14, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.545 Vali Acc: 0.754 Test Loss: 0.545 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9477221965789795
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 2.0456504821777344
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869560).  Saving model ...
Epoch: 17 cost time: 2.020557403564453
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9095230102539062
Epoch: 18, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.869560 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 1.9935381412506104
Epoch: 19, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5607757568359375
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6532907485961914
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.479 Vali Acc: 0.870 Test Loss: 0.479 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8955724239349365
Epoch: 22, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.468 Vali Acc: 0.768 Test Loss: 0.468 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3195199966430664
Epoch: 23, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7498421669006348
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 1.8357274532318115
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6439566612243652
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1324031352996826
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8797805309295654
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7380545139312744
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.899 Test Loss: 0.393 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9679694175720215
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.172023296356201
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.891 Test Loss: 0.456 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9629852771759033
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.899 Test Loss: 0.435 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.0468199253082275
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.34083890914917
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 2714560
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.301027536392212
Epoch: 1, Steps: 9 | Train Loss: 1.509 Vali Loss: 1.385 Vali Acc: 0.362 Test Loss: 1.385 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 2.7247421741485596
Epoch: 2, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.301 Vali Acc: 0.312 Test Loss: 1.301 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.247468948364258
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.158 Vali Acc: 0.507 Test Loss: 1.158 Test Acc: 0.507
Validation loss decreased (-0.362305 --> -0.507235).  Saving model ...
Epoch: 4 cost time: 1.7994682788848877
Epoch: 4, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.010 Vali Acc: 0.587 Test Loss: 1.010 Test Acc: 0.587
Validation loss decreased (-0.507235 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 2.4168434143066406
Epoch: 5, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.915 Vali Acc: 0.623 Test Loss: 0.915 Test Acc: 0.623
Validation loss decreased (-0.586946 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 2.2908437252044678
Epoch: 6, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.850 Vali Acc: 0.594 Test Loss: 0.850 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7216713428497314
Epoch: 7, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.814 Vali Acc: 0.674 Test Loss: 0.814 Test Acc: 0.674
Validation loss decreased (-0.623179 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.8818702697753906
Epoch: 8, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.752 Vali Acc: 0.645 Test Loss: 0.752 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2676494121551514
Epoch: 9, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.730 Vali Acc: 0.688 Test Loss: 0.730 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688399).  Saving model ...
Epoch: 10 cost time: 1.9973084926605225
Epoch: 10, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.629 Vali Acc: 0.696 Test Loss: 0.629 Test Acc: 0.696
Validation loss decreased (-0.688399 --> -0.695646).  Saving model ...
Epoch: 11 cost time: 2.0758838653564453
Epoch: 11, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.643 Vali Acc: 0.696 Test Loss: 0.643 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7870986461639404
Epoch: 12, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
Validation loss decreased (-0.695646 --> -0.717385).  Saving model ...
Epoch: 13 cost time: 2.0315608978271484
Epoch: 13, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.067833662033081
Epoch: 14, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.637 Vali Acc: 0.790 Test Loss: 0.637 Test Acc: 0.790
Validation loss decreased (-0.717385 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 1.7515747547149658
Epoch: 15, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.494 Vali Acc: 0.804 Test Loss: 0.494 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 2.6056296825408936
Epoch: 16, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.529 Vali Acc: 0.797 Test Loss: 0.529 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7397780418395996
Epoch: 17, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8155312538146973
Epoch: 18, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 2.5148732662200928
Epoch: 19, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.242326498031616
Epoch: 20, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4107301235198975
Epoch: 21, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 1.7497272491455078
Epoch: 22, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.553823232650757
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.207071304321289
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 2.4104487895965576
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.170362949371338
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6690564155578613
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9045255184173584
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 2.557870388031006
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7067344188690186
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1302247047424316
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.3425214290618896
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.951207160949707
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7887861728668213
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.3129539489746094
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.862 Test Loss: 0.563 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8545868396759033
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 37 cost time: 2.474585771560669
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.1111772060394287
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6564710140228271
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7065727710723877
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.9807405471801758
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8223316669464111
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.1939268112182617
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.7848823070526123
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.684654951095581
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.8329999446868896
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.891 Test Loss: 0.401 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1815040
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.789879560470581
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.373 Vali Acc: 0.333 Test Loss: 1.373 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.6146833896636963
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
Validation loss decreased (-0.333320 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.9671173095703125
Epoch: 3, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.159 Vali Acc: 0.413 Test Loss: 1.159 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.673102855682373
Epoch: 4, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.011 Vali Acc: 0.609 Test Loss: 1.011 Test Acc: 0.609
Validation loss decreased (-0.499987 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 1.7513039112091064
Epoch: 5, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.927 Vali Acc: 0.609 Test Loss: 0.927 Test Acc: 0.609
Validation loss decreased (-0.608686 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 1.6774964332580566
Epoch: 6, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.845 Vali Acc: 0.630 Test Loss: 0.845 Test Acc: 0.630
Validation loss decreased (-0.608686 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.6384093761444092
Epoch: 7, Steps: 9 | Train Loss: 0.663 Vali Loss: 0.815 Vali Acc: 0.688 Test Loss: 0.815 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.887336015701294
Epoch: 8, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.741 Vali Acc: 0.696 Test Loss: 0.741 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.9321255683898926
Epoch: 9, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.730 Vali Acc: 0.703 Test Loss: 0.730 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.751267671585083
Epoch: 10, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.687 Vali Acc: 0.652 Test Loss: 0.687 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9470820426940918
Epoch: 11, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746371).  Saving model ...
Epoch: 12 cost time: 1.588054895401001
Epoch: 12, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.853203296661377
Epoch: 13, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.600 Vali Acc: 0.754 Test Loss: 0.600 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.5588338375091553
Epoch: 14, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.470 Vali Acc: 0.804 Test Loss: 0.470 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 2.0887229442596436
Epoch: 15, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6643257141113281
Epoch: 16, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.616 Vali Acc: 0.790 Test Loss: 0.616 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9163308143615723
Epoch: 17, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.577 Vali Acc: 0.768 Test Loss: 0.577 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.017503023147583
Epoch: 18, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.633 Vali Acc: 0.804 Test Loss: 0.633 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6207773685455322
Epoch: 19, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.804343 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 1.8972361087799072
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8951058387756348
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.975494623184204
Epoch: 22, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 1.8885293006896973
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8747236728668213
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 2.0253570079803467
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7907648086547852
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7330408096313477
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8920693397521973
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 2.400991439819336
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0695996284484863
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9712576866149902
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0512595176696777
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6557018756866455
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.8300623893737793
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 35 cost time: 1.7526333332061768
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.765542984008789
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6327590942382812
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0512218475341797
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.17779541015625
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.2208569049835205
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.9467196464538574
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.2388646602630615
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.8132283687591553
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.6126742362976074
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1812800
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.159563302993774
Epoch: 1, Steps: 9 | Train Loss: 1.489 Vali Loss: 1.400 Vali Acc: 0.261 Test Loss: 1.400 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.9004559516906738
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.294 Vali Acc: 0.377 Test Loss: 1.294 Test Acc: 0.377
Validation loss decreased (-0.260856 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 2.043691635131836
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.134 Vali Acc: 0.471 Test Loss: 1.134 Test Acc: 0.471
Validation loss decreased (-0.376799 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 1.6635797023773193
Epoch: 4, Steps: 9 | Train Loss: 1.076 Vali Loss: 0.988 Vali Acc: 0.565 Test Loss: 0.988 Test Acc: 0.565
Validation loss decreased (-0.471003 --> -0.565208).  Saving model ...
Epoch: 5 cost time: 1.7301864624023438
Epoch: 5, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.886 Vali Acc: 0.696 Test Loss: 0.886 Test Acc: 0.696
Validation loss decreased (-0.565208 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 1.7480027675628662
Epoch: 6, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.821 Vali Acc: 0.630 Test Loss: 0.821 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9837830066680908
Epoch: 7, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0724868774414062
Epoch: 8, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.736 Vali Acc: 0.667 Test Loss: 0.736 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.139235019683838
Epoch: 9, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.726 Vali Acc: 0.717 Test Loss: 0.726 Test Acc: 0.717
Validation loss decreased (-0.695643 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 2.198931932449341
Epoch: 10, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.646 Vali Acc: 0.696 Test Loss: 0.646 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2019267082214355
Epoch: 11, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.696 Vali Acc: 0.725 Test Loss: 0.696 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 2.700190782546997
Epoch: 12, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.577 Vali Acc: 0.754 Test Loss: 0.577 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 1.8527605533599854
Epoch: 13, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.701 Vali Acc: 0.688 Test Loss: 0.701 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.01887845993042
Epoch: 14, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2855465412139893
Epoch: 15, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.696 Vali Acc: 0.739 Test Loss: 0.696 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5361857414245605
Epoch: 16, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.579 Vali Acc: 0.754 Test Loss: 0.579 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.216207265853882
Epoch: 17, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 2.2542223930358887
Epoch: 18, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.303544044494629
Epoch: 19, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.9324712753295898
Epoch: 20, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2020440101623535
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.017744302749634
Epoch: 22, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1378164291381836
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.294647216796875
Epoch: 24, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0644044876098633
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.8483471870422363
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.001332998275757
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.7980527877807617
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3668956756591797
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.450284481048584
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.093844175338745
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.315513849258423
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1998696327209473
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.2984957695007324
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.3528997898101807
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.230579376220703
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8338382244110107
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1810560
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.812905788421631
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.282 Vali Acc: 0.391 Test Loss: 1.282 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 2.3616273403167725
Epoch: 2, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.391292 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 2.0624475479125977
Epoch: 3, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.015 Vali Acc: 0.587 Test Loss: 1.015 Test Acc: 0.587
Validation loss decreased (-0.514481 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 2.145913600921631
Epoch: 4, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.918 Vali Acc: 0.623 Test Loss: 0.918 Test Acc: 0.623
Validation loss decreased (-0.586946 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 2.0071728229522705
Epoch: 5, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.835 Vali Acc: 0.645 Test Loss: 0.835 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 1.9729180335998535
Epoch: 6, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673905).  Saving model ...
Epoch: 7 cost time: 1.880908727645874
Epoch: 7, Steps: 9 | Train Loss: 0.597 Vali Loss: 0.757 Vali Acc: 0.652 Test Loss: 0.757 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0346133708953857
Epoch: 8, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.766 Vali Acc: 0.659 Test Loss: 0.766 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4109628200531006
Epoch: 9, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.663 Vali Acc: 0.703 Test Loss: 0.663 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 1.9550604820251465
Epoch: 10, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.641 Vali Acc: 0.710 Test Loss: 0.641 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710139).  Saving model ...
Epoch: 11 cost time: 2.261117696762085
Epoch: 11, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.653 Vali Acc: 0.717 Test Loss: 0.653 Test Acc: 0.717
Validation loss decreased (-0.710139 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.9882123470306396
Epoch: 12, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.565 Vali Acc: 0.797 Test Loss: 0.565 Test Acc: 0.797
Validation loss decreased (-0.717385 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.955904245376587
Epoch: 13, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.556 Vali Acc: 0.754 Test Loss: 0.556 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.959960699081421
Epoch: 14, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.596 Vali Acc: 0.790 Test Loss: 0.596 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.156672716140747
Epoch: 15, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7660577297210693
Epoch: 16, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.588 Vali Acc: 0.732 Test Loss: 0.588 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9934067726135254
Epoch: 17, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1985056400299072
Epoch: 18, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9939587116241455
Epoch: 19, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 20 cost time: 1.9202368259429932
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.350 Vali Acc: 0.862 Test Loss: 0.350 Test Acc: 0.862
Validation loss decreased (-0.818835 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 2.0953285694122314
Epoch: 21, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2782349586486816
Epoch: 22, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.331 Vali Acc: 0.877 Test Loss: 0.331 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 23 cost time: 2.4989304542541504
Epoch: 23, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.485893487930298
Epoch: 24, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2724945545196533
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 2.2068734169006348
Epoch: 26, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.154183864593506
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.318 Vali Acc: 0.862 Test Loss: 0.318 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.681954860687256
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6064627170562744
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.286 Vali Acc: 0.891 Test Loss: 0.286 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 2.128427028656006
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0750179290771484
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 32 cost time: 2.900144338607788
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9850189685821533
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.584038734436035
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2934184074401855
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 36 cost time: 1.9225528240203857
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.289 Vali Acc: 0.899 Test Loss: 0.289 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.029465913772583
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.191957712173462
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.0426056385040283
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.4767746925354004
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.2332217693328857
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.6403238773345947
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.2241392135620117
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8981997966766357
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.7402093410491943
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1808320
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.879754066467285
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.353 Vali Acc: 0.370 Test Loss: 1.353 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.6619653701782227
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.314 Vali Acc: 0.355 Test Loss: 1.314 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7563886642456055
Epoch: 3, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.141 Vali Acc: 0.551 Test Loss: 1.141 Test Acc: 0.551
Validation loss decreased (-0.369552 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 1.7836616039276123
Epoch: 4, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.022 Vali Acc: 0.580 Test Loss: 1.022 Test Acc: 0.580
Validation loss decreased (-0.550713 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 1.8458800315856934
Epoch: 5, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.902 Vali Acc: 0.630 Test Loss: 0.902 Test Acc: 0.630
Validation loss decreased (-0.579700 --> -0.630426).  Saving model ...
Epoch: 6 cost time: 2.0603551864624023
Epoch: 6, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.833 Vali Acc: 0.630 Test Loss: 0.833 Test Acc: 0.630
Validation loss decreased (-0.630426 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.5950126647949219
Epoch: 7, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.793 Vali Acc: 0.667 Test Loss: 0.793 Test Acc: 0.667
Validation loss decreased (-0.630426 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.7042734622955322
Epoch: 8, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.745 Vali Acc: 0.688 Test Loss: 0.745 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 1.540778398513794
Epoch: 9, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.714 Vali Acc: 0.681 Test Loss: 0.714 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.896411418914795
Epoch: 10, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.676 Vali Acc: 0.696 Test Loss: 0.676 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.5362129211425781
Epoch: 11, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.653 Vali Acc: 0.696 Test Loss: 0.653 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695646).  Saving model ...
Epoch: 12 cost time: 1.7125744819641113
Epoch: 12, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.695646 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 2.110015630722046
Epoch: 13, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 1.6830060482025146
Epoch: 14, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.7030243873596191
Epoch: 15, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.570 Vali Acc: 0.797 Test Loss: 0.570 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 1.6056623458862305
Epoch: 16, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5977773666381836
Epoch: 17, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826083).  Saving model ...
Epoch: 18 cost time: 1.7501928806304932
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.675 Vali Acc: 0.797 Test Loss: 0.675 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7263376712799072
Epoch: 19, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.7730913162231445
Epoch: 20, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.530 Vali Acc: 0.768 Test Loss: 0.530 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5101935863494873
Epoch: 21, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5124094486236572
Epoch: 22, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.083509683609009
Epoch: 23, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.369 Vali Acc: 0.855 Test Loss: 0.369 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855069).  Saving model ...
Epoch: 24 cost time: 1.6777400970458984
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6471483707427979
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884054).  Saving model ...
Epoch: 26 cost time: 1.7645390033721924
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7932074069976807
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8494822978973389
Epoch: 28, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.401 Vali Acc: 0.848 Test Loss: 0.401 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5690710544586182
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0219945907592773
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0048389434814453
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7894353866577148
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1947414875030518
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8668544292449951
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.848 Test Loss: 0.394 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.909771203994751
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 1220608
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.159918546676636
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.391 Vali Acc: 0.341 Test Loss: 1.391 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.819732427597046
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.276 Vali Acc: 0.449 Test Loss: 1.276 Test Acc: 0.449
Validation loss decreased (-0.340566 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 2.0982506275177
Epoch: 3, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.126 Vali Acc: 0.565 Test Loss: 1.126 Test Acc: 0.565
Validation loss decreased (-0.449263 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 2.3830554485321045
Epoch: 4, Steps: 9 | Train Loss: 0.953 Vali Loss: 0.973 Vali Acc: 0.609 Test Loss: 0.973 Test Acc: 0.609
Validation loss decreased (-0.565206 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 1.8588249683380127
Epoch: 5, Steps: 9 | Train Loss: 0.818 Vali Loss: 0.866 Vali Acc: 0.638 Test Loss: 0.866 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 1.921867847442627
Epoch: 6, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.808 Vali Acc: 0.659 Test Loss: 0.808 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 7 cost time: 2.2148356437683105
Epoch: 7, Steps: 9 | Train Loss: 0.663 Vali Loss: 0.782 Vali Acc: 0.652 Test Loss: 0.782 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0493459701538086
Epoch: 8, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.736 Vali Acc: 0.645 Test Loss: 0.736 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7132313251495361
Epoch: 9, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.672 Vali Acc: 0.703 Test Loss: 0.672 Test Acc: 0.703
Validation loss decreased (-0.659412 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 1.691758394241333
Epoch: 10, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.656 Vali Acc: 0.696 Test Loss: 0.656 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2561843395233154
Epoch: 11, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
Validation loss decreased (-0.702892 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 2.7824184894561768
Epoch: 12, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.717385 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.8843533992767334
Epoch: 13, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.543 Vali Acc: 0.797 Test Loss: 0.543 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 2.3542914390563965
Epoch: 14, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9324522018432617
Epoch: 15, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.484 Vali Acc: 0.804 Test Loss: 0.484 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 1.9774327278137207
Epoch: 16, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.961763858795166
Epoch: 17, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.463 Vali Acc: 0.804 Test Loss: 0.463 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0138940811157227
Epoch: 18, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.439 Vali Acc: 0.812 Test Loss: 0.439 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.073413848876953
Epoch: 19, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.506 Vali Acc: 0.797 Test Loss: 0.506 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.03438663482666
Epoch: 20, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.53840970993042
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 1.680521011352539
Epoch: 22, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.516 Vali Acc: 0.804 Test Loss: 0.516 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9279119968414307
Epoch: 23, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.358 Vali Acc: 0.848 Test Loss: 0.358 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9380788803100586
Epoch: 24, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 25 cost time: 2.3047494888305664
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.412 Vali Acc: 0.812 Test Loss: 0.412 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9605324268341064
Epoch: 26, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.541 Vali Acc: 0.761 Test Loss: 0.541 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8344759941101074
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884055).  Saving model ...
Epoch: 28 cost time: 1.7147042751312256
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.374 Vali Acc: 0.848 Test Loss: 0.374 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9100499153137207
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8729326725006104
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
Validation loss decreased (-0.884055 --> -0.905794).  Saving model ...
Epoch: 31 cost time: 2.050170421600342
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7929978370666504
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7422010898590088
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8231794834136963
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3219733238220215
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.334 Vali Acc: 0.862 Test Loss: 0.334 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.1583685874938965
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.9334135055541992
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7965123653411865
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 39 cost time: 2.5786190032958984
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.0278186798095703
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.439008951187134
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9798805713653564
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.3744325637817383
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.6793630123138428
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.4195821285247803
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.284087896347046
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.7503483295440674
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.173546075820923
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 1218368
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.258716821670532
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.299 Vali Acc: 0.464 Test Loss: 1.299 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 2.0400285720825195
Epoch: 2, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.227 Vali Acc: 0.428 Test Loss: 1.227 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4395506381988525
Epoch: 3, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.125 Vali Acc: 0.572 Test Loss: 1.125 Test Acc: 0.572
Validation loss decreased (-0.463755 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 2.2569971084594727
Epoch: 4, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.019 Vali Acc: 0.587 Test Loss: 1.019 Test Acc: 0.587
Validation loss decreased (-0.572453 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 2.268265962600708
Epoch: 5, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.911 Vali Acc: 0.630 Test Loss: 0.911 Test Acc: 0.630
Validation loss decreased (-0.586946 --> -0.630426).  Saving model ...
Epoch: 6 cost time: 1.7823255062103271
Epoch: 6, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.829 Vali Acc: 0.645 Test Loss: 0.829 Test Acc: 0.645
Validation loss decreased (-0.630426 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.8389382362365723
Epoch: 7, Steps: 9 | Train Loss: 0.637 Vali Loss: 0.760 Vali Acc: 0.659 Test Loss: 0.760 Test Acc: 0.659
Validation loss decreased (-0.644919 --> -0.659413).  Saving model ...
Epoch: 8 cost time: 2.369485378265381
Epoch: 8, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.731 Vali Acc: 0.667 Test Loss: 0.731 Test Acc: 0.667
Validation loss decreased (-0.659413 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 2.1453142166137695
Epoch: 9, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.693 Vali Acc: 0.638 Test Loss: 0.693 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.959855318069458
Epoch: 10, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.621 Vali Acc: 0.725 Test Loss: 0.621 Test Acc: 0.725
Validation loss decreased (-0.666659 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 2.4269092082977295
Epoch: 11, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.847114324569702
Epoch: 12, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 1.8239719867706299
Epoch: 13, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.533 Vali Acc: 0.775 Test Loss: 0.533 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 1.9582874774932861
Epoch: 14, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 1.8928186893463135
Epoch: 15, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.493 Vali Acc: 0.804 Test Loss: 0.493 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 2.3385350704193115
Epoch: 16, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.053267478942871
Epoch: 17, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.012561798095703
Epoch: 18, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.466 Vali Acc: 0.790 Test Loss: 0.466 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8540785312652588
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
Validation loss decreased (-0.804343 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 2.112639904022217
Epoch: 20, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1857118606567383
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.408337116241455
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 2.3542840480804443
Epoch: 23, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.309796094894409
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.371 Vali Acc: 0.855 Test Loss: 0.371 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.178217887878418
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.632 Vali Acc: 0.790 Test Loss: 0.632 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.079787492752075
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.365 Vali Acc: 0.841 Test Loss: 0.365 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3287060260772705
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.88857102394104
Epoch: 28, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 29 cost time: 2.0191333293914795
Epoch: 29, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 2.659243583679199
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9459924697875977
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.136237144470215
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6832139492034912
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.3016512393951416
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.3313002586364746
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.890261173248291
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.068807363510132
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9253597259521484
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.3769874572753906
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1216128
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9892160892486572
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.354 Vali Acc: 0.268 Test Loss: 1.354 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.985933542251587
Epoch: 2, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.277 Vali Acc: 0.348 Test Loss: 1.277 Test Acc: 0.348
Validation loss decreased (-0.268102 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.712428092956543
Epoch: 3, Steps: 9 | Train Loss: 1.267 Vali Loss: 1.162 Vali Acc: 0.572 Test Loss: 1.162 Test Acc: 0.572
Validation loss decreased (-0.347813 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.7455589771270752
Epoch: 4, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.042 Vali Acc: 0.572 Test Loss: 1.042 Test Acc: 0.572
Validation loss decreased (-0.572452 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 2.045295238494873
Epoch: 5, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.906 Vali Acc: 0.681 Test Loss: 0.906 Test Acc: 0.681
Validation loss decreased (-0.572453 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 1.611975908279419
Epoch: 6, Steps: 9 | Train Loss: 0.736 Vali Loss: 0.804 Vali Acc: 0.674 Test Loss: 0.804 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.535390853881836
Epoch: 7, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.777 Vali Acc: 0.688 Test Loss: 0.777 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 2.2679800987243652
Epoch: 8, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.712 Vali Acc: 0.710 Test Loss: 0.712 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 2.2922990322113037
Epoch: 9, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.671 Vali Acc: 0.674 Test Loss: 0.671 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.268126964569092
Epoch: 10, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.607 Vali Acc: 0.790 Test Loss: 0.607 Test Acc: 0.790
Validation loss decreased (-0.710138 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 2.3393311500549316
Epoch: 11, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9765868186950684
Epoch: 12, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1074366569519043
Epoch: 13, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.504 Vali Acc: 0.790 Test Loss: 0.504 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 14 cost time: 2.349893808364868
Epoch: 14, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 1.9743695259094238
Epoch: 15, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.433 Vali Acc: 0.819 Test Loss: 0.433 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 1.8916363716125488
Epoch: 16, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.238196611404419
Epoch: 17, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4824907779693604
Epoch: 18, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 2.094393491744995
Epoch: 19, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8054771423339844
Epoch: 20, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 21 cost time: 2.5038630962371826
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9756834506988525
Epoch: 22, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 2.323040723800659
Epoch: 23, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3673617839813232
Epoch: 24, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.334 Vali Acc: 0.862 Test Loss: 0.334 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 1.671607255935669
Epoch: 25, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.226508617401123
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8813843727111816
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.797558069229126
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.036752462387085
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.331618309020996
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8291168212890625
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 32 cost time: 1.9023778438568115
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7677175998687744
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 34 cost time: 2.2815353870391846
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9175565242767334
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.473881721496582
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6164188385009766
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.000561237335205
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7987380027770996
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.484790325164795
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.0451409816741943
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.406 Vali Acc: 0.891 Test Loss: 0.406 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.5508315563201904
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.0882015228271484
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.877 Test Loss: 0.402 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1213888
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.138878107070923
Epoch: 1, Steps: 9 | Train Loss: 1.491 Vali Loss: 1.377 Vali Acc: 0.319 Test Loss: 1.377 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 2.242788553237915
Epoch: 2, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (-0.318827 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 1.7207801342010498
Epoch: 3, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
Validation loss decreased (-0.362305 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.7189559936523438
Epoch: 4, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.173 Vali Acc: 0.536 Test Loss: 1.173 Test Acc: 0.536
Validation loss decreased (-0.499987 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 1.9831972122192383
Epoch: 5, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.047 Vali Acc: 0.652 Test Loss: 1.047 Test Acc: 0.652
Validation loss decreased (-0.536220 --> -0.652163).  Saving model ...
Epoch: 6 cost time: 1.9837143421173096
Epoch: 6, Steps: 9 | Train Loss: 0.985 Vali Loss: 0.931 Vali Acc: 0.674 Test Loss: 0.931 Test Acc: 0.674
Validation loss decreased (-0.652163 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 2.1699788570404053
Epoch: 7, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.876 Vali Acc: 0.601 Test Loss: 0.876 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7837250232696533
Epoch: 8, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.792 Vali Acc: 0.688 Test Loss: 0.792 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 1.976611614227295
Epoch: 9, Steps: 9 | Train Loss: 0.663 Vali Loss: 0.747 Vali Acc: 0.638 Test Loss: 0.747 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.167917251586914
Epoch: 10, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.698 Vali Acc: 0.674 Test Loss: 0.698 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.196287155151367
Epoch: 11, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.674 Vali Acc: 0.681 Test Loss: 0.674 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3230679035186768
Epoch: 12, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.611 Vali Acc: 0.754 Test Loss: 0.611 Test Acc: 0.754
Validation loss decreased (-0.688398 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 1.9359688758850098
Epoch: 13, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 1.9366497993469238
Epoch: 14, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 1.884981632232666
Epoch: 15, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.526 Vali Acc: 0.790 Test Loss: 0.526 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6921050548553467
Epoch: 16, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8294367790222168
Epoch: 17, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8774943351745605
Epoch: 18, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 1.9594035148620605
Epoch: 19, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0344815254211426
Epoch: 20, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 2.065669536590576
Epoch: 21, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855069).  Saving model ...
Epoch: 22 cost time: 1.8098044395446777
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.499 Vali Acc: 0.790 Test Loss: 0.499 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7230472564697266
Epoch: 23, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 1.8821959495544434
Epoch: 24, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4448230266571045
Epoch: 25, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.380 Vali Acc: 0.848 Test Loss: 0.380 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0189297199249268
Epoch: 26, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.522 Vali Acc: 0.790 Test Loss: 0.522 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0568692684173584
Epoch: 27, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.8847315311431885
Epoch: 28, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.387666702270508
Epoch: 29, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.475 Vali Acc: 0.812 Test Loss: 0.475 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2772164344787598
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5477426052093506
Epoch: 31, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7038135528564453
Epoch: 32, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8530430793762207
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.0218775272369385
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.141234874725342
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.877 Test Loss: 0.484 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 36 cost time: 1.8180358409881592
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.109649658203125
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.534 Vali Acc: 0.848 Test Loss: 0.534 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7250304222106934
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.123422622680664
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.8744943141937256
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 41 cost time: 1.7749724388122559
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.6734490394592285
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.497 Vali Acc: 0.884 Test Loss: 0.497 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0232529640197754
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.884 Test Loss: 0.487 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7666079998016357
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 45 cost time: 1.8163948059082031
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.0602567195892334
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.9241833686828613
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.870 Test Loss: 0.526 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8585963249206543
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.6688477993011475
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.584026575088501
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.9238197803497314
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.877 Test Loss: 0.498 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.9178979396820068
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.891 Test Loss: 0.494 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.4145820140838623
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.605940580368042
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 923392
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.330503463745117
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.378 Vali Acc: 0.312 Test Loss: 1.378 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.7931723594665527
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.316 Vali Acc: 0.312 Test Loss: 1.316 Test Acc: 0.312
Validation loss decreased (-0.311580 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 2.104848623275757
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.222 Vali Acc: 0.471 Test Loss: 1.222 Test Acc: 0.471
Validation loss decreased (-0.311581 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 1.9694242477416992
Epoch: 4, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.110 Vali Acc: 0.587 Test Loss: 1.110 Test Acc: 0.587
Validation loss decreased (-0.471002 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 2.201738119125366
Epoch: 5, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.004 Vali Acc: 0.551 Test Loss: 1.004 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3413171768188477
Epoch: 6, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.926 Vali Acc: 0.623 Test Loss: 0.926 Test Acc: 0.623
Validation loss decreased (-0.586945 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 2.0535197257995605
Epoch: 7, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.860 Vali Acc: 0.572 Test Loss: 0.860 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1977944374084473
Epoch: 8, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
Validation loss decreased (-0.623179 --> -0.681151).  Saving model ...
Epoch: 9 cost time: 1.6742191314697266
Epoch: 9, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.788 Vali Acc: 0.594 Test Loss: 0.788 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.137821674346924
Epoch: 10, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.794 Vali Acc: 0.688 Test Loss: 0.794 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 1.7525131702423096
Epoch: 11, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.773 Vali Acc: 0.623 Test Loss: 0.773 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8733820915222168
Epoch: 12, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.715 Vali Acc: 0.674 Test Loss: 0.715 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.272435188293457
Epoch: 13, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.639 Vali Acc: 0.696 Test Loss: 0.639 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695646).  Saving model ...
Epoch: 14 cost time: 2.0023224353790283
Epoch: 14, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.695646 --> -0.746371).  Saving model ...
Epoch: 15 cost time: 1.9263010025024414
Epoch: 15, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.644 Vali Acc: 0.717 Test Loss: 0.644 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.688425064086914
Epoch: 16, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.552 Vali Acc: 0.710 Test Loss: 0.552 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9273715019226074
Epoch: 17, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.500 Vali Acc: 0.761 Test Loss: 0.500 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760865).  Saving model ...
Epoch: 18 cost time: 1.873866081237793
Epoch: 18, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.520 Vali Acc: 0.768 Test Loss: 0.520 Test Acc: 0.768
Validation loss decreased (-0.760865 --> -0.768111).  Saving model ...
Epoch: 19 cost time: 2.2755396366119385
Epoch: 19, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.520 Vali Acc: 0.768 Test Loss: 0.520 Test Acc: 0.768
Validation loss decreased (-0.768111 --> -0.768111).  Saving model ...
Epoch: 20 cost time: 2.090458869934082
Epoch: 20, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.440 Vali Acc: 0.790 Test Loss: 0.440 Test Acc: 0.790
Validation loss decreased (-0.768111 --> -0.789851).  Saving model ...
Epoch: 21 cost time: 1.9640235900878906
Epoch: 21, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.458 Vali Acc: 0.812 Test Loss: 0.458 Test Acc: 0.812
Validation loss decreased (-0.789851 --> -0.811590).  Saving model ...
Epoch: 22 cost time: 1.8690659999847412
Epoch: 22, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
Validation loss decreased (-0.811590 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 1.9297125339508057
Epoch: 23, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.223417043685913
Epoch: 24, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8622443675994873
Epoch: 25, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.433 Vali Acc: 0.826 Test Loss: 0.433 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.845252513885498
Epoch: 26, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1722331047058105
Epoch: 27, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8574018478393555
Epoch: 28, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.137183666229248
Epoch: 29, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.103665590286255
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.3360373973846436
Epoch: 31, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.426574945449829
Epoch: 32, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 921152
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.425759553909302
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.409 Vali Acc: 0.312 Test Loss: 1.409 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.7781546115875244
Epoch: 2, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.335 Vali Acc: 0.428 Test Loss: 1.335 Test Acc: 0.428
Validation loss decreased (-0.311580 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 2.0885541439056396
Epoch: 3, Steps: 9 | Train Loss: 1.242 Vali Loss: 1.242 Vali Acc: 0.442 Test Loss: 1.242 Test Acc: 0.442
Validation loss decreased (-0.427523 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 2.04366135597229
Epoch: 4, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.135 Vali Acc: 0.522 Test Loss: 1.135 Test Acc: 0.522
Validation loss decreased (-0.442017 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 2.2497386932373047
Epoch: 5, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.022 Vali Acc: 0.587 Test Loss: 1.022 Test Acc: 0.587
Validation loss decreased (-0.521728 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 1.605081558227539
Epoch: 6, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.935 Vali Acc: 0.587 Test Loss: 0.935 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 7 cost time: 2.0497686862945557
Epoch: 7, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.867 Vali Acc: 0.638 Test Loss: 0.867 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 1.6934826374053955
Epoch: 8, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.826 Vali Acc: 0.623 Test Loss: 0.826 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9373133182525635
Epoch: 9, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.774 Vali Acc: 0.667 Test Loss: 0.774 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.9921653270721436
Epoch: 10, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.750 Vali Acc: 0.674 Test Loss: 0.750 Test Acc: 0.674
Validation loss decreased (-0.666659 --> -0.673906).  Saving model ...
Epoch: 11 cost time: 2.0135293006896973
Epoch: 11, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.713 Vali Acc: 0.681 Test Loss: 0.713 Test Acc: 0.681
Validation loss decreased (-0.673906 --> -0.681152).  Saving model ...
Epoch: 12 cost time: 2.1055052280426025
Epoch: 12, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717385).  Saving model ...
Epoch: 13 cost time: 2.0360519886016846
Epoch: 13, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.7784812450408936
Epoch: 14, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.595 Vali Acc: 0.739 Test Loss: 0.595 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.783445119857788
Epoch: 15, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 1.5818047523498535
Epoch: 16, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.556 Vali Acc: 0.768 Test Loss: 0.556 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7623367309570312
Epoch: 17, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.538 Vali Acc: 0.775 Test Loss: 0.538 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0439200401306152
Epoch: 18, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782604).  Saving model ...
Epoch: 19 cost time: 2.2024967670440674
Epoch: 19, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.502 Vali Acc: 0.790 Test Loss: 0.502 Test Acc: 0.790
Validation loss decreased (-0.782604 --> -0.789850).  Saving model ...
Epoch: 20 cost time: 1.5732603073120117
Epoch: 20, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.623 Vali Acc: 0.797 Test Loss: 0.623 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797095).  Saving model ...
Epoch: 21 cost time: 1.9733519554138184
Epoch: 21, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.486 Vali Acc: 0.812 Test Loss: 0.486 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811589).  Saving model ...
Epoch: 22 cost time: 1.9033141136169434
Epoch: 22, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6835083961486816
Epoch: 23, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 1.6831176280975342
Epoch: 24, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9396326541900635
Epoch: 25, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0135557651519775
Epoch: 26, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8112421035766602
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5703036785125732
Epoch: 28, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 29 cost time: 1.8256542682647705
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.663 Vali Acc: 0.797 Test Loss: 0.663 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6991181373596191
Epoch: 30, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.003634214401245
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.126823902130127
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8263790607452393
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 34 cost time: 1.5495405197143555
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7571935653686523
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6927063465118408
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.551 Vali Acc: 0.855 Test Loss: 0.551 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7149608135223389
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.877 Test Loss: 0.453 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 38 cost time: 2.071824789047241
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9669804573059082
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.970813274383545
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.0692224502563477
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.015436887741089
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.9294300079345703
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.516 Vali Acc: 0.862 Test Loss: 0.516 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7241699695587158
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.479302167892456
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.894413948059082
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.862 Test Loss: 0.569 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.8016064167022705
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.848 Test Loss: 0.541 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 918912
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8718373775482178
Epoch: 1, Steps: 9 | Train Loss: 1.489 Vali Loss: 1.452 Vali Acc: 0.355 Test Loss: 1.452 Test Acc: 0.355
Validation loss decreased (inf --> -0.355058).  Saving model ...
Epoch: 2 cost time: 1.9646837711334229
Epoch: 2, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.352 Vali Acc: 0.283 Test Loss: 1.352 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8661465644836426
Epoch: 3, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.264 Vali Acc: 0.464 Test Loss: 1.264 Test Acc: 0.464
Validation loss decreased (-0.355058 --> -0.463755).  Saving model ...
Epoch: 4 cost time: 2.253321886062622
Epoch: 4, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.158 Vali Acc: 0.587 Test Loss: 1.158 Test Acc: 0.587
Validation loss decreased (-0.463755 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 1.9845490455627441
Epoch: 5, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.037 Vali Acc: 0.580 Test Loss: 1.037 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5039055347442627
Epoch: 6, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.935 Vali Acc: 0.652 Test Loss: 0.935 Test Acc: 0.652
Validation loss decreased (-0.586945 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 2.1928606033325195
Epoch: 7, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.844 Vali Acc: 0.696 Test Loss: 0.844 Test Acc: 0.696
Validation loss decreased (-0.652165 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 1.7713994979858398
Epoch: 8, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.782 Vali Acc: 0.696 Test Loss: 0.782 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695644).  Saving model ...
Epoch: 9 cost time: 2.1648380756378174
Epoch: 9, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.739 Vali Acc: 0.674 Test Loss: 0.739 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9675729274749756
Epoch: 10, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 1.797581434249878
Epoch: 11, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.877018928527832
Epoch: 12, Steps: 9 | Train Loss: 0.404 Vali Loss: 0.617 Vali Acc: 0.739 Test Loss: 0.617 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 13 cost time: 2.2850847244262695
Epoch: 13, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.578 Vali Acc: 0.768 Test Loss: 0.578 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768110).  Saving model ...
Epoch: 14 cost time: 2.0257322788238525
Epoch: 14, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1762142181396484
Epoch: 15, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.530 Vali Acc: 0.775 Test Loss: 0.530 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 16 cost time: 2.1475577354431152
Epoch: 16, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.512 Vali Acc: 0.790 Test Loss: 0.512 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 1.9891059398651123
Epoch: 17, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.484 Vali Acc: 0.775 Test Loss: 0.484 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6885592937469482
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.507 Vali Acc: 0.797 Test Loss: 0.507 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 19 cost time: 1.8658816814422607
Epoch: 19, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 2.0517008304595947
Epoch: 20, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 3.1881253719329834
Epoch: 21, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.383 Vali Acc: 0.841 Test Loss: 0.383 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.029196262359619
Epoch: 22, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.460 Vali Acc: 0.826 Test Loss: 0.460 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.184868097305298
Epoch: 23, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 1.637493371963501
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.467 Vali Acc: 0.819 Test Loss: 0.467 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7962944507598877
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 26 cost time: 2.4627771377563477
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1829869747161865
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7695868015289307
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.315 Vali Acc: 0.877 Test Loss: 0.315 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1371524333953857
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7678937911987305
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9707958698272705
Epoch: 31, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.345 Vali Acc: 0.870 Test Loss: 0.345 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0624239444732666
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1011064052581787
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.862 Test Loss: 0.343 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.099813461303711
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7427234649658203
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 916672
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.4639551639556885
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 2.1536593437194824
Epoch: 2, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.301 Vali Acc: 0.399 Test Loss: 1.301 Test Acc: 0.399
Validation loss decreased (-0.297088 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 2.2702248096466064
Epoch: 3, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.193 Vali Acc: 0.420 Test Loss: 1.193 Test Acc: 0.420
Validation loss decreased (-0.398538 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 1.9487881660461426
Epoch: 4, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.073 Vali Acc: 0.572 Test Loss: 1.073 Test Acc: 0.572
Validation loss decreased (-0.420278 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 2.0718677043914795
Epoch: 5, Steps: 9 | Train Loss: 0.976 Vali Loss: 0.968 Vali Acc: 0.616 Test Loss: 0.968 Test Acc: 0.616
Validation loss decreased (-0.572453 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 1.8979249000549316
Epoch: 6, Steps: 9 | Train Loss: 0.849 Vali Loss: 0.897 Vali Acc: 0.623 Test Loss: 0.897 Test Acc: 0.623
Validation loss decreased (-0.615932 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 2.448596954345703
Epoch: 7, Steps: 9 | Train Loss: 0.716 Vali Loss: 0.835 Vali Acc: 0.645 Test Loss: 0.835 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.830256462097168
Epoch: 8, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.791 Vali Acc: 0.667 Test Loss: 0.791 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 1.6718099117279053
Epoch: 9, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.744 Vali Acc: 0.710 Test Loss: 0.744 Test Acc: 0.710
Validation loss decreased (-0.666659 --> -0.710137).  Saving model ...
Epoch: 10 cost time: 2.0862863063812256
Epoch: 10, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.705 Vali Acc: 0.688 Test Loss: 0.705 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2697715759277344
Epoch: 11, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.700 Vali Acc: 0.725 Test Loss: 0.700 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 2.4673733711242676
Epoch: 12, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.682 Vali Acc: 0.696 Test Loss: 0.682 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8375000953674316
Epoch: 13, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.650 Vali Acc: 0.725 Test Loss: 0.650 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 14 cost time: 2.141510248184204
Epoch: 14, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.618 Vali Acc: 0.732 Test Loss: 0.618 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 15 cost time: 1.8988494873046875
Epoch: 15, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.577 Vali Acc: 0.768 Test Loss: 0.577 Test Acc: 0.768
Validation loss decreased (-0.731878 --> -0.768110).  Saving model ...
Epoch: 16 cost time: 2.0436909198760986
Epoch: 16, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.594 Vali Acc: 0.754 Test Loss: 0.594 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9852650165557861
Epoch: 17, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 18 cost time: 2.02272629737854
Epoch: 18, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.529 Vali Acc: 0.790 Test Loss: 0.529 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.509150266647339
Epoch: 19, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 20 cost time: 1.9291582107543945
Epoch: 20, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.883021593093872
Epoch: 21, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.471 Vali Acc: 0.812 Test Loss: 0.471 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8229248523712158
Epoch: 22, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.99570631980896
Epoch: 23, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.9490423202514648
Epoch: 24, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 25 cost time: 2.456024169921875
Epoch: 25, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8340961933135986
Epoch: 26, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.391 Vali Acc: 0.848 Test Loss: 0.391 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 1.9996716976165771
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9604551792144775
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 29 cost time: 1.8326866626739502
Epoch: 29, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5291461944580078
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.6474108695983887
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 32 cost time: 2.0037734508514404
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5589845180511475
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0399255752563477
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 2.0056700706481934
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0317437648773193
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9332759380340576
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8866395950317383
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.0241506099700928
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.9032981395721436
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.818652868270874
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.1260125637054443
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.5549488067626953
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.140277862548828
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 774784
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.761358022689819
Epoch: 1, Steps: 9 | Train Loss: 1.491 Vali Loss: 1.462 Vali Acc: 0.290 Test Loss: 1.462 Test Acc: 0.290
Validation loss decreased (inf --> -0.289840).  Saving model ...
Epoch: 2 cost time: 1.8750600814819336
Epoch: 2, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.391 Vali Acc: 0.246 Test Loss: 1.391 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8236761093139648
Epoch: 3, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.319 Vali Acc: 0.362 Test Loss: 1.319 Test Acc: 0.362
Validation loss decreased (-0.289840 --> -0.362306).  Saving model ...
Epoch: 4 cost time: 2.161771535873413
Epoch: 4, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.226 Vali Acc: 0.493 Test Loss: 1.226 Test Acc: 0.493
Validation loss decreased (-0.362306 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 1.9126067161560059
Epoch: 5, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.102 Vali Acc: 0.551 Test Loss: 1.102 Test Acc: 0.551
Validation loss decreased (-0.492741 --> -0.550714).  Saving model ...
Epoch: 6 cost time: 2.0855748653411865
Epoch: 6, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.000 Vali Acc: 0.638 Test Loss: 1.000 Test Acc: 0.638
Validation loss decreased (-0.550714 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 2.157125234603882
Epoch: 7, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.908 Vali Acc: 0.681 Test Loss: 0.908 Test Acc: 0.681
Validation loss decreased (-0.637671 --> -0.681150).  Saving model ...
Epoch: 8 cost time: 1.966191291809082
Epoch: 8, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.847 Vali Acc: 0.681 Test Loss: 0.847 Test Acc: 0.681
Validation loss decreased (-0.681150 --> -0.681151).  Saving model ...
Epoch: 9 cost time: 1.8450143337249756
Epoch: 9, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.826 Vali Acc: 0.630 Test Loss: 0.826 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0114822387695312
Epoch: 10, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.769 Vali Acc: 0.696 Test Loss: 0.769 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 11 cost time: 2.0009765625
Epoch: 11, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.740 Vali Acc: 0.674 Test Loss: 0.740 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2408699989318848
Epoch: 12, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.732 Vali Acc: 0.681 Test Loss: 0.732 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.358757495880127
Epoch: 13, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.674 Vali Acc: 0.703 Test Loss: 0.674 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702892).  Saving model ...
Epoch: 14 cost time: 2.4456701278686523
Epoch: 14, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731877).  Saving model ...
Epoch: 15 cost time: 2.292371988296509
Epoch: 15, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 16 cost time: 2.0152738094329834
Epoch: 16, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.581519365310669
Epoch: 17, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 2.241180896759033
Epoch: 18, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 19 cost time: 2.0442237854003906
Epoch: 19, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.567 Vali Acc: 0.797 Test Loss: 0.567 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 20 cost time: 1.8358004093170166
Epoch: 20, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.528 Vali Acc: 0.790 Test Loss: 0.528 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.252753973007202
Epoch: 21, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.550 Vali Acc: 0.761 Test Loss: 0.550 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4225592613220215
Epoch: 22, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.443 Vali Acc: 0.783 Test Loss: 0.443 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6011829376220703
Epoch: 23, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 24 cost time: 1.5195186138153076
Epoch: 24, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 2.095019578933716
Epoch: 25, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.568 Vali Acc: 0.797 Test Loss: 0.568 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2660419940948486
Epoch: 26, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.617 Vali Acc: 0.804 Test Loss: 0.617 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2412102222442627
Epoch: 27, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5908405780792236
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.23425555229187
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 2.162224769592285
Epoch: 30, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8931941986083984
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.28316068649292
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.051774740219116
Epoch: 33, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.691 Vali Acc: 0.841 Test Loss: 0.691 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.101130485534668
Epoch: 34, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2168679237365723
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876807).  Saving model ...
Epoch: 36 cost time: 2.224060297012329
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.527428150177002
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.077195405960083
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.3494925498962402
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9849390983581543
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.0947067737579346
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.1297059059143066
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.175808906555176
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.9311654567718506
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.9240052700042725
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 772544
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.27632737159729
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.311 Vali Acc: 0.377 Test Loss: 1.311 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 1.9152100086212158
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.247 Vali Acc: 0.486 Test Loss: 1.247 Test Acc: 0.486
Validation loss decreased (-0.376798 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.4651198387145996
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.130 Vali Acc: 0.572 Test Loss: 1.130 Test Acc: 0.572
Validation loss decreased (-0.485495 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.6341400146484375
Epoch: 4, Steps: 9 | Train Loss: 1.097 Vali Loss: 1.014 Vali Acc: 0.645 Test Loss: 1.014 Test Acc: 0.645
Validation loss decreased (-0.572452 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 1.6842238903045654
Epoch: 5, Steps: 9 | Train Loss: 0.943 Vali Loss: 0.924 Vali Acc: 0.674 Test Loss: 0.924 Test Acc: 0.674
Validation loss decreased (-0.644917 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.865469217300415
Epoch: 6, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.855 Vali Acc: 0.674 Test Loss: 0.855 Test Acc: 0.674
Validation loss decreased (-0.673904 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 1.9200773239135742
Epoch: 7, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.795 Vali Acc: 0.659 Test Loss: 0.795 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8187716007232666
Epoch: 8, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.736 Vali Acc: 0.659 Test Loss: 0.736 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9437744617462158
Epoch: 9, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.702 Vali Acc: 0.681 Test Loss: 0.702 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 1.5407640933990479
Epoch: 10, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.682 Vali Acc: 0.659 Test Loss: 0.682 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8125460147857666
Epoch: 11, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.665 Vali Acc: 0.703 Test Loss: 0.665 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702892).  Saving model ...
Epoch: 12 cost time: 1.9956161975860596
Epoch: 12, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 1.6965372562408447
Epoch: 13, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.554 Vali Acc: 0.746 Test Loss: 0.554 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 14 cost time: 1.8557729721069336
Epoch: 14, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.529 Vali Acc: 0.775 Test Loss: 0.529 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 1.9342041015625
Epoch: 15, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782604).  Saving model ...
Epoch: 16 cost time: 1.974686861038208
Epoch: 16, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.543 Vali Acc: 0.768 Test Loss: 0.543 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.960942268371582
Epoch: 17, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
Validation loss decreased (-0.782604 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 2.2005372047424316
Epoch: 18, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.7894129753112793
Epoch: 19, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.411 Vali Acc: 0.826 Test Loss: 0.411 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9520256519317627
Epoch: 20, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7784321308135986
Epoch: 21, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7776002883911133
Epoch: 22, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.362 Vali Acc: 0.826 Test Loss: 0.362 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7532916069030762
Epoch: 23, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
Validation loss decreased (-0.847822 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 1.5364012718200684
Epoch: 24, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.081336259841919
Epoch: 25, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.343 Vali Acc: 0.862 Test Loss: 0.343 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6860673427581787
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7256834506988525
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0664827823638916
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.334 Vali Acc: 0.870 Test Loss: 0.334 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.919426679611206
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6172206401824951
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.331 Vali Acc: 0.877 Test Loss: 0.331 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.761855125427246
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.315 Vali Acc: 0.870 Test Loss: 0.315 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.853182077407837
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7450973987579346
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 770304
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.287853956222534
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.443 Vali Acc: 0.203 Test Loss: 1.443 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 2.493274211883545
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.345 Vali Acc: 0.362 Test Loss: 1.345 Test Acc: 0.362
Validation loss decreased (-0.202884 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 2.138747215270996
Epoch: 3, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.255 Vali Acc: 0.543 Test Loss: 1.255 Test Acc: 0.543
Validation loss decreased (-0.362305 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 2.1555228233337402
Epoch: 4, Steps: 9 | Train Loss: 1.127 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.199108123779297
Epoch: 5, Steps: 9 | Train Loss: 0.992 Vali Loss: 1.018 Vali Acc: 0.645 Test Loss: 1.018 Test Acc: 0.645
Validation loss decreased (-0.543466 --> -0.644917).  Saving model ...
Epoch: 6 cost time: 1.9951024055480957
Epoch: 6, Steps: 9 | Train Loss: 0.878 Vali Loss: 0.901 Vali Acc: 0.652 Test Loss: 0.901 Test Acc: 0.652
Validation loss decreased (-0.644917 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 2.706740617752075
Epoch: 7, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.834 Vali Acc: 0.688 Test Loss: 0.834 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 1.7983574867248535
Epoch: 8, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.794 Vali Acc: 0.601 Test Loss: 0.794 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.396824359893799
Epoch: 9, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.744 Vali Acc: 0.681 Test Loss: 0.744 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.05471134185791
Epoch: 10, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.734 Vali Acc: 0.674 Test Loss: 0.734 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.726982593536377
Epoch: 11, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.711 Vali Acc: 0.674 Test Loss: 0.711 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8387386798858643
Epoch: 12, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.632 Vali Acc: 0.768 Test Loss: 0.632 Test Acc: 0.768
Validation loss decreased (-0.688397 --> -0.768110).  Saving model ...
Epoch: 13 cost time: 2.3115224838256836
Epoch: 13, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9356155395507812
Epoch: 14, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.604 Vali Acc: 0.725 Test Loss: 0.604 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0708558559417725
Epoch: 15, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.300285577774048
Epoch: 16, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.589 Vali Acc: 0.768 Test Loss: 0.589 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 17 cost time: 1.986882209777832
Epoch: 17, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.544 Vali Acc: 0.754 Test Loss: 0.544 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.124443531036377
Epoch: 18, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.544 Vali Acc: 0.790 Test Loss: 0.544 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.7934534549713135
Epoch: 19, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 20 cost time: 1.975611686706543
Epoch: 20, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.488 Vali Acc: 0.790 Test Loss: 0.488 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.176867961883545
Epoch: 21, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8299431800842285
Epoch: 22, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.425 Vali Acc: 0.812 Test Loss: 0.425 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 23 cost time: 1.9793057441711426
Epoch: 23, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.865166187286377
Epoch: 24, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 1.6879122257232666
Epoch: 25, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0329012870788574
Epoch: 26, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8480193614959717
Epoch: 27, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6497688293457031
Epoch: 28, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1535725593566895
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 2.312776803970337
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.517 Vali Acc: 0.862 Test Loss: 0.517 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 31 cost time: 2.123608350753784
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1733179092407227
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8383088111877441
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.807077169418335
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.878835916519165
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.057523488998413
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 37 cost time: 2.1911301612854004
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 38 cost time: 1.991337776184082
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.518 Vali Acc: 0.862 Test Loss: 0.518 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8120291233062744
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 40 cost time: 2.1066391468048096
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9359524250030518
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 42 cost time: 2.0017895698547363
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7879996299743652
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7467455863952637
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8228108882904053
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.116124391555786
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.521 Vali Acc: 0.862 Test Loss: 0.521 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.932823657989502
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.499019145965576
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.3486576080322266
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.5855929851531982
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.118928909301758
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.862 Test Loss: 0.507 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 768064
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.51601243019104
Epoch: 1, Steps: 9 | Train Loss: 1.496 Vali Loss: 1.444 Vali Acc: 0.254 Test Loss: 1.444 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.7409472465515137
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.367 Vali Acc: 0.384 Test Loss: 1.367 Test Acc: 0.384
Validation loss decreased (-0.253609 --> -0.384044).  Saving model ...
Epoch: 3 cost time: 1.8289504051208496
Epoch: 3, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.298 Vali Acc: 0.471 Test Loss: 1.298 Test Acc: 0.471
Validation loss decreased (-0.384044 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 2.599367141723633
Epoch: 4, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.201 Vali Acc: 0.420 Test Loss: 1.201 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7502996921539307
Epoch: 5, Steps: 9 | Train Loss: 1.078 Vali Loss: 1.089 Vali Acc: 0.543 Test Loss: 1.089 Test Acc: 0.543
Validation loss decreased (-0.471002 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 1.874352216720581
Epoch: 6, Steps: 9 | Train Loss: 0.927 Vali Loss: 1.015 Vali Acc: 0.638 Test Loss: 1.015 Test Acc: 0.638
Validation loss decreased (-0.543467 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 1.7420878410339355
Epoch: 7, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.913 Vali Acc: 0.659 Test Loss: 0.913 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 2.067193031311035
Epoch: 8, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.855 Vali Acc: 0.674 Test Loss: 0.855 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673904).  Saving model ...
Epoch: 9 cost time: 1.756758213043213
Epoch: 9, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.823 Vali Acc: 0.681 Test Loss: 0.823 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 10 cost time: 1.7410435676574707
Epoch: 10, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.796 Vali Acc: 0.652 Test Loss: 0.796 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.10155987739563
Epoch: 11, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.758 Vali Acc: 0.739 Test Loss: 0.758 Test Acc: 0.739
Validation loss decreased (-0.681151 --> -0.739123).  Saving model ...
Epoch: 12 cost time: 1.7812144756317139
Epoch: 12, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.732 Vali Acc: 0.717 Test Loss: 0.732 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.182300090789795
Epoch: 13, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
Validation loss decreased (-0.739123 --> -0.760863).  Saving model ...
Epoch: 14 cost time: 2.013493061065674
Epoch: 14, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1625146865844727
Epoch: 15, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.618 Vali Acc: 0.797 Test Loss: 0.618 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797095).  Saving model ...
Epoch: 16 cost time: 2.003218650817871
Epoch: 16, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6843109130859375
Epoch: 17, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.597 Vali Acc: 0.797 Test Loss: 0.597 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 18 cost time: 1.8763580322265625
Epoch: 18, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.863267183303833
Epoch: 19, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7253122329711914
Epoch: 20, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 21 cost time: 1.9031014442443848
Epoch: 21, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.804342 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 2.297096014022827
Epoch: 22, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.615 Vali Acc: 0.797 Test Loss: 0.615 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9544811248779297
Epoch: 23, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.543 Vali Acc: 0.768 Test Loss: 0.543 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2184629440307617
Epoch: 24, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8464384078979492
Epoch: 25, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9934682846069336
Epoch: 26, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.424 Vali Acc: 0.848 Test Loss: 0.424 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7023069858551025
Epoch: 27, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1070027351379395
Epoch: 28, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.576993465423584
Epoch: 29, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.958559513092041
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 2.2461514472961426
Epoch: 31, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 32 cost time: 1.8637771606445312
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1223554611206055
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 34 cost time: 1.9426319599151611
Epoch: 34, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9501478672027588
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.352 Vali Acc: 0.884 Test Loss: 0.352 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6373393535614014
Epoch: 36, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7585604190826416
Epoch: 37, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.466 Vali Acc: 0.826 Test Loss: 0.466 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.812929630279541
Epoch: 38, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6826438903808594
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.817037582397461
Epoch: 40, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8061866760253906
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8120615482330322
Epoch: 42, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.3345401287078857
Epoch: 43, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 764704
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.91243839263916
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.394 Vali Acc: 0.246 Test Loss: 1.394 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.7528955936431885
Epoch: 2, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.359 Vali Acc: 0.341 Test Loss: 1.359 Test Acc: 0.341
Validation loss decreased (-0.246363 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.9721951484680176
Epoch: 3, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.257 Vali Acc: 0.478 Test Loss: 1.257 Test Acc: 0.478
Validation loss decreased (-0.340566 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 1.7060678005218506
Epoch: 4, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.147 Vali Acc: 0.536 Test Loss: 1.147 Test Acc: 0.536
Validation loss decreased (-0.478248 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 2.0990278720855713
Epoch: 5, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.058 Vali Acc: 0.652 Test Loss: 1.058 Test Acc: 0.652
Validation loss decreased (-0.536220 --> -0.652163).  Saving model ...
Epoch: 6 cost time: 1.7243878841400146
Epoch: 6, Steps: 9 | Train Loss: 0.927 Vali Loss: 0.984 Vali Acc: 0.630 Test Loss: 0.984 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6161549091339111
Epoch: 7, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.887 Vali Acc: 0.674 Test Loss: 0.887 Test Acc: 0.674
Validation loss decreased (-0.652163 --> -0.673904).  Saving model ...
Epoch: 8 cost time: 1.8257794380187988
Epoch: 8, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.836 Vali Acc: 0.710 Test Loss: 0.836 Test Acc: 0.710
Validation loss decreased (-0.673904 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 1.637371301651001
Epoch: 9, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.765 Vali Acc: 0.761 Test Loss: 0.765 Test Acc: 0.761
Validation loss decreased (-0.710137 --> -0.760862).  Saving model ...
Epoch: 10 cost time: 1.6027493476867676
Epoch: 10, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.717 Vali Acc: 0.790 Test Loss: 0.717 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 1.682044267654419
Epoch: 11, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.622 Vali Acc: 0.790 Test Loss: 0.622 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.9956705570220947
Epoch: 12, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 1.9486169815063477
Epoch: 13, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.6703312397003174
Epoch: 14, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.513 Vali Acc: 0.862 Test Loss: 0.513 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 1.9913945198059082
Epoch: 15, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.396 Vali Acc: 0.870 Test Loss: 0.396 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.8869855403900146
Epoch: 16, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8702168464660645
Epoch: 17, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 18 cost time: 1.5536353588104248
Epoch: 18, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6767218112945557
Epoch: 19, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 1.7109038829803467
Epoch: 20, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9570460319519043
Epoch: 21, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7413361072540283
Epoch: 22, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.045987129211426
Epoch: 23, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9040656089782715
Epoch: 24, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.318 Vali Acc: 0.884 Test Loss: 0.318 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7482876777648926
Epoch: 25, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 2.176631212234497
Epoch: 26, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1188461780548096
Epoch: 27, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 28 cost time: 1.8583672046661377
Epoch: 28, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.340 Vali Acc: 0.862 Test Loss: 0.340 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.655689001083374
Epoch: 29, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (-0.891301 --> -0.927533).  Saving model ...
Epoch: 30 cost time: 1.772336721420288
Epoch: 30, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5712196826934814
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 32 cost time: 1.7737698554992676
Epoch: 32, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.152423620223999
Epoch: 33, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.256 Vali Acc: 0.913 Test Loss: 0.256 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8843257427215576
Epoch: 34, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.928 Test Loss: 0.267 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 35 cost time: 1.8403379917144775
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.265 Vali Acc: 0.899 Test Loss: 0.265 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0135908126831055
Epoch: 36, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.64003586769104
Epoch: 37, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.3142218589782715
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.790 Test Loss: 0.482 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.7421963214874268
Epoch: 39, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942027).  Saving model ...
Epoch: 40 cost time: 2.0289275646209717
Epoch: 40, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8628833293914795
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.319 Vali Acc: 0.870 Test Loss: 0.319 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.1366543769836426
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6134989261627197
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.562793254852295
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.615161418914795
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.880638837814331
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9789371490478516
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.8048017024993896
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.736710786819458
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 763584
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.851790189743042
Epoch: 1, Steps: 9 | Train Loss: 1.554 Vali Loss: 1.417 Vali Acc: 0.312 Test Loss: 1.417 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.7378003597259521
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.368 Vali Acc: 0.225 Test Loss: 1.368 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6994836330413818
Epoch: 3, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.319 Vali Acc: 0.341 Test Loss: 1.319 Test Acc: 0.341
Validation loss decreased (-0.311580 --> -0.340567).  Saving model ...
Epoch: 4 cost time: 1.5492534637451172
Epoch: 4, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.263 Vali Acc: 0.471 Test Loss: 1.263 Test Acc: 0.471
Validation loss decreased (-0.340567 --> -0.471002).  Saving model ...
Epoch: 5 cost time: 2.0529839992523193
Epoch: 5, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.159 Vali Acc: 0.471 Test Loss: 1.159 Test Acc: 0.471
Validation loss decreased (-0.471002 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 1.8193132877349854
Epoch: 6, Steps: 9 | Train Loss: 1.033 Vali Loss: 1.046 Vali Acc: 0.587 Test Loss: 1.046 Test Acc: 0.587
Validation loss decreased (-0.471003 --> -0.586946).  Saving model ...
Epoch: 7 cost time: 1.8182392120361328
Epoch: 7, Steps: 9 | Train Loss: 0.907 Vali Loss: 0.968 Vali Acc: 0.652 Test Loss: 0.968 Test Acc: 0.652
Validation loss decreased (-0.586946 --> -0.652164).  Saving model ...
Epoch: 8 cost time: 1.7650387287139893
Epoch: 8, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.899 Vali Acc: 0.616 Test Loss: 0.899 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0486433506011963
Epoch: 9, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.791 Vali Acc: 0.717 Test Loss: 0.791 Test Acc: 0.717
Validation loss decreased (-0.652164 --> -0.717383).  Saving model ...
Epoch: 10 cost time: 1.8188519477844238
Epoch: 10, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.753 Vali Acc: 0.703 Test Loss: 0.753 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7108731269836426
Epoch: 11, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.684 Vali Acc: 0.746 Test Loss: 0.684 Test Acc: 0.746
Validation loss decreased (-0.717383 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 1.9978504180908203
Epoch: 12, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
Validation loss decreased (-0.746370 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.8191757202148438
Epoch: 13, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8968255519866943
Epoch: 14, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.550 Vali Acc: 0.804 Test Loss: 0.550 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9196257591247559
Epoch: 15, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5638337135314941
Epoch: 16, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 1.9358925819396973
Epoch: 17, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 1.7401235103607178
Epoch: 18, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7580902576446533
Epoch: 19, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9581162929534912
Epoch: 20, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 1.7142293453216553
Epoch: 21, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 1.746403694152832
Epoch: 22, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5005416870117188
Epoch: 23, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7717719078063965
Epoch: 24, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.831247091293335
Epoch: 25, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
Validation loss decreased (-0.920287 --> -0.942027).  Saving model ...
Epoch: 26 cost time: 1.964200735092163
Epoch: 26, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8875072002410889
Epoch: 27, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9165892601013184
Epoch: 28, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4713704586029053
Epoch: 29, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.320 Vali Acc: 0.884 Test Loss: 0.320 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8487858772277832
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.914074420928955
Epoch: 31, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8439640998840332
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.826777696609497
Epoch: 33, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.301 Vali Acc: 0.928 Test Loss: 0.301 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7035529613494873
Epoch: 34, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.2155866622924805
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 762464
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5299293994903564
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.306 Vali Acc: 0.391 Test Loss: 1.306 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 2.117190361022949
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
Validation loss decreased (-0.391291 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 1.6373176574707031
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.159 Vali Acc: 0.529 Test Loss: 1.159 Test Acc: 0.529
Validation loss decreased (-0.514480 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 1.7609894275665283
Epoch: 4, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.055 Vali Acc: 0.580 Test Loss: 1.055 Test Acc: 0.580
Validation loss decreased (-0.528974 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 2.851074457168579
Epoch: 5, Steps: 9 | Train Loss: 0.939 Vali Loss: 0.983 Vali Acc: 0.638 Test Loss: 0.983 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 2.0160446166992188
Epoch: 6, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.935 Vali Acc: 0.594 Test Loss: 0.935 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.929372787475586
Epoch: 7, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.886 Vali Acc: 0.594 Test Loss: 0.886 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8675215244293213
Epoch: 8, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.844 Vali Acc: 0.623 Test Loss: 0.844 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.383042573928833
Epoch: 9, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.801 Vali Acc: 0.638 Test Loss: 0.801 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637673).  Saving model ...
Epoch: 10 cost time: 1.9794933795928955
Epoch: 10, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.794 Vali Acc: 0.638 Test Loss: 0.794 Test Acc: 0.638
Validation loss decreased (-0.637673 --> -0.637673).  Saving model ...
Epoch: 11 cost time: 2.4402785301208496
Epoch: 11, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.749 Vali Acc: 0.674 Test Loss: 0.749 Test Acc: 0.674
Validation loss decreased (-0.637673 --> -0.673906).  Saving model ...
Epoch: 12 cost time: 1.7785542011260986
Epoch: 12, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.726 Vali Acc: 0.674 Test Loss: 0.726 Test Acc: 0.674
Validation loss decreased (-0.673906 --> -0.673906).  Saving model ...
Epoch: 13 cost time: 2.016636848449707
Epoch: 13, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.694 Vali Acc: 0.696 Test Loss: 0.694 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695645).  Saving model ...
Epoch: 14 cost time: 1.8568482398986816
Epoch: 14, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.707 Vali Acc: 0.739 Test Loss: 0.707 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739123).  Saving model ...
Epoch: 15 cost time: 2.1472554206848145
Epoch: 15, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2405028343200684
Epoch: 16, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.719 Vali Acc: 0.739 Test Loss: 0.719 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.137505054473877
Epoch: 17, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.650 Vali Acc: 0.725 Test Loss: 0.650 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9842989444732666
Epoch: 18, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.648 Vali Acc: 0.746 Test Loss: 0.648 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 19 cost time: 1.8273990154266357
Epoch: 19, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.538 Vali Acc: 0.790 Test Loss: 0.538 Test Acc: 0.790
Validation loss decreased (-0.746370 --> -0.789850).  Saving model ...
Epoch: 20 cost time: 1.922834873199463
Epoch: 20, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0584652423858643
Epoch: 21, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1158900260925293
Epoch: 22, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.775646686553955
Epoch: 23, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.594 Vali Acc: 0.754 Test Loss: 0.594 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8740897178649902
Epoch: 24, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 2.0253376960754395
Epoch: 25, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.609 Vali Acc: 0.797 Test Loss: 0.609 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9979438781738281
Epoch: 26, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 27 cost time: 1.8529856204986572
Epoch: 27, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 1.9377508163452148
Epoch: 28, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.496 Vali Acc: 0.812 Test Loss: 0.496 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6719679832458496
Epoch: 29, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7154743671417236
Epoch: 30, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 31 cost time: 1.5505378246307373
Epoch: 31, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.630 Vali Acc: 0.790 Test Loss: 0.630 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.039583444595337
Epoch: 32, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 33 cost time: 1.8821401596069336
Epoch: 33, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0520660877227783
Epoch: 34, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0622737407684326
Epoch: 35, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.01758074760437
Epoch: 36, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7145066261291504
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.9184095859527588
Epoch: 38, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 39 cost time: 2.473806858062744
Epoch: 39, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.575 Vali Acc: 0.804 Test Loss: 0.575 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9551396369934082
Epoch: 40, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.1369194984436035
Epoch: 41, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6580498218536377
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7861249446868896
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.5142886638641357
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.1085190773010254
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.0550005435943604
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.9580333232879639
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.1203675270080566
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 761344
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9666357040405273
Epoch: 1, Steps: 9 | Train Loss: 1.509 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.7118580341339111
Epoch: 2, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.408 Vali Acc: 0.319 Test Loss: 1.408 Test Acc: 0.319
Validation loss decreased (-0.231870 --> -0.318826).  Saving model ...
Epoch: 3 cost time: 2.2352237701416016
Epoch: 3, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.347 Vali Acc: 0.304 Test Loss: 1.347 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7927403450012207
Epoch: 4, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.283 Vali Acc: 0.413 Test Loss: 1.283 Test Acc: 0.413
Validation loss decreased (-0.318826 --> -0.413031).  Saving model ...
Epoch: 5 cost time: 1.3488304615020752
Epoch: 5, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.214 Vali Acc: 0.435 Test Loss: 1.214 Test Acc: 0.435
Validation loss decreased (-0.413031 --> -0.434770).  Saving model ...
Epoch: 6 cost time: 1.5583686828613281
Epoch: 6, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.133 Vali Acc: 0.507 Test Loss: 1.133 Test Acc: 0.507
Validation loss decreased (-0.434770 --> -0.507235).  Saving model ...
Epoch: 7 cost time: 1.7414846420288086
Epoch: 7, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.045 Vali Acc: 0.587 Test Loss: 1.045 Test Acc: 0.587
Validation loss decreased (-0.507235 --> -0.586946).  Saving model ...
Epoch: 8 cost time: 2.0006678104400635
Epoch: 8, Steps: 9 | Train Loss: 0.858 Vali Loss: 0.959 Vali Acc: 0.645 Test Loss: 0.959 Test Acc: 0.645
Validation loss decreased (-0.586946 --> -0.644918).  Saving model ...
Epoch: 9 cost time: 2.061736583709717
Epoch: 9, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.899 Vali Acc: 0.659 Test Loss: 0.899 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659411).  Saving model ...
Epoch: 10 cost time: 1.7099087238311768
Epoch: 10, Steps: 9 | Train Loss: 0.733 Vali Loss: 0.883 Vali Acc: 0.681 Test Loss: 0.883 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 11 cost time: 1.7184100151062012
Epoch: 11, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.816 Vali Acc: 0.667 Test Loss: 0.816 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.687650442123413
Epoch: 12, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.783 Vali Acc: 0.696 Test Loss: 0.783 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 13 cost time: 1.8789329528808594
Epoch: 13, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.783 Vali Acc: 0.659 Test Loss: 0.783 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9093050956726074
Epoch: 14, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.750 Vali Acc: 0.703 Test Loss: 0.750 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 15 cost time: 1.5349469184875488
Epoch: 15, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.722 Vali Acc: 0.688 Test Loss: 0.722 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6082417964935303
Epoch: 16, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.691 Vali Acc: 0.696 Test Loss: 0.691 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9711644649505615
Epoch: 17, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.678 Vali Acc: 0.710 Test Loss: 0.678 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 18 cost time: 2.0104057788848877
Epoch: 18, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.648 Vali Acc: 0.761 Test Loss: 0.648 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760863).  Saving model ...
Epoch: 19 cost time: 1.774735450744629
Epoch: 19, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.600 Vali Acc: 0.761 Test Loss: 0.600 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 20 cost time: 1.673621416091919
Epoch: 20, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.656 Vali Acc: 0.768 Test Loss: 0.656 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768109).  Saving model ...
Epoch: 21 cost time: 1.830876111984253
Epoch: 21, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.580 Vali Acc: 0.790 Test Loss: 0.580 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 22 cost time: 1.8954544067382812
Epoch: 22, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.576 Vali Acc: 0.775 Test Loss: 0.576 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.444000244140625
Epoch: 23, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.618 Vali Acc: 0.768 Test Loss: 0.618 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8070907592773438
Epoch: 24, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.486 Vali Acc: 0.804 Test Loss: 0.486 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 25 cost time: 2.031205415725708
Epoch: 25, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818835).  Saving model ...
Epoch: 26 cost time: 2.02061128616333
Epoch: 26, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.053417682647705
Epoch: 27, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.119264841079712
Epoch: 28, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 29 cost time: 1.6365041732788086
Epoch: 29, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 30 cost time: 1.6080834865570068
Epoch: 30, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0865378379821777
Epoch: 31, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9063563346862793
Epoch: 32, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 1.9250202178955078
Epoch: 33, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 34 cost time: 1.7839205265045166
Epoch: 34, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0561487674713135
Epoch: 35, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 36 cost time: 2.1548633575439453
Epoch: 36, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 1.8366010189056396
Epoch: 37, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.387 Vali Acc: 0.877 Test Loss: 0.387 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 2.048297643661499
Epoch: 38, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8502652645111084
Epoch: 39, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 40 cost time: 1.9483318328857422
Epoch: 40, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9290924072265625
Epoch: 41, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7370600700378418
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7459540367126465
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8478093147277832
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.9331793785095215
Epoch: 45, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 46 cost time: 1.749312162399292
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.402 Vali Acc: 0.877 Test Loss: 0.402 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9133038520812988
Epoch: 47, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 48 cost time: 1.786656379699707
Epoch: 48, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7110035419464111
Epoch: 49, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.7829995155334473
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.7332501411437988
Epoch: 51, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.902273178100586
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.6570320129394531
Epoch: 53, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.7659227848052979
Epoch: 54, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.714770793914795
Epoch: 55, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.877 Test Loss: 0.509 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.6624212265014648
Epoch: 56, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.5770959854125977
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 465184
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.43471360206604
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.384 Vali Acc: 0.254 Test Loss: 1.384 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.967674732208252
Epoch: 2, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.369 Vali Acc: 0.326 Test Loss: 1.369 Test Acc: 0.326
Validation loss decreased (-0.253609 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 1.7688829898834229
Epoch: 3, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.313 Vali Acc: 0.406 Test Loss: 1.313 Test Acc: 0.406
Validation loss decreased (-0.326073 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 1.9051127433776855
Epoch: 4, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
Validation loss decreased (-0.405784 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.8789441585540771
Epoch: 5, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.209 Vali Acc: 0.457 Test Loss: 1.209 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4549221992492676
Epoch: 6, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.108 Vali Acc: 0.594 Test Loss: 1.108 Test Acc: 0.594
Validation loss decreased (-0.499987 --> -0.594192).  Saving model ...
Epoch: 7 cost time: 2.0474061965942383
Epoch: 7, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.023 Vali Acc: 0.630 Test Loss: 1.023 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 8 cost time: 1.8745522499084473
Epoch: 8, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.947 Vali Acc: 0.674 Test Loss: 0.947 Test Acc: 0.674
Validation loss decreased (-0.630425 --> -0.673904).  Saving model ...
Epoch: 9 cost time: 2.009211301803589
Epoch: 9, Steps: 9 | Train Loss: 0.816 Vali Loss: 0.893 Vali Acc: 0.659 Test Loss: 0.893 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.00406813621521
Epoch: 10, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.834 Vali Acc: 0.674 Test Loss: 0.834 Test Acc: 0.674
Validation loss decreased (-0.673904 --> -0.673905).  Saving model ...
Epoch: 11 cost time: 1.8560755252838135
Epoch: 11, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.801 Vali Acc: 0.710 Test Loss: 0.801 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710137).  Saving model ...
Epoch: 12 cost time: 2.1684820652008057
Epoch: 12, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.765 Vali Acc: 0.754 Test Loss: 0.765 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753616).  Saving model ...
Epoch: 13 cost time: 2.032399892807007
Epoch: 13, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.727 Vali Acc: 0.739 Test Loss: 0.727 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0081114768981934
Epoch: 14, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.694 Vali Acc: 0.768 Test Loss: 0.694 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768109).  Saving model ...
Epoch: 15 cost time: 1.8255317211151123
Epoch: 15, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.986325979232788
Epoch: 16, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 1.897428274154663
Epoch: 17, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.910524845123291
Epoch: 18, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1537578105926514
Epoch: 19, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 2.0560245513916016
Epoch: 20, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.529 Vali Acc: 0.797 Test Loss: 0.529 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.042659282684326
Epoch: 21, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 2.0114834308624268
Epoch: 22, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 1.874192476272583
Epoch: 23, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6924848556518555
Epoch: 24, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.482 Vali Acc: 0.797 Test Loss: 0.482 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0018839836120605
Epoch: 25, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8306162357330322
Epoch: 26, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7320148944854736
Epoch: 27, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.411 Vali Acc: 0.841 Test Loss: 0.411 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.515484571456909
Epoch: 28, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.803335428237915
Epoch: 29, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9242746829986572
Epoch: 30, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 1.942366361618042
Epoch: 31, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.429 Vali Acc: 0.826 Test Loss: 0.429 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3137829303741455
Epoch: 32, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0394344329833984
Epoch: 33, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9230585098266602
Epoch: 34, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7762696743011475
Epoch: 35, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.0307133197784424
Epoch: 36, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.9125795364379883
Epoch: 37, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 2.0717034339904785
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0057456493377686
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9204890727996826
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.735733985900879
Epoch: 41, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.8457200527191162
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.079442024230957
Epoch: 43, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9693603515625
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.145968198776245
Epoch: 45, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.325 Vali Acc: 0.884 Test Loss: 0.325 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.929744005203247
Epoch: 46, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.7268345355987549
Epoch: 47, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 464064
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6119940280914307
Epoch: 1, Steps: 9 | Train Loss: 1.535 Vali Loss: 1.440 Vali Acc: 0.174 Test Loss: 1.440 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 1.9524133205413818
Epoch: 2, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.362 Vali Acc: 0.341 Test Loss: 1.362 Test Acc: 0.341
Validation loss decreased (-0.173899 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.64072585105896
Epoch: 3, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.289 Vali Acc: 0.478 Test Loss: 1.289 Test Acc: 0.478
Validation loss decreased (-0.340566 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 1.9274649620056152
Epoch: 4, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.223 Vali Acc: 0.449 Test Loss: 1.223 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6774208545684814
Epoch: 5, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.136 Vali Acc: 0.543 Test Loss: 1.136 Test Acc: 0.543
Validation loss decreased (-0.478248 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 1.8606820106506348
Epoch: 6, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.055 Vali Acc: 0.652 Test Loss: 1.055 Test Acc: 0.652
Validation loss decreased (-0.543467 --> -0.652163).  Saving model ...
Epoch: 7 cost time: 1.4456744194030762
Epoch: 7, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.989 Vali Acc: 0.652 Test Loss: 0.989 Test Acc: 0.652
Validation loss decreased (-0.652163 --> -0.652164).  Saving model ...
Epoch: 8 cost time: 1.5818400382995605
Epoch: 8, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.943 Vali Acc: 0.630 Test Loss: 0.943 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.065587282180786
Epoch: 9, Steps: 9 | Train Loss: 0.728 Vali Loss: 0.878 Vali Acc: 0.623 Test Loss: 0.878 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8440663814544678
Epoch: 10, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.830 Vali Acc: 0.710 Test Loss: 0.830 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710137).  Saving model ...
Epoch: 11 cost time: 1.7764968872070312
Epoch: 11, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.805 Vali Acc: 0.710 Test Loss: 0.805 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710137).  Saving model ...
Epoch: 12 cost time: 1.6603012084960938
Epoch: 12, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.764 Vali Acc: 0.688 Test Loss: 0.764 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9868011474609375
Epoch: 13, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.731 Vali Acc: 0.739 Test Loss: 0.731 Test Acc: 0.739
Validation loss decreased (-0.710137 --> -0.739123).  Saving model ...
Epoch: 14 cost time: 1.9224138259887695
Epoch: 14, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.715 Vali Acc: 0.703 Test Loss: 0.715 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.555234670639038
Epoch: 15, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7143745422363281
Epoch: 16, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.663 Vali Acc: 0.732 Test Loss: 0.663 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4156126976013184
Epoch: 17, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.640 Vali Acc: 0.754 Test Loss: 0.640 Test Acc: 0.754
Validation loss decreased (-0.739123 --> -0.753617).  Saving model ...
Epoch: 18 cost time: 1.7864913940429688
Epoch: 18, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 19 cost time: 1.6647281646728516
Epoch: 19, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5838382244110107
Epoch: 20, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.550 Vali Acc: 0.790 Test Loss: 0.550 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789850).  Saving model ...
Epoch: 21 cost time: 1.6083216667175293
Epoch: 21, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 22 cost time: 1.7067220211029053
Epoch: 22, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.501 Vali Acc: 0.797 Test Loss: 0.501 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 23 cost time: 1.5826046466827393
Epoch: 23, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.563 Vali Acc: 0.804 Test Loss: 0.563 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 24 cost time: 2.200371026992798
Epoch: 24, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 1.741004228591919
Epoch: 25, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.8311817646026611
Epoch: 26, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.054353713989258
Epoch: 27, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8033854961395264
Epoch: 28, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 1.7249791622161865
Epoch: 29, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 30 cost time: 1.6830735206604004
Epoch: 30, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 31 cost time: 1.8014936447143555
Epoch: 31, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2610514163970947
Epoch: 32, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 33 cost time: 1.9647839069366455
Epoch: 33, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.363 Vali Acc: 0.848 Test Loss: 0.363 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0878095626831055
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9173104763031006
Epoch: 35, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7358393669128418
Epoch: 36, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.447 Vali Acc: 0.812 Test Loss: 0.447 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.319319725036621
Epoch: 37, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.9430325031280518
Epoch: 38, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.9414596557617188
Epoch: 39, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 1.7893168926239014
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8442344665527344
Epoch: 41, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.843095064163208
Epoch: 42, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.222949266433716
Epoch: 43, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.336 Vali Acc: 0.899 Test Loss: 0.336 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 44 cost time: 1.750011682510376
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.269 Vali Acc: 0.920 Test Loss: 0.269 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920287).  Saving model ...
Epoch: 45 cost time: 2.0153913497924805
Epoch: 45, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7543301582336426
Epoch: 46, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.374 Vali Acc: 0.848 Test Loss: 0.374 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.8614540100097656
Epoch: 47, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.324 Vali Acc: 0.877 Test Loss: 0.324 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9772930145263672
Epoch: 48, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.892073631286621
Epoch: 49, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8430392742156982
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 51 cost time: 2.151935338973999
Epoch: 51, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 52 cost time: 2.0143792629241943
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.7138113975524902
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.8240811824798584
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.9421896934509277
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.6679623126983643
Epoch: 56, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.0002493858337402
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.7838151454925537
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.8097560405731201
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.7993385791778564
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.103360414505005
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.913 Test Loss: 0.263 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 462944
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.3115928173065186
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.427 Vali Acc: 0.283 Test Loss: 1.427 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 1.5831916332244873
Epoch: 2, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.370 Vali Acc: 0.261 Test Loss: 1.370 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.722738265991211
Epoch: 3, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.324 Vali Acc: 0.326 Test Loss: 1.324 Test Acc: 0.326
Validation loss decreased (-0.282594 --> -0.326074).  Saving model ...
Epoch: 4 cost time: 2.0294601917266846
Epoch: 4, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.264 Vali Acc: 0.420 Test Loss: 1.264 Test Acc: 0.420
Validation loss decreased (-0.326074 --> -0.420277).  Saving model ...
Epoch: 5 cost time: 1.879807710647583
Epoch: 5, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.184 Vali Acc: 0.572 Test Loss: 1.184 Test Acc: 0.572
Validation loss decreased (-0.420277 --> -0.572452).  Saving model ...
Epoch: 6 cost time: 1.9112732410430908
Epoch: 6, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.116 Vali Acc: 0.536 Test Loss: 1.116 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.849778652191162
Epoch: 7, Steps: 9 | Train Loss: 0.982 Vali Loss: 1.037 Vali Acc: 0.623 Test Loss: 1.037 Test Acc: 0.623
Validation loss decreased (-0.572452 --> -0.623178).  Saving model ...
Epoch: 8 cost time: 1.75563383102417
Epoch: 8, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.966 Vali Acc: 0.659 Test Loss: 0.966 Test Acc: 0.659
Validation loss decreased (-0.623178 --> -0.659411).  Saving model ...
Epoch: 9 cost time: 1.8561699390411377
Epoch: 9, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.913 Vali Acc: 0.659 Test Loss: 0.913 Test Acc: 0.659
Validation loss decreased (-0.659411 --> -0.659411).  Saving model ...
Epoch: 10 cost time: 2.188321113586426
Epoch: 10, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.875 Vali Acc: 0.667 Test Loss: 0.875 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 11 cost time: 1.897165060043335
Epoch: 11, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.823 Vali Acc: 0.696 Test Loss: 0.823 Test Acc: 0.696
Validation loss decreased (-0.666658 --> -0.695644).  Saving model ...
Epoch: 12 cost time: 1.9121251106262207
Epoch: 12, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.827 Vali Acc: 0.688 Test Loss: 0.827 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0374417304992676
Epoch: 13, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.741 Vali Acc: 0.725 Test Loss: 0.741 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 14 cost time: 2.013364553451538
Epoch: 14, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.737 Vali Acc: 0.732 Test Loss: 0.737 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 15 cost time: 2.1255617141723633
Epoch: 15, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.691 Vali Acc: 0.725 Test Loss: 0.691 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.063441038131714
Epoch: 16, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.660 Vali Acc: 0.739 Test Loss: 0.660 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 17 cost time: 2.179037570953369
Epoch: 17, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.655 Vali Acc: 0.732 Test Loss: 0.655 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5345375537872314
Epoch: 18, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768110).  Saving model ...
Epoch: 19 cost time: 2.0826327800750732
Epoch: 19, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1727192401885986
Epoch: 20, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.559 Vali Acc: 0.790 Test Loss: 0.559 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 2.1073522567749023
Epoch: 21, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.582 Vali Acc: 0.761 Test Loss: 0.582 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9790773391723633
Epoch: 22, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.517 Vali Acc: 0.790 Test Loss: 0.517 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 23 cost time: 2.1350576877593994
Epoch: 23, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.576 Vali Acc: 0.746 Test Loss: 0.576 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5702338218688965
Epoch: 24, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.497 Vali Acc: 0.775 Test Loss: 0.497 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8657763004302979
Epoch: 25, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0582849979400635
Epoch: 26, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.451 Vali Acc: 0.804 Test Loss: 0.451 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 27 cost time: 1.935608148574829
Epoch: 27, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.490 Vali Acc: 0.797 Test Loss: 0.490 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9772567749023438
Epoch: 28, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.511 Vali Acc: 0.812 Test Loss: 0.511 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 29 cost time: 1.8672518730163574
Epoch: 29, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9421772956848145
Epoch: 30, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 31 cost time: 2.1013779640197754
Epoch: 31, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826082).  Saving model ...
Epoch: 32 cost time: 1.9559619426727295
Epoch: 32, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 33 cost time: 1.7645299434661865
Epoch: 33, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.389 Vali Acc: 0.841 Test Loss: 0.389 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 34 cost time: 1.7688581943511963
Epoch: 34, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0990326404571533
Epoch: 35, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.926407814025879
Epoch: 36, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.328786611557007
Epoch: 37, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869562).  Saving model ...
Epoch: 38 cost time: 2.2207624912261963
Epoch: 38, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.4043378829956055
Epoch: 39, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.434 Vali Acc: 0.826 Test Loss: 0.434 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.2475733757019043
Epoch: 40, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.17976450920105
Epoch: 41, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.400921106338501
Epoch: 42, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.147433280944824
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.2370989322662354
Epoch: 44, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.391 Vali Acc: 0.848 Test Loss: 0.391 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.247159242630005
Epoch: 45, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.287014961242676
Epoch: 46, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.154017925262451
Epoch: 47, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.396 Vali Acc: 0.841 Test Loss: 0.396 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 461824
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.028644323348999
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.344 Vali Acc: 0.319 Test Loss: 1.344 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.8997817039489746
Epoch: 2, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.323 Vali Acc: 0.406 Test Loss: 1.323 Test Acc: 0.406
Validation loss decreased (-0.318827 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.8716998100280762
Epoch: 3, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.288 Vali Acc: 0.435 Test Loss: 1.288 Test Acc: 0.435
Validation loss decreased (-0.405784 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 1.8273789882659912
Epoch: 4, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.215 Vali Acc: 0.558 Test Loss: 1.215 Test Acc: 0.558
Validation loss decreased (-0.434770 --> -0.557959).  Saving model ...
Epoch: 5 cost time: 1.8378872871398926
Epoch: 5, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.136 Vali Acc: 0.645 Test Loss: 1.136 Test Acc: 0.645
Validation loss decreased (-0.557959 --> -0.644916).  Saving model ...
Epoch: 6 cost time: 1.7454452514648438
Epoch: 6, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.065 Vali Acc: 0.659 Test Loss: 1.065 Test Acc: 0.659
Validation loss decreased (-0.644916 --> -0.659410).  Saving model ...
Epoch: 7 cost time: 1.8437023162841797
Epoch: 7, Steps: 9 | Train Loss: 0.963 Vali Loss: 0.964 Vali Acc: 0.667 Test Loss: 0.964 Test Acc: 0.667
Validation loss decreased (-0.659410 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 1.7724220752716064
Epoch: 8, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.905 Vali Acc: 0.659 Test Loss: 0.905 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6742324829101562
Epoch: 9, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.862 Vali Acc: 0.638 Test Loss: 0.862 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6848411560058594
Epoch: 10, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.817 Vali Acc: 0.652 Test Loss: 0.817 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.736865758895874
Epoch: 11, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.786 Vali Acc: 0.652 Test Loss: 0.786 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7145130634307861
Epoch: 12, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.746 Vali Acc: 0.667 Test Loss: 0.746 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666659).  Saving model ...
Epoch: 13 cost time: 1.5833055973052979
Epoch: 13, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.725 Vali Acc: 0.681 Test Loss: 0.725 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 1.6540148258209229
Epoch: 14, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.701 Vali Acc: 0.696 Test Loss: 0.701 Test Acc: 0.696
Validation loss decreased (-0.681152 --> -0.695645).  Saving model ...
Epoch: 15 cost time: 1.80271577835083
Epoch: 15, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.654 Vali Acc: 0.725 Test Loss: 0.654 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724631).  Saving model ...
Epoch: 16 cost time: 1.4279961585998535
Epoch: 16, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.605 Vali Acc: 0.739 Test Loss: 0.605 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 17 cost time: 1.675757646560669
Epoch: 17, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.617 Vali Acc: 0.754 Test Loss: 0.617 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 18 cost time: 1.7170372009277344
Epoch: 18, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.551 Vali Acc: 0.790 Test Loss: 0.551 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.5980091094970703
Epoch: 19, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.516 Vali Acc: 0.790 Test Loss: 0.516 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 20 cost time: 1.9158804416656494
Epoch: 20, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.489 Vali Acc: 0.804 Test Loss: 0.489 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 21 cost time: 1.6027326583862305
Epoch: 21, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 1.521317720413208
Epoch: 22, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 1.668313980102539
Epoch: 23, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 24 cost time: 1.8814849853515625
Epoch: 24, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.713801383972168
Epoch: 25, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 26 cost time: 1.7042431831359863
Epoch: 26, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6256630420684814
Epoch: 27, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 28 cost time: 1.9402122497558594
Epoch: 28, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.015249490737915
Epoch: 29, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884055).  Saving model ...
Epoch: 30 cost time: 1.9356377124786377
Epoch: 30, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 31 cost time: 1.880197525024414
Epoch: 31, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8342113494873047
Epoch: 32, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8622527122497559
Epoch: 33, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 34 cost time: 2.075193405151367
Epoch: 34, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.614246129989624
Epoch: 35, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6790175437927246
Epoch: 36, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9619722366333008
Epoch: 37, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.080871820449829
Epoch: 38, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.920194149017334
Epoch: 39, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.5832328796386719
Epoch: 40, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5616893768310547
Epoch: 41, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 42 cost time: 2.1580007076263428
Epoch: 42, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8992879390716553
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8372719287872314
Epoch: 44, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4841234683990479
Epoch: 45, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.7035810947418213
Epoch: 46, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.5727007389068604
Epoch: 47, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.036612033843994
Epoch: 48, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 49 cost time: 1.6767349243164062
Epoch: 49, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6454646587371826
Epoch: 50, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8553509712219238
Epoch: 51, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.8286659717559814
Epoch: 52, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.636988878250122
Epoch: 53, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.8083038330078125
Epoch: 54, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.6612026691436768
Epoch: 55, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.913 Test Loss: 0.251 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.6027328968048096
Epoch: 56, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.5737617015838623
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.7389860153198242
Epoch: 58, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 315424
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.784215211868286
Epoch: 1, Steps: 9 | Train Loss: 1.474 Vali Loss: 1.448 Vali Acc: 0.188 Test Loss: 1.448 Test Acc: 0.188
Validation loss decreased (inf --> -0.188391).  Saving model ...
Epoch: 2 cost time: 1.8144738674163818
Epoch: 2, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.393 Vali Acc: 0.370 Test Loss: 1.393 Test Acc: 0.370
Validation loss decreased (-0.188391 --> -0.369551).  Saving model ...
Epoch: 3 cost time: 1.873962163925171
Epoch: 3, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.347 Vali Acc: 0.435 Test Loss: 1.347 Test Acc: 0.435
Validation loss decreased (-0.369551 --> -0.434769).  Saving model ...
Epoch: 4 cost time: 1.7961175441741943
Epoch: 4, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.289 Vali Acc: 0.413 Test Loss: 1.289 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9158775806427002
Epoch: 5, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.214 Vali Acc: 0.572 Test Loss: 1.214 Test Acc: 0.572
Validation loss decreased (-0.434769 --> -0.572452).  Saving model ...
Epoch: 6 cost time: 1.9438304901123047
Epoch: 6, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6218876838684082
Epoch: 7, Steps: 9 | Train Loss: 1.034 Vali Loss: 1.054 Vali Acc: 0.609 Test Loss: 1.054 Test Acc: 0.609
Validation loss decreased (-0.572452 --> -0.608685).  Saving model ...
Epoch: 8 cost time: 2.063845634460449
Epoch: 8, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.983 Vali Acc: 0.638 Test Loss: 0.983 Test Acc: 0.638
Validation loss decreased (-0.608685 --> -0.637671).  Saving model ...
Epoch: 9 cost time: 2.0777997970581055
Epoch: 9, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.935 Vali Acc: 0.630 Test Loss: 0.935 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6771655082702637
Epoch: 10, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.894 Vali Acc: 0.645 Test Loss: 0.894 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644919).  Saving model ...
Epoch: 11 cost time: 1.6448206901550293
Epoch: 11, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.858 Vali Acc: 0.667 Test Loss: 0.858 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666658).  Saving model ...
Epoch: 12 cost time: 2.049375534057617
Epoch: 12, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.839 Vali Acc: 0.667 Test Loss: 0.839 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 13 cost time: 1.7700533866882324
Epoch: 13, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.774 Vali Acc: 0.703 Test Loss: 0.774 Test Acc: 0.703
Validation loss decreased (-0.666658 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 1.5687329769134521
Epoch: 14, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.778 Vali Acc: 0.688 Test Loss: 0.778 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.127450942993164
Epoch: 15, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 16 cost time: 1.7095344066619873
Epoch: 16, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 17 cost time: 1.8745925426483154
Epoch: 17, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.651 Vali Acc: 0.732 Test Loss: 0.651 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 18 cost time: 1.9921090602874756
Epoch: 18, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.591 Vali Acc: 0.739 Test Loss: 0.591 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739125).  Saving model ...
Epoch: 19 cost time: 2.0579230785369873
Epoch: 19, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.615 Vali Acc: 0.761 Test Loss: 0.615 Test Acc: 0.761
Validation loss decreased (-0.739125 --> -0.760863).  Saving model ...
Epoch: 20 cost time: 1.6847913265228271
Epoch: 20, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 2.2775487899780273
Epoch: 21, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.554 Vali Acc: 0.804 Test Loss: 0.554 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 2.0100793838500977
Epoch: 22, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 23 cost time: 1.8342385292053223
Epoch: 23, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9527599811553955
Epoch: 24, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.476 Vali Acc: 0.812 Test Loss: 0.476 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1941428184509277
Epoch: 25, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 1.9794447422027588
Epoch: 26, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 1.9904980659484863
Epoch: 27, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7104341983795166
Epoch: 28, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 1.839402675628662
Epoch: 29, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9946613311767578
Epoch: 30, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 31 cost time: 1.733659267425537
Epoch: 31, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.533 Vali Acc: 0.768 Test Loss: 0.533 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8838098049163818
Epoch: 32, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 33 cost time: 1.9334027767181396
Epoch: 33, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.082704782485962
Epoch: 34, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8545732498168945
Epoch: 35, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.510 Vali Acc: 0.819 Test Loss: 0.510 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8039205074310303
Epoch: 36, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5726089477539062
Epoch: 37, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 38 cost time: 1.506319284439087
Epoch: 38, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.431 Vali Acc: 0.841 Test Loss: 0.431 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6155438423156738
Epoch: 39, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5041298866271973
Epoch: 40, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.874485969543457
Epoch: 41, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5037012100219727
Epoch: 42, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 43 cost time: 1.8601832389831543
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8566265106201172
Epoch: 44, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7494914531707764
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.85737943649292
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6841864585876465
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.0013668537139893
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.9985456466674805
Epoch: 49, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.5436890125274658
Epoch: 50, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.841 Test Loss: 0.394 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.846116065979004
Epoch: 51, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.7657852172851562
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 314304
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.3613715171813965
Epoch: 1, Steps: 9 | Train Loss: 1.543 Vali Loss: 1.437 Vali Acc: 0.196 Test Loss: 1.437 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 2.3256990909576416
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.328 Vali Acc: 0.333 Test Loss: 1.328 Test Acc: 0.333
Validation loss decreased (-0.195638 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 2.095717430114746
Epoch: 3, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.303 Vali Acc: 0.370 Test Loss: 1.303 Test Acc: 0.370
Validation loss decreased (-0.333320 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 1.715090036392212
Epoch: 4, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.214 Vali Acc: 0.478 Test Loss: 1.214 Test Acc: 0.478
Validation loss decreased (-0.369552 --> -0.478249).  Saving model ...
Epoch: 5 cost time: 1.900036334991455
Epoch: 5, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.478249 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.153796911239624
Epoch: 6, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.090 Vali Acc: 0.587 Test Loss: 1.090 Test Acc: 0.587
Validation loss decreased (-0.499988 --> -0.586946).  Saving model ...
Epoch: 7 cost time: 1.9631609916687012
Epoch: 7, Steps: 9 | Train Loss: 0.980 Vali Loss: 1.038 Vali Acc: 0.587 Test Loss: 1.038 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586946).  Saving model ...
Epoch: 8 cost time: 1.8088910579681396
Epoch: 8, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.989 Vali Acc: 0.580 Test Loss: 0.989 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.983773946762085
Epoch: 9, Steps: 9 | Train Loss: 0.830 Vali Loss: 0.934 Vali Acc: 0.587 Test Loss: 0.934 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 10 cost time: 1.6986756324768066
Epoch: 10, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.882 Vali Acc: 0.638 Test Loss: 0.882 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 11 cost time: 2.411146640777588
Epoch: 11, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.844 Vali Acc: 0.630 Test Loss: 0.844 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2684030532836914
Epoch: 12, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.784 Vali Acc: 0.659 Test Loss: 0.784 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 13 cost time: 1.8679187297821045
Epoch: 13, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.744 Vali Acc: 0.703 Test Loss: 0.744 Test Acc: 0.703
Validation loss decreased (-0.659412 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 2.079667568206787
Epoch: 14, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.731 Vali Acc: 0.703 Test Loss: 0.731 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 15 cost time: 1.8725042343139648
Epoch: 15, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.708 Vali Acc: 0.725 Test Loss: 0.708 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 16 cost time: 1.7968955039978027
Epoch: 16, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.694 Vali Acc: 0.739 Test Loss: 0.694 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739123).  Saving model ...
Epoch: 17 cost time: 1.779088020324707
Epoch: 17, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6441457271575928
Epoch: 18, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.636 Vali Acc: 0.732 Test Loss: 0.636 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1704602241516113
Epoch: 19, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.625 Vali Acc: 0.754 Test Loss: 0.625 Test Acc: 0.754
Validation loss decreased (-0.739123 --> -0.753617).  Saving model ...
Epoch: 20 cost time: 2.1855146884918213
Epoch: 20, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 21 cost time: 1.9618585109710693
Epoch: 21, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.513 Vali Acc: 0.797 Test Loss: 0.513 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797096).  Saving model ...
Epoch: 22 cost time: 1.9665162563323975
Epoch: 22, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 1.6222667694091797
Epoch: 23, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.535 Vali Acc: 0.797 Test Loss: 0.535 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7982327938079834
Epoch: 24, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 2.231569528579712
Epoch: 25, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.437 Vali Acc: 0.826 Test Loss: 0.437 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8398103713989258
Epoch: 26, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 1.946864128112793
Epoch: 27, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.576972484588623
Epoch: 28, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 2.3026926517486572
Epoch: 29, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.184053897857666
Epoch: 30, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.388 Vali Acc: 0.841 Test Loss: 0.388 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1089441776275635
Epoch: 31, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.1673340797424316
Epoch: 32, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7878329753875732
Epoch: 33, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9923770427703857
Epoch: 34, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9405279159545898
Epoch: 35, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 36 cost time: 1.987006425857544
Epoch: 36, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 37 cost time: 2.270380735397339
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.182371139526367
Epoch: 38, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8241195678710938
Epoch: 39, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.413771390914917
Epoch: 40, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.1630542278289795
Epoch: 41, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.3977200984954834
Epoch: 42, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.389570713043213
Epoch: 43, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.6024794578552246
Epoch: 44, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.2062690258026123
Epoch: 45, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.4001681804656982
Epoch: 46, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 313184
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.190982341766357
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.400 Vali Acc: 0.203 Test Loss: 1.400 Test Acc: 0.203
Validation loss decreased (inf --> -0.202885).  Saving model ...
Epoch: 2 cost time: 2.021543025970459
Epoch: 2, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.364 Vali Acc: 0.290 Test Loss: 1.364 Test Acc: 0.290
Validation loss decreased (-0.202885 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 1.9272210597991943
Epoch: 3, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.309 Vali Acc: 0.391 Test Loss: 1.309 Test Acc: 0.391
Validation loss decreased (-0.289841 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 2.289278984069824
Epoch: 4, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.244 Vali Acc: 0.478 Test Loss: 1.244 Test Acc: 0.478
Validation loss decreased (-0.391291 --> -0.478248).  Saving model ...
Epoch: 5 cost time: 2.0817933082580566
Epoch: 5, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.165 Vali Acc: 0.522 Test Loss: 1.165 Test Acc: 0.522
Validation loss decreased (-0.478248 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 2.3863108158111572
Epoch: 6, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.087 Vali Acc: 0.580 Test Loss: 1.087 Test Acc: 0.580
Validation loss decreased (-0.521727 --> -0.579699).  Saving model ...
Epoch: 7 cost time: 2.176325798034668
Epoch: 7, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.008 Vali Acc: 0.623 Test Loss: 1.008 Test Acc: 0.623
Validation loss decreased (-0.579699 --> -0.623178).  Saving model ...
Epoch: 8 cost time: 1.7561697959899902
Epoch: 8, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.952 Vali Acc: 0.616 Test Loss: 0.952 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7706375122070312
Epoch: 9, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.897 Vali Acc: 0.609 Test Loss: 0.897 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3398869037628174
Epoch: 10, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.862 Vali Acc: 0.638 Test Loss: 0.862 Test Acc: 0.638
Validation loss decreased (-0.623178 --> -0.637673).  Saving model ...
Epoch: 11 cost time: 2.0078177452087402
Epoch: 11, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.826 Vali Acc: 0.630 Test Loss: 0.826 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9670217037200928
Epoch: 12, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.796 Vali Acc: 0.645 Test Loss: 0.796 Test Acc: 0.645
Validation loss decreased (-0.637673 --> -0.644920).  Saving model ...
Epoch: 13 cost time: 2.3033769130706787
Epoch: 13, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.764 Vali Acc: 0.681 Test Loss: 0.764 Test Acc: 0.681
Validation loss decreased (-0.644920 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 2.0175600051879883
Epoch: 14, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.749 Vali Acc: 0.681 Test Loss: 0.749 Test Acc: 0.681
Validation loss decreased (-0.681152 --> -0.681152).  Saving model ...
Epoch: 15 cost time: 2.251544952392578
Epoch: 15, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.724 Vali Acc: 0.696 Test Loss: 0.724 Test Acc: 0.696
Validation loss decreased (-0.681152 --> -0.695645).  Saving model ...
Epoch: 16 cost time: 1.8837323188781738
Epoch: 16, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.710 Vali Acc: 0.688 Test Loss: 0.710 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.062440872192383
Epoch: 17, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.691 Vali Acc: 0.696 Test Loss: 0.691 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 2.2725536823272705
Epoch: 18, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.676 Vali Acc: 0.703 Test Loss: 0.676 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702892).  Saving model ...
Epoch: 19 cost time: 1.9183447360992432
Epoch: 19, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.670 Vali Acc: 0.710 Test Loss: 0.670 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710138).  Saving model ...
Epoch: 20 cost time: 2.113621473312378
Epoch: 20, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 21 cost time: 1.8322577476501465
Epoch: 21, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
Validation loss decreased (-0.731878 --> -0.731878).  Saving model ...
Epoch: 22 cost time: 2.2796969413757324
Epoch: 22, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775357).  Saving model ...
Epoch: 23 cost time: 2.0461721420288086
Epoch: 23, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8322687149047852
Epoch: 24, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.546 Vali Acc: 0.804 Test Loss: 0.546 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804342).  Saving model ...
Epoch: 25 cost time: 2.0913171768188477
Epoch: 25, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 26 cost time: 2.0258686542510986
Epoch: 26, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.504 Vali Acc: 0.804 Test Loss: 0.504 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.117725133895874
Epoch: 27, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.914672613143921
Epoch: 28, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 29 cost time: 1.649893045425415
Epoch: 29, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9619030952453613
Epoch: 30, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 2.239746332168579
Epoch: 31, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3911783695220947
Epoch: 32, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.209014892578125
Epoch: 33, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 2.124591112136841
Epoch: 34, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9228811264038086
Epoch: 35, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 36 cost time: 1.9468867778778076
Epoch: 36, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8950109481811523
Epoch: 37, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.3011906147003174
Epoch: 38, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 39 cost time: 1.7853343486785889
Epoch: 39, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.151116132736206
Epoch: 40, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.374 Vali Acc: 0.848 Test Loss: 0.374 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.3058125972747803
Epoch: 41, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.221975326538086
Epoch: 42, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.390 Vali Acc: 0.841 Test Loss: 0.390 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4829726219177246
Epoch: 43, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.8260815143585205
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.2133259773254395
Epoch: 45, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.17747163772583
Epoch: 46, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.399 Vali Acc: 0.841 Test Loss: 0.399 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.3110930919647217
Epoch: 47, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.0702149868011475
Epoch: 48, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 312064
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.22962498664856
Epoch: 1, Steps: 9 | Train Loss: 1.523 Vali Loss: 1.436 Vali Acc: 0.319 Test Loss: 1.436 Test Acc: 0.319
Validation loss decreased (inf --> -0.318826).  Saving model ...
Epoch: 2 cost time: 1.6566684246063232
Epoch: 2, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.393 Vali Acc: 0.304 Test Loss: 1.393 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5317060947418213
Epoch: 3, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.373 Vali Acc: 0.210 Test Loss: 1.373 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8767049312591553
Epoch: 4, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.334 Vali Acc: 0.341 Test Loss: 1.334 Test Acc: 0.341
Validation loss decreased (-0.318826 --> -0.340566).  Saving model ...
Epoch: 5 cost time: 1.9082269668579102
Epoch: 5, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.279 Vali Acc: 0.457 Test Loss: 1.279 Test Acc: 0.457
Validation loss decreased (-0.340566 --> -0.456509).  Saving model ...
Epoch: 6 cost time: 2.062302589416504
Epoch: 6, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.456509 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.8692991733551025
Epoch: 7, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.168 Vali Acc: 0.536 Test Loss: 1.168 Test Acc: 0.536
Validation loss decreased (-0.499988 --> -0.536220).  Saving model ...
Epoch: 8 cost time: 1.7828154563903809
Epoch: 8, Steps: 9 | Train Loss: 1.078 Vali Loss: 1.106 Vali Acc: 0.609 Test Loss: 1.106 Test Acc: 0.609
Validation loss decreased (-0.536220 --> -0.608685).  Saving model ...
Epoch: 9 cost time: 1.7360234260559082
Epoch: 9, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.033 Vali Acc: 0.659 Test Loss: 1.033 Test Acc: 0.659
Validation loss decreased (-0.608685 --> -0.659410).  Saving model ...
Epoch: 10 cost time: 1.6213674545288086
Epoch: 10, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.970 Vali Acc: 0.652 Test Loss: 0.970 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.971724271774292
Epoch: 11, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.914 Vali Acc: 0.667 Test Loss: 0.914 Test Acc: 0.667
Validation loss decreased (-0.659410 --> -0.666658).  Saving model ...
Epoch: 12 cost time: 2.0787410736083984
Epoch: 12, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.869 Vali Acc: 0.688 Test Loss: 0.869 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688397).  Saving model ...
Epoch: 13 cost time: 1.8913486003875732
Epoch: 13, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.852 Vali Acc: 0.674 Test Loss: 0.852 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6687841415405273
Epoch: 14, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.814 Vali Acc: 0.681 Test Loss: 0.814 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0059447288513184
Epoch: 15, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.797 Vali Acc: 0.667 Test Loss: 0.797 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.885801076889038
Epoch: 16, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.772 Vali Acc: 0.667 Test Loss: 0.772 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7784905433654785
Epoch: 17, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.754 Vali Acc: 0.710 Test Loss: 0.754 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710137).  Saving model ...
Epoch: 18 cost time: 2.011983633041382
Epoch: 18, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.721 Vali Acc: 0.681 Test Loss: 0.721 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7658905982971191
Epoch: 19, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.705 Vali Acc: 0.667 Test Loss: 0.705 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5970444679260254
Epoch: 20, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.686 Vali Acc: 0.725 Test Loss: 0.686 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 21 cost time: 1.9280526638031006
Epoch: 21, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 22 cost time: 1.5043816566467285
Epoch: 22, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.639 Vali Acc: 0.754 Test Loss: 0.639 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 23 cost time: 1.526038646697998
Epoch: 23, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.590 Vali Acc: 0.775 Test Loss: 0.590 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775356).  Saving model ...
Epoch: 24 cost time: 1.5050039291381836
Epoch: 24, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.549 Vali Acc: 0.804 Test Loss: 0.549 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 25 cost time: 1.4393806457519531
Epoch: 25, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.938560962677002
Epoch: 26, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.524 Vali Acc: 0.754 Test Loss: 0.524 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8230116367340088
Epoch: 27, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9645261764526367
Epoch: 28, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.572662115097046
Epoch: 29, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.512 Vali Acc: 0.768 Test Loss: 0.512 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.876960277557373
Epoch: 30, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.434 Vali Acc: 0.812 Test Loss: 0.434 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811590).  Saving model ...
Epoch: 31 cost time: 1.587918996810913
Epoch: 31, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.597 Vali Acc: 0.797 Test Loss: 0.597 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7704520225524902
Epoch: 32, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.481 Vali Acc: 0.804 Test Loss: 0.481 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6621348857879639
Epoch: 33, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
Validation loss decreased (-0.811590 --> -0.833329).  Saving model ...
Epoch: 34 cost time: 1.9477708339691162
Epoch: 34, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.005059003829956
Epoch: 35, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.397 Vali Acc: 0.841 Test Loss: 0.397 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 36 cost time: 1.763334035873413
Epoch: 36, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.427 Vali Acc: 0.797 Test Loss: 0.427 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1210410594940186
Epoch: 37, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 38 cost time: 1.609384536743164
Epoch: 38, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.420 Vali Acc: 0.804 Test Loss: 0.420 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.716752052307129
Epoch: 39, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.387 Vali Acc: 0.841 Test Loss: 0.387 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0625128746032715
Epoch: 40, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.102076292037964
Epoch: 41, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 42 cost time: 1.8365402221679688
Epoch: 42, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 43 cost time: 1.8040497303009033
Epoch: 43, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.1429429054260254
Epoch: 44, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0934534072875977
Epoch: 45, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.2816665172576904
Epoch: 46, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.0773234367370605
Epoch: 47, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.651719093322754
Epoch: 48, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.408 Vali Acc: 0.841 Test Loss: 0.408 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.844099521636963
Epoch: 49, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.7296881675720215
Epoch: 50, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.9591803550720215
Epoch: 51, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.9544386863708496
Epoch: 52, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 240544
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7788169384002686
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.384 Vali Acc: 0.254 Test Loss: 1.384 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 2.1019763946533203
Epoch: 2, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.336 Vali Acc: 0.290 Test Loss: 1.336 Test Acc: 0.290
Validation loss decreased (-0.253609 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 2.129279851913452
Epoch: 3, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.288 Vali Acc: 0.413 Test Loss: 1.288 Test Acc: 0.413
Validation loss decreased (-0.289842 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.6361894607543945
Epoch: 4, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.230 Vali Acc: 0.442 Test Loss: 1.230 Test Acc: 0.442
Validation loss decreased (-0.413031 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 1.942000150680542
Epoch: 5, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.178 Vali Acc: 0.478 Test Loss: 1.178 Test Acc: 0.478
Validation loss decreased (-0.442017 --> -0.478249).  Saving model ...
Epoch: 6 cost time: 1.9416232109069824
Epoch: 6, Steps: 9 | Train Loss: 1.094 Vali Loss: 1.123 Vali Acc: 0.507 Test Loss: 1.123 Test Acc: 0.507
Validation loss decreased (-0.478249 --> -0.507235).  Saving model ...
Epoch: 7 cost time: 2.1730458736419678
Epoch: 7, Steps: 9 | Train Loss: 1.018 Vali Loss: 1.069 Vali Acc: 0.543 Test Loss: 1.069 Test Acc: 0.543
Validation loss decreased (-0.507235 --> -0.543468).  Saving model ...
Epoch: 8 cost time: 1.916351318359375
Epoch: 8, Steps: 9 | Train Loss: 0.955 Vali Loss: 1.013 Vali Acc: 0.601 Test Loss: 1.013 Test Acc: 0.601
Validation loss decreased (-0.543468 --> -0.601439).  Saving model ...
Epoch: 9 cost time: 1.9492692947387695
Epoch: 9, Steps: 9 | Train Loss: 0.896 Vali Loss: 0.959 Vali Acc: 0.638 Test Loss: 0.959 Test Acc: 0.638
Validation loss decreased (-0.601439 --> -0.637672).  Saving model ...
Epoch: 10 cost time: 1.8009533882141113
Epoch: 10, Steps: 9 | Train Loss: 0.864 Vali Loss: 0.926 Vali Acc: 0.623 Test Loss: 0.926 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8726606369018555
Epoch: 11, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.878 Vali Acc: 0.623 Test Loss: 0.878 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6846721172332764
Epoch: 12, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.854 Vali Acc: 0.652 Test Loss: 0.854 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652165).  Saving model ...
Epoch: 13 cost time: 1.8624842166900635
Epoch: 13, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.817 Vali Acc: 0.659 Test Loss: 0.817 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659412).  Saving model ...
Epoch: 14 cost time: 1.660531997680664
Epoch: 14, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.789 Vali Acc: 0.688 Test Loss: 0.789 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 15 cost time: 1.8141422271728516
Epoch: 15, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.743 Vali Acc: 0.688 Test Loss: 0.743 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 16 cost time: 2.4337306022644043
Epoch: 16, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.744 Vali Acc: 0.652 Test Loss: 0.744 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0550618171691895
Epoch: 17, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.716 Vali Acc: 0.688 Test Loss: 0.716 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688399).  Saving model ...
Epoch: 18 cost time: 1.9400641918182373
Epoch: 18, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.674 Vali Acc: 0.703 Test Loss: 0.674 Test Acc: 0.703
Validation loss decreased (-0.688399 --> -0.702892).  Saving model ...
Epoch: 19 cost time: 2.2588882446289062
Epoch: 19, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.675 Vali Acc: 0.696 Test Loss: 0.675 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.321399211883545
Epoch: 20, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 21 cost time: 1.8720881938934326
Epoch: 21, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.628 Vali Acc: 0.710 Test Loss: 0.628 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2152888774871826
Epoch: 22, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.608 Vali Acc: 0.725 Test Loss: 0.608 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3825299739837646
Epoch: 23, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 24 cost time: 2.1082797050476074
Epoch: 24, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.545 Vali Acc: 0.768 Test Loss: 0.545 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 25 cost time: 1.9497408866882324
Epoch: 25, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 26 cost time: 1.7370882034301758
Epoch: 26, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.560 Vali Acc: 0.768 Test Loss: 0.560 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8120458126068115
Epoch: 27, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.782603 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 2.113042116165161
Epoch: 28, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.531 Vali Acc: 0.775 Test Loss: 0.531 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8840599060058594
Epoch: 29, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.473 Vali Acc: 0.804 Test Loss: 0.473 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6889097690582275
Epoch: 30, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.770336389541626
Epoch: 31, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.425 Vali Acc: 0.841 Test Loss: 0.425 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 32 cost time: 1.9011719226837158
Epoch: 32, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.108175754547119
Epoch: 33, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.538 Vali Acc: 0.790 Test Loss: 0.538 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.5015087127685547
Epoch: 34, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.305050849914551
Epoch: 35, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.380 Vali Acc: 0.848 Test Loss: 0.380 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 36 cost time: 2.1144726276397705
Epoch: 36, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 37 cost time: 2.422304630279541
Epoch: 37, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 38 cost time: 2.1078073978424072
Epoch: 38, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3501908779144287
Epoch: 39, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7427363395690918
Epoch: 40, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 41 cost time: 1.808619737625122
Epoch: 41, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.415 Vali Acc: 0.841 Test Loss: 0.415 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.494570732116699
Epoch: 42, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 43 cost time: 1.9811723232269287
Epoch: 43, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 44 cost time: 2.027153491973877
Epoch: 44, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9026665687561035
Epoch: 45, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.855 Test Loss: 0.345 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.370818614959717
Epoch: 46, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.121155023574829
Epoch: 47, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.1369287967681885
Epoch: 48, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7121539115905762
Epoch: 49, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.092663049697876
Epoch: 50, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.9759209156036377
Epoch: 51, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.9570879936218262
Epoch: 52, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.147808313369751
Epoch: 53, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 239424
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.707014799118042
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.334 Vali Acc: 0.341 Test Loss: 1.334 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 2.0518600940704346
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.301 Vali Acc: 0.413 Test Loss: 1.301 Test Acc: 0.413
Validation loss decreased (-0.340566 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 2.4647350311279297
Epoch: 3, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.264 Vali Acc: 0.420 Test Loss: 1.264 Test Acc: 0.420
Validation loss decreased (-0.413030 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 2.0431337356567383
Epoch: 4, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.197 Vali Acc: 0.558 Test Loss: 1.197 Test Acc: 0.558
Validation loss decreased (-0.420277 --> -0.557959).  Saving model ...
Epoch: 5 cost time: 2.166435718536377
Epoch: 5, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.128 Vali Acc: 0.601 Test Loss: 1.128 Test Acc: 0.601
Validation loss decreased (-0.557959 --> -0.601438).  Saving model ...
Epoch: 6 cost time: 1.744680643081665
Epoch: 6, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.062 Vali Acc: 0.594 Test Loss: 1.062 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.113257884979248
Epoch: 7, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.007 Vali Acc: 0.616 Test Loss: 1.007 Test Acc: 0.616
Validation loss decreased (-0.601438 --> -0.615932).  Saving model ...
Epoch: 8 cost time: 2.6781299114227295
Epoch: 8, Steps: 9 | Train Loss: 0.949 Vali Loss: 0.962 Vali Acc: 0.652 Test Loss: 0.962 Test Acc: 0.652
Validation loss decreased (-0.615932 --> -0.652164).  Saving model ...
Epoch: 9 cost time: 1.9584038257598877
Epoch: 9, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.913 Vali Acc: 0.674 Test Loss: 0.913 Test Acc: 0.674
Validation loss decreased (-0.652164 --> -0.673904).  Saving model ...
Epoch: 10 cost time: 1.8710708618164062
Epoch: 10, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.866 Vali Acc: 0.681 Test Loss: 0.866 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 11 cost time: 1.7527239322662354
Epoch: 11, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.849 Vali Acc: 0.696 Test Loss: 0.849 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 12 cost time: 1.5195846557617188
Epoch: 12, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.841 Vali Acc: 0.667 Test Loss: 0.841 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8748464584350586
Epoch: 13, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.817 Vali Acc: 0.659 Test Loss: 0.817 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4745001792907715
Epoch: 14, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.781 Vali Acc: 0.696 Test Loss: 0.781 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695644).  Saving model ...
Epoch: 15 cost time: 2.0316925048828125
Epoch: 15, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.758 Vali Acc: 0.703 Test Loss: 0.758 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 16 cost time: 2.35685396194458
Epoch: 16, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.729 Vali Acc: 0.703 Test Loss: 0.729 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 17 cost time: 1.889601707458496
Epoch: 17, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.709 Vali Acc: 0.703 Test Loss: 0.709 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 18 cost time: 2.0935122966766357
Epoch: 18, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 19 cost time: 2.096149206161499
Epoch: 19, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731878).  Saving model ...
Epoch: 20 cost time: 2.1804094314575195
Epoch: 20, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.655 Vali Acc: 0.739 Test Loss: 0.655 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739124).  Saving model ...
Epoch: 21 cost time: 1.696007490158081
Epoch: 21, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.597 Vali Acc: 0.768 Test Loss: 0.597 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768110).  Saving model ...
Epoch: 22 cost time: 2.2440755367279053
Epoch: 22, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9671900272369385
Epoch: 23, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 24 cost time: 1.726609230041504
Epoch: 24, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5592150688171387
Epoch: 25, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.526 Vali Acc: 0.797 Test Loss: 0.526 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9184491634368896
Epoch: 26, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.513 Vali Acc: 0.797 Test Loss: 0.513 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8944365978240967
Epoch: 27, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.488 Vali Acc: 0.804 Test Loss: 0.488 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 28 cost time: 2.0808167457580566
Epoch: 28, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 29 cost time: 2.057274103164673
Epoch: 29, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 1.7603278160095215
Epoch: 30, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9358165264129639
Epoch: 31, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.7488977909088135
Epoch: 32, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 33 cost time: 2.4286692142486572
Epoch: 33, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0481624603271484
Epoch: 34, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6521565914154053
Epoch: 35, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8812201023101807
Epoch: 36, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 37 cost time: 1.6201519966125488
Epoch: 37, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.352 Vali Acc: 0.855 Test Loss: 0.352 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.6493637561798096
Epoch: 38, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0320382118225098
Epoch: 39, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 2.279691696166992
Epoch: 40, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.5051522254943848
Epoch: 41, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.064239978790283
Epoch: 42, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.343 Vali Acc: 0.899 Test Loss: 0.343 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 43 cost time: 1.9691119194030762
Epoch: 43, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.833907127380371
Epoch: 44, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.349 Vali Acc: 0.855 Test Loss: 0.349 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.8013744354248047
Epoch: 45, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.386 Vali Acc: 0.891 Test Loss: 0.386 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.3883328437805176
Epoch: 46, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.2647464275360107
Epoch: 47, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 48 cost time: 1.747370719909668
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7274563312530518
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.390 Vali Acc: 0.899 Test Loss: 0.390 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.8784980773925781
Epoch: 50, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 51 cost time: 2.1822633743286133
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.263836622238159
Epoch: 52, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.013284206390381
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.899 Test Loss: 0.334 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.856119155883789
Epoch: 54, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.9520654678344727
Epoch: 55, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.7332544326782227
Epoch: 56, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.8238236904144287
Epoch: 57, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 58 cost time: 1.7325875759124756
Epoch: 58, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.1730895042419434
Epoch: 59, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.7346749305725098
Epoch: 60, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.9547924995422363
Epoch: 61, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.9887053966522217
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.6910042762756348
Epoch: 63, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.899 Test Loss: 0.394 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.640911340713501
Epoch: 64, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.899 Test Loss: 0.276 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.293046712875366
Epoch: 65, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 66 cost time: 2.3465001583099365
Epoch: 66, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.352 Vali Acc: 0.899 Test Loss: 0.352 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.1251351833343506
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.0360946655273438
Epoch: 68, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 69 cost time: 1.5483427047729492
Epoch: 69, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.22910737991333
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.654737949371338
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 2.5620381832122803
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.7040250301361084
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.8148384094238281
Epoch: 74, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.899 Test Loss: 0.233 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.8385801315307617
Epoch: 75, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.704 Vali Acc: 0.826 Test Loss: 0.704 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 2.1105382442474365
Epoch: 76, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 2.0123188495635986
Epoch: 77, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.383 Vali Acc: 0.906 Test Loss: 0.383 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.8538753986358643
Epoch: 78, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.384 Vali Acc: 0.913 Test Loss: 0.384 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 238304
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.2748637199401855
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.390 Vali Acc: 0.326 Test Loss: 1.390 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 2.008453845977783
Epoch: 2, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.361 Vali Acc: 0.391 Test Loss: 1.361 Test Acc: 0.391
Validation loss decreased (-0.326073 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.714338779449463
Epoch: 3, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.334 Vali Acc: 0.471 Test Loss: 1.334 Test Acc: 0.471
Validation loss decreased (-0.391291 --> -0.471001).  Saving model ...
Epoch: 4 cost time: 1.9156668186187744
Epoch: 4, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.301 Vali Acc: 0.493 Test Loss: 1.301 Test Acc: 0.493
Validation loss decreased (-0.471001 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 1.8504021167755127
Epoch: 5, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.265 Vali Acc: 0.529 Test Loss: 1.265 Test Acc: 0.529
Validation loss decreased (-0.492741 --> -0.528973).  Saving model ...
Epoch: 6 cost time: 1.9062039852142334
Epoch: 6, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.212 Vali Acc: 0.587 Test Loss: 1.212 Test Acc: 0.587
Validation loss decreased (-0.528973 --> -0.586944).  Saving model ...
Epoch: 7 cost time: 1.6573574542999268
Epoch: 7, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.151 Vali Acc: 0.572 Test Loss: 1.151 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.790174961090088
Epoch: 8, Steps: 9 | Train Loss: 1.088 Vali Loss: 1.093 Vali Acc: 0.558 Test Loss: 1.093 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5088810920715332
Epoch: 9, Steps: 9 | Train Loss: 0.976 Vali Loss: 1.032 Vali Acc: 0.580 Test Loss: 1.032 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0348637104034424
Epoch: 10, Steps: 9 | Train Loss: 0.892 Vali Loss: 0.973 Vali Acc: 0.667 Test Loss: 0.973 Test Acc: 0.667
Validation loss decreased (-0.586944 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 2.1633336544036865
Epoch: 11, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9704020023345947
Epoch: 12, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.886 Vali Acc: 0.696 Test Loss: 0.886 Test Acc: 0.696
Validation loss decreased (-0.666657 --> -0.695643).  Saving model ...
Epoch: 13 cost time: 2.122370958328247
Epoch: 13, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.845 Vali Acc: 0.703 Test Loss: 0.845 Test Acc: 0.703
Validation loss decreased (-0.695643 --> -0.702890).  Saving model ...
Epoch: 14 cost time: 1.7414124011993408
Epoch: 14, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.805 Vali Acc: 0.739 Test Loss: 0.805 Test Acc: 0.739
Validation loss decreased (-0.702890 --> -0.739122).  Saving model ...
Epoch: 15 cost time: 1.8756802082061768
Epoch: 15, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.778 Vali Acc: 0.717 Test Loss: 0.778 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6397407054901123
Epoch: 16, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.743 Vali Acc: 0.746 Test Loss: 0.743 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746369).  Saving model ...
Epoch: 17 cost time: 1.6054260730743408
Epoch: 17, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.737 Vali Acc: 0.710 Test Loss: 0.737 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6933166980743408
Epoch: 18, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.688 Vali Acc: 0.754 Test Loss: 0.688 Test Acc: 0.754
Validation loss decreased (-0.746369 --> -0.753616).  Saving model ...
Epoch: 19 cost time: 1.5694642066955566
Epoch: 19, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.669 Vali Acc: 0.725 Test Loss: 0.669 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8948373794555664
Epoch: 20, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6913707256317139
Epoch: 21, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782602).  Saving model ...
Epoch: 22 cost time: 1.6744532585144043
Epoch: 22, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7714619636535645
Epoch: 23, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.612 Vali Acc: 0.790 Test Loss: 0.612 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 24 cost time: 1.7895820140838623
Epoch: 24, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.611 Vali Acc: 0.739 Test Loss: 0.611 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7055268287658691
Epoch: 25, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.560 Vali Acc: 0.790 Test Loss: 0.560 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 26 cost time: 1.7585456371307373
Epoch: 26, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.857879400253296
Epoch: 27, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.544 Vali Acc: 0.790 Test Loss: 0.544 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 28 cost time: 1.7164537906646729
Epoch: 28, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 29 cost time: 1.8141758441925049
Epoch: 29, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.512 Vali Acc: 0.790 Test Loss: 0.512 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.065234899520874
Epoch: 30, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.520 Vali Acc: 0.797 Test Loss: 0.520 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.997870922088623
Epoch: 31, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.470 Vali Acc: 0.812 Test Loss: 0.470 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 32 cost time: 1.6898572444915771
Epoch: 32, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.477 Vali Acc: 0.812 Test Loss: 0.477 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9917588233947754
Epoch: 33, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.489 Vali Acc: 0.826 Test Loss: 0.489 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826082).  Saving model ...
Epoch: 34 cost time: 2.1651556491851807
Epoch: 34, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 35 cost time: 2.10441255569458
Epoch: 35, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.466 Vali Acc: 0.797 Test Loss: 0.466 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7333707809448242
Epoch: 36, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7886621952056885
Epoch: 37, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7892022132873535
Epoch: 38, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 39 cost time: 2.0567519664764404
Epoch: 39, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.923499584197998
Epoch: 40, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.408 Vali Acc: 0.841 Test Loss: 0.408 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.3349740505218506
Epoch: 41, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8609287738800049
Epoch: 42, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.931438684463501
Epoch: 43, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 44 cost time: 1.7370765209197998
Epoch: 44, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9599392414093018
Epoch: 45, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.393 Vali Acc: 0.812 Test Loss: 0.393 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9883310794830322
Epoch: 46, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7508471012115479
Epoch: 47, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.9192256927490234
Epoch: 48, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 49 cost time: 1.774390697479248
Epoch: 49, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.340 Vali Acc: 0.855 Test Loss: 0.340 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 50 cost time: 2.074953317642212
Epoch: 50, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.044107675552368
Epoch: 51, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 52 cost time: 1.772902488708496
Epoch: 52, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.346 Vali Acc: 0.862 Test Loss: 0.346 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 53 cost time: 1.9528098106384277
Epoch: 53, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.344 Vali Acc: 0.870 Test Loss: 0.344 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 54 cost time: 1.79469895362854
Epoch: 54, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.0054874420166016
Epoch: 55, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 56 cost time: 1.818042516708374
Epoch: 56, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 57 cost time: 2.2334163188934326
Epoch: 57, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.006507158279419
Epoch: 58, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.704862117767334
Epoch: 59, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.0265142917633057
Epoch: 60, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.8219802379608154
Epoch: 61, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.0417847633361816
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.353 Vali Acc: 0.862 Test Loss: 0.353 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.7320621013641357
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 64 cost time: 1.8890495300292969
Epoch: 64, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.0495331287384033
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.1939878463745117
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.1042966842651367
Epoch: 67, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.982710361480713
Epoch: 68, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.610388994216919
Epoch: 69, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 70 cost time: 1.608006238937378
Epoch: 70, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.5811371803283691
Epoch: 71, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.8674588203430176
Epoch: 72, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.5698926448822021
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.899 Test Loss: 0.297 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.6502182483673096
Epoch: 74, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.6865944862365723
Epoch: 75, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.8876309394836426
Epoch: 76, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.899080753326416
Epoch: 77, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.899 Test Loss: 0.309 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.6594600677490234
Epoch: 78, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 2.0415995121002197
Epoch: 79, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 237184
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9031951427459717
Epoch: 1, Steps: 9 | Train Loss: 1.490 Vali Loss: 1.285 Vali Acc: 0.529 Test Loss: 1.285 Test Acc: 0.529
Validation loss decreased (inf --> -0.528973).  Saving model ...
Epoch: 2 cost time: 1.9408152103424072
Epoch: 2, Steps: 9 | Train Loss: 1.239 Vali Loss: 1.090 Vali Acc: 0.449 Test Loss: 1.090 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9546785354614258
Epoch: 3, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.898 Vali Acc: 0.609 Test Loss: 0.898 Test Acc: 0.609
Validation loss decreased (-0.528973 --> -0.608687).  Saving model ...
Epoch: 4 cost time: 2.1862237453460693
Epoch: 4, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.694 Vali Acc: 0.732 Test Loss: 0.694 Test Acc: 0.732
Validation loss decreased (-0.608687 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 1.556570053100586
Epoch: 5, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.639 Vali Acc: 0.725 Test Loss: 0.639 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6525654792785645
Epoch: 6, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739123).  Saving model ...
Epoch: 7 cost time: 1.8680152893066406
Epoch: 7, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.726 Vali Acc: 0.681 Test Loss: 0.726 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8577971458435059
Epoch: 8, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.617 Vali Acc: 0.804 Test Loss: 0.617 Test Acc: 0.804
Validation loss decreased (-0.739123 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 1.8763902187347412
Epoch: 9, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8003034591674805
Epoch: 10, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.841 Vali Acc: 0.768 Test Loss: 0.841 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.141453742980957
Epoch: 11, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.496 Vali Acc: 0.833 Test Loss: 0.496 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.9912047386169434
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.587 Vali Acc: 0.783 Test Loss: 0.587 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1394455432891846
Epoch: 13, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.078619956970215
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 1.6853911876678467
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
Validation loss decreased (-0.840574 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 1.8573787212371826
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8278090953826904
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.848 Test Loss: 0.550 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.787337064743042
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.019615650177002
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3145287036895752
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4963164329528809
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4446628093719482
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8189222812652588
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8762273788452148
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4534554481506348
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 11147316
model size : 47.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7738242149353027
Epoch: 1, Steps: 9 | Train Loss: 1.534 Vali Loss: 1.531 Vali Acc: 0.304 Test Loss: 1.531 Test Acc: 0.304
Validation loss decreased (inf --> -0.304333).  Saving model ...
Epoch: 2 cost time: 1.957289218902588
Epoch: 2, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.328 Vali Acc: 0.457 Test Loss: 1.328 Test Acc: 0.457
Validation loss decreased (-0.304333 --> -0.456508).  Saving model ...
Epoch: 3 cost time: 1.7482187747955322
Epoch: 3, Steps: 9 | Train Loss: 0.955 Vali Loss: 0.963 Vali Acc: 0.500 Test Loss: 0.963 Test Acc: 0.500
Validation loss decreased (-0.456508 --> -0.499990).  Saving model ...
Epoch: 4 cost time: 1.645519733428955
Epoch: 4, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.737 Vali Acc: 0.703 Test Loss: 0.737 Test Acc: 0.703
Validation loss decreased (-0.499990 --> -0.702891).  Saving model ...
Epoch: 5 cost time: 2.1408748626708984
Epoch: 5, Steps: 9 | Train Loss: 0.448 Vali Loss: 1.042 Vali Acc: 0.652 Test Loss: 1.042 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9659037590026855
Epoch: 6, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.816 Vali Acc: 0.616 Test Loss: 0.816 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4738504886627197
Epoch: 7, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 8 cost time: 1.521956205368042
Epoch: 8, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.730 Vali Acc: 0.739 Test Loss: 0.730 Test Acc: 0.739
Validation loss decreased (-0.717385 --> -0.739123).  Saving model ...
Epoch: 9 cost time: 1.818352460861206
Epoch: 9, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.755 Vali Acc: 0.732 Test Loss: 0.755 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0005178451538086
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.695 Vali Acc: 0.790 Test Loss: 0.695 Test Acc: 0.790
Validation loss decreased (-0.739123 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 1.647418737411499
Epoch: 11, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.699 Vali Acc: 0.746 Test Loss: 0.699 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.092974901199341
Epoch: 12, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.466348648071289
Epoch: 13, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7679686546325684
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.541 Vali Acc: 0.754 Test Loss: 0.541 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.705798864364624
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 16 cost time: 1.5849223136901855
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840573).  Saving model ...
Epoch: 17 cost time: 1.6568577289581299
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0356438159942627
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.624 Vali Acc: 0.862 Test Loss: 0.624 Test Acc: 0.862
Validation loss decreased (-0.840573 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 1.9758760929107666
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7837717533111572
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 21 cost time: 2.2418620586395264
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 22 cost time: 1.6475839614868164
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1965956687927246
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0702669620513916
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 25 cost time: 1.483236312866211
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.870 Test Loss: 0.554 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7471351623535156
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.862 Test Loss: 0.575 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.43168306350708
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.870 Test Loss: 0.563 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9340217113494873
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.877 Test Loss: 0.585 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 29 cost time: 2.1415483951568604
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.870 Test Loss: 0.571 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.231031656265259
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.862 Test Loss: 0.582 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5820927619934082
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6504969596862793
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6821346282958984
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.870 Test Loss: 0.581 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7749247550964355
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.877 Test Loss: 0.574 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 35 cost time: 2.124190092086792
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.877 Test Loss: 0.585 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.745173692703247
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.877 Test Loss: 0.607 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9058301448822021
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.877 Test Loss: 0.601 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.098137855529785
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.877 Test Loss: 0.575 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8709652423858643
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.877 Test Loss: 0.563 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 40 cost time: 2.208517551422119
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.877 Test Loss: 0.581 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7910325527191162
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.877 Test Loss: 0.587 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9554908275604248
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.877 Test Loss: 0.599 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.284832715988159
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.877 Test Loss: 0.601 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.2218475341796875
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.870 Test Loss: 0.608 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.665252685546875
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.877 Test Loss: 0.594 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.6465840339660645
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.877 Test Loss: 0.582 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7478277683258057
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.877 Test Loss: 0.586 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.0617196559906006
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.877 Test Loss: 0.595 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.061976671218872
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 11139124
model size : 47.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.243050813674927
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.400 Vali Acc: 0.399 Test Loss: 1.400 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 2.034754753112793
Epoch: 2, Steps: 9 | Train Loss: 1.264 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.398537 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 2.553373098373413
Epoch: 3, Steps: 9 | Train Loss: 0.872 Vali Loss: 0.940 Vali Acc: 0.478 Test Loss: 0.940 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7611503601074219
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.723 Vali Acc: 0.688 Test Loss: 0.723 Test Acc: 0.688
Validation loss decreased (-0.499989 --> -0.688399).  Saving model ...
Epoch: 5 cost time: 1.73189115524292
Epoch: 5, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.657 Vali Acc: 0.710 Test Loss: 0.657 Test Acc: 0.710
Validation loss decreased (-0.688399 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.7843408584594727
Epoch: 6, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 7 cost time: 1.8580238819122314
Epoch: 7, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.660 Vali Acc: 0.746 Test Loss: 0.660 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.73280930519104
Epoch: 8, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7013425827026367
Epoch: 9, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 10 cost time: 1.620628833770752
Epoch: 10, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9701387882232666
Epoch: 11, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.543 Vali Acc: 0.775 Test Loss: 0.543 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 1.7124805450439453
Epoch: 12, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
Validation loss decreased (-0.775357 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.8957910537719727
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.6999905109405518
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.931 Vali Acc: 0.804 Test Loss: 0.931 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7829465866088867
Epoch: 15, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.198 Vali Acc: 0.696 Test Loss: 1.198 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7910807132720947
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.438 Vali Acc: 0.819 Test Loss: 0.438 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.089812755584717
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.785 Vali Acc: 0.812 Test Loss: 0.785 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.723024845123291
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0071141719818115
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855067).  Saving model ...
Epoch: 20 cost time: 1.752366065979004
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.786402940750122
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.826 Test Loss: 0.744 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.664630651473999
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9038586616516113
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.848 Test Loss: 0.635 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6793909072875977
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.855 Test Loss: 0.590 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4986815452575684
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7388286590576172
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.855 Test Loss: 0.579 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5598537921905518
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.1777520179748535
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1315929889678955
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 11130932
model size : 47.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6533336639404297
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.334 Vali Acc: 0.341 Test Loss: 1.334 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.5852618217468262
Epoch: 2, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
Validation loss decreased (-0.340566 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 2.1848323345184326
Epoch: 3, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.837 Vali Acc: 0.688 Test Loss: 0.837 Test Acc: 0.688
Validation loss decreased (-0.499989 --> -0.688397).  Saving model ...
Epoch: 4 cost time: 1.8992440700531006
Epoch: 4, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.770 Vali Acc: 0.703 Test Loss: 0.770 Test Acc: 0.703
Validation loss decreased (-0.688397 --> -0.702891).  Saving model ...
Epoch: 5 cost time: 1.6800799369812012
Epoch: 5, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.609 Vali Acc: 0.754 Test Loss: 0.609 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753617).  Saving model ...
Epoch: 6 cost time: 1.7190771102905273
Epoch: 6, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.644 Vali Acc: 0.746 Test Loss: 0.644 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9580872058868408
Epoch: 7, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 2.016862630844116
Epoch: 8, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.905 Vali Acc: 0.703 Test Loss: 0.905 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0182578563690186
Epoch: 9, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.638 Vali Acc: 0.739 Test Loss: 0.638 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7395131587982178
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
Validation loss decreased (-0.760863 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 1.4591894149780273
Epoch: 11, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.700 Vali Acc: 0.732 Test Loss: 0.700 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.838454246520996
Epoch: 12, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.652 Vali Acc: 0.797 Test Loss: 0.652 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.663682222366333
Epoch: 13, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.967641830444336
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0543267726898193
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.676 Vali Acc: 0.841 Test Loss: 0.676 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7090201377868652
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9148368835449219
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.848 Test Loss: 0.679 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6939198970794678
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.855 Test Loss: 0.620 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7877635955810547
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.848 Test Loss: 0.662 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.471639633178711
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.855 Test Loss: 0.637 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 11122740
model size : 47.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6851847171783447
Epoch: 1, Steps: 9 | Train Loss: 1.506 Vali Loss: 1.540 Vali Acc: 0.268 Test Loss: 1.540 Test Acc: 0.268
Validation loss decreased (inf --> -0.268101).  Saving model ...
Epoch: 2 cost time: 2.009573221206665
Epoch: 2, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.199 Vali Acc: 0.406 Test Loss: 1.199 Test Acc: 0.406
Validation loss decreased (-0.268101 --> -0.405785).  Saving model ...
Epoch: 3 cost time: 1.7023475170135498
Epoch: 3, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
Validation loss decreased (-0.405785 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.8393776416778564
Epoch: 4, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.854 Vali Acc: 0.565 Test Loss: 0.854 Test Acc: 0.565
Validation loss decreased (-0.514482 --> -0.565209).  Saving model ...
Epoch: 5 cost time: 1.5651946067810059
Epoch: 5, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.683 Vali Acc: 0.688 Test Loss: 0.683 Test Acc: 0.688
Validation loss decreased (-0.565209 --> -0.688399).  Saving model ...
Epoch: 6 cost time: 1.6586029529571533
Epoch: 6, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.808 Vali Acc: 0.609 Test Loss: 0.808 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.552577257156372
Epoch: 7, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.688399 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.5770325660705566
Epoch: 8, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.759 Vali Acc: 0.725 Test Loss: 0.759 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4618370532989502
Epoch: 9, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.520 Vali Acc: 0.797 Test Loss: 0.520 Test Acc: 0.797
Validation loss decreased (-0.746371 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.4376842975616455
Epoch: 10, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.583 Vali Acc: 0.754 Test Loss: 0.583 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4834413528442383
Epoch: 11, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 1.4779143333435059
Epoch: 12, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5304760932922363
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5674629211425781
Epoch: 14, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6597135066986084
Epoch: 15, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.605 Vali Acc: 0.826 Test Loss: 0.605 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6757252216339111
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 1.679086446762085
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6371252536773682
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.686983346939087
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6171531677246094
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.5098741054534912
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4551737308502197
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8600594997406006
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.636298418045044
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.642632007598877
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.395024299621582
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.379720687866211
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.980705976486206
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5617592334747314
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7515168190002441
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 9308724
model size : 40.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.538480520248413
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.7736690044403076
Epoch: 2, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.083 Vali Acc: 0.572 Test Loss: 1.083 Test Acc: 0.572
Validation loss decreased (-0.333320 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 1.6370131969451904
Epoch: 3, Steps: 9 | Train Loss: 0.957 Vali Loss: 1.038 Vali Acc: 0.522 Test Loss: 1.038 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8229072093963623
Epoch: 4, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.879 Vali Acc: 0.594 Test Loss: 0.879 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594194).  Saving model ...
Epoch: 5 cost time: 1.813844919204712
Epoch: 5, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.695 Vali Acc: 0.710 Test Loss: 0.695 Test Acc: 0.710
Validation loss decreased (-0.594194 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 2.4805209636688232
Epoch: 6, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.647 Vali Acc: 0.710 Test Loss: 0.647 Test Acc: 0.710
Validation loss decreased (-0.710138 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.8391194343566895
Epoch: 7, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.710 Vali Acc: 0.696 Test Loss: 0.710 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.748427152633667
Epoch: 8, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.538 Vali Acc: 0.797 Test Loss: 0.538 Test Acc: 0.797
Validation loss decreased (-0.710138 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 1.8103225231170654
Epoch: 9, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.563 Vali Acc: 0.790 Test Loss: 0.563 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4687023162841797
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.457 Vali Acc: 0.819 Test Loss: 0.457 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 1.685232162475586
Epoch: 11, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.728 Vali Acc: 0.645 Test Loss: 0.728 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8977148532867432
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 1.5728681087493896
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.792 Vali Acc: 0.797 Test Loss: 0.792 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7503187656402588
Epoch: 14, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0519180297851562
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.756068468093872
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.5453979969024658
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 1.988710880279541
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7061190605163574
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9135963916778564
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6670072078704834
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.571746587753296
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.862 Test Loss: 0.508 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7489066123962402
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7753193378448486
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8797755241394043
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8922877311706543
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7249295711517334
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.848 Test Loss: 0.538 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 9300532
model size : 40.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.164682388305664
Epoch: 1, Steps: 9 | Train Loss: 1.431 Vali Loss: 1.285 Vali Acc: 0.449 Test Loss: 1.285 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 1.6578049659729004
Epoch: 2, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.123 Vali Acc: 0.442 Test Loss: 1.123 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9041266441345215
Epoch: 3, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.908 Vali Acc: 0.594 Test Loss: 0.908 Test Acc: 0.594
Validation loss decreased (-0.449263 --> -0.594194).  Saving model ...
Epoch: 4 cost time: 1.4266204833984375
Epoch: 4, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.846 Vali Acc: 0.652 Test Loss: 0.846 Test Acc: 0.652
Validation loss decreased (-0.594194 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 1.5650136470794678
Epoch: 5, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.636 Vali Acc: 0.710 Test Loss: 0.636 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710139).  Saving model ...
Epoch: 6 cost time: 1.9020676612854004
Epoch: 6, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.590 Vali Acc: 0.768 Test Loss: 0.590 Test Acc: 0.768
Validation loss decreased (-0.710139 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 1.7700891494750977
Epoch: 7, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7134718894958496
Epoch: 8, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.626 Vali Acc: 0.703 Test Loss: 0.626 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.887511968612671
Epoch: 9, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.638 Vali Acc: 0.739 Test Loss: 0.638 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9788193702697754
Epoch: 10, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
Validation loss decreased (-0.768110 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 2.2292728424072266
Epoch: 11, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.606 Vali Acc: 0.797 Test Loss: 0.606 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.475557804107666
Epoch: 12, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.541 Vali Acc: 0.804 Test Loss: 0.541 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8535864353179932
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 1.8857536315917969
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 2.3870749473571777
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.736 Vali Acc: 0.812 Test Loss: 0.736 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1477057933807373
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6191072463989258
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 2.0679712295532227
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9943625926971436
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.855 Test Loss: 0.622 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1874592304229736
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884054).  Saving model ...
Epoch: 21 cost time: 1.7940020561218262
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7112464904785156
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0198917388916016
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3784739971160889
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 1.9304044246673584
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1020145416259766
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7896275520324707
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8148984909057617
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.884 Test Loss: 0.442 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2238495349884033
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9154067039489746
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8619744777679443
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7611525058746338
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6410460472106934
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0305724143981934
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 9292340
model size : 40.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8899502754211426
Epoch: 1, Steps: 9 | Train Loss: 1.543 Vali Loss: 1.409 Vali Acc: 0.275 Test Loss: 1.409 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 2.044163942337036
Epoch: 2, Steps: 9 | Train Loss: 1.253 Vali Loss: 1.116 Vali Acc: 0.428 Test Loss: 1.116 Test Acc: 0.428
Validation loss decreased (-0.275348 --> -0.427525).  Saving model ...
Epoch: 3 cost time: 1.450242280960083
Epoch: 3, Steps: 9 | Train Loss: 0.919 Vali Loss: 0.906 Vali Acc: 0.587 Test Loss: 0.906 Test Acc: 0.587
Validation loss decreased (-0.427525 --> -0.586947).  Saving model ...
Epoch: 4 cost time: 1.6375365257263184
Epoch: 4, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.836 Vali Acc: 0.659 Test Loss: 0.836 Test Acc: 0.659
Validation loss decreased (-0.586947 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 1.8974888324737549
Epoch: 5, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.717 Vali Acc: 0.696 Test Loss: 0.717 Test Acc: 0.696
Validation loss decreased (-0.659412 --> -0.695645).  Saving model ...
Epoch: 6 cost time: 2.0208656787872314
Epoch: 6, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.747 Vali Acc: 0.652 Test Loss: 0.747 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6916236877441406
Epoch: 7, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.851 Vali Acc: 0.645 Test Loss: 0.851 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0789902210235596
Epoch: 8, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.737 Vali Acc: 0.725 Test Loss: 0.737 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724630).  Saving model ...
Epoch: 9 cost time: 1.8422834873199463
Epoch: 9, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.724630 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 2.090547800064087
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7639615535736084
Epoch: 11, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.616 Vali Acc: 0.754 Test Loss: 0.616 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7313008308410645
Epoch: 12, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1123881340026855
Epoch: 13, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.895681381225586
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847820).  Saving model ...
Epoch: 15 cost time: 1.897148847579956
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 2.262293577194214
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8559520244598389
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.836052417755127
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 1.6341290473937988
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 20 cost time: 1.8418474197387695
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.855 Test Loss: 0.597 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7821838855743408
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.654512882232666
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.855 Test Loss: 0.590 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.054278612136841
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.855 Test Loss: 0.617 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0246236324310303
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.855 Test Loss: 0.616 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6093530654907227
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.855 Test Loss: 0.610 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7362539768218994
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5020990371704102
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.848 Test Loss: 0.638 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5663788318634033
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.2719576358795166
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.855 Test Loss: 0.627 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 9284148
model size : 40.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.763456106185913
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.260 Vali Acc: 0.399 Test Loss: 1.260 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 1.5191709995269775
Epoch: 2, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.090 Vali Acc: 0.442 Test Loss: 1.090 Test Acc: 0.442
Validation loss decreased (-0.398538 --> -0.442018).  Saving model ...
Epoch: 3 cost time: 1.668588399887085
Epoch: 3, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.969 Vali Acc: 0.551 Test Loss: 0.969 Test Acc: 0.551
Validation loss decreased (-0.442018 --> -0.550715).  Saving model ...
Epoch: 4 cost time: 1.391913652420044
Epoch: 4, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.713 Vali Acc: 0.725 Test Loss: 0.713 Test Acc: 0.725
Validation loss decreased (-0.550715 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 1.4724724292755127
Epoch: 5, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.606 Vali Acc: 0.739 Test Loss: 0.606 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 1.599822998046875
Epoch: 6, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.617 Vali Acc: 0.725 Test Loss: 0.617 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.719425916671753
Epoch: 7, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.8220512866973877
Epoch: 8, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.671410083770752
Epoch: 9, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.714 Vali Acc: 0.688 Test Loss: 0.714 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6760921478271484
Epoch: 10, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
Validation loss decreased (-0.760864 --> -0.804343).  Saving model ...
Epoch: 11 cost time: 1.8600807189941406
Epoch: 11, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3558108806610107
Epoch: 12, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 1.3950912952423096
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.659 Vali Acc: 0.790 Test Loss: 0.659 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8367056846618652
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5694580078125
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6760103702545166
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5476891994476318
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5479822158813477
Epoch: 18, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.620 Vali Acc: 0.812 Test Loss: 0.620 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6162135601043701
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6086745262145996
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 1.502678632736206
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.527165412902832
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5787115097045898
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 1.6149482727050781
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4991364479064941
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.848 Test Loss: 0.538 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5098931789398193
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7419564723968506
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.6404905319213867
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.659268856048584
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4298856258392334
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4296386241912842
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 1.5788302421569824
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4431984424591064
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.530799388885498
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4538168907165527
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4945957660675049
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5969221591949463
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3538792133331299
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 39 cost time: 1.2324507236480713
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.599771499633789
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 41 cost time: 1.5181915760040283
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5763397216796875
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.778613567352295
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6038713455200195
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5215702056884766
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.569521188735962
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.0108108520507812
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5543434619903564
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.019561529159546
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 50 cost time: 1.848832130432129
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8107194900512695
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.6225032806396484
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.9258852005004883
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.8288977146148682
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.9273731708526611
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.8307719230651855
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.4961762428283691
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.7075154781341553
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.7199523448944092
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 8389428
model size : 37.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.404189109802246
Epoch: 1, Steps: 9 | Train Loss: 1.476 Vali Loss: 1.432 Vali Acc: 0.283 Test Loss: 1.432 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 1.6257400512695312
Epoch: 2, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.206 Vali Acc: 0.362 Test Loss: 1.206 Test Acc: 0.362
Validation loss decreased (-0.282594 --> -0.362307).  Saving model ...
Epoch: 3 cost time: 1.5393590927124023
Epoch: 3, Steps: 9 | Train Loss: 1.022 Vali Loss: 0.983 Vali Acc: 0.529 Test Loss: 0.983 Test Acc: 0.529
Validation loss decreased (-0.362307 --> -0.528976).  Saving model ...
Epoch: 4 cost time: 1.7156257629394531
Epoch: 4, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.837 Vali Acc: 0.594 Test Loss: 0.837 Test Acc: 0.594
Validation loss decreased (-0.528976 --> -0.594195).  Saving model ...
Epoch: 5 cost time: 1.6597731113433838
Epoch: 5, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
Validation loss decreased (-0.594195 --> -0.746369).  Saving model ...
Epoch: 6 cost time: 1.8993022441864014
Epoch: 6, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6655426025390625
Epoch: 7, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.610 Vali Acc: 0.739 Test Loss: 0.610 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.730147361755371
Epoch: 8, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
Validation loss decreased (-0.746369 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 1.9482753276824951
Epoch: 9, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.563 Vali Acc: 0.754 Test Loss: 0.563 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6480114459991455
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5889160633087158
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.487 Vali Acc: 0.804 Test Loss: 0.487 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5136544704437256
Epoch: 12, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.617 Vali Acc: 0.790 Test Loss: 0.617 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5916261672973633
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7310969829559326
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 1.896920919418335
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 1.4530861377716064
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6293163299560547
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6817495822906494
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5494763851165771
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0564749240875244
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 1.6967720985412598
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4508318901062012
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.848 Test Loss: 0.535 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6612193584442139
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 24 cost time: 1.5813567638397217
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.909005880355835
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.862 Test Loss: 0.513 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8793153762817383
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6238172054290771
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.855 Test Loss: 0.540 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9473316669464111
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6903903484344482
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9709889888763428
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.862 Test Loss: 0.517 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6524722576141357
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.862 Test Loss: 0.518 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3966500759124756
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6691522598266602
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.862 Test Loss: 0.544 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 8381236
model size : 37.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.255918979644775
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.382 Vali Acc: 0.362 Test Loss: 1.382 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.8368842601776123
Epoch: 2, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.083 Vali Acc: 0.572 Test Loss: 1.083 Test Acc: 0.572
Validation loss decreased (-0.362305 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 1.6329150199890137
Epoch: 3, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.936 Vali Acc: 0.536 Test Loss: 0.936 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4504530429840088
Epoch: 4, Steps: 9 | Train Loss: 0.768 Vali Loss: 0.933 Vali Acc: 0.638 Test Loss: 0.933 Test Acc: 0.638
Validation loss decreased (-0.572453 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 1.5287458896636963
Epoch: 5, Steps: 9 | Train Loss: 0.615 Vali Loss: 0.885 Vali Acc: 0.543 Test Loss: 0.885 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5068278312683105
Epoch: 6, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.747 Vali Acc: 0.725 Test Loss: 0.747 Test Acc: 0.725
Validation loss decreased (-0.637672 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.705338716506958
Epoch: 7, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.621 Vali Acc: 0.754 Test Loss: 0.621 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 1.8277757167816162
Epoch: 8, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.649 Vali Acc: 0.710 Test Loss: 0.649 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6510822772979736
Epoch: 9, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.588 Vali Acc: 0.790 Test Loss: 0.588 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.6632325649261475
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.615 Vali Acc: 0.768 Test Loss: 0.615 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.541841983795166
Epoch: 11, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.940 Vali Acc: 0.783 Test Loss: 0.940 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4128422737121582
Epoch: 12, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.551 Vali Acc: 0.797 Test Loss: 0.551 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.7642526626586914
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.605 Vali Acc: 0.768 Test Loss: 0.605 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6235113143920898
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.626 Vali Acc: 0.804 Test Loss: 0.626 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 1.5319159030914307
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.5774891376495361
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8197529315948486
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.855 Test Loss: 0.619 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855066).  Saving model ...
Epoch: 18 cost time: 1.51131272315979
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.855 Test Loss: 0.580 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 1.9300215244293213
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.528536081314087
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 21 cost time: 1.6639642715454102
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.855 Test Loss: 0.538 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 22 cost time: 1.4482629299163818
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 23 cost time: 1.4698963165283203
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.855 Test Loss: 0.530 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 24 cost time: 1.561333179473877
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 1.5665369033813477
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5922014713287354
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8136358261108398
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.723435640335083
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.862 Test Loss: 0.533 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5126049518585205
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4500806331634521
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8230397701263428
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.862 Test Loss: 0.546 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.87558913230896
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.511369228363037
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.862 Test Loss: 0.552 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4706687927246094
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 8373044
model size : 36.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.907541275024414
Epoch: 1, Steps: 9 | Train Loss: 1.538 Vali Loss: 1.449 Vali Acc: 0.283 Test Loss: 1.449 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 1.6460297107696533
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.186 Vali Acc: 0.471 Test Loss: 1.186 Test Acc: 0.471
Validation loss decreased (-0.282594 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.8177440166473389
Epoch: 3, Steps: 9 | Train Loss: 1.054 Vali Loss: 0.969 Vali Acc: 0.652 Test Loss: 0.969 Test Acc: 0.652
Validation loss decreased (-0.471003 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 1.7930381298065186
Epoch: 4, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.801 Vali Acc: 0.696 Test Loss: 0.801 Test Acc: 0.696
Validation loss decreased (-0.652164 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 1.6868336200714111
Epoch: 5, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.822 Vali Acc: 0.710 Test Loss: 0.822 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 1.5237808227539062
Epoch: 6, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.746 Vali Acc: 0.725 Test Loss: 0.746 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.829545021057129
Epoch: 7, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.642 Vali Acc: 0.732 Test Loss: 0.642 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 1.824923038482666
Epoch: 8, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 1.8642752170562744
Epoch: 9, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 2.020366907119751
Epoch: 10, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.758 Vali Acc: 0.746 Test Loss: 0.758 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5910813808441162
Epoch: 11, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.628 Vali Acc: 0.804 Test Loss: 0.628 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.5967495441436768
Epoch: 12, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 2.3499860763549805
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
Validation loss decreased (-0.804342 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 1.7188403606414795
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8888664245605469
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.750 Vali Acc: 0.812 Test Loss: 0.750 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6593601703643799
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5678446292877197
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7540671825408936
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.841 Test Loss: 0.674 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3652052879333496
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.819 Test Loss: 0.622 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7226190567016602
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.819 Test Loss: 0.620 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7416329383850098
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.130312442779541
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.841 Test Loss: 0.633 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6120634078979492
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 8364852
model size : 36.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.903318166732788
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.401 Vali Acc: 0.283 Test Loss: 1.401 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.4010696411132812
Epoch: 2, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.217 Vali Acc: 0.377 Test Loss: 1.217 Test Acc: 0.377
Validation loss decreased (-0.282595 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 1.597496509552002
Epoch: 3, Steps: 9 | Train Loss: 0.990 Vali Loss: 1.254 Vali Acc: 0.435 Test Loss: 1.254 Test Acc: 0.435
Validation loss decreased (-0.376799 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 1.648144245147705
Epoch: 4, Steps: 9 | Train Loss: 0.990 Vali Loss: 0.942 Vali Acc: 0.551 Test Loss: 0.942 Test Acc: 0.551
Validation loss decreased (-0.434770 --> -0.550715).  Saving model ...
Epoch: 5 cost time: 1.7205486297607422
Epoch: 5, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.680 Vali Acc: 0.710 Test Loss: 0.680 Test Acc: 0.710
Validation loss decreased (-0.550715 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.6678714752197266
Epoch: 6, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.727 Vali Acc: 0.703 Test Loss: 0.727 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9925382137298584
Epoch: 7, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.805 Vali Acc: 0.681 Test Loss: 0.805 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8041305541992188
Epoch: 8, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
Validation loss decreased (-0.710138 --> -0.746371).  Saving model ...
Epoch: 9 cost time: 1.609933614730835
Epoch: 9, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.617 Vali Acc: 0.754 Test Loss: 0.617 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 1.4646658897399902
Epoch: 10, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.596 Vali Acc: 0.739 Test Loss: 0.596 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8996131420135498
Epoch: 11, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.928680658340454
Epoch: 12, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 2.006542444229126
Epoch: 13, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 2.021575450897217
Epoch: 14, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 1.8456089496612549
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.6254682540893555
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 1.5889251232147217
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7126784324645996
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.941575527191162
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.7526109218597412
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 1.6633796691894531
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5456175804138184
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 23 cost time: 1.7831084728240967
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 1.656811237335205
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0782063007354736
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.762373924255371
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5159502029418945
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 28 cost time: 1.5456061363220215
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6914427280426025
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.865091323852539
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.891 Test Loss: 0.393 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5735523700714111
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6618874073028564
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5890722274780273
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.877 Test Loss: 0.402 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6276464462280273
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.626375675201416
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8087785243988037
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7808396816253662
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 7929780
model size : 35.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7294113636016846
Epoch: 1, Steps: 9 | Train Loss: 1.545 Vali Loss: 1.349 Vali Acc: 0.348 Test Loss: 1.349 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.5899357795715332
Epoch: 2, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.160 Vali Acc: 0.543 Test Loss: 1.160 Test Acc: 0.543
Validation loss decreased (-0.347813 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 1.5962438583374023
Epoch: 3, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.062 Vali Acc: 0.399 Test Loss: 1.062 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7698872089385986
Epoch: 4, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.747 Vali Acc: 0.703 Test Loss: 0.747 Test Acc: 0.703
Validation loss decreased (-0.543467 --> -0.702891).  Saving model ...
Epoch: 5 cost time: 1.715085744857788
Epoch: 5, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.613 Vali Acc: 0.739 Test Loss: 0.613 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 1.6967318058013916
Epoch: 6, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 7 cost time: 1.5061912536621094
Epoch: 7, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 2.0295698642730713
Epoch: 8, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.555 Vali Acc: 0.754 Test Loss: 0.555 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.855994701385498
Epoch: 9, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.6794648170471191
Epoch: 10, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 1.4835357666015625
Epoch: 11, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.3889985084533691
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 1.564035177230835
Epoch: 13, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.7264349460601807
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.860 Vali Acc: 0.797 Test Loss: 0.860 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5201992988586426
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.719 Vali Acc: 0.804 Test Loss: 0.719 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7130095958709717
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.782 Vali Acc: 0.754 Test Loss: 0.782 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4440665245056152
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.835 Vali Acc: 0.819 Test Loss: 0.835 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.673520565032959
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9831020832061768
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.528 Vali Acc: 0.877 Test Loss: 0.528 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876806).  Saving model ...
Epoch: 20 cost time: 1.433107614517212
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.217193841934204
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.525266170501709
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.862 Test Loss: 0.547 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4705424308776855
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5573289394378662
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5090456008911133
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5538311004638672
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7522015571594238
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7487757205963135
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6481256484985352
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 7921588
model size : 35.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.892552375793457
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.335 Vali Acc: 0.268 Test Loss: 1.335 Test Acc: 0.268
Validation loss decreased (inf --> -0.268103).  Saving model ...
Epoch: 2 cost time: 1.821162223815918
Epoch: 2, Steps: 9 | Train Loss: 1.184 Vali Loss: 1.120 Vali Acc: 0.471 Test Loss: 1.120 Test Acc: 0.471
Validation loss decreased (-0.268103 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.4680838584899902
Epoch: 3, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.977 Vali Acc: 0.587 Test Loss: 0.977 Test Acc: 0.587
Validation loss decreased (-0.471003 --> -0.586947).  Saving model ...
Epoch: 4 cost time: 2.0405256748199463
Epoch: 4, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.944 Vali Acc: 0.457 Test Loss: 0.944 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.591245412826538
Epoch: 5, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.774 Vali Acc: 0.681 Test Loss: 0.774 Test Acc: 0.681
Validation loss decreased (-0.586947 --> -0.681152).  Saving model ...
Epoch: 6 cost time: 1.6586456298828125
Epoch: 6, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.706 Vali Acc: 0.710 Test Loss: 0.706 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.6496107578277588
Epoch: 7, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.666 Vali Acc: 0.652 Test Loss: 0.666 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.429245948791504
Epoch: 8, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.587 Vali Acc: 0.754 Test Loss: 0.587 Test Acc: 0.754
Validation loss decreased (-0.710138 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.6785838603973389
Epoch: 9, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.573 Vali Acc: 0.790 Test Loss: 0.573 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.7944276332855225
Epoch: 10, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.567 Vali Acc: 0.761 Test Loss: 0.567 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8548448085784912
Epoch: 11, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8344371318817139
Epoch: 12, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
Validation loss decreased (-0.789849 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 1.748422622680664
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.646939754486084
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.670 Vali Acc: 0.797 Test Loss: 0.670 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.523082971572876
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6652295589447021
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.737 Vali Acc: 0.804 Test Loss: 0.737 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5546741485595703
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 18 cost time: 1.7095530033111572
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 1.4759504795074463
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.384 Vali Acc: 0.891 Test Loss: 0.384 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 1.7463412284851074
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5668325424194336
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8163607120513916
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.051790714263916
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6223247051239014
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6540992259979248
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.434361457824707
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0177063941955566
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6193854808807373
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4356961250305176
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 7913396
model size : 35.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7343196868896484
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.326 Vali Acc: 0.326 Test Loss: 1.326 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.4333717823028564
Epoch: 2, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.101 Vali Acc: 0.623 Test Loss: 1.101 Test Acc: 0.623
Validation loss decreased (-0.326074 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 1.4215474128723145
Epoch: 3, Steps: 9 | Train Loss: 1.014 Vali Loss: 0.935 Vali Acc: 0.572 Test Loss: 0.935 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4396188259124756
Epoch: 4, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.736 Vali Acc: 0.710 Test Loss: 0.736 Test Acc: 0.710
Validation loss decreased (-0.623177 --> -0.710138).  Saving model ...
Epoch: 5 cost time: 1.4335627555847168
Epoch: 5, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 1.4821078777313232
Epoch: 6, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.622 Vali Acc: 0.710 Test Loss: 0.622 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6714091300964355
Epoch: 7, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.649 Vali Acc: 0.725 Test Loss: 0.649 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 8 cost time: 1.6881837844848633
Epoch: 8, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 1.785400152206421
Epoch: 9, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.619 Vali Acc: 0.754 Test Loss: 0.619 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8920114040374756
Epoch: 10, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.811 Vali Acc: 0.739 Test Loss: 0.811 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8282198905944824
Epoch: 11, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.710 Vali Acc: 0.739 Test Loss: 0.710 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6584751605987549
Epoch: 12, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8048102855682373
Epoch: 13, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.733 Vali Acc: 0.688 Test Loss: 0.733 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.77358078956604
Epoch: 14, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.689 Vali Acc: 0.804 Test Loss: 0.689 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 1.9893646240234375
Epoch: 15, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.9845120906829834
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3500218391418457
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 18 cost time: 1.416309118270874
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.848 Test Loss: 0.581 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2830018997192383
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7829406261444092
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 21 cost time: 1.8051731586456299
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.835420846939087
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 23 cost time: 1.4325072765350342
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.855 Test Loss: 0.555 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5191142559051514
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.855 Test Loss: 0.560 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6184427738189697
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6527149677276611
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.151210308074951
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.855 Test Loss: 0.576 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5497045516967773
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9159138202667236
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7990615367889404
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.855 Test Loss: 0.576 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7617592811584473
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8535096645355225
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 7905204
model size : 35.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5997512340545654
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.302 Vali Acc: 0.304 Test Loss: 1.302 Test Acc: 0.304
Validation loss decreased (inf --> -0.304335).  Saving model ...
Epoch: 2 cost time: 1.5208044052124023
Epoch: 2, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.099 Vali Acc: 0.594 Test Loss: 1.099 Test Acc: 0.594
Validation loss decreased (-0.304335 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 1.6169941425323486
Epoch: 3, Steps: 9 | Train Loss: 0.997 Vali Loss: 0.936 Vali Acc: 0.652 Test Loss: 0.936 Test Acc: 0.652
Validation loss decreased (-0.594192 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 1.8483669757843018
Epoch: 4, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.833 Vali Acc: 0.652 Test Loss: 0.833 Test Acc: 0.652
Validation loss decreased (-0.652165 --> -0.652166).  Saving model ...
Epoch: 5 cost time: 1.5335021018981934
Epoch: 5, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
Validation loss decreased (-0.652166 --> -0.739123).  Saving model ...
Epoch: 6 cost time: 1.5913984775543213
Epoch: 6, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.661 Vali Acc: 0.696 Test Loss: 0.661 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.855243444442749
Epoch: 7, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7145576477050781
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
Validation loss decreased (-0.739123 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.620786190032959
Epoch: 9, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.982598066329956
Epoch: 10, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.643 Vali Acc: 0.739 Test Loss: 0.643 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6487681865692139
Epoch: 11, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.760864 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 1.5937490463256836
Epoch: 12, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.67988920211792
Epoch: 13, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0472803115844727
Epoch: 14, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 2.0072274208068848
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 1.5595664978027344
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6378989219665527
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6983659267425537
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6008660793304443
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 2.261761426925659
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5497674942016602
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5966758728027344
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6824071407318115
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.862 Test Loss: 0.524 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4861392974853516
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.024702310562134
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.524 Vali Acc: 0.862 Test Loss: 0.524 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.035029411315918
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7752299308776855
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.798840045928955
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7642126083374023
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 3742260
model size : 16.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5100860595703125
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.348 Vali Acc: 0.391 Test Loss: 1.348 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.2254157066345215
Epoch: 2, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.193 Vali Acc: 0.565 Test Loss: 1.193 Test Acc: 0.565
Validation loss decreased (-0.391291 --> -0.565205).  Saving model ...
Epoch: 3 cost time: 1.2853517532348633
Epoch: 3, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.019 Vali Acc: 0.580 Test Loss: 1.019 Test Acc: 0.580
Validation loss decreased (-0.565205 --> -0.579700).  Saving model ...
Epoch: 4 cost time: 1.5469040870666504
Epoch: 4, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.885 Vali Acc: 0.630 Test Loss: 0.885 Test Acc: 0.630
Validation loss decreased (-0.579700 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 1.7034633159637451
Epoch: 5, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.748 Vali Acc: 0.717 Test Loss: 0.748 Test Acc: 0.717
Validation loss decreased (-0.630426 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 1.4921436309814453
Epoch: 6, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.3200671672821045
Epoch: 7, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.621 Vali Acc: 0.761 Test Loss: 0.621 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.4849557876586914
Epoch: 8, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.616 Vali Acc: 0.746 Test Loss: 0.616 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5437877178192139
Epoch: 9, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.607 Vali Acc: 0.754 Test Loss: 0.607 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4089372158050537
Epoch: 10, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.661 Vali Acc: 0.710 Test Loss: 0.661 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.277763843536377
Epoch: 11, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.531 Vali Acc: 0.797 Test Loss: 0.531 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 1.5158815383911133
Epoch: 12, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.646153211593628
Epoch: 13, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.5364761352539062
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.539 Vali Acc: 0.855 Test Loss: 0.539 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855067).  Saving model ...
Epoch: 15 cost time: 1.505913257598877
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.652 Vali Acc: 0.819 Test Loss: 0.652 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4560058116912842
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 1.56455659866333
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5276830196380615
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.807300329208374
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.3908016681671143
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4540679454803467
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2971439361572266
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 23 cost time: 1.3402605056762695
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.814058542251587
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.870 Test Loss: 0.477 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.439448356628418
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.357553243637085
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5045206546783447
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5367658138275146
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5379924774169922
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.884 Test Loss: 0.457 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 30 cost time: 1.6940031051635742
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.884 Test Loss: 0.502 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6426551342010498
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.884 Test Loss: 0.496 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4095304012298584
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.884 Test Loss: 0.462 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3082091808319092
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.877 Test Loss: 0.531 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7787463665008545
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.884 Test Loss: 0.453 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 35 cost time: 1.733504056930542
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.884 Test Loss: 0.525 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4121615886688232
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.884 Test Loss: 0.513 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.457655668258667
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.423797607421875
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.884 Test Loss: 0.516 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6149215698242188
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.884 Test Loss: 0.502 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5770454406738281
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.884 Test Loss: 0.528 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6584012508392334
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.884 Test Loss: 0.518 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6289355754852295
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.884 Test Loss: 0.501 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4458963871002197
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.884 Test Loss: 0.536 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.6816790103912354
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.884 Test Loss: 0.501 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 3738164
model size : 16.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4257853031158447
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.379 Vali Acc: 0.312 Test Loss: 1.379 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.4145212173461914
Epoch: 2, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.222 Vali Acc: 0.420 Test Loss: 1.222 Test Acc: 0.420
Validation loss decreased (-0.311580 --> -0.420278).  Saving model ...
Epoch: 3 cost time: 1.5427706241607666
Epoch: 3, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.016 Vali Acc: 0.558 Test Loss: 1.016 Test Acc: 0.558
Validation loss decreased (-0.420278 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 1.6308848857879639
Epoch: 4, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.845 Vali Acc: 0.652 Test Loss: 0.845 Test Acc: 0.652
Validation loss decreased (-0.557961 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 1.3663420677185059
Epoch: 5, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.808 Vali Acc: 0.652 Test Loss: 0.808 Test Acc: 0.652
Validation loss decreased (-0.652165 --> -0.652166).  Saving model ...
Epoch: 6 cost time: 1.3706159591674805
Epoch: 6, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.748 Vali Acc: 0.696 Test Loss: 0.748 Test Acc: 0.696
Validation loss decreased (-0.652166 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.509336233139038
Epoch: 7, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.676 Vali Acc: 0.688 Test Loss: 0.676 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3604085445404053
Epoch: 8, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.639 Vali Acc: 0.754 Test Loss: 0.639 Test Acc: 0.754
Validation loss decreased (-0.695645 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.7111623287200928
Epoch: 9, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.599 Vali Acc: 0.754 Test Loss: 0.599 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 1.5327346324920654
Epoch: 10, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.547 Vali Acc: 0.812 Test Loss: 0.547 Test Acc: 0.812
Validation loss decreased (-0.753617 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 1.4980599880218506
Epoch: 11, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.657 Vali Acc: 0.746 Test Loss: 0.657 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6556391716003418
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 1.9629507064819336
Epoch: 13, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5351300239562988
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 1.4712517261505127
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.436 Vali Acc: 0.812 Test Loss: 0.436 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4545247554779053
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.528092384338379
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 18 cost time: 1.6617624759674072
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8441874980926514
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 1.3916842937469482
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.537 Vali Acc: 0.862 Test Loss: 0.537 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7234983444213867
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.656008243560791
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.396306037902832
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 1.8062639236450195
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6747291088104248
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876806).  Saving model ...
Epoch: 26 cost time: 1.5769822597503662
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.471447467803955
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8937959671020508
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.877 Test Loss: 0.478 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876807).  Saving model ...
Epoch: 29 cost time: 1.8425066471099854
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.884 Test Loss: 0.450 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 30 cost time: 1.7474465370178223
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4279241561889648
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.51078462600708
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.877 Test Loss: 0.486 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6860637664794922
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.679640769958496
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4517970085144043
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.884 Test Loss: 0.478 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.475728988647461
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5508992671966553
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.884 Test Loss: 0.473 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7572927474975586
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7179231643676758
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.884 Test Loss: 0.492 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 3734068
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.667293071746826
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.316 Vali Acc: 0.406 Test Loss: 1.316 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.6239562034606934
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.159 Vali Acc: 0.572 Test Loss: 1.159 Test Acc: 0.572
Validation loss decreased (-0.405784 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 1.6193645000457764
Epoch: 3, Steps: 9 | Train Loss: 1.023 Vali Loss: 1.008 Vali Acc: 0.572 Test Loss: 1.008 Test Acc: 0.572
Validation loss decreased (-0.572452 --> -0.572454).  Saving model ...
Epoch: 4 cost time: 1.847557544708252
Epoch: 4, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.841 Vali Acc: 0.652 Test Loss: 0.841 Test Acc: 0.652
Validation loss decreased (-0.572454 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 1.7825632095336914
Epoch: 5, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.747 Vali Acc: 0.638 Test Loss: 0.747 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8358368873596191
Epoch: 6, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.677 Vali Acc: 0.710 Test Loss: 0.677 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.4051227569580078
Epoch: 7, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 8 cost time: 1.5802969932556152
Epoch: 8, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.596 Vali Acc: 0.768 Test Loss: 0.596 Test Acc: 0.768
Validation loss decreased (-0.717385 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 1.7268095016479492
Epoch: 9, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7493841648101807
Epoch: 10, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.669 Vali Acc: 0.739 Test Loss: 0.669 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2588064670562744
Epoch: 11, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.656 Vali Acc: 0.761 Test Loss: 0.656 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.804018497467041
Epoch: 12, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.768110 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 1.6802303791046143
Epoch: 13, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.534 Vali Acc: 0.768 Test Loss: 0.534 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9732491970062256
Epoch: 14, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8261363506317139
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.711 Vali Acc: 0.790 Test Loss: 0.711 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.966191291809082
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.425 Vali Acc: 0.826 Test Loss: 0.425 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9327614307403564
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 2.0470314025878906
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7448678016662598
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 20 cost time: 1.674492597579956
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 21 cost time: 1.9255995750427246
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.906325340270996
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7635135650634766
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.036787748336792
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.03525710105896
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.884 Test Loss: 0.415 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0919535160064697
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.197021245956421
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6260976791381836
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8941607475280762
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5533158779144287
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 3729972
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.116253137588501
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.314 Vali Acc: 0.464 Test Loss: 1.314 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 1.7626349925994873
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.183 Vali Acc: 0.529 Test Loss: 1.183 Test Acc: 0.529
Validation loss decreased (-0.463755 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 1.8258521556854248
Epoch: 3, Steps: 9 | Train Loss: 1.144 Vali Loss: 1.057 Vali Acc: 0.558 Test Loss: 1.057 Test Acc: 0.558
Validation loss decreased (-0.528974 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.825465440750122
Epoch: 4, Steps: 9 | Train Loss: 0.957 Vali Loss: 0.900 Vali Acc: 0.630 Test Loss: 0.900 Test Acc: 0.630
Validation loss decreased (-0.557960 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 1.6736559867858887
Epoch: 5, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.792 Vali Acc: 0.616 Test Loss: 0.792 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.78794527053833
Epoch: 6, Steps: 9 | Train Loss: 0.611 Vali Loss: 0.693 Vali Acc: 0.732 Test Loss: 0.693 Test Acc: 0.732
Validation loss decreased (-0.630426 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 2.17760968208313
Epoch: 7, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.668 Vali Acc: 0.710 Test Loss: 0.668 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6281731128692627
Epoch: 8, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.592 Vali Acc: 0.725 Test Loss: 0.592 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8888931274414062
Epoch: 9, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.6832644939422607
Epoch: 10, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.635 Vali Acc: 0.688 Test Loss: 0.635 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.271389961242676
Epoch: 11, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 1.5440585613250732
Epoch: 12, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.686 Vali Acc: 0.768 Test Loss: 0.686 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5581560134887695
Epoch: 13, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 14 cost time: 1.9889907836914062
Epoch: 14, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7494242191314697
Epoch: 15, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 1.738725185394287
Epoch: 16, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.462 Vali Acc: 0.826 Test Loss: 0.462 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 1.6907382011413574
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 1.9429361820220947
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5892767906188965
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9857382774353027
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9551544189453125
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7895748615264893
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6308865547180176
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 1.7978417873382568
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.874570608139038
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8547170162200928
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9062004089355469
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5507299900054932
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 29 cost time: 2.1576004028320312
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.035127878189087
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7951915264129639
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7639009952545166
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0329430103302
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.8630776405334473
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 35 cost time: 1.8090236186981201
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6609482765197754
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9619839191436768
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.637138843536377
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.136773109436035
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 40 cost time: 2.0122995376586914
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6763570308685303
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9993195533752441
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.747304916381836
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.851761817932129
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6269173622131348
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.710904598236084
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 47 cost time: 1.799999713897705
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 48 cost time: 1.7453320026397705
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.6317410469055176
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 50 cost time: 1.44789457321167
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.847069263458252
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.877 Test Loss: 0.458 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 52 cost time: 1.9144337177276611
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.7790391445159912
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.877 Test Loss: 0.496 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.9111394882202148
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.877 Test Loss: 0.472 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.9241321086883545
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 56 cost time: 1.836885690689087
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 57 cost time: 1.9549474716186523
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.1341192722320557
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.7951655387878418
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.6863148212432861
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.8250555992126465
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.7355496883392334
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.9906370639801025
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.877 Test Loss: 0.451 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.648103952407837
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.884 Test Loss: 0.455 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 65 cost time: 1.874587059020996
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.884 Test Loss: 0.495 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8968753814697266
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.884 Test Loss: 0.477 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9632582664489746
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.717388391494751
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.884 Test Loss: 0.479 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.678438663482666
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.884 Test Loss: 0.471 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.0427372455596924
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.870 Test Loss: 0.566 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.8559317588806152
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.884 Test Loss: 0.438 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 72 cost time: 2.0092265605926514
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.625340461730957
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.7109787464141846
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.877 Test Loss: 0.520 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.6217234134674072
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.6775217056274414
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.884 Test Loss: 0.491 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.8098528385162354
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.884 Test Loss: 0.474 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.8500416278839111
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.8897156715393066
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.884 Test Loss: 0.504 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.7148690223693848
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.6763296127319336
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.884 Test Loss: 0.486 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2821172
model size : 13.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5794098377227783
Epoch: 1, Steps: 9 | Train Loss: 1.477 Vali Loss: 1.423 Vali Acc: 0.217 Test Loss: 1.423 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 1.6088230609893799
Epoch: 2, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.217377 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.6271228790283203
Epoch: 3, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.113 Vali Acc: 0.529 Test Loss: 1.113 Test Acc: 0.529
Validation loss decreased (-0.485495 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 1.5503003597259521
Epoch: 4, Steps: 9 | Train Loss: 0.979 Vali Loss: 0.966 Vali Acc: 0.630 Test Loss: 0.966 Test Acc: 0.630
Validation loss decreased (-0.528974 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 1.548609733581543
Epoch: 5, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.819 Vali Acc: 0.696 Test Loss: 0.819 Test Acc: 0.696
Validation loss decreased (-0.630425 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 1.5424633026123047
Epoch: 6, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.700 Vali Acc: 0.710 Test Loss: 0.700 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.5645678043365479
Epoch: 7, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.675 Vali Acc: 0.696 Test Loss: 0.675 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4397528171539307
Epoch: 8, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 1.7457566261291504
Epoch: 9, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731878).  Saving model ...
Epoch: 10 cost time: 1.527923345565796
Epoch: 10, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.5669074058532715
Epoch: 11, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.497 Vali Acc: 0.826 Test Loss: 0.497 Test Acc: 0.826
Validation loss decreased (-0.775357 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 1.5493390560150146
Epoch: 12, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.536 Vali Acc: 0.797 Test Loss: 0.536 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5868282318115234
Epoch: 13, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8249895572662354
Epoch: 14, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.762557029724121
Epoch: 15, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.416 Vali Acc: 0.819 Test Loss: 0.416 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.771160364151001
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
Validation loss decreased (-0.826082 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 1.6144161224365234
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.798555612564087
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 1.5398283004760742
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5701136589050293
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7707946300506592
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4946932792663574
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.312 Vali Acc: 0.862 Test Loss: 0.312 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.60664963722229
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.471 Vali Acc: 0.884 Test Loss: 0.471 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7862160205841064
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.338 Vali Acc: 0.899 Test Loss: 0.338 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 1.64854097366333
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5313849449157715
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.380 Vali Acc: 0.899 Test Loss: 0.380 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8628978729248047
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.130019426345825
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.899 Test Loss: 0.380 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7907078266143799
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5475845336914062
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.627246379852295
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.891 Test Loss: 0.430 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5735423564910889
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9702997207641602
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7736587524414062
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2817076
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3572354316711426
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.390 Vali Acc: 0.210 Test Loss: 1.390 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 1.725283145904541
Epoch: 2, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.265 Vali Acc: 0.406 Test Loss: 1.265 Test Acc: 0.406
Validation loss decreased (-0.210131 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.5107524394989014
Epoch: 3, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.126 Vali Acc: 0.558 Test Loss: 1.126 Test Acc: 0.558
Validation loss decreased (-0.405784 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.6352729797363281
Epoch: 4, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.973 Vali Acc: 0.630 Test Loss: 0.973 Test Acc: 0.630
Validation loss decreased (-0.557960 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 1.6634056568145752
Epoch: 5, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.827 Vali Acc: 0.688 Test Loss: 0.827 Test Acc: 0.688
Validation loss decreased (-0.630425 --> -0.688398).  Saving model ...
Epoch: 6 cost time: 1.4062087535858154
Epoch: 6, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.748 Vali Acc: 0.652 Test Loss: 0.748 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4637641906738281
Epoch: 7, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.644 Vali Acc: 0.688 Test Loss: 0.644 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688399).  Saving model ...
Epoch: 8 cost time: 1.3656234741210938
Epoch: 8, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.595 Vali Acc: 0.725 Test Loss: 0.595 Test Acc: 0.725
Validation loss decreased (-0.688399 --> -0.724632).  Saving model ...
Epoch: 9 cost time: 1.665907621383667
Epoch: 9, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.573 Vali Acc: 0.768 Test Loss: 0.573 Test Acc: 0.768
Validation loss decreased (-0.724632 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 1.4083752632141113
Epoch: 10, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.541 Vali Acc: 0.768 Test Loss: 0.541 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768111).  Saving model ...
Epoch: 11 cost time: 1.6659669876098633
Epoch: 11, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5517683029174805
Epoch: 12, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.768111 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 1.4776463508605957
Epoch: 13, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.718 Vali Acc: 0.746 Test Loss: 0.718 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5102131366729736
Epoch: 14, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.544 Vali Acc: 0.797 Test Loss: 0.544 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 1.9121649265289307
Epoch: 15, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.551 Vali Acc: 0.775 Test Loss: 0.551 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5974361896514893
Epoch: 16, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 1.8946995735168457
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 1.5157020092010498
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.9192173480987549
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6644747257232666
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 1.8611383438110352
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7647440433502197
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876808).  Saving model ...
Epoch: 23 cost time: 1.729468822479248
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9695985317230225
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8390023708343506
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.737581729888916
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.70076584815979
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7474477291107178
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7376103401184082
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.608051061630249
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6331422328948975
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.464754581451416
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2812980
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1097824573516846
Epoch: 1, Steps: 9 | Train Loss: 1.461 Vali Loss: 1.395 Vali Acc: 0.326 Test Loss: 1.395 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.351349115371704
Epoch: 2, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
Validation loss decreased (-0.326073 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.508619785308838
Epoch: 3, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.033 Vali Acc: 0.493 Test Loss: 1.033 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492743).  Saving model ...
Epoch: 4 cost time: 1.4358043670654297
Epoch: 4, Steps: 9 | Train Loss: 0.954 Vali Loss: 0.918 Vali Acc: 0.616 Test Loss: 0.918 Test Acc: 0.616
Validation loss decreased (-0.492743 --> -0.615933).  Saving model ...
Epoch: 5 cost time: 1.414954662322998
Epoch: 5, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.789 Vali Acc: 0.674 Test Loss: 0.789 Test Acc: 0.674
Validation loss decreased (-0.615933 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.2521703243255615
Epoch: 6, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.727 Vali Acc: 0.652 Test Loss: 0.727 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4786665439605713
Epoch: 7, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.296076774597168
Epoch: 8, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.604 Vali Acc: 0.725 Test Loss: 0.604 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3540804386138916
Epoch: 9, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.540 Vali Acc: 0.797 Test Loss: 0.540 Test Acc: 0.797
Validation loss decreased (-0.731877 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.4931998252868652
Epoch: 10, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.547 Vali Acc: 0.768 Test Loss: 0.547 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4276516437530518
Epoch: 11, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5012054443359375
Epoch: 12, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.569 Vali Acc: 0.797 Test Loss: 0.569 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.601121187210083
Epoch: 13, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.631 Vali Acc: 0.768 Test Loss: 0.631 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.473017930984497
Epoch: 14, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.539 Vali Acc: 0.739 Test Loss: 0.539 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3614587783813477
Epoch: 15, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 1.7036941051483154
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.5185348987579346
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 1.829326868057251
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5943617820739746
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6289997100830078
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 1.5381319522857666
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.494 Vali Acc: 0.797 Test Loss: 0.494 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6450355052947998
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4389796257019043
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5822861194610596
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 1.5543923377990723
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.498 Vali Acc: 0.862 Test Loss: 0.498 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 26 cost time: 1.4456024169921875
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 27 cost time: 1.4419264793395996
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5238702297210693
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6717047691345215
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4727108478546143
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5408024787902832
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.352980613708496
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4801294803619385
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6782758235931396
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.870 Test Loss: 0.552 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7038493156433105
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7811110019683838
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.877 Test Loss: 0.507 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 37 cost time: 1.593395709991455
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4623727798461914
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8196070194244385
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.072450876235962
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.877 Test Loss: 0.519 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.083355665206909
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.877 Test Loss: 0.498 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 42 cost time: 1.5238268375396729
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.877 Test Loss: 0.518 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.359227180480957
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.877 Test Loss: 0.530 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.526376485824585
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.542492151260376
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.702253818511963
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6348631381988525
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.877 Test Loss: 0.528 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.498934268951416
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.884 Test Loss: 0.529 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 49 cost time: 1.2889108657836914
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.877 Test Loss: 0.502 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3239984512329102
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.877 Test Loss: 0.565 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.5515875816345215
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.884 Test Loss: 0.516 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 52 cost time: 1.7695190906524658
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.891 Test Loss: 0.539 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 53 cost time: 1.8213610649108887
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.877 Test Loss: 0.524 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3566250801086426
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.884 Test Loss: 0.534 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3744404315948486
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3605430126190186
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.877 Test Loss: 0.515 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.503929853439331
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.877 Test Loss: 0.527 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.6343774795532227
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.877 Test Loss: 0.533 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.516700267791748
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.877 Test Loss: 0.499 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.6212248802185059
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.891 Test Loss: 0.533 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 61 cost time: 1.3778119087219238
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.6652448177337646
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.884 Test Loss: 0.563 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.352992296218872
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.891 Test Loss: 0.527 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 64 cost time: 1.6812279224395752
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.891 Test Loss: 0.531 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3960356712341309
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.891 Test Loss: 0.547 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.4204394817352295
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.877 Test Loss: 0.514 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.3357036113739014
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.884 Test Loss: 0.556 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.5091888904571533
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.877 Test Loss: 0.527 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.6793322563171387
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.884 Test Loss: 0.541 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.8982439041137695
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.877 Test Loss: 0.564 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.5182607173919678
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.891 Test Loss: 0.555 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.6330885887145996
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.884 Test Loss: 0.552 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.691596269607544
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.884 Test Loss: 0.528 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2808884
model size : 13.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.373112201690674
Epoch: 1, Steps: 9 | Train Loss: 1.476 Vali Loss: 1.415 Vali Acc: 0.312 Test Loss: 1.415 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.4465484619140625
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.301 Vali Acc: 0.348 Test Loss: 1.301 Test Acc: 0.348
Validation loss decreased (-0.311580 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.7177636623382568
Epoch: 3, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.151 Vali Acc: 0.449 Test Loss: 1.151 Test Acc: 0.449
Validation loss decreased (-0.347813 --> -0.449264).  Saving model ...
Epoch: 4 cost time: 1.548126459121704
Epoch: 4, Steps: 9 | Train Loss: 0.990 Vali Loss: 1.018 Vali Acc: 0.478 Test Loss: 1.018 Test Acc: 0.478
Validation loss decreased (-0.449264 --> -0.478251).  Saving model ...
Epoch: 5 cost time: 1.5668632984161377
Epoch: 5, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.883 Vali Acc: 0.674 Test Loss: 0.883 Test Acc: 0.674
Validation loss decreased (-0.478251 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.5536127090454102
Epoch: 6, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.779 Vali Acc: 0.688 Test Loss: 0.779 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 1.5447978973388672
Epoch: 7, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.709 Vali Acc: 0.710 Test Loss: 0.709 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 8 cost time: 1.618762731552124
Epoch: 8, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.710 Vali Acc: 0.739 Test Loss: 0.710 Test Acc: 0.739
Validation loss decreased (-0.710138 --> -0.739123).  Saving model ...
Epoch: 9 cost time: 1.330035924911499
Epoch: 9, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.581 Vali Acc: 0.746 Test Loss: 0.581 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746371).  Saving model ...
Epoch: 10 cost time: 1.3264310359954834
Epoch: 10, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6089742183685303
Epoch: 11, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.505 Vali Acc: 0.804 Test Loss: 0.505 Test Acc: 0.804
Validation loss decreased (-0.746371 --> -0.804343).  Saving model ...
Epoch: 12 cost time: 1.5415050983428955
Epoch: 12, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.542 Vali Acc: 0.775 Test Loss: 0.542 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3577618598937988
Epoch: 13, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.616 Vali Acc: 0.797 Test Loss: 0.616 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.565666913986206
Epoch: 14, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.514 Vali Acc: 0.790 Test Loss: 0.514 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4931395053863525
Epoch: 15, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.4825124740600586
Epoch: 16, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7632246017456055
Epoch: 17, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 18 cost time: 1.8284547328948975
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.776585340499878
Epoch: 19, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.551 Vali Acc: 0.790 Test Loss: 0.551 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.915048599243164
Epoch: 20, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 1.493222951889038
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5673038959503174
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.469 Vali Acc: 0.877 Test Loss: 0.469 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 23 cost time: 1.7029728889465332
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.899 Test Loss: 0.406 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898547).  Saving model ...
Epoch: 24 cost time: 1.5767543315887451
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.720876693725586
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5778529644012451
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5861399173736572
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8813564777374268
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6537532806396484
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.862 Test Loss: 0.471 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8499176502227783
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.931194543838501
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6690993309020996
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5230438709259033
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2360628
model size : 11.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9969470500946045
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.382 Vali Acc: 0.297 Test Loss: 1.382 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.5313942432403564
Epoch: 2, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.251 Vali Acc: 0.428 Test Loss: 1.251 Test Acc: 0.428
Validation loss decreased (-0.297088 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 1.9646508693695068
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.106 Vali Acc: 0.601 Test Loss: 1.106 Test Acc: 0.601
Validation loss decreased (-0.427524 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 1.8119592666625977
Epoch: 4, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.966 Vali Acc: 0.638 Test Loss: 0.966 Test Acc: 0.638
Validation loss decreased (-0.601438 --> -0.637671).  Saving model ...
Epoch: 5 cost time: 1.7880182266235352
Epoch: 5, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.840 Vali Acc: 0.638 Test Loss: 0.840 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637673).  Saving model ...
Epoch: 6 cost time: 1.5265023708343506
Epoch: 6, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.753 Vali Acc: 0.659 Test Loss: 0.753 Test Acc: 0.659
Validation loss decreased (-0.637673 --> -0.659413).  Saving model ...
Epoch: 7 cost time: 1.5866494178771973
Epoch: 7, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.688 Vali Acc: 0.674 Test Loss: 0.688 Test Acc: 0.674
Validation loss decreased (-0.659413 --> -0.673906).  Saving model ...
Epoch: 8 cost time: 1.8384811878204346
Epoch: 8, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.661 Vali Acc: 0.739 Test Loss: 0.661 Test Acc: 0.739
Validation loss decreased (-0.673906 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 1.590604543685913
Epoch: 9, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6371171474456787
Epoch: 10, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.645 Vali Acc: 0.710 Test Loss: 0.645 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6190226078033447
Epoch: 11, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.663 Vali Acc: 0.725 Test Loss: 0.663 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.591034173965454
Epoch: 12, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.523 Vali Acc: 0.812 Test Loss: 0.523 Test Acc: 0.812
Validation loss decreased (-0.739124 --> -0.811589).  Saving model ...
Epoch: 13 cost time: 1.5513691902160645
Epoch: 13, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.644 Vali Acc: 0.688 Test Loss: 0.644 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8789677619934082
Epoch: 14, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.767277479171753
Epoch: 15, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.550 Vali Acc: 0.754 Test Loss: 0.550 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9889445304870605
Epoch: 16, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
Validation loss decreased (-0.811589 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 1.6493403911590576
Epoch: 17, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7211027145385742
Epoch: 18, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.797717809677124
Epoch: 19, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6388332843780518
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5540003776550293
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7663719654083252
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.695708990097046
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869560).  Saving model ...
Epoch: 24 cost time: 1.7713921070098877
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 1.7511355876922607
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5955781936645508
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.469682216644287
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8362321853637695
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 29 cost time: 1.486161231994629
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.627025842666626
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4849371910095215
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7154970169067383
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5239017009735107
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9403069019317627
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.884 Test Loss: 0.448 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 35 cost time: 1.6284120082855225
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5007576942443848
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5745744705200195
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.877 Test Loss: 0.483 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.475672483444214
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5290699005126953
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7532780170440674
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5895068645477295
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.877 Test Loss: 0.527 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.5280966758728027
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.891 Test Loss: 0.496 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 43 cost time: 1.5493323802947998
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.884 Test Loss: 0.523 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.68434739112854
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.877 Test Loss: 0.529 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.604933500289917
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.877 Test Loss: 0.530 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5302982330322266
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.899 Test Loss: 0.503 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898546).  Saving model ...
Epoch: 47 cost time: 1.5770878791809082
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.717604398727417
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.884 Test Loss: 0.517 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5038976669311523
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.899 Test Loss: 0.516 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.6935694217681885
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.884 Test Loss: 0.538 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.8121390342712402
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.884 Test Loss: 0.538 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.7158451080322266
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.884 Test Loss: 0.519 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.5259709358215332
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.891 Test Loss: 0.501 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.5308754444122314
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.63570237159729
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.877 Test Loss: 0.542 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.783252477645874
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.891 Test Loss: 0.535 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2356532
model size : 11.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.445544958114624
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.378 Vali Acc: 0.326 Test Loss: 1.378 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.5592219829559326
Epoch: 2, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.330 Vali Acc: 0.391 Test Loss: 1.330 Test Acc: 0.391
Validation loss decreased (-0.326073 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.5656938552856445
Epoch: 3, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.170 Vali Acc: 0.406 Test Loss: 1.170 Test Acc: 0.406
Validation loss decreased (-0.391291 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 1.6220767498016357
Epoch: 4, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.022 Vali Acc: 0.558 Test Loss: 1.022 Test Acc: 0.558
Validation loss decreased (-0.405785 --> -0.557961).  Saving model ...
Epoch: 5 cost time: 1.6871697902679443
Epoch: 5, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.876 Vali Acc: 0.616 Test Loss: 0.876 Test Acc: 0.616
Validation loss decreased (-0.557961 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 1.596881628036499
Epoch: 6, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.758 Vali Acc: 0.703 Test Loss: 0.758 Test Acc: 0.703
Validation loss decreased (-0.615933 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.436037302017212
Epoch: 7, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 8 cost time: 1.89082670211792
Epoch: 8, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.557370901107788
Epoch: 9, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.638 Vali Acc: 0.703 Test Loss: 0.638 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6295225620269775
Epoch: 10, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
Validation loss decreased (-0.717385 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.382094383239746
Epoch: 11, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3060283660888672
Epoch: 12, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3932390213012695
Epoch: 13, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.500 Vali Acc: 0.804 Test Loss: 0.500 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 1.4967632293701172
Epoch: 14, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.632 Vali Acc: 0.754 Test Loss: 0.632 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4882574081420898
Epoch: 15, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7166922092437744
Epoch: 16, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.485 Vali Acc: 0.797 Test Loss: 0.485 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.524385690689087
Epoch: 17, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.505 Vali Acc: 0.826 Test Loss: 0.505 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 1.349773645401001
Epoch: 18, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 1.45223069190979
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4395592212677002
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 1.6586520671844482
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4374330043792725
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.942073106765747
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6941561698913574
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 1.6703948974609375
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4274077415466309
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7121272087097168
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.405 Vali Acc: 0.870 Test Loss: 0.405 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7964186668395996
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6610107421875
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6877543926239014
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6499919891357422
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7428112030029297
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.7008941173553467
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7617783546447754
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2352436
model size : 11.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3854284286499023
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.378 Vali Acc: 0.304 Test Loss: 1.378 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.4344546794891357
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.243 Vali Acc: 0.420 Test Loss: 1.243 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.4293465614318848
Epoch: 3, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.096 Vali Acc: 0.638 Test Loss: 1.096 Test Acc: 0.638
Validation loss decreased (-0.420277 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 1.7927048206329346
Epoch: 4, Steps: 9 | Train Loss: 1.050 Vali Loss: 0.951 Vali Acc: 0.616 Test Loss: 0.951 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5303235054016113
Epoch: 5, Steps: 9 | Train Loss: 0.880 Vali Loss: 0.840 Vali Acc: 0.710 Test Loss: 0.840 Test Acc: 0.710
Validation loss decreased (-0.637670 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 1.533390998840332
Epoch: 6, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.734 Vali Acc: 0.703 Test Loss: 0.734 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.621497631072998
Epoch: 7, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.684 Vali Acc: 0.696 Test Loss: 0.684 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4232325553894043
Epoch: 8, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
Validation loss decreased (-0.710137 --> -0.731878).  Saving model ...
Epoch: 9 cost time: 1.6486444473266602
Epoch: 9, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.575 Vali Acc: 0.754 Test Loss: 0.575 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 1.3930237293243408
Epoch: 10, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782604).  Saving model ...
Epoch: 11 cost time: 1.4787204265594482
Epoch: 11, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.545 Vali Acc: 0.790 Test Loss: 0.545 Test Acc: 0.790
Validation loss decreased (-0.782604 --> -0.789850).  Saving model ...
Epoch: 12 cost time: 1.3531839847564697
Epoch: 12, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.468 Vali Acc: 0.812 Test Loss: 0.468 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811590).  Saving model ...
Epoch: 13 cost time: 1.476555585861206
Epoch: 13, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.468 Vali Acc: 0.790 Test Loss: 0.468 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.519089937210083
Epoch: 14, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.514 Vali Acc: 0.768 Test Loss: 0.514 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7505090236663818
Epoch: 15, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.459 Vali Acc: 0.819 Test Loss: 0.459 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 1.5103325843811035
Epoch: 16, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.423 Vali Acc: 0.826 Test Loss: 0.423 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 17 cost time: 1.9557788372039795
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.520 Vali Acc: 0.797 Test Loss: 0.520 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5354092121124268
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 1.4496231079101562
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
Validation loss decreased (-0.833328 --> -0.869562).  Saving model ...
Epoch: 20 cost time: 1.5247926712036133
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4694912433624268
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.757502794265747
Epoch: 22, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4953908920288086
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.557924509048462
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6140251159667969
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6552610397338867
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.429 Vali Acc: 0.870 Test Loss: 0.429 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6301648616790771
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.776888370513916
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7050931453704834
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 2348340
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.778554916381836
Epoch: 1, Steps: 9 | Train Loss: 1.520 Vali Loss: 1.339 Vali Acc: 0.442 Test Loss: 1.339 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 1.9414393901824951
Epoch: 2, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
Validation loss decreased (-0.442016 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 1.5686228275299072
Epoch: 3, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
Validation loss decreased (-0.514481 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 1.5046837329864502
Epoch: 4, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.962 Vali Acc: 0.572 Test Loss: 0.962 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572454).  Saving model ...
Epoch: 5 cost time: 1.9110965728759766
Epoch: 5, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.834 Vali Acc: 0.674 Test Loss: 0.834 Test Acc: 0.674
Validation loss decreased (-0.572454 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.4677455425262451
Epoch: 6, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.740 Vali Acc: 0.681 Test Loss: 0.740 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 1.6795248985290527
Epoch: 7, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.681 Vali Acc: 0.681 Test Loss: 0.681 Test Acc: 0.681
Validation loss decreased (-0.681152 --> -0.681153).  Saving model ...
Epoch: 8 cost time: 1.891441822052002
Epoch: 8, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.712 Vali Acc: 0.638 Test Loss: 0.712 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5717618465423584
Epoch: 9, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.724 Vali Acc: 0.710 Test Loss: 0.724 Test Acc: 0.710
Validation loss decreased (-0.681153 --> -0.710138).  Saving model ...
Epoch: 10 cost time: 2.0175094604492188
Epoch: 10, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 11 cost time: 1.678924322128296
Epoch: 11, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746371).  Saving model ...
Epoch: 12 cost time: 1.6736986637115479
Epoch: 12, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.557 Vali Acc: 0.790 Test Loss: 0.557 Test Acc: 0.790
Validation loss decreased (-0.746371 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 1.6526851654052734
Epoch: 13, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.548 Vali Acc: 0.768 Test Loss: 0.548 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6449806690216064
Epoch: 14, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 1.4491827487945557
Epoch: 15, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5181398391723633
Epoch: 16, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 1.761307716369629
Epoch: 17, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.454 Vali Acc: 0.826 Test Loss: 0.454 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 1.3864459991455078
Epoch: 18, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5815656185150146
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.625 Vali Acc: 0.804 Test Loss: 0.625 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.611250638961792
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.420 Vali Acc: 0.804 Test Loss: 0.420 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.892223596572876
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.6318016052246094
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6251740455627441
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.848 Test Loss: 0.394 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 24 cost time: 1.6299028396606445
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6017205715179443
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 26 cost time: 1.6115334033966064
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 27 cost time: 1.4446563720703125
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.648784875869751
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9432730674743652
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.806370496749878
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.508040189743042
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 32 cost time: 1.677774429321289
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5785319805145264
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7387464046478271
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6537582874298096
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4189479351043701
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5060064792633057
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8695895671844482
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6053624153137207
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5443534851074219
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6101386547088623
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2130356
model size : 10.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.017132997512817
Epoch: 1, Steps: 9 | Train Loss: 1.467 Vali Loss: 1.380 Vali Acc: 0.261 Test Loss: 1.380 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.603593349456787
Epoch: 2, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.258 Vali Acc: 0.384 Test Loss: 1.258 Test Acc: 0.384
Validation loss decreased (-0.260856 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.4390456676483154
Epoch: 3, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.088 Vali Acc: 0.558 Test Loss: 1.088 Test Acc: 0.558
Validation loss decreased (-0.384045 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.3073155879974365
Epoch: 4, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.933 Vali Acc: 0.645 Test Loss: 0.933 Test Acc: 0.645
Validation loss decreased (-0.557960 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 1.5780270099639893
Epoch: 5, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.838 Vali Acc: 0.630 Test Loss: 0.838 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.846559762954712
Epoch: 6, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.792 Vali Acc: 0.645 Test Loss: 0.792 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644920).  Saving model ...
Epoch: 7 cost time: 1.5585803985595703
Epoch: 7, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.702 Vali Acc: 0.703 Test Loss: 0.702 Test Acc: 0.703
Validation loss decreased (-0.644920 --> -0.702892).  Saving model ...
Epoch: 8 cost time: 1.4877197742462158
Epoch: 8, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.653 Vali Acc: 0.717 Test Loss: 0.653 Test Acc: 0.717
Validation loss decreased (-0.702892 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.487429141998291
Epoch: 9, Steps: 9 | Train Loss: 0.404 Vali Loss: 0.610 Vali Acc: 0.754 Test Loss: 0.610 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 1.5540823936462402
Epoch: 10, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.620 Vali Acc: 0.739 Test Loss: 0.620 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4760138988494873
Epoch: 11, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5712289810180664
Epoch: 12, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.565 Vali Acc: 0.775 Test Loss: 0.565 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 1.4594264030456543
Epoch: 13, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.525 Vali Acc: 0.797 Test Loss: 0.525 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.3858022689819336
Epoch: 14, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.562847375869751
Epoch: 15, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.550931453704834
Epoch: 16, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.507 Vali Acc: 0.790 Test Loss: 0.507 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7187004089355469
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3501322269439697
Epoch: 18, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.397343635559082
Epoch: 19, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.45658278465271
Epoch: 20, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5668127536773682
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 1.4522144794464111
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 1.6242632865905762
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.603956699371338
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 1.498023271560669
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6698689460754395
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.61002516746521
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.832512617111206
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3833088874816895
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3829069137573242
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.462151050567627
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6353039741516113
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.538043737411499
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.686202049255371
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2126260
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.258621454238892
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.383 Vali Acc: 0.348 Test Loss: 1.383 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 1.6523559093475342
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
Validation loss decreased (-0.347812 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.6034770011901855
Epoch: 3, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.113 Vali Acc: 0.529 Test Loss: 1.113 Test Acc: 0.529
Validation loss decreased (-0.485495 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 1.6211655139923096
Epoch: 4, Steps: 9 | Train Loss: 1.014 Vali Loss: 0.978 Vali Acc: 0.616 Test Loss: 0.978 Test Acc: 0.616
Validation loss decreased (-0.528974 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.5088543891906738
Epoch: 5, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.866 Vali Acc: 0.638 Test Loss: 0.866 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637673).  Saving model ...
Epoch: 6 cost time: 1.4603042602539062
Epoch: 6, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.776 Vali Acc: 0.688 Test Loss: 0.776 Test Acc: 0.688
Validation loss decreased (-0.637673 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 1.6929891109466553
Epoch: 7, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.724 Vali Acc: 0.645 Test Loss: 0.724 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4837157726287842
Epoch: 8, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.679 Vali Acc: 0.725 Test Loss: 0.679 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724631).  Saving model ...
Epoch: 9 cost time: 1.829430103302002
Epoch: 9, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.584 Vali Acc: 0.768 Test Loss: 0.584 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 1.5268232822418213
Epoch: 10, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.630 Vali Acc: 0.696 Test Loss: 0.630 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.656803846359253
Epoch: 11, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 1.4613022804260254
Epoch: 12, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.517 Vali Acc: 0.797 Test Loss: 0.517 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.5950515270233154
Epoch: 13, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 1.4980897903442383
Epoch: 14, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 15 cost time: 1.5340917110443115
Epoch: 15, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 1.6547932624816895
Epoch: 16, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6050498485565186
Epoch: 17, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 18 cost time: 1.6379196643829346
Epoch: 18, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
Validation loss decreased (-0.826083 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 1.4857406616210938
Epoch: 19, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.608405351638794
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.397437572479248
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5370073318481445
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 23 cost time: 1.393765926361084
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2212295532226562
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8099102973937988
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8642971515655518
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6948966979980469
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891300).  Saving model ...
Epoch: 28 cost time: 1.4082908630371094
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4353864192962646
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6695497035980225
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4243979454040527
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6358160972595215
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6414568424224854
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3413703441619873
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.687690258026123
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5581822395324707
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3975012302398682
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2122164
model size : 10.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1469597816467285
Epoch: 1, Steps: 9 | Train Loss: 1.489 Vali Loss: 1.406 Vali Acc: 0.319 Test Loss: 1.406 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.6195788383483887
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.307 Vali Acc: 0.399 Test Loss: 1.307 Test Acc: 0.399
Validation loss decreased (-0.318827 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 1.473336935043335
Epoch: 3, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
Validation loss decreased (-0.398538 --> -0.485496).  Saving model ...
Epoch: 4 cost time: 1.7367644309997559
Epoch: 4, Steps: 9 | Train Loss: 1.024 Vali Loss: 1.031 Vali Acc: 0.442 Test Loss: 1.031 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8633756637573242
Epoch: 5, Steps: 9 | Train Loss: 0.872 Vali Loss: 0.914 Vali Acc: 0.616 Test Loss: 0.914 Test Acc: 0.616
Validation loss decreased (-0.485496 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 1.5145201683044434
Epoch: 6, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.780 Vali Acc: 0.725 Test Loss: 0.780 Test Acc: 0.725
Validation loss decreased (-0.615933 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.588991641998291
Epoch: 7, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.699 Vali Acc: 0.739 Test Loss: 0.699 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 8 cost time: 1.4403629302978516
Epoch: 8, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.649 Vali Acc: 0.710 Test Loss: 0.649 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5830929279327393
Epoch: 9, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.624 Vali Acc: 0.696 Test Loss: 0.624 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5197949409484863
Epoch: 10, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6744816303253174
Epoch: 11, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.564 Vali Acc: 0.739 Test Loss: 0.564 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739125).  Saving model ...
Epoch: 12 cost time: 1.6530370712280273
Epoch: 12, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7459635734558105
Epoch: 13, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.532 Vali Acc: 0.804 Test Loss: 0.532 Test Acc: 0.804
Validation loss decreased (-0.739125 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 1.4856393337249756
Epoch: 14, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6953582763671875
Epoch: 15, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.504 Vali Acc: 0.812 Test Loss: 0.504 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 1.375143051147461
Epoch: 16, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5699522495269775
Epoch: 17, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.544 Vali Acc: 0.790 Test Loss: 0.544 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4750466346740723
Epoch: 18, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.811589 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.5672862529754639
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.395554542541504
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.3158085346221924
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 1.5925571918487549
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 1.5928826332092285
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6969404220581055
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6027393341064453
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.593296766281128
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 1.4262187480926514
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3465394973754883
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6085443496704102
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4971332550048828
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.624152421951294
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5806138515472412
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5171284675598145
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6613054275512695
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6158244609832764
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5402112007141113
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2118068
model size : 10.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8691582679748535
Epoch: 1, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.407 Vali Acc: 0.319 Test Loss: 1.407 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.518566370010376
Epoch: 2, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.313 Vali Acc: 0.341 Test Loss: 1.313 Test Acc: 0.341
Validation loss decreased (-0.318827 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 1.4596428871154785
Epoch: 3, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.168 Vali Acc: 0.594 Test Loss: 1.168 Test Acc: 0.594
Validation loss decreased (-0.340567 --> -0.594191).  Saving model ...
Epoch: 4 cost time: 1.6312780380249023
Epoch: 4, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.027 Vali Acc: 0.587 Test Loss: 1.027 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.474785566329956
Epoch: 5, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.904 Vali Acc: 0.659 Test Loss: 0.904 Test Acc: 0.659
Validation loss decreased (-0.594191 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 1.7834539413452148
Epoch: 6, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.840 Vali Acc: 0.667 Test Loss: 0.840 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.4525439739227295
Epoch: 7, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.815 Vali Acc: 0.674 Test Loss: 0.815 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.4086380004882812
Epoch: 8, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.752 Vali Acc: 0.667 Test Loss: 0.752 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5244355201721191
Epoch: 9, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.704 Vali Acc: 0.681 Test Loss: 0.704 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 1.4002513885498047
Epoch: 10, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.640 Vali Acc: 0.703 Test Loss: 0.640 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702892).  Saving model ...
Epoch: 11 cost time: 1.4388210773468018
Epoch: 11, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.621 Vali Acc: 0.710 Test Loss: 0.621 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710139).  Saving model ...
Epoch: 12 cost time: 1.677992582321167
Epoch: 12, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
Validation loss decreased (-0.710139 --> -0.746371).  Saving model ...
Epoch: 13 cost time: 1.5977694988250732
Epoch: 13, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 1.4993481636047363
Epoch: 14, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.582 Vali Acc: 0.754 Test Loss: 0.582 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.43682861328125
Epoch: 15, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.593 Vali Acc: 0.754 Test Loss: 0.593 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6042225360870361
Epoch: 16, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.560 Vali Acc: 0.768 Test Loss: 0.560 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.407654047012329
Epoch: 17, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.469 Vali Acc: 0.804 Test Loss: 0.469 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 18 cost time: 1.6919622421264648
Epoch: 18, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.486 Vali Acc: 0.797 Test Loss: 0.486 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6893200874328613
Epoch: 19, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
Validation loss decreased (-0.804343 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 1.5096161365509033
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.382 Vali Acc: 0.848 Test Loss: 0.382 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 1.4078466892242432
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4254744052886963
Epoch: 22, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.349 Vali Acc: 0.855 Test Loss: 0.349 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 23 cost time: 1.6418912410736084
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3422601222991943
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.324 Vali Acc: 0.870 Test Loss: 0.324 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 1.4169895648956299
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6625103950500488
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.337698221206665
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5202374458312988
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 1.198798656463623
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 30 cost time: 1.5242085456848145
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6690292358398438
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3852779865264893
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 33 cost time: 1.6042163372039795
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.666393518447876
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 35 cost time: 1.5241875648498535
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.488070011138916
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.728729009628296
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8146350383758545
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 39 cost time: 1.6723706722259521
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 1.2827730178833008
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6336591243743896
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 42 cost time: 1.3859484195709229
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2669599056243896
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 44 cost time: 1.4096317291259766
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.43684983253479
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 46 cost time: 1.4220824241638184
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.913 Test Loss: 0.304 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9111909866333008
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.680701732635498
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.6009254455566406
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.899 Test Loss: 0.334 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4607908725738525
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.560692548751831
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.485457181930542
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.9442903995513916
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.4725010395050049
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.770660161972046
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1415988
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.075360298156738
Epoch: 1, Steps: 9 | Train Loss: 1.626 Vali Loss: 1.449 Vali Acc: 0.196 Test Loss: 1.449 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 1.8439419269561768
Epoch: 2, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.393 Vali Acc: 0.319 Test Loss: 1.393 Test Acc: 0.319
Validation loss decreased (-0.195638 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.765427589416504
Epoch: 3, Steps: 9 | Train Loss: 1.309 Vali Loss: 1.216 Vali Acc: 0.507 Test Loss: 1.216 Test Acc: 0.507
Validation loss decreased (-0.318827 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 1.9068608283996582
Epoch: 4, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.096 Vali Acc: 0.565 Test Loss: 1.096 Test Acc: 0.565
Validation loss decreased (-0.507234 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 1.5263075828552246
Epoch: 5, Steps: 9 | Train Loss: 0.976 Vali Loss: 0.971 Vali Acc: 0.623 Test Loss: 0.971 Test Acc: 0.623
Validation loss decreased (-0.565206 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 1.3764445781707764
Epoch: 6, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.884 Vali Acc: 0.630 Test Loss: 0.884 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.4781503677368164
Epoch: 7, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.812 Vali Acc: 0.659 Test Loss: 0.812 Test Acc: 0.659
Validation loss decreased (-0.630426 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 1.4792399406433105
Epoch: 8, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.770 Vali Acc: 0.674 Test Loss: 0.770 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 1.5631802082061768
Epoch: 9, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.738 Vali Acc: 0.674 Test Loss: 0.738 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673906).  Saving model ...
Epoch: 10 cost time: 1.8732476234436035
Epoch: 10, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.682 Vali Acc: 0.681 Test Loss: 0.682 Test Acc: 0.681
Validation loss decreased (-0.673906 --> -0.681153).  Saving model ...
Epoch: 11 cost time: 1.6002264022827148
Epoch: 11, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.703 Vali Acc: 0.688 Test Loss: 0.703 Test Acc: 0.688
Validation loss decreased (-0.681153 --> -0.688399).  Saving model ...
Epoch: 12 cost time: 1.5408554077148438
Epoch: 12, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
Validation loss decreased (-0.688399 --> -0.717385).  Saving model ...
Epoch: 13 cost time: 1.4633750915527344
Epoch: 13, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.635 Vali Acc: 0.696 Test Loss: 0.635 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3262131214141846
Epoch: 14, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
Validation loss decreased (-0.717385 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 1.4145538806915283
Epoch: 15, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.743 Vali Acc: 0.609 Test Loss: 0.743 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4199938774108887
Epoch: 16, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6709744930267334
Epoch: 17, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.499 Vali Acc: 0.775 Test Loss: 0.499 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7499041557312012
Epoch: 18, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
Validation loss decreased (-0.797096 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.4583616256713867
Epoch: 19, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4280016422271729
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5639986991882324
Epoch: 21, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0670387744903564
Epoch: 22, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5819296836853027
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4695770740509033
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 1.580531358718872
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3701786994934082
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.733447790145874
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5681872367858887
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5442047119140625
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 30 cost time: 1.6197113990783691
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4700207710266113
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7827365398406982
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6479637622833252
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.967238426208496
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5911974906921387
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7135558128356934
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4344050884246826
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3968219757080078
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.897869348526001
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1413940
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9883294105529785
Epoch: 1, Steps: 9 | Train Loss: 1.541 Vali Loss: 1.452 Vali Acc: 0.203 Test Loss: 1.452 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 1.272752046585083
Epoch: 2, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.362 Vali Acc: 0.355 Test Loss: 1.362 Test Acc: 0.355
Validation loss decreased (-0.202884 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.3778598308563232
Epoch: 3, Steps: 9 | Train Loss: 1.260 Vali Loss: 1.234 Vali Acc: 0.377 Test Loss: 1.234 Test Acc: 0.377
Validation loss decreased (-0.355059 --> -0.376799).  Saving model ...
Epoch: 4 cost time: 1.3049812316894531
Epoch: 4, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.105 Vali Acc: 0.623 Test Loss: 1.105 Test Acc: 0.623
Validation loss decreased (-0.376799 --> -0.623177).  Saving model ...
Epoch: 5 cost time: 1.430344581604004
Epoch: 5, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.961 Vali Acc: 0.638 Test Loss: 0.961 Test Acc: 0.638
Validation loss decreased (-0.623177 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 1.5740983486175537
Epoch: 6, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.882 Vali Acc: 0.688 Test Loss: 0.882 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 1.8743796348571777
Epoch: 7, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.774 Vali Acc: 0.681 Test Loss: 0.774 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4406437873840332
Epoch: 8, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.767 Vali Acc: 0.638 Test Loss: 0.767 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3285651206970215
Epoch: 9, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.690 Vali Acc: 0.703 Test Loss: 0.690 Test Acc: 0.703
Validation loss decreased (-0.688397 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 1.2839560508728027
Epoch: 10, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.632 Vali Acc: 0.710 Test Loss: 0.632 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710139).  Saving model ...
Epoch: 11 cost time: 1.2448232173919678
Epoch: 11, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
Validation loss decreased (-0.710139 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.368682622909546
Epoch: 12, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
Validation loss decreased (-0.717385 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 1.2928574085235596
Epoch: 13, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.731878 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 1.457991600036621
Epoch: 14, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.511 Vali Acc: 0.790 Test Loss: 0.511 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 15 cost time: 1.4528179168701172
Epoch: 15, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 1.3562061786651611
Epoch: 16, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 1.4386608600616455
Epoch: 17, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4674758911132812
Epoch: 18, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.447 Vali Acc: 0.797 Test Loss: 0.447 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6956148147583008
Epoch: 19, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 20 cost time: 1.5049049854278564
Epoch: 20, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6139397621154785
Epoch: 21, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3768904209136963
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.377 Vali Acc: 0.848 Test Loss: 0.377 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4277889728546143
Epoch: 23, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.721595287322998
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 1.598165512084961
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5233607292175293
Epoch: 26, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.884 Test Loss: 0.358 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 1.3527600765228271
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5234956741333008
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5361638069152832
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.402 Vali Acc: 0.826 Test Loss: 0.402 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4111735820770264
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6456878185272217
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6775593757629395
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4970402717590332
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6433870792388916
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 35 cost time: 1.6892874240875244
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5549390316009521
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5357096195220947
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 38 cost time: 1.5995488166809082
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.927121639251709
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4731695652008057
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6962299346923828
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.085355281829834
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 43 cost time: 1.266080379486084
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7280337810516357
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4385936260223389
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6477634906768799
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.9130852222442627
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.476165533065796
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.4613587856292725
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4709339141845703
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.321174144744873
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.4644339084625244
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.899 Test Loss: 0.298 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 53 cost time: 1.5238125324249268
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.6665337085723877
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.5083696842193604
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.509894609451294
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.4040498733520508
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.5510776042938232
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.6372520923614502
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.5689022541046143
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.6478228569030762
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.884 Test Loss: 0.387 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.2857062816619873
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1411892
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.652536630630493
Epoch: 1, Steps: 9 | Train Loss: 1.497 Vali Loss: 1.404 Vali Acc: 0.239 Test Loss: 1.404 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.6652004718780518
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.338 Vali Acc: 0.275 Test Loss: 1.338 Test Acc: 0.275
Validation loss decreased (-0.239116 --> -0.275349).  Saving model ...
Epoch: 3 cost time: 1.5276341438293457
Epoch: 3, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.201 Vali Acc: 0.319 Test Loss: 1.201 Test Acc: 0.319
Validation loss decreased (-0.275349 --> -0.318829).  Saving model ...
Epoch: 4 cost time: 1.4483659267425537
Epoch: 4, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.045 Vali Acc: 0.623 Test Loss: 1.045 Test Acc: 0.623
Validation loss decreased (-0.318829 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 1.6130335330963135
Epoch: 5, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.933 Vali Acc: 0.594 Test Loss: 0.933 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7048766613006592
Epoch: 6, Steps: 9 | Train Loss: 0.772 Vali Loss: 0.852 Vali Acc: 0.652 Test Loss: 0.852 Test Acc: 0.652
Validation loss decreased (-0.623178 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 1.6459448337554932
Epoch: 7, Steps: 9 | Train Loss: 0.668 Vali Loss: 0.805 Vali Acc: 0.601 Test Loss: 0.805 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.581315279006958
Epoch: 8, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.652165 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 1.7292189598083496
Epoch: 9, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.675 Vali Acc: 0.703 Test Loss: 0.675 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.779329776763916
Epoch: 10, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.614 Vali Acc: 0.746 Test Loss: 0.614 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746371).  Saving model ...
Epoch: 11 cost time: 1.4633800983428955
Epoch: 11, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760864).  Saving model ...
Epoch: 12 cost time: 1.7064793109893799
Epoch: 12, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.545 Vali Acc: 0.768 Test Loss: 0.545 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 13 cost time: 1.430305004119873
Epoch: 13, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.768110 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.505206823348999
Epoch: 14, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5447561740875244
Epoch: 15, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.6159164905548096
Epoch: 16, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.568495750427246
Epoch: 17, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.520 Vali Acc: 0.797 Test Loss: 0.520 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8175199031829834
Epoch: 18, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.4684712886810303
Epoch: 19, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 1.5000593662261963
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.9808082580566406
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 1.4624710083007812
Epoch: 22, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.437 Vali Acc: 0.862 Test Loss: 0.437 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.725367784500122
Epoch: 23, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 1.457141399383545
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7841877937316895
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 26 cost time: 1.4459309577941895
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6433286666870117
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5471584796905518
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 29 cost time: 1.476552963256836
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5424542427062988
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4712345600128174
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.399 Vali Acc: 0.891 Test Loss: 0.399 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 32 cost time: 1.7072508335113525
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 33 cost time: 1.5772387981414795
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6628386974334717
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.369 Vali Acc: 0.899 Test Loss: 0.369 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 1.4242243766784668
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.913 Test Loss: 0.342 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 36 cost time: 1.4623992443084717
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8201313018798828
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5443594455718994
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.928 Test Loss: 0.322 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 39 cost time: 1.3042256832122803
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6177756786346436
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6423814296722412
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3906755447387695
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.552351951599121
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.675995111465454
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6575729846954346
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5022108554840088
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.447326898574829
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8451862335205078
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.891 Test Loss: 0.401 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 1409844
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1903645992279053
Epoch: 1, Steps: 9 | Train Loss: 1.483 Vali Loss: 1.430 Vali Acc: 0.261 Test Loss: 1.430 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 1.8476734161376953
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.336 Vali Acc: 0.312 Test Loss: 1.336 Test Acc: 0.312
Validation loss decreased (-0.260855 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 1.3687145709991455
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.223 Vali Acc: 0.478 Test Loss: 1.223 Test Acc: 0.478
Validation loss decreased (-0.311581 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 1.3752562999725342
Epoch: 4, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.100 Vali Acc: 0.529 Test Loss: 1.100 Test Acc: 0.529
Validation loss decreased (-0.478249 --> -0.528975).  Saving model ...
Epoch: 5 cost time: 1.291734218597412
Epoch: 5, Steps: 9 | Train Loss: 0.957 Vali Loss: 0.985 Vali Acc: 0.543 Test Loss: 0.985 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 6 cost time: 1.3505611419677734
Epoch: 6, Steps: 9 | Train Loss: 0.833 Vali Loss: 0.885 Vali Acc: 0.645 Test Loss: 0.885 Test Acc: 0.645
Validation loss decreased (-0.543468 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.3469531536102295
Epoch: 7, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.804 Vali Acc: 0.652 Test Loss: 0.804 Test Acc: 0.652
Validation loss decreased (-0.644919 --> -0.652166).  Saving model ...
Epoch: 8 cost time: 1.470494031906128
Epoch: 8, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.764 Vali Acc: 0.659 Test Loss: 0.764 Test Acc: 0.659
Validation loss decreased (-0.652166 --> -0.659413).  Saving model ...
Epoch: 9 cost time: 1.424818754196167
Epoch: 9, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.744 Vali Acc: 0.659 Test Loss: 0.744 Test Acc: 0.659
Validation loss decreased (-0.659413 --> -0.659413).  Saving model ...
Epoch: 10 cost time: 1.5378913879394531
Epoch: 10, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.698 Vali Acc: 0.703 Test Loss: 0.698 Test Acc: 0.703
Validation loss decreased (-0.659413 --> -0.702892).  Saving model ...
Epoch: 11 cost time: 1.4784483909606934
Epoch: 11, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.663 Vali Acc: 0.674 Test Loss: 0.663 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3337440490722656
Epoch: 12, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.628 Vali Acc: 0.710 Test Loss: 0.628 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710139).  Saving model ...
Epoch: 13 cost time: 1.272857427597046
Epoch: 13, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
Validation loss decreased (-0.710139 --> -0.768110).  Saving model ...
Epoch: 14 cost time: 1.526810884475708
Epoch: 14, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.554 Vali Acc: 0.761 Test Loss: 0.554 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5923268795013428
Epoch: 15, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.504 Vali Acc: 0.804 Test Loss: 0.504 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 1.6400461196899414
Epoch: 16, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.561 Vali Acc: 0.761 Test Loss: 0.561 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.449695110321045
Epoch: 17, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.527 Vali Acc: 0.754 Test Loss: 0.527 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6565821170806885
Epoch: 18, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.472 Vali Acc: 0.790 Test Loss: 0.472 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7011451721191406
Epoch: 19, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 20 cost time: 1.483361005783081
Epoch: 20, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.428 Vali Acc: 0.819 Test Loss: 0.428 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 21 cost time: 1.662942886352539
Epoch: 21, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.471 Vali Acc: 0.812 Test Loss: 0.471 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6112060546875
Epoch: 22, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 1.452829360961914
Epoch: 23, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5442314147949219
Epoch: 24, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 1.5717799663543701
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.7088279724121094
Epoch: 26, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 1.6210227012634277
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.430 Vali Acc: 0.819 Test Loss: 0.430 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7291254997253418
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5862488746643066
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5224452018737793
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4555726051330566
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 1.4269309043884277
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.848 Test Loss: 0.399 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4320380687713623
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5085296630859375
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.382 Vali Acc: 0.848 Test Loss: 0.382 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.438713788986206
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 36 cost time: 1.3740670680999756
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 37 cost time: 1.5540344715118408
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.429 Vali Acc: 0.870 Test Loss: 0.429 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 1.4153859615325928
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 39 cost time: 1.4713718891143799
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.354668140411377
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6484348773956299
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6797888278961182
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4739491939544678
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.535 Vali Acc: 0.848 Test Loss: 0.535 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.56870436668396
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 45 cost time: 1.344883680343628
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4800941944122314
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4934303760528564
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3552181720733643
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.9234082698822021
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.7137823104858398
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.9369194507598877
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4864771366119385
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.8117554187774658
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.7772634029388428
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 953652
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6215426921844482
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.432 Vali Acc: 0.217 Test Loss: 1.432 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 1.3383450508117676
Epoch: 2, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.370 Vali Acc: 0.319 Test Loss: 1.370 Test Acc: 0.319
Validation loss decreased (-0.217377 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.3419756889343262
Epoch: 3, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.221 Vali Acc: 0.529 Test Loss: 1.221 Test Acc: 0.529
Validation loss decreased (-0.318827 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 1.2193284034729004
Epoch: 4, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4587626457214355
Epoch: 5, Steps: 9 | Train Loss: 0.907 Vali Loss: 0.952 Vali Acc: 0.601 Test Loss: 0.952 Test Acc: 0.601
Validation loss decreased (-0.528973 --> -0.601440).  Saving model ...
Epoch: 6 cost time: 1.4075489044189453
Epoch: 6, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.852 Vali Acc: 0.652 Test Loss: 0.852 Test Acc: 0.652
Validation loss decreased (-0.601440 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 1.3219506740570068
Epoch: 7, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.814 Vali Acc: 0.674 Test Loss: 0.814 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.3132359981536865
Epoch: 8, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.765 Vali Acc: 0.652 Test Loss: 0.765 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3697857856750488
Epoch: 9, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.728 Vali Acc: 0.703 Test Loss: 0.728 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.224135398864746
Epoch: 10, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.653 Vali Acc: 0.710 Test Loss: 0.653 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 11 cost time: 1.533473253250122
Epoch: 11, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.663 Vali Acc: 0.739 Test Loss: 0.663 Test Acc: 0.739
Validation loss decreased (-0.710138 --> -0.739124).  Saving model ...
Epoch: 12 cost time: 1.4529447555541992
Epoch: 12, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.623 Vali Acc: 0.710 Test Loss: 0.623 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5395739078521729
Epoch: 13, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
Validation loss decreased (-0.739124 --> -0.789849).  Saving model ...
Epoch: 14 cost time: 1.314969539642334
Epoch: 14, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3713726997375488
Epoch: 15, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.545 Vali Acc: 0.761 Test Loss: 0.545 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5082967281341553
Epoch: 16, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.493 Vali Acc: 0.790 Test Loss: 0.493 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 1.4828176498413086
Epoch: 17, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.452 Vali Acc: 0.812 Test Loss: 0.452 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811590).  Saving model ...
Epoch: 18 cost time: 1.4190170764923096
Epoch: 18, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.566 Vali Acc: 0.768 Test Loss: 0.566 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9245290756225586
Epoch: 19, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.468 Vali Acc: 0.783 Test Loss: 0.468 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7184672355651855
Epoch: 20, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
Validation loss decreased (-0.811590 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 1.578209400177002
Epoch: 21, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4404723644256592
Epoch: 22, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.423 Vali Acc: 0.804 Test Loss: 0.423 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4510111808776855
Epoch: 23, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5827789306640625
Epoch: 24, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 1.7288758754730225
Epoch: 25, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7206323146820068
Epoch: 26, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6244003772735596
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3572866916656494
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 1.3582477569580078
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 1.5014231204986572
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5619492530822754
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.337 Vali Acc: 0.862 Test Loss: 0.337 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.692213535308838
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.410 Vali Acc: 0.862 Test Loss: 0.410 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5045166015625
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5325417518615723
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5506680011749268
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4539968967437744
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3772237300872803
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.5925395488739014
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7065472602844238
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 1.5883865356445312
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7233030796051025
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5138509273529053
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6958560943603516
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 44 cost time: 1.532979965209961
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6905450820922852
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6290419101715088
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 47 cost time: 1.416822910308838
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.521242380142212
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.870 Test Loss: 0.347 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5305454730987549
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.271622896194458
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.4054737091064453
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 52 cost time: 1.5782191753387451
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5611672401428223
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.4179201126098633
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2976248264312744
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.877 Test Loss: 0.391 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.382707118988037
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.6298246383666992
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.3276290893554688
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 59 cost time: 1.4245340824127197
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.5092394351959229
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.4930872917175293
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.558168649673462
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 63 cost time: 1.298241138458252
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.343045711517334
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.4266235828399658
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 66 cost time: 1.5138134956359863
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.6022169589996338
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.4522407054901123
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.7107601165771484
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.3460958003997803
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.891 Test Loss: 0.336 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.4479808807373047
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 72 cost time: 1.2454266548156738
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.3888487815856934
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.217452049255371
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.424384355545044
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.899 Test Loss: 0.353 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.5150303840637207
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 77 cost time: 1.3758585453033447
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.4410951137542725
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.3580231666564941
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.2998507022857666
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.535750389099121
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.7384231090545654
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.6286308765411377
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.400972604751587
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.3780176639556885
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.899 Test Loss: 0.354 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.323561429977417
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 951604
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3758394718170166
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.334 Vali Acc: 0.377 Test Loss: 1.334 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 1.440666913986206
Epoch: 2, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.284 Vali Acc: 0.319 Test Loss: 1.284 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5175542831420898
Epoch: 3, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.185 Vali Acc: 0.522 Test Loss: 1.185 Test Acc: 0.522
Validation loss decreased (-0.376798 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.4635040760040283
Epoch: 4, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.107 Vali Acc: 0.529 Test Loss: 1.107 Test Acc: 0.529
Validation loss decreased (-0.521727 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 1.4640750885009766
Epoch: 5, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.022 Vali Acc: 0.471 Test Loss: 1.022 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.492307186126709
Epoch: 6, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.894 Vali Acc: 0.623 Test Loss: 0.894 Test Acc: 0.623
Validation loss decreased (-0.528974 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 1.6451430320739746
Epoch: 7, Steps: 9 | Train Loss: 0.736 Vali Loss: 0.796 Vali Acc: 0.674 Test Loss: 0.796 Test Acc: 0.674
Validation loss decreased (-0.623179 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.4171655178070068
Epoch: 8, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.762 Vali Acc: 0.696 Test Loss: 0.762 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.5217034816741943
Epoch: 9, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.715 Vali Acc: 0.645 Test Loss: 0.715 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8207616806030273
Epoch: 10, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.648 Vali Acc: 0.710 Test Loss: 0.648 Test Acc: 0.710
Validation loss decreased (-0.695645 --> -0.710138).  Saving model ...
Epoch: 11 cost time: 1.7615556716918945
Epoch: 11, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.620 Vali Acc: 0.717 Test Loss: 0.620 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.8816263675689697
Epoch: 12, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.579 Vali Acc: 0.754 Test Loss: 0.579 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 1.2670917510986328
Epoch: 13, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 1.3764283657073975
Epoch: 14, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.5042765140533447
Epoch: 15, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782604).  Saving model ...
Epoch: 16 cost time: 1.5476253032684326
Epoch: 16, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
Validation loss decreased (-0.782604 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 1.5003056526184082
Epoch: 17, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.436 Vali Acc: 0.819 Test Loss: 0.436 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7182483673095703
Epoch: 18, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 1.3887805938720703
Epoch: 19, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 1.514472246170044
Epoch: 20, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.426180362701416
Epoch: 21, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 1.6470322608947754
Epoch: 22, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6666896343231201
Epoch: 23, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.129786491394043
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.336 Vali Acc: 0.891 Test Loss: 0.336 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 1.6602799892425537
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5041487216949463
Epoch: 26, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4281926155090332
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4996771812438965
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.82961106300354
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 30 cost time: 1.6494276523590088
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5973076820373535
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6328301429748535
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6557061672210693
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.719261646270752
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6557233333587646
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.355 Vali Acc: 0.891 Test Loss: 0.355 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8709824085235596
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 37 cost time: 1.5100460052490234
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5546510219573975
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 39 cost time: 1.7870573997497559
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.870 Test Loss: 0.326 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4983274936676025
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 41 cost time: 1.6828513145446777
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.811532974243164
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6235063076019287
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.899 Test Loss: 0.326 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5308849811553955
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4512979984283447
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
Validation loss decreased (-0.905795 --> -0.927534).  Saving model ...
Epoch: 46 cost time: 1.3688938617706299
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4933791160583496
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7471399307250977
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.6506226062774658
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.899 Test Loss: 0.287 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.5809125900268555
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.6557958126068115
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.6611521244049072
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.8158395290374756
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.5739216804504395
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.6218442916870117
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.899 Test Loss: 0.319 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 949556
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2505898475646973
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.237901210784912
Epoch: 2, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.286 Vali Acc: 0.471 Test Loss: 1.286 Test Acc: 0.471
Validation loss decreased (-0.297088 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 1.9376420974731445
Epoch: 3, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.471002 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 1.5368025302886963
Epoch: 4, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.051 Vali Acc: 0.580 Test Loss: 1.051 Test Acc: 0.580
Validation loss decreased (-0.514481 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 1.3745942115783691
Epoch: 5, Steps: 9 | Train Loss: 0.995 Vali Loss: 0.971 Vali Acc: 0.558 Test Loss: 0.971 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3588387966156006
Epoch: 6, Steps: 9 | Train Loss: 0.821 Vali Loss: 0.885 Vali Acc: 0.645 Test Loss: 0.885 Test Acc: 0.645
Validation loss decreased (-0.579700 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.5404019355773926
Epoch: 7, Steps: 9 | Train Loss: 0.716 Vali Loss: 0.792 Vali Acc: 0.667 Test Loss: 0.792 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.575204849243164
Epoch: 8, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.719 Vali Acc: 0.710 Test Loss: 0.719 Test Acc: 0.710
Validation loss decreased (-0.666659 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 1.93149733543396
Epoch: 9, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.691 Vali Acc: 0.696 Test Loss: 0.691 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.469550371170044
Epoch: 10, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.668 Vali Acc: 0.681 Test Loss: 0.668 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5387177467346191
Epoch: 11, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.596 Vali Acc: 0.725 Test Loss: 0.596 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724632).  Saving model ...
Epoch: 12 cost time: 1.3900575637817383
Epoch: 12, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
Validation loss decreased (-0.724632 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 1.454502820968628
Epoch: 13, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.523 Vali Acc: 0.768 Test Loss: 0.523 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7145297527313232
Epoch: 14, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7514476776123047
Epoch: 15, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 1.4229412078857422
Epoch: 16, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.541 Vali Acc: 0.790 Test Loss: 0.541 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4422435760498047
Epoch: 17, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.435 Vali Acc: 0.826 Test Loss: 0.435 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826083).  Saving model ...
Epoch: 18 cost time: 1.484112024307251
Epoch: 18, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.4622013568878174
Epoch: 19, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4804103374481201
Epoch: 20, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.444 Vali Acc: 0.819 Test Loss: 0.444 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.791898250579834
Epoch: 21, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6607306003570557
Epoch: 22, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 23 cost time: 1.7510459423065186
Epoch: 23, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4461934566497803
Epoch: 24, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4368422031402588
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4177696704864502
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4875295162200928
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6783154010772705
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9045302867889404
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5586464405059814
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4845824241638184
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4569344520568848
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 947508
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.348590135574341
Epoch: 1, Steps: 9 | Train Loss: 1.665 Vali Loss: 1.534 Vali Acc: 0.261 Test Loss: 1.534 Test Acc: 0.261
Validation loss decreased (inf --> -0.260854).  Saving model ...
Epoch: 2 cost time: 1.3278825283050537
Epoch: 2, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.437 Vali Acc: 0.304 Test Loss: 1.437 Test Acc: 0.304
Validation loss decreased (-0.260854 --> -0.304333).  Saving model ...
Epoch: 3 cost time: 1.5497407913208008
Epoch: 3, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.313 Vali Acc: 0.413 Test Loss: 1.313 Test Acc: 0.413
Validation loss decreased (-0.304333 --> -0.413030).  Saving model ...
Epoch: 4 cost time: 1.2703192234039307
Epoch: 4, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.240 Vali Acc: 0.370 Test Loss: 1.240 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4160311222076416
Epoch: 5, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.102 Vali Acc: 0.551 Test Loss: 1.102 Test Acc: 0.551
Validation loss decreased (-0.413030 --> -0.550714).  Saving model ...
Epoch: 6 cost time: 1.3600878715515137
Epoch: 6, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.981 Vali Acc: 0.594 Test Loss: 0.981 Test Acc: 0.594
Validation loss decreased (-0.550714 --> -0.594193).  Saving model ...
Epoch: 7 cost time: 1.202038288116455
Epoch: 7, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.869 Vali Acc: 0.674 Test Loss: 0.869 Test Acc: 0.674
Validation loss decreased (-0.594193 --> -0.673904).  Saving model ...
Epoch: 8 cost time: 1.2029438018798828
Epoch: 8, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.780 Vali Acc: 0.703 Test Loss: 0.780 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702891).  Saving model ...
Epoch: 9 cost time: 1.3873920440673828
Epoch: 9, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.719 Vali Acc: 0.703 Test Loss: 0.719 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.3640191555023193
Epoch: 10, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.403728723526001
Epoch: 11, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.674 Vali Acc: 0.667 Test Loss: 0.674 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2825126647949219
Epoch: 12, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.603 Vali Acc: 0.754 Test Loss: 0.603 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 1.3990552425384521
Epoch: 13, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.602 Vali Acc: 0.761 Test Loss: 0.602 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 14 cost time: 1.3185036182403564
Epoch: 14, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.567 Vali Acc: 0.739 Test Loss: 0.567 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4567160606384277
Epoch: 15, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.509 Vali Acc: 0.804 Test Loss: 0.509 Test Acc: 0.804
Validation loss decreased (-0.760864 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 1.3636894226074219
Epoch: 16, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.573951005935669
Epoch: 17, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.503 Vali Acc: 0.797 Test Loss: 0.503 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4819080829620361
Epoch: 18, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.535 Vali Acc: 0.804 Test Loss: 0.535 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5505106449127197
Epoch: 19, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 20 cost time: 1.3775262832641602
Epoch: 20, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.513 Vali Acc: 0.812 Test Loss: 0.513 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4300951957702637
Epoch: 21, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 1.721907377243042
Epoch: 22, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.812 Test Loss: 0.511 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5418460369110107
Epoch: 23, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 1.4873449802398682
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.454 Vali Acc: 0.797 Test Loss: 0.454 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5447800159454346
Epoch: 25, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 1.5657804012298584
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.504 Vali Acc: 0.804 Test Loss: 0.504 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4575598239898682
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4725990295410156
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.315814733505249
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4526879787445068
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.559692144393921
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3006627559661865
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7873435020446777
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.642 Vali Acc: 0.725 Test Loss: 0.642 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5607354640960693
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.614501714706421
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.797 Test Loss: 0.694 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 722484
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4351413249969482
Epoch: 1, Steps: 9 | Train Loss: 1.494 Vali Loss: 1.415 Vali Acc: 0.254 Test Loss: 1.415 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.5334808826446533
Epoch: 2, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.394 Vali Acc: 0.319 Test Loss: 1.394 Test Acc: 0.319
Validation loss decreased (-0.253609 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.5098140239715576
Epoch: 3, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.309 Vali Acc: 0.362 Test Loss: 1.309 Test Acc: 0.362
Validation loss decreased (-0.318827 --> -0.362306).  Saving model ...
Epoch: 4 cost time: 1.552485466003418
Epoch: 4, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.362306 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.622032880783081
Epoch: 5, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.151 Vali Acc: 0.442 Test Loss: 1.151 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.730085849761963
Epoch: 6, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.020 Vali Acc: 0.587 Test Loss: 1.020 Test Acc: 0.587
Validation loss decreased (-0.499988 --> -0.586946).  Saving model ...
Epoch: 7 cost time: 1.4957385063171387
Epoch: 7, Steps: 9 | Train Loss: 0.896 Vali Loss: 0.947 Vali Acc: 0.565 Test Loss: 0.947 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4765512943267822
Epoch: 8, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.871 Vali Acc: 0.652 Test Loss: 0.871 Test Acc: 0.652
Validation loss decreased (-0.586946 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 1.4455971717834473
Epoch: 9, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.789 Vali Acc: 0.681 Test Loss: 0.789 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 1.4981508255004883
Epoch: 10, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 1.3491237163543701
Epoch: 11, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.731 Vali Acc: 0.674 Test Loss: 0.731 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4400160312652588
Epoch: 12, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.711 Vali Acc: 0.710 Test Loss: 0.711 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6266040802001953
Epoch: 13, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.644 Vali Acc: 0.717 Test Loss: 0.644 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 14 cost time: 1.4315879344940186
Epoch: 14, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.588 Vali Acc: 0.768 Test Loss: 0.588 Test Acc: 0.768
Validation loss decreased (-0.717385 --> -0.768110).  Saving model ...
Epoch: 15 cost time: 1.279430627822876
Epoch: 15, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.578 Vali Acc: 0.768 Test Loss: 0.578 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 16 cost time: 1.5575132369995117
Epoch: 16, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.555 Vali Acc: 0.790 Test Loss: 0.555 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 1.460414171218872
Epoch: 17, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4785940647125244
Epoch: 18, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.549 Vali Acc: 0.790 Test Loss: 0.549 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.5487260818481445
Epoch: 19, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.450 Vali Acc: 0.812 Test Loss: 0.450 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811590).  Saving model ...
Epoch: 20 cost time: 1.3644168376922607
Epoch: 20, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.503 Vali Acc: 0.790 Test Loss: 0.503 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.391359567642212
Epoch: 21, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.480 Vali Acc: 0.812 Test Loss: 0.480 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5199649333953857
Epoch: 22, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.445 Vali Acc: 0.797 Test Loss: 0.445 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.646895408630371
Epoch: 23, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
Validation loss decreased (-0.811590 --> -0.840576).  Saving model ...
Epoch: 24 cost time: 1.7430331707000732
Epoch: 24, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5967795848846436
Epoch: 25, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.386 Vali Acc: 0.819 Test Loss: 0.386 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4094858169555664
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
Validation loss decreased (-0.840576 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 1.6656851768493652
Epoch: 27, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5419471263885498
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.383 Vali Acc: 0.877 Test Loss: 0.383 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 1.5479562282562256
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4692623615264893
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.832275152206421
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.485090732574463
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5861940383911133
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 34 cost time: 1.426560401916504
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5408177375793457
Epoch: 35, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4688196182250977
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9016146659851074
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.7009735107421875
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6935038566589355
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6076078414916992
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.358 Vali Acc: 0.899 Test Loss: 0.358 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 41 cost time: 1.4725048542022705
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4010412693023682
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.52927827835083
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.899 Test Loss: 0.384 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8035485744476318
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.899 Test Loss: 0.382 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4930195808410645
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.557831048965454
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 47 cost time: 1.4729046821594238
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.899 Test Loss: 0.371 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4629805088043213
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5068001747131348
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.354 Vali Acc: 0.899 Test Loss: 0.354 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2053115367889404
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.4975674152374268
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.386 Vali Acc: 0.899 Test Loss: 0.386 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.5451774597167969
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 53 cost time: 1.379460334777832
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5694241523742676
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.906 Test Loss: 0.366 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3523037433624268
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.334735631942749
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.899 Test Loss: 0.369 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.5616600513458252
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.3367068767547607
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.6386995315551758
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.5800318717956543
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.899 Test Loss: 0.371 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.4451930522918701
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.4543354511260986
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 720436
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8630850315093994
Epoch: 1, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.375 Vali Acc: 0.232 Test Loss: 1.375 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.703214406967163
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.314 Vali Acc: 0.391 Test Loss: 1.314 Test Acc: 0.391
Validation loss decreased (-0.231870 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.3947885036468506
Epoch: 3, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.245 Vali Acc: 0.406 Test Loss: 1.245 Test Acc: 0.406
Validation loss decreased (-0.391291 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 1.5146701335906982
Epoch: 4, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.159 Vali Acc: 0.457 Test Loss: 1.159 Test Acc: 0.457
Validation loss decreased (-0.405785 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 1.537219762802124
Epoch: 5, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.064 Vali Acc: 0.536 Test Loss: 1.064 Test Acc: 0.536
Validation loss decreased (-0.456510 --> -0.536221).  Saving model ...
Epoch: 6 cost time: 1.9809188842773438
Epoch: 6, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.954 Vali Acc: 0.601 Test Loss: 0.954 Test Acc: 0.601
Validation loss decreased (-0.536221 --> -0.601440).  Saving model ...
Epoch: 7 cost time: 1.9328932762145996
Epoch: 7, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.864 Vali Acc: 0.659 Test Loss: 0.864 Test Acc: 0.659
Validation loss decreased (-0.601440 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 1.3649559020996094
Epoch: 8, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.800 Vali Acc: 0.696 Test Loss: 0.800 Test Acc: 0.696
Validation loss decreased (-0.659412 --> -0.695644).  Saving model ...
Epoch: 9 cost time: 1.5835750102996826
Epoch: 9, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.782 Vali Acc: 0.652 Test Loss: 0.782 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6777372360229492
Epoch: 10, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.755 Vali Acc: 0.659 Test Loss: 0.755 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6323320865631104
Epoch: 11, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.744 Vali Acc: 0.645 Test Loss: 0.744 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.568613052368164
Epoch: 12, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.682 Vali Acc: 0.674 Test Loss: 0.682 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7975149154663086
Epoch: 13, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.704 Vali Acc: 0.696 Test Loss: 0.704 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695645).  Saving model ...
Epoch: 14 cost time: 1.8837220668792725
Epoch: 14, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.616 Vali Acc: 0.725 Test Loss: 0.616 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724632).  Saving model ...
Epoch: 15 cost time: 1.2822957038879395
Epoch: 15, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
Validation loss decreased (-0.724632 --> -0.731878).  Saving model ...
Epoch: 16 cost time: 1.4875974655151367
Epoch: 16, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.571 Vali Acc: 0.761 Test Loss: 0.571 Test Acc: 0.761
Validation loss decreased (-0.731878 --> -0.760864).  Saving model ...
Epoch: 17 cost time: 1.5307180881500244
Epoch: 17, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.527 Vali Acc: 0.790 Test Loss: 0.527 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789850).  Saving model ...
Epoch: 18 cost time: 1.6428487300872803
Epoch: 18, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.584 Vali Acc: 0.754 Test Loss: 0.584 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5931568145751953
Epoch: 19, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.502 Vali Acc: 0.790 Test Loss: 0.502 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 20 cost time: 1.6580195426940918
Epoch: 20, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6337604522705078
Epoch: 21, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 1.4908201694488525
Epoch: 22, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 1.5223360061645508
Epoch: 23, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5460405349731445
Epoch: 24, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6157755851745605
Epoch: 25, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.6190052032470703
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.429 Vali Acc: 0.841 Test Loss: 0.429 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 1.382148027420044
Epoch: 27, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855069).  Saving model ...
Epoch: 28 cost time: 1.410672903060913
Epoch: 28, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.855 Test Loss: 0.371 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 29 cost time: 1.318150281906128
Epoch: 29, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6755306720733643
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9516057968139648
Epoch: 31, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4981622695922852
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 33 cost time: 1.5706720352172852
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4729218482971191
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3825197219848633
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4300775527954102
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 1.4367637634277344
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 1.6512107849121094
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 39 cost time: 1.5330586433410645
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.672544240951538
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.645056962966919
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.532318353652954
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.530522346496582
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6088447570800781
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6191895008087158
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4607837200164795
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.4767382144927979
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.701904296875
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 718388
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5636422634124756
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.377 Vali Acc: 0.312 Test Loss: 1.377 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.3684101104736328
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (-0.311580 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.219569444656372
Epoch: 3, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.249 Vali Acc: 0.449 Test Loss: 1.249 Test Acc: 0.449
Validation loss decreased (-0.355059 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 1.3370423316955566
Epoch: 4, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.166 Vali Acc: 0.471 Test Loss: 1.166 Test Acc: 0.471
Validation loss decreased (-0.449263 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 1.398045539855957
Epoch: 5, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.079 Vali Acc: 0.543 Test Loss: 1.079 Test Acc: 0.543
Validation loss decreased (-0.471003 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 1.5653367042541504
Epoch: 6, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.978 Vali Acc: 0.623 Test Loss: 0.978 Test Acc: 0.623
Validation loss decreased (-0.543467 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 1.337709665298462
Epoch: 7, Steps: 9 | Train Loss: 0.847 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.623179 --> -0.724629).  Saving model ...
Epoch: 8 cost time: 1.5245819091796875
Epoch: 8, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.791 Vali Acc: 0.710 Test Loss: 0.791 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4358599185943604
Epoch: 9, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.743 Vali Acc: 0.725 Test Loss: 0.743 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 1.173003911972046
Epoch: 10, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.686 Vali Acc: 0.710 Test Loss: 0.686 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3056526184082031
Epoch: 11, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.669 Vali Acc: 0.703 Test Loss: 0.669 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5325322151184082
Epoch: 12, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.612 Vali Acc: 0.725 Test Loss: 0.612 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724632).  Saving model ...
Epoch: 13 cost time: 1.2563936710357666
Epoch: 13, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.589 Vali Acc: 0.754 Test Loss: 0.589 Test Acc: 0.754
Validation loss decreased (-0.724632 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.432774543762207
Epoch: 14, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.4503021240234375
Epoch: 15, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.548 Vali Acc: 0.768 Test Loss: 0.548 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.631094217300415
Epoch: 16, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.509 Vali Acc: 0.775 Test Loss: 0.509 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4013473987579346
Epoch: 17, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811590).  Saving model ...
Epoch: 18 cost time: 1.189227819442749
Epoch: 18, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
Validation loss decreased (-0.811590 --> -0.811590).  Saving model ...
Epoch: 19 cost time: 1.4233884811401367
Epoch: 19, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.436 Vali Acc: 0.812 Test Loss: 0.436 Test Acc: 0.812
Validation loss decreased (-0.811590 --> -0.811590).  Saving model ...
Epoch: 20 cost time: 1.4735283851623535
Epoch: 20, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826083).  Saving model ...
Epoch: 21 cost time: 1.6932470798492432
Epoch: 21, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4522931575775146
Epoch: 22, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
Validation loss decreased (-0.826083 --> -0.869562).  Saving model ...
Epoch: 23 cost time: 1.3877441883087158
Epoch: 23, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2975213527679443
Epoch: 24, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3457958698272705
Epoch: 25, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 26 cost time: 1.2737741470336914
Epoch: 26, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7225191593170166
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3167362213134766
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2936193943023682
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 1.6462936401367188
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7721433639526367
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6525347232818604
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 33 cost time: 1.375495195388794
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 34 cost time: 1.5742096900939941
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8120243549346924
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3827474117279053
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 37 cost time: 1.620694875717163
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7859477996826172
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5114672183990479
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.713158369064331
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7823879718780518
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4898629188537598
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4655685424804688
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4685604572296143
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.7739157676696777
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.5897819995880127
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 716340
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.471125364303589
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.477 Vali Acc: 0.297 Test Loss: 1.477 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 1.5768451690673828
Epoch: 2, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6713833808898926
Epoch: 3, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.331 Vali Acc: 0.370 Test Loss: 1.331 Test Acc: 0.370
Validation loss decreased (-0.297087 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 1.789595365524292
Epoch: 4, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.256 Vali Acc: 0.442 Test Loss: 1.256 Test Acc: 0.442
Validation loss decreased (-0.369552 --> -0.442016).  Saving model ...
Epoch: 5 cost time: 1.643763542175293
Epoch: 5, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.186 Vali Acc: 0.435 Test Loss: 1.186 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3854832649230957
Epoch: 6, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.097 Vali Acc: 0.507 Test Loss: 1.097 Test Acc: 0.507
Validation loss decreased (-0.442016 --> -0.507235).  Saving model ...
Epoch: 7 cost time: 1.6232094764709473
Epoch: 7, Steps: 9 | Train Loss: 0.902 Vali Loss: 0.982 Vali Acc: 0.616 Test Loss: 0.982 Test Acc: 0.616
Validation loss decreased (-0.507235 --> -0.615932).  Saving model ...
Epoch: 8 cost time: 1.9498112201690674
Epoch: 8, Steps: 9 | Train Loss: 0.831 Vali Loss: 0.900 Vali Acc: 0.616 Test Loss: 0.900 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615933).  Saving model ...
Epoch: 9 cost time: 1.4776768684387207
Epoch: 9, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
Validation loss decreased (-0.615933 --> -0.717383).  Saving model ...
Epoch: 10 cost time: 1.5977349281311035
Epoch: 10, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.737 Vali Acc: 0.688 Test Loss: 0.737 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7427520751953125
Epoch: 11, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.716 Vali Acc: 0.703 Test Loss: 0.716 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6024761199951172
Epoch: 12, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.682 Vali Acc: 0.696 Test Loss: 0.682 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4136111736297607
Epoch: 13, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.614 Vali Acc: 0.739 Test Loss: 0.614 Test Acc: 0.739
Validation loss decreased (-0.717383 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 1.359344482421875
Epoch: 14, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4149208068847656
Epoch: 15, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.584 Vali Acc: 0.754 Test Loss: 0.584 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 1.7876660823822021
Epoch: 16, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.540 Vali Acc: 0.754 Test Loss: 0.540 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753618).  Saving model ...
Epoch: 17 cost time: 1.5179400444030762
Epoch: 17, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
Validation loss decreased (-0.753618 --> -0.760864).  Saving model ...
Epoch: 18 cost time: 1.5570623874664307
Epoch: 18, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.557 Vali Acc: 0.754 Test Loss: 0.557 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9236106872558594
Epoch: 19, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
Validation loss decreased (-0.760864 --> -0.818836).  Saving model ...
Epoch: 20 cost time: 1.414327621459961
Epoch: 20, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.542 Vali Acc: 0.797 Test Loss: 0.542 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6423413753509521
Epoch: 21, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 1.7549941539764404
Epoch: 22, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.509 Vali Acc: 0.804 Test Loss: 0.509 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.638369083404541
Epoch: 23, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 1.291776180267334
Epoch: 24, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8711352348327637
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4033117294311523
Epoch: 26, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 27 cost time: 1.6163005828857422
Epoch: 27, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.400 Vali Acc: 0.870 Test Loss: 0.400 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5912046432495117
Epoch: 28, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5540251731872559
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.616682767868042
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 1.3978033065795898
Epoch: 31, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6578748226165771
Epoch: 32, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.386 Vali Acc: 0.891 Test Loss: 0.386 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 33 cost time: 1.695544958114624
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5727100372314453
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6492276191711426
Epoch: 35, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6238269805908203
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.412 Vali Acc: 0.891 Test Loss: 0.412 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.597238302230835
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.516 Vali Acc: 0.884 Test Loss: 0.516 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2834584712982178
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.372 Vali Acc: 0.899 Test Loss: 0.372 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 39 cost time: 1.7357654571533203
Epoch: 39, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.503 Vali Acc: 0.884 Test Loss: 0.503 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.68088698387146
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.375 Vali Acc: 0.913 Test Loss: 0.375 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 41 cost time: 1.5495901107788086
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.455 Vali Acc: 0.884 Test Loss: 0.455 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7418432235717773
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8297600746154785
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3357300758361816
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6144580841064453
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5798966884613037
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.891 Test Loss: 0.434 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.7557499408721924
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.410 Vali Acc: 0.906 Test Loss: 0.410 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5419962406158447
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.489 Vali Acc: 0.891 Test Loss: 0.489 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3682351112365723
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.7289974689483643
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.382 Vali Acc: 0.913 Test Loss: 0.382 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 606900
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.21772837638855
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.413 Vali Acc: 0.203 Test Loss: 1.413 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 1.3900134563446045
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.387 Vali Acc: 0.290 Test Loss: 1.387 Test Acc: 0.290
Validation loss decreased (-0.202884 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 1.7127628326416016
Epoch: 3, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.320 Vali Acc: 0.319 Test Loss: 1.320 Test Acc: 0.319
Validation loss decreased (-0.289841 --> -0.318827).  Saving model ...
Epoch: 4 cost time: 2.117121696472168
Epoch: 4, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.241 Vali Acc: 0.355 Test Loss: 1.241 Test Acc: 0.355
Validation loss decreased (-0.318827 --> -0.355060).  Saving model ...
Epoch: 5 cost time: 1.532552719116211
Epoch: 5, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.178 Vali Acc: 0.522 Test Loss: 1.178 Test Acc: 0.522
Validation loss decreased (-0.355060 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 1.4996483325958252
Epoch: 6, Steps: 9 | Train Loss: 0.983 Vali Loss: 1.058 Vali Acc: 0.529 Test Loss: 1.058 Test Acc: 0.529
Validation loss decreased (-0.521727 --> -0.528975).  Saving model ...
Epoch: 7 cost time: 1.6082837581634521
Epoch: 7, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.956 Vali Acc: 0.645 Test Loss: 0.956 Test Acc: 0.645
Validation loss decreased (-0.528975 --> -0.644918).  Saving model ...
Epoch: 8 cost time: 1.9151413440704346
Epoch: 8, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.886 Vali Acc: 0.696 Test Loss: 0.886 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695643).  Saving model ...
Epoch: 9 cost time: 1.8241212368011475
Epoch: 9, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.816 Vali Acc: 0.688 Test Loss: 0.816 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.563966989517212
Epoch: 10, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.773 Vali Acc: 0.725 Test Loss: 0.773 Test Acc: 0.725
Validation loss decreased (-0.695643 --> -0.724630).  Saving model ...
Epoch: 11 cost time: 1.3688726425170898
Epoch: 11, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.712 Vali Acc: 0.725 Test Loss: 0.712 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 1.4676969051361084
Epoch: 12, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.676 Vali Acc: 0.732 Test Loss: 0.676 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 13 cost time: 1.5931527614593506
Epoch: 13, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.666 Vali Acc: 0.710 Test Loss: 0.666 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4361968040466309
Epoch: 14, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.648 Vali Acc: 0.710 Test Loss: 0.648 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1696040630340576
Epoch: 15, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 1.4707155227661133
Epoch: 16, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.635 Vali Acc: 0.754 Test Loss: 0.635 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.692960262298584
Epoch: 17, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.588 Vali Acc: 0.754 Test Loss: 0.588 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 18 cost time: 1.6023612022399902
Epoch: 18, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 19 cost time: 1.841831922531128
Epoch: 19, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.561 Vali Acc: 0.797 Test Loss: 0.561 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 20 cost time: 1.7694463729858398
Epoch: 20, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6747865676879883
Epoch: 21, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.577 Vali Acc: 0.775 Test Loss: 0.577 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3533177375793457
Epoch: 22, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.547 Vali Acc: 0.761 Test Loss: 0.547 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7084264755249023
Epoch: 23, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.483 Vali Acc: 0.819 Test Loss: 0.483 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 24 cost time: 1.3846416473388672
Epoch: 24, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.475 Vali Acc: 0.804 Test Loss: 0.475 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6729977130889893
Epoch: 25, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 1.6883628368377686
Epoch: 26, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3581814765930176
Epoch: 27, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.405 Vali Acc: 0.870 Test Loss: 0.405 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.4111595153808594
Epoch: 28, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4955854415893555
Epoch: 29, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4071087837219238
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5664680004119873
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.302018642425537
Epoch: 32, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6185340881347656
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4831461906433105
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 1.4790360927581787
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5750744342803955
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.505173921585083
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6994452476501465
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.372779130935669
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 40 cost time: 1.4808571338653564
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 41 cost time: 1.4129583835601807
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.608844518661499
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6190838813781738
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 44 cost time: 1.5480704307556152
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.342 Vali Acc: 0.899 Test Loss: 0.342 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 45 cost time: 1.5966646671295166
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.511711597442627
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7185726165771484
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4833660125732422
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3537395000457764
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6411120891571045
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.884 Test Loss: 0.417 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3652236461639404
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.5017750263214111
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.8088738918304443
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.8295371532440186
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 604852
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.316441059112549
Epoch: 1, Steps: 9 | Train Loss: 1.481 Vali Loss: 1.396 Vali Acc: 0.246 Test Loss: 1.396 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.4304687976837158
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.354 Vali Acc: 0.326 Test Loss: 1.354 Test Acc: 0.326
Validation loss decreased (-0.246363 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 1.4506845474243164
Epoch: 3, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.259 Vali Acc: 0.493 Test Loss: 1.259 Test Acc: 0.493
Validation loss decreased (-0.326073 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 1.5124256610870361
Epoch: 4, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.173 Vali Acc: 0.420 Test Loss: 1.173 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5275030136108398
Epoch: 5, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.056 Vali Acc: 0.587 Test Loss: 1.056 Test Acc: 0.587
Validation loss decreased (-0.492741 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 1.4318733215332031
Epoch: 6, Steps: 9 | Train Loss: 0.955 Vali Loss: 0.955 Vali Acc: 0.638 Test Loss: 0.955 Test Acc: 0.638
Validation loss decreased (-0.586946 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 1.3402562141418457
Epoch: 7, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.878 Vali Acc: 0.652 Test Loss: 0.878 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 1.6307685375213623
Epoch: 8, Steps: 9 | Train Loss: 0.768 Vali Loss: 0.834 Vali Acc: 0.667 Test Loss: 0.834 Test Acc: 0.667
Validation loss decreased (-0.652165 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 1.3753273487091064
Epoch: 9, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.762 Vali Acc: 0.667 Test Loss: 0.762 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.510305643081665
Epoch: 10, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.754 Vali Acc: 0.667 Test Loss: 0.754 Test Acc: 0.667
Validation loss decreased (-0.666659 --> -0.666659).  Saving model ...
Epoch: 11 cost time: 1.8819458484649658
Epoch: 11, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.718 Vali Acc: 0.638 Test Loss: 0.718 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6151461601257324
Epoch: 12, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.689 Vali Acc: 0.703 Test Loss: 0.689 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702892).  Saving model ...
Epoch: 13 cost time: 1.7767853736877441
Epoch: 13, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.649 Vali Acc: 0.696 Test Loss: 0.649 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6009490489959717
Epoch: 14, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.635 Vali Acc: 0.696 Test Loss: 0.635 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8261833190917969
Epoch: 15, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.601 Vali Acc: 0.739 Test Loss: 0.601 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 1.3818399906158447
Epoch: 16, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3647160530090332
Epoch: 17, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 18 cost time: 1.28725004196167
Epoch: 18, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.502 Vali Acc: 0.812 Test Loss: 0.502 Test Acc: 0.812
Validation loss decreased (-0.746371 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.4371330738067627
Epoch: 19, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4585866928100586
Epoch: 20, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.484 Vali Acc: 0.775 Test Loss: 0.484 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2629270553588867
Epoch: 21, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.479 Vali Acc: 0.804 Test Loss: 0.479 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.452380657196045
Epoch: 22, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840576).  Saving model ...
Epoch: 23 cost time: 1.5508191585540771
Epoch: 23, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.462 Vali Acc: 0.775 Test Loss: 0.462 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6001653671264648
Epoch: 24, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.469 Vali Acc: 0.804 Test Loss: 0.469 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9920499324798584
Epoch: 25, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 1.5365402698516846
Epoch: 26, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.431 Vali Acc: 0.804 Test Loss: 0.431 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7641279697418213
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.597325086593628
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3648712635040283
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 30 cost time: 1.665614366531372
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8844990730285645
Epoch: 31, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 32 cost time: 1.8407104015350342
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 33 cost time: 1.4784626960754395
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6723179817199707
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4911441802978516
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.899 Test Loss: 0.338 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 36 cost time: 1.4713623523712158
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5104491710662842
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6300387382507324
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6955780982971191
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7607395648956299
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8277394771575928
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6350078582763672
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6241862773895264
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.5711402893066406
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.629685878753662
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 602804
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8254005908966064
Epoch: 1, Steps: 9 | Train Loss: 1.490 Vali Loss: 1.430 Vali Acc: 0.188 Test Loss: 1.430 Test Acc: 0.188
Validation loss decreased (inf --> -0.188392).  Saving model ...
Epoch: 2 cost time: 1.5994019508361816
Epoch: 2, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.393 Vali Acc: 0.333 Test Loss: 1.393 Test Acc: 0.333
Validation loss decreased (-0.188392 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 1.3429961204528809
Epoch: 3, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.334 Vali Acc: 0.391 Test Loss: 1.334 Test Acc: 0.391
Validation loss decreased (-0.333319 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 1.4101066589355469
Epoch: 4, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.269 Vali Acc: 0.377 Test Loss: 1.269 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3961598873138428
Epoch: 5, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.197 Vali Acc: 0.507 Test Loss: 1.197 Test Acc: 0.507
Validation loss decreased (-0.391291 --> -0.507234).  Saving model ...
Epoch: 6 cost time: 1.7532672882080078
Epoch: 6, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
Validation loss decreased (-0.507234 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 1.4924108982086182
Epoch: 7, Steps: 9 | Train Loss: 0.954 Vali Loss: 1.021 Vali Acc: 0.471 Test Loss: 1.021 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3506436347961426
Epoch: 8, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.929 Vali Acc: 0.652 Test Loss: 0.929 Test Acc: 0.652
Validation loss decreased (-0.514482 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 1.554175615310669
Epoch: 9, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.844 Vali Acc: 0.630 Test Loss: 0.844 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4739632606506348
Epoch: 10, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.791 Vali Acc: 0.638 Test Loss: 0.791 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2057573795318604
Epoch: 11, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.764 Vali Acc: 0.645 Test Loss: 0.764 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6991896629333496
Epoch: 12, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.727 Vali Acc: 0.652 Test Loss: 0.727 Test Acc: 0.652
Validation loss decreased (-0.652165 --> -0.652167).  Saving model ...
Epoch: 13 cost time: 1.654386281967163
Epoch: 13, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.669 Vali Acc: 0.681 Test Loss: 0.669 Test Acc: 0.681
Validation loss decreased (-0.652167 --> -0.681153).  Saving model ...
Epoch: 14 cost time: 1.3320908546447754
Epoch: 14, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.641 Vali Acc: 0.696 Test Loss: 0.641 Test Acc: 0.696
Validation loss decreased (-0.681153 --> -0.695646).  Saving model ...
Epoch: 15 cost time: 1.3647866249084473
Epoch: 15, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.619 Vali Acc: 0.725 Test Loss: 0.619 Test Acc: 0.725
Validation loss decreased (-0.695646 --> -0.724631).  Saving model ...
Epoch: 16 cost time: 1.5749425888061523
Epoch: 16, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.580 Vali Acc: 0.725 Test Loss: 0.580 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724632).  Saving model ...
Epoch: 17 cost time: 1.5811703205108643
Epoch: 17, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.724632 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 1.5883851051330566
Epoch: 18, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.540 Vali Acc: 0.790 Test Loss: 0.540 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.7724049091339111
Epoch: 19, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.488 Vali Acc: 0.804 Test Loss: 0.488 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 20 cost time: 1.6140351295471191
Epoch: 20, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 1.5902314186096191
Epoch: 21, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 1.3821561336517334
Epoch: 22, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.470 Vali Acc: 0.812 Test Loss: 0.470 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0715091228485107
Epoch: 23, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840576).  Saving model ...
Epoch: 24 cost time: 1.639416217803955
Epoch: 24, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9549741744995117
Epoch: 25, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5351548194885254
Epoch: 26, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
Validation loss decreased (-0.840576 --> -0.862315).  Saving model ...
Epoch: 27 cost time: 1.5055720806121826
Epoch: 27, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5004007816314697
Epoch: 28, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.678501844406128
Epoch: 29, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.590 Vali Acc: 0.739 Test Loss: 0.590 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7060821056365967
Epoch: 30, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6503779888153076
Epoch: 31, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5853381156921387
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 33 cost time: 1.631641149520874
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 34 cost time: 1.6001958847045898
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4462628364562988
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4186887741088867
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.517 Vali Acc: 0.877 Test Loss: 0.517 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3455581665039062
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.884 Test Loss: 0.439 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 38 cost time: 1.5075137615203857
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6342897415161133
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4065589904785156
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3662281036376953
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4976205825805664
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6793866157531738
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8229761123657227
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.884 Test Loss: 0.490 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4171276092529297
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.472 Vali Acc: 0.884 Test Loss: 0.472 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4562463760375977
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.884 Test Loss: 0.451 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.5679500102996826
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.511 Vali Acc: 0.877 Test Loss: 0.511 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 600756
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.293736696243286
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.423 Vali Acc: 0.225 Test Loss: 1.423 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 1.650418758392334
Epoch: 2, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.390 Vali Acc: 0.312 Test Loss: 1.390 Test Acc: 0.312
Validation loss decreased (-0.224623 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 1.6405599117279053
Epoch: 3, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.331 Vali Acc: 0.406 Test Loss: 1.331 Test Acc: 0.406
Validation loss decreased (-0.311580 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 1.4272925853729248
Epoch: 4, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.294 Vali Acc: 0.449 Test Loss: 1.294 Test Acc: 0.449
Validation loss decreased (-0.405784 --> -0.449262).  Saving model ...
Epoch: 5 cost time: 1.460444450378418
Epoch: 5, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.207 Vali Acc: 0.413 Test Loss: 1.207 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2957565784454346
Epoch: 6, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.095 Vali Acc: 0.565 Test Loss: 1.095 Test Acc: 0.565
Validation loss decreased (-0.449262 --> -0.565206).  Saving model ...
Epoch: 7 cost time: 1.4719645977020264
Epoch: 7, Steps: 9 | Train Loss: 0.968 Vali Loss: 1.000 Vali Acc: 0.623 Test Loss: 1.000 Test Acc: 0.623
Validation loss decreased (-0.565206 --> -0.623178).  Saving model ...
Epoch: 8 cost time: 1.7935779094696045
Epoch: 8, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.898 Vali Acc: 0.688 Test Loss: 0.898 Test Acc: 0.688
Validation loss decreased (-0.623178 --> -0.688397).  Saving model ...
Epoch: 9 cost time: 1.499094009399414
Epoch: 9, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.835 Vali Acc: 0.717 Test Loss: 0.835 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717383).  Saving model ...
Epoch: 10 cost time: 1.4704761505126953
Epoch: 10, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.797 Vali Acc: 0.710 Test Loss: 0.797 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.641141653060913
Epoch: 11, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
Validation loss decreased (-0.717383 --> -0.746369).  Saving model ...
Epoch: 12 cost time: 1.4213545322418213
Epoch: 12, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.716 Vali Acc: 0.746 Test Loss: 0.716 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746370).  Saving model ...
Epoch: 13 cost time: 1.4978253841400146
Epoch: 13, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.677 Vali Acc: 0.761 Test Loss: 0.677 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 14 cost time: 1.383476734161377
Epoch: 14, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7104873657226562
Epoch: 15, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789849).  Saving model ...
Epoch: 16 cost time: 1.8053834438323975
Epoch: 16, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.596 Vali Acc: 0.761 Test Loss: 0.596 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5630455017089844
Epoch: 17, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.588 Vali Acc: 0.768 Test Loss: 0.588 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6168410778045654
Epoch: 18, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.5792145729064941
Epoch: 19, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.506 Vali Acc: 0.797 Test Loss: 0.506 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.512831211090088
Epoch: 20, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5269293785095215
Epoch: 21, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 1.4568085670471191
Epoch: 22, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 1.3937642574310303
Epoch: 23, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4805192947387695
Epoch: 24, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 1.3030633926391602
Epoch: 25, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6274724006652832
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7081561088562012
Epoch: 27, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 28 cost time: 1.2725856304168701
Epoch: 28, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5083885192871094
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.346 Vali Acc: 0.862 Test Loss: 0.346 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 30 cost time: 1.642094612121582
Epoch: 30, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884055).  Saving model ...
Epoch: 31 cost time: 1.4698009490966797
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.877 Test Loss: 0.323 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2553331851959229
Epoch: 32, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7023181915283203
Epoch: 33, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 34 cost time: 1.587812900543213
Epoch: 34, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.372 Vali Acc: 0.848 Test Loss: 0.372 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4057865142822266
Epoch: 35, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.330 Vali Acc: 0.870 Test Loss: 0.330 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.573117971420288
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7704858779907227
Epoch: 37, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
Epoch: 38 cost time: 1.19950532913208
Epoch: 38, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.320 Vali Acc: 0.870 Test Loss: 0.320 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.417720079421997
Epoch: 39, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4873273372650146
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.287 Vali Acc: 0.884 Test Loss: 0.287 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3836190700531006
Epoch: 41, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4850430488586426
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4659245014190674
Epoch: 43, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.884 Test Loss: 0.303 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3918349742889404
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.5671067237854004
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6234633922576904
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.891 Test Loss: 0.277 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.9752764701843262
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.342 Vali Acc: 0.862 Test Loss: 0.342 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 596916
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1409969329833984
Epoch: 1, Steps: 9 | Train Loss: 1.595 Vali Loss: 1.395 Vali Acc: 0.370 Test Loss: 1.395 Test Acc: 0.370
Validation loss decreased (inf --> -0.369551).  Saving model ...
Epoch: 2 cost time: 1.1112747192382812
Epoch: 2, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.290 Vali Acc: 0.377 Test Loss: 1.290 Test Acc: 0.377
Validation loss decreased (-0.369551 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 1.3794877529144287
Epoch: 3, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.188 Vali Acc: 0.435 Test Loss: 1.188 Test Acc: 0.435
Validation loss decreased (-0.376799 --> -0.434771).  Saving model ...
Epoch: 4 cost time: 1.805422067642212
Epoch: 4, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.094 Vali Acc: 0.486 Test Loss: 1.094 Test Acc: 0.486
Validation loss decreased (-0.434771 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 1.3518590927124023
Epoch: 5, Steps: 9 | Train Loss: 1.033 Vali Loss: 1.000 Vali Acc: 0.558 Test Loss: 1.000 Test Acc: 0.558
Validation loss decreased (-0.485496 --> -0.557961).  Saving model ...
Epoch: 6 cost time: 1.750504493713379
Epoch: 6, Steps: 9 | Train Loss: 0.911 Vali Loss: 0.905 Vali Acc: 0.645 Test Loss: 0.905 Test Acc: 0.645
Validation loss decreased (-0.557961 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 1.6597034931182861
Epoch: 7, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.838 Vali Acc: 0.652 Test Loss: 0.838 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652166).  Saving model ...
Epoch: 8 cost time: 1.565265417098999
Epoch: 8, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.794 Vali Acc: 0.659 Test Loss: 0.794 Test Acc: 0.659
Validation loss decreased (-0.652166 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 1.600693702697754
Epoch: 9, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.2782268524169922
Epoch: 10, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.732 Vali Acc: 0.710 Test Loss: 0.732 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5544228553771973
Epoch: 11, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.705 Vali Acc: 0.732 Test Loss: 0.705 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 1.5387084484100342
Epoch: 12, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.690 Vali Acc: 0.739 Test Loss: 0.690 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 13 cost time: 1.518359661102295
Epoch: 13, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.652 Vali Acc: 0.754 Test Loss: 0.652 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.4870061874389648
Epoch: 14, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.785902500152588
Epoch: 15, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.603 Vali Acc: 0.761 Test Loss: 0.603 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3984708786010742
Epoch: 16, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 17 cost time: 1.5057079792022705
Epoch: 17, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.570 Vali Acc: 0.768 Test Loss: 0.570 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5253748893737793
Epoch: 18, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.585 Vali Acc: 0.790 Test Loss: 0.585 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4660511016845703
Epoch: 19, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8283145427703857
Epoch: 20, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 1.3845860958099365
Epoch: 21, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 22 cost time: 1.453376054763794
Epoch: 22, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5110750198364258
Epoch: 23, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5322861671447754
Epoch: 24, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.421 Vali Acc: 0.841 Test Loss: 0.421 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.508741855621338
Epoch: 25, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4462776184082031
Epoch: 26, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 1.5431010723114014
Epoch: 27, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.399 Vali Acc: 0.848 Test Loss: 0.399 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 1.5879623889923096
Epoch: 28, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855067).  Saving model ...
Epoch: 29 cost time: 1.3696050643920898
Epoch: 29, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 1.3571712970733643
Epoch: 30, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4815459251403809
Epoch: 31, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 32 cost time: 1.4686076641082764
Epoch: 32, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 33 cost time: 1.5744919776916504
Epoch: 33, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5853490829467773
Epoch: 34, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 1.4735209941864014
Epoch: 35, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.433419942855835
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.28145170211792
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3841333389282227
Epoch: 38, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.458894968032837
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.453357219696045
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.620069980621338
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3574128150939941
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4590799808502197
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.7635416984558105
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 595892
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.313694715499878
Epoch: 1, Steps: 9 | Train Loss: 1.520 Vali Loss: 1.439 Vali Acc: 0.203 Test Loss: 1.439 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 1.4680290222167969
Epoch: 2, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.383 Vali Acc: 0.312 Test Loss: 1.383 Test Acc: 0.312
Validation loss decreased (-0.202884 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 1.4983580112457275
Epoch: 3, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.290 Vali Acc: 0.449 Test Loss: 1.290 Test Acc: 0.449
Validation loss decreased (-0.311580 --> -0.449262).  Saving model ...
Epoch: 4 cost time: 1.5616276264190674
Epoch: 4, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.216 Vali Acc: 0.449 Test Loss: 1.216 Test Acc: 0.449
Validation loss decreased (-0.449262 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 1.5178837776184082
Epoch: 5, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
Validation loss decreased (-0.449263 --> -0.485496).  Saving model ...
Epoch: 6 cost time: 1.2729885578155518
Epoch: 6, Steps: 9 | Train Loss: 0.965 Vali Loss: 1.038 Vali Acc: 0.580 Test Loss: 1.038 Test Acc: 0.580
Validation loss decreased (-0.485496 --> -0.579700).  Saving model ...
Epoch: 7 cost time: 1.7985198497772217
Epoch: 7, Steps: 9 | Train Loss: 0.830 Vali Loss: 0.980 Vali Acc: 0.580 Test Loss: 0.980 Test Acc: 0.580
Validation loss decreased (-0.579700 --> -0.579700).  Saving model ...
Epoch: 8 cost time: 1.5248303413391113
Epoch: 8, Steps: 9 | Train Loss: 0.768 Vali Loss: 0.931 Vali Acc: 0.601 Test Loss: 0.931 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601440).  Saving model ...
Epoch: 9 cost time: 1.4900312423706055
Epoch: 9, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.881 Vali Acc: 0.601 Test Loss: 0.881 Test Acc: 0.601
Validation loss decreased (-0.601440 --> -0.601440).  Saving model ...
Epoch: 10 cost time: 1.6791133880615234
Epoch: 10, Steps: 9 | Train Loss: 0.615 Vali Loss: 0.829 Vali Acc: 0.659 Test Loss: 0.829 Test Acc: 0.659
Validation loss decreased (-0.601440 --> -0.659412).  Saving model ...
Epoch: 11 cost time: 1.5227336883544922
Epoch: 11, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.775 Vali Acc: 0.652 Test Loss: 0.775 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5290498733520508
Epoch: 12, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.746 Vali Acc: 0.688 Test Loss: 0.746 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 13 cost time: 1.4706590175628662
Epoch: 13, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.728 Vali Acc: 0.674 Test Loss: 0.728 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4294946193695068
Epoch: 14, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.727 Vali Acc: 0.674 Test Loss: 0.727 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.788815975189209
Epoch: 15, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.645 Vali Acc: 0.754 Test Loss: 0.645 Test Acc: 0.754
Validation loss decreased (-0.688398 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 1.5313467979431152
Epoch: 16, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.655 Vali Acc: 0.732 Test Loss: 0.655 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5970604419708252
Epoch: 17, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.576 Vali Acc: 0.804 Test Loss: 0.576 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 1.3943393230438232
Epoch: 18, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.576 Vali Acc: 0.797 Test Loss: 0.576 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.735518217086792
Epoch: 19, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.529 Vali Acc: 0.797 Test Loss: 0.529 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.549116611480713
Epoch: 20, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.804342 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 1.4272270202636719
Epoch: 21, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.580448865890503
Epoch: 22, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.459 Vali Acc: 0.819 Test Loss: 0.459 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7197439670562744
Epoch: 23, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4827983379364014
Epoch: 24, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.545 Vali Acc: 0.790 Test Loss: 0.545 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4852380752563477
Epoch: 25, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.406 Vali Acc: 0.797 Test Loss: 0.406 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2959582805633545
Epoch: 26, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 1.9022483825683594
Epoch: 27, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.341 Vali Acc: 0.855 Test Loss: 0.341 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5263299942016602
Epoch: 28, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 29 cost time: 1.599806547164917
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.769350290298462
Epoch: 30, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.336 Vali Acc: 0.891 Test Loss: 0.336 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 31 cost time: 1.6477234363555908
Epoch: 31, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5193209648132324
Epoch: 32, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5342504978179932
Epoch: 33, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6141068935394287
Epoch: 34, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913041).  Saving model ...
Epoch: 35 cost time: 1.7315013408660889
Epoch: 35, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7424607276916504
Epoch: 36, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9674885272979736
Epoch: 37, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7173492908477783
Epoch: 38, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.270 Vali Acc: 0.899 Test Loss: 0.270 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6999754905700684
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.748619794845581
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.913 Test Loss: 0.249 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 41 cost time: 2.022188663482666
Epoch: 41, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 42 cost time: 1.5832188129425049
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6716928482055664
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8052053451538086
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 45 cost time: 1.7536225318908691
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.0877580642700195
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7027194499969482
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 48 cost time: 1.7867183685302734
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 49 cost time: 1.7395741939544678
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.446641445159912
Epoch: 50, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8997974395751953
Epoch: 51, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.555799961090088
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.913 Test Loss: 0.262 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.9867823123931885
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 54 cost time: 1.740403175354004
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.751457929611206
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.7455997467041016
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5146148204803467
Epoch: 57, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.750718355178833
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.8887653350830078
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9652416706085205
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.6045923233032227
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.5018327236175537
Epoch: 62, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.3446424007415771
Epoch: 63, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 594868
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.164491653442383
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.378 Vali Acc: 0.355 Test Loss: 1.378 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.365070104598999
Epoch: 2, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.309 Vali Acc: 0.391 Test Loss: 1.309 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.4793989658355713
Epoch: 3, Steps: 9 | Train Loss: 1.265 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
Validation loss decreased (-0.391291 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 1.492887258529663
Epoch: 4, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.146 Vali Acc: 0.471 Test Loss: 1.146 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.723160982131958
Epoch: 5, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.068 Vali Acc: 0.486 Test Loss: 1.068 Test Acc: 0.486
Validation loss decreased (-0.485495 --> -0.485497).  Saving model ...
Epoch: 6 cost time: 1.3761229515075684
Epoch: 6, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.988 Vali Acc: 0.609 Test Loss: 0.988 Test Acc: 0.609
Validation loss decreased (-0.485497 --> -0.608686).  Saving model ...
Epoch: 7 cost time: 1.75413179397583
Epoch: 7, Steps: 9 | Train Loss: 0.857 Vali Loss: 0.949 Vali Acc: 0.623 Test Loss: 0.949 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623179).  Saving model ...
Epoch: 8 cost time: 1.3429906368255615
Epoch: 8, Steps: 9 | Train Loss: 0.781 Vali Loss: 0.900 Vali Acc: 0.659 Test Loss: 0.900 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659411).  Saving model ...
Epoch: 9 cost time: 1.4613852500915527
Epoch: 9, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.851 Vali Acc: 0.652 Test Loss: 0.851 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4469497203826904
Epoch: 10, Steps: 9 | Train Loss: 0.668 Vali Loss: 0.832 Vali Acc: 0.674 Test Loss: 0.832 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673905).  Saving model ...
Epoch: 11 cost time: 1.6252245903015137
Epoch: 11, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.789 Vali Acc: 0.688 Test Loss: 0.789 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688398).  Saving model ...
Epoch: 12 cost time: 1.604447841644287
Epoch: 12, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 1.2717010974884033
Epoch: 13, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.739 Vali Acc: 0.732 Test Loss: 0.739 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 14 cost time: 1.2621946334838867
Epoch: 14, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.717 Vali Acc: 0.725 Test Loss: 0.717 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3218097686767578
Epoch: 15, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.724 Vali Acc: 0.732 Test Loss: 0.724 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731877).  Saving model ...
Epoch: 16 cost time: 1.8475620746612549
Epoch: 16, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9201998710632324
Epoch: 17, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.690 Vali Acc: 0.739 Test Loss: 0.690 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 18 cost time: 1.4544634819030762
Epoch: 18, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.688 Vali Acc: 0.725 Test Loss: 0.688 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.587395191192627
Epoch: 19, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.687 Vali Acc: 0.746 Test Loss: 0.687 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 20 cost time: 1.641730546951294
Epoch: 20, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.695 Vali Acc: 0.768 Test Loss: 0.695 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768109).  Saving model ...
Epoch: 21 cost time: 1.5095746517181396
Epoch: 21, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.598 Vali Acc: 0.790 Test Loss: 0.598 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 22 cost time: 1.4747200012207031
Epoch: 22, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.597 Vali Acc: 0.790 Test Loss: 0.597 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 23 cost time: 1.5736887454986572
Epoch: 23, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.557 Vali Acc: 0.761 Test Loss: 0.557 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6108818054199219
Epoch: 24, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.568 Vali Acc: 0.804 Test Loss: 0.568 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 25 cost time: 1.7341620922088623
Epoch: 25, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5572333335876465
Epoch: 26, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 27 cost time: 1.5322637557983398
Epoch: 27, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.587 Vali Acc: 0.790 Test Loss: 0.587 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3406548500061035
Epoch: 28, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 1.7471070289611816
Epoch: 29, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6214213371276855
Epoch: 30, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 31 cost time: 1.6130998134613037
Epoch: 31, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 1.6906120777130127
Epoch: 32, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5689918994903564
Epoch: 33, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 1.3953053951263428
Epoch: 34, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.513636589050293
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 36 cost time: 1.8062257766723633
Epoch: 36, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 37 cost time: 1.5502958297729492
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.450608730316162
Epoch: 38, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 39 cost time: 1.4121966361999512
Epoch: 39, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.422 Vali Acc: 0.899 Test Loss: 0.422 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5740008354187012
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.77024245262146
Epoch: 41, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6931605339050293
Epoch: 42, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 43 cost time: 1.3211052417755127
Epoch: 43, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3972852230072021
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5655479431152344
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 46 cost time: 1.2374820709228516
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.899 Test Loss: 0.407 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4867174625396729
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3261747360229492
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.372 Vali Acc: 0.913 Test Loss: 0.372 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 49 cost time: 1.7008543014526367
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.381 Vali Acc: 0.906 Test Loss: 0.381 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4460673332214355
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.378 Vali Acc: 0.899 Test Loss: 0.378 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.616969347000122
Epoch: 51, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.7197668552398682
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.899 Test Loss: 0.376 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.6291766166687012
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.393 Vali Acc: 0.899 Test Loss: 0.393 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5000643730163574
Epoch: 54, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.357 Vali Acc: 0.920 Test Loss: 0.357 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 55 cost time: 1.502279281616211
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.366 Vali Acc: 0.920 Test Loss: 0.366 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.752831220626831
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.920 Test Loss: 0.354 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 57 cost time: 1.886044979095459
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 58 cost time: 1.6854183673858643
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.354 Vali Acc: 0.920 Test Loss: 0.354 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.8190650939941406
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.373 Vali Acc: 0.913 Test Loss: 0.373 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.8160474300384521
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.6404392719268799
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.579291820526123
Epoch: 62, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.333 Vali Acc: 0.913 Test Loss: 0.333 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.5824146270751953
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.913 Test Loss: 0.384 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.619175910949707
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.920 Test Loss: 0.344 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.8714334964752197
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.352 Vali Acc: 0.899 Test Loss: 0.352 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.6270785331726074
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.350 Vali Acc: 0.920 Test Loss: 0.350 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.5931973457336426
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.920 Test Loss: 0.367 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 593844
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.150179624557495
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.373 Vali Acc: 0.261 Test Loss: 1.373 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.5201573371887207
Epoch: 2, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.337 Vali Acc: 0.333 Test Loss: 1.337 Test Acc: 0.333
Validation loss decreased (-0.260856 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 1.3158764839172363
Epoch: 3, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.300 Vali Acc: 0.348 Test Loss: 1.300 Test Acc: 0.348
Validation loss decreased (-0.333320 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 1.5290603637695312
Epoch: 4, Steps: 9 | Train Loss: 1.257 Vali Loss: 1.234 Vali Acc: 0.420 Test Loss: 1.234 Test Acc: 0.420
Validation loss decreased (-0.347813 --> -0.420278).  Saving model ...
Epoch: 5 cost time: 1.8334391117095947
Epoch: 5, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.163 Vali Acc: 0.449 Test Loss: 1.163 Test Acc: 0.449
Validation loss decreased (-0.420278 --> -0.449264).  Saving model ...
Epoch: 6 cost time: 1.3624005317687988
Epoch: 6, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.081 Vali Acc: 0.536 Test Loss: 1.081 Test Acc: 0.536
Validation loss decreased (-0.449264 --> -0.536221).  Saving model ...
Epoch: 7 cost time: 1.6656818389892578
Epoch: 7, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.998 Vali Acc: 0.609 Test Loss: 0.998 Test Acc: 0.609
Validation loss decreased (-0.536221 --> -0.608686).  Saving model ...
Epoch: 8 cost time: 1.4440836906433105
Epoch: 8, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.929 Vali Acc: 0.616 Test Loss: 0.929 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615933).  Saving model ...
Epoch: 9 cost time: 1.5993802547454834
Epoch: 9, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.882 Vali Acc: 0.674 Test Loss: 0.882 Test Acc: 0.674
Validation loss decreased (-0.615933 --> -0.673904).  Saving model ...
Epoch: 10 cost time: 1.5778307914733887
Epoch: 10, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.846 Vali Acc: 0.667 Test Loss: 0.846 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4245109558105469
Epoch: 11, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.810 Vali Acc: 0.659 Test Loss: 0.810 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6591017246246338
Epoch: 12, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 13 cost time: 1.4573824405670166
Epoch: 13, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.765 Vali Acc: 0.688 Test Loss: 0.765 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 14 cost time: 1.572458028793335
Epoch: 14, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.752 Vali Acc: 0.667 Test Loss: 0.752 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.466050148010254
Epoch: 15, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.725 Vali Acc: 0.674 Test Loss: 0.725 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.527311086654663
Epoch: 16, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.705 Vali Acc: 0.696 Test Loss: 0.705 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 17 cost time: 1.5997045040130615
Epoch: 17, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 18 cost time: 1.5060360431671143
Epoch: 18, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6486692428588867
Epoch: 19, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.678 Vali Acc: 0.703 Test Loss: 0.678 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4775772094726562
Epoch: 20, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.615 Vali Acc: 0.754 Test Loss: 0.615 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 21 cost time: 1.692871332168579
Epoch: 21, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7936599254608154
Epoch: 22, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.576 Vali Acc: 0.768 Test Loss: 0.576 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 23 cost time: 1.509582757949829
Epoch: 23, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8013293743133545
Epoch: 24, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.529 Vali Acc: 0.761 Test Loss: 0.529 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.55804443359375
Epoch: 25, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.538 Vali Acc: 0.754 Test Loss: 0.538 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6503093242645264
Epoch: 26, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.505 Vali Acc: 0.797 Test Loss: 0.505 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 27 cost time: 1.6139609813690186
Epoch: 27, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.472 Vali Acc: 0.797 Test Loss: 0.472 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797097).  Saving model ...
Epoch: 28 cost time: 1.7472076416015625
Epoch: 28, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.431 Vali Acc: 0.841 Test Loss: 0.431 Test Acc: 0.841
Validation loss decreased (-0.797097 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 1.618819236755371
Epoch: 29, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6639404296875
Epoch: 30, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 1.421142339706421
Epoch: 31, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.386 Vali Acc: 0.841 Test Loss: 0.386 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7119064331054688
Epoch: 32, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 1.4540917873382568
Epoch: 33, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 1.4880077838897705
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 35 cost time: 1.8659512996673584
Epoch: 35, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.371 Vali Acc: 0.855 Test Loss: 0.371 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9954745769500732
Epoch: 36, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 37 cost time: 1.5602524280548096
Epoch: 37, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 38 cost time: 1.4215614795684814
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.701056957244873
Epoch: 39, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.311 Vali Acc: 0.877 Test Loss: 0.311 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 1.513988733291626
Epoch: 40, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.307 Vali Acc: 0.870 Test Loss: 0.307 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6158266067504883
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7252259254455566
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.749924898147583
Epoch: 43, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.877 Test Loss: 0.311 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5987000465393066
Epoch: 44, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.70650053024292
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.877 Test Loss: 0.311 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.951404094696045
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.282 Vali Acc: 0.891 Test Loss: 0.282 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891302).  Saving model ...
Epoch: 47 cost time: 1.8594181537628174
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.891 Test Loss: 0.271 Test Acc: 0.891
Validation loss decreased (-0.891302 --> -0.891302).  Saving model ...
Epoch: 48 cost time: 1.6175193786621094
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.291 Vali Acc: 0.891 Test Loss: 0.291 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8129615783691406
Epoch: 49, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
Validation loss decreased (-0.891302 --> -0.898548).  Saving model ...
Epoch: 50 cost time: 1.5397849082946777
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.905733585357666
Epoch: 51, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.591355323791504
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.913 Test Loss: 0.262 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 53 cost time: 1.4432237148284912
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.899 Test Loss: 0.288 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8827307224273682
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.884 Test Loss: 0.281 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.0947985649108887
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.899 Test Loss: 0.275 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.6897356510162354
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 57 cost time: 1.7061798572540283
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.899 Test Loss: 0.266 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.6698002815246582
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.7557373046875
Epoch: 59, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.899 Test Loss: 0.258 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.6931848526000977
Epoch: 60, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.0196890830993652
Epoch: 61, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.6464900970458984
Epoch: 62, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.547748327255249
Epoch: 63, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.870 Test Loss: 0.295 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.4922995567321777
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.884 Test Loss: 0.290 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.750704050064087
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.985302209854126
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.899 Test Loss: 0.262 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 363956
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.695950746536255
Epoch: 1, Steps: 9 | Train Loss: 1.503 Vali Loss: 1.415 Vali Acc: 0.283 Test Loss: 1.415 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 2.1291983127593994
Epoch: 2, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.377 Vali Acc: 0.283 Test Loss: 1.377 Test Acc: 0.283
Validation loss decreased (-0.282595 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 1.708026647567749
Epoch: 3, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.339 Vali Acc: 0.341 Test Loss: 1.339 Test Acc: 0.341
Validation loss decreased (-0.282595 --> -0.340566).  Saving model ...
Epoch: 4 cost time: 1.5418274402618408
Epoch: 4, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.280 Vali Acc: 0.457 Test Loss: 1.280 Test Acc: 0.457
Validation loss decreased (-0.340566 --> -0.456509).  Saving model ...
Epoch: 5 cost time: 1.4579582214355469
Epoch: 5, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
Validation loss decreased (-0.456509 --> -0.485495).  Saving model ...
Epoch: 6 cost time: 1.4510750770568848
Epoch: 6, Steps: 9 | Train Loss: 1.161 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.485495 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.4934020042419434
Epoch: 7, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.045 Vali Acc: 0.572 Test Loss: 1.045 Test Acc: 0.572
Validation loss decreased (-0.499989 --> -0.572453).  Saving model ...
Epoch: 8 cost time: 1.4389772415161133
Epoch: 8, Steps: 9 | Train Loss: 0.920 Vali Loss: 0.973 Vali Acc: 0.609 Test Loss: 0.973 Test Acc: 0.609
Validation loss decreased (-0.572453 --> -0.608686).  Saving model ...
Epoch: 9 cost time: 1.335357666015625
Epoch: 9, Steps: 9 | Train Loss: 0.816 Vali Loss: 0.897 Vali Acc: 0.630 Test Loss: 0.897 Test Acc: 0.630
Validation loss decreased (-0.608686 --> -0.630426).  Saving model ...
Epoch: 10 cost time: 1.485830545425415
Epoch: 10, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.856 Vali Acc: 0.645 Test Loss: 0.856 Test Acc: 0.645
Validation loss decreased (-0.630426 --> -0.644919).  Saving model ...
Epoch: 11 cost time: 1.436431646347046
Epoch: 11, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.804 Vali Acc: 0.710 Test Loss: 0.804 Test Acc: 0.710
Validation loss decreased (-0.644919 --> -0.710137).  Saving model ...
Epoch: 12 cost time: 1.4888484477996826
Epoch: 12, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.760 Vali Acc: 0.710 Test Loss: 0.760 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710137).  Saving model ...
Epoch: 13 cost time: 1.485008955001831
Epoch: 13, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.730 Vali Acc: 0.703 Test Loss: 0.730 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4953291416168213
Epoch: 14, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.709 Vali Acc: 0.703 Test Loss: 0.709 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.595632791519165
Epoch: 15, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 16 cost time: 1.6012487411499023
Epoch: 16, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.650 Vali Acc: 0.739 Test Loss: 0.650 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 17 cost time: 1.5459203720092773
Epoch: 17, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.632 Vali Acc: 0.725 Test Loss: 0.632 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.532846450805664
Epoch: 18, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760863).  Saving model ...
Epoch: 19 cost time: 1.4259796142578125
Epoch: 19, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 20 cost time: 1.8428277969360352
Epoch: 20, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 21 cost time: 1.503509521484375
Epoch: 21, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.543 Vali Acc: 0.768 Test Loss: 0.543 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768111).  Saving model ...
Epoch: 22 cost time: 1.4945354461669922
Epoch: 22, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.538 Vali Acc: 0.797 Test Loss: 0.538 Test Acc: 0.797
Validation loss decreased (-0.768111 --> -0.797096).  Saving model ...
Epoch: 23 cost time: 1.5277562141418457
Epoch: 23, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.813112735748291
Epoch: 24, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.512 Vali Acc: 0.812 Test Loss: 0.512 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 25 cost time: 1.5071330070495605
Epoch: 25, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.455 Vali Acc: 0.826 Test Loss: 0.455 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 26 cost time: 1.5319855213165283
Epoch: 26, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5822885036468506
Epoch: 27, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 28 cost time: 1.5283498764038086
Epoch: 28, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 1.490081787109375
Epoch: 29, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.505 Vali Acc: 0.804 Test Loss: 0.505 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6241960525512695
Epoch: 30, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 1.6848883628845215
Epoch: 31, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9728021621704102
Epoch: 32, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 33 cost time: 2.2504782676696777
Epoch: 33, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.366 Vali Acc: 0.884 Test Loss: 0.366 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 34 cost time: 1.5828649997711182
Epoch: 34, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.358 Vali Acc: 0.884 Test Loss: 0.358 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 35 cost time: 1.6159460544586182
Epoch: 35, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0300474166870117
Epoch: 36, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6392078399658203
Epoch: 37, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 38 cost time: 1.7501742839813232
Epoch: 38, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9535748958587646
Epoch: 39, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.396 Vali Acc: 0.870 Test Loss: 0.396 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0467188358306885
Epoch: 40, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6572721004486084
Epoch: 41, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.172743558883667
Epoch: 42, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7465355396270752
Epoch: 43, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 44 cost time: 1.5787537097930908
Epoch: 44, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.558814287185669
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5886399745941162
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6025540828704834
Epoch: 47, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 48 cost time: 1.4468588829040527
Epoch: 48, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8875842094421387
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6431701183319092
Epoch: 50, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
Validation loss decreased (-0.905794 --> -0.927533).  Saving model ...
Epoch: 51 cost time: 1.5148568153381348
Epoch: 51, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.904170036315918
Epoch: 52, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.7010900974273682
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.4980878829956055
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.7046306133270264
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5740108489990234
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4687700271606445
Epoch: 57, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.14374041557312
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.5141568183898926
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.835465431213379
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 362932
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3496389389038086
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.409 Vali Acc: 0.283 Test Loss: 1.409 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.5150561332702637
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.344 Vali Acc: 0.341 Test Loss: 1.344 Test Acc: 0.341
Validation loss decreased (-0.282595 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.4536843299865723
Epoch: 3, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.279 Vali Acc: 0.442 Test Loss: 1.279 Test Acc: 0.442
Validation loss decreased (-0.340566 --> -0.442016).  Saving model ...
Epoch: 4 cost time: 1.3997387886047363
Epoch: 4, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.217 Vali Acc: 0.428 Test Loss: 1.217 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4648630619049072
Epoch: 5, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.150 Vali Acc: 0.551 Test Loss: 1.150 Test Acc: 0.551
Validation loss decreased (-0.442016 --> -0.550713).  Saving model ...
Epoch: 6 cost time: 1.506363868713379
Epoch: 6, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.087 Vali Acc: 0.558 Test Loss: 1.087 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557960).  Saving model ...
Epoch: 7 cost time: 1.7508840560913086
Epoch: 7, Steps: 9 | Train Loss: 0.938 Vali Loss: 1.023 Vali Acc: 0.565 Test Loss: 1.023 Test Acc: 0.565
Validation loss decreased (-0.557960 --> -0.565207).  Saving model ...
Epoch: 8 cost time: 1.4548864364624023
Epoch: 8, Steps: 9 | Train Loss: 0.821 Vali Loss: 0.972 Vali Acc: 0.681 Test Loss: 0.972 Test Acc: 0.681
Validation loss decreased (-0.565207 --> -0.681150).  Saving model ...
Epoch: 9 cost time: 1.8318367004394531
Epoch: 9, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.917 Vali Acc: 0.681 Test Loss: 0.917 Test Acc: 0.681
Validation loss decreased (-0.681150 --> -0.681150).  Saving model ...
Epoch: 10 cost time: 1.7241899967193604
Epoch: 10, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.859 Vali Acc: 0.696 Test Loss: 0.859 Test Acc: 0.696
Validation loss decreased (-0.681150 --> -0.695644).  Saving model ...
Epoch: 11 cost time: 1.6337132453918457
Epoch: 11, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.836 Vali Acc: 0.688 Test Loss: 0.836 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6389672756195068
Epoch: 12, Steps: 9 | Train Loss: 0.584 Vali Loss: 0.813 Vali Acc: 0.696 Test Loss: 0.813 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695644).  Saving model ...
Epoch: 13 cost time: 1.5822086334228516
Epoch: 13, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.780 Vali Acc: 0.696 Test Loss: 0.780 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695644).  Saving model ...
Epoch: 14 cost time: 1.742734670639038
Epoch: 14, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.754 Vali Acc: 0.703 Test Loss: 0.754 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 15 cost time: 1.580521583557129
Epoch: 15, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 16 cost time: 1.5150172710418701
Epoch: 16, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.685 Vali Acc: 0.725 Test Loss: 0.685 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 17 cost time: 1.3023569583892822
Epoch: 17, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 18 cost time: 1.474668025970459
Epoch: 18, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.619 Vali Acc: 0.746 Test Loss: 0.619 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 19 cost time: 1.6273701190948486
Epoch: 19, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.612 Vali Acc: 0.761 Test Loss: 0.612 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760863).  Saving model ...
Epoch: 20 cost time: 1.6793229579925537
Epoch: 20, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775357).  Saving model ...
Epoch: 21 cost time: 1.6246109008789062
Epoch: 21, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.403782606124878
Epoch: 22, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.775357 --> -0.833328).  Saving model ...
Epoch: 23 cost time: 1.4644417762756348
Epoch: 23, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4384264945983887
Epoch: 24, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.352052927017212
Epoch: 25, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862315).  Saving model ...
Epoch: 26 cost time: 1.5851457118988037
Epoch: 26, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6585333347320557
Epoch: 27, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.4924230575561523
Epoch: 28, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5869221687316895
Epoch: 29, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8429834842681885
Epoch: 30, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 31 cost time: 1.4243407249450684
Epoch: 31, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 32 cost time: 1.365241289138794
Epoch: 32, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.294 Vali Acc: 0.891 Test Loss: 0.294 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 33 cost time: 1.5479912757873535
Epoch: 33, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.329 Vali Acc: 0.870 Test Loss: 0.329 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5116691589355469
Epoch: 34, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.406684160232544
Epoch: 35, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.877 Test Loss: 0.291 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.309983491897583
Epoch: 36, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 37 cost time: 1.3901522159576416
Epoch: 37, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3580143451690674
Epoch: 38, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920288).  Saving model ...
Epoch: 39 cost time: 1.390920639038086
Epoch: 39, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5456631183624268
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 41 cost time: 1.7459263801574707
Epoch: 41, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.636307954788208
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4234066009521484
Epoch: 43, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.256 Vali Acc: 0.913 Test Loss: 0.256 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7387571334838867
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.899 Test Loss: 0.244 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4260878562927246
Epoch: 45, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 46 cost time: 1.6087284088134766
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 47 cost time: 1.7306370735168457
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.920 Test Loss: 0.212 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6795341968536377
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9214727878570557
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.7360131740570068
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.6246938705444336
Epoch: 51, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.8072984218597412
Epoch: 52, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 53 cost time: 1.6366024017333984
Epoch: 53, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.754608392715454
Epoch: 54, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 55 cost time: 1.3376541137695312
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 56 cost time: 1.5892715454101562
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4312121868133545
Epoch: 57, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4598040580749512
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.6912100315093994
Epoch: 59, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 60 cost time: 1.5720367431640625
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.5546352863311768
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.3579225540161133
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.4281096458435059
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.957749843597412
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949274).  Saving model ...
Epoch: 65 cost time: 1.6461186408996582
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 66 cost time: 1.6221156120300293
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.5323677062988281
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.542701244354248
Epoch: 68, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.8281581401824951
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.942 Test Loss: 0.181 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.593416690826416
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.7973344326019287
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
Validation loss decreased (-0.949274 --> -0.956520).  Saving model ...
Epoch: 72 cost time: 1.516169786453247
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.649794578552246
Epoch: 73, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.8005437850952148
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.7532179355621338
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.6062407493591309
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.5476083755493164
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
Validation loss decreased (-0.956520 --> -0.963766).  Saving model ...
Epoch: 78 cost time: 1.7139019966125488
Epoch: 78, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.7394328117370605
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.4599363803863525
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.5818357467651367
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.3509953022003174
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.541898250579834
Epoch: 83, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.8374261856079102
Epoch: 84, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.5423932075500488
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 1.6177802085876465
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 1.3683021068572998
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9637681159420289
model parameter : 361908
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.694756269454956
Epoch: 1, Steps: 9 | Train Loss: 1.520 Vali Loss: 1.478 Vali Acc: 0.188 Test Loss: 1.478 Test Acc: 0.188
Validation loss decreased (inf --> -0.188391).  Saving model ...
Epoch: 2 cost time: 1.5210535526275635
Epoch: 2, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.430 Vali Acc: 0.196 Test Loss: 1.430 Test Acc: 0.196
Validation loss decreased (-0.188391 --> -0.195638).  Saving model ...
Epoch: 3 cost time: 1.481797218322754
Epoch: 3, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.195638 --> -0.282595).  Saving model ...
Epoch: 4 cost time: 1.5895614624023438
Epoch: 4, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.323 Vali Acc: 0.297 Test Loss: 1.323 Test Acc: 0.297
Validation loss decreased (-0.282595 --> -0.297088).  Saving model ...
Epoch: 5 cost time: 1.4999961853027344
Epoch: 5, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.264 Vali Acc: 0.384 Test Loss: 1.264 Test Acc: 0.384
Validation loss decreased (-0.297088 --> -0.384045).  Saving model ...
Epoch: 6 cost time: 1.3821418285369873
Epoch: 6, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.202 Vali Acc: 0.399 Test Loss: 1.202 Test Acc: 0.399
Validation loss decreased (-0.384045 --> -0.398539).  Saving model ...
Epoch: 7 cost time: 1.4833476543426514
Epoch: 7, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.132 Vali Acc: 0.471 Test Loss: 1.132 Test Acc: 0.471
Validation loss decreased (-0.398539 --> -0.471003).  Saving model ...
Epoch: 8 cost time: 1.4566378593444824
Epoch: 8, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.075 Vali Acc: 0.493 Test Loss: 1.075 Test Acc: 0.493
Validation loss decreased (-0.471003 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 1.3067030906677246
Epoch: 9, Steps: 9 | Train Loss: 0.898 Vali Loss: 1.005 Vali Acc: 0.536 Test Loss: 1.005 Test Acc: 0.536
Validation loss decreased (-0.492743 --> -0.536222).  Saving model ...
Epoch: 10 cost time: 1.3888919353485107
Epoch: 10, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.933 Vali Acc: 0.645 Test Loss: 0.933 Test Acc: 0.645
Validation loss decreased (-0.536222 --> -0.644918).  Saving model ...
Epoch: 11 cost time: 1.5249314308166504
Epoch: 11, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.870 Vali Acc: 0.710 Test Loss: 0.870 Test Acc: 0.710
Validation loss decreased (-0.644918 --> -0.710136).  Saving model ...
Epoch: 12 cost time: 1.6534814834594727
Epoch: 12, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717383).  Saving model ...
Epoch: 13 cost time: 1.6589634418487549
Epoch: 13, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.782 Vali Acc: 0.710 Test Loss: 0.782 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4900341033935547
Epoch: 14, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.751 Vali Acc: 0.725 Test Loss: 0.751 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724630).  Saving model ...
Epoch: 15 cost time: 1.4221656322479248
Epoch: 15, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
Validation loss decreased (-0.724630 --> -0.775356).  Saving model ...
Epoch: 16 cost time: 1.388564109802246
Epoch: 16, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.686 Vali Acc: 0.739 Test Loss: 0.686 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5279936790466309
Epoch: 17, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.647 Vali Acc: 0.754 Test Loss: 0.647 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5631103515625
Epoch: 18, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.589 Vali Acc: 0.768 Test Loss: 0.589 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2847471237182617
Epoch: 19, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 20 cost time: 1.4885454177856445
Epoch: 20, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.543 Vali Acc: 0.797 Test Loss: 0.543 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 21 cost time: 1.5052039623260498
Epoch: 21, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 1.3770997524261475
Epoch: 22, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.505 Vali Acc: 0.826 Test Loss: 0.505 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 1.7070097923278809
Epoch: 23, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.434493064880371
Epoch: 24, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.463632345199585
Epoch: 25, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
Validation loss decreased (-0.833329 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 1.3566429615020752
Epoch: 26, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4402430057525635
Epoch: 27, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4080069065093994
Epoch: 28, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3885316848754883
Epoch: 29, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3141815662384033
Epoch: 30, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 1.450664758682251
Epoch: 31, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5631089210510254
Epoch: 32, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4762389659881592
Epoch: 33, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5024662017822266
Epoch: 34, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9228615760803223
Epoch: 35, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6555562019348145
Epoch: 36, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3341898918151855
Epoch: 37, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3747551441192627
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4653410911560059
Epoch: 39, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.450 Vali Acc: 0.804 Test Loss: 0.450 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4266133308410645
Epoch: 40, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 360884
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8374955654144287
Epoch: 1, Steps: 9 | Train Loss: 1.518 Vali Loss: 1.426 Vali Acc: 0.391 Test Loss: 1.426 Test Acc: 0.391
Validation loss decreased (inf --> -0.391290).  Saving model ...
Epoch: 2 cost time: 1.7451305389404297
Epoch: 2, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6602487564086914
Epoch: 3, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.362 Vali Acc: 0.261 Test Loss: 1.362 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.486844539642334
Epoch: 4, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.311 Vali Acc: 0.391 Test Loss: 1.311 Test Acc: 0.391
Validation loss decreased (-0.391290 --> -0.391291).  Saving model ...
Epoch: 5 cost time: 1.4361841678619385
Epoch: 5, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.261 Vali Acc: 0.493 Test Loss: 1.261 Test Acc: 0.493
Validation loss decreased (-0.391291 --> -0.492741).  Saving model ...
Epoch: 6 cost time: 1.5199072360992432
Epoch: 6, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.201 Vali Acc: 0.543 Test Loss: 1.201 Test Acc: 0.543
Validation loss decreased (-0.492741 --> -0.543466).  Saving model ...
Epoch: 7 cost time: 1.5700311660766602
Epoch: 7, Steps: 9 | Train Loss: 1.163 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.543466 --> -0.572452).  Saving model ...
Epoch: 8 cost time: 1.493605613708496
Epoch: 8, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.056 Vali Acc: 0.616 Test Loss: 1.056 Test Acc: 0.616
Validation loss decreased (-0.572452 --> -0.615931).  Saving model ...
Epoch: 9 cost time: 1.618746280670166
Epoch: 9, Steps: 9 | Train Loss: 0.986 Vali Loss: 0.976 Vali Acc: 0.638 Test Loss: 0.976 Test Acc: 0.638
Validation loss decreased (-0.615931 --> -0.637671).  Saving model ...
Epoch: 10 cost time: 1.331075668334961
Epoch: 10, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.914 Vali Acc: 0.688 Test Loss: 0.914 Test Acc: 0.688
Validation loss decreased (-0.637671 --> -0.688397).  Saving model ...
Epoch: 11 cost time: 1.774442434310913
Epoch: 11, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.869 Vali Acc: 0.688 Test Loss: 0.869 Test Acc: 0.688
Validation loss decreased (-0.688397 --> -0.688397).  Saving model ...
Epoch: 12 cost time: 1.499835729598999
Epoch: 12, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.807 Vali Acc: 0.688 Test Loss: 0.807 Test Acc: 0.688
Validation loss decreased (-0.688397 --> -0.688398).  Saving model ...
Epoch: 13 cost time: 1.470508098602295
Epoch: 13, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724630).  Saving model ...
Epoch: 14 cost time: 1.3560693264007568
Epoch: 14, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.762 Vali Acc: 0.703 Test Loss: 0.762 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3272578716278076
Epoch: 15, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.727 Vali Acc: 0.688 Test Loss: 0.727 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4686307907104492
Epoch: 16, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.700 Vali Acc: 0.710 Test Loss: 0.700 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.187716484069824
Epoch: 17, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.668 Vali Acc: 0.696 Test Loss: 0.668 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3676717281341553
Epoch: 18, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.655 Vali Acc: 0.688 Test Loss: 0.655 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4599401950836182
Epoch: 19, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.664 Vali Acc: 0.725 Test Loss: 0.664 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724631).  Saving model ...
Epoch: 20 cost time: 1.4472100734710693
Epoch: 20, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.613 Vali Acc: 0.725 Test Loss: 0.613 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724632).  Saving model ...
Epoch: 21 cost time: 1.3146283626556396
Epoch: 21, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.606 Vali Acc: 0.732 Test Loss: 0.606 Test Acc: 0.732
Validation loss decreased (-0.724632 --> -0.731878).  Saving model ...
Epoch: 22 cost time: 1.4093618392944336
Epoch: 22, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 23 cost time: 1.5062313079833984
Epoch: 23, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
Validation loss decreased (-0.746371 --> -0.746371).  Saving model ...
Epoch: 24 cost time: 1.8308191299438477
Epoch: 24, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.417184591293335
Epoch: 25, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.503 Vali Acc: 0.812 Test Loss: 0.503 Test Acc: 0.812
Validation loss decreased (-0.746371 --> -0.811589).  Saving model ...
Epoch: 26 cost time: 1.3063502311706543
Epoch: 26, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.518 Vali Acc: 0.797 Test Loss: 0.518 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5972108840942383
Epoch: 27, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 1.4122216701507568
Epoch: 28, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.485 Vali Acc: 0.812 Test Loss: 0.485 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4530911445617676
Epoch: 29, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.116816997528076
Epoch: 30, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 31 cost time: 1.9101202487945557
Epoch: 31, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.447 Vali Acc: 0.819 Test Loss: 0.447 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.638662338256836
Epoch: 32, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 33 cost time: 1.5539205074310303
Epoch: 33, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.434 Vali Acc: 0.826 Test Loss: 0.434 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7934319972991943
Epoch: 34, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.426 Vali Acc: 0.819 Test Loss: 0.426 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8247456550598145
Epoch: 35, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869562).  Saving model ...
Epoch: 36 cost time: 1.7959575653076172
Epoch: 36, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.455 Vali Acc: 0.826 Test Loss: 0.455 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.780698537826538
Epoch: 37, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6817741394042969
Epoch: 38, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.821199655532837
Epoch: 39, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.664663553237915
Epoch: 40, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.873506784439087
Epoch: 41, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4828662872314453
Epoch: 42, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7874562740325928
Epoch: 43, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.5818769931793213
Epoch: 44, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.8861875534057617
Epoch: 45, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 247476
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.38730788230896
Epoch: 1, Steps: 9 | Train Loss: 1.672 Vali Loss: 1.557 Vali Acc: 0.109 Test Loss: 1.557 Test Acc: 0.109
Validation loss decreased (inf --> -0.108680).  Saving model ...
Epoch: 2 cost time: 1.637134075164795
Epoch: 2, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.446 Vali Acc: 0.254 Test Loss: 1.446 Test Acc: 0.254
Validation loss decreased (-0.108680 --> -0.253609).  Saving model ...
Epoch: 3 cost time: 1.4694077968597412
Epoch: 3, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
Validation loss decreased (-0.253609 --> -0.333319).  Saving model ...
Epoch: 4 cost time: 1.5198330879211426
Epoch: 4, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.353 Vali Acc: 0.355 Test Loss: 1.353 Test Acc: 0.355
Validation loss decreased (-0.333319 --> -0.355059).  Saving model ...
Epoch: 5 cost time: 1.6683526039123535
Epoch: 5, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.294 Vali Acc: 0.355 Test Loss: 1.294 Test Acc: 0.355
Validation loss decreased (-0.355059 --> -0.355060).  Saving model ...
Epoch: 6 cost time: 1.2761454582214355
Epoch: 6, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.236 Vali Acc: 0.464 Test Loss: 1.236 Test Acc: 0.464
Validation loss decreased (-0.355060 --> -0.463756).  Saving model ...
Epoch: 7 cost time: 1.3567705154418945
Epoch: 7, Steps: 9 | Train Loss: 1.114 Vali Loss: 1.157 Vali Acc: 0.522 Test Loss: 1.157 Test Acc: 0.522
Validation loss decreased (-0.463756 --> -0.521728).  Saving model ...
Epoch: 8 cost time: 1.2209949493408203
Epoch: 8, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.072 Vali Acc: 0.565 Test Loss: 1.072 Test Acc: 0.565
Validation loss decreased (-0.521728 --> -0.565207).  Saving model ...
Epoch: 9 cost time: 1.3653573989868164
Epoch: 9, Steps: 9 | Train Loss: 0.965 Vali Loss: 1.007 Vali Acc: 0.601 Test Loss: 1.007 Test Acc: 0.601
Validation loss decreased (-0.565207 --> -0.601439).  Saving model ...
Epoch: 10 cost time: 1.5389347076416016
Epoch: 10, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.947 Vali Acc: 0.601 Test Loss: 0.947 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601440).  Saving model ...
Epoch: 11 cost time: 1.5659501552581787
Epoch: 11, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.893 Vali Acc: 0.601 Test Loss: 0.893 Test Acc: 0.601
Validation loss decreased (-0.601440 --> -0.601440).  Saving model ...
Epoch: 12 cost time: 1.6989150047302246
Epoch: 12, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.855 Vali Acc: 0.688 Test Loss: 0.855 Test Acc: 0.688
Validation loss decreased (-0.601440 --> -0.688397).  Saving model ...
Epoch: 13 cost time: 1.554534912109375
Epoch: 13, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.829 Vali Acc: 0.659 Test Loss: 0.829 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3526651859283447
Epoch: 14, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.789 Vali Acc: 0.667 Test Loss: 0.789 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7619361877441406
Epoch: 15, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.757 Vali Acc: 0.710 Test Loss: 0.757 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710137).  Saving model ...
Epoch: 16 cost time: 1.6303894519805908
Epoch: 16, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.747 Vali Acc: 0.688 Test Loss: 0.747 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6445863246917725
Epoch: 17, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.710137 --> -0.731877).  Saving model ...
Epoch: 18 cost time: 1.4652113914489746
Epoch: 18, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 19 cost time: 1.842318058013916
Epoch: 19, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.361520528793335
Epoch: 20, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.579 Vali Acc: 0.797 Test Loss: 0.579 Test Acc: 0.797
Validation loss decreased (-0.746370 --> -0.797096).  Saving model ...
Epoch: 21 cost time: 1.4904546737670898
Epoch: 21, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 22 cost time: 1.5558104515075684
Epoch: 22, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 1.376265048980713
Epoch: 23, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.6826891899108887
Epoch: 24, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 1.4739265441894531
Epoch: 25, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5583686828613281
Epoch: 26, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 1.3450965881347656
Epoch: 27, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9155769348144531
Epoch: 28, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5176734924316406
Epoch: 29, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8247931003570557
Epoch: 30, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7497587203979492
Epoch: 31, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 32 cost time: 1.5568745136260986
Epoch: 32, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7346584796905518
Epoch: 33, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9547717571258545
Epoch: 34, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5581738948822021
Epoch: 35, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4818902015686035
Epoch: 36, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4179809093475342
Epoch: 37, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3516395092010498
Epoch: 38, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4659740924835205
Epoch: 39, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7161989212036133
Epoch: 40, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4420275688171387
Epoch: 41, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 246452
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5335066318511963
Epoch: 1, Steps: 9 | Train Loss: 1.494 Vali Loss: 1.454 Vali Acc: 0.326 Test Loss: 1.454 Test Acc: 0.326
Validation loss decreased (inf --> -0.326072).  Saving model ...
Epoch: 2 cost time: 1.335496187210083
Epoch: 2, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.363 Vali Acc: 0.268 Test Loss: 1.363 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.516817569732666
Epoch: 3, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.320 Vali Acc: 0.377 Test Loss: 1.320 Test Acc: 0.377
Validation loss decreased (-0.326072 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 1.3167235851287842
Epoch: 4, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.263 Vali Acc: 0.391 Test Loss: 1.263 Test Acc: 0.391
Validation loss decreased (-0.376798 --> -0.391292).  Saving model ...
Epoch: 5 cost time: 1.3708250522613525
Epoch: 5, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.199 Vali Acc: 0.543 Test Loss: 1.199 Test Acc: 0.543
Validation loss decreased (-0.391292 --> -0.543466).  Saving model ...
Epoch: 6 cost time: 1.508284568786621
Epoch: 6, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.135 Vali Acc: 0.580 Test Loss: 1.135 Test Acc: 0.580
Validation loss decreased (-0.543466 --> -0.579699).  Saving model ...
Epoch: 7 cost time: 1.4302234649658203
Epoch: 7, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.063 Vali Acc: 0.580 Test Loss: 1.063 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579700).  Saving model ...
Epoch: 8 cost time: 1.6698472499847412
Epoch: 8, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.001 Vali Acc: 0.630 Test Loss: 1.001 Test Acc: 0.630
Validation loss decreased (-0.579700 --> -0.630425).  Saving model ...
Epoch: 9 cost time: 1.3850648403167725
Epoch: 9, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.943 Vali Acc: 0.688 Test Loss: 0.943 Test Acc: 0.688
Validation loss decreased (-0.630425 --> -0.688396).  Saving model ...
Epoch: 10 cost time: 1.3427908420562744
Epoch: 10, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.909 Vali Acc: 0.645 Test Loss: 0.909 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3877382278442383
Epoch: 11, Steps: 9 | Train Loss: 0.725 Vali Loss: 0.860 Vali Acc: 0.645 Test Loss: 0.860 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8058526515960693
Epoch: 12, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.821 Vali Acc: 0.645 Test Loss: 0.821 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5427815914154053
Epoch: 13, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.776 Vali Acc: 0.681 Test Loss: 0.776 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6082727909088135
Epoch: 14, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.753 Vali Acc: 0.659 Test Loss: 0.753 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4802746772766113
Epoch: 15, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.734 Vali Acc: 0.703 Test Loss: 0.734 Test Acc: 0.703
Validation loss decreased (-0.688396 --> -0.702891).  Saving model ...
Epoch: 16 cost time: 1.4712839126586914
Epoch: 16, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.697 Vali Acc: 0.710 Test Loss: 0.697 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 17 cost time: 1.458148717880249
Epoch: 17, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.686 Vali Acc: 0.696 Test Loss: 0.686 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7123205661773682
Epoch: 18, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.664 Vali Acc: 0.725 Test Loss: 0.664 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 1.4374804496765137
Epoch: 19, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.664 Vali Acc: 0.696 Test Loss: 0.664 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4518821239471436
Epoch: 20, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 21 cost time: 1.6076304912567139
Epoch: 21, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.402517557144165
Epoch: 22, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
Validation loss decreased (-0.731878 --> -0.760864).  Saving model ...
Epoch: 23 cost time: 1.512270212173462
Epoch: 23, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.550 Vali Acc: 0.761 Test Loss: 0.550 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 24 cost time: 1.5026867389678955
Epoch: 24, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.521 Vali Acc: 0.797 Test Loss: 0.521 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 1.4569685459136963
Epoch: 25, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.522 Vali Acc: 0.768 Test Loss: 0.522 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.47829270362854
Epoch: 26, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.488 Vali Acc: 0.812 Test Loss: 0.488 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 27 cost time: 1.3507845401763916
Epoch: 27, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 28 cost time: 1.4309134483337402
Epoch: 28, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.483 Vali Acc: 0.804 Test Loss: 0.483 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4851250648498535
Epoch: 29, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.435448169708252
Epoch: 30, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.442 Vali Acc: 0.812 Test Loss: 0.442 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6616325378417969
Epoch: 31, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 32 cost time: 1.3748929500579834
Epoch: 32, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 33 cost time: 1.555159091949463
Epoch: 33, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 34 cost time: 1.4621219635009766
Epoch: 34, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.396 Vali Acc: 0.841 Test Loss: 0.396 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.681739091873169
Epoch: 35, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 36 cost time: 1.7419428825378418
Epoch: 36, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 37 cost time: 1.546304702758789
Epoch: 37, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.529529333114624
Epoch: 38, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.347 Vali Acc: 0.848 Test Loss: 0.347 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4620170593261719
Epoch: 39, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862314).  Saving model ...
Epoch: 40 cost time: 1.6720242500305176
Epoch: 40, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.289 Vali Acc: 0.884 Test Loss: 0.289 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884055).  Saving model ...
Epoch: 41 cost time: 1.7263777256011963
Epoch: 41, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.432694911956787
Epoch: 42, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.325 Vali Acc: 0.877 Test Loss: 0.325 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5668559074401855
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.301 Vali Acc: 0.877 Test Loss: 0.301 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6568892002105713
Epoch: 44, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.688795804977417
Epoch: 45, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4349439144134521
Epoch: 46, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.877 Test Loss: 0.305 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3399784564971924
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.356264591217041
Epoch: 48, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.305 Vali Acc: 0.884 Test Loss: 0.305 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5838868618011475
Epoch: 49, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3798670768737793
Epoch: 50, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 245428
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.169297695159912
Epoch: 1, Steps: 9 | Train Loss: 1.658 Vali Loss: 1.500 Vali Acc: 0.246 Test Loss: 1.500 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 1.356215238571167
Epoch: 2, Steps: 9 | Train Loss: 1.489 Vali Loss: 1.374 Vali Acc: 0.312 Test Loss: 1.374 Test Acc: 0.312
Validation loss decreased (-0.246362 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 1.4977891445159912
Epoch: 3, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5489981174468994
Epoch: 4, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.302 Vali Acc: 0.326 Test Loss: 1.302 Test Acc: 0.326
Validation loss decreased (-0.311580 --> -0.326074).  Saving model ...
Epoch: 5 cost time: 1.1750667095184326
Epoch: 5, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.235 Vali Acc: 0.391 Test Loss: 1.235 Test Acc: 0.391
Validation loss decreased (-0.326074 --> -0.391292).  Saving model ...
Epoch: 6 cost time: 1.3983705043792725
Epoch: 6, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.175 Vali Acc: 0.464 Test Loss: 1.175 Test Acc: 0.464
Validation loss decreased (-0.391292 --> -0.463756).  Saving model ...
Epoch: 7 cost time: 1.4523091316223145
Epoch: 7, Steps: 9 | Train Loss: 1.151 Vali Loss: 1.112 Vali Acc: 0.464 Test Loss: 1.112 Test Acc: 0.464
Validation loss decreased (-0.463756 --> -0.463757).  Saving model ...
Epoch: 8 cost time: 1.35768723487854
Epoch: 8, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.024 Vali Acc: 0.630 Test Loss: 1.024 Test Acc: 0.630
Validation loss decreased (-0.463757 --> -0.630425).  Saving model ...
Epoch: 9 cost time: 1.6329848766326904
Epoch: 9, Steps: 9 | Train Loss: 0.963 Vali Loss: 0.949 Vali Acc: 0.645 Test Loss: 0.949 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 10 cost time: 1.6502389907836914
Epoch: 10, Steps: 9 | Train Loss: 0.868 Vali Loss: 0.887 Vali Acc: 0.652 Test Loss: 0.887 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 11 cost time: 1.6776199340820312
Epoch: 11, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.836 Vali Acc: 0.667 Test Loss: 0.836 Test Acc: 0.667
Validation loss decreased (-0.652165 --> -0.666658).  Saving model ...
Epoch: 12 cost time: 1.7662529945373535
Epoch: 12, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.797 Vali Acc: 0.674 Test Loss: 0.797 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 1.4221420288085938
Epoch: 13, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.765 Vali Acc: 0.674 Test Loss: 0.765 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 14 cost time: 1.4809882640838623
Epoch: 14, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.737 Vali Acc: 0.710 Test Loss: 0.737 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710138).  Saving model ...
Epoch: 15 cost time: 1.6005890369415283
Epoch: 15, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.725 Vali Acc: 0.674 Test Loss: 0.725 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6711809635162354
Epoch: 16, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.685 Vali Acc: 0.710 Test Loss: 0.685 Test Acc: 0.710
Validation loss decreased (-0.710138 --> -0.710138).  Saving model ...
Epoch: 17 cost time: 1.7116305828094482
Epoch: 17, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.680 Vali Acc: 0.688 Test Loss: 0.680 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.531189203262329
Epoch: 18, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 19 cost time: 1.40077543258667
Epoch: 19, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.673 Vali Acc: 0.696 Test Loss: 0.673 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3075146675109863
Epoch: 20, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.644 Vali Acc: 0.717 Test Loss: 0.644 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 21 cost time: 1.3551678657531738
Epoch: 21, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.643 Vali Acc: 0.696 Test Loss: 0.643 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.330763578414917
Epoch: 22, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.635 Vali Acc: 0.710 Test Loss: 0.635 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3917410373687744
Epoch: 23, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.608 Vali Acc: 0.725 Test Loss: 0.608 Test Acc: 0.725
Validation loss decreased (-0.717385 --> -0.724632).  Saving model ...
Epoch: 24 cost time: 1.387608289718628
Epoch: 24, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.724632 --> -0.782603).  Saving model ...
Epoch: 25 cost time: 1.5893864631652832
Epoch: 25, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.620 Vali Acc: 0.754 Test Loss: 0.620 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4332664012908936
Epoch: 26, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3706285953521729
Epoch: 27, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4009602069854736
Epoch: 28, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8292107582092285
Epoch: 29, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 30 cost time: 1.4827094078063965
Epoch: 30, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7346980571746826
Epoch: 31, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6728417873382568
Epoch: 32, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.626 Vali Acc: 0.768 Test Loss: 0.626 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2536232471466064
Epoch: 33, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 34 cost time: 1.319931983947754
Epoch: 34, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.539 Vali Acc: 0.797 Test Loss: 0.539 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 35 cost time: 1.2282135486602783
Epoch: 35, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3609719276428223
Epoch: 36, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 37 cost time: 1.5989186763763428
Epoch: 37, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 38 cost time: 1.6410377025604248
Epoch: 38, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.515 Vali Acc: 0.797 Test Loss: 0.515 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3646845817565918
Epoch: 39, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826081).  Saving model ...
Epoch: 40 cost time: 1.3887171745300293
Epoch: 40, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 41 cost time: 1.44732666015625
Epoch: 41, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 42 cost time: 1.2037975788116455
Epoch: 42, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.554142951965332
Epoch: 43, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 44 cost time: 1.4316604137420654
Epoch: 44, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5644490718841553
Epoch: 45, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 1.468219518661499
Epoch: 46, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.466886043548584
Epoch: 47, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5266122817993164
Epoch: 48, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 49 cost time: 1.3270606994628906
Epoch: 49, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6009845733642578
Epoch: 50, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.7050807476043701
Epoch: 51, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.514 Vali Acc: 0.812 Test Loss: 0.514 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5690994262695312
Epoch: 52, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5816855430603027
Epoch: 53, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 54 cost time: 1.4651587009429932
Epoch: 54, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5410888195037842
Epoch: 55, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.5278894901275635
Epoch: 56, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.3094959259033203
Epoch: 57, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 58 cost time: 1.513930320739746
Epoch: 58, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.43021559715271
Epoch: 59, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 60 cost time: 1.4873056411743164
Epoch: 60, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.419921636581421
Epoch: 61, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.6060676574707031
Epoch: 62, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.8070483207702637
Epoch: 63, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.631282091140747
Epoch: 64, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 65 cost time: 2.00639009475708
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.6908226013183594
Epoch: 66, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9136254787445068
Epoch: 67, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.7221651077270508
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.3088152408599854
Epoch: 69, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.5231261253356934
Epoch: 70, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.4228951930999756
Epoch: 71, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.623953104019165
Epoch: 72, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.7122647762298584
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.65673828125
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 244404
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.454089879989624
Epoch: 1, Steps: 9 | Train Loss: 1.501 Vali Loss: 1.412 Vali Acc: 0.232 Test Loss: 1.412 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.4103703498840332
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1819112300872803
Epoch: 3, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.341 Vali Acc: 0.399 Test Loss: 1.341 Test Acc: 0.399
Validation loss decreased (-0.231870 --> -0.398537).  Saving model ...
Epoch: 4 cost time: 1.4004855155944824
Epoch: 4, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.294 Vali Acc: 0.478 Test Loss: 1.294 Test Acc: 0.478
Validation loss decreased (-0.398537 --> -0.478248).  Saving model ...
Epoch: 5 cost time: 1.2535285949707031
Epoch: 5, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.245 Vali Acc: 0.442 Test Loss: 1.245 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6008610725402832
Epoch: 6, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.192 Vali Acc: 0.442 Test Loss: 1.192 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5290029048919678
Epoch: 7, Steps: 9 | Train Loss: 1.125 Vali Loss: 1.126 Vali Acc: 0.507 Test Loss: 1.126 Test Acc: 0.507
Validation loss decreased (-0.478248 --> -0.507235).  Saving model ...
Epoch: 8 cost time: 1.5728650093078613
Epoch: 8, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.067 Vali Acc: 0.522 Test Loss: 1.067 Test Acc: 0.522
Validation loss decreased (-0.507235 --> -0.521728).  Saving model ...
Epoch: 9 cost time: 1.5648972988128662
Epoch: 9, Steps: 9 | Train Loss: 0.971 Vali Loss: 1.013 Vali Acc: 0.558 Test Loss: 1.013 Test Acc: 0.558
Validation loss decreased (-0.521728 --> -0.557961).  Saving model ...
Epoch: 10 cost time: 1.4810245037078857
Epoch: 10, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.976 Vali Acc: 0.572 Test Loss: 0.976 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572454).  Saving model ...
Epoch: 11 cost time: 1.3320960998535156
Epoch: 11, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.914 Vali Acc: 0.616 Test Loss: 0.914 Test Acc: 0.616
Validation loss decreased (-0.572454 --> -0.615933).  Saving model ...
Epoch: 12 cost time: 1.3527801036834717
Epoch: 12, Steps: 9 | Train Loss: 0.746 Vali Loss: 0.867 Vali Acc: 0.659 Test Loss: 0.867 Test Acc: 0.659
Validation loss decreased (-0.615933 --> -0.659412).  Saving model ...
Epoch: 13 cost time: 1.5448434352874756
Epoch: 13, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.834 Vali Acc: 0.659 Test Loss: 0.834 Test Acc: 0.659
Validation loss decreased (-0.659412 --> -0.659412).  Saving model ...
Epoch: 14 cost time: 1.8040966987609863
Epoch: 14, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.810 Vali Acc: 0.659 Test Loss: 0.810 Test Acc: 0.659
Validation loss decreased (-0.659412 --> -0.659412).  Saving model ...
Epoch: 15 cost time: 1.4778153896331787
Epoch: 15, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.783 Vali Acc: 0.674 Test Loss: 0.783 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 16 cost time: 1.760937213897705
Epoch: 16, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.765 Vali Acc: 0.674 Test Loss: 0.765 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 17 cost time: 1.487579584121704
Epoch: 17, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.726 Vali Acc: 0.696 Test Loss: 0.726 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 1.6737546920776367
Epoch: 18, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 19 cost time: 1.6384057998657227
Epoch: 19, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.700 Vali Acc: 0.688 Test Loss: 0.700 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.598043441772461
Epoch: 20, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5600781440734863
Epoch: 21, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6828348636627197
Epoch: 22, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 23 cost time: 1.5850188732147217
Epoch: 23, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5619144439697266
Epoch: 24, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 25 cost time: 1.5567383766174316
Epoch: 25, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.627 Vali Acc: 0.703 Test Loss: 0.627 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.719750165939331
Epoch: 26, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.581 Vali Acc: 0.768 Test Loss: 0.581 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 27 cost time: 1.728048324584961
Epoch: 27, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 28 cost time: 1.8417294025421143
Epoch: 28, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 29 cost time: 2.0160439014434814
Epoch: 29, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.523 Vali Acc: 0.790 Test Loss: 0.523 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6227540969848633
Epoch: 30, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.484 Vali Acc: 0.819 Test Loss: 0.484 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 31 cost time: 1.4021360874176025
Epoch: 31, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5997645854949951
Epoch: 32, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6319539546966553
Epoch: 33, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847821).  Saving model ...
Epoch: 34 cost time: 1.4548556804656982
Epoch: 34, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.454 Vali Acc: 0.826 Test Loss: 0.454 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7960245609283447
Epoch: 35, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.467 Vali Acc: 0.812 Test Loss: 0.467 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5068414211273193
Epoch: 36, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4220755100250244
Epoch: 37, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6116611957550049
Epoch: 38, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5807716846466064
Epoch: 39, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.422 Vali Acc: 0.841 Test Loss: 0.422 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4399409294128418
Epoch: 40, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862315).  Saving model ...
Epoch: 41 cost time: 1.5413880348205566
Epoch: 41, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4765815734863281
Epoch: 42, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5501110553741455
Epoch: 43, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5118894577026367
Epoch: 44, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6968183517456055
Epoch: 45, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5294973850250244
Epoch: 46, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.0850558280944824
Epoch: 47, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 48 cost time: 1.4873831272125244
Epoch: 48, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4231147766113281
Epoch: 49, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.930316686630249
Epoch: 50, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5501532554626465
Epoch: 51, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.8067352771759033
Epoch: 52, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 53 cost time: 1.5163710117340088
Epoch: 53, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5502548217773438
Epoch: 54, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.6159663200378418
Epoch: 55, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.487973928451538
Epoch: 56, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.5531470775604248
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.361999273300171
Epoch: 58, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 59 cost time: 1.340364694595337
Epoch: 59, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.451 Vali Acc: 0.877 Test Loss: 0.451 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4090826511383057
Epoch: 60, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.5723018646240234
Epoch: 61, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.5897996425628662
Epoch: 62, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.3997323513031006
Epoch: 63, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.4593586921691895
Epoch: 64, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.6816682815551758
Epoch: 65, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.384 Vali Acc: 0.899 Test Loss: 0.384 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.7035696506500244
Epoch: 66, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.545097827911377
Epoch: 67, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.5471034049987793
Epoch: 68, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 189236
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.367257833480835
Epoch: 1, Steps: 9 | Train Loss: 1.513 Vali Loss: 1.446 Vali Acc: 0.174 Test Loss: 1.446 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 1.4904789924621582
Epoch: 2, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.396 Vali Acc: 0.268 Test Loss: 1.396 Test Acc: 0.268
Validation loss decreased (-0.173899 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 1.5665037631988525
Epoch: 3, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.370 Vali Acc: 0.341 Test Loss: 1.370 Test Acc: 0.341
Validation loss decreased (-0.268102 --> -0.340566).  Saving model ...
Epoch: 4 cost time: 1.6086876392364502
Epoch: 4, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.326 Vali Acc: 0.384 Test Loss: 1.326 Test Acc: 0.384
Validation loss decreased (-0.340566 --> -0.384045).  Saving model ...
Epoch: 5 cost time: 1.6536102294921875
Epoch: 5, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.267 Vali Acc: 0.478 Test Loss: 1.267 Test Acc: 0.478
Validation loss decreased (-0.384045 --> -0.478248).  Saving model ...
Epoch: 6 cost time: 1.4926178455352783
Epoch: 6, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.202 Vali Acc: 0.543 Test Loss: 1.202 Test Acc: 0.543
Validation loss decreased (-0.478248 --> -0.543466).  Saving model ...
Epoch: 7 cost time: 1.6748099327087402
Epoch: 7, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.129 Vali Acc: 0.580 Test Loss: 1.129 Test Acc: 0.580
Validation loss decreased (-0.543466 --> -0.579699).  Saving model ...
Epoch: 8 cost time: 1.5277132987976074
Epoch: 8, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.062 Vali Acc: 0.572 Test Loss: 1.062 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.531001329421997
Epoch: 9, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.990 Vali Acc: 0.609 Test Loss: 0.990 Test Acc: 0.609
Validation loss decreased (-0.579699 --> -0.608686).  Saving model ...
Epoch: 10 cost time: 1.4562859535217285
Epoch: 10, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.930 Vali Acc: 0.638 Test Loss: 0.930 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637672).  Saving model ...
Epoch: 11 cost time: 1.7264277935028076
Epoch: 11, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.889 Vali Acc: 0.601 Test Loss: 0.889 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.464548110961914
Epoch: 12, Steps: 9 | Train Loss: 0.713 Vali Loss: 0.833 Vali Acc: 0.652 Test Loss: 0.833 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652166).  Saving model ...
Epoch: 13 cost time: 1.4196751117706299
Epoch: 13, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.786 Vali Acc: 0.681 Test Loss: 0.786 Test Acc: 0.681
Validation loss decreased (-0.652166 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 1.5388307571411133
Epoch: 14, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.766 Vali Acc: 0.652 Test Loss: 0.766 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.545752763748169
Epoch: 15, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.729 Vali Acc: 0.681 Test Loss: 0.729 Test Acc: 0.681
Validation loss decreased (-0.681152 --> -0.681152).  Saving model ...
Epoch: 16 cost time: 1.5467662811279297
Epoch: 16, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717384).  Saving model ...
Epoch: 17 cost time: 1.5809321403503418
Epoch: 17, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.678 Vali Acc: 0.681 Test Loss: 0.678 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6287074089050293
Epoch: 18, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 19 cost time: 1.2993988990783691
Epoch: 19, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.647 Vali Acc: 0.703 Test Loss: 0.647 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4865100383758545
Epoch: 20, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 21 cost time: 1.428980827331543
Epoch: 21, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.571 Vali Acc: 0.768 Test Loss: 0.571 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768110).  Saving model ...
Epoch: 22 cost time: 1.797046184539795
Epoch: 22, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.519 Vali Acc: 0.790 Test Loss: 0.519 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 23 cost time: 1.3696458339691162
Epoch: 23, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 24 cost time: 1.5811190605163574
Epoch: 24, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 25 cost time: 1.590449571609497
Epoch: 25, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 26 cost time: 1.547013521194458
Epoch: 26, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840576).  Saving model ...
Epoch: 27 cost time: 1.85514497756958
Epoch: 27, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4131324291229248
Epoch: 28, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 1.4221386909484863
Epoch: 29, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.359769582748413
Epoch: 30, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4343583583831787
Epoch: 31, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5470576286315918
Epoch: 32, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4919981956481934
Epoch: 33, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 1.8458259105682373
Epoch: 34, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6403841972351074
Epoch: 35, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4352734088897705
Epoch: 36, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 37 cost time: 1.313786506652832
Epoch: 37, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5246219635009766
Epoch: 38, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 39 cost time: 1.4936585426330566
Epoch: 39, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5698976516723633
Epoch: 40, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5155913829803467
Epoch: 41, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4464492797851562
Epoch: 42, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4401695728302002
Epoch: 43, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6979243755340576
Epoch: 44, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.530487060546875
Epoch: 45, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891300).  Saving model ...
Epoch: 46 cost time: 1.2772197723388672
Epoch: 46, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4346027374267578
Epoch: 47, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.37375807762146
Epoch: 48, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.449 Vali Acc: 0.884 Test Loss: 0.449 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.5296285152435303
Epoch: 49, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.372 Vali Acc: 0.899 Test Loss: 0.372 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 50 cost time: 1.1838488578796387
Epoch: 50, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4387578964233398
Epoch: 51, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.457 Vali Acc: 0.884 Test Loss: 0.457 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.5977222919464111
Epoch: 52, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.602074384689331
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.396697998046875
Epoch: 54, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.3483340740203857
Epoch: 55, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.838758945465088
Epoch: 56, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.5149948596954346
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.8087818622589111
Epoch: 58, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.5059199333190918
Epoch: 59, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 188212
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.172121524810791
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.388 Vali Acc: 0.246 Test Loss: 1.388 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.3756039142608643
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.410295009613037
Epoch: 3, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.340 Vali Acc: 0.261 Test Loss: 1.340 Test Acc: 0.261
Validation loss decreased (-0.246363 --> -0.260856).  Saving model ...
Epoch: 4 cost time: 1.3696660995483398
Epoch: 4, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.290 Vali Acc: 0.362 Test Loss: 1.290 Test Acc: 0.362
Validation loss decreased (-0.260856 --> -0.362306).  Saving model ...
Epoch: 5 cost time: 1.4762449264526367
Epoch: 5, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.239 Vali Acc: 0.362 Test Loss: 1.239 Test Acc: 0.362
Validation loss decreased (-0.362306 --> -0.362306).  Saving model ...
Epoch: 6 cost time: 1.2883086204528809
Epoch: 6, Steps: 9 | Train Loss: 1.132 Vali Loss: 1.175 Vali Acc: 0.399 Test Loss: 1.175 Test Acc: 0.399
Validation loss decreased (-0.362306 --> -0.398539).  Saving model ...
Epoch: 7 cost time: 1.3762075901031494
Epoch: 7, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.106 Vali Acc: 0.428 Test Loss: 1.106 Test Acc: 0.428
Validation loss decreased (-0.398539 --> -0.427525).  Saving model ...
Epoch: 8 cost time: 1.4720325469970703
Epoch: 8, Steps: 9 | Train Loss: 0.963 Vali Loss: 1.037 Vali Acc: 0.493 Test Loss: 1.037 Test Acc: 0.493
Validation loss decreased (-0.427525 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 1.5549054145812988
Epoch: 9, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.974 Vali Acc: 0.594 Test Loss: 0.974 Test Acc: 0.594
Validation loss decreased (-0.492743 --> -0.594193).  Saving model ...
Epoch: 10 cost time: 1.6283652782440186
Epoch: 10, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.908 Vali Acc: 0.659 Test Loss: 0.908 Test Acc: 0.659
Validation loss decreased (-0.594193 --> -0.659411).  Saving model ...
Epoch: 11 cost time: 1.469975233078003
Epoch: 11, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.864 Vali Acc: 0.674 Test Loss: 0.864 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673904).  Saving model ...
Epoch: 12 cost time: 1.4137444496154785
Epoch: 12, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.829 Vali Acc: 0.681 Test Loss: 0.829 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 13 cost time: 1.2950522899627686
Epoch: 13, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.804 Vali Acc: 0.688 Test Loss: 0.804 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 14 cost time: 1.5901615619659424
Epoch: 14, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.769 Vali Acc: 0.688 Test Loss: 0.769 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 15 cost time: 1.3582637310028076
Epoch: 15, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.736 Vali Acc: 0.688 Test Loss: 0.736 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 16 cost time: 1.4783484935760498
Epoch: 16, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.730 Vali Acc: 0.696 Test Loss: 0.730 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 17 cost time: 1.387915849685669
Epoch: 17, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.707 Vali Acc: 0.696 Test Loss: 0.707 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 1.2867653369903564
Epoch: 18, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 19 cost time: 1.4237587451934814
Epoch: 19, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.662 Vali Acc: 0.703 Test Loss: 0.662 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9361257553100586
Epoch: 20, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.674 Vali Acc: 0.703 Test Loss: 0.674 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5593621730804443
Epoch: 21, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.661 Vali Acc: 0.703 Test Loss: 0.661 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5220510959625244
Epoch: 22, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731878).  Saving model ...
Epoch: 23 cost time: 1.5099551677703857
Epoch: 23, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.622 Vali Acc: 0.725 Test Loss: 0.622 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3590738773345947
Epoch: 24, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.616 Vali Acc: 0.710 Test Loss: 0.616 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.791858196258545
Epoch: 25, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 26 cost time: 1.5927395820617676
Epoch: 26, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.590 Vali Acc: 0.739 Test Loss: 0.590 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2918519973754883
Epoch: 27, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.575 Vali Acc: 0.725 Test Loss: 0.575 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.736375093460083
Epoch: 28, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7016937732696533
Epoch: 29, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760864).  Saving model ...
Epoch: 30 cost time: 1.2214365005493164
Epoch: 30, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 31 cost time: 1.2013473510742188
Epoch: 31, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.592 Vali Acc: 0.768 Test Loss: 0.592 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 32 cost time: 1.3812098503112793
Epoch: 32, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 33 cost time: 1.3881773948669434
Epoch: 33, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 34 cost time: 1.3984472751617432
Epoch: 34, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5245792865753174
Epoch: 35, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4305164813995361
Epoch: 36, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 37 cost time: 1.4002981185913086
Epoch: 37, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.518 Vali Acc: 0.812 Test Loss: 0.518 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3939807415008545
Epoch: 38, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 39 cost time: 1.5661053657531738
Epoch: 39, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.595872163772583
Epoch: 40, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.475 Vali Acc: 0.819 Test Loss: 0.475 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 41 cost time: 1.5451912879943848
Epoch: 41, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5630507469177246
Epoch: 42, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 43 cost time: 1.636418342590332
Epoch: 43, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 44 cost time: 1.2627785205841064
Epoch: 44, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6368699073791504
Epoch: 45, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.478 Vali Acc: 0.812 Test Loss: 0.478 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.568598747253418
Epoch: 46, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.501452922821045
Epoch: 47, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 48 cost time: 1.6327767372131348
Epoch: 48, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5019676685333252
Epoch: 49, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 50 cost time: 1.677056074142456
Epoch: 50, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5618202686309814
Epoch: 51, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3982641696929932
Epoch: 52, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 53 cost time: 1.4196507930755615
Epoch: 53, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.6604502201080322
Epoch: 54, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.592923879623413
Epoch: 55, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.7641053199768066
Epoch: 56, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 57 cost time: 1.635695457458496
Epoch: 57, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.6082568168640137
Epoch: 58, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.6335272789001465
Epoch: 59, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 60 cost time: 1.928849458694458
Epoch: 60, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.650721549987793
Epoch: 61, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.5950427055358887
Epoch: 62, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.6049623489379883
Epoch: 63, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.6749155521392822
Epoch: 64, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 65 cost time: 1.6061370372772217
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.429 Vali Acc: 0.870 Test Loss: 0.429 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3581688404083252
Epoch: 66, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.8290343284606934
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.9262614250183105
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.953920841217041
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.361840009689331
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.6065962314605713
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.5619561672210693
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 73 cost time: 1.3693737983703613
Epoch: 73, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.3579299449920654
Epoch: 74, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.676628589630127
Epoch: 75, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 76 cost time: 1.8679311275482178
Epoch: 76, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.6419551372528076
Epoch: 77, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.5200533866882324
Epoch: 78, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.3912684917449951
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.9090955257415771
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.400796890258789
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.4362189769744873
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.4384486675262451
Epoch: 83, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.5599534511566162
Epoch: 84, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.3861749172210693
Epoch: 85, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 187188
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4574646949768066
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.453 Vali Acc: 0.181 Test Loss: 1.453 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 1.5553267002105713
Epoch: 2, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.433 Vali Acc: 0.210 Test Loss: 1.433 Test Acc: 0.210
Validation loss decreased (-0.181145 --> -0.210131).  Saving model ...
Epoch: 3 cost time: 1.4875907897949219
Epoch: 3, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.407 Vali Acc: 0.232 Test Loss: 1.407 Test Acc: 0.232
Validation loss decreased (-0.210131 --> -0.231870).  Saving model ...
Epoch: 4 cost time: 1.666398048400879
Epoch: 4, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.372 Vali Acc: 0.283 Test Loss: 1.372 Test Acc: 0.283
Validation loss decreased (-0.231870 --> -0.282595).  Saving model ...
Epoch: 5 cost time: 1.4576430320739746
Epoch: 5, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.341 Vali Acc: 0.290 Test Loss: 1.341 Test Acc: 0.290
Validation loss decreased (-0.282595 --> -0.289842).  Saving model ...
Epoch: 6 cost time: 1.578538417816162
Epoch: 6, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
Validation loss decreased (-0.289842 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 1.5765793323516846
Epoch: 7, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.253 Vali Acc: 0.377 Test Loss: 1.253 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376799).  Saving model ...
Epoch: 8 cost time: 1.6668589115142822
Epoch: 8, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.199 Vali Acc: 0.406 Test Loss: 1.199 Test Acc: 0.406
Validation loss decreased (-0.376799 --> -0.405785).  Saving model ...
Epoch: 9 cost time: 1.4603047370910645
Epoch: 9, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.135 Vali Acc: 0.471 Test Loss: 1.135 Test Acc: 0.471
Validation loss decreased (-0.405785 --> -0.471003).  Saving model ...
Epoch: 10 cost time: 1.6198928356170654
Epoch: 10, Steps: 9 | Train Loss: 1.000 Vali Loss: 1.057 Vali Acc: 0.493 Test Loss: 1.057 Test Acc: 0.493
Validation loss decreased (-0.471003 --> -0.492743).  Saving model ...
Epoch: 11 cost time: 1.6032066345214844
Epoch: 11, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.980 Vali Acc: 0.594 Test Loss: 0.980 Test Acc: 0.594
Validation loss decreased (-0.492743 --> -0.594193).  Saving model ...
Epoch: 12 cost time: 1.5117223262786865
Epoch: 12, Steps: 9 | Train Loss: 0.772 Vali Loss: 0.914 Vali Acc: 0.638 Test Loss: 0.914 Test Acc: 0.638
Validation loss decreased (-0.594193 --> -0.637672).  Saving model ...
Epoch: 13 cost time: 1.5113656520843506
Epoch: 13, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.852 Vali Acc: 0.659 Test Loss: 0.852 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 14 cost time: 1.377223014831543
Epoch: 14, Steps: 9 | Train Loss: 0.663 Vali Loss: 0.806 Vali Acc: 0.696 Test Loss: 0.806 Test Acc: 0.696
Validation loss decreased (-0.659412 --> -0.695644).  Saving model ...
Epoch: 15 cost time: 1.7321760654449463
Epoch: 15, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.760 Vali Acc: 0.710 Test Loss: 0.760 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710137).  Saving model ...
Epoch: 16 cost time: 1.633723497390747
Epoch: 16, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.722 Vali Acc: 0.725 Test Loss: 0.722 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 17 cost time: 1.374265193939209
Epoch: 17, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.705 Vali Acc: 0.696 Test Loss: 0.705 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.551130771636963
Epoch: 18, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 19 cost time: 1.4389803409576416
Epoch: 19, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 20 cost time: 1.2327854633331299
Epoch: 20, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.621 Vali Acc: 0.746 Test Loss: 0.621 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 21 cost time: 1.2925505638122559
Epoch: 21, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775356).  Saving model ...
Epoch: 22 cost time: 1.7007386684417725
Epoch: 22, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 23 cost time: 1.7710695266723633
Epoch: 23, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.481868028640747
Epoch: 24, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 1.2014973163604736
Epoch: 25, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.5109541416168213
Epoch: 26, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 1.636202335357666
Epoch: 27, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3626725673675537
Epoch: 28, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.533 Vali Acc: 0.797 Test Loss: 0.533 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.770275592803955
Epoch: 29, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 30 cost time: 1.5759234428405762
Epoch: 30, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 31 cost time: 1.7160789966583252
Epoch: 31, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 1.4359219074249268
Epoch: 32, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4846572875976562
Epoch: 33, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 1.3286700248718262
Epoch: 34, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7870829105377197
Epoch: 35, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4587302207946777
Epoch: 36, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 37 cost time: 1.6814982891082764
Epoch: 37, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4926435947418213
Epoch: 38, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891300).  Saving model ...
Epoch: 39 cost time: 1.3618354797363281
Epoch: 39, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2517118453979492
Epoch: 40, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.401684284210205
Epoch: 41, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5665686130523682
Epoch: 42, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6037638187408447
Epoch: 43, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5170011520385742
Epoch: 44, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 45 cost time: 1.677438497543335
Epoch: 45, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5520997047424316
Epoch: 46, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6207835674285889
Epoch: 47, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3194904327392578
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.387 Vali Acc: 0.899 Test Loss: 0.387 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 49 cost time: 1.577497959136963
Epoch: 49, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3533413410186768
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.426 Vali Acc: 0.884 Test Loss: 0.426 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.871856451034546
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5975255966186523
Epoch: 52, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7550325393676758
Epoch: 53, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.9703116416931152
Epoch: 54, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.438 Vali Acc: 0.884 Test Loss: 0.438 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7275550365447998
Epoch: 55, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.498260498046875
Epoch: 56, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.5211281776428223
Epoch: 57, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.0984323024749756
Epoch: 58, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 186164
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9860687255859375
Epoch: 1, Steps: 9 | Train Loss: 1.586 Vali Loss: 1.448 Vali Acc: 0.341 Test Loss: 1.448 Test Acc: 0.341
Validation loss decreased (inf --> -0.340565).  Saving model ...
Epoch: 2 cost time: 1.4895663261413574
Epoch: 2, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.168 Vali Acc: 0.543 Test Loss: 1.168 Test Acc: 0.543
Validation loss decreased (-0.340565 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 1.2293720245361328
Epoch: 3, Steps: 9 | Train Loss: 1.023 Vali Loss: 1.090 Vali Acc: 0.420 Test Loss: 1.090 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3009092807769775
Epoch: 4, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.911 Vali Acc: 0.580 Test Loss: 0.911 Test Acc: 0.580
Validation loss decreased (-0.543467 --> -0.579701).  Saving model ...
Epoch: 5 cost time: 1.4735758304595947
Epoch: 5, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.776 Vali Acc: 0.688 Test Loss: 0.776 Test Acc: 0.688
Validation loss decreased (-0.579701 --> -0.688398).  Saving model ...
Epoch: 6 cost time: 1.3751256465911865
Epoch: 6, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.779 Vali Acc: 0.652 Test Loss: 0.779 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5744473934173584
Epoch: 7, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.672 Vali Acc: 0.768 Test Loss: 0.672 Test Acc: 0.768
Validation loss decreased (-0.688398 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.3707902431488037
Epoch: 8, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2958555221557617
Epoch: 9, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.611 Vali Acc: 0.710 Test Loss: 0.611 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3394784927368164
Epoch: 10, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.729 Vali Acc: 0.667 Test Loss: 0.729 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4817988872528076
Epoch: 11, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.508 Vali Acc: 0.761 Test Loss: 0.508 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.422562837600708
Epoch: 12, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.875 Vali Acc: 0.768 Test Loss: 0.875 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2899620532989502
Epoch: 13, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.627 Vali Acc: 0.790 Test Loss: 0.627 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 14 cost time: 1.251770257949829
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
Validation loss decreased (-0.789849 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 1.2997064590454102
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4473636150360107
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.723 Vali Acc: 0.790 Test Loss: 0.723 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.305021047592163
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.684 Vali Acc: 0.833 Test Loss: 0.684 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2733538150787354
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3803913593292236
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.819 Vali Acc: 0.797 Test Loss: 0.819 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3669490814208984
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5820999145507812
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847820).  Saving model ...
Epoch: 22 cost time: 1.4252219200134277
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 23 cost time: 1.3079125881195068
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 1.4911103248596191
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4970142841339111
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 1.511157512664795
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5628056526184082
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.877 Test Loss: 0.502 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 28 cost time: 1.3717803955078125
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.370856523513794
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.877 Test Loss: 0.506 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4898569583892822
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7540674209594727
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.323801040649414
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 33 cost time: 1.375941514968872
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5470287799835205
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.335007667541504
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.02253794670105
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.276526689529419
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6339306831359863
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5197079181671143
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7951972484588623
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.591874361038208
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2874772548675537
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 7988520
model size : 35.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5436980724334717
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.255 Vali Acc: 0.435 Test Loss: 1.255 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 1.1637232303619385
Epoch: 2, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
Validation loss decreased (-0.434770 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.2531514167785645
Epoch: 3, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.956 Vali Acc: 0.580 Test Loss: 0.956 Test Acc: 0.580
Validation loss decreased (-0.499989 --> -0.579701).  Saving model ...
Epoch: 4 cost time: 1.3217148780822754
Epoch: 4, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.790 Vali Acc: 0.681 Test Loss: 0.790 Test Acc: 0.681
Validation loss decreased (-0.579701 --> -0.681152).  Saving model ...
Epoch: 5 cost time: 1.1330344676971436
Epoch: 5, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.808 Vali Acc: 0.623 Test Loss: 0.808 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2794044017791748
Epoch: 6, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.650 Vali Acc: 0.754 Test Loss: 0.650 Test Acc: 0.754
Validation loss decreased (-0.681152 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 1.365321159362793
Epoch: 7, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.0467126369476318
Epoch: 8, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.626 Vali Acc: 0.754 Test Loss: 0.626 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2755558490753174
Epoch: 9, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.753 Vali Acc: 0.754 Test Loss: 0.753 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2972548007965088
Epoch: 10, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.828 Vali Acc: 0.754 Test Loss: 0.828 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2729809284210205
Epoch: 11, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2371141910552979
Epoch: 12, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
Validation loss decreased (-0.760863 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 1.3029727935791016
Epoch: 13, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 1.2181110382080078
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.286167860031128
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.260077953338623
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4030582904815674
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.644 Vali Acc: 0.841 Test Loss: 0.644 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1242802143096924
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2401139736175537
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 20 cost time: 1.1682980060577393
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.862 Test Loss: 0.572 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 21 cost time: 1.0891597270965576
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.862 Test Loss: 0.584 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1239991188049316
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.855 Test Loss: 0.605 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1079127788543701
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2902474403381348
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.855 Test Loss: 0.621 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2144758701324463
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1888394355773926
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.862 Test Loss: 0.598 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.245405673980713
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2071363925933838
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.416916847229004
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2753586769104004
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.862 Test Loss: 0.619 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 7981608
model size : 35.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5416793823242188
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.408 Vali Acc: 0.261 Test Loss: 1.408 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 1.1733944416046143
Epoch: 2, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.129 Vali Acc: 0.558 Test Loss: 1.129 Test Acc: 0.558
Validation loss decreased (-0.260855 --> -0.557960).  Saving model ...
Epoch: 3 cost time: 1.2461519241333008
Epoch: 3, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.019 Vali Acc: 0.449 Test Loss: 1.019 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.029090404510498
Epoch: 4, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.846 Vali Acc: 0.623 Test Loss: 0.846 Test Acc: 0.623
Validation loss decreased (-0.557960 --> -0.623180).  Saving model ...
Epoch: 5 cost time: 1.0389976501464844
Epoch: 5, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.721 Vali Acc: 0.710 Test Loss: 0.721 Test Acc: 0.710
Validation loss decreased (-0.623180 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.6541240215301514
Epoch: 6, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.580 Vali Acc: 0.754 Test Loss: 0.580 Test Acc: 0.754
Validation loss decreased (-0.710138 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 1.3187384605407715
Epoch: 7, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.775 Vali Acc: 0.688 Test Loss: 0.775 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1643483638763428
Epoch: 8, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1694200038909912
Epoch: 9, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.638 Vali Acc: 0.754 Test Loss: 0.638 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.260587215423584
Epoch: 10, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 1.1742241382598877
Epoch: 11, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 1.0159368515014648
Epoch: 12, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.590 Vali Acc: 0.790 Test Loss: 0.590 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4811999797821045
Epoch: 13, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3206682205200195
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 1.2859015464782715
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3419418334960938
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 1.2796237468719482
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2038323879241943
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1806936264038086
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0484862327575684
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.862 Test Loss: 0.540 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0841469764709473
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0678305625915527
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.206026554107666
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0690548419952393
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.862 Test Loss: 0.550 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2635469436645508
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.862 Test Loss: 0.555 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2233359813690186
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 27 cost time: 1.3909718990325928
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.862 Test Loss: 0.561 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1682701110839844
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.862 Test Loss: 0.573 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1227822303771973
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.870 Test Loss: 0.554 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.31103515625
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.862 Test Loss: 0.574 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.259211778640747
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1453492641448975
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2348053455352783
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.870 Test Loss: 0.569 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2551836967468262
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.870 Test Loss: 0.559 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2558834552764893
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.862 Test Loss: 0.588 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3552830219268799
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 7974696
model size : 35.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8411800861358643
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.420 Vali Acc: 0.297 Test Loss: 1.420 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 1.179445743560791
Epoch: 2, Steps: 9 | Train Loss: 1.265 Vali Loss: 1.122 Vali Acc: 0.478 Test Loss: 1.122 Test Acc: 0.478
Validation loss decreased (-0.297087 --> -0.478250).  Saving model ...
Epoch: 3 cost time: 1.2017912864685059
Epoch: 3, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.963 Vali Acc: 0.536 Test Loss: 0.963 Test Acc: 0.536
Validation loss decreased (-0.478250 --> -0.536222).  Saving model ...
Epoch: 4 cost time: 1.4349491596221924
Epoch: 4, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.771 Vali Acc: 0.696 Test Loss: 0.771 Test Acc: 0.696
Validation loss decreased (-0.536222 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 1.4107167720794678
Epoch: 5, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.760 Vali Acc: 0.703 Test Loss: 0.760 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 1.3192026615142822
Epoch: 6, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.596 Vali Acc: 0.754 Test Loss: 0.596 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 1.6167361736297607
Epoch: 7, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 1.167550802230835
Epoch: 8, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0877397060394287
Epoch: 9, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.816 Vali Acc: 0.674 Test Loss: 0.816 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1893796920776367
Epoch: 10, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.618 Vali Acc: 0.761 Test Loss: 0.618 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3916540145874023
Epoch: 11, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.782603 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 1.3559105396270752
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.570 Vali Acc: 0.754 Test Loss: 0.570 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5629031658172607
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.772 Vali Acc: 0.812 Test Loss: 0.772 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4867722988128662
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.632 Vali Acc: 0.804 Test Loss: 0.632 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2162795066833496
Epoch: 15, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862313).  Saving model ...
Epoch: 16 cost time: 1.3015286922454834
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3503494262695312
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.862 Test Loss: 0.569 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1776764392852783
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.841 Test Loss: 0.753 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2187697887420654
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.841 Test Loss: 0.665 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2838623523712158
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.841 Test Loss: 0.614 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2297906875610352
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.848 Test Loss: 0.668 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5780761241912842
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.848 Test Loss: 0.648 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3049943447113037
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.855 Test Loss: 0.621 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5398375988006592
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.855 Test Loss: 0.629 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3341906070709229
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.848 Test Loss: 0.638 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 7967784
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.478140115737915
Epoch: 1, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.346 Vali Acc: 0.355 Test Loss: 1.346 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.2927076816558838
Epoch: 2, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.106 Vali Acc: 0.507 Test Loss: 1.106 Test Acc: 0.507
Validation loss decreased (-0.355059 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.4643008708953857
Epoch: 3, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.954 Vali Acc: 0.652 Test Loss: 0.954 Test Acc: 0.652
Validation loss decreased (-0.507235 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 1.3349580764770508
Epoch: 4, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.844 Vali Acc: 0.623 Test Loss: 0.844 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2503767013549805
Epoch: 5, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.678 Vali Acc: 0.725 Test Loss: 0.678 Test Acc: 0.725
Validation loss decreased (-0.652164 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.2203288078308105
Epoch: 6, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.676 Vali Acc: 0.717 Test Loss: 0.676 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4736015796661377
Epoch: 7, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.635 Vali Acc: 0.739 Test Loss: 0.635 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.3510634899139404
Epoch: 8, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.327685832977295
Epoch: 9, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 10 cost time: 1.236023187637329
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.688 Vali Acc: 0.674 Test Loss: 0.688 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.295588493347168
Epoch: 11, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.635 Vali Acc: 0.797 Test Loss: 0.635 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797095).  Saving model ...
Epoch: 12 cost time: 1.182769775390625
Epoch: 12, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.589 Vali Acc: 0.768 Test Loss: 0.589 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4817204475402832
Epoch: 13, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 1.482682228088379
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3734557628631592
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.551201343536377
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.732 Vali Acc: 0.812 Test Loss: 0.732 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.422682523727417
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3839120864868164
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.848 Test Loss: 0.546 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 1.2906200885772705
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3089823722839355
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5205111503601074
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.870 Test Loss: 0.515 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869560).  Saving model ...
Epoch: 22 cost time: 1.538569688796997
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.117 Vali Acc: 0.804 Test Loss: 1.117 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5050361156463623
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.290304183959961
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5419816970825195
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2789957523345947
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 1.197401762008667
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.899 Test Loss: 0.398 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 1.2584564685821533
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.899 Test Loss: 0.384 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 29 cost time: 1.3269140720367432
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2828679084777832
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.247041940689087
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4262974262237549
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3242297172546387
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3053808212280273
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2123820781707764
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.891 Test Loss: 0.406 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5317425727844238
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4579651355743408
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.899 Test Loss: 0.403 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.5108177661895752
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.899 Test Loss: 0.404 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 6675240
model size : 30.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.407996654510498
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.307 Vali Acc: 0.312 Test Loss: 1.307 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.357163429260254
Epoch: 2, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.116 Vali Acc: 0.565 Test Loss: 1.116 Test Acc: 0.565
Validation loss decreased (-0.311581 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 1.0616185665130615
Epoch: 3, Steps: 9 | Train Loss: 1.008 Vali Loss: 0.987 Vali Acc: 0.536 Test Loss: 0.987 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.294440507888794
Epoch: 4, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.882 Vali Acc: 0.587 Test Loss: 0.882 Test Acc: 0.587
Validation loss decreased (-0.565206 --> -0.586948).  Saving model ...
Epoch: 5 cost time: 1.0395987033843994
Epoch: 5, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.751 Vali Acc: 0.703 Test Loss: 0.751 Test Acc: 0.703
Validation loss decreased (-0.586948 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 1.0965890884399414
Epoch: 6, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731878).  Saving model ...
Epoch: 7 cost time: 1.1950926780700684
Epoch: 7, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.596 Vali Acc: 0.775 Test Loss: 0.596 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 1.2494144439697266
Epoch: 8, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.723 Vali Acc: 0.732 Test Loss: 0.723 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.344818353652954
Epoch: 9, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5969412326812744
Epoch: 10, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.718 Vali Acc: 0.725 Test Loss: 0.718 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.062518835067749
Epoch: 11, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818836).  Saving model ...
Epoch: 12 cost time: 1.0141184329986572
Epoch: 12, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.608 Vali Acc: 0.790 Test Loss: 0.608 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.310018539428711
Epoch: 13, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.645 Vali Acc: 0.804 Test Loss: 0.645 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1403014659881592
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.652 Vali Acc: 0.775 Test Loss: 0.652 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2554206848144531
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.686 Vali Acc: 0.768 Test Loss: 0.686 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.18388032913208
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847820).  Saving model ...
Epoch: 17 cost time: 1.3986945152282715
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 1.1369433403015137
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.778 Vali Acc: 0.855 Test Loss: 0.778 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4754104614257812
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1753883361816406
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2665627002716064
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0872387886047363
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2558043003082275
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.855 Test Loss: 0.551 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2000646591186523
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2241661548614502
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4135818481445312
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.862 Test Loss: 0.507 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2556979656219482
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 6668328
model size : 30.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1809563636779785
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.308 Vali Acc: 0.362 Test Loss: 1.308 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 1.5443315505981445
Epoch: 2, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.142 Vali Acc: 0.413 Test Loss: 1.142 Test Acc: 0.413
Validation loss decreased (-0.362306 --> -0.413032).  Saving model ...
Epoch: 3 cost time: 1.5182995796203613
Epoch: 3, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.015 Vali Acc: 0.551 Test Loss: 1.015 Test Acc: 0.551
Validation loss decreased (-0.413032 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 1.5032825469970703
Epoch: 4, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.898 Vali Acc: 0.529 Test Loss: 0.898 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2961366176605225
Epoch: 5, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.732 Vali Acc: 0.638 Test Loss: 0.732 Test Acc: 0.638
Validation loss decreased (-0.550714 --> -0.637674).  Saving model ...
Epoch: 6 cost time: 1.3793587684631348
Epoch: 6, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.826 Vali Acc: 0.696 Test Loss: 0.826 Test Acc: 0.696
Validation loss decreased (-0.637674 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 1.0919594764709473
Epoch: 7, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.653 Vali Acc: 0.768 Test Loss: 0.653 Test Acc: 0.768
Validation loss decreased (-0.695644 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.3634333610534668
Epoch: 8, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1617603302001953
Epoch: 9, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.716 Vali Acc: 0.652 Test Loss: 0.716 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4420602321624756
Epoch: 10, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.728 Vali Acc: 0.746 Test Loss: 0.728 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3178460597991943
Epoch: 11, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.685 Vali Acc: 0.826 Test Loss: 0.685 Test Acc: 0.826
Validation loss decreased (-0.768109 --> -0.826080).  Saving model ...
Epoch: 12 cost time: 1.2133877277374268
Epoch: 12, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.878 Vali Acc: 0.630 Test Loss: 0.878 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2850151062011719
Epoch: 13, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.327033519744873
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.1961407661437988
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 16 cost time: 1.1637756824493408
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2031948566436768
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.731 Vali Acc: 0.833 Test Loss: 0.731 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2156124114990234
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.862 Test Loss: 0.601 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 1.215759038925171
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.855 Test Loss: 0.567 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3210117816925049
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 21 cost time: 1.1214728355407715
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.855 Test Loss: 0.560 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2379891872406006
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.848 Test Loss: 0.597 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3081400394439697
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.862 Test Loss: 0.586 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.294567584991455
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4578876495361328
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.855 Test Loss: 0.590 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.171640396118164
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.179490566253662
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3070838451385498
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.181901454925537
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.848 Test Loss: 0.610 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.171402931213379
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.855 Test Loss: 0.600 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 6661416
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6669797897338867
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.391 Vali Acc: 0.362 Test Loss: 1.391 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.4002656936645508
Epoch: 2, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.290 Vali Acc: 0.391 Test Loss: 1.290 Test Acc: 0.391
Validation loss decreased (-0.362305 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.377610206604004
Epoch: 3, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.041 Vali Acc: 0.645 Test Loss: 1.041 Test Acc: 0.645
Validation loss decreased (-0.391291 --> -0.644917).  Saving model ...
Epoch: 4 cost time: 1.5541257858276367
Epoch: 4, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.931 Vali Acc: 0.464 Test Loss: 0.931 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.323864459991455
Epoch: 5, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.753 Vali Acc: 0.688 Test Loss: 0.753 Test Acc: 0.688
Validation loss decreased (-0.644917 --> -0.688398).  Saving model ...
Epoch: 6 cost time: 1.1962707042694092
Epoch: 6, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.736 Vali Acc: 0.667 Test Loss: 0.736 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6633572578430176
Epoch: 7, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.673 Vali Acc: 0.768 Test Loss: 0.673 Test Acc: 0.768
Validation loss decreased (-0.688398 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.7240855693817139
Epoch: 8, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.657 Vali Acc: 0.703 Test Loss: 0.657 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3020386695861816
Epoch: 9, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.450366735458374
Epoch: 10, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.373828649520874
Epoch: 11, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.649 Vali Acc: 0.688 Test Loss: 0.649 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2020633220672607
Epoch: 12, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.618 Vali Acc: 0.761 Test Loss: 0.618 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3864755630493164
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.750 Vali Acc: 0.674 Test Loss: 0.750 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2009437084197998
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.501427412033081
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.732 Vali Acc: 0.812 Test Loss: 0.732 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811587).  Saving model ...
Epoch: 16 cost time: 1.367272138595581
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.653 Vali Acc: 0.768 Test Loss: 0.653 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2775521278381348
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.973 Vali Acc: 0.819 Test Loss: 0.973 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818831).  Saving model ...
Epoch: 18 cost time: 1.4953045845031738
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
Validation loss decreased (-0.818831 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.3464038372039795
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3724055290222168
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.791 Vali Acc: 0.819 Test Loss: 0.791 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3995792865753174
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.855 Test Loss: 0.559 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6160707473754883
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.826 Test Loss: 0.644 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.428971767425537
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.841 Test Loss: 0.701 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5019688606262207
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5349717140197754
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.848 Test Loss: 0.633 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3924627304077148
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6269211769104004
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3541884422302246
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 6654504
model size : 30.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0370852947235107
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.330 Vali Acc: 0.283 Test Loss: 1.330 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.4609744548797607
Epoch: 2, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.168 Vali Acc: 0.391 Test Loss: 1.168 Test Acc: 0.391
Validation loss decreased (-0.282595 --> -0.391293).  Saving model ...
Epoch: 3 cost time: 1.5610883235931396
Epoch: 3, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.032 Vali Acc: 0.457 Test Loss: 1.032 Test Acc: 0.457
Validation loss decreased (-0.391293 --> -0.456511).  Saving model ...
Epoch: 4 cost time: 1.478257656097412
Epoch: 4, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.931 Vali Acc: 0.609 Test Loss: 0.931 Test Acc: 0.609
Validation loss decreased (-0.456511 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 1.524874210357666
Epoch: 5, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.788 Vali Acc: 0.601 Test Loss: 0.788 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4021797180175781
Epoch: 6, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.716 Vali Acc: 0.696 Test Loss: 0.716 Test Acc: 0.696
Validation loss decreased (-0.608686 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.3609848022460938
Epoch: 7, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.296004295349121
Epoch: 8, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5176911354064941
Epoch: 9, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 1.7684109210968018
Epoch: 10, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 11 cost time: 1.7275030612945557
Epoch: 11, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7667717933654785
Epoch: 12, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3795154094696045
Epoch: 13, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
Validation loss decreased (-0.760864 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.4107542037963867
Epoch: 14, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.531 Vali Acc: 0.790 Test Loss: 0.531 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.38771653175354
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.677 Vali Acc: 0.819 Test Loss: 0.677 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818834).  Saving model ...
Epoch: 16 cost time: 1.3946542739868164
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.6203453540802002
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 1.6084609031677246
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.463653802871704
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.538785457611084
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.350428819656372
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4833259582519531
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2286183834075928
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4393839836120605
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4404692649841309
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4301223754882812
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3713955879211426
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 6018600
model size : 27.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8861544132232666
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.287 Vali Acc: 0.464 Test Loss: 1.287 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 1.445937156677246
Epoch: 2, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.124 Vali Acc: 0.478 Test Loss: 1.124 Test Acc: 0.478
Validation loss decreased (-0.463755 --> -0.478250).  Saving model ...
Epoch: 3 cost time: 1.539351463317871
Epoch: 3, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.996 Vali Acc: 0.464 Test Loss: 0.996 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.628795862197876
Epoch: 4, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.877 Vali Acc: 0.551 Test Loss: 0.877 Test Acc: 0.551
Validation loss decreased (-0.478250 --> -0.550716).  Saving model ...
Epoch: 5 cost time: 1.1713683605194092
Epoch: 5, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.749 Vali Acc: 0.710 Test Loss: 0.749 Test Acc: 0.710
Validation loss decreased (-0.550716 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 1.3338453769683838
Epoch: 6, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.648 Vali Acc: 0.688 Test Loss: 0.648 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4691390991210938
Epoch: 7, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.687 Vali Acc: 0.732 Test Loss: 0.687 Test Acc: 0.732
Validation loss decreased (-0.710137 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.2733469009399414
Epoch: 8, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.619 Vali Acc: 0.739 Test Loss: 0.619 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 1.586383581161499
Epoch: 9, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.577 Vali Acc: 0.768 Test Loss: 0.577 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 1.3530323505401611
Epoch: 10, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.252974510192871
Epoch: 11, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2179365158081055
Epoch: 12, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.775357 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 1.3581974506378174
Epoch: 13, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2628154754638672
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2318894863128662
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3183493614196777
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.1985232830047607
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2723231315612793
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2343018054962158
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0845401287078857
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4346351623535156
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2488462924957275
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.848 Test Loss: 0.550 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4764647483825684
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 24 cost time: 1.3824493885040283
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.855 Test Loss: 0.618 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4791336059570312
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.212137222290039
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.855 Test Loss: 0.534 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 27 cost time: 1.3382635116577148
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.855 Test Loss: 0.586 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.279871940612793
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.855 Test Loss: 0.621 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3018333911895752
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.870 Test Loss: 0.566 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 30 cost time: 1.4095697402954102
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.870 Test Loss: 0.563 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 31 cost time: 1.5662758350372314
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4211957454681396
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.862 Test Loss: 0.568 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.613400936126709
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.862 Test Loss: 0.567 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4356725215911865
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 35 cost time: 1.519761085510254
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3985295295715332
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3918228149414062
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.870 Test Loss: 0.552 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 38 cost time: 1.3142297267913818
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.470038652420044
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.870 Test Loss: 0.570 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4684467315673828
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4257092475891113
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.870 Test Loss: 0.551 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 42 cost time: 1.410689115524292
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.870 Test Loss: 0.560 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4765276908874512
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.578235149383545
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.402482271194458
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.870 Test Loss: 0.568 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4641549587249756
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.5931899547576904
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3705103397369385
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.870 Test Loss: 0.570 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4554669857025146
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.870 Test Loss: 0.564 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4710824489593506
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.870 Test Loss: 0.564 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3192284107208252
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.870 Test Loss: 0.570 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 6011688
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.096978187561035
Epoch: 1, Steps: 9 | Train Loss: 1.527 Vali Loss: 1.447 Vali Acc: 0.268 Test Loss: 1.447 Test Acc: 0.268
Validation loss decreased (inf --> -0.268101).  Saving model ...
Epoch: 2 cost time: 1.0115737915039062
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.189 Vali Acc: 0.377 Test Loss: 1.189 Test Acc: 0.377
Validation loss decreased (-0.268101 --> -0.376800).  Saving model ...
Epoch: 3 cost time: 1.1480417251586914
Epoch: 3, Steps: 9 | Train Loss: 1.046 Vali Loss: 0.990 Vali Acc: 0.558 Test Loss: 0.990 Test Acc: 0.558
Validation loss decreased (-0.376800 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 1.2801012992858887
Epoch: 4, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.884 Vali Acc: 0.645 Test Loss: 0.884 Test Acc: 0.645
Validation loss decreased (-0.557961 --> -0.644919).  Saving model ...
Epoch: 5 cost time: 1.2155702114105225
Epoch: 5, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.810 Vali Acc: 0.587 Test Loss: 0.810 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0937423706054688
Epoch: 6, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.756 Vali Acc: 0.732 Test Loss: 0.756 Test Acc: 0.732
Validation loss decreased (-0.644919 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 1.076237678527832
Epoch: 7, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.815 Vali Acc: 0.696 Test Loss: 0.815 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0338547229766846
Epoch: 8, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.828 Vali Acc: 0.659 Test Loss: 0.828 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3953173160552979
Epoch: 9, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.744 Vali Acc: 0.667 Test Loss: 0.744 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.065324306488037
Epoch: 10, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
Validation loss decreased (-0.731876 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 1.0964763164520264
Epoch: 11, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.606 Vali Acc: 0.768 Test Loss: 0.606 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1829092502593994
Epoch: 12, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4554927349090576
Epoch: 13, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.194643497467041
Epoch: 14, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.731 Vali Acc: 0.797 Test Loss: 0.731 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3053436279296875
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
Validation loss decreased (-0.797096 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.2812721729278564
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.522 Vali Acc: 0.826 Test Loss: 0.522 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0995967388153076
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.729 Vali Acc: 0.819 Test Loss: 0.729 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2885937690734863
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.0462448596954346
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2419102191925049
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4564826488494873
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4228026866912842
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.848 Test Loss: 0.544 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4116027355194092
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2826159000396729
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1890885829925537
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.848 Test Loss: 0.555 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3016417026519775
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1351559162139893
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.848 Test Loss: 0.549 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2632241249084473
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.855 Test Loss: 0.562 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 6004776
model size : 27.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.111781358718872
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.329 Vali Acc: 0.275 Test Loss: 1.329 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.106177568435669
Epoch: 2, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.122 Vali Acc: 0.478 Test Loss: 1.122 Test Acc: 0.478
Validation loss decreased (-0.275349 --> -0.478250).  Saving model ...
Epoch: 3 cost time: 1.1231975555419922
Epoch: 3, Steps: 9 | Train Loss: 1.036 Vali Loss: 0.964 Vali Acc: 0.616 Test Loss: 0.964 Test Acc: 0.616
Validation loss decreased (-0.478250 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 1.3313653469085693
Epoch: 4, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.905 Vali Acc: 0.565 Test Loss: 0.905 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1493489742279053
Epoch: 5, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.785 Vali Acc: 0.681 Test Loss: 0.785 Test Acc: 0.681
Validation loss decreased (-0.615932 --> -0.681152).  Saving model ...
Epoch: 6 cost time: 1.1437106132507324
Epoch: 6, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717385).  Saving model ...
Epoch: 7 cost time: 1.1267070770263672
Epoch: 7, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
Validation loss decreased (-0.717385 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 1.2505128383636475
Epoch: 8, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.829 Vali Acc: 0.681 Test Loss: 0.829 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0864758491516113
Epoch: 9, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.554 Vali Acc: 0.775 Test Loss: 0.554 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3988306522369385
Epoch: 10, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.648 Vali Acc: 0.725 Test Loss: 0.648 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.413788080215454
Epoch: 11, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 1.1901030540466309
Epoch: 12, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.982 Vali Acc: 0.732 Test Loss: 0.982 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2269411087036133
Epoch: 13, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.589 Vali Acc: 0.790 Test Loss: 0.589 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.357926845550537
Epoch: 14, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.532 Vali Acc: 0.804 Test Loss: 0.532 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3059568405151367
Epoch: 15, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.703 Vali Acc: 0.812 Test Loss: 0.703 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3122293949127197
Epoch: 16, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.3320233821868896
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840574).  Saving model ...
Epoch: 18 cost time: 1.0052080154418945
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0781264305114746
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1246390342712402
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 1.2166337966918945
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1773240566253662
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.147007942199707
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2212393283843994
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2812764644622803
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0771546363830566
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1156189441680908
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3678710460662842
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.306034803390503
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3123514652252197
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 5997864
model size : 27.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.748603343963623
Epoch: 1, Steps: 9 | Train Loss: 1.564 Vali Loss: 1.440 Vali Acc: 0.246 Test Loss: 1.440 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 1.3631243705749512
Epoch: 2, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.246362 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.2074768543243408
Epoch: 3, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.052 Vali Acc: 0.514 Test Loss: 1.052 Test Acc: 0.514
Validation loss decreased (-0.485495 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.3946154117584229
Epoch: 4, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.932 Vali Acc: 0.623 Test Loss: 0.932 Test Acc: 0.623
Validation loss decreased (-0.514482 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 1.466242790222168
Epoch: 5, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.822 Vali Acc: 0.630 Test Loss: 0.822 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630427).  Saving model ...
Epoch: 6 cost time: 1.22947096824646
Epoch: 6, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.776 Vali Acc: 0.667 Test Loss: 0.776 Test Acc: 0.667
Validation loss decreased (-0.630427 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 1.6823973655700684
Epoch: 7, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
Validation loss decreased (-0.666659 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 1.3319544792175293
Epoch: 8, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.785 Vali Acc: 0.739 Test Loss: 0.785 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.394524335861206
Epoch: 9, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.673 Vali Acc: 0.754 Test Loss: 0.673 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4814386367797852
Epoch: 10, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.616 Vali Acc: 0.710 Test Loss: 0.616 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3272106647491455
Epoch: 11, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.544248342514038
Epoch: 12, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.4777133464813232
Epoch: 13, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.782603 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 1.394657850265503
Epoch: 14, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.517 Vali Acc: 0.790 Test Loss: 0.517 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3522825241088867
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.684 Vali Acc: 0.696 Test Loss: 0.684 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.326648473739624
Epoch: 16, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.407890796661377
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 1.3707411289215088
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.285940170288086
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 20 cost time: 1.4790518283843994
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.497734785079956
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2051444053649902
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2400424480438232
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.848 Test Loss: 0.535 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2192285060882568
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3313379287719727
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3704469203948975
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 27 cost time: 1.5390965938568115
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4212346076965332
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 29 cost time: 1.2848448753356934
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 30 cost time: 1.3805811405181885
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 31 cost time: 1.1478724479675293
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.158689022064209
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2356903553009033
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.366947889328003
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 35 cost time: 1.2695212364196777
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 36 cost time: 1.2865667343139648
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 37 cost time: 1.4252214431762695
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2487409114837646
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3702609539031982
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 40 cost time: 1.476898431777954
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4059698581695557
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3346590995788574
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.397341251373291
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.384343147277832
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 45 cost time: 1.2338943481445312
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2964835166931152
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.460301160812378
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5608491897583008
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.372162103652954
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.4985055923461914
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.6605830192565918
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.7806994915008545
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.5198616981506348
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2636470794677734
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 55 cost time: 1.3691143989562988
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 56 cost time: 1.3871698379516602
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.622678279876709
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4292511940002441
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.4067268371582031
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.48939847946167
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.3743572235107422
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.5712697505950928
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 63 cost time: 1.3857481479644775
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.427720069885254
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.5905344486236572
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.4342763423919678
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.4317905902862549
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.3555774688720703
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.2087929248809814
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 70 cost time: 1.135631799697876
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.3449821472167969
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.4221909046173096
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.1892280578613281
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.116157054901123
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.2251367568969727
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.497727870941162
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.2495088577270508
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.377206802368164
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.4982531070709229
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 5690280
model size : 26.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9445607662200928
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.289 Vali Acc: 0.406 Test Loss: 1.289 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.3782415390014648
Epoch: 2, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.080 Vali Acc: 0.536 Test Loss: 1.080 Test Acc: 0.536
Validation loss decreased (-0.405784 --> -0.536221).  Saving model ...
Epoch: 3 cost time: 1.353691816329956
Epoch: 3, Steps: 9 | Train Loss: 0.938 Vali Loss: 0.971 Vali Acc: 0.486 Test Loss: 0.971 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3747005462646484
Epoch: 4, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.836 Vali Acc: 0.645 Test Loss: 0.836 Test Acc: 0.645
Validation loss decreased (-0.536221 --> -0.644919).  Saving model ...
Epoch: 5 cost time: 1.2796530723571777
Epoch: 5, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.644919 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 1.1737041473388672
Epoch: 6, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.652 Vali Acc: 0.732 Test Loss: 0.652 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.120218276977539
Epoch: 7, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 8 cost time: 1.4386751651763916
Epoch: 8, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.616 Vali Acc: 0.739 Test Loss: 0.616 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5496222972869873
Epoch: 9, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.610 Vali Acc: 0.754 Test Loss: 0.610 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3626010417938232
Epoch: 10, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.495 Vali Acc: 0.790 Test Loss: 0.495 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 1.404343605041504
Epoch: 11, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4559836387634277
Epoch: 12, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.588 Vali Acc: 0.790 Test Loss: 0.588 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2427408695220947
Epoch: 13, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.4655780792236328
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.366609811782837
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.693 Vali Acc: 0.790 Test Loss: 0.693 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.61399245262146
Epoch: 16, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.4208121299743652
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.556 Vali Acc: 0.848 Test Loss: 0.556 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 1.64241361618042
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 1.3786451816558838
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 20 cost time: 1.1760072708129883
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2542550563812256
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6384985446929932
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3572170734405518
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.246070384979248
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2156071662902832
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4329919815063477
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1186017990112305
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1621205806732178
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.38033127784729
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 5683368
model size : 26.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1467251777648926
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.317 Vali Acc: 0.435 Test Loss: 1.317 Test Acc: 0.435
Validation loss decreased (inf --> -0.434769).  Saving model ...
Epoch: 2 cost time: 1.3010411262512207
Epoch: 2, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.106 Vali Acc: 0.507 Test Loss: 1.106 Test Acc: 0.507
Validation loss decreased (-0.434769 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.4984009265899658
Epoch: 3, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.056 Vali Acc: 0.471 Test Loss: 1.056 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4149975776672363
Epoch: 4, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.914 Vali Acc: 0.645 Test Loss: 0.914 Test Acc: 0.645
Validation loss decreased (-0.507235 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 1.3217556476593018
Epoch: 5, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.800 Vali Acc: 0.580 Test Loss: 0.800 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4918971061706543
Epoch: 6, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
Validation loss decreased (-0.644918 --> -0.717384).  Saving model ...
Epoch: 7 cost time: 1.2934067249298096
Epoch: 7, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.4288625717163086
Epoch: 8, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6112241744995117
Epoch: 9, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4359276294708252
Epoch: 10, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.4677543640136719
Epoch: 11, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.586 Vali Acc: 0.804 Test Loss: 0.586 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.3345952033996582
Epoch: 12, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.618 Vali Acc: 0.746 Test Loss: 0.618 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7517104148864746
Epoch: 13, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.640 Vali Acc: 0.754 Test Loss: 0.640 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4082036018371582
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.724 Vali Acc: 0.725 Test Loss: 0.724 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3197450637817383
Epoch: 15, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.580 Vali Acc: 0.790 Test Loss: 0.580 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5772356986999512
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.879 Vali Acc: 0.797 Test Loss: 0.879 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.359558343887329
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840574).  Saving model ...
Epoch: 18 cost time: 1.5955781936645508
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 1.2373714447021484
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.841 Test Loss: 0.683 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2714910507202148
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.848 Test Loss: 0.651 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.269101619720459
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1998004913330078
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 23 cost time: 1.243279218673706
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.315004587173462
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.471604585647583
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.855 Test Loss: 0.617 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5582821369171143
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.855 Test Loss: 0.619 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3176987171173096
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3936235904693604
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.855 Test Loss: 0.617 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3779585361480713
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.855 Test Loss: 0.615 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2257592678070068
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.862 Test Loss: 0.606 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 31 cost time: 1.4912409782409668
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.855 Test Loss: 0.624 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5712323188781738
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.862 Test Loss: 0.621 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.470808506011963
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.862 Test Loss: 0.626 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4312255382537842
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.862 Test Loss: 0.618 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2819552421569824
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.862 Test Loss: 0.610 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5460832118988037
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.862 Test Loss: 0.610 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3352892398834229
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.862 Test Loss: 0.609 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.551828384399414
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.862 Test Loss: 0.616 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4466462135314941
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.862 Test Loss: 0.620 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3269948959350586
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.855 Test Loss: 0.636 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 5676456
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.473132848739624
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.397 Vali Acc: 0.268 Test Loss: 1.397 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.8457746505737305
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.163 Vali Acc: 0.471 Test Loss: 1.163 Test Acc: 0.471
Validation loss decreased (-0.268102 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.4168665409088135
Epoch: 3, Steps: 9 | Train Loss: 1.067 Vali Loss: 0.982 Vali Acc: 0.645 Test Loss: 0.982 Test Acc: 0.645
Validation loss decreased (-0.471003 --> -0.644918).  Saving model ...
Epoch: 4 cost time: 1.447209119796753
Epoch: 4, Steps: 9 | Train Loss: 0.834 Vali Loss: 0.914 Vali Acc: 0.565 Test Loss: 0.914 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4910547733306885
Epoch: 5, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.867 Vali Acc: 0.580 Test Loss: 0.867 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.336329698562622
Epoch: 6, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
Validation loss decreased (-0.644918 --> -0.717385).  Saving model ...
Epoch: 7 cost time: 1.4018712043762207
Epoch: 7, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.743 Vali Acc: 0.696 Test Loss: 0.743 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3977575302124023
Epoch: 8, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
Validation loss decreased (-0.717385 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 1.3946008682250977
Epoch: 9, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.358222484588623
Epoch: 10, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6432225704193115
Epoch: 11, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.649 Vali Acc: 0.725 Test Loss: 0.649 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2761192321777344
Epoch: 12, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.736 Vali Acc: 0.659 Test Loss: 0.736 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2955026626586914
Epoch: 13, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.510 Vali Acc: 0.790 Test Loss: 0.510 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 14 cost time: 1.280052900314331
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.608 Vali Acc: 0.826 Test Loss: 0.608 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826081).  Saving model ...
Epoch: 15 cost time: 1.6195824146270752
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3194406032562256
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.5117015838623047
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 1.2312202453613281
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840574).  Saving model ...
Epoch: 19 cost time: 1.1513006687164307
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4261929988861084
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 21 cost time: 1.734680414199829
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 22 cost time: 1.4444410800933838
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4711601734161377
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4807322025299072
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 1.2026119232177734
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2476379871368408
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4851222038269043
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.474471092224121
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.628432035446167
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4531283378601074
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.621199369430542
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2000455856323242
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6069865226745605
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5412335395812988
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 35 cost time: 1.5221030712127686
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5073144435882568
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.0494115352630615
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.66103196144104
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.848 Test Loss: 0.579 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.45652437210083
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 40 cost time: 1.3877661228179932
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3663489818572998
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.202721357345581
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.855 Test Loss: 0.580 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6258249282836914
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.478531837463379
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6218514442443848
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3213956356048584
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.282090187072754
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.512519359588623
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.5329654216766357
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 5669544
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3987514972686768
Epoch: 1, Steps: 9 | Train Loss: 1.514 Vali Loss: 1.442 Vali Acc: 0.203 Test Loss: 1.442 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 1.2964551448822021
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.275 Vali Acc: 0.478 Test Loss: 1.275 Test Acc: 0.478
Validation loss decreased (-0.202884 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.5695438385009766
Epoch: 3, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
Validation loss decreased (-0.478248 --> -0.543467).  Saving model ...
Epoch: 4 cost time: 1.6046478748321533
Epoch: 4, Steps: 9 | Train Loss: 0.941 Vali Loss: 0.958 Vali Acc: 0.601 Test Loss: 0.958 Test Acc: 0.601
Validation loss decreased (-0.543467 --> -0.601440).  Saving model ...
Epoch: 5 cost time: 1.6424331665039062
Epoch: 5, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.809 Vali Acc: 0.681 Test Loss: 0.809 Test Acc: 0.681
Validation loss decreased (-0.601440 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.4635612964630127
Epoch: 6, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.694 Vali Acc: 0.710 Test Loss: 0.694 Test Acc: 0.710
Validation loss decreased (-0.681151 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.424342393875122
Epoch: 7, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.652 Vali Acc: 0.710 Test Loss: 0.652 Test Acc: 0.710
Validation loss decreased (-0.710138 --> -0.710138).  Saving model ...
Epoch: 8 cost time: 1.7172441482543945
Epoch: 8, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
Validation loss decreased (-0.710138 --> -0.746371).  Saving model ...
Epoch: 9 cost time: 1.1898493766784668
Epoch: 9, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.561 Vali Acc: 0.768 Test Loss: 0.561 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 1.3248803615570068
Epoch: 10, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.423304557800293
Epoch: 11, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 1.2906670570373535
Epoch: 12, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4840757846832275
Epoch: 13, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 14 cost time: 1.2763116359710693
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.23142671585083
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 1.3153676986694336
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5706193447113037
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.833 Test Loss: 0.496 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 1.2628917694091797
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 1.3789222240447998
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 1.3983726501464844
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4573101997375488
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2829656600952148
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 1.781926155090332
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6623542308807373
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4722788333892822
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 1.7222559452056885
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 1.6080553531646729
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2810518741607666
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5118293762207031
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5664758682250977
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.508080005645752
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5875816345214844
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.41074800491333
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.870 Test Loss: 0.477 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7054307460784912
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7657201290130615
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.498108148574829
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 2686120
model size : 12.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9771547317504883
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.394 Vali Acc: 0.254 Test Loss: 1.394 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.3662981986999512
Epoch: 2, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.268 Vali Acc: 0.391 Test Loss: 1.268 Test Acc: 0.391
Validation loss decreased (-0.253609 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 1.173466444015503
Epoch: 3, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
Validation loss decreased (-0.391292 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.0768792629241943
Epoch: 4, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.948 Vali Acc: 0.681 Test Loss: 0.948 Test Acc: 0.681
Validation loss decreased (-0.499989 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 1.335066318511963
Epoch: 5, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.808 Vali Acc: 0.688 Test Loss: 0.808 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688398).  Saving model ...
Epoch: 6 cost time: 1.427976369857788
Epoch: 6, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.735 Vali Acc: 0.703 Test Loss: 0.735 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.116452693939209
Epoch: 7, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 8 cost time: 1.3164212703704834
Epoch: 8, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.604 Vali Acc: 0.703 Test Loss: 0.604 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.262087106704712
Epoch: 9, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.589 Vali Acc: 0.739 Test Loss: 0.589 Test Acc: 0.739
Validation loss decreased (-0.717385 --> -0.739125).  Saving model ...
Epoch: 10 cost time: 1.470848798751831
Epoch: 10, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.529 Vali Acc: 0.775 Test Loss: 0.529 Test Acc: 0.775
Validation loss decreased (-0.739125 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.1572811603546143
Epoch: 11, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.559 Vali Acc: 0.754 Test Loss: 0.559 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1089558601379395
Epoch: 12, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4152178764343262
Epoch: 13, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
Validation loss decreased (-0.775357 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.1670684814453125
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.480 Vali Acc: 0.812 Test Loss: 0.480 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.255615472793579
Epoch: 15, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.198157548904419
Epoch: 16, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1240663528442383
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1632680892944336
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 1.100435495376587
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1680653095245361
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.1515812873840332
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2807121276855469
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 1.0740184783935547
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 1.0994172096252441
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 1.1732103824615479
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 26 cost time: 1.2887744903564453
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1692562103271484
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.884 Test Loss: 0.417 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4542734622955322
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.426 Vali Acc: 0.884 Test Loss: 0.426 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1767921447753906
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1667516231536865
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3298497200012207
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4119181632995605
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2408080101013184
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2449297904968262
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2914507389068604
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2682664
model size : 12.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.581696033477783
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.292 Vali Acc: 0.384 Test Loss: 1.292 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.23221755027771
Epoch: 2, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.184 Vali Acc: 0.471 Test Loss: 1.184 Test Acc: 0.471
Validation loss decreased (-0.384045 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.3211393356323242
Epoch: 3, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.085 Vali Acc: 0.428 Test Loss: 1.085 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3625011444091797
Epoch: 4, Steps: 9 | Train Loss: 0.905 Vali Loss: 1.026 Vali Acc: 0.601 Test Loss: 1.026 Test Acc: 0.601
Validation loss decreased (-0.471003 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.409064531326294
Epoch: 5, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.911 Vali Acc: 0.493 Test Loss: 0.911 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3627169132232666
Epoch: 6, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.751 Vali Acc: 0.703 Test Loss: 0.751 Test Acc: 0.703
Validation loss decreased (-0.601439 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.2807767391204834
Epoch: 7, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.656 Vali Acc: 0.732 Test Loss: 0.656 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.3529279232025146
Epoch: 8, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.684 Vali Acc: 0.710 Test Loss: 0.684 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7181134223937988
Epoch: 9, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 1.18501615524292
Epoch: 10, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760864).  Saving model ...
Epoch: 11 cost time: 1.4394376277923584
Epoch: 11, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.595 Vali Acc: 0.754 Test Loss: 0.595 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4594333171844482
Epoch: 12, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 1.2360260486602783
Epoch: 13, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.489 Vali Acc: 0.812 Test Loss: 0.489 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.3655686378479004
Epoch: 14, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 1.6744892597198486
Epoch: 15, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.583 Vali Acc: 0.812 Test Loss: 0.583 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7148542404174805
Epoch: 16, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.471 Vali Acc: 0.812 Test Loss: 0.471 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6713168621063232
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8882436752319336
Epoch: 18, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 19 cost time: 1.2946360111236572
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.4825465679168701
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 1.2897887229919434
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.536698341369629
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4210460186004639
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1652014255523682
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3739418983459473
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5133147239685059
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4108507633209229
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4463930130004883
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2273437976837158
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2174201011657715
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 2679208
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.416227340698242
Epoch: 1, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.328 Vali Acc: 0.239 Test Loss: 1.328 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 1.442302942276001
Epoch: 2, Steps: 9 | Train Loss: 1.242 Vali Loss: 1.170 Vali Acc: 0.478 Test Loss: 1.170 Test Acc: 0.478
Validation loss decreased (-0.239117 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 1.1887264251708984
Epoch: 3, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.053 Vali Acc: 0.478 Test Loss: 1.053 Test Acc: 0.478
Validation loss decreased (-0.478249 --> -0.478250).  Saving model ...
Epoch: 4 cost time: 1.2344365119934082
Epoch: 4, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.913 Vali Acc: 0.609 Test Loss: 0.913 Test Acc: 0.609
Validation loss decreased (-0.478250 --> -0.608687).  Saving model ...
Epoch: 5 cost time: 1.2299330234527588
Epoch: 5, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.795 Vali Acc: 0.674 Test Loss: 0.795 Test Acc: 0.674
Validation loss decreased (-0.608687 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.1129016876220703
Epoch: 6, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.745 Vali Acc: 0.703 Test Loss: 0.745 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.0887510776519775
Epoch: 7, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.618 Vali Acc: 0.746 Test Loss: 0.618 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.2758839130401611
Epoch: 8, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.667 Vali Acc: 0.674 Test Loss: 0.667 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2754206657409668
Epoch: 9, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760863).  Saving model ...
Epoch: 10 cost time: 1.2444379329681396
Epoch: 10, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.556 Vali Acc: 0.768 Test Loss: 0.556 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 11 cost time: 1.2006547451019287
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
Validation loss decreased (-0.768110 --> -0.818836).  Saving model ...
Epoch: 12 cost time: 1.300671100616455
Epoch: 12, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1890294551849365
Epoch: 13, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.138395071029663
Epoch: 14, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4771020412445068
Epoch: 15, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.706 Vali Acc: 0.768 Test Loss: 0.706 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2920403480529785
Epoch: 16, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.3144969940185547
Epoch: 17, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4512567520141602
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.473886489868164
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3541197776794434
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2161166667938232
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0983026027679443
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4900939464569092
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 24 cost time: 1.379495620727539
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 1.2513277530670166
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3421528339385986
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2287428379058838
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6469404697418213
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3590517044067383
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 30 cost time: 1.3280913829803467
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2973198890686035
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2991302013397217
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3988730907440186
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.373955488204956
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 35 cost time: 1.4080424308776855
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.870 Test Loss: 0.524 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4564054012298584
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.870 Test Loss: 0.518 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3784658908843994
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2558398246765137
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.877 Test Loss: 0.511 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 39 cost time: 1.241835117340088
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.262150764465332
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.877 Test Loss: 0.525 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4866490364074707
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4939298629760742
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1344690322875977
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.877 Test Loss: 0.513 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.362074613571167
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.877 Test Loss: 0.532 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7412309646606445
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.566425085067749
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.877 Test Loss: 0.507 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876807).  Saving model ...
Epoch: 47 cost time: 1.2042818069458008
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 48 cost time: 1.224431037902832
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.877 Test Loss: 0.523 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5075969696044922
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.877 Test Loss: 0.529 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2305397987365723
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.877 Test Loss: 0.529 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4268856048583984
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.877 Test Loss: 0.534 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2423827648162842
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.877 Test Loss: 0.524 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.114781141281128
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1054046154022217
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.877 Test Loss: 0.547 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.250844955444336
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.877 Test Loss: 0.542 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1235501766204834
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.877 Test Loss: 0.536 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.2152225971221924
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.877 Test Loss: 0.542 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2675752
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9666531085968018
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.357 Vali Acc: 0.290 Test Loss: 1.357 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.2215633392333984
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.212 Vali Acc: 0.522 Test Loss: 1.212 Test Acc: 0.522
Validation loss decreased (-0.289841 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.1043822765350342
Epoch: 3, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.110 Vali Acc: 0.507 Test Loss: 1.110 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1356289386749268
Epoch: 4, Steps: 9 | Train Loss: 0.987 Vali Loss: 0.979 Vali Acc: 0.609 Test Loss: 0.979 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 1.2068800926208496
Epoch: 5, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.857 Vali Acc: 0.667 Test Loss: 0.857 Test Acc: 0.667
Validation loss decreased (-0.608686 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.220825433731079
Epoch: 6, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.746 Vali Acc: 0.732 Test Loss: 0.746 Test Acc: 0.732
Validation loss decreased (-0.666658 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.2647197246551514
Epoch: 7, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.694 Vali Acc: 0.688 Test Loss: 0.694 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1713430881500244
Epoch: 8, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.669 Vali Acc: 0.725 Test Loss: 0.669 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.221757173538208
Epoch: 9, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 10 cost time: 1.2345364093780518
Epoch: 10, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2615513801574707
Epoch: 11, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.543 Vali Acc: 0.790 Test Loss: 0.543 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789850).  Saving model ...
Epoch: 12 cost time: 1.1646630764007568
Epoch: 12, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.598 Vali Acc: 0.768 Test Loss: 0.598 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1801416873931885
Epoch: 13, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 1.1922521591186523
Epoch: 14, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.535 Vali Acc: 0.804 Test Loss: 0.535 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5352795124053955
Epoch: 15, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2360320091247559
Epoch: 16, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.501 Vali Acc: 0.804 Test Loss: 0.501 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2503323554992676
Epoch: 17, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 1.3820641040802002
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.500 Vali Acc: 0.804 Test Loss: 0.500 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2555968761444092
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2560255527496338
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 1.3928759098052979
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.467 Vali Acc: 0.826 Test Loss: 0.467 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4056427478790283
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 1.3866932392120361
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.285719871520996
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 1.373260736465454
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3290603160858154
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3437039852142334
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.3416354656219482
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 1.4601209163665771
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3510873317718506
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 31 cost time: 1.1245949268341064
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 32 cost time: 1.2092845439910889
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 33 cost time: 1.1168804168701172
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.884 Test Loss: 0.410 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4081130027770996
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.353431224822998
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2701184749603271
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1629626750946045
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0219264030456543
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 39 cost time: 1.2629642486572266
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4661738872528076
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 41 cost time: 1.2001688480377197
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.884 Test Loss: 0.398 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.091367483139038
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 43 cost time: 1.1176002025604248
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.899 Test Loss: 0.404 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 44 cost time: 1.2107415199279785
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 45 cost time: 1.2366511821746826
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3415577411651611
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.906 Test Loss: 0.389 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 47 cost time: 1.1355571746826172
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.906 Test Loss: 0.393 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3141722679138184
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.899 Test Loss: 0.398 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2579569816589355
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.899 Test Loss: 0.395 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.6228563785552979
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.899 Test Loss: 0.401 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.288196086883545
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.899 Test Loss: 0.399 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2254014015197754
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 53 cost time: 1.3710651397705078
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.906 Test Loss: 0.403 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3843269348144531
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.906 Test Loss: 0.390 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.471691608428955
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.906 Test Loss: 0.381 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.424978494644165
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.866973876953125
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.394982099533081
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.5246715545654297
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.906 Test Loss: 0.393 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.486492395401001
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.906 Test Loss: 0.390 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.7975385189056396
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.3076081275939941
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 2028200
model size : 10.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.932548761367798
Epoch: 1, Steps: 9 | Train Loss: 1.482 Vali Loss: 1.385 Vali Acc: 0.377 Test Loss: 1.385 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 1.5705406665802002
Epoch: 2, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
Validation loss decreased (-0.376798 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.587632417678833
Epoch: 3, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.128 Vali Acc: 0.536 Test Loss: 1.128 Test Acc: 0.536
Validation loss decreased (-0.485495 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 1.4252455234527588
Epoch: 4, Steps: 9 | Train Loss: 0.988 Vali Loss: 1.003 Vali Acc: 0.616 Test Loss: 1.003 Test Acc: 0.616
Validation loss decreased (-0.536221 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.0992374420166016
Epoch: 5, Steps: 9 | Train Loss: 0.835 Vali Loss: 0.882 Vali Acc: 0.609 Test Loss: 0.882 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.200770378112793
Epoch: 6, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.794 Vali Acc: 0.645 Test Loss: 0.794 Test Acc: 0.645
Validation loss decreased (-0.615932 --> -0.644920).  Saving model ...
Epoch: 7 cost time: 1.2353291511535645
Epoch: 7, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
Validation loss decreased (-0.644920 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.299851417541504
Epoch: 8, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.683 Vali Acc: 0.688 Test Loss: 0.683 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3577940464019775
Epoch: 9, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.664 Vali Acc: 0.674 Test Loss: 0.664 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4330170154571533
Epoch: 10, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.578 Vali Acc: 0.739 Test Loss: 0.578 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739125).  Saving model ...
Epoch: 11 cost time: 1.409092664718628
Epoch: 11, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2064566612243652
Epoch: 12, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.739125 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.197458267211914
Epoch: 13, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.571 Vali Acc: 0.754 Test Loss: 0.571 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2042598724365234
Epoch: 14, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.505 Vali Acc: 0.797 Test Loss: 0.505 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 1.2138490676879883
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.450 Vali Acc: 0.797 Test Loss: 0.450 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797097).  Saving model ...
Epoch: 16 cost time: 1.4471070766448975
Epoch: 16, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.496 Vali Acc: 0.790 Test Loss: 0.496 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2932002544403076
Epoch: 17, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
Validation loss decreased (-0.797097 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 1.5587844848632812
Epoch: 18, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.738 Vali Acc: 0.790 Test Loss: 0.738 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.738313913345337
Epoch: 19, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.459 Vali Acc: 0.812 Test Loss: 0.459 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2015495300292969
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.587 Vali Acc: 0.826 Test Loss: 0.587 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3705241680145264
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 1.3170104026794434
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4052579402923584
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 1.5774147510528564
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 1.558664083480835
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8496568202972412
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.262824535369873
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2953431606292725
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 29 cost time: 1.2585580348968506
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 30 cost time: 1.4469330310821533
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 1.4293148517608643
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 1.5472450256347656
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 33 cost time: 1.202662706375122
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5710563659667969
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2564659118652344
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 36 cost time: 1.475654125213623
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.390516996383667
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 38 cost time: 1.5692083835601807
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3685994148254395
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5068695545196533
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5960824489593506
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.521111011505127
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4230222702026367
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7263166904449463
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4637248516082764
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.318807601928711
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.870 Test Loss: 0.448 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.4409964084625244
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2024744
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.07958984375
Epoch: 1, Steps: 9 | Train Loss: 1.563 Vali Loss: 1.393 Vali Acc: 0.406 Test Loss: 1.393 Test Acc: 0.406
Validation loss decreased (inf --> -0.405783).  Saving model ...
Epoch: 2 cost time: 1.4142403602600098
Epoch: 2, Steps: 9 | Train Loss: 1.509 Vali Loss: 1.385 Vali Acc: 0.290 Test Loss: 1.385 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5328609943389893
Epoch: 3, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.197 Vali Acc: 0.413 Test Loss: 1.197 Test Acc: 0.413
Validation loss decreased (-0.405783 --> -0.413032).  Saving model ...
Epoch: 4 cost time: 1.1901400089263916
Epoch: 4, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.031 Vali Acc: 0.587 Test Loss: 1.031 Test Acc: 0.587
Validation loss decreased (-0.413032 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 1.2897131443023682
Epoch: 5, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.917 Vali Acc: 0.558 Test Loss: 0.917 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3216166496276855
Epoch: 6, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.803 Vali Acc: 0.659 Test Loss: 0.803 Test Acc: 0.659
Validation loss decreased (-0.586946 --> -0.659412).  Saving model ...
Epoch: 7 cost time: 1.3421127796173096
Epoch: 7, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.711 Vali Acc: 0.710 Test Loss: 0.711 Test Acc: 0.710
Validation loss decreased (-0.659412 --> -0.710138).  Saving model ...
Epoch: 8 cost time: 1.4572420120239258
Epoch: 8, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.678 Vali Acc: 0.681 Test Loss: 0.678 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.359788417816162
Epoch: 9, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.630 Vali Acc: 0.696 Test Loss: 0.630 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2882907390594482
Epoch: 10, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.640 Vali Acc: 0.710 Test Loss: 0.640 Test Acc: 0.710
Validation loss decreased (-0.710138 --> -0.710139).  Saving model ...
Epoch: 11 cost time: 1.320333480834961
Epoch: 11, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.591 Vali Acc: 0.725 Test Loss: 0.591 Test Acc: 0.725
Validation loss decreased (-0.710139 --> -0.724632).  Saving model ...
Epoch: 12 cost time: 1.1537485122680664
Epoch: 12, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.571 Vali Acc: 0.754 Test Loss: 0.571 Test Acc: 0.754
Validation loss decreased (-0.724632 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 1.2553551197052002
Epoch: 13, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 1.4629440307617188
Epoch: 14, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
Validation loss decreased (-0.782603 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 1.3624787330627441
Epoch: 15, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.493 Vali Acc: 0.812 Test Loss: 0.493 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7279994487762451
Epoch: 16, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3901841640472412
Epoch: 17, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 1.2771110534667969
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 1.286667823791504
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 1.3297266960144043
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.551 Vali Acc: 0.855 Test Loss: 0.551 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 21 cost time: 1.3545563220977783
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.16184663772583
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 23 cost time: 1.4112505912780762
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3821263313293457
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.496 Vali Acc: 0.870 Test Loss: 0.496 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 25 cost time: 1.2292280197143555
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.123927116394043
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3247785568237305
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.290968894958496
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 29 cost time: 1.1785688400268555
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1772074699401855
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.310983657836914
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.877 Test Loss: 0.507 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1735682487487793
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2734484672546387
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.877 Test Loss: 0.515 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1170072555541992
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.877 Test Loss: 0.515 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2709136009216309
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3094274997711182
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.445582389831543
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.877 Test Loss: 0.522 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1403496265411377
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.877 Test Loss: 0.555 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2021288
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.36867094039917
Epoch: 1, Steps: 9 | Train Loss: 1.500 Vali Loss: 1.425 Vali Acc: 0.283 Test Loss: 1.425 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 1.5386784076690674
Epoch: 2, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.320 Vali Acc: 0.312 Test Loss: 1.320 Test Acc: 0.312
Validation loss decreased (-0.282594 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 1.4599885940551758
Epoch: 3, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.311581 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.6290407180786133
Epoch: 4, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.059 Vali Acc: 0.478 Test Loss: 1.059 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2489440441131592
Epoch: 5, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.964 Vali Acc: 0.601 Test Loss: 0.964 Test Acc: 0.601
Validation loss decreased (-0.499988 --> -0.601440).  Saving model ...
Epoch: 6 cost time: 1.340132236480713
Epoch: 6, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.865 Vali Acc: 0.551 Test Loss: 0.865 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3017685413360596
Epoch: 7, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.806 Vali Acc: 0.674 Test Loss: 0.806 Test Acc: 0.674
Validation loss decreased (-0.601440 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.4111549854278564
Epoch: 8, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.717 Vali Acc: 0.688 Test Loss: 0.717 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688399).  Saving model ...
Epoch: 9 cost time: 1.6138010025024414
Epoch: 9, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (-0.688399 --> -0.717385).  Saving model ...
Epoch: 10 cost time: 1.2771894931793213
Epoch: 10, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
Validation loss decreased (-0.717385 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.0438416004180908
Epoch: 11, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 1.4377453327178955
Epoch: 12, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2525715827941895
Epoch: 13, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.595 Vali Acc: 0.754 Test Loss: 0.595 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.357379674911499
Epoch: 14, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.567 Vali Acc: 0.790 Test Loss: 0.567 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 1.3513123989105225
Epoch: 15, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 1.4023289680480957
Epoch: 16, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2826311588287354
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.493 Vali Acc: 0.826 Test Loss: 0.493 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 1.3188235759735107
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.536972999572754
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4158735275268555
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 1.3847837448120117
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2626745700836182
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8951101303100586
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.20961594581604
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4080932140350342
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.333139181137085
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3684837818145752
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.590468168258667
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7317183017730713
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4586453437805176
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 2017832
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3517422676086426
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.357 Vali Acc: 0.232 Test Loss: 1.357 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.2942259311676025
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
Validation loss decreased (-0.231870 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.3833320140838623
Epoch: 3, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.118 Vali Acc: 0.551 Test Loss: 1.118 Test Acc: 0.551
Validation loss decreased (-0.485495 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 1.3898048400878906
Epoch: 4, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.004 Vali Acc: 0.645 Test Loss: 1.004 Test Acc: 0.645
Validation loss decreased (-0.550713 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 1.3595178127288818
Epoch: 5, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.904 Vali Acc: 0.645 Test Loss: 0.904 Test Acc: 0.645
Validation loss decreased (-0.644917 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 1.4816076755523682
Epoch: 6, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.809 Vali Acc: 0.688 Test Loss: 0.809 Test Acc: 0.688
Validation loss decreased (-0.644918 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 1.1226840019226074
Epoch: 7, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.2238988876342773
Epoch: 8, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.277763843536377
Epoch: 9, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.635 Vali Acc: 0.725 Test Loss: 0.635 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.54355788230896
Epoch: 10, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.596 Vali Acc: 0.725 Test Loss: 0.596 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4813315868377686
Epoch: 11, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.543 Vali Acc: 0.790 Test Loss: 0.543 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789850).  Saving model ...
Epoch: 12 cost time: 1.3098559379577637
Epoch: 12, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.693833351135254
Epoch: 13, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3388819694519043
Epoch: 14, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.560 Vali Acc: 0.790 Test Loss: 0.560 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.14985990524292
Epoch: 15, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.540 Vali Acc: 0.797 Test Loss: 0.540 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 1.345172643661499
Epoch: 16, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 1.3886992931365967
Epoch: 17, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.523 Vali Acc: 0.797 Test Loss: 0.523 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.582636833190918
Epoch: 18, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2742843627929688
Epoch: 19, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 1.2168705463409424
Epoch: 20, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.790 Test Loss: 0.574 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1798739433288574
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 1.1428616046905518
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.693432331085205
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 1.2240188121795654
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5200726985931396
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3019568920135498
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3315563201904297
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.279463291168213
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2617523670196533
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5130515098571777
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2419395446777344
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.683197021484375
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3768351078033447
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1699240
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4602582454681396
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.396 Vali Acc: 0.261 Test Loss: 1.396 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.7174346446990967
Epoch: 2, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.292 Vali Acc: 0.413 Test Loss: 1.292 Test Acc: 0.413
Validation loss decreased (-0.260856 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.4225502014160156
Epoch: 3, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.165 Vali Acc: 0.449 Test Loss: 1.165 Test Acc: 0.449
Validation loss decreased (-0.413031 --> -0.449264).  Saving model ...
Epoch: 4 cost time: 1.4545538425445557
Epoch: 4, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.072 Vali Acc: 0.536 Test Loss: 1.072 Test Acc: 0.536
Validation loss decreased (-0.449264 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 1.567697525024414
Epoch: 5, Steps: 9 | Train Loss: 0.886 Vali Loss: 0.924 Vali Acc: 0.616 Test Loss: 0.924 Test Acc: 0.616
Validation loss decreased (-0.536221 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 1.184302568435669
Epoch: 6, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.860 Vali Acc: 0.681 Test Loss: 0.860 Test Acc: 0.681
Validation loss decreased (-0.615933 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.6313774585723877
Epoch: 7, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.736 Vali Acc: 0.688 Test Loss: 0.736 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.227952241897583
Epoch: 8, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.3514585494995117
Epoch: 9, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746371).  Saving model ...
Epoch: 10 cost time: 1.3751370906829834
Epoch: 10, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.632 Vali Acc: 0.754 Test Loss: 0.632 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 11 cost time: 1.4051074981689453
Epoch: 11, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3414475917816162
Epoch: 12, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.7010157108306885
Epoch: 13, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.519 Vali Acc: 0.812 Test Loss: 0.519 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.4224390983581543
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2545356750488281
Epoch: 15, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 16 cost time: 1.4117228984832764
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.47462797164917
Epoch: 17, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.486 Vali Acc: 0.804 Test Loss: 0.486 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4224498271942139
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.483 Vali Acc: 0.804 Test Loss: 0.483 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6043293476104736
Epoch: 19, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.811590 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 1.2847390174865723
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4366321563720703
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.410764217376709
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 23 cost time: 1.261667013168335
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7585277557373047
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.360405445098877
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 1.3154947757720947
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3124988079071045
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1024937629699707
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6276164054870605
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2638990879058838
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3427276611328125
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2942278385162354
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4711501598358154
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2387299537658691
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2799742221832275
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.862 Test Loss: 0.508 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1695784
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.974215507507324
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.333 Vali Acc: 0.435 Test Loss: 1.333 Test Acc: 0.435
Validation loss decreased (inf --> -0.434769).  Saving model ...
Epoch: 2 cost time: 1.2712328433990479
Epoch: 2, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.232 Vali Acc: 0.543 Test Loss: 1.232 Test Acc: 0.543
Validation loss decreased (-0.434769 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 1.1857554912567139
Epoch: 3, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4357266426086426
Epoch: 4, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.996 Vali Acc: 0.594 Test Loss: 0.996 Test Acc: 0.594
Validation loss decreased (-0.543466 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 1.4179911613464355
Epoch: 5, Steps: 9 | Train Loss: 0.833 Vali Loss: 0.868 Vali Acc: 0.667 Test Loss: 0.868 Test Acc: 0.667
Validation loss decreased (-0.594193 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.3570468425750732
Epoch: 6, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.756 Vali Acc: 0.681 Test Loss: 0.756 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 1.8337247371673584
Epoch: 7, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.2457351684570312
Epoch: 8, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.2966523170471191
Epoch: 9, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
Validation loss decreased (-0.717385 --> -0.731878).  Saving model ...
Epoch: 10 cost time: 1.2549464702606201
Epoch: 10, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.579 Vali Acc: 0.739 Test Loss: 0.579 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739125).  Saving model ...
Epoch: 11 cost time: 1.1157252788543701
Epoch: 11, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
Validation loss decreased (-0.739125 --> -0.760864).  Saving model ...
Epoch: 12 cost time: 1.4363503456115723
Epoch: 12, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.559 Vali Acc: 0.739 Test Loss: 0.559 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.346147060394287
Epoch: 13, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6088192462921143
Epoch: 14, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.612 Vali Acc: 0.790 Test Loss: 0.612 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 1.419524908065796
Epoch: 15, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5208172798156738
Epoch: 16, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5071046352386475
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.170210838317871
Epoch: 18, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 1.2489123344421387
Epoch: 19, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.565 Vali Acc: 0.804 Test Loss: 0.565 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 20 cost time: 1.255211591720581
Epoch: 20, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 1.2307367324829102
Epoch: 21, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2372992038726807
Epoch: 22, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3078758716583252
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.848 Test Loss: 0.563 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847820).  Saving model ...
Epoch: 24 cost time: 1.1418068408966064
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 1.2799272537231445
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 26 cost time: 1.6805076599121094
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1220510005950928
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.4182617664337158
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.848 Test Loss: 0.536 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4184050559997559
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.386833906173706
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4742765426635742
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.386204481124878
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.862 Test Loss: 0.516 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 33 cost time: 1.186640739440918
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6136419773101807
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 35 cost time: 1.2420380115509033
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3810594081878662
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2012028694152832
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2580008506774902
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.862 Test Loss: 0.524 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2141008377075195
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 40 cost time: 1.4723987579345703
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2913315296173096
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.862 Test Loss: 0.521 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2349269390106201
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.224327564239502
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.870 Test Loss: 0.526 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 44 cost time: 1.331719160079956
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.877 Test Loss: 0.520 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 45 cost time: 1.1698150634765625
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.461921215057373
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.439936637878418
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3759706020355225
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3550853729248047
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3927960395812988
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.4598546028137207
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2181077003479004
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.4500470161437988
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.877 Test Loss: 0.517 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 54 cost time: 1.3041210174560547
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.877 Test Loss: 0.518 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3318891525268555
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.877 Test Loss: 0.529 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.056553602218628
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.877 Test Loss: 0.545 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.6347646713256836
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.877 Test Loss: 0.543 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2484474182128906
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.877 Test Loss: 0.522 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1670820713043213
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.877 Test Loss: 0.522 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.3487188816070557
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.877 Test Loss: 0.550 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.5715930461883545
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.877 Test Loss: 0.547 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.4735963344573975
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.877 Test Loss: 0.539 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.3382515907287598
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.877 Test Loss: 0.549 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1692328
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.326373815536499
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
Validation loss decreased (inf --> -0.485494).  Saving model ...
Epoch: 2 cost time: 1.3262925148010254
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.192 Vali Acc: 0.442 Test Loss: 1.192 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.121960163116455
Epoch: 3, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.043 Vali Acc: 0.580 Test Loss: 1.043 Test Acc: 0.580
Validation loss decreased (-0.485494 --> -0.579700).  Saving model ...
Epoch: 4 cost time: 1.2500488758087158
Epoch: 4, Steps: 9 | Train Loss: 0.959 Vali Loss: 0.931 Vali Acc: 0.601 Test Loss: 0.931 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601440).  Saving model ...
Epoch: 5 cost time: 1.2927944660186768
Epoch: 5, Steps: 9 | Train Loss: 0.775 Vali Loss: 0.857 Vali Acc: 0.652 Test Loss: 0.857 Test Acc: 0.652
Validation loss decreased (-0.601440 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 1.810490369796753
Epoch: 6, Steps: 9 | Train Loss: 0.693 Vali Loss: 0.731 Vali Acc: 0.710 Test Loss: 0.731 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.4296631813049316
Epoch: 7, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.651 Vali Acc: 0.732 Test Loss: 0.651 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 1.5932939052581787
Epoch: 8, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.616 Vali Acc: 0.725 Test Loss: 0.616 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.590097188949585
Epoch: 9, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.566 Vali Acc: 0.725 Test Loss: 0.566 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4930224418640137
Epoch: 10, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6507837772369385
Epoch: 11, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.731878 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 1.253187656402588
Epoch: 12, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4064648151397705
Epoch: 13, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.499 Vali Acc: 0.790 Test Loss: 0.499 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 14 cost time: 1.2970836162567139
Epoch: 14, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4760661125183105
Epoch: 15, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.501 Vali Acc: 0.826 Test Loss: 0.501 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 1.2350361347198486
Epoch: 16, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.486 Vali Acc: 0.790 Test Loss: 0.486 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1654348373413086
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.554 Vali Acc: 0.790 Test Loss: 0.554 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.324418306350708
Epoch: 18, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 1.1730446815490723
Epoch: 19, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 1.5305778980255127
Epoch: 20, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.377483606338501
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0608882904052734
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4244294166564941
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3526623249053955
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.514521598815918
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1277732849121094
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2144474983215332
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3346467018127441
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.158099889755249
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1688872
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.0917205810546875
Epoch: 1, Steps: 9 | Train Loss: 1.474 Vali Loss: 1.357 Vali Acc: 0.312 Test Loss: 1.357 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.5969088077545166
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.287 Vali Acc: 0.391 Test Loss: 1.287 Test Acc: 0.391
Validation loss decreased (-0.311581 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.596754789352417
Epoch: 3, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.202 Vali Acc: 0.391 Test Loss: 1.202 Test Acc: 0.391
Validation loss decreased (-0.391291 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 1.6116526126861572
Epoch: 4, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.068 Vali Acc: 0.565 Test Loss: 1.068 Test Acc: 0.565
Validation loss decreased (-0.391292 --> -0.565207).  Saving model ...
Epoch: 5 cost time: 1.348890781402588
Epoch: 5, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.975 Vali Acc: 0.529 Test Loss: 0.975 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4451069831848145
Epoch: 6, Steps: 9 | Train Loss: 0.746 Vali Loss: 0.860 Vali Acc: 0.638 Test Loss: 0.860 Test Acc: 0.638
Validation loss decreased (-0.565207 --> -0.637673).  Saving model ...
Epoch: 7 cost time: 1.3879132270812988
Epoch: 7, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.765 Vali Acc: 0.739 Test Loss: 0.765 Test Acc: 0.739
Validation loss decreased (-0.637673 --> -0.739123).  Saving model ...
Epoch: 8 cost time: 1.5418615341186523
Epoch: 8, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4599390029907227
Epoch: 9, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.682 Vali Acc: 0.703 Test Loss: 0.682 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7192106246948242
Epoch: 10, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.635 Vali Acc: 0.688 Test Loss: 0.635 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3625221252441406
Epoch: 11, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.585 Vali Acc: 0.768 Test Loss: 0.585 Test Acc: 0.768
Validation loss decreased (-0.739123 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 1.2962350845336914
Epoch: 12, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.644 Vali Acc: 0.725 Test Loss: 0.644 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.488002061843872
Epoch: 13, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.589 Vali Acc: 0.768 Test Loss: 0.589 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5847649574279785
Epoch: 14, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8348474502563477
Epoch: 15, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.561 Vali Acc: 0.761 Test Loss: 0.561 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5263268947601318
Epoch: 16, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
Validation loss decreased (-0.768110 --> -0.818835).  Saving model ...
Epoch: 17 cost time: 1.6971187591552734
Epoch: 17, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.455 Vali Acc: 0.804 Test Loss: 0.455 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5304005146026611
Epoch: 18, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.498 Vali Acc: 0.797 Test Loss: 0.498 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5187532901763916
Epoch: 19, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.559 Vali Acc: 0.804 Test Loss: 0.559 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.446927547454834
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.441 Vali Acc: 0.833 Test Loss: 0.441 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 1.412208080291748
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.3360748291015625
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6751596927642822
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6244752407073975
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 1.354832410812378
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.530973196029663
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 27 cost time: 1.3838531970977783
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 1.2712867259979248
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4799752235412598
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 1.1078202724456787
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 31 cost time: 1.5769262313842773
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1866261959075928
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2151501178741455
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4548258781433105
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3660759925842285
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3450846672058105
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 37 cost time: 1.3612947463989258
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.24107027053833
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.407524585723877
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3507778644561768
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3579373359680176
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5098886489868164
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.488999605178833
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.870 Test Loss: 0.487 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.396028757095337
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.223222017288208
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.877 Test Loss: 0.469 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2841780185699463
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1534760
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.278353452682495
Epoch: 1, Steps: 9 | Train Loss: 1.506 Vali Loss: 1.305 Vali Acc: 0.428 Test Loss: 1.305 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 1.156264305114746
Epoch: 2, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.250 Vali Acc: 0.428 Test Loss: 1.250 Test Acc: 0.428
Validation loss decreased (-0.427523 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 1.3986046314239502
Epoch: 3, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.146 Vali Acc: 0.493 Test Loss: 1.146 Test Acc: 0.493
Validation loss decreased (-0.427524 --> -0.492742).  Saving model ...
Epoch: 4 cost time: 1.213348150253296
Epoch: 4, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.057 Vali Acc: 0.464 Test Loss: 1.057 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2325148582458496
Epoch: 5, Steps: 9 | Train Loss: 0.926 Vali Loss: 0.962 Vali Acc: 0.630 Test Loss: 0.962 Test Acc: 0.630
Validation loss decreased (-0.492742 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.3222434520721436
Epoch: 6, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.874 Vali Acc: 0.667 Test Loss: 0.874 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.1384878158569336
Epoch: 7, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.747 Vali Acc: 0.732 Test Loss: 0.747 Test Acc: 0.732
Validation loss decreased (-0.666658 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.2677903175354004
Epoch: 8, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.690 Vali Acc: 0.746 Test Loss: 0.690 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 9 cost time: 0.9700496196746826
Epoch: 9, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.643 Vali Acc: 0.703 Test Loss: 0.643 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.47880220413208
Epoch: 10, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.627 Vali Acc: 0.703 Test Loss: 0.627 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0156586170196533
Epoch: 11, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.615 Vali Acc: 0.739 Test Loss: 0.615 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3650963306427002
Epoch: 12, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 1.22312331199646
Epoch: 13, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.550 Vali Acc: 0.768 Test Loss: 0.550 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.32584547996521
Epoch: 14, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2662382125854492
Epoch: 15, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 16 cost time: 1.1947145462036133
Epoch: 16, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 1.4094080924987793
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3412115573883057
Epoch: 18, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.558 Vali Acc: 0.797 Test Loss: 0.558 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2808852195739746
Epoch: 19, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.548 Vali Acc: 0.790 Test Loss: 0.548 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.383394718170166
Epoch: 20, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 1.2437288761138916
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.2368481159210205
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0589642524719238
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2248716354370117
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3897864818572998
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 1.4593656063079834
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 1.1791014671325684
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1990885734558105
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.239795207977295
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 30 cost time: 1.2747015953063965
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2367658615112305
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.182893991470337
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.365854024887085
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1985085010528564
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 35 cost time: 1.4738762378692627
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2297093868255615
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.409106731414795
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5090596675872803
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3261587619781494
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5036063194274902
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3675458431243896
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 42 cost time: 1.2861895561218262
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 43 cost time: 1.3867144584655762
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.210439920425415
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2290167808532715
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1911818981170654
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.30303955078125
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2743847370147705
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.870 Test Loss: 0.400 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3441767692565918
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3982946872711182
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2021148204803467
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.5633387565612793
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1531304
model size : 8.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.005509376525879
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.340 Vali Acc: 0.217 Test Loss: 1.340 Test Acc: 0.217
Validation loss decreased (inf --> -0.217378).  Saving model ...
Epoch: 2 cost time: 1.3966538906097412
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.265 Vali Acc: 0.348 Test Loss: 1.265 Test Acc: 0.348
Validation loss decreased (-0.217378 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.924912691116333
Epoch: 3, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.175 Vali Acc: 0.420 Test Loss: 1.175 Test Acc: 0.420
Validation loss decreased (-0.347813 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 1.505535364151001
Epoch: 4, Steps: 9 | Train Loss: 1.078 Vali Loss: 1.060 Vali Acc: 0.486 Test Loss: 1.060 Test Acc: 0.486
Validation loss decreased (-0.420278 --> -0.485497).  Saving model ...
Epoch: 5 cost time: 1.3129746913909912
Epoch: 5, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.973 Vali Acc: 0.609 Test Loss: 0.973 Test Acc: 0.609
Validation loss decreased (-0.485497 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 1.381746768951416
Epoch: 6, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.843 Vali Acc: 0.630 Test Loss: 0.843 Test Acc: 0.630
Validation loss decreased (-0.608686 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.4253578186035156
Epoch: 7, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.760 Vali Acc: 0.688 Test Loss: 0.760 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.3709778785705566
Epoch: 8, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.690 Vali Acc: 0.710 Test Loss: 0.690 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 1.4211111068725586
Epoch: 9, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.674 Vali Acc: 0.703 Test Loss: 0.674 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.365006685256958
Epoch: 10, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.637 Vali Acc: 0.703 Test Loss: 0.637 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2591500282287598
Epoch: 11, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
Validation loss decreased (-0.710138 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.3845510482788086
Epoch: 12, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.824206829071045
Epoch: 13, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.5679278373718262
Epoch: 14, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3312673568725586
Epoch: 15, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 1.4582009315490723
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.490 Vali Acc: 0.804 Test Loss: 0.490 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.242572546005249
Epoch: 17, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.526 Vali Acc: 0.790 Test Loss: 0.526 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2759253978729248
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.638 Vali Acc: 0.790 Test Loss: 0.638 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2894742488861084
Epoch: 19, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.477346658706665
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 1.2337725162506104
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 1.5157902240753174
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.423424482345581
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3970844745635986
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855067).  Saving model ...
Epoch: 25 cost time: 1.325652837753296
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 26 cost time: 1.1177089214324951
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 1.4906854629516602
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5323081016540527
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3047280311584473
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.862 Test Loss: 0.557 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862313).  Saving model ...
Epoch: 30 cost time: 1.3772454261779785
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 31 cost time: 1.3954999446868896
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.711780071258545
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.862 Test Loss: 0.529 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0756187438964844
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.870 Test Loss: 0.477 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 34 cost time: 1.3530333042144775
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5935139656066895
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.295464277267456
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 1.3822970390319824
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.862 Test Loss: 0.510 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2595758438110352
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3636040687561035
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2713465690612793
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.8757078647613525
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5667383670806885
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3655636310577393
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1936495304107666
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.311248779296875
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3995778560638428
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.870 Test Loss: 0.515 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1527848
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9578378200531006
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.371 Vali Acc: 0.391 Test Loss: 1.371 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.524301528930664
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.271 Vali Acc: 0.413 Test Loss: 1.271 Test Acc: 0.413
Validation loss decreased (-0.391291 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.2466325759887695
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.413031 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.3715863227844238
Epoch: 4, Steps: 9 | Train Loss: 1.020 Vali Loss: 1.006 Vali Acc: 0.572 Test Loss: 1.006 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2263872623443604
Epoch: 5, Steps: 9 | Train Loss: 0.852 Vali Loss: 0.906 Vali Acc: 0.580 Test Loss: 0.906 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579701).  Saving model ...
Epoch: 6 cost time: 1.2461862564086914
Epoch: 6, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.826 Vali Acc: 0.630 Test Loss: 0.826 Test Acc: 0.630
Validation loss decreased (-0.579701 --> -0.630427).  Saving model ...
Epoch: 7 cost time: 1.1148273944854736
Epoch: 7, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.748 Vali Acc: 0.674 Test Loss: 0.748 Test Acc: 0.674
Validation loss decreased (-0.630427 --> -0.673906).  Saving model ...
Epoch: 8 cost time: 1.3473730087280273
Epoch: 8, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.683 Vali Acc: 0.674 Test Loss: 0.683 Test Acc: 0.674
Validation loss decreased (-0.673906 --> -0.673906).  Saving model ...
Epoch: 9 cost time: 1.3941807746887207
Epoch: 9, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.696 Vali Acc: 0.696 Test Loss: 0.696 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 1.2185277938842773
Epoch: 10, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717385).  Saving model ...
Epoch: 11 cost time: 1.2697498798370361
Epoch: 11, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.651 Vali Acc: 0.703 Test Loss: 0.651 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2932703495025635
Epoch: 12, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.554 Vali Acc: 0.754 Test Loss: 0.554 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753618).  Saving model ...
Epoch: 13 cost time: 1.0576632022857666
Epoch: 13, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.547 Vali Acc: 0.754 Test Loss: 0.547 Test Acc: 0.754
Validation loss decreased (-0.753618 --> -0.753618).  Saving model ...
Epoch: 14 cost time: 1.251709222793579
Epoch: 14, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.609 Vali Acc: 0.790 Test Loss: 0.609 Test Acc: 0.790
Validation loss decreased (-0.753618 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 1.025078535079956
Epoch: 15, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.539557933807373
Epoch: 16, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 1.1777770519256592
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 18 cost time: 1.1764352321624756
Epoch: 18, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.308612585067749
Epoch: 19, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 1.4069757461547852
Epoch: 20, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.508 Vali Acc: 0.826 Test Loss: 0.508 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2196414470672607
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.078117847442627
Epoch: 22, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 1.4766693115234375
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.184356451034546
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 1.184051513671875
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 26 cost time: 1.2035210132598877
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2648248672485352
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 28 cost time: 1.1403841972351074
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2001729011535645
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2502498626708984
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2735919952392578
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1578896045684814
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4890000820159912
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2611610889434814
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2088863849639893
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4957635402679443
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 37 cost time: 1.2018907070159912
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 38 cost time: 1.0565085411071777
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3154547214508057
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3554906845092773
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 41 cost time: 1.2393412590026855
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1069979667663574
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 43 cost time: 1.1300921440124512
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.438765048980713
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3093671798706055
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 46 cost time: 1.2709999084472656
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3098537921905518
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 48 cost time: 1.170435905456543
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0961947441101074
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3137640953063965
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1438772678375244
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.891 Test Loss: 0.430 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.467017650604248
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1535038948059082
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.6054584980010986
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 55 cost time: 1.1779179573059082
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1167187690734863
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2151439189910889
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1966667175292969
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.891 Test Loss: 0.425 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2056033611297607
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.899 Test Loss: 0.422 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 60 cost time: 1.1379120349884033
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.891 Test Loss: 0.432 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1963081359863281
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1262321472167969
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1795403957366943
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 64 cost time: 1.073923110961914
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.899 Test Loss: 0.422 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1622247695922852
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.1413376331329346
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.899 Test Loss: 0.425 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.4298429489135742
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.899 Test Loss: 0.423 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.4469218254089355
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.4766767024993896
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.899 Test Loss: 0.422 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.2117676734924316
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.899 Test Loss: 0.429 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.4139928817749023
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 72 cost time: 1.098323106765747
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.899 Test Loss: 0.425 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.446131706237793
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.899 Test Loss: 0.433 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.3631443977355957
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.3117632865905762
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.899 Test Loss: 0.422 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.5433502197265625
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.2019157409667969
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.899 Test Loss: 0.423 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.119861125946045
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.899 Test Loss: 0.429 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.2249901294708252
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.348726749420166
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.899 Test Loss: 0.437 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.448587417602539
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 1524392
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.450742483139038
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.397 Vali Acc: 0.370 Test Loss: 1.397 Test Acc: 0.370
Validation loss decreased (inf --> -0.369551).  Saving model ...
Epoch: 2 cost time: 1.3673224449157715
Epoch: 2, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.319 Vali Acc: 0.442 Test Loss: 1.319 Test Acc: 0.442
Validation loss decreased (-0.369551 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 1.7570817470550537
Epoch: 3, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.238 Vali Acc: 0.428 Test Loss: 1.238 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1008710861206055
Epoch: 4, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.118 Vali Acc: 0.536 Test Loss: 1.118 Test Acc: 0.536
Validation loss decreased (-0.442016 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 1.129894495010376
Epoch: 5, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.018 Vali Acc: 0.572 Test Loss: 1.018 Test Acc: 0.572
Validation loss decreased (-0.536221 --> -0.572454).  Saving model ...
Epoch: 6 cost time: 1.2389836311340332
Epoch: 6, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.886 Vali Acc: 0.659 Test Loss: 0.886 Test Acc: 0.659
Validation loss decreased (-0.572454 --> -0.659411).  Saving model ...
Epoch: 7 cost time: 1.1503291130065918
Epoch: 7, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.789 Vali Acc: 0.674 Test Loss: 0.789 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.4079430103302002
Epoch: 8, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.749 Vali Acc: 0.674 Test Loss: 0.749 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673906).  Saving model ...
Epoch: 9 cost time: 1.2231121063232422
Epoch: 9, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.673906 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.2275784015655518
Epoch: 10, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.634 Vali Acc: 0.710 Test Loss: 0.634 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2157175540924072
Epoch: 11, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.648 Vali Acc: 0.710 Test Loss: 0.648 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.169753074645996
Epoch: 12, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.559 Vali Acc: 0.754 Test Loss: 0.559 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753618).  Saving model ...
Epoch: 13 cost time: 1.4406859874725342
Epoch: 13, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.615 Vali Acc: 0.725 Test Loss: 0.615 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3182151317596436
Epoch: 14, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3464677333831787
Epoch: 15, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.555 Vali Acc: 0.790 Test Loss: 0.555 Test Acc: 0.790
Validation loss decreased (-0.753618 --> -0.789850).  Saving model ...
Epoch: 16 cost time: 1.2897052764892578
Epoch: 16, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 17 cost time: 1.202284574508667
Epoch: 17, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.499 Vali Acc: 0.797 Test Loss: 0.499 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3114092350006104
Epoch: 18, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.505 Vali Acc: 0.797 Test Loss: 0.505 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3680877685546875
Epoch: 19, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.3681464195251465
Epoch: 20, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.421 Vali Acc: 0.812 Test Loss: 0.421 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5123956203460693
Epoch: 21, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9524896144866943
Epoch: 22, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 23 cost time: 1.1785941123962402
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.439 Vali Acc: 0.841 Test Loss: 0.439 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3953039646148682
Epoch: 24, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 25 cost time: 0.9304077625274658
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 1.181980848312378
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 27 cost time: 1.3628032207489014
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1788980960845947
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 29 cost time: 1.1603946685791016
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2222471237182617
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 1.4957795143127441
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.180128574371338
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 33 cost time: 1.333195447921753
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2261414527893066
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1129958629608154
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3251497745513916
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2516000270843506
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1377427577972412
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2277922630310059
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0697174072265625
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.444093942642212
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6408493518829346
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1017960
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1003317832946777
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.350 Vali Acc: 0.370 Test Loss: 1.350 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.4656472206115723
Epoch: 2, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.276 Vali Acc: 0.457 Test Loss: 1.276 Test Acc: 0.457
Validation loss decreased (-0.369552 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 1.206662893295288
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.224 Vali Acc: 0.435 Test Loss: 1.224 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3840904235839844
Epoch: 4, Steps: 9 | Train Loss: 1.099 Vali Loss: 1.097 Vali Acc: 0.580 Test Loss: 1.097 Test Acc: 0.580
Validation loss decreased (-0.456509 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 1.3215992450714111
Epoch: 5, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.000 Vali Acc: 0.507 Test Loss: 1.000 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2823083400726318
Epoch: 6, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.909 Vali Acc: 0.630 Test Loss: 0.909 Test Acc: 0.630
Validation loss decreased (-0.579699 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.529646396636963
Epoch: 7, Steps: 9 | Train Loss: 0.728 Vali Loss: 0.822 Vali Acc: 0.645 Test Loss: 0.822 Test Acc: 0.645
Validation loss decreased (-0.630426 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.4879400730133057
Epoch: 8, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.776 Vali Acc: 0.645 Test Loss: 0.776 Test Acc: 0.645
Validation loss decreased (-0.644919 --> -0.644920).  Saving model ...
Epoch: 9 cost time: 1.2512946128845215
Epoch: 9, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.729 Vali Acc: 0.674 Test Loss: 0.729 Test Acc: 0.674
Validation loss decreased (-0.644920 --> -0.673906).  Saving model ...
Epoch: 10 cost time: 1.2411980628967285
Epoch: 10, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.708 Vali Acc: 0.667 Test Loss: 0.708 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.482438087463379
Epoch: 11, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.676 Vali Acc: 0.703 Test Loss: 0.676 Test Acc: 0.703
Validation loss decreased (-0.673906 --> -0.702892).  Saving model ...
Epoch: 12 cost time: 1.0720551013946533
Epoch: 12, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.632 Vali Acc: 0.688 Test Loss: 0.632 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4452183246612549
Epoch: 13, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.625 Vali Acc: 0.696 Test Loss: 0.625 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.227132797241211
Epoch: 14, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731878).  Saving model ...
Epoch: 15 cost time: 1.2722423076629639
Epoch: 15, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.603 Vali Acc: 0.761 Test Loss: 0.603 Test Acc: 0.761
Validation loss decreased (-0.731878 --> -0.760864).  Saving model ...
Epoch: 16 cost time: 1.1208395957946777
Epoch: 16, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4988675117492676
Epoch: 17, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.558 Vali Acc: 0.790 Test Loss: 0.558 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789849).  Saving model ...
Epoch: 18 cost time: 1.356968879699707
Epoch: 18, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.376185655593872
Epoch: 19, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.515 Vali Acc: 0.804 Test Loss: 0.515 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 20 cost time: 1.2936649322509766
Epoch: 20, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 1.3459820747375488
Epoch: 21, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6464226245880127
Epoch: 22, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7139801979064941
Epoch: 23, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 24 cost time: 1.3931314945220947
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 1.274446725845337
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5679349899291992
Epoch: 26, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 1.3269929885864258
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840574).  Saving model ...
Epoch: 28 cost time: 1.2371134757995605
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4541926383972168
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4378321170806885
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.565427541732788
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5138216018676758
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 33 cost time: 1.6263103485107422
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1428027153015137
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6116163730621338
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7959837913513184
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.492563009262085
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5517818927764893
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 39 cost time: 1.5519053936004639
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5319242477416992
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 41 cost time: 1.6524455547332764
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.848 Test Loss: 0.549 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 42 cost time: 1.5598297119140625
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 43 cost time: 1.3356175422668457
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4348781108856201
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4395678043365479
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6147005558013916
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 47 cost time: 1.303168773651123
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.848 Test Loss: 0.627 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.551774263381958
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3023121356964111
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.29880690574646
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.260420322418213
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2895019054412842
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.448460578918457
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.6164989471435547
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.3300824165344238
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1371865272521973
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1016232
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.125309705734253
Epoch: 1, Steps: 9 | Train Loss: 1.547 Vali Loss: 1.389 Vali Acc: 0.362 Test Loss: 1.389 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.2000596523284912
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.329 Vali Acc: 0.319 Test Loss: 1.329 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.434128761291504
Epoch: 3, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.186 Vali Acc: 0.522 Test Loss: 1.186 Test Acc: 0.522
Validation loss decreased (-0.362305 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.1706202030181885
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.074 Vali Acc: 0.623 Test Loss: 1.074 Test Acc: 0.623
Validation loss decreased (-0.521727 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 1.0630409717559814
Epoch: 5, Steps: 9 | Train Loss: 0.947 Vali Loss: 0.977 Vali Acc: 0.536 Test Loss: 0.977 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.19486403465271
Epoch: 6, Steps: 9 | Train Loss: 0.807 Vali Loss: 0.865 Vali Acc: 0.681 Test Loss: 0.865 Test Acc: 0.681
Validation loss decreased (-0.623178 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.1987128257751465
Epoch: 7, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.805 Vali Acc: 0.674 Test Loss: 0.805 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2265686988830566
Epoch: 8, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.748 Vali Acc: 0.674 Test Loss: 0.748 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.370844841003418
Epoch: 9, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.720 Vali Acc: 0.681 Test Loss: 0.720 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 1.1851539611816406
Epoch: 10, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.677 Vali Acc: 0.703 Test Loss: 0.677 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702892).  Saving model ...
Epoch: 11 cost time: 1.3553438186645508
Epoch: 11, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
Validation loss decreased (-0.702892 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.233168125152588
Epoch: 12, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.644 Vali Acc: 0.703 Test Loss: 0.644 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4179768562316895
Epoch: 13, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.581 Vali Acc: 0.746 Test Loss: 0.581 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746371).  Saving model ...
Epoch: 14 cost time: 1.2605657577514648
Epoch: 14, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.564 Vali Acc: 0.739 Test Loss: 0.564 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.322148323059082
Epoch: 15, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.534 Vali Acc: 0.768 Test Loss: 0.534 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768111).  Saving model ...
Epoch: 16 cost time: 1.2242674827575684
Epoch: 16, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.560 Vali Acc: 0.746 Test Loss: 0.560 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2778053283691406
Epoch: 17, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.768111 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 1.2513351440429688
Epoch: 18, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (-0.782603 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 1.4236345291137695
Epoch: 19, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.642 Vali Acc: 0.775 Test Loss: 0.642 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2968578338623047
Epoch: 20, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 1.24043869972229
Epoch: 21, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2178423404693604
Epoch: 22, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.142876386642456
Epoch: 23, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2087504863739014
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3777427673339844
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.279592514038086
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.501 Vali Acc: 0.826 Test Loss: 0.501 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4981846809387207
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 1.7514610290527344
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 1.6945812702178955
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2147374153137207
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3520960807800293
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3169751167297363
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 33 cost time: 1.2921278476715088
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1276960372924805
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3919739723205566
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1354186534881592
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.396 Vali Acc: 0.870 Test Loss: 0.396 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3308610916137695
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.464501142501831
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4096038341522217
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1874735355377197
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.367985486984253
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 42 cost time: 1.2391762733459473
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3485476970672607
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.203751564025879
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 45 cost time: 1.3196897506713867
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2555689811706543
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2710130214691162
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4907925128936768
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3107266426086426
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3867831230163574
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2993497848510742
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2285118103027344
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1783521175384521
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.225271224975586
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1014504
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.250491142272949
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.371 Vali Acc: 0.370 Test Loss: 1.371 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.413837194442749
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.319 Vali Acc: 0.290 Test Loss: 1.319 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7091753482818604
Epoch: 3, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.217 Vali Acc: 0.529 Test Loss: 1.217 Test Acc: 0.529
Validation loss decreased (-0.369552 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 1.2530388832092285
Epoch: 4, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.094 Vali Acc: 0.558 Test Loss: 1.094 Test Acc: 0.558
Validation loss decreased (-0.528973 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 1.265296459197998
Epoch: 5, Steps: 9 | Train Loss: 0.975 Vali Loss: 0.984 Vali Acc: 0.638 Test Loss: 0.984 Test Acc: 0.638
Validation loss decreased (-0.557960 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 1.1848254203796387
Epoch: 6, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.871 Vali Acc: 0.659 Test Loss: 0.871 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659412).  Saving model ...
Epoch: 7 cost time: 1.384382963180542
Epoch: 7, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.779 Vali Acc: 0.667 Test Loss: 0.779 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 1.227898120880127
Epoch: 8, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.708 Vali Acc: 0.667 Test Loss: 0.708 Test Acc: 0.667
Validation loss decreased (-0.666659 --> -0.666660).  Saving model ...
Epoch: 9 cost time: 1.178351640701294
Epoch: 9, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.672 Vali Acc: 0.703 Test Loss: 0.672 Test Acc: 0.703
Validation loss decreased (-0.666660 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 1.4194536209106445
Epoch: 10, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.653 Vali Acc: 0.703 Test Loss: 0.653 Test Acc: 0.703
Validation loss decreased (-0.702892 --> -0.702892).  Saving model ...
Epoch: 11 cost time: 1.4369957447052002
Epoch: 11, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.585 Vali Acc: 0.725 Test Loss: 0.585 Test Acc: 0.725
Validation loss decreased (-0.702892 --> -0.724632).  Saving model ...
Epoch: 12 cost time: 1.2469127178192139
Epoch: 12, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.578 Vali Acc: 0.739 Test Loss: 0.578 Test Acc: 0.739
Validation loss decreased (-0.724632 --> -0.739125).  Saving model ...
Epoch: 13 cost time: 1.1819231510162354
Epoch: 13, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.591 Vali Acc: 0.754 Test Loss: 0.591 Test Acc: 0.754
Validation loss decreased (-0.739125 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.2009682655334473
Epoch: 14, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 1.5277793407440186
Epoch: 15, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.534 Vali Acc: 0.797 Test Loss: 0.534 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 1.4283967018127441
Epoch: 16, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.459 Vali Acc: 0.804 Test Loss: 0.459 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 1.295846939086914
Epoch: 17, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.478 Vali Acc: 0.797 Test Loss: 0.478 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4361979961395264
Epoch: 18, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 19 cost time: 1.4638285636901855
Epoch: 19, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 1.1883444786071777
Epoch: 20, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.422 Vali Acc: 0.812 Test Loss: 0.422 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2224738597869873
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.4534647464752197
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 1.4679462909698486
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 1.4621655941009521
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6192152500152588
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7638025283813477
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 27 cost time: 1.2589211463928223
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2175025939941406
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 1.3397138118743896
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.228076457977295
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 1.5498807430267334
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4676735401153564
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2273187637329102
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.449599027633667
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.884 Test Loss: 0.462 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2794365882873535
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3872790336608887
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1779980659484863
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.427 Vali Acc: 0.884 Test Loss: 0.427 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3187005519866943
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 39 cost time: 1.235987901687622
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1041104793548584
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.295353651046753
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4394209384918213
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1030702590942383
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.891 Test Loss: 0.425 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3888511657714844
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5129117965698242
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4687035083770752
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.899 Test Loss: 0.421 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 47 cost time: 1.0381321907043457
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4110007286071777
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9862480163574219
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1504271030426025
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 51 cost time: 1.4618148803710938
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3800880908966064
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 53 cost time: 1.4241023063659668
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.891 Test Loss: 0.428 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4614124298095703
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2968347072601318
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.906 Test Loss: 0.428 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 56 cost time: 1.3286676406860352
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.899 Test Loss: 0.468 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1928038597106934
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.913 Test Loss: 0.407 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 58 cost time: 1.7980315685272217
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.891 Test Loss: 0.486 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4846348762512207
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.913 Test Loss: 0.418 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2611768245697021
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.906 Test Loss: 0.456 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.3026189804077148
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.299849510192871
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.899 Test Loss: 0.461 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2991654872894287
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.899 Test Loss: 0.446 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.1068239212036133
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.1535649299621582
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.4562792778015137
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.906 Test Loss: 0.454 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2708570957183838
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.899 Test Loss: 0.452 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1012776
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.143681764602661
Epoch: 1, Steps: 9 | Train Loss: 1.520 Vali Loss: 1.349 Vali Acc: 0.391 Test Loss: 1.349 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.3189029693603516
Epoch: 2, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.311 Vali Acc: 0.391 Test Loss: 1.311 Test Acc: 0.391
Validation loss decreased (-0.391291 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.1454358100891113
Epoch: 3, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.184 Vali Acc: 0.536 Test Loss: 1.184 Test Acc: 0.536
Validation loss decreased (-0.391291 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 1.0757668018341064
Epoch: 4, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.083 Vali Acc: 0.587 Test Loss: 1.083 Test Acc: 0.587
Validation loss decreased (-0.536220 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 1.0654246807098389
Epoch: 5, Steps: 9 | Train Loss: 0.980 Vali Loss: 0.994 Vali Acc: 0.587 Test Loss: 0.994 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 6 cost time: 1.2517082691192627
Epoch: 6, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.897 Vali Acc: 0.616 Test Loss: 0.897 Test Acc: 0.616
Validation loss decreased (-0.586947 --> -0.615933).  Saving model ...
Epoch: 7 cost time: 1.2516765594482422
Epoch: 7, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.825 Vali Acc: 0.659 Test Loss: 0.825 Test Acc: 0.659
Validation loss decreased (-0.615933 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 1.159118890762329
Epoch: 8, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.764 Vali Acc: 0.688 Test Loss: 0.764 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 1.348841667175293
Epoch: 9, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.716 Vali Acc: 0.674 Test Loss: 0.716 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6272857189178467
Epoch: 10, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.690 Vali Acc: 0.696 Test Loss: 0.690 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.1384265422821045
Epoch: 11, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.633 Vali Acc: 0.717 Test Loss: 0.633 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.1446292400360107
Epoch: 12, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.616 Vali Acc: 0.703 Test Loss: 0.616 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0591959953308105
Epoch: 13, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.558 Vali Acc: 0.768 Test Loss: 0.558 Test Acc: 0.768
Validation loss decreased (-0.717385 --> -0.768110).  Saving model ...
Epoch: 14 cost time: 1.1080355644226074
Epoch: 14, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.557 Vali Acc: 0.739 Test Loss: 0.557 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9290506839752197
Epoch: 15, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.548 Vali Acc: 0.775 Test Loss: 0.548 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 16 cost time: 1.007711410522461
Epoch: 16, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.499 Vali Acc: 0.790 Test Loss: 0.499 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 1.2386679649353027
Epoch: 17, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.531 Vali Acc: 0.790 Test Loss: 0.531 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.263791799545288
Epoch: 18, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.468 Vali Acc: 0.812 Test Loss: 0.468 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811590).  Saving model ...
Epoch: 19 cost time: 1.1476213932037354
Epoch: 19, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 1.203932523727417
Epoch: 20, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.464 Vali Acc: 0.804 Test Loss: 0.464 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2512035369873047
Epoch: 21, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.438 Vali Acc: 0.819 Test Loss: 0.438 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1289300918579102
Epoch: 22, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.434 Vali Acc: 0.797 Test Loss: 0.434 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.243924856185913
Epoch: 23, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.3925755023956299
Epoch: 24, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.428 Vali Acc: 0.826 Test Loss: 0.428 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5453877449035645
Epoch: 25, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.403 Vali Acc: 0.848 Test Loss: 0.403 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 1.299093246459961
Epoch: 26, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3336143493652344
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.391 Vali Acc: 0.841 Test Loss: 0.391 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2087147235870361
Epoch: 28, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1834242343902588
Epoch: 29, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3838939666748047
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 31 cost time: 1.2337186336517334
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3760466575622559
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2309553623199463
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 34 cost time: 1.294118881225586
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.169081687927246
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2076036930084229
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3539910316467285
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 1.5013206005096436
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3333549499511719
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 40 cost time: 1.2698004245758057
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5187101364135742
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2030315399169922
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.862 Test Loss: 0.437 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4762589931488037
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 44 cost time: 1.3241050243377686
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4806177616119385
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1984660625457764
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3627510070800781
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4676859378814697
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2624762058258057
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2685036659240723
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.220740795135498
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.2660186290740967
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 53 cost time: 1.5273330211639404
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2546148300170898
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1471891403198242
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.239769458770752
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0560457706451416
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.238797664642334
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.2381057739257812
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.7522144317626953
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.3077268600463867
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.379352331161499
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 687720
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9894022941589355
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.439 Vali Acc: 0.174 Test Loss: 1.439 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 1.153615951538086
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.364 Vali Acc: 0.275 Test Loss: 1.364 Test Acc: 0.275
Validation loss decreased (-0.173899 --> -0.275349).  Saving model ...
Epoch: 3 cost time: 1.0531723499298096
Epoch: 3, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.266 Vali Acc: 0.413 Test Loss: 1.266 Test Acc: 0.413
Validation loss decreased (-0.275349 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.3396732807159424
Epoch: 4, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.413031 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2376463413238525
Epoch: 5, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.090 Vali Acc: 0.580 Test Loss: 1.090 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 1.228217601776123
Epoch: 6, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.991 Vali Acc: 0.529 Test Loss: 0.991 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1287386417388916
Epoch: 7, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.871 Vali Acc: 0.667 Test Loss: 0.871 Test Acc: 0.667
Validation loss decreased (-0.579699 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 1.0957951545715332
Epoch: 8, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.796 Vali Acc: 0.652 Test Loss: 0.796 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1855578422546387
Epoch: 9, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.060063123703003
Epoch: 10, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.711 Vali Acc: 0.696 Test Loss: 0.711 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2367570400238037
Epoch: 11, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.0796804428100586
Epoch: 12, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.664 Vali Acc: 0.725 Test Loss: 0.664 Test Acc: 0.725
Validation loss decreased (-0.717385 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 1.129178762435913
Epoch: 13, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.608 Vali Acc: 0.703 Test Loss: 0.608 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.111936092376709
Epoch: 14, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.617 Vali Acc: 0.710 Test Loss: 0.617 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3645596504211426
Epoch: 15, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 16 cost time: 1.627410650253296
Epoch: 16, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.731878 --> -0.731879).  Saving model ...
Epoch: 17 cost time: 1.4363923072814941
Epoch: 17, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
Validation loss decreased (-0.731879 --> -0.775357).  Saving model ...
Epoch: 18 cost time: 1.2670607566833496
Epoch: 18, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.517 Vali Acc: 0.768 Test Loss: 0.517 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3321032524108887
Epoch: 19, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.482 Vali Acc: 0.797 Test Loss: 0.482 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797097).  Saving model ...
Epoch: 20 cost time: 1.138246774673462
Epoch: 20, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
Validation loss decreased (-0.797097 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 1.3579561710357666
Epoch: 21, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5602047443389893
Epoch: 22, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.459 Vali Acc: 0.819 Test Loss: 0.459 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1424779891967773
Epoch: 23, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.488 Vali Acc: 0.804 Test Loss: 0.488 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2413067817687988
Epoch: 24, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.475 Vali Acc: 0.819 Test Loss: 0.475 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1406493186950684
Epoch: 25, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.484 Vali Acc: 0.797 Test Loss: 0.484 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1944966316223145
Epoch: 26, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840576).  Saving model ...
Epoch: 27 cost time: 1.3920738697052002
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3949408531188965
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4749188423156738
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0765998363494873
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2500207424163818
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4215171337127686
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 33 cost time: 1.010260820388794
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4445734024047852
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1473908424377441
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3401575088500977
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1550467014312744
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.371544361114502
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3100128173828125
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
Validation loss decreased (-0.840576 --> -0.862315).  Saving model ...
Epoch: 40 cost time: 1.143620252609253
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1773977279663086
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.276552438735962
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2754604816436768
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1618354320526123
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.22580885887146
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1851575374603271
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2933588027954102
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3274879455566406
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 49 cost time: 1.3973333835601807
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 50 cost time: 1.1675238609313965
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.22806715965271
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.14827561378479
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3764941692352295
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.376835823059082
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 55 cost time: 1.2377045154571533
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.388784646987915
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2593109607696533
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.3767943382263184
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.884 Test Loss: 0.459 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.28456711769104
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1645619869232178
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1806058883666992
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.477142095565796
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.884 Test Loss: 0.462 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.5635457038879395
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.140965223312378
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.877 Test Loss: 0.451 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 685992
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.374512195587158
Epoch: 1, Steps: 9 | Train Loss: 1.527 Vali Loss: 1.431 Vali Acc: 0.225 Test Loss: 1.431 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 1.2505502700805664
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (-0.224623 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 1.2564239501953125
Epoch: 3, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.284 Vali Acc: 0.478 Test Loss: 1.284 Test Acc: 0.478
Validation loss decreased (-0.297088 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 1.0533058643341064
Epoch: 4, Steps: 9 | Train Loss: 1.184 Vali Loss: 1.195 Vali Acc: 0.435 Test Loss: 1.195 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.708829641342163
Epoch: 5, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
Validation loss decreased (-0.478248 --> -0.514482).  Saving model ...
Epoch: 6 cost time: 1.2619411945343018
Epoch: 6, Steps: 9 | Train Loss: 0.914 Vali Loss: 1.004 Vali Acc: 0.507 Test Loss: 1.004 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1311695575714111
Epoch: 7, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.902 Vali Acc: 0.659 Test Loss: 0.902 Test Acc: 0.659
Validation loss decreased (-0.514482 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 1.4652807712554932
Epoch: 8, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.828 Vali Acc: 0.674 Test Loss: 0.828 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 1.5719318389892578
Epoch: 9, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.768 Vali Acc: 0.667 Test Loss: 0.768 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3507888317108154
Epoch: 10, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.718 Vali Acc: 0.696 Test Loss: 0.718 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.2792859077453613
Epoch: 11, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.686 Vali Acc: 0.696 Test Loss: 0.686 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695645).  Saving model ...
Epoch: 12 cost time: 1.5764708518981934
Epoch: 12, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.662 Vali Acc: 0.681 Test Loss: 0.662 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.737213134765625
Epoch: 13, Steps: 9 | Train Loss: 0.404 Vali Loss: 0.647 Vali Acc: 0.725 Test Loss: 0.647 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724631).  Saving model ...
Epoch: 14 cost time: 1.7101871967315674
Epoch: 14, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.630 Vali Acc: 0.725 Test Loss: 0.630 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 15 cost time: 1.336043119430542
Epoch: 15, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746371).  Saving model ...
Epoch: 16 cost time: 1.5497174263000488
Epoch: 16, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 17 cost time: 1.5702228546142578
Epoch: 17, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.510 Vali Acc: 0.797 Test Loss: 0.510 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 18 cost time: 1.446120023727417
Epoch: 18, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 1.4864997863769531
Epoch: 19, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 1.272221326828003
Epoch: 20, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4681880474090576
Epoch: 21, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.3248238563537598
Epoch: 22, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 1.3593313694000244
Epoch: 23, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4758937358856201
Epoch: 24, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2806682586669922
Epoch: 25, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 1.3078632354736328
Epoch: 26, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4420931339263916
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2870380878448486
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 29 cost time: 1.5671799182891846
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 30 cost time: 1.3843140602111816
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1332876682281494
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3953893184661865
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8009297847747803
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5072731971740723
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.421565294265747
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4002983570098877
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 37 cost time: 1.2714848518371582
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 1.5556387901306152
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4551067352294922
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4237942695617676
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2458710670471191
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6061897277832031
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 43 cost time: 1.4780619144439697
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5572168827056885
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4195170402526855
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4086353778839111
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.870 Test Loss: 0.396 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6127374172210693
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.608255386352539
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.5557339191436768
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.7642967700958252
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.6889948844909668
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1569886207580566
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 684264
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.27603816986084
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.413 Vali Acc: 0.239 Test Loss: 1.413 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.2047169208526611
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.344 Vali Acc: 0.420 Test Loss: 1.344 Test Acc: 0.420
Validation loss decreased (-0.239116 --> -0.420276).  Saving model ...
Epoch: 3 cost time: 1.3019540309906006
Epoch: 3, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.256 Vali Acc: 0.428 Test Loss: 1.256 Test Acc: 0.428
Validation loss decreased (-0.420276 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 1.3732430934906006
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
Validation loss decreased (-0.427524 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2404861450195312
Epoch: 5, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.049 Vali Acc: 0.572 Test Loss: 1.049 Test Acc: 0.572
Validation loss decreased (-0.499988 --> -0.572453).  Saving model ...
Epoch: 6 cost time: 1.201995849609375
Epoch: 6, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.943 Vali Acc: 0.638 Test Loss: 0.943 Test Acc: 0.638
Validation loss decreased (-0.572453 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 1.0733814239501953
Epoch: 7, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.859 Vali Acc: 0.688 Test Loss: 0.859 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 1.3438584804534912
Epoch: 8, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1082563400268555
Epoch: 9, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.728 Vali Acc: 0.688 Test Loss: 0.728 Test Acc: 0.688
Validation loss decreased (-0.688397 --> -0.688399).  Saving model ...
Epoch: 10 cost time: 1.199585199356079
Epoch: 10, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.697 Vali Acc: 0.688 Test Loss: 0.697 Test Acc: 0.688
Validation loss decreased (-0.688399 --> -0.688399).  Saving model ...
Epoch: 11 cost time: 1.2316629886627197
Epoch: 11, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.669 Vali Acc: 0.703 Test Loss: 0.669 Test Acc: 0.703
Validation loss decreased (-0.688399 --> -0.702892).  Saving model ...
Epoch: 12 cost time: 1.2373030185699463
Epoch: 12, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 1.2460830211639404
Epoch: 13, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.621 Vali Acc: 0.703 Test Loss: 0.621 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.512909173965454
Epoch: 14, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.201683521270752
Epoch: 15, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.598 Vali Acc: 0.739 Test Loss: 0.598 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 1.124232292175293
Epoch: 16, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 17 cost time: 1.184561014175415
Epoch: 17, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3168859481811523
Epoch: 18, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.507 Vali Acc: 0.797 Test Loss: 0.507 Test Acc: 0.797
Validation loss decreased (-0.746371 --> -0.797096).  Saving model ...
Epoch: 19 cost time: 1.1289854049682617
Epoch: 19, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.501 Vali Acc: 0.768 Test Loss: 0.501 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2967419624328613
Epoch: 20, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.554 Vali Acc: 0.790 Test Loss: 0.554 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.143239974975586
Epoch: 21, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.466 Vali Acc: 0.812 Test Loss: 0.466 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811590).  Saving model ...
Epoch: 22 cost time: 1.3395302295684814
Epoch: 22, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 23 cost time: 1.2329771518707275
Epoch: 23, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.493 Vali Acc: 0.812 Test Loss: 0.493 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4493751525878906
Epoch: 24, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.448 Vali Acc: 0.826 Test Loss: 0.448 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 1.384244441986084
Epoch: 25, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 1.131446123123169
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.433 Vali Acc: 0.826 Test Loss: 0.433 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1782338619232178
Epoch: 27, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 1.0882327556610107
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1872422695159912
Epoch: 29, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3053412437438965
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3168766498565674
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3745241165161133
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.143392562866211
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1621613502502441
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 35 cost time: 1.447610855102539
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 1.3155641555786133
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.314054012298584
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 38 cost time: 1.2336585521697998
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0734775066375732
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4136695861816406
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 41 cost time: 1.1356239318847656
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2896454334259033
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.870 Test Loss: 0.405 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 43 cost time: 1.133178949356079
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3753023147583008
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 45 cost time: 1.3095476627349854
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2642617225646973
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2124137878417969
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2240278720855713
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3258116245269775
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0288960933685303
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 51 cost time: 1.1458640098571777
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2257440090179443
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.870 Test Loss: 0.434 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3121635913848877
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3130686283111572
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.387406349182129
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3611934185028076
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.1865570545196533
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3790793418884277
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1569931507110596
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2875945568084717
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 61 cost time: 1.0708253383636475
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1110384464263916
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.2318248748779297
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.2585256099700928
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 65 cost time: 1.270205020904541
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3716330528259277
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1849665641784668
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.0955421924591064
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.1759743690490723
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.361037254333496
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.2405297756195068
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.877 Test Loss: 0.441 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.2166922092437744
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.3407692909240723
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.0919914245605469
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 682536
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9108943939208984
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.1576459407806396
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.305 Vali Acc: 0.348 Test Loss: 1.305 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.351379632949829
Epoch: 3, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.231 Vali Acc: 0.420 Test Loss: 1.231 Test Acc: 0.420
Validation loss decreased (-0.362305 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 1.2346625328063965
Epoch: 4, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.420278 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 1.1732864379882812
Epoch: 5, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.058 Vali Acc: 0.551 Test Loss: 1.058 Test Acc: 0.551
Validation loss decreased (-0.499989 --> -0.550714).  Saving model ...
Epoch: 6 cost time: 1.36238431930542
Epoch: 6, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.000 Vali Acc: 0.536 Test Loss: 1.000 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4261820316314697
Epoch: 7, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.890 Vali Acc: 0.638 Test Loss: 0.890 Test Acc: 0.638
Validation loss decreased (-0.550714 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 1.091707468032837
Epoch: 8, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 1.4058797359466553
Epoch: 9, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.770 Vali Acc: 0.681 Test Loss: 0.770 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6792352199554443
Epoch: 10, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.733 Vali Acc: 0.696 Test Loss: 0.733 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.3781473636627197
Epoch: 11, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.684 Vali Acc: 0.688 Test Loss: 0.684 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.454984426498413
Epoch: 12, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.647 Vali Acc: 0.710 Test Loss: 0.647 Test Acc: 0.710
Validation loss decreased (-0.695645 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 1.1607089042663574
Epoch: 13, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.655 Vali Acc: 0.681 Test Loss: 0.655 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.194105625152588
Epoch: 14, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.635 Vali Acc: 0.703 Test Loss: 0.635 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0739023685455322
Epoch: 15, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.630 Vali Acc: 0.688 Test Loss: 0.630 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1542043685913086
Epoch: 16, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
Validation loss decreased (-0.710138 --> -0.746371).  Saving model ...
Epoch: 17 cost time: 1.3552405834197998
Epoch: 17, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.449357271194458
Epoch: 18, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.548 Vali Acc: 0.768 Test Loss: 0.548 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768110).  Saving model ...
Epoch: 19 cost time: 1.34932541847229
Epoch: 19, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.555 Vali Acc: 0.739 Test Loss: 0.555 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.268028736114502
Epoch: 20, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
Validation loss decreased (-0.768110 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 1.1009595394134521
Epoch: 21, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1991961002349854
Epoch: 22, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.193681001663208
Epoch: 23, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 24 cost time: 1.4501678943634033
Epoch: 24, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.525 Vali Acc: 0.797 Test Loss: 0.525 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1573364734649658
Epoch: 25, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.505 Vali Acc: 0.804 Test Loss: 0.505 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2392652034759521
Epoch: 26, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 27 cost time: 1.1504380702972412
Epoch: 27, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 28 cost time: 1.273197889328003
Epoch: 28, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 1.1232898235321045
Epoch: 29, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1640915870666504
Epoch: 30, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2770018577575684
Epoch: 31, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 32 cost time: 1.1983141899108887
Epoch: 32, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.397965431213379
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1577856540679932
Epoch: 34, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.012601375579834
Epoch: 35, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2427246570587158
Epoch: 36, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2571511268615723
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.539 Vali Acc: 0.855 Test Loss: 0.539 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.261202096939087
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0497753620147705
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 40 cost time: 1.1443641185760498
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.120570421218872
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.38515043258667
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.534 Vali Acc: 0.848 Test Loss: 0.534 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1497876644134521
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2454380989074707
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1233928203582764
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.848 Test Loss: 0.536 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.279151439666748
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.4391436576843262
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3931200504302979
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.848 Test Loss: 0.546 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4602036476135254
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 522600
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8264474868774414
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.380 Vali Acc: 0.319 Test Loss: 1.380 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.341212272644043
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
Validation loss decreased (-0.318827 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.9492366313934326
Epoch: 3, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.253 Vali Acc: 0.377 Test Loss: 1.253 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376799).  Saving model ...
Epoch: 4 cost time: 1.1963839530944824
Epoch: 4, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.159 Vali Acc: 0.565 Test Loss: 1.159 Test Acc: 0.565
Validation loss decreased (-0.376799 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 1.1475603580474854
Epoch: 5, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.078 Vali Acc: 0.514 Test Loss: 1.078 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2125091552734375
Epoch: 6, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.995 Vali Acc: 0.601 Test Loss: 0.995 Test Acc: 0.601
Validation loss decreased (-0.565206 --> -0.601439).  Saving model ...
Epoch: 7 cost time: 1.401275396347046
Epoch: 7, Steps: 9 | Train Loss: 0.846 Vali Loss: 0.933 Vali Acc: 0.623 Test Loss: 0.933 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623179).  Saving model ...
Epoch: 8 cost time: 1.5344634056091309
Epoch: 8, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.855 Vali Acc: 0.674 Test Loss: 0.855 Test Acc: 0.674
Validation loss decreased (-0.623179 --> -0.673904).  Saving model ...
Epoch: 9 cost time: 1.1541376113891602
Epoch: 9, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 10 cost time: 1.217517614364624
Epoch: 10, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.737 Vali Acc: 0.703 Test Loss: 0.737 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 11 cost time: 1.205275535583496
Epoch: 11, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.706 Vali Acc: 0.703 Test Loss: 0.706 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 1.3260610103607178
Epoch: 12, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.689 Vali Acc: 0.703 Test Loss: 0.689 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702892).  Saving model ...
Epoch: 13 cost time: 1.2767372131347656
Epoch: 13, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.638 Vali Acc: 0.703 Test Loss: 0.638 Test Acc: 0.703
Validation loss decreased (-0.702892 --> -0.702892).  Saving model ...
Epoch: 14 cost time: 1.196593999862671
Epoch: 14, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.627 Vali Acc: 0.710 Test Loss: 0.627 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710139).  Saving model ...
Epoch: 15 cost time: 1.2296411991119385
Epoch: 15, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.582 Vali Acc: 0.739 Test Loss: 0.582 Test Acc: 0.739
Validation loss decreased (-0.710139 --> -0.739125).  Saving model ...
Epoch: 16 cost time: 1.1354296207427979
Epoch: 16, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.566 Vali Acc: 0.739 Test Loss: 0.566 Test Acc: 0.739
Validation loss decreased (-0.739125 --> -0.739125).  Saving model ...
Epoch: 17 cost time: 1.2144198417663574
Epoch: 17, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.548 Vali Acc: 0.790 Test Loss: 0.548 Test Acc: 0.790
Validation loss decreased (-0.739125 --> -0.789850).  Saving model ...
Epoch: 18 cost time: 1.1961090564727783
Epoch: 18, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.582 Vali Acc: 0.739 Test Loss: 0.582 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2477614879608154
Epoch: 19, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 20 cost time: 1.7394864559173584
Epoch: 20, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.271178960800171
Epoch: 21, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.499 Vali Acc: 0.804 Test Loss: 0.499 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.430645227432251
Epoch: 22, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 1.0459203720092773
Epoch: 23, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0563716888427734
Epoch: 24, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.485 Vali Acc: 0.812 Test Loss: 0.485 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2291667461395264
Epoch: 25, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 1.2991814613342285
Epoch: 26, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 1.4282820224761963
Epoch: 27, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5964927673339844
Epoch: 28, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 1.3233520984649658
Epoch: 29, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3783020973205566
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.219618558883667
Epoch: 31, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 1.071354627609253
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.283897876739502
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.096013069152832
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2483503818511963
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4202635288238525
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2900261878967285
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2718994617462158
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2609319686889648
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2927632331848145
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2081127166748047
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.458 Vali Acc: 0.855 Test Loss: 0.458 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 42 cost time: 1.4668877124786377
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4040279388427734
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2872705459594727
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2007668018341064
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4430468082427979
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3248488903045654
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0714635848999023
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1160175800323486
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4171102046966553
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3975753784179688
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 520872
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.619459629058838
Epoch: 1, Steps: 9 | Train Loss: 1.525 Vali Loss: 1.396 Vali Acc: 0.225 Test Loss: 1.396 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.606553077697754
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.351 Vali Acc: 0.290 Test Loss: 1.351 Test Acc: 0.290
Validation loss decreased (-0.224624 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 1.4685006141662598
Epoch: 3, Steps: 9 | Train Loss: 1.291 Vali Loss: 1.264 Vali Acc: 0.478 Test Loss: 1.264 Test Acc: 0.478
Validation loss decreased (-0.289842 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 1.4448597431182861
Epoch: 4, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.193 Vali Acc: 0.471 Test Loss: 1.193 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0043327808380127
Epoch: 5, Steps: 9 | Train Loss: 1.089 Vali Loss: 1.094 Vali Acc: 0.601 Test Loss: 1.094 Test Acc: 0.601
Validation loss decreased (-0.478248 --> -0.601438).  Saving model ...
Epoch: 6 cost time: 1.3229105472564697
Epoch: 6, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.024 Vali Acc: 0.601 Test Loss: 1.024 Test Acc: 0.601
Validation loss decreased (-0.601438 --> -0.601439).  Saving model ...
Epoch: 7 cost time: 1.1066067218780518
Epoch: 7, Steps: 9 | Train Loss: 0.852 Vali Loss: 0.932 Vali Acc: 0.594 Test Loss: 0.932 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8903541564941406
Epoch: 8, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.837 Vali Acc: 0.630 Test Loss: 0.837 Test Acc: 0.630
Validation loss decreased (-0.601439 --> -0.630426).  Saving model ...
Epoch: 9 cost time: 1.2523901462554932
Epoch: 9, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.748 Vali Acc: 0.696 Test Loss: 0.748 Test Acc: 0.696
Validation loss decreased (-0.630426 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 1.1308965682983398
Epoch: 10, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.710 Vali Acc: 0.703 Test Loss: 0.710 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 11 cost time: 1.2784850597381592
Epoch: 11, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.685 Vali Acc: 0.681 Test Loss: 0.685 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1859140396118164
Epoch: 12, Steps: 9 | Train Loss: 0.464 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 13 cost time: 1.5421772003173828
Epoch: 13, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 14 cost time: 1.1624863147735596
Epoch: 14, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 15 cost time: 1.2712574005126953
Epoch: 15, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.601 Vali Acc: 0.739 Test Loss: 0.601 Test Acc: 0.739
Validation loss decreased (-0.717385 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 1.2544105052947998
Epoch: 16, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3697030544281006
Epoch: 17, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 1.2526435852050781
Epoch: 18, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.547 Vali Acc: 0.790 Test Loss: 0.547 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.1554813385009766
Epoch: 19, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 20 cost time: 1.2247204780578613
Epoch: 20, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.474 Vali Acc: 0.812 Test Loss: 0.474 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1197197437286377
Epoch: 21, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2986476421356201
Epoch: 22, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 23 cost time: 1.265645980834961
Epoch: 23, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 1.2078828811645508
Epoch: 24, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 1.4722535610198975
Epoch: 25, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3233416080474854
Epoch: 26, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 1.541275978088379
Epoch: 27, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3111400604248047
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3786232471466064
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.363495111465454
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4087159633636475
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 1.4233760833740234
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3704917430877686
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5629351139068604
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8263843059539795
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4290142059326172
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4276385307312012
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4791138172149658
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.358891487121582
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2791862487792969
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 41 cost time: 1.3518118858337402
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5687565803527832
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.795424222946167
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3738160133361816
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.353503942489624
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4687995910644531
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.208057165145874
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5409328937530518
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3645966053009033
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2891781330108643
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 519144
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6439428329467773
Epoch: 1, Steps: 9 | Train Loss: 1.490 Vali Loss: 1.375 Vali Acc: 0.304 Test Loss: 1.375 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.1413049697875977
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.336 Vali Acc: 0.406 Test Loss: 1.336 Test Acc: 0.406
Validation loss decreased (-0.304334 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.143324375152588
Epoch: 3, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.256 Vali Acc: 0.391 Test Loss: 1.256 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.145287036895752
Epoch: 4, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.180 Vali Acc: 0.399 Test Loss: 1.180 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2862622737884521
Epoch: 5, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.107 Vali Acc: 0.594 Test Loss: 1.107 Test Acc: 0.594
Validation loss decreased (-0.405784 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 1.157414436340332
Epoch: 6, Steps: 9 | Train Loss: 0.989 Vali Loss: 1.026 Vali Acc: 0.565 Test Loss: 1.026 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.216550350189209
Epoch: 7, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.957 Vali Acc: 0.616 Test Loss: 0.957 Test Acc: 0.616
Validation loss decreased (-0.594192 --> -0.615932).  Saving model ...
Epoch: 8 cost time: 1.1292140483856201
Epoch: 8, Steps: 9 | Train Loss: 0.741 Vali Loss: 0.877 Vali Acc: 0.630 Test Loss: 0.877 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630426).  Saving model ...
Epoch: 9 cost time: 1.0215725898742676
Epoch: 9, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.815 Vali Acc: 0.667 Test Loss: 0.815 Test Acc: 0.667
Validation loss decreased (-0.630426 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.150930404663086
Epoch: 10, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.732 Vali Acc: 0.703 Test Loss: 0.732 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 11 cost time: 1.1414222717285156
Epoch: 11, Steps: 9 | Train Loss: 0.540 Vali Loss: 0.685 Vali Acc: 0.696 Test Loss: 0.685 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3094761371612549
Epoch: 12, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.676 Vali Acc: 0.681 Test Loss: 0.676 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1174938678741455
Epoch: 13, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.652 Vali Acc: 0.681 Test Loss: 0.652 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4266424179077148
Epoch: 14, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.653 Vali Acc: 0.710 Test Loss: 0.653 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 15 cost time: 1.1635565757751465
Epoch: 15, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 16 cost time: 1.2578530311584473
Epoch: 16, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 17 cost time: 1.1502609252929688
Epoch: 17, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.582 Vali Acc: 0.725 Test Loss: 0.582 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6739857196807861
Epoch: 18, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 19 cost time: 1.2315871715545654
Epoch: 19, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2498998641967773
Epoch: 20, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0835816860198975
Epoch: 21, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.509 Vali Acc: 0.790 Test Loss: 0.509 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 22 cost time: 1.1158206462860107
Epoch: 22, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 23 cost time: 1.0812981128692627
Epoch: 23, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0046095848083496
Epoch: 24, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 25 cost time: 1.190234661102295
Epoch: 25, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 26 cost time: 1.2691376209259033
Epoch: 26, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 1.333268642425537
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 28 cost time: 1.246192216873169
Epoch: 28, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 1.1753699779510498
Epoch: 29, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.04530930519104
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1596031188964844
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1898438930511475
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2364921569824219
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0789368152618408
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876807).  Saving model ...
Epoch: 35 cost time: 1.1326558589935303
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 36 cost time: 1.1950373649597168
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1947970390319824
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1677045822143555
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3293581008911133
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 40 cost time: 1.3336915969848633
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3087711334228516
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4447917938232422
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3643550872802734
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2258143424987793
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1338911056518555
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.093372106552124
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 47 cost time: 1.1796796321868896
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1662395000457764
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.877 Test Loss: 0.442 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0567433834075928
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2382357120513916
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 51 cost time: 1.2546863555908203
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.215956211090088
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1320734024047852
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0469725131988525
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2306056022644043
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0301768779754639
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2428812980651855
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1492257118225098
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.141974687576294
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1958343982696533
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.884 Test Loss: 0.447 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 517416
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0707767009735107
Epoch: 1, Steps: 9 | Train Loss: 1.475 Vali Loss: 1.382 Vali Acc: 0.304 Test Loss: 1.382 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.1140942573547363
Epoch: 2, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.342 Vali Acc: 0.319 Test Loss: 1.342 Test Acc: 0.319
Validation loss decreased (-0.304334 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.0786418914794922
Epoch: 3, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.252 Vali Acc: 0.413 Test Loss: 1.252 Test Acc: 0.413
Validation loss decreased (-0.318827 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.0312981605529785
Epoch: 4, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.171 Vali Acc: 0.457 Test Loss: 1.171 Test Acc: 0.457
Validation loss decreased (-0.413031 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 1.2009682655334473
Epoch: 5, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.093 Vali Acc: 0.435 Test Loss: 1.093 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3217732906341553
Epoch: 6, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.005 Vali Acc: 0.565 Test Loss: 1.005 Test Acc: 0.565
Validation loss decreased (-0.456510 --> -0.565207).  Saving model ...
Epoch: 7 cost time: 1.1160364151000977
Epoch: 7, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.916 Vali Acc: 0.565 Test Loss: 0.916 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565208).  Saving model ...
Epoch: 8 cost time: 1.07432222366333
Epoch: 8, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.836 Vali Acc: 0.667 Test Loss: 0.836 Test Acc: 0.667
Validation loss decreased (-0.565208 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 1.1561338901519775
Epoch: 9, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.782 Vali Acc: 0.674 Test Loss: 0.782 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 1.1909456253051758
Epoch: 10, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.749 Vali Acc: 0.688 Test Loss: 0.749 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 1.269164800643921
Epoch: 11, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.717 Vali Acc: 0.667 Test Loss: 0.717 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1794302463531494
Epoch: 12, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.653 Vali Acc: 0.710 Test Loss: 0.653 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 1.1759960651397705
Epoch: 13, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 14 cost time: 1.2447154521942139
Epoch: 14, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 15 cost time: 1.0735399723052979
Epoch: 15, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.581 Vali Acc: 0.725 Test Loss: 0.581 Test Acc: 0.725
Validation loss decreased (-0.717385 --> -0.724632).  Saving model ...
Epoch: 16 cost time: 1.152867317199707
Epoch: 16, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.724632 --> -0.746371).  Saving model ...
Epoch: 17 cost time: 1.1981456279754639
Epoch: 17, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 18 cost time: 1.2969756126403809
Epoch: 18, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2027604579925537
Epoch: 19, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.518 Vali Acc: 0.768 Test Loss: 0.518 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2481656074523926
Epoch: 20, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 21 cost time: 1.0614464282989502
Epoch: 21, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.0907859802246094
Epoch: 22, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.337287425994873
Epoch: 23, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1910171508789062
Epoch: 24, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.520 Vali Acc: 0.797 Test Loss: 0.520 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1904187202453613
Epoch: 25, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2420268058776855
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 1.1572909355163574
Epoch: 27, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.0817348957061768
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2067689895629883
Epoch: 29, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0737950801849365
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1149303913116455
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 1.1061680316925049
Epoch: 32, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.184079647064209
Epoch: 33, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2088713645935059
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.280574083328247
Epoch: 35, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1502833366394043
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1947124004364014
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1847071647644043
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1943416595458984
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2392394542694092
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3136146068572998
Epoch: 41, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 440040
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0803282260894775
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.421 Vali Acc: 0.196 Test Loss: 1.421 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 1.1005446910858154
Epoch: 2, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.356 Vali Acc: 0.391 Test Loss: 1.356 Test Acc: 0.391
Validation loss decreased (-0.195638 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.1716673374176025
Epoch: 3, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.291 Vali Acc: 0.362 Test Loss: 1.291 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1231105327606201
Epoch: 4, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.216 Vali Acc: 0.442 Test Loss: 1.216 Test Acc: 0.442
Validation loss decreased (-0.391291 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 1.1031572818756104
Epoch: 5, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
Validation loss decreased (-0.442017 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.1977825164794922
Epoch: 6, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.049 Vali Acc: 0.536 Test Loss: 1.049 Test Acc: 0.536
Validation loss decreased (-0.499989 --> -0.536221).  Saving model ...
Epoch: 7 cost time: 1.162914514541626
Epoch: 7, Steps: 9 | Train Loss: 0.868 Vali Loss: 0.964 Vali Acc: 0.565 Test Loss: 0.964 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565208).  Saving model ...
Epoch: 8 cost time: 1.1491379737854004
Epoch: 8, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.888 Vali Acc: 0.630 Test Loss: 0.888 Test Acc: 0.630
Validation loss decreased (-0.565208 --> -0.630426).  Saving model ...
Epoch: 9 cost time: 1.160353660583496
Epoch: 9, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.820 Vali Acc: 0.674 Test Loss: 0.820 Test Acc: 0.674
Validation loss decreased (-0.630426 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 1.2237489223480225
Epoch: 10, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.761 Vali Acc: 0.674 Test Loss: 0.761 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 11 cost time: 1.2331316471099854
Epoch: 11, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.737 Vali Acc: 0.674 Test Loss: 0.737 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673906).  Saving model ...
Epoch: 12 cost time: 1.1542081832885742
Epoch: 12, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.683 Vali Acc: 0.696 Test Loss: 0.683 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695645).  Saving model ...
Epoch: 13 cost time: 1.1322076320648193
Epoch: 13, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.664 Vali Acc: 0.696 Test Loss: 0.664 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695646).  Saving model ...
Epoch: 14 cost time: 1.4310946464538574
Epoch: 14, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.669 Vali Acc: 0.681 Test Loss: 0.669 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2401130199432373
Epoch: 15, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
Validation loss decreased (-0.695646 --> -0.731878).  Saving model ...
Epoch: 16 cost time: 1.085336446762085
Epoch: 16, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.657 Vali Acc: 0.696 Test Loss: 0.657 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2000677585601807
Epoch: 17, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1014080047607422
Epoch: 18, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 19 cost time: 1.2169303894042969
Epoch: 19, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.561 Vali Acc: 0.761 Test Loss: 0.561 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760864).  Saving model ...
Epoch: 20 cost time: 1.0408532619476318
Epoch: 20, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775357).  Saving model ...
Epoch: 21 cost time: 1.2608776092529297
Epoch: 21, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1994352340698242
Epoch: 22, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.491 Vali Acc: 0.804 Test Loss: 0.491 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 23 cost time: 1.5250029563903809
Epoch: 23, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.540 Vali Acc: 0.790 Test Loss: 0.540 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2947783470153809
Epoch: 24, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 1.220090389251709
Epoch: 25, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.512 Vali Acc: 0.790 Test Loss: 0.512 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3147644996643066
Epoch: 26, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.143897294998169
Epoch: 27, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.460 Vali Acc: 0.826 Test Loss: 0.460 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 28 cost time: 1.3546619415283203
Epoch: 28, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1147644519805908
Epoch: 29, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 30 cost time: 1.3922226428985596
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.493 Vali Acc: 0.826 Test Loss: 0.493 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3382952213287354
Epoch: 31, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 32 cost time: 1.5179474353790283
Epoch: 32, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 33 cost time: 1.3400516510009766
Epoch: 33, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5265038013458252
Epoch: 34, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3323895931243896
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4158406257629395
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2786860466003418
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3969638347625732
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 39 cost time: 1.272810935974121
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.16357421875
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5816833972930908
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3505008220672607
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.439 Vali Acc: 0.870 Test Loss: 0.439 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.323869228363037
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2211577892303467
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 45 cost time: 1.1082806587219238
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0491094589233398
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1196870803833008
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0777926445007324
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3321599960327148
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3706119060516357
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1542155742645264
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.884 Test Loss: 0.454 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1781525611877441
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.026038408279419
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.2599663734436035
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 438312
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.403765916824341
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.385 Vali Acc: 0.254 Test Loss: 1.385 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.2160038948059082
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.309 Vali Acc: 0.319 Test Loss: 1.309 Test Acc: 0.319
Validation loss decreased (-0.253609 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.2131593227386475
Epoch: 3, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.318827 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 1.1880674362182617
Epoch: 4, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.485495 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.4622764587402344
Epoch: 5, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.076 Vali Acc: 0.551 Test Loss: 1.076 Test Acc: 0.551
Validation loss decreased (-0.499988 --> -0.550714).  Saving model ...
Epoch: 6 cost time: 1.4955897331237793
Epoch: 6, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.997 Vali Acc: 0.601 Test Loss: 0.997 Test Acc: 0.601
Validation loss decreased (-0.550714 --> -0.601439).  Saving model ...
Epoch: 7 cost time: 1.1837220191955566
Epoch: 7, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.928 Vali Acc: 0.587 Test Loss: 0.928 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2218406200408936
Epoch: 8, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.851 Vali Acc: 0.652 Test Loss: 0.851 Test Acc: 0.652
Validation loss decreased (-0.601439 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 1.1313557624816895
Epoch: 9, Steps: 9 | Train Loss: 0.706 Vali Loss: 0.806 Vali Acc: 0.688 Test Loss: 0.806 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 1.3368778228759766
Epoch: 10, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.734 Vali Acc: 0.659 Test Loss: 0.734 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4014511108398438
Epoch: 11, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.698 Vali Acc: 0.703 Test Loss: 0.698 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702892).  Saving model ...
Epoch: 12 cost time: 1.448559045791626
Epoch: 12, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.652 Vali Acc: 0.696 Test Loss: 0.652 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3876454830169678
Epoch: 13, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.656 Vali Acc: 0.696 Test Loss: 0.656 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2511160373687744
Epoch: 14, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.632 Vali Acc: 0.674 Test Loss: 0.632 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3343470096588135
Epoch: 15, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.570 Vali Acc: 0.725 Test Loss: 0.570 Test Acc: 0.725
Validation loss decreased (-0.702892 --> -0.724632).  Saving model ...
Epoch: 16 cost time: 1.147923469543457
Epoch: 16, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.308953046798706
Epoch: 17, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3387811183929443
Epoch: 18, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
Validation loss decreased (-0.724632 --> -0.746371).  Saving model ...
Epoch: 19 cost time: 1.266477108001709
Epoch: 19, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 20 cost time: 1.2321946620941162
Epoch: 20, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.579 Vali Acc: 0.739 Test Loss: 0.579 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2665948867797852
Epoch: 21, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.543 Vali Acc: 0.768 Test Loss: 0.543 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3967301845550537
Epoch: 22, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.527 Vali Acc: 0.797 Test Loss: 0.527 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 23 cost time: 1.1290287971496582
Epoch: 23, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 24 cost time: 1.235029935836792
Epoch: 24, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6197965145111084
Epoch: 25, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.36012864112854
Epoch: 26, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.533 Vali Acc: 0.797 Test Loss: 0.533 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.327988862991333
Epoch: 27, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.504 Vali Acc: 0.819 Test Loss: 0.504 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 1.1459784507751465
Epoch: 28, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 29 cost time: 1.1148531436920166
Epoch: 29, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 1.325347900390625
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7463080883026123
Epoch: 31, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2070422172546387
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.242751121520996
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 34 cost time: 1.3960707187652588
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3117575645446777
Epoch: 35, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4240286350250244
Epoch: 36, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2555851936340332
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 38 cost time: 1.163191318511963
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2614374160766602
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 40 cost time: 1.3600690364837646
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5503723621368408
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 42 cost time: 1.323171615600586
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2938706874847412
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2870275974273682
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 45 cost time: 1.3927083015441895
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 46 cost time: 1.4000132083892822
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2724971771240234
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 48 cost time: 1.424039602279663
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.411581039428711
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.296135425567627
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.3306479454040527
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2106001377105713
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 53 cost time: 1.056044101715088
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4104676246643066
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4502978324890137
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4983539581298828
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.3047261238098145
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.4317941665649414
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.870 Test Loss: 0.477 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.3786134719848633
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.331514835357666
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.4461050033569336
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.862 Test Loss: 0.508 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.5028977394104004
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 436584
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.309290885925293
Epoch: 1, Steps: 9 | Train Loss: 1.506 Vali Loss: 1.435 Vali Acc: 0.239 Test Loss: 1.435 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.3976695537567139
Epoch: 2, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.396 Vali Acc: 0.355 Test Loss: 1.396 Test Acc: 0.355
Validation loss decreased (-0.239116 --> -0.355058).  Saving model ...
Epoch: 3 cost time: 1.3748884201049805
Epoch: 3, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.315 Vali Acc: 0.377 Test Loss: 1.315 Test Acc: 0.377
Validation loss decreased (-0.355058 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 1.5607047080993652
Epoch: 4, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.242 Vali Acc: 0.464 Test Loss: 1.242 Test Acc: 0.464
Validation loss decreased (-0.376798 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 1.3300399780273438
Epoch: 5, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.152 Vali Acc: 0.435 Test Loss: 1.152 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3989474773406982
Epoch: 6, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.058 Vali Acc: 0.609 Test Loss: 1.058 Test Acc: 0.609
Validation loss decreased (-0.463756 --> -0.608685).  Saving model ...
Epoch: 7 cost time: 1.3890061378479004
Epoch: 7, Steps: 9 | Train Loss: 0.941 Vali Loss: 0.946 Vali Acc: 0.652 Test Loss: 0.946 Test Acc: 0.652
Validation loss decreased (-0.608685 --> -0.652164).  Saving model ...
Epoch: 8 cost time: 1.0534052848815918
Epoch: 8, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.861 Vali Acc: 0.652 Test Loss: 0.861 Test Acc: 0.652
Validation loss decreased (-0.652164 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 1.3579237461090088
Epoch: 9, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.790 Vali Acc: 0.674 Test Loss: 0.790 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 1.2489855289459229
Epoch: 10, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.751 Vali Acc: 0.710 Test Loss: 0.751 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710137).  Saving model ...
Epoch: 11 cost time: 1.3152499198913574
Epoch: 11, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.696 Vali Acc: 0.703 Test Loss: 0.696 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5152292251586914
Epoch: 12, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.698 Vali Acc: 0.703 Test Loss: 0.698 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5345368385314941
Epoch: 13, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.654 Vali Acc: 0.688 Test Loss: 0.654 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1166296005249023
Epoch: 14, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717385).  Saving model ...
Epoch: 15 cost time: 1.0937604904174805
Epoch: 15, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 16 cost time: 1.202866554260254
Epoch: 16, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3359792232513428
Epoch: 17, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.717385 --> -0.818835).  Saving model ...
Epoch: 18 cost time: 1.336301565170288
Epoch: 18, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.553 Vali Acc: 0.739 Test Loss: 0.553 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4781510829925537
Epoch: 19, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.537 Vali Acc: 0.797 Test Loss: 0.537 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7339692115783691
Epoch: 20, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2757630348205566
Epoch: 21, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 1.2452881336212158
Epoch: 22, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6261687278747559
Epoch: 23, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.2678718566894531
Epoch: 24, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 1.562227487564087
Epoch: 25, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.6229641437530518
Epoch: 26, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 1.4882397651672363
Epoch: 27, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9002070426940918
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 1.2267823219299316
Epoch: 29, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.202986478805542
Epoch: 30, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 31 cost time: 1.1525871753692627
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5272107124328613
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7028310298919678
Epoch: 33, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4690048694610596
Epoch: 34, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4892914295196533
Epoch: 35, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3396251201629639
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4383025169372559
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3685688972473145
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2914743423461914
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 40 cost time: 1.3254683017730713
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4082298278808594
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.702775239944458
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4921150207519531
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.458 Vali Acc: 0.877 Test Loss: 0.458 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 44 cost time: 1.4067702293395996
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.389618158340454
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4295954704284668
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5946736335754395
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3982558250427246
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3936498165130615
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.855 Test Loss: 0.548 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.4826974868774414
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.550781011581421
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.4846200942993164
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.5129241943359375
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 434856
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8455827236175537
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.413 Vali Acc: 0.210 Test Loss: 1.413 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 1.2616417407989502
Epoch: 2, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.360 Vali Acc: 0.312 Test Loss: 1.360 Test Acc: 0.312
Validation loss decreased (-0.210131 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 1.0631632804870605
Epoch: 3, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.303 Vali Acc: 0.406 Test Loss: 1.303 Test Acc: 0.406
Validation loss decreased (-0.311581 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 1.0178864002227783
Epoch: 4, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.405784 --> -0.485495).  Saving model ...
Epoch: 5 cost time: 0.9883718490600586
Epoch: 5, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.179 Vali Acc: 0.399 Test Loss: 1.179 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0829782485961914
Epoch: 6, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.079 Vali Acc: 0.551 Test Loss: 1.079 Test Acc: 0.551
Validation loss decreased (-0.485495 --> -0.550714).  Saving model ...
Epoch: 7 cost time: 0.9495794773101807
Epoch: 7, Steps: 9 | Train Loss: 1.008 Vali Loss: 0.989 Vali Acc: 0.580 Test Loss: 0.989 Test Acc: 0.580
Validation loss decreased (-0.550714 --> -0.579700).  Saving model ...
Epoch: 8 cost time: 1.0727190971374512
Epoch: 8, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.898 Vali Acc: 0.681 Test Loss: 0.898 Test Acc: 0.681
Validation loss decreased (-0.579700 --> -0.681150).  Saving model ...
Epoch: 9 cost time: 1.1928081512451172
Epoch: 9, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.825 Vali Acc: 0.717 Test Loss: 0.825 Test Acc: 0.717
Validation loss decreased (-0.681150 --> -0.717383).  Saving model ...
Epoch: 10 cost time: 1.1496896743774414
Epoch: 10, Steps: 9 | Train Loss: 0.705 Vali Loss: 0.769 Vali Acc: 0.710 Test Loss: 0.769 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.240539789199829
Epoch: 11, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
Validation loss decreased (-0.717383 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 1.1918609142303467
Epoch: 12, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1502158641815186
Epoch: 13, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 1.0783534049987793
Epoch: 14, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 15 cost time: 1.1187748908996582
Epoch: 15, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 1.281703233718872
Epoch: 16, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 17 cost time: 1.2971482276916504
Epoch: 17, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.594 Vali Acc: 0.790 Test Loss: 0.594 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 18 cost time: 1.2724573612213135
Epoch: 18, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0441076755523682
Epoch: 19, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2104051113128662
Epoch: 20, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3028490543365479
Epoch: 21, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 22 cost time: 1.2978527545928955
Epoch: 22, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.501 Vali Acc: 0.812 Test Loss: 0.501 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 1.2971320152282715
Epoch: 23, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 24 cost time: 1.123744010925293
Epoch: 24, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 25 cost time: 1.1623682975769043
Epoch: 25, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.459 Vali Acc: 0.812 Test Loss: 0.459 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2217726707458496
Epoch: 26, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847821).  Saving model ...
Epoch: 27 cost time: 1.1141645908355713
Epoch: 27, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 28 cost time: 1.1684069633483887
Epoch: 28, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 1.3721489906311035
Epoch: 29, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.408 Vali Acc: 0.841 Test Loss: 0.408 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5117599964141846
Epoch: 30, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 1.196155309677124
Epoch: 31, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2330493927001953
Epoch: 32, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5274498462677002
Epoch: 33, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1333301067352295
Epoch: 34, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.015357255935669
Epoch: 35, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.165102481842041
Epoch: 36, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.348388671875
Epoch: 37, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2792935371398926
Epoch: 38, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2879586219787598
Epoch: 39, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 1.1324372291564941
Epoch: 40, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1414079666137695
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2640924453735352
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2132313251495361
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1912927627563477
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.285172939300537
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1529262065887451
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2821948528289795
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1807641983032227
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.3142383098602295
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 50 cost time: 1.4083638191223145
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 51 cost time: 1.3147234916687012
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.4422948360443115
Epoch: 52, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.553004503250122
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3079617023468018
Epoch: 54, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3356328010559082
Epoch: 55, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.4010488986968994
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.3309838771820068
Epoch: 57, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.5562269687652588
Epoch: 58, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.501009225845337
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.198340654373169
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.906 Test Loss: 0.381 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 429640
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.392019510269165
Epoch: 1, Steps: 9 | Train Loss: 1.515 Vali Loss: 1.427 Vali Acc: 0.188 Test Loss: 1.427 Test Acc: 0.188
Validation loss decreased (inf --> -0.188392).  Saving model ...
Epoch: 2 cost time: 1.4200236797332764
Epoch: 2, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.381 Vali Acc: 0.254 Test Loss: 1.381 Test Acc: 0.254
Validation loss decreased (-0.188392 --> -0.253609).  Saving model ...
Epoch: 3 cost time: 1.0762321949005127
Epoch: 3, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.320 Vali Acc: 0.341 Test Loss: 1.320 Test Acc: 0.341
Validation loss decreased (-0.253609 --> -0.340567).  Saving model ...
Epoch: 4 cost time: 1.2749109268188477
Epoch: 4, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.233 Vali Acc: 0.493 Test Loss: 1.233 Test Acc: 0.493
Validation loss decreased (-0.340567 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 1.4140260219573975
Epoch: 5, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.159 Vali Acc: 0.529 Test Loss: 1.159 Test Acc: 0.529
Validation loss decreased (-0.492741 --> -0.528974).  Saving model ...
Epoch: 6 cost time: 1.43560791015625
Epoch: 6, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.074 Vali Acc: 0.565 Test Loss: 1.074 Test Acc: 0.565
Validation loss decreased (-0.528974 --> -0.565207).  Saving model ...
Epoch: 7 cost time: 1.2382001876831055
Epoch: 7, Steps: 9 | Train Loss: 0.919 Vali Loss: 0.986 Vali Acc: 0.616 Test Loss: 0.986 Test Acc: 0.616
Validation loss decreased (-0.565207 --> -0.615932).  Saving model ...
Epoch: 8 cost time: 1.1255135536193848
Epoch: 8, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.938 Vali Acc: 0.638 Test Loss: 0.938 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 1.2621665000915527
Epoch: 9, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.847 Vali Acc: 0.659 Test Loss: 0.847 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 10 cost time: 1.4389512538909912
Epoch: 10, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.789 Vali Acc: 0.725 Test Loss: 0.789 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724630).  Saving model ...
Epoch: 11 cost time: 1.2693963050842285
Epoch: 11, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.729 Vali Acc: 0.688 Test Loss: 0.729 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3309485912322998
Epoch: 12, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.700 Vali Acc: 0.725 Test Loss: 0.700 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 1.6896882057189941
Epoch: 13, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 14 cost time: 1.3032183647155762
Epoch: 14, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 15 cost time: 1.2797904014587402
Epoch: 15, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 16 cost time: 1.158029556274414
Epoch: 16, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0976638793945312
Epoch: 17, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 1.2986063957214355
Epoch: 18, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.533 Vali Acc: 0.797 Test Loss: 0.533 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 19 cost time: 1.1551573276519775
Epoch: 19, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 1.2526473999023438
Epoch: 20, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.140967607498169
Epoch: 21, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3089580535888672
Epoch: 22, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1809802055358887
Epoch: 23, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.448 Vali Acc: 0.826 Test Loss: 0.448 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 1.270035982131958
Epoch: 24, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.472 Vali Acc: 0.819 Test Loss: 0.472 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2618579864501953
Epoch: 25, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 1.2516202926635742
Epoch: 26, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4267315864562988
Epoch: 27, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.1938698291778564
Epoch: 28, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 29 cost time: 1.2771892547607422
Epoch: 29, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 30 cost time: 1.397334098815918
Epoch: 30, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 31 cost time: 1.030526876449585
Epoch: 31, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1512346267700195
Epoch: 32, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 33 cost time: 1.2399890422821045
Epoch: 33, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.420384407043457
Epoch: 34, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 35 cost time: 1.3126115798950195
Epoch: 35, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5050888061523438
Epoch: 36, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 37 cost time: 1.2403664588928223
Epoch: 37, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1755754947662354
Epoch: 38, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.28169846534729
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 1.2462170124053955
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2559490203857422
Epoch: 41, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2477002143859863
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 43 cost time: 1.1582574844360352
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6990935802459717
Epoch: 44, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2011516094207764
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.297 Vali Acc: 0.899 Test Loss: 0.297 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 46 cost time: 1.1375746726989746
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.899 Test Loss: 0.290 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 47 cost time: 0.9796457290649414
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1268179416656494
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2330760955810547
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 50 cost time: 1.3397881984710693
Epoch: 50, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.899 Test Loss: 0.282 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1944785118103027
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.4538052082061768
Epoch: 52, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.4992196559906006
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2550208568572998
Epoch: 54, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.482046127319336
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1753382682800293
Epoch: 56, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.3928749561309814
Epoch: 57, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.5102756023406982
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.3244011402130127
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 428776
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4468443393707275
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.328 Vali Acc: 0.391 Test Loss: 1.328 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.4743452072143555
Epoch: 2, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.282 Vali Acc: 0.486 Test Loss: 1.282 Test Acc: 0.486
Validation loss decreased (-0.391291 --> -0.485494).  Saving model ...
Epoch: 3 cost time: 1.161663293838501
Epoch: 3, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.226 Vali Acc: 0.536 Test Loss: 1.226 Test Acc: 0.536
Validation loss decreased (-0.485494 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 1.2768845558166504
Epoch: 4, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.162 Vali Acc: 0.587 Test Loss: 1.162 Test Acc: 0.587
Validation loss decreased (-0.536220 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 1.305920124053955
Epoch: 5, Steps: 9 | Train Loss: 1.094 Vali Loss: 1.086 Vali Acc: 0.565 Test Loss: 1.086 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.422245979309082
Epoch: 6, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.006 Vali Acc: 0.623 Test Loss: 1.006 Test Acc: 0.623
Validation loss decreased (-0.586945 --> -0.623178).  Saving model ...
Epoch: 7 cost time: 1.3089020252227783
Epoch: 7, Steps: 9 | Train Loss: 0.917 Vali Loss: 0.936 Vali Acc: 0.565 Test Loss: 0.936 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.368237018585205
Epoch: 8, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.871 Vali Acc: 0.659 Test Loss: 0.871 Test Acc: 0.659
Validation loss decreased (-0.623178 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 1.170175313949585
Epoch: 9, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.819 Vali Acc: 0.667 Test Loss: 0.819 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 1.260317325592041
Epoch: 10, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.768 Vali Acc: 0.696 Test Loss: 0.768 Test Acc: 0.696
Validation loss decreased (-0.666658 --> -0.695644).  Saving model ...
Epoch: 11 cost time: 1.4884140491485596
Epoch: 11, Steps: 9 | Train Loss: 0.597 Vali Loss: 0.718 Vali Acc: 0.703 Test Loss: 0.718 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 1.5696005821228027
Epoch: 12, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.705 Vali Acc: 0.703 Test Loss: 0.705 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 1.2311007976531982
Epoch: 13, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 14 cost time: 1.424079179763794
Epoch: 14, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.645 Vali Acc: 0.739 Test Loss: 0.645 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 15 cost time: 1.1013808250427246
Epoch: 15, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.613 Vali Acc: 0.739 Test Loss: 0.613 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 1.2777173519134521
Epoch: 16, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3097643852233887
Epoch: 17, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
Validation loss decreased (-0.739124 --> -0.775356).  Saving model ...
Epoch: 18 cost time: 1.430724859237671
Epoch: 18, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 19 cost time: 1.5774445533752441
Epoch: 19, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.587 Vali Acc: 0.790 Test Loss: 0.587 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 20 cost time: 1.1121771335601807
Epoch: 20, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 21 cost time: 1.303910732269287
Epoch: 21, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1274516582489014
Epoch: 22, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 1.423841953277588
Epoch: 23, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 1.2849137783050537
Epoch: 24, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 1.5919685363769531
Epoch: 25, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 26 cost time: 1.5849437713623047
Epoch: 26, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 1.2440156936645508
Epoch: 27, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.1024224758148193
Epoch: 28, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1142656803131104
Epoch: 29, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 30 cost time: 1.3755600452423096
Epoch: 30, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5984523296356201
Epoch: 31, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3017992973327637
Epoch: 32, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.388334035873413
Epoch: 33, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3786919116973877
Epoch: 34, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5859498977661133
Epoch: 35, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.305290699005127
Epoch: 36, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 37 cost time: 1.4167258739471436
Epoch: 37, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3463976383209229
Epoch: 38, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2976884841918945
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 1.3808798789978027
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.571763515472412
Epoch: 41, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7922232151031494
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.331991195678711
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.399296760559082
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3866539001464844
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4647738933563232
Epoch: 46, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.4816179275512695
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.908024549484253
Epoch: 48, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2468194961547852
Epoch: 49, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 427912
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1573843955993652
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.391 Vali Acc: 0.225 Test Loss: 1.391 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.3013315200805664
Epoch: 2, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.347 Vali Acc: 0.384 Test Loss: 1.347 Test Acc: 0.384
Validation loss decreased (-0.224624 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.1081430912017822
Epoch: 3, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.283 Vali Acc: 0.413 Test Loss: 1.283 Test Acc: 0.413
Validation loss decreased (-0.384045 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.718810796737671
Epoch: 4, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.213 Vali Acc: 0.493 Test Loss: 1.213 Test Acc: 0.493
Validation loss decreased (-0.413031 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 1.2276711463928223
Epoch: 5, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.133 Vali Acc: 0.572 Test Loss: 1.133 Test Acc: 0.572
Validation loss decreased (-0.492741 --> -0.572452).  Saving model ...
Epoch: 6 cost time: 1.080535650253296
Epoch: 6, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.053 Vali Acc: 0.616 Test Loss: 1.053 Test Acc: 0.616
Validation loss decreased (-0.572452 --> -0.615931).  Saving model ...
Epoch: 7 cost time: 1.3575568199157715
Epoch: 7, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.981 Vali Acc: 0.580 Test Loss: 0.981 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3907365798950195
Epoch: 8, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.911 Vali Acc: 0.674 Test Loss: 0.911 Test Acc: 0.674
Validation loss decreased (-0.615931 --> -0.673904).  Saving model ...
Epoch: 9 cost time: 1.3126988410949707
Epoch: 9, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
Validation loss decreased (-0.673904 --> -0.717383).  Saving model ...
Epoch: 10 cost time: 1.141982078552246
Epoch: 10, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.804 Vali Acc: 0.659 Test Loss: 0.804 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2299182415008545
Epoch: 11, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717384).  Saving model ...
Epoch: 12 cost time: 1.453765869140625
Epoch: 12, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.717 Vali Acc: 0.725 Test Loss: 0.717 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 1.169321060180664
Epoch: 13, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.687 Vali Acc: 0.754 Test Loss: 0.687 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753616).  Saving model ...
Epoch: 14 cost time: 1.2102298736572266
Epoch: 14, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782602).  Saving model ...
Epoch: 15 cost time: 1.2522764205932617
Epoch: 15, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.628 Vali Acc: 0.739 Test Loss: 0.628 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1286544799804688
Epoch: 16, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.606 Vali Acc: 0.754 Test Loss: 0.606 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0118281841278076
Epoch: 17, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3591201305389404
Epoch: 18, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.546 Vali Acc: 0.790 Test Loss: 0.546 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.2102351188659668
Epoch: 19, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 20 cost time: 1.1150593757629395
Epoch: 20, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 1.259218692779541
Epoch: 21, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.505 Vali Acc: 0.819 Test Loss: 0.505 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0878992080688477
Epoch: 22, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2343831062316895
Epoch: 23, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 1.2647876739501953
Epoch: 24, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 1.290581464767456
Epoch: 25, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2582221031188965
Epoch: 26, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2727508544921875
Epoch: 27, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.400578260421753
Epoch: 28, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 1.2699253559112549
Epoch: 29, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 1.4145565032958984
Epoch: 30, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 1.328808069229126
Epoch: 31, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2863922119140625
Epoch: 32, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6694884300231934
Epoch: 33, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.590644121170044
Epoch: 34, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 35 cost time: 1.562903881072998
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2719099521636963
Epoch: 36, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2191784381866455
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.345 Vali Acc: 0.870 Test Loss: 0.345 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 38 cost time: 1.348423957824707
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1617631912231445
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1529011726379395
Epoch: 40, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2498269081115723
Epoch: 41, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3018100261688232
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4556596279144287
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1756391525268555
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.136798620223999
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.080613374710083
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.3237924575805664
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 427048
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6011829376220703
Epoch: 1, Steps: 9 | Train Loss: 1.500 Vali Loss: 1.445 Vali Acc: 0.210 Test Loss: 1.445 Test Acc: 0.210
Validation loss decreased (inf --> -0.210130).  Saving model ...
Epoch: 2 cost time: 1.2144978046417236
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.390 Vali Acc: 0.232 Test Loss: 1.390 Test Acc: 0.232
Validation loss decreased (-0.210130 --> -0.231870).  Saving model ...
Epoch: 3 cost time: 1.1571540832519531
Epoch: 3, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.363 Vali Acc: 0.297 Test Loss: 1.363 Test Acc: 0.297
Validation loss decreased (-0.231870 --> -0.297088).  Saving model ...
Epoch: 4 cost time: 1.3298242092132568
Epoch: 4, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.280 Vali Acc: 0.406 Test Loss: 1.280 Test Acc: 0.406
Validation loss decreased (-0.297088 --> -0.405784).  Saving model ...
Epoch: 5 cost time: 1.5461499691009521
Epoch: 5, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.211 Vali Acc: 0.464 Test Loss: 1.211 Test Acc: 0.464
Validation loss decreased (-0.405784 --> -0.463756).  Saving model ...
Epoch: 6 cost time: 1.1800906658172607
Epoch: 6, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.129 Vali Acc: 0.529 Test Loss: 1.129 Test Acc: 0.529
Validation loss decreased (-0.463756 --> -0.528974).  Saving model ...
Epoch: 7 cost time: 1.2961335182189941
Epoch: 7, Steps: 9 | Train Loss: 1.014 Vali Loss: 1.042 Vali Acc: 0.601 Test Loss: 1.042 Test Acc: 0.601
Validation loss decreased (-0.528974 --> -0.601439).  Saving model ...
Epoch: 8 cost time: 1.293870449066162
Epoch: 8, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.963 Vali Acc: 0.645 Test Loss: 0.963 Test Acc: 0.645
Validation loss decreased (-0.601439 --> -0.644918).  Saving model ...
Epoch: 9 cost time: 1.2448453903198242
Epoch: 9, Steps: 9 | Train Loss: 0.840 Vali Loss: 0.915 Vali Acc: 0.630 Test Loss: 0.915 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0861568450927734
Epoch: 10, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.865 Vali Acc: 0.652 Test Loss: 0.865 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 11 cost time: 1.5114762783050537
Epoch: 11, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.828 Vali Acc: 0.674 Test Loss: 0.828 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 1.4050014019012451
Epoch: 12, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.797 Vali Acc: 0.674 Test Loss: 0.797 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 1.3198275566101074
Epoch: 13, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.673905 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 1.33170485496521
Epoch: 14, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.707 Vali Acc: 0.710 Test Loss: 0.707 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.225034236907959
Epoch: 15, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.691 Vali Acc: 0.710 Test Loss: 0.691 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.332247257232666
Epoch: 16, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.685 Vali Acc: 0.696 Test Loss: 0.685 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1261701583862305
Epoch: 17, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 18 cost time: 1.1072468757629395
Epoch: 18, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 19 cost time: 1.3228003978729248
Epoch: 19, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.202087640762329
Epoch: 20, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
Validation loss decreased (-0.717385 --> -0.731878).  Saving model ...
Epoch: 21 cost time: 1.2135097980499268
Epoch: 21, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.587 Vali Acc: 0.739 Test Loss: 0.587 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739125).  Saving model ...
Epoch: 22 cost time: 1.1541876792907715
Epoch: 22, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.549 Vali Acc: 0.768 Test Loss: 0.549 Test Acc: 0.768
Validation loss decreased (-0.739125 --> -0.768110).  Saving model ...
Epoch: 23 cost time: 1.413078784942627
Epoch: 23, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 24 cost time: 1.1840054988861084
Epoch: 24, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.536 Vali Acc: 0.768 Test Loss: 0.536 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2582879066467285
Epoch: 25, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.502 Vali Acc: 0.804 Test Loss: 0.502 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 26 cost time: 1.2157618999481201
Epoch: 26, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 27 cost time: 1.0697815418243408
Epoch: 27, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0764613151550293
Epoch: 28, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 1.289388656616211
Epoch: 29, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1375706195831299
Epoch: 30, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 31 cost time: 1.06437087059021
Epoch: 31, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 32 cost time: 1.1096854209899902
Epoch: 32, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 33 cost time: 1.1857168674468994
Epoch: 33, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 34 cost time: 1.1130828857421875
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1342062950134277
Epoch: 35, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2171111106872559
Epoch: 36, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0261881351470947
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4962856769561768
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 39 cost time: 1.3231523036956787
Epoch: 39, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 40 cost time: 1.163193941116333
Epoch: 40, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3417322635650635
Epoch: 41, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2289502620697021
Epoch: 42, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1191565990447998
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.052664041519165
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 45 cost time: 1.3048286437988281
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9497940540313721
Epoch: 46, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1392168998718262
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2535808086395264
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2787835597991943
Epoch: 49, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2884445190429688
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.913 Test Loss: 0.308 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 51 cost time: 1.0975027084350586
Epoch: 51, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 52 cost time: 1.2146341800689697
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.310 Vali Acc: 0.920 Test Loss: 0.310 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0968809127807617
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2494213581085205
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3890798091888428
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2617390155792236
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.342 Vali Acc: 0.913 Test Loss: 0.342 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.2089166641235352
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2618227005004883
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.111335277557373
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.028183937072754
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1313562393188477
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 263240
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1428604125976562
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.415 Vali Acc: 0.254 Test Loss: 1.415 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.2504374980926514
Epoch: 2, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.371 Vali Acc: 0.377 Test Loss: 1.371 Test Acc: 0.377
Validation loss decreased (-0.253609 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 1.1703202724456787
Epoch: 3, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.358 Vali Acc: 0.312 Test Loss: 1.358 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2824859619140625
Epoch: 4, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.296 Vali Acc: 0.449 Test Loss: 1.296 Test Acc: 0.449
Validation loss decreased (-0.376798 --> -0.449262).  Saving model ...
Epoch: 5 cost time: 1.1723103523254395
Epoch: 5, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.227 Vali Acc: 0.551 Test Loss: 1.227 Test Acc: 0.551
Validation loss decreased (-0.449262 --> -0.550712).  Saving model ...
Epoch: 6 cost time: 1.1598036289215088
Epoch: 6, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.165 Vali Acc: 0.565 Test Loss: 1.165 Test Acc: 0.565
Validation loss decreased (-0.550712 --> -0.565206).  Saving model ...
Epoch: 7 cost time: 1.379633903503418
Epoch: 7, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.089 Vali Acc: 0.580 Test Loss: 1.089 Test Acc: 0.580
Validation loss decreased (-0.565206 --> -0.579699).  Saving model ...
Epoch: 8 cost time: 1.3166444301605225
Epoch: 8, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.003 Vali Acc: 0.580 Test Loss: 1.003 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579700).  Saving model ...
Epoch: 9 cost time: 1.2217481136322021
Epoch: 9, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.922 Vali Acc: 0.659 Test Loss: 0.922 Test Acc: 0.659
Validation loss decreased (-0.579700 --> -0.659411).  Saving model ...
Epoch: 10 cost time: 1.4151887893676758
Epoch: 10, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.857 Vali Acc: 0.681 Test Loss: 0.857 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 11 cost time: 1.3103547096252441
Epoch: 11, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.803 Vali Acc: 0.703 Test Loss: 0.803 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 1.2795183658599854
Epoch: 12, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.766 Vali Acc: 0.703 Test Loss: 0.766 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 1.1430635452270508
Epoch: 13, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 1.297978162765503
Epoch: 14, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.690 Vali Acc: 0.710 Test Loss: 0.690 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1535170078277588
Epoch: 15, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.675 Vali Acc: 0.717 Test Loss: 0.675 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 16 cost time: 1.0998306274414062
Epoch: 16, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.664 Vali Acc: 0.725 Test Loss: 0.664 Test Acc: 0.725
Validation loss decreased (-0.717385 --> -0.724631).  Saving model ...
Epoch: 17 cost time: 1.1787078380584717
Epoch: 17, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 18 cost time: 1.027439832687378
Epoch: 18, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.584 Vali Acc: 0.754 Test Loss: 0.584 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 19 cost time: 1.2582554817199707
Epoch: 19, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3210177421569824
Epoch: 20, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.552 Vali Acc: 0.761 Test Loss: 0.552 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 21 cost time: 1.345588207244873
Epoch: 21, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.545 Vali Acc: 0.761 Test Loss: 0.545 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 22 cost time: 1.0587069988250732
Epoch: 22, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.529 Vali Acc: 0.754 Test Loss: 0.529 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2484025955200195
Epoch: 23, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.486 Vali Acc: 0.812 Test Loss: 0.486 Test Acc: 0.812
Validation loss decreased (-0.760864 --> -0.811589).  Saving model ...
Epoch: 24 cost time: 1.0595722198486328
Epoch: 24, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.483 Vali Acc: 0.790 Test Loss: 0.483 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1838538646697998
Epoch: 25, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.440 Vali Acc: 0.812 Test Loss: 0.440 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 26 cost time: 1.040684700012207
Epoch: 26, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.411 Vali Acc: 0.841 Test Loss: 0.411 Test Acc: 0.841
Validation loss decreased (-0.811590 --> -0.840576).  Saving model ...
Epoch: 27 cost time: 1.4468281269073486
Epoch: 27, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2873997688293457
Epoch: 28, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2561960220336914
Epoch: 29, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.263749361038208
Epoch: 30, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6320712566375732
Epoch: 31, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
Validation loss decreased (-0.840576 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 1.1941521167755127
Epoch: 32, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.362 Vali Acc: 0.855 Test Loss: 0.362 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3727822303771973
Epoch: 33, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 1.2443056106567383
Epoch: 34, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.350 Vali Acc: 0.862 Test Loss: 0.350 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 35 cost time: 1.5013997554779053
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.353 Vali Acc: 0.862 Test Loss: 0.353 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2041144371032715
Epoch: 36, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5683562755584717
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 1.493605136871338
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2985813617706299
Epoch: 39, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4714176654815674
Epoch: 40, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 41 cost time: 1.223515272140503
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 42 cost time: 1.3887250423431396
Epoch: 42, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4221272468566895
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.343000888824463
Epoch: 44, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 45 cost time: 1.3259148597717285
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 46 cost time: 1.359917163848877
Epoch: 46, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3011417388916016
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3924744129180908
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4788095951080322
Epoch: 49, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3177003860473633
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.4391562938690186
Epoch: 51, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.3094370365142822
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.289 Vali Acc: 0.899 Test Loss: 0.289 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 53 cost time: 1.162252426147461
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.188521146774292
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2056150436401367
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 56 cost time: 1.2889697551727295
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3056666851043701
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0734145641326904
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2453701496124268
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.899 Test Loss: 0.314 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.1635375022888184
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.2800207138061523
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.899 Test Loss: 0.317 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1811811923980713
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.470724105834961
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.2482504844665527
Epoch: 64, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.899 Test Loss: 0.317 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.2793371677398682
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 262376
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.466864824295044
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.386 Vali Acc: 0.210 Test Loss: 1.386 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 1.5362658500671387
Epoch: 2, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.349 Vali Acc: 0.261 Test Loss: 1.349 Test Acc: 0.261
Validation loss decreased (-0.210131 --> -0.260856).  Saving model ...
Epoch: 3 cost time: 1.0965957641601562
Epoch: 3, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.309 Vali Acc: 0.319 Test Loss: 1.309 Test Acc: 0.319
Validation loss decreased (-0.260856 --> -0.318827).  Saving model ...
Epoch: 4 cost time: 1.13273024559021
Epoch: 4, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.236 Vali Acc: 0.413 Test Loss: 1.236 Test Acc: 0.413
Validation loss decreased (-0.318827 --> -0.413031).  Saving model ...
Epoch: 5 cost time: 1.4237773418426514
Epoch: 5, Steps: 9 | Train Loss: 1.200 Vali Loss: 1.167 Vali Acc: 0.522 Test Loss: 1.167 Test Acc: 0.522
Validation loss decreased (-0.413031 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 1.4850804805755615
Epoch: 6, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.099 Vali Acc: 0.522 Test Loss: 1.099 Test Acc: 0.522
Validation loss decreased (-0.521727 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 1.3180139064788818
Epoch: 7, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.023 Vali Acc: 0.601 Test Loss: 1.023 Test Acc: 0.601
Validation loss decreased (-0.521728 --> -0.601439).  Saving model ...
Epoch: 8 cost time: 1.2557520866394043
Epoch: 8, Steps: 9 | Train Loss: 0.934 Vali Loss: 0.952 Vali Acc: 0.601 Test Loss: 0.952 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601440).  Saving model ...
Epoch: 9 cost time: 1.1559388637542725
Epoch: 9, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.884 Vali Acc: 0.652 Test Loss: 0.884 Test Acc: 0.652
Validation loss decreased (-0.601440 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 1.1775259971618652
Epoch: 10, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.816 Vali Acc: 0.688 Test Loss: 0.816 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 1.285426378250122
Epoch: 11, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.773 Vali Acc: 0.681 Test Loss: 0.773 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3717880249023438
Epoch: 12, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.742 Vali Acc: 0.703 Test Loss: 0.742 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 1.4191293716430664
Epoch: 13, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 1.2449402809143066
Epoch: 14, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.679 Vali Acc: 0.725 Test Loss: 0.679 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 15 cost time: 1.4506449699401855
Epoch: 15, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5289084911346436
Epoch: 16, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.309546709060669
Epoch: 17, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 18 cost time: 1.0164852142333984
Epoch: 18, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.578 Vali Acc: 0.768 Test Loss: 0.578 Test Acc: 0.768
Validation loss decreased (-0.731878 --> -0.768110).  Saving model ...
Epoch: 19 cost time: 1.0219883918762207
Epoch: 19, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 20 cost time: 1.108267068862915
Epoch: 20, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 21 cost time: 1.244018316268921
Epoch: 21, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.533 Vali Acc: 0.790 Test Loss: 0.533 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.192014455795288
Epoch: 22, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.530 Vali Acc: 0.790 Test Loss: 0.530 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1716549396514893
Epoch: 23, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.514 Vali Acc: 0.812 Test Loss: 0.514 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 24 cost time: 1.2975108623504639
Epoch: 24, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 1.4752197265625
Epoch: 25, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 26 cost time: 1.030466079711914
Epoch: 26, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.111649513244629
Epoch: 27, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.192291498184204
Epoch: 28, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5318939685821533
Epoch: 29, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3364510536193848
Epoch: 30, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 31 cost time: 1.3326036930084229
Epoch: 31, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.436469554901123
Epoch: 32, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 33 cost time: 1.5236899852752686
Epoch: 33, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.241349458694458
Epoch: 34, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 1.6002118587493896
Epoch: 35, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 36 cost time: 1.361961841583252
Epoch: 36, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.462390661239624
Epoch: 37, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6101784706115723
Epoch: 38, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 39 cost time: 1.3857526779174805
Epoch: 39, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.497877597808838
Epoch: 40, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913040).  Saving model ...
Epoch: 41 cost time: 1.2848601341247559
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2328572273254395
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1258444786071777
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3310668468475342
Epoch: 44, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3446085453033447
Epoch: 45, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6029200553894043
Epoch: 46, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.430492877960205
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4909296035766602
Epoch: 48, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 49 cost time: 1.8158471584320068
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1687862873077393
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.443373680114746
Epoch: 51, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.928 Test Loss: 0.302 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 52 cost time: 1.0813226699829102
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.303 Vali Acc: 0.920 Test Loss: 0.303 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3542201519012451
Epoch: 53, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6228811740875244
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.913 Test Loss: 0.333 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.4948678016662598
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.5509984493255615
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.353 Vali Acc: 0.913 Test Loss: 0.353 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.415632963180542
Epoch: 57, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.3723719120025635
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.403001070022583
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.493586540222168
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.2329154014587402
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 261512
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.786667823791504
Epoch: 1, Steps: 9 | Train Loss: 1.527 Vali Loss: 1.412 Vali Acc: 0.261 Test Loss: 1.412 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 1.0692803859710693
Epoch: 2, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.354 Vali Acc: 0.333 Test Loss: 1.354 Test Acc: 0.333
Validation loss decreased (-0.260855 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 1.02187180519104
Epoch: 3, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.316 Vali Acc: 0.399 Test Loss: 1.316 Test Acc: 0.399
Validation loss decreased (-0.333320 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 1.127974033355713
Epoch: 4, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.398538 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2727248668670654
Epoch: 5, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.185 Vali Acc: 0.522 Test Loss: 1.185 Test Acc: 0.522
Validation loss decreased (-0.499988 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 1.0344271659851074
Epoch: 6, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.099 Vali Acc: 0.594 Test Loss: 1.099 Test Acc: 0.594
Validation loss decreased (-0.521727 --> -0.594192).  Saving model ...
Epoch: 7 cost time: 1.0286359786987305
Epoch: 7, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.018 Vali Acc: 0.601 Test Loss: 1.018 Test Acc: 0.601
Validation loss decreased (-0.594192 --> -0.601439).  Saving model ...
Epoch: 8 cost time: 1.1825244426727295
Epoch: 8, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.949 Vali Acc: 0.638 Test Loss: 0.949 Test Acc: 0.638
Validation loss decreased (-0.601439 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 1.3048210144042969
Epoch: 9, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.877 Vali Acc: 0.674 Test Loss: 0.877 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673904).  Saving model ...
Epoch: 10 cost time: 1.1660962104797363
Epoch: 10, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.826 Vali Acc: 0.688 Test Loss: 0.826 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 1.1388463973999023
Epoch: 11, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.789 Vali Acc: 0.703 Test Loss: 0.789 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 1.185218334197998
Epoch: 12, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.738 Vali Acc: 0.710 Test Loss: 0.738 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 1.0945568084716797
Epoch: 13, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 1.0504589080810547
Epoch: 14, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.674 Vali Acc: 0.739 Test Loss: 0.674 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 15 cost time: 1.1550397872924805
Epoch: 15, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3180131912231445
Epoch: 16, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3230376243591309
Epoch: 17, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.605 Vali Acc: 0.739 Test Loss: 0.605 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 18 cost time: 1.2069320678710938
Epoch: 18, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.602 Vali Acc: 0.739 Test Loss: 0.602 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 19 cost time: 1.0251591205596924
Epoch: 19, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.582 Vali Acc: 0.761 Test Loss: 0.582 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 20 cost time: 1.196570873260498
Epoch: 20, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.554 Vali Acc: 0.768 Test Loss: 0.554 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 21 cost time: 1.1330080032348633
Epoch: 21, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.558 Vali Acc: 0.761 Test Loss: 0.558 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4220049381256104
Epoch: 22, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.528 Vali Acc: 0.790 Test Loss: 0.528 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 23 cost time: 1.3209247589111328
Epoch: 23, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.508 Vali Acc: 0.790 Test Loss: 0.508 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 24 cost time: 1.0759642124176025
Epoch: 24, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.506 Vali Acc: 0.797 Test Loss: 0.506 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 1.1746952533721924
Epoch: 25, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.526 Vali Acc: 0.790 Test Loss: 0.526 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2624211311340332
Epoch: 26, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.475 Vali Acc: 0.804 Test Loss: 0.475 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 27 cost time: 1.0759193897247314
Epoch: 27, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 28 cost time: 1.1542236804962158
Epoch: 28, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.506 Vali Acc: 0.790 Test Loss: 0.506 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0456242561340332
Epoch: 29, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.454 Vali Acc: 0.812 Test Loss: 0.454 Test Acc: 0.812
Validation loss decreased (-0.811590 --> -0.811590).  Saving model ...
Epoch: 30 cost time: 1.227043867111206
Epoch: 30, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 31 cost time: 1.1332147121429443
Epoch: 31, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 32 cost time: 1.1419322490692139
Epoch: 32, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
Validation loss decreased (-0.826083 --> -0.826083).  Saving model ...
Epoch: 33 cost time: 1.1446516513824463
Epoch: 33, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 34 cost time: 1.226940631866455
Epoch: 34, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.452 Vali Acc: 0.790 Test Loss: 0.452 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1636121273040771
Epoch: 35, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2053585052490234
Epoch: 36, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.444 Vali Acc: 0.797 Test Loss: 0.444 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0511305332183838
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3924646377563477
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.422 Vali Acc: 0.819 Test Loss: 0.422 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.315312385559082
Epoch: 39, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1614248752593994
Epoch: 40, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 41 cost time: 1.127234697341919
Epoch: 41, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 42 cost time: 1.727457046508789
Epoch: 42, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.411 Vali Acc: 0.841 Test Loss: 0.411 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 43 cost time: 1.0975520610809326
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2665202617645264
Epoch: 44, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2428579330444336
Epoch: 45, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 46 cost time: 1.209646463394165
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0313389301300049
Epoch: 47, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 48 cost time: 1.3671541213989258
Epoch: 48, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4339215755462646
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1985456943511963
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1713428497314453
Epoch: 51, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 52 cost time: 1.0935611724853516
Epoch: 52, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2939808368682861
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.190054178237915
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1804943084716797
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1484873294830322
Epoch: 56, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.3159773349761963
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 58 cost time: 1.362999677658081
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2773916721343994
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.4161169528961182
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2290055751800537
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3292725086212158
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2113227844238281
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.1516647338867188
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.2282168865203857
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.3497490882873535
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.3323640823364258
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 260648
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1661715507507324
Epoch: 1, Steps: 9 | Train Loss: 1.566 Vali Loss: 1.506 Vali Acc: 0.275 Test Loss: 1.506 Test Acc: 0.275
Validation loss decreased (inf --> -0.275347).  Saving model ...
Epoch: 2 cost time: 1.2114431858062744
Epoch: 2, Steps: 9 | Train Loss: 1.461 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (-0.275347 --> -0.275348).  Saving model ...
Epoch: 3 cost time: 1.164113998413086
Epoch: 3, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.397 Vali Acc: 0.246 Test Loss: 1.397 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2824883460998535
Epoch: 4, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.358 Vali Acc: 0.283 Test Loss: 1.358 Test Acc: 0.283
Validation loss decreased (-0.275348 --> -0.282595).  Saving model ...
Epoch: 5 cost time: 1.424267053604126
Epoch: 5, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.303 Vali Acc: 0.370 Test Loss: 1.303 Test Acc: 0.370
Validation loss decreased (-0.282595 --> -0.369552).  Saving model ...
Epoch: 6 cost time: 1.136653184890747
Epoch: 6, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.248 Vali Acc: 0.493 Test Loss: 1.248 Test Acc: 0.493
Validation loss decreased (-0.369552 --> -0.492741).  Saving model ...
Epoch: 7 cost time: 1.2873728275299072
Epoch: 7, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
Validation loss decreased (-0.492741 --> -0.514481).  Saving model ...
Epoch: 8 cost time: 1.3999722003936768
Epoch: 8, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.114 Vali Acc: 0.587 Test Loss: 1.114 Test Acc: 0.587
Validation loss decreased (-0.514481 --> -0.586945).  Saving model ...
Epoch: 9 cost time: 1.2142865657806396
Epoch: 9, Steps: 9 | Train Loss: 1.003 Vali Loss: 1.037 Vali Acc: 0.580 Test Loss: 1.037 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.143357515335083
Epoch: 10, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.957 Vali Acc: 0.659 Test Loss: 0.957 Test Acc: 0.659
Validation loss decreased (-0.586945 --> -0.659411).  Saving model ...
Epoch: 11 cost time: 1.1408774852752686
Epoch: 11, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.887 Vali Acc: 0.674 Test Loss: 0.887 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673904).  Saving model ...
Epoch: 12 cost time: 1.0996685028076172
Epoch: 12, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.842 Vali Acc: 0.645 Test Loss: 0.842 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1190671920776367
Epoch: 13, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.789 Vali Acc: 0.703 Test Loss: 0.789 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 1.3375670909881592
Epoch: 14, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.751 Vali Acc: 0.696 Test Loss: 0.751 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2955968379974365
Epoch: 15, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.729 Vali Acc: 0.696 Test Loss: 0.729 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0849180221557617
Epoch: 16, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746370).  Saving model ...
Epoch: 17 cost time: 1.1539604663848877
Epoch: 17, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3090441226959229
Epoch: 18, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.626 Vali Acc: 0.739 Test Loss: 0.626 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2700550556182861
Epoch: 19, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.608 Vali Acc: 0.754 Test Loss: 0.608 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 20 cost time: 1.1466712951660156
Epoch: 20, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 21 cost time: 1.1623663902282715
Epoch: 21, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.557 Vali Acc: 0.790 Test Loss: 0.557 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 22 cost time: 1.060560941696167
Epoch: 22, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.36289381980896
Epoch: 23, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.533 Vali Acc: 0.797 Test Loss: 0.533 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 24 cost time: 1.140859842300415
Epoch: 24, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 25 cost time: 1.0559895038604736
Epoch: 25, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 26 cost time: 1.280937910079956
Epoch: 26, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.480 Vali Acc: 0.804 Test Loss: 0.480 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 27 cost time: 1.2020642757415771
Epoch: 27, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 28 cost time: 1.1704282760620117
Epoch: 28, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 1.2451415061950684
Epoch: 29, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 30 cost time: 1.207505702972412
Epoch: 30, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2972111701965332
Epoch: 31, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 32 cost time: 1.1504592895507812
Epoch: 32, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2017662525177002
Epoch: 33, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 1.1196279525756836
Epoch: 34, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 1.1654763221740723
Epoch: 35, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1584877967834473
Epoch: 36, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.325 Vali Acc: 0.870 Test Loss: 0.325 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1297457218170166
Epoch: 37, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898547).  Saving model ...
Epoch: 38 cost time: 1.0920753479003906
Epoch: 38, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3067843914031982
Epoch: 39, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.235036849975586
Epoch: 40, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 41 cost time: 1.3076419830322266
Epoch: 41, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2342889308929443
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0320830345153809
Epoch: 43, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.332 Vali Acc: 0.862 Test Loss: 0.332 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2775511741638184
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 45 cost time: 0.9964971542358398
Epoch: 45, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0417075157165527
Epoch: 46, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 47 cost time: 1.1354701519012451
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 48 cost time: 1.1517808437347412
Epoch: 48, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2386724948883057
Epoch: 49, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 50 cost time: 1.1742820739746094
Epoch: 50, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 51 cost time: 1.1316256523132324
Epoch: 51, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.272686243057251
Epoch: 52, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0914864540100098
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2624194622039795
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1981008052825928
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.118133306503296
Epoch: 56, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.3365015983581543
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3988828659057617
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1623499393463135
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.072746992111206
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 180040
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.058967113494873
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.451 Vali Acc: 0.268 Test Loss: 1.451 Test Acc: 0.268
Validation loss decreased (inf --> -0.268101).  Saving model ...
Epoch: 2 cost time: 1.2813830375671387
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (-0.268101 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 1.2406208515167236
Epoch: 3, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.337 Vali Acc: 0.348 Test Loss: 1.337 Test Acc: 0.348
Validation loss decreased (-0.297088 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 1.3509514331817627
Epoch: 4, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.309 Vali Acc: 0.384 Test Loss: 1.309 Test Acc: 0.384
Validation loss decreased (-0.347813 --> -0.384045).  Saving model ...
Epoch: 5 cost time: 1.3125879764556885
Epoch: 5, Steps: 9 | Train Loss: 1.265 Vali Loss: 1.257 Vali Acc: 0.478 Test Loss: 1.257 Test Acc: 0.478
Validation loss decreased (-0.384045 --> -0.478248).  Saving model ...
Epoch: 6 cost time: 1.1682469844818115
Epoch: 6, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.201 Vali Acc: 0.522 Test Loss: 1.201 Test Acc: 0.522
Validation loss decreased (-0.478248 --> -0.521727).  Saving model ...
Epoch: 7 cost time: 1.1052029132843018
Epoch: 7, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.136 Vali Acc: 0.522 Test Loss: 1.136 Test Acc: 0.522
Validation loss decreased (-0.521727 --> -0.521728).  Saving model ...
Epoch: 8 cost time: 1.108919620513916
Epoch: 8, Steps: 9 | Train Loss: 1.019 Vali Loss: 1.084 Vali Acc: 0.587 Test Loss: 1.084 Test Acc: 0.587
Validation loss decreased (-0.521728 --> -0.586946).  Saving model ...
Epoch: 9 cost time: 1.211625099182129
Epoch: 9, Steps: 9 | Train Loss: 0.913 Vali Loss: 1.024 Vali Acc: 0.558 Test Loss: 1.024 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1564583778381348
Epoch: 10, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.964 Vali Acc: 0.594 Test Loss: 0.964 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 11 cost time: 1.106205701828003
Epoch: 11, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.891 Vali Acc: 0.652 Test Loss: 0.891 Test Acc: 0.652
Validation loss decreased (-0.594193 --> -0.652165).  Saving model ...
Epoch: 12 cost time: 1.152467966079712
Epoch: 12, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.847 Vali Acc: 0.659 Test Loss: 0.847 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659412).  Saving model ...
Epoch: 13 cost time: 1.022301435470581
Epoch: 13, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.787 Vali Acc: 0.681 Test Loss: 0.787 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 1.2854325771331787
Epoch: 14, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
Validation loss decreased (-0.681152 --> -0.688398).  Saving model ...
Epoch: 15 cost time: 0.981839656829834
Epoch: 15, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.726 Vali Acc: 0.688 Test Loss: 0.726 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688399).  Saving model ...
Epoch: 16 cost time: 0.9905104637145996
Epoch: 16, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
Validation loss decreased (-0.688399 --> -0.717384).  Saving model ...
Epoch: 17 cost time: 1.0766022205352783
Epoch: 17, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.682 Vali Acc: 0.696 Test Loss: 0.682 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1070990562438965
Epoch: 18, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 19 cost time: 1.2674169540405273
Epoch: 19, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.645 Vali Acc: 0.703 Test Loss: 0.645 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.163771629333496
Epoch: 20, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0619869232177734
Epoch: 21, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 22 cost time: 1.3612515926361084
Epoch: 22, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.625 Vali Acc: 0.739 Test Loss: 0.625 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 23 cost time: 1.1583681106567383
Epoch: 23, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 24 cost time: 1.0898048877716064
Epoch: 24, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.594 Vali Acc: 0.754 Test Loss: 0.594 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1756103038787842
Epoch: 25, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2472925186157227
Epoch: 26, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.590 Vali Acc: 0.754 Test Loss: 0.590 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2285692691802979
Epoch: 27, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 28 cost time: 1.218918800354004
Epoch: 28, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.565 Vali Acc: 0.768 Test Loss: 0.565 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 29 cost time: 1.2630665302276611
Epoch: 29, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 30 cost time: 1.177299976348877
Epoch: 30, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 31 cost time: 1.0882532596588135
Epoch: 31, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.548 Vali Acc: 0.797 Test Loss: 0.548 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 32 cost time: 1.122795581817627
Epoch: 32, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 33 cost time: 1.1543068885803223
Epoch: 33, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 34 cost time: 1.1857726573944092
Epoch: 34, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.31703782081604
Epoch: 35, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847821).  Saving model ...
Epoch: 36 cost time: 1.0137267112731934
Epoch: 36, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 37 cost time: 1.1428229808807373
Epoch: 37, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.085672378540039
Epoch: 38, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3794736862182617
Epoch: 39, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3101465702056885
Epoch: 40, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1026418209075928
Epoch: 41, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2736916542053223
Epoch: 42, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 43 cost time: 1.2169344425201416
Epoch: 43, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0759990215301514
Epoch: 44, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.242171049118042
Epoch: 45, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 46 cost time: 1.0830857753753662
Epoch: 46, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.512 Vali Acc: 0.862 Test Loss: 0.512 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 47 cost time: 1.3218743801116943
Epoch: 47, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 48 cost time: 1.2495477199554443
Epoch: 48, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 49 cost time: 1.1382606029510498
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4404630661010742
Epoch: 50, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.147413730621338
Epoch: 51, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3444428443908691
Epoch: 52, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 53 cost time: 1.2249939441680908
Epoch: 53, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.232353687286377
Epoch: 54, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.498 Vali Acc: 0.862 Test Loss: 0.498 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.187929391860962
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 56 cost time: 1.0369863510131836
Epoch: 56, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.512 Vali Acc: 0.862 Test Loss: 0.512 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1588683128356934
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1822991371154785
Epoch: 58, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1655943393707275
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.855 Test Loss: 0.541 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.1610722541809082
Epoch: 60, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.3539674282073975
Epoch: 61, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 62 cost time: 1.1238250732421875
Epoch: 62, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.252192497253418
Epoch: 63, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.1443760395050049
Epoch: 64, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.512 Vali Acc: 0.862 Test Loss: 0.512 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.306818962097168
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.2160542011260986
Epoch: 66, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.245441198348999
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.1924047470092773
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.3781425952911377
Epoch: 69, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.154822587966919
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.095193862915039
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 179176
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8877532482147217
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.362 Vali Acc: 0.319 Test Loss: 1.362 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.3565876483917236
Epoch: 2, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.334 Vali Acc: 0.348 Test Loss: 1.334 Test Acc: 0.348
Validation loss decreased (-0.318827 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.3349347114562988
Epoch: 3, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.308 Vali Acc: 0.391 Test Loss: 1.308 Test Acc: 0.391
Validation loss decreased (-0.347813 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 1.4292738437652588
Epoch: 4, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.254 Vali Acc: 0.471 Test Loss: 1.254 Test Acc: 0.471
Validation loss decreased (-0.391291 --> -0.471002).  Saving model ...
Epoch: 5 cost time: 1.4761340618133545
Epoch: 5, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.195 Vali Acc: 0.522 Test Loss: 1.195 Test Acc: 0.522
Validation loss decreased (-0.471002 --> -0.521727).  Saving model ...
Epoch: 6 cost time: 1.244286298751831
Epoch: 6, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.138 Vali Acc: 0.536 Test Loss: 1.138 Test Acc: 0.536
Validation loss decreased (-0.521727 --> -0.536221).  Saving model ...
Epoch: 7 cost time: 1.4308602809906006
Epoch: 7, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.082 Vali Acc: 0.536 Test Loss: 1.082 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 8 cost time: 1.1299879550933838
Epoch: 8, Steps: 9 | Train Loss: 0.950 Vali Loss: 1.004 Vali Acc: 0.558 Test Loss: 1.004 Test Acc: 0.558
Validation loss decreased (-0.536221 --> -0.557961).  Saving model ...
Epoch: 9 cost time: 1.3332269191741943
Epoch: 9, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.942 Vali Acc: 0.630 Test Loss: 0.942 Test Acc: 0.630
Validation loss decreased (-0.557961 --> -0.630425).  Saving model ...
Epoch: 10 cost time: 1.3579771518707275
Epoch: 10, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.889 Vali Acc: 0.630 Test Loss: 0.889 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630426).  Saving model ...
Epoch: 11 cost time: 1.3249168395996094
Epoch: 11, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.843 Vali Acc: 0.609 Test Loss: 0.843 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4784233570098877
Epoch: 12, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.807 Vali Acc: 0.659 Test Loss: 0.807 Test Acc: 0.659
Validation loss decreased (-0.630426 --> -0.659412).  Saving model ...
Epoch: 13 cost time: 1.7191505432128906
Epoch: 13, Steps: 9 | Train Loss: 0.611 Vali Loss: 0.777 Vali Acc: 0.667 Test Loss: 0.777 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666659).  Saving model ...
Epoch: 14 cost time: 1.5624990463256836
Epoch: 14, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.736 Vali Acc: 0.674 Test Loss: 0.736 Test Acc: 0.674
Validation loss decreased (-0.666659 --> -0.673906).  Saving model ...
Epoch: 15 cost time: 1.3640556335449219
Epoch: 15, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.693 Vali Acc: 0.696 Test Loss: 0.693 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695645).  Saving model ...
Epoch: 16 cost time: 1.8001611232757568
Epoch: 16, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.666 Vali Acc: 0.703 Test Loss: 0.666 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702892).  Saving model ...
Epoch: 17 cost time: 1.4417612552642822
Epoch: 17, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.648 Vali Acc: 0.703 Test Loss: 0.648 Test Acc: 0.703
Validation loss decreased (-0.702892 --> -0.702892).  Saving model ...
Epoch: 18 cost time: 1.3091692924499512
Epoch: 18, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.648 Vali Acc: 0.703 Test Loss: 0.648 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1915302276611328
Epoch: 19, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
Validation loss decreased (-0.702892 --> -0.717385).  Saving model ...
Epoch: 20 cost time: 1.2373638153076172
Epoch: 20, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.610 Vali Acc: 0.710 Test Loss: 0.610 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.423685073852539
Epoch: 21, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.595 Vali Acc: 0.703 Test Loss: 0.595 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.35115647315979
Epoch: 22, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.585 Vali Acc: 0.725 Test Loss: 0.585 Test Acc: 0.725
Validation loss decreased (-0.717385 --> -0.724632).  Saving model ...
Epoch: 23 cost time: 1.141141653060913
Epoch: 23, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.574 Vali Acc: 0.754 Test Loss: 0.574 Test Acc: 0.754
Validation loss decreased (-0.724632 --> -0.753617).  Saving model ...
Epoch: 24 cost time: 1.351372241973877
Epoch: 24, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.543 Vali Acc: 0.775 Test Loss: 0.543 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775357).  Saving model ...
Epoch: 25 cost time: 1.3083007335662842
Epoch: 25, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.538 Vali Acc: 0.775 Test Loss: 0.538 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 26 cost time: 1.37571120262146
Epoch: 26, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5888187885284424
Epoch: 27, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.510 Vali Acc: 0.790 Test Loss: 0.510 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 28 cost time: 1.1241657733917236
Epoch: 28, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.510 Vali Acc: 0.797 Test Loss: 0.510 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 29 cost time: 1.1681015491485596
Epoch: 29, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 30 cost time: 1.3563530445098877
Epoch: 30, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 31 cost time: 1.3000140190124512
Epoch: 31, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.158207893371582
Epoch: 32, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 33 cost time: 1.2468976974487305
Epoch: 33, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 34 cost time: 1.3183493614196777
Epoch: 34, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 35 cost time: 1.0728185176849365
Epoch: 35, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 1.5069317817687988
Epoch: 36, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4178776741027832
Epoch: 37, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 1.2448840141296387
Epoch: 38, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3770787715911865
Epoch: 39, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7675285339355469
Epoch: 40, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3067193031311035
Epoch: 41, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 42 cost time: 1.189828634262085
Epoch: 42, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2720756530761719
Epoch: 43, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.722287893295288
Epoch: 44, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 45 cost time: 1.6253743171691895
Epoch: 45, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 46 cost time: 1.4201159477233887
Epoch: 46, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4771535396575928
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 48 cost time: 1.3960943222045898
Epoch: 48, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5854051113128662
Epoch: 49, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3775312900543213
Epoch: 50, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 51 cost time: 1.3186683654785156
Epoch: 51, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.4641945362091064
Epoch: 52, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.6258189678192139
Epoch: 53, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.8520324230194092
Epoch: 54, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.4686031341552734
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.510211706161499
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.5020904541015625
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.4095630645751953
Epoch: 58, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 59 cost time: 1.5781280994415283
Epoch: 59, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 60 cost time: 1.468421220779419
Epoch: 60, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3347022533416748
Epoch: 61, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.253899097442627
Epoch: 62, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.5015108585357666
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.2476558685302734
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.884 Test Loss: 0.382 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.5863251686096191
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.588871717453003
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.6904215812683105
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.6923365592956543
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.8252849578857422
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 178312
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7599308490753174
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.401 Vali Acc: 0.275 Test Loss: 1.401 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.1512057781219482
Epoch: 2, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.367 Vali Acc: 0.348 Test Loss: 1.367 Test Acc: 0.348
Validation loss decreased (-0.275348 --> -0.347812).  Saving model ...
Epoch: 3 cost time: 1.1108734607696533
Epoch: 3, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.330 Vali Acc: 0.391 Test Loss: 1.330 Test Acc: 0.391
Validation loss decreased (-0.347812 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 1.4294822216033936
Epoch: 4, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.288 Vali Acc: 0.449 Test Loss: 1.288 Test Acc: 0.449
Validation loss decreased (-0.391291 --> -0.449262).  Saving model ...
Epoch: 5 cost time: 1.461125373840332
Epoch: 5, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.229 Vali Acc: 0.493 Test Loss: 1.229 Test Acc: 0.493
Validation loss decreased (-0.449262 --> -0.492741).  Saving model ...
Epoch: 6 cost time: 1.223196029663086
Epoch: 6, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.177 Vali Acc: 0.493 Test Loss: 1.177 Test Acc: 0.493
Validation loss decreased (-0.492741 --> -0.492742).  Saving model ...
Epoch: 7 cost time: 1.1369056701660156
Epoch: 7, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.122 Vali Acc: 0.623 Test Loss: 1.122 Test Acc: 0.623
Validation loss decreased (-0.492742 --> -0.623177).  Saving model ...
Epoch: 8 cost time: 1.0794198513031006
Epoch: 8, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.056 Vali Acc: 0.616 Test Loss: 1.056 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0357956886291504
Epoch: 9, Steps: 9 | Train Loss: 0.945 Vali Loss: 1.004 Vali Acc: 0.638 Test Loss: 1.004 Test Acc: 0.638
Validation loss decreased (-0.623177 --> -0.637671).  Saving model ...
Epoch: 10 cost time: 1.0806760787963867
Epoch: 10, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.948 Vali Acc: 0.616 Test Loss: 0.948 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1302521228790283
Epoch: 11, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.890 Vali Acc: 0.674 Test Loss: 0.890 Test Acc: 0.674
Validation loss decreased (-0.637671 --> -0.673904).  Saving model ...
Epoch: 12 cost time: 1.0001800060272217
Epoch: 12, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.837 Vali Acc: 0.681 Test Loss: 0.837 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 13 cost time: 1.1591839790344238
Epoch: 13, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.805 Vali Acc: 0.674 Test Loss: 0.805 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0340931415557861
Epoch: 14, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.744 Vali Acc: 0.703 Test Loss: 0.744 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 15 cost time: 0.9843888282775879
Epoch: 15, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.719 Vali Acc: 0.703 Test Loss: 0.719 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 16 cost time: 1.1904969215393066
Epoch: 16, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.691 Vali Acc: 0.725 Test Loss: 0.691 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 17 cost time: 1.033069372177124
Epoch: 17, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.654 Vali Acc: 0.739 Test Loss: 0.654 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 18 cost time: 1.0644402503967285
Epoch: 18, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1268060207366943
Epoch: 19, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.627 Vali Acc: 0.725 Test Loss: 0.627 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1222751140594482
Epoch: 20, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.601 Vali Acc: 0.754 Test Loss: 0.601 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 21 cost time: 1.186115026473999
Epoch: 21, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.589 Vali Acc: 0.725 Test Loss: 0.589 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2936999797821045
Epoch: 22, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.557 Vali Acc: 0.761 Test Loss: 0.557 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 23 cost time: 1.1289231777191162
Epoch: 23, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782603).  Saving model ...
Epoch: 24 cost time: 1.0818047523498535
Epoch: 24, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.509 Vali Acc: 0.790 Test Loss: 0.509 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 25 cost time: 1.4225082397460938
Epoch: 25, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 26 cost time: 1.0195047855377197
Epoch: 26, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.478 Vali Acc: 0.804 Test Loss: 0.478 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2962090969085693
Epoch: 27, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.501 Vali Acc: 0.797 Test Loss: 0.501 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0755765438079834
Epoch: 28, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 29 cost time: 1.1386287212371826
Epoch: 29, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826083).  Saving model ...
Epoch: 30 cost time: 1.5485148429870605
Epoch: 30, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 1.0182559490203857
Epoch: 31, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.421 Vali Acc: 0.841 Test Loss: 0.421 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1527714729309082
Epoch: 32, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 33 cost time: 1.2574715614318848
Epoch: 33, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 34 cost time: 1.0416877269744873
Epoch: 34, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 1.097048282623291
Epoch: 35, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3369536399841309
Epoch: 36, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 37 cost time: 1.3920204639434814
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2337381839752197
Epoch: 38, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 39 cost time: 1.1766202449798584
Epoch: 39, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.215419054031372
Epoch: 40, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 41 cost time: 1.101461410522461
Epoch: 41, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1358559131622314
Epoch: 42, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.355 Vali Acc: 0.891 Test Loss: 0.355 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4482190608978271
Epoch: 43, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.454188585281372
Epoch: 44, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.326 Vali Acc: 0.899 Test Loss: 0.326 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 45 cost time: 1.2427594661712646
Epoch: 45, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1040520668029785
Epoch: 46, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.356 Vali Acc: 0.899 Test Loss: 0.356 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2012128829956055
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0616731643676758
Epoch: 48, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 49 cost time: 1.1563472747802734
Epoch: 49, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1480672359466553
Epoch: 50, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.305 Vali Acc: 0.913 Test Loss: 0.305 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 51 cost time: 1.2279882431030273
Epoch: 51, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.384 Vali Acc: 0.891 Test Loss: 0.384 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.35331130027771
Epoch: 52, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1364188194274902
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1315639019012451
Epoch: 54, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1341724395751953
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.1226110458374023
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0796995162963867
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2825846672058105
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1785709857940674
Epoch: 59, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.0278205871582031
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 177448
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.581991195678711
Epoch: 1, Steps: 9 | Train Loss: 1.488 Vali Loss: 1.380 Vali Acc: 0.341 Test Loss: 1.380 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.2449724674224854
Epoch: 2, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.340 Vali Acc: 0.399 Test Loss: 1.340 Test Acc: 0.399
Validation loss decreased (-0.340566 --> -0.398537).  Saving model ...
Epoch: 3 cost time: 1.297745704650879
Epoch: 3, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.318 Vali Acc: 0.428 Test Loss: 1.318 Test Acc: 0.428
Validation loss decreased (-0.398537 --> -0.427523).  Saving model ...
Epoch: 4 cost time: 1.0269079208374023
Epoch: 4, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.295 Vali Acc: 0.377 Test Loss: 1.295 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.002880334854126
Epoch: 5, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.240 Vali Acc: 0.543 Test Loss: 1.240 Test Acc: 0.543
Validation loss decreased (-0.427523 --> -0.543466).  Saving model ...
Epoch: 6 cost time: 1.3143830299377441
Epoch: 6, Steps: 9 | Train Loss: 1.242 Vali Loss: 1.205 Vali Acc: 0.543 Test Loss: 1.205 Test Acc: 0.543
Validation loss decreased (-0.543466 --> -0.543466).  Saving model ...
Epoch: 7 cost time: 1.695000410079956
Epoch: 7, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.153 Vali Acc: 0.522 Test Loss: 1.153 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3293688297271729
Epoch: 8, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.476602554321289
Epoch: 9, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.041 Vali Acc: 0.551 Test Loss: 1.041 Test Acc: 0.551
Validation loss decreased (-0.543466 --> -0.550714).  Saving model ...
Epoch: 10 cost time: 1.286743402481079
Epoch: 10, Steps: 9 | Train Loss: 0.994 Vali Loss: 0.981 Vali Acc: 0.587 Test Loss: 0.981 Test Acc: 0.587
Validation loss decreased (-0.550714 --> -0.586947).  Saving model ...
Epoch: 11 cost time: 1.34041166305542
Epoch: 11, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.937 Vali Acc: 0.572 Test Loss: 0.937 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3551948070526123
Epoch: 12, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.898 Vali Acc: 0.594 Test Loss: 0.898 Test Acc: 0.594
Validation loss decreased (-0.586947 --> -0.594194).  Saving model ...
Epoch: 13 cost time: 1.219322919845581
Epoch: 13, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.835 Vali Acc: 0.645 Test Loss: 0.835 Test Acc: 0.645
Validation loss decreased (-0.594194 --> -0.644919).  Saving model ...
Epoch: 14 cost time: 1.1614134311676025
Epoch: 14, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.790 Vali Acc: 0.667 Test Loss: 0.790 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 15 cost time: 1.412459373474121
Epoch: 15, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.754 Vali Acc: 0.659 Test Loss: 0.754 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2919468879699707
Epoch: 16, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.724 Vali Acc: 0.688 Test Loss: 0.724 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 17 cost time: 1.2633228302001953
Epoch: 17, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.724 Vali Acc: 0.696 Test Loss: 0.724 Test Acc: 0.696
Validation loss decreased (-0.688399 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 1.2426257133483887
Epoch: 18, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.694 Vali Acc: 0.696 Test Loss: 0.694 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695645).  Saving model ...
Epoch: 19 cost time: 1.3468372821807861
Epoch: 19, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.667 Vali Acc: 0.725 Test Loss: 0.667 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724631).  Saving model ...
Epoch: 20 cost time: 1.0629091262817383
Epoch: 20, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.655 Vali Acc: 0.703 Test Loss: 0.655 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3814539909362793
Epoch: 21, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.648 Vali Acc: 0.725 Test Loss: 0.648 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 22 cost time: 1.348968505859375
Epoch: 22, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.643 Vali Acc: 0.725 Test Loss: 0.643 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 23 cost time: 1.1859939098358154
Epoch: 23, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.634 Vali Acc: 0.725 Test Loss: 0.634 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 24 cost time: 0.9950361251831055
Epoch: 24, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 25 cost time: 1.2321674823760986
Epoch: 25, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.607 Vali Acc: 0.725 Test Loss: 0.607 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1646521091461182
Epoch: 26, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.606 Vali Acc: 0.725 Test Loss: 0.606 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.224036455154419
Epoch: 27, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0125412940979004
Epoch: 28, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.577 Vali Acc: 0.754 Test Loss: 0.577 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 29 cost time: 1.157846212387085
Epoch: 29, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.581 Vali Acc: 0.739 Test Loss: 0.581 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4550166130065918
Epoch: 30, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.565 Vali Acc: 0.768 Test Loss: 0.565 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 31 cost time: 1.194127082824707
Epoch: 31, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.566 Vali Acc: 0.754 Test Loss: 0.566 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0972130298614502
Epoch: 32, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.571 Vali Acc: 0.754 Test Loss: 0.571 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0913145542144775
Epoch: 33, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 34 cost time: 1.2517685890197754
Epoch: 34, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 35 cost time: 1.1837503910064697
Epoch: 35, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.252702236175537
Epoch: 36, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4797489643096924
Epoch: 37, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2458467483520508
Epoch: 38, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2178242206573486
Epoch: 39, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 40 cost time: 1.1153149604797363
Epoch: 40, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1703903675079346
Epoch: 41, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 42 cost time: 1.105337142944336
Epoch: 42, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3428969383239746
Epoch: 43, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.526 Vali Acc: 0.797 Test Loss: 0.526 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3970129489898682
Epoch: 44, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5641422271728516
Epoch: 45, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.163149118423462
Epoch: 46, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.387038230895996
Epoch: 47, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 48 cost time: 1.2798130512237549
Epoch: 48, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1900053024291992
Epoch: 49, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3556022644042969
Epoch: 50, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 51 cost time: 1.0334553718566895
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2656581401824951
Epoch: 52, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1007962226867676
Epoch: 53, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2481484413146973
Epoch: 54, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2653117179870605
Epoch: 55, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2327866554260254
Epoch: 56, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.3466670513153076
Epoch: 57, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 58 cost time: 1.326786994934082
Epoch: 58, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3897185325622559
Epoch: 59, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5513098239898682
Epoch: 60, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.298485279083252
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.1822717189788818
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2345366477966309
Epoch: 63, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2017948627471924
Epoch: 64, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.193526029586792
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.11867094039917
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2254705429077148
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 138440
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.894902229309082
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.404 Vali Acc: 0.268 Test Loss: 1.404 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.2471861839294434
Epoch: 2, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.372 Vali Acc: 0.304 Test Loss: 1.372 Test Acc: 0.304
Validation loss decreased (-0.268102 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 1.3958923816680908
Epoch: 3, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.344 Vali Acc: 0.312 Test Loss: 1.344 Test Acc: 0.312
Validation loss decreased (-0.304334 --> -0.311581).  Saving model ...
Epoch: 4 cost time: 1.2176275253295898
Epoch: 4, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.314 Vali Acc: 0.362 Test Loss: 1.314 Test Acc: 0.362
Validation loss decreased (-0.311581 --> -0.362306).  Saving model ...
Epoch: 5 cost time: 1.1898448467254639
Epoch: 5, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.272 Vali Acc: 0.428 Test Loss: 1.272 Test Acc: 0.428
Validation loss decreased (-0.362306 --> -0.427524).  Saving model ...
Epoch: 6 cost time: 1.4524564743041992
Epoch: 6, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.427524 --> -0.485495).  Saving model ...
Epoch: 7 cost time: 1.4599626064300537
Epoch: 7, Steps: 9 | Train Loss: 1.151 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
Validation loss decreased (-0.485495 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.189887523651123
Epoch: 8, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.129 Vali Acc: 0.536 Test Loss: 1.129 Test Acc: 0.536
Validation loss decreased (-0.499988 --> -0.536221).  Saving model ...
Epoch: 9 cost time: 1.3625719547271729
Epoch: 9, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.085 Vali Acc: 0.507 Test Loss: 1.085 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5147109031677246
Epoch: 10, Steps: 9 | Train Loss: 0.943 Vali Loss: 1.052 Vali Acc: 0.580 Test Loss: 1.052 Test Acc: 0.580
Validation loss decreased (-0.536221 --> -0.579700).  Saving model ...
Epoch: 11 cost time: 1.3570258617401123
Epoch: 11, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.985 Vali Acc: 0.543 Test Loss: 0.985 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2017889022827148
Epoch: 12, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.918 Vali Acc: 0.594 Test Loss: 0.918 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594194).  Saving model ...
Epoch: 13 cost time: 1.1548645496368408
Epoch: 13, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.858 Vali Acc: 0.630 Test Loss: 0.858 Test Acc: 0.630
Validation loss decreased (-0.594194 --> -0.630426).  Saving model ...
Epoch: 14 cost time: 1.366962194442749
Epoch: 14, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.811 Vali Acc: 0.681 Test Loss: 0.811 Test Acc: 0.681
Validation loss decreased (-0.630426 --> -0.681151).  Saving model ...
Epoch: 15 cost time: 1.2902944087982178
Epoch: 15, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.771 Vali Acc: 0.681 Test Loss: 0.771 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 16 cost time: 1.337203025817871
Epoch: 16, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.723 Vali Acc: 0.710 Test Loss: 0.723 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 17 cost time: 1.3325257301330566
Epoch: 17, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731877).  Saving model ...
Epoch: 18 cost time: 1.4865930080413818
Epoch: 18, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.654 Vali Acc: 0.710 Test Loss: 0.654 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2242894172668457
Epoch: 19, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.654 Vali Acc: 0.710 Test Loss: 0.654 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3542883396148682
Epoch: 20, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.618 Vali Acc: 0.732 Test Loss: 0.618 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 21 cost time: 1.235550880432129
Epoch: 21, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
Validation loss decreased (-0.731878 --> -0.731878).  Saving model ...
Epoch: 22 cost time: 1.2277638912200928
Epoch: 22, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.581 Vali Acc: 0.746 Test Loss: 0.581 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 23 cost time: 1.2058298587799072
Epoch: 23, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
Validation loss decreased (-0.746371 --> -0.746371).  Saving model ...
Epoch: 24 cost time: 1.3067669868469238
Epoch: 24, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.565 Vali Acc: 0.754 Test Loss: 0.565 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753618).  Saving model ...
Epoch: 25 cost time: 1.2791178226470947
Epoch: 25, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
Validation loss decreased (-0.753618 --> -0.789849).  Saving model ...
Epoch: 26 cost time: 1.4794726371765137
Epoch: 26, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.516 Vali Acc: 0.797 Test Loss: 0.516 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 27 cost time: 1.117891550064087
Epoch: 27, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 1.2327947616577148
Epoch: 28, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.485 Vali Acc: 0.804 Test Loss: 0.485 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9956669807434082
Epoch: 29, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 30 cost time: 1.309410810470581
Epoch: 30, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 31 cost time: 1.3804430961608887
Epoch: 31, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 32 cost time: 1.182175636291504
Epoch: 32, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 1.186464548110962
Epoch: 33, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 1.1439273357391357
Epoch: 34, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2306790351867676
Epoch: 35, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 1.1948888301849365
Epoch: 36, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 1.142099142074585
Epoch: 37, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 38 cost time: 1.261911153793335
Epoch: 38, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.297041416168213
Epoch: 39, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 40 cost time: 1.21760892868042
Epoch: 40, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2650482654571533
Epoch: 41, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3543810844421387
Epoch: 42, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 43 cost time: 1.5161104202270508
Epoch: 43, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.386 Vali Acc: 0.899 Test Loss: 0.386 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 44 cost time: 1.2529628276824951
Epoch: 44, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 45 cost time: 1.2527422904968262
Epoch: 45, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3639342784881592
Epoch: 46, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.382 Vali Acc: 0.899 Test Loss: 0.382 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2753770351409912
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.183997631072998
Epoch: 48, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1822288036346436
Epoch: 49, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.169414758682251
Epoch: 50, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2118065357208252
Epoch: 51, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 52 cost time: 1.4322686195373535
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2794950008392334
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1655516624450684
Epoch: 54, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 55 cost time: 1.2356209754943848
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.297306776046753
Epoch: 56, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1357223987579346
Epoch: 57, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1302862167358398
Epoch: 58, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.369 Vali Acc: 0.899 Test Loss: 0.369 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.3083839416503906
Epoch: 59, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.33561372756958
Epoch: 60, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.392091989517212
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.3198273181915283
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 63 cost time: 1.4483122825622559
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.359626054763794
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.013312816619873
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 66 cost time: 1.2791674137115479
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2745723724365234
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.352 Vali Acc: 0.899 Test Loss: 0.352 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3345813751220703
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2879409790039062
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.4150803089141846
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.082690715789795
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.1483275890350342
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.254687786102295
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.1578140258789062
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.3187975883483887
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.899 Test Loss: 0.372 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 137576
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.294281721115112
Epoch: 1, Steps: 9 | Train Loss: 1.528 Vali Loss: 1.452 Vali Acc: 0.261 Test Loss: 1.452 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 1.375192403793335
Epoch: 2, Steps: 9 | Train Loss: 1.475 Vali Loss: 1.411 Vali Acc: 0.304 Test Loss: 1.411 Test Acc: 0.304
Validation loss decreased (-0.260855 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 1.331784963607788
Epoch: 3, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.376 Vali Acc: 0.319 Test Loss: 1.376 Test Acc: 0.319
Validation loss decreased (-0.304334 --> -0.318827).  Saving model ...
Epoch: 4 cost time: 1.449875831604004
Epoch: 4, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.336 Vali Acc: 0.355 Test Loss: 1.336 Test Acc: 0.355
Validation loss decreased (-0.318827 --> -0.355059).  Saving model ...
Epoch: 5 cost time: 1.2600409984588623
Epoch: 5, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.286 Vali Acc: 0.406 Test Loss: 1.286 Test Acc: 0.406
Validation loss decreased (-0.355059 --> -0.405784).  Saving model ...
Epoch: 6 cost time: 1.2953460216522217
Epoch: 6, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.239 Vali Acc: 0.413 Test Loss: 1.239 Test Acc: 0.413
Validation loss decreased (-0.405784 --> -0.413031).  Saving model ...
Epoch: 7 cost time: 1.1500911712646484
Epoch: 7, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.189 Vali Acc: 0.449 Test Loss: 1.189 Test Acc: 0.449
Validation loss decreased (-0.413031 --> -0.449263).  Saving model ...
Epoch: 8 cost time: 1.5588629245758057
Epoch: 8, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.112 Vali Acc: 0.551 Test Loss: 1.112 Test Acc: 0.551
Validation loss decreased (-0.449263 --> -0.550714).  Saving model ...
Epoch: 9 cost time: 1.5760884284973145
Epoch: 9, Steps: 9 | Train Loss: 1.009 Vali Loss: 1.040 Vali Acc: 0.594 Test Loss: 1.040 Test Acc: 0.594
Validation loss decreased (-0.550714 --> -0.594192).  Saving model ...
Epoch: 10 cost time: 1.2505147457122803
Epoch: 10, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.979 Vali Acc: 0.587 Test Loss: 0.979 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1876120567321777
Epoch: 11, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.918 Vali Acc: 0.630 Test Loss: 0.918 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630426).  Saving model ...
Epoch: 12 cost time: 1.1792683601379395
Epoch: 12, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.862 Vali Acc: 0.674 Test Loss: 0.862 Test Acc: 0.674
Validation loss decreased (-0.630426 --> -0.673904).  Saving model ...
Epoch: 13 cost time: 1.587372064590454
Epoch: 13, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.817 Vali Acc: 0.652 Test Loss: 0.817 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3706414699554443
Epoch: 14, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.780 Vali Acc: 0.681 Test Loss: 0.780 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681152).  Saving model ...
Epoch: 15 cost time: 1.6273281574249268
Epoch: 15, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.758 Vali Acc: 0.703 Test Loss: 0.758 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702891).  Saving model ...
Epoch: 16 cost time: 1.5327565670013428
Epoch: 16, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.725 Vali Acc: 0.710 Test Loss: 0.725 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 17 cost time: 1.6325256824493408
Epoch: 17, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 18 cost time: 1.7421455383300781
Epoch: 18, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.709 Vali Acc: 0.725 Test Loss: 0.709 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3985180854797363
Epoch: 19, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.659 Vali Acc: 0.703 Test Loss: 0.659 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4729251861572266
Epoch: 20, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.663 Vali Acc: 0.725 Test Loss: 0.663 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 21 cost time: 1.3444523811340332
Epoch: 21, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7094788551330566
Epoch: 22, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.627 Vali Acc: 0.710 Test Loss: 0.627 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4979321956634521
Epoch: 23, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.619 Vali Acc: 0.725 Test Loss: 0.619 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 24 cost time: 1.274122953414917
Epoch: 24, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746371).  Saving model ...
Epoch: 25 cost time: 1.440229892730713
Epoch: 25, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.594 Vali Acc: 0.739 Test Loss: 0.594 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3608641624450684
Epoch: 26, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.593 Vali Acc: 0.725 Test Loss: 0.593 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.578476905822754
Epoch: 27, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760864).  Saving model ...
Epoch: 28 cost time: 1.672332525253296
Epoch: 28, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.572 Vali Acc: 0.768 Test Loss: 0.572 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 29 cost time: 1.4321823120117188
Epoch: 29, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 30 cost time: 1.737825632095337
Epoch: 30, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.563 Vali Acc: 0.768 Test Loss: 0.563 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.408294677734375
Epoch: 31, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 32 cost time: 1.0733325481414795
Epoch: 32, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.550 Vali Acc: 0.768 Test Loss: 0.550 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1916019916534424
Epoch: 33, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 34 cost time: 1.1947133541107178
Epoch: 34, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 35 cost time: 1.6834590435028076
Epoch: 35, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.187459945678711
Epoch: 36, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 37 cost time: 1.232128620147705
Epoch: 37, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.519 Vali Acc: 0.812 Test Loss: 0.519 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3559761047363281
Epoch: 38, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 39 cost time: 1.389967441558838
Epoch: 39, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 40 cost time: 1.5163350105285645
Epoch: 40, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 41 cost time: 1.5082118511199951
Epoch: 41, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6483407020568848
Epoch: 42, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.371190071105957
Epoch: 43, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3710389137268066
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2803692817687988
Epoch: 45, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 46 cost time: 1.5176091194152832
Epoch: 46, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 47 cost time: 1.5793237686157227
Epoch: 47, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4100654125213623
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4142670631408691
Epoch: 49, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.5459060668945312
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.2774441242218018
Epoch: 51, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.3403639793395996
Epoch: 52, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2537949085235596
Epoch: 53, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.5040292739868164
Epoch: 54, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2086396217346191
Epoch: 55, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 56 cost time: 1.4597573280334473
Epoch: 56, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 57 cost time: 1.5110759735107422
Epoch: 57, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.4293761253356934
Epoch: 58, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.5611295700073242
Epoch: 59, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.4068620204925537
Epoch: 60, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.495234727859497
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.3490691184997559
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.732065200805664
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.4361836910247803
Epoch: 64, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.2241673469543457
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.471472978591919
Epoch: 66, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 136712
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2659006118774414
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.387 Vali Acc: 0.312 Test Loss: 1.387 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.3459413051605225
Epoch: 2, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.320 Vali Acc: 0.370 Test Loss: 1.320 Test Acc: 0.370
Validation loss decreased (-0.311580 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 1.2958719730377197
Epoch: 3, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.290 Vali Acc: 0.413 Test Loss: 1.290 Test Acc: 0.413
Validation loss decreased (-0.369552 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.3265330791473389
Epoch: 4, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.236 Vali Acc: 0.493 Test Loss: 1.236 Test Acc: 0.493
Validation loss decreased (-0.413031 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 1.191443920135498
Epoch: 5, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.185 Vali Acc: 0.580 Test Loss: 1.185 Test Acc: 0.580
Validation loss decreased (-0.492741 --> -0.579698).  Saving model ...
Epoch: 6 cost time: 1.2164943218231201
Epoch: 6, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.124 Vali Acc: 0.623 Test Loss: 1.124 Test Acc: 0.623
Validation loss decreased (-0.579698 --> -0.623177).  Saving model ...
Epoch: 7 cost time: 1.2194674015045166
Epoch: 7, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.070 Vali Acc: 0.630 Test Loss: 1.070 Test Acc: 0.630
Validation loss decreased (-0.623177 --> -0.630424).  Saving model ...
Epoch: 8 cost time: 1.6095750331878662
Epoch: 8, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.014 Vali Acc: 0.630 Test Loss: 1.014 Test Acc: 0.630
Validation loss decreased (-0.630424 --> -0.630425).  Saving model ...
Epoch: 9 cost time: 1.3393759727478027
Epoch: 9, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.957 Vali Acc: 0.645 Test Loss: 0.957 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 10 cost time: 1.4477005004882812
Epoch: 10, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.906 Vali Acc: 0.652 Test Loss: 0.906 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 11 cost time: 1.2941854000091553
Epoch: 11, Steps: 9 | Train Loss: 0.824 Vali Loss: 0.847 Vali Acc: 0.681 Test Loss: 0.847 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681151).  Saving model ...
Epoch: 12 cost time: 1.4135875701904297
Epoch: 12, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.790 Vali Acc: 0.696 Test Loss: 0.790 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 13 cost time: 1.6038665771484375
Epoch: 13, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.754 Vali Acc: 0.725 Test Loss: 0.754 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 14 cost time: 1.3558712005615234
Epoch: 14, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.734 Vali Acc: 0.725 Test Loss: 0.734 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724630).  Saving model ...
Epoch: 15 cost time: 1.2803435325622559
Epoch: 15, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
Validation loss decreased (-0.724630 --> -0.775355).  Saving model ...
Epoch: 16 cost time: 1.4899470806121826
Epoch: 16, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2445945739746094
Epoch: 17, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.645 Vali Acc: 0.739 Test Loss: 0.645 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1765601634979248
Epoch: 18, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.626 Vali Acc: 0.746 Test Loss: 0.626 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0682306289672852
Epoch: 19, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4028117656707764
Epoch: 20, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.580 Vali Acc: 0.761 Test Loss: 0.580 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1576414108276367
Epoch: 21, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782603).  Saving model ...
Epoch: 22 cost time: 1.5039231777191162
Epoch: 22, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4536182880401611
Epoch: 23, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.528 Vali Acc: 0.790 Test Loss: 0.528 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 24 cost time: 1.5261216163635254
Epoch: 24, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.506 Vali Acc: 0.790 Test Loss: 0.506 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 25 cost time: 1.2993509769439697
Epoch: 25, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 26 cost time: 1.3549590110778809
Epoch: 26, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.492 Vali Acc: 0.790 Test Loss: 0.492 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2624244689941406
Epoch: 27, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 1.4047660827636719
Epoch: 28, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0999681949615479
Epoch: 29, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.421 Vali Acc: 0.841 Test Loss: 0.421 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 1.2428796291351318
Epoch: 30, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6166510581970215
Epoch: 31, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4805898666381836
Epoch: 32, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 1.4092249870300293
Epoch: 33, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 34 cost time: 1.19903564453125
Epoch: 34, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 35 cost time: 1.1476209163665771
Epoch: 35, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.160313606262207
Epoch: 36, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 37 cost time: 1.217827558517456
Epoch: 37, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 38 cost time: 1.5075502395629883
Epoch: 38, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 39 cost time: 1.451324224472046
Epoch: 39, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 1.250068187713623
Epoch: 40, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 41 cost time: 1.2357385158538818
Epoch: 41, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.298 Vali Acc: 0.899 Test Loss: 0.298 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 42 cost time: 1.2259540557861328
Epoch: 42, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.554502010345459
Epoch: 43, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.899 Test Loss: 0.295 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 44 cost time: 1.5394134521484375
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.411498785018921
Epoch: 45, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4330077171325684
Epoch: 46, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4232404232025146
Epoch: 47, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 48 cost time: 1.3447198867797852
Epoch: 48, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8502264022827148
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.899 Test Loss: 0.298 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.7682719230651855
Epoch: 50, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.913 Test Loss: 0.285 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5792174339294434
Epoch: 51, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.4890615940093994
Epoch: 52, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 53 cost time: 1.8561835289001465
Epoch: 53, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.482302188873291
Epoch: 54, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4348435401916504
Epoch: 55, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.920 Test Loss: 0.271 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 56 cost time: 1.3706436157226562
Epoch: 56, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3453001976013184
Epoch: 57, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1986935138702393
Epoch: 58, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5065860748291016
Epoch: 59, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.6886894702911377
Epoch: 60, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.920 Test Loss: 0.254 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 61 cost time: 1.5477278232574463
Epoch: 61, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3128588199615479
Epoch: 62, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.4216415882110596
Epoch: 63, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.2030513286590576
Epoch: 64, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.2833194732666016
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.276 Vali Acc: 0.899 Test Loss: 0.276 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.4380669593811035
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.6567060947418213
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.410440444946289
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.899 Test Loss: 0.281 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.8488717079162598
Epoch: 69, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.3632135391235352
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.920 Test Loss: 0.281 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 135848
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4296622276306152
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.360 Vali Acc: 0.384 Test Loss: 1.360 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 1.23240327835083
Epoch: 2, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.148 Vali Acc: 0.442 Test Loss: 1.148 Test Acc: 0.442
Validation loss decreased (-0.384044 --> -0.442018).  Saving model ...
Epoch: 3 cost time: 1.082576036453247
Epoch: 3, Steps: 9 | Train Loss: 0.980 Vali Loss: 1.065 Vali Acc: 0.464 Test Loss: 1.065 Test Acc: 0.464
Validation loss decreased (-0.442018 --> -0.463757).  Saving model ...
Epoch: 4 cost time: 0.9282658100128174
Epoch: 4, Steps: 9 | Train Loss: 0.831 Vali Loss: 1.043 Vali Acc: 0.558 Test Loss: 1.043 Test Acc: 0.558
Validation loss decreased (-0.463757 --> -0.557961).  Saving model ...
Epoch: 5 cost time: 1.2636780738830566
Epoch: 5, Steps: 9 | Train Loss: 0.725 Vali Loss: 0.961 Vali Acc: 0.551 Test Loss: 0.961 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.338484764099121
Epoch: 6, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.815 Vali Acc: 0.601 Test Loss: 0.815 Test Acc: 0.601
Validation loss decreased (-0.557961 --> -0.601441).  Saving model ...
Epoch: 7 cost time: 1.2543981075286865
Epoch: 7, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.935 Vali Acc: 0.630 Test Loss: 0.935 Test Acc: 0.630
Validation loss decreased (-0.601441 --> -0.630425).  Saving model ...
Epoch: 8 cost time: 1.0819880962371826
Epoch: 8, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.733 Vali Acc: 0.717 Test Loss: 0.733 Test Acc: 0.717
Validation loss decreased (-0.630425 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 1.3817780017852783
Epoch: 9, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.719 Vali Acc: 0.710 Test Loss: 0.719 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.301328182220459
Epoch: 10, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.710 Vali Acc: 0.725 Test Loss: 0.710 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 1.4879310131072998
Epoch: 11, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 1.4587292671203613
Epoch: 12, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.773 Vali Acc: 0.674 Test Loss: 0.773 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2404460906982422
Epoch: 13, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.839 Vali Acc: 0.732 Test Loss: 0.839 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2806477546691895
Epoch: 14, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.634 Vali Acc: 0.804 Test Loss: 0.634 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 1.1435067653656006
Epoch: 15, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.532 Vali Acc: 0.797 Test Loss: 0.532 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.404951810836792
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.879 Vali Acc: 0.761 Test Loss: 0.879 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4210469722747803
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.281637191772461
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.724 Vali Acc: 0.826 Test Loss: 0.724 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826080).  Saving model ...
Epoch: 19 cost time: 1.1366586685180664
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 1.2550346851348877
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.826 Test Loss: 0.633 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.317195177078247
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.826 Test Loss: 0.662 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5283629894256592
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5095622539520264
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 24 cost time: 1.3828084468841553
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.826 Test Loss: 0.633 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2547564506530762
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3967244625091553
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1643989086151123
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0217576026916504
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2199809551239014
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2542603015899658
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9942364692687988
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2499680519104004
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.415614128112793
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 4840988
model size : 23.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2944345474243164
Epoch: 1, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.378 Vali Acc: 0.275 Test Loss: 1.378 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.2966914176940918
Epoch: 2, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.158 Vali Acc: 0.507 Test Loss: 1.158 Test Acc: 0.507
Validation loss decreased (-0.275349 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.2015490531921387
Epoch: 3, Steps: 9 | Train Loss: 1.006 Vali Loss: 0.985 Vali Acc: 0.594 Test Loss: 0.985 Test Acc: 0.594
Validation loss decreased (-0.507235 --> -0.594193).  Saving model ...
Epoch: 4 cost time: 1.0676848888397217
Epoch: 4, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.891 Vali Acc: 0.623 Test Loss: 0.891 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 1.132828712463379
Epoch: 5, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.802 Vali Acc: 0.659 Test Loss: 0.802 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 1.0936346054077148
Epoch: 6, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.878 Vali Acc: 0.609 Test Loss: 0.878 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.313347339630127
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.855 Vali Acc: 0.703 Test Loss: 0.855 Test Acc: 0.703
Validation loss decreased (-0.659412 --> -0.702890).  Saving model ...
Epoch: 8 cost time: 1.004112720489502
Epoch: 8, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.667 Vali Acc: 0.710 Test Loss: 0.667 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 1.0820856094360352
Epoch: 9, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.587 Vali Acc: 0.768 Test Loss: 0.587 Test Acc: 0.768
Validation loss decreased (-0.710138 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 1.262894868850708
Epoch: 10, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1129271984100342
Epoch: 11, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.648 Vali Acc: 0.754 Test Loss: 0.648 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1594834327697754
Epoch: 12, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.732 Vali Acc: 0.725 Test Loss: 0.732 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2307937145233154
Epoch: 13, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.684 Vali Acc: 0.783 Test Loss: 0.684 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782602).  Saving model ...
Epoch: 14 cost time: 1.2300224304199219
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.839 Vali Acc: 0.754 Test Loss: 0.839 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3321139812469482
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804341).  Saving model ...
Epoch: 16 cost time: 1.3308525085449219
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3705744743347168
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.684 Vali Acc: 0.826 Test Loss: 0.684 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826080).  Saving model ...
Epoch: 18 cost time: 1.296769618988037
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.814 Vali Acc: 0.819 Test Loss: 0.814 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3807590007781982
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840574).  Saving model ...
Epoch: 20 cost time: 1.1393260955810547
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0603375434875488
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.819 Test Loss: 0.722 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.626401662826538
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.106337308883667
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.841 Test Loss: 0.672 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3053669929504395
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2423973083496094
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.841 Test Loss: 0.698 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6288018226623535
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.841 Test Loss: 0.678 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.348524570465088
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.493187665939331
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1065750122070312
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 4836380
model size : 23.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8099043369293213
Epoch: 1, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.362 Vali Acc: 0.261 Test Loss: 1.362 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.8663568496704102
Epoch: 2, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.175 Vali Acc: 0.478 Test Loss: 1.175 Test Acc: 0.478
Validation loss decreased (-0.260856 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 1.1022601127624512
Epoch: 3, Steps: 9 | Train Loss: 1.019 Vali Loss: 1.092 Vali Acc: 0.413 Test Loss: 1.092 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9390573501586914
Epoch: 4, Steps: 9 | Train Loss: 0.824 Vali Loss: 1.006 Vali Acc: 0.594 Test Loss: 1.006 Test Acc: 0.594
Validation loss decreased (-0.478249 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 1.2033443450927734
Epoch: 5, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.867 Vali Acc: 0.623 Test Loss: 0.867 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623180).  Saving model ...
Epoch: 6 cost time: 1.0798394680023193
Epoch: 6, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.738 Vali Acc: 0.696 Test Loss: 0.738 Test Acc: 0.696
Validation loss decreased (-0.623180 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.1725852489471436
Epoch: 7, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.821 Vali Acc: 0.630 Test Loss: 0.821 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1595425605773926
Epoch: 8, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.841 Vali Acc: 0.594 Test Loss: 0.841 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0668621063232422
Epoch: 9, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.690 Vali Acc: 0.739 Test Loss: 0.690 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 0.9377410411834717
Epoch: 10, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1992688179016113
Epoch: 11, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.599 Vali Acc: 0.754 Test Loss: 0.599 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 12 cost time: 1.142106294631958
Epoch: 12, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.553 Vali Acc: 0.790 Test Loss: 0.553 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789850).  Saving model ...
Epoch: 13 cost time: 1.10251784324646
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.706 Vali Acc: 0.768 Test Loss: 0.706 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.500889778137207
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.660 Vali Acc: 0.826 Test Loss: 0.660 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826080).  Saving model ...
Epoch: 15 cost time: 1.0733697414398193
Epoch: 15, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.616 Vali Acc: 0.797 Test Loss: 0.616 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9726088047027588
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.657 Vali Acc: 0.775 Test Loss: 0.657 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1057984828948975
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.716 Vali Acc: 0.804 Test Loss: 0.716 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3400423526763916
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840574).  Saving model ...
Epoch: 19 cost time: 0.9918582439422607
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 20 cost time: 1.3491623401641846
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3543498516082764
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.841 Test Loss: 0.587 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1931798458099365
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3318088054656982
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.138650894165039
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2562358379364014
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1872475147247314
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2249279022216797
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1347382068634033
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4622418880462646
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.848 Test Loss: 0.594 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 4831772
model size : 23.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.11543607711792
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.339 Vali Acc: 0.377 Test Loss: 1.339 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.902306318283081
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.128 Vali Acc: 0.493 Test Loss: 1.128 Test Acc: 0.493
Validation loss decreased (-0.376798 --> -0.492742).  Saving model ...
Epoch: 3 cost time: 1.1162645816802979
Epoch: 3, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.063 Vali Acc: 0.449 Test Loss: 1.063 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.166553258895874
Epoch: 4, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.998 Vali Acc: 0.478 Test Loss: 0.998 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9787094593048096
Epoch: 5, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.839 Vali Acc: 0.594 Test Loss: 0.839 Test Acc: 0.594
Validation loss decreased (-0.492742 --> -0.594195).  Saving model ...
Epoch: 6 cost time: 1.0209226608276367
Epoch: 6, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.764 Vali Acc: 0.674 Test Loss: 0.764 Test Acc: 0.674
Validation loss decreased (-0.594195 --> -0.673905).  Saving model ...
Epoch: 7 cost time: 1.3400771617889404
Epoch: 7, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.926 Vali Acc: 0.638 Test Loss: 0.926 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.015782117843628
Epoch: 8, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.760 Vali Acc: 0.667 Test Loss: 0.760 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1337592601776123
Epoch: 9, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.681 Vali Acc: 0.725 Test Loss: 0.681 Test Acc: 0.725
Validation loss decreased (-0.673905 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.118912935256958
Epoch: 10, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.686 Vali Acc: 0.754 Test Loss: 0.686 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753616).  Saving model ...
Epoch: 11 cost time: 0.9213724136352539
Epoch: 11, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.727 Vali Acc: 0.746 Test Loss: 0.727 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1065473556518555
Epoch: 12, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760863).  Saving model ...
Epoch: 13 cost time: 1.0641303062438965
Epoch: 13, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775355).  Saving model ...
Epoch: 14 cost time: 1.1304535865783691
Epoch: 14, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.0306591987609863
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.784 Vali Acc: 0.797 Test Loss: 0.784 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797094).  Saving model ...
Epoch: 16 cost time: 0.9506020545959473
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.672 Vali Acc: 0.790 Test Loss: 0.672 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.19578218460083
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.749 Vali Acc: 0.819 Test Loss: 0.749 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818833).  Saving model ...
Epoch: 18 cost time: 1.0287516117095947
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.833 Test Loss: 0.715 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 1.020322561264038
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 0.9104290008544922
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1145129203796387
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840573).  Saving model ...
Epoch: 22 cost time: 1.1789631843566895
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.848 Test Loss: 0.638 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 23 cost time: 1.0681085586547852
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.841 Test Loss: 0.643 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9971864223480225
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.841 Test Loss: 0.640 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9094069004058838
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.009641408920288
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9070491790771484
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.130852460861206
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0559015274047852
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9124979972839355
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9368085861206055
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.841 Test Loss: 0.644 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9412069320678711
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 4827164
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.765211582183838
Epoch: 1, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.280 Vali Acc: 0.435 Test Loss: 1.280 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 0.9067356586456299
Epoch: 2, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.123 Vali Acc: 0.522 Test Loss: 1.123 Test Acc: 0.522
Validation loss decreased (-0.434770 --> -0.521728).  Saving model ...
Epoch: 3 cost time: 0.9109077453613281
Epoch: 3, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.067 Vali Acc: 0.493 Test Loss: 1.067 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0470061302185059
Epoch: 4, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.984 Vali Acc: 0.478 Test Loss: 0.984 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9954423904418945
Epoch: 5, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.882 Vali Acc: 0.652 Test Loss: 0.882 Test Acc: 0.652
Validation loss decreased (-0.521728 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 0.9136323928833008
Epoch: 6, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.851 Vali Acc: 0.638 Test Loss: 0.851 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9842698574066162
Epoch: 7, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.759 Vali Acc: 0.681 Test Loss: 0.759 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681152).  Saving model ...
Epoch: 8 cost time: 1.0052850246429443
Epoch: 8, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.801 Vali Acc: 0.674 Test Loss: 0.801 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.072509765625
Epoch: 9, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
Validation loss decreased (-0.681152 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 0.979733943939209
Epoch: 10, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.647 Vali Acc: 0.703 Test Loss: 0.647 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0079891681671143
Epoch: 11, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.701 Vali Acc: 0.725 Test Loss: 0.701 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9126255512237549
Epoch: 12, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.681 Vali Acc: 0.754 Test Loss: 0.681 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753616).  Saving model ...
Epoch: 13 cost time: 0.9166154861450195
Epoch: 13, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.762 Vali Acc: 0.768 Test Loss: 0.762 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768108).  Saving model ...
Epoch: 14 cost time: 0.9181807041168213
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.708 Vali Acc: 0.732 Test Loss: 0.708 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.048980474472046
Epoch: 15, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0323452949523926
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.820 Vali Acc: 0.768 Test Loss: 0.820 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9265413284301758
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
Validation loss decreased (-0.768108 --> -0.782602).  Saving model ...
Epoch: 18 cost time: 0.9144887924194336
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.790 Test Loss: 0.591 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 19 cost time: 1.257781982421875
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.804 Test Loss: 0.758 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804340).  Saving model ...
Epoch: 20 cost time: 1.0504627227783203
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
Validation loss decreased (-0.804340 --> -0.840573).  Saving model ...
Epoch: 21 cost time: 0.9966351985931396
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855067).  Saving model ...
Epoch: 22 cost time: 1.2974064350128174
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2169370651245117
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1116664409637451
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.046976089477539
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9850187301635742
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2110764980316162
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.848 Test Loss: 0.639 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9791455268859863
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2344586849212646
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.125669002532959
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9243950843811035
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.848 Test Loss: 0.612 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 4053020
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.595261812210083
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.332 Vali Acc: 0.370 Test Loss: 1.332 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.8864541053771973
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.165 Vali Acc: 0.413 Test Loss: 1.165 Test Acc: 0.413
Validation loss decreased (-0.369552 --> -0.413032).  Saving model ...
Epoch: 3 cost time: 1.0238873958587646
Epoch: 3, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.045 Vali Acc: 0.587 Test Loss: 1.045 Test Acc: 0.587
Validation loss decreased (-0.413032 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 0.8346152305603027
Epoch: 4, Steps: 9 | Train Loss: 0.872 Vali Loss: 0.995 Vali Acc: 0.601 Test Loss: 0.995 Test Acc: 0.601
Validation loss decreased (-0.586946 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 0.9194750785827637
Epoch: 5, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.870 Vali Acc: 0.645 Test Loss: 0.870 Test Acc: 0.645
Validation loss decreased (-0.601439 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 0.8055663108825684
Epoch: 6, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.879 Vali Acc: 0.565 Test Loss: 0.879 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8983945846557617
Epoch: 7, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.744 Vali Acc: 0.703 Test Loss: 0.744 Test Acc: 0.703
Validation loss decreased (-0.644919 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 0.8286170959472656
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 0.9631710052490234
Epoch: 9, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.711 Vali Acc: 0.717 Test Loss: 0.711 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0715241432189941
Epoch: 10, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
Validation loss decreased (-0.717385 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.138479232788086
Epoch: 11, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9262089729309082
Epoch: 12, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.631 Vali Acc: 0.768 Test Loss: 0.631 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9340975284576416
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 0.9733099937438965
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.787 Vali Acc: 0.754 Test Loss: 0.787 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0202751159667969
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.647 Vali Acc: 0.819 Test Loss: 0.647 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.132350206375122
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0089313983917236
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.815 Vali Acc: 0.812 Test Loss: 0.815 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9012632369995117
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.0031261444091797
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.85451340675354
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.974 Vali Acc: 0.797 Test Loss: 0.974 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0696814060211182
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.804 Test Loss: 0.654 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.978646993637085
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.843 Vali Acc: 0.819 Test Loss: 0.843 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0778651237487793
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9545257091522217
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.826 Test Loss: 0.728 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0347535610198975
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.819 Test Loss: 0.723 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.03273344039917
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.855 Test Loss: 0.736 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855065).  Saving model ...
Epoch: 27 cost time: 0.821333646774292
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.855 Test Loss: 0.712 Test Acc: 0.855
Validation loss decreased (-0.855065 --> -0.855065).  Saving model ...
Epoch: 28 cost time: 1.064478874206543
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.848 Test Loss: 0.666 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0387322902679443
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0961408615112305
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.982285737991333
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.848 Test Loss: 0.640 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2258257865905762
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.841 Test Loss: 0.643 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0483331680297852
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.033341407775879
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2194736003875732
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0005478858947754
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1269500255584717
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 4048412
model size : 20.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.04905104637146
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.419 Vali Acc: 0.174 Test Loss: 1.419 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 1.0507709980010986
Epoch: 2, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.226 Vali Acc: 0.442 Test Loss: 1.226 Test Acc: 0.442
Validation loss decreased (-0.173899 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 1.1631691455841064
Epoch: 3, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.138 Vali Acc: 0.471 Test Loss: 1.138 Test Acc: 0.471
Validation loss decreased (-0.442017 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 1.0524239540100098
Epoch: 4, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.962 Vali Acc: 0.551 Test Loss: 0.962 Test Acc: 0.551
Validation loss decreased (-0.471003 --> -0.550715).  Saving model ...
Epoch: 5 cost time: 1.3946328163146973
Epoch: 5, Steps: 9 | Train Loss: 0.781 Vali Loss: 1.011 Vali Acc: 0.601 Test Loss: 1.011 Test Acc: 0.601
Validation loss decreased (-0.550715 --> -0.601439).  Saving model ...
Epoch: 6 cost time: 0.9987020492553711
Epoch: 6, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.895 Vali Acc: 0.529 Test Loss: 0.895 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1791248321533203
Epoch: 7, Steps: 9 | Train Loss: 0.523 Vali Loss: 1.161 Vali Acc: 0.630 Test Loss: 1.161 Test Acc: 0.630
Validation loss decreased (-0.601439 --> -0.630423).  Saving model ...
Epoch: 8 cost time: 1.0350027084350586
Epoch: 8, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.943 Vali Acc: 0.587 Test Loss: 0.943 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0440685749053955
Epoch: 9, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.790 Vali Acc: 0.667 Test Loss: 0.790 Test Acc: 0.667
Validation loss decreased (-0.630423 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.0507357120513916
Epoch: 10, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
Validation loss decreased (-0.666659 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.1138219833374023
Epoch: 11, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.948 Vali Acc: 0.645 Test Loss: 0.948 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1158244609832764
Epoch: 12, Steps: 9 | Train Loss: 0.227 Vali Loss: 1.151 Vali Acc: 0.630 Test Loss: 1.151 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2277398109436035
Epoch: 13, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.889 Vali Acc: 0.710 Test Loss: 0.889 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9809367656707764
Epoch: 14, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.637 Vali Acc: 0.768 Test Loss: 0.637 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 15 cost time: 0.9252121448516846
Epoch: 15, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
Validation loss decreased (-0.768110 --> -0.811588).  Saving model ...
Epoch: 16 cost time: 0.8720881938934326
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.626 Vali Acc: 0.761 Test Loss: 0.626 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9889602661132812
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.714 Vali Acc: 0.804 Test Loss: 0.714 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.154956340789795
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 1.0360941886901855
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 1.0095477104187012
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840574).  Saving model ...
Epoch: 21 cost time: 1.07684326171875
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9806609153747559
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.848 Test Loss: 0.598 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 23 cost time: 1.1655845642089844
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0567123889923096
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0474748611450195
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0759305953979492
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2472610473632812
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5636606216430664
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0507407188415527
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.848 Test Loss: 0.575 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 30 cost time: 1.2565598487854004
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 31 cost time: 0.9582366943359375
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1980578899383545
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2059223651885986
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.08746337890625
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.848 Test Loss: 0.586 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2266490459442139
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.848 Test Loss: 0.590 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.529524803161621
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2230846881866455
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1855711936950684
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.010357141494751
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.848 Test Loss: 0.581 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0342957973480225
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 4043804
model size : 20.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.74873423576355
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.378 Vali Acc: 0.406 Test Loss: 1.378 Test Acc: 0.406
Validation loss decreased (inf --> -0.405783).  Saving model ...
Epoch: 2 cost time: 1.2336435317993164
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.216 Vali Acc: 0.348 Test Loss: 1.216 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.097501277923584
Epoch: 3, Steps: 9 | Train Loss: 0.992 Vali Loss: 1.029 Vali Acc: 0.514 Test Loss: 1.029 Test Acc: 0.514
Validation loss decreased (-0.405783 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.031275749206543
Epoch: 4, Steps: 9 | Train Loss: 0.850 Vali Loss: 0.949 Vali Acc: 0.565 Test Loss: 0.949 Test Acc: 0.565
Validation loss decreased (-0.514482 --> -0.565208).  Saving model ...
Epoch: 5 cost time: 1.2641680240631104
Epoch: 5, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.923 Vali Acc: 0.543 Test Loss: 0.923 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1298902034759521
Epoch: 6, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.738 Vali Acc: 0.652 Test Loss: 0.738 Test Acc: 0.652
Validation loss decreased (-0.565208 --> -0.652167).  Saving model ...
Epoch: 7 cost time: 1.1465113162994385
Epoch: 7, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.770 Vali Acc: 0.630 Test Loss: 0.770 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1447539329528809
Epoch: 8, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.760 Vali Acc: 0.674 Test Loss: 0.760 Test Acc: 0.674
Validation loss decreased (-0.652167 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 1.0748722553253174
Epoch: 9, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.832 Vali Acc: 0.688 Test Loss: 0.832 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688397).  Saving model ...
Epoch: 10 cost time: 0.9633750915527344
Epoch: 10, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 0.9764561653137207
Epoch: 11, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
Validation loss decreased (-0.717384 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 0.9208583831787109
Epoch: 12, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0674359798431396
Epoch: 13, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.646 Vali Acc: 0.790 Test Loss: 0.646 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0214159488677979
Epoch: 14, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2272002696990967
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0609993934631348
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.706 Vali Acc: 0.804 Test Loss: 0.706 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0559070110321045
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0092451572418213
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.665 Vali Acc: 0.812 Test Loss: 0.665 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1742198467254639
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 0.9970207214355469
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 1.1652476787567139
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9432413578033447
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.095911979675293
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1168200969696045
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0079724788665771
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.855 Test Loss: 0.629 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855066).  Saving model ...
Epoch: 26 cost time: 1.3171777725219727
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9375171661376953
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.848 Test Loss: 0.579 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0025548934936523
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1422810554504395
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3148093223571777
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0464532375335693
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5112988948822021
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.071753978729248
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0911219120025635
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0701239109039307
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.848 Test Loss: 0.606 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 4039196
model size : 20.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2356016635894775
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.336 Vali Acc: 0.471 Test Loss: 1.336 Test Acc: 0.471
Validation loss decreased (inf --> -0.471001).  Saving model ...
Epoch: 2 cost time: 1.1188015937805176
Epoch: 2, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.183 Vali Acc: 0.420 Test Loss: 1.183 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0612590312957764
Epoch: 3, Steps: 9 | Train Loss: 1.124 Vali Loss: 1.076 Vali Acc: 0.594 Test Loss: 1.076 Test Acc: 0.594
Validation loss decreased (-0.471001 --> -0.594192).  Saving model ...
Epoch: 4 cost time: 0.8102517127990723
Epoch: 4, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.967 Vali Acc: 0.558 Test Loss: 0.967 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1478590965270996
Epoch: 5, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.872 Vali Acc: 0.609 Test Loss: 0.872 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608687).  Saving model ...
Epoch: 6 cost time: 1.1199102401733398
Epoch: 6, Steps: 9 | Train Loss: 0.578 Vali Loss: 1.039 Vali Acc: 0.500 Test Loss: 1.039 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8458187580108643
Epoch: 7, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.762 Vali Acc: 0.681 Test Loss: 0.762 Test Acc: 0.681
Validation loss decreased (-0.608687 --> -0.681152).  Saving model ...
Epoch: 8 cost time: 1.4163095951080322
Epoch: 8, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.810 Vali Acc: 0.616 Test Loss: 0.810 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.222585678100586
Epoch: 9, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.599 Vali Acc: 0.739 Test Loss: 0.599 Test Acc: 0.739
Validation loss decreased (-0.681152 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 1.1890270709991455
Epoch: 10, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0065722465515137
Epoch: 11, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3063995838165283
Epoch: 12, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1000170707702637
Epoch: 13, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782602).  Saving model ...
Epoch: 14 cost time: 1.030421495437622
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 0.8698554039001465
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.8279650211334229
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.799 Vali Acc: 0.804 Test Loss: 0.799 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9615142345428467
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
Validation loss decreased (-0.818835 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 0.853156566619873
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.689 Vali Acc: 0.826 Test Loss: 0.689 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0820820331573486
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.877 Test Loss: 0.547 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876806).  Saving model ...
Epoch: 20 cost time: 1.0067219734191895
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9352848529815674
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.855 Test Loss: 0.618 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0854637622833252
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.862 Test Loss: 0.582 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1492393016815186
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.855 Test Loss: 0.575 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.203803539276123
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.855 Test Loss: 0.556 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0000133514404297
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1847569942474365
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 27 cost time: 1.0697288513183594
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 28 cost time: 1.0177197456359863
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9943931102752686
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.877 Test Loss: 0.540 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.288313865661621
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.877 Test Loss: 0.540 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9536581039428711
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.877 Test Loss: 0.542 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1022377014160156
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2499287128448486
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.877 Test Loss: 0.533 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 34 cost time: 1.291524887084961
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.877 Test Loss: 0.534 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1647167205810547
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.156287670135498
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.884 Test Loss: 0.533 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 37 cost time: 1.0456435680389404
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9695513248443604
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.877 Test Loss: 0.540 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1182737350463867
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.877 Test Loss: 0.541 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1287639141082764
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.877 Test Loss: 0.544 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1371607780456543
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.884 Test Loss: 0.543 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.055302619934082
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 43 cost time: 1.0726642608642578
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.884 Test Loss: 0.550 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0181221961975098
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.884 Test Loss: 0.551 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1876366138458252
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.891 Test Loss: 0.543 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 46 cost time: 1.0180935859680176
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.891 Test Loss: 0.543 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9330704212188721
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.891 Test Loss: 0.548 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2134883403778076
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.891 Test Loss: 0.550 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1399364471435547
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.891 Test Loss: 0.547 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.32106351852417
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.891 Test Loss: 0.547 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0762908458709717
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.891 Test Loss: 0.542 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 52 cost time: 1.0632469654083252
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.891 Test Loss: 0.543 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8906857967376709
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1452414989471436
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1524598598480225
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2365660667419434
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.970088005065918
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0056424140930176
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.891 Test Loss: 0.548 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.2257301807403564
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.891 Test Loss: 0.546 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9207918643951416
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.891 Test Loss: 0.542 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.0662803649902344
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.891 Test Loss: 0.541 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 62 cost time: 0.94468092918396
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.891 Test Loss: 0.542 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0956194400787354
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.899 Test Loss: 0.537 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898545).  Saving model ...
Epoch: 64 cost time: 0.9939775466918945
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.891 Test Loss: 0.542 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.331840991973877
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.891 Test Loss: 0.546 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.1975910663604736
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.891 Test Loss: 0.550 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.2559802532196045
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.891 Test Loss: 0.547 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.6102125644683838
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.891 Test Loss: 0.545 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.3520541191101074
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.906 Test Loss: 0.541 Test Acc: 0.906
Validation loss decreased (-0.898545 --> -0.905792).  Saving model ...
Epoch: 70 cost time: 0.9876930713653564
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.899 Test Loss: 0.545 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.10884428024292
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.891 Test Loss: 0.548 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0940072536468506
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.891 Test Loss: 0.550 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.1732821464538574
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.891 Test Loss: 0.550 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.9614846706390381
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.899 Test Loss: 0.548 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.1046948432922363
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.899 Test Loss: 0.544 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.060171365737915
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.899 Test Loss: 0.542 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.2255878448486328
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.899 Test Loss: 0.543 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.0129191875457764
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.899 Test Loss: 0.545 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.9244344234466553
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.899 Test Loss: 0.547 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 3659036
model size : 18.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5252444744110107
Epoch: 1, Steps: 9 | Train Loss: 1.502 Vali Loss: 1.354 Vali Acc: 0.348 Test Loss: 1.354 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 0.8543212413787842
Epoch: 2, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.175 Vali Acc: 0.587 Test Loss: 1.175 Test Acc: 0.587
Validation loss decreased (-0.347813 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 0.9214928150177002
Epoch: 3, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.109 Vali Acc: 0.399 Test Loss: 1.109 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0400464534759521
Epoch: 4, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.986 Vali Acc: 0.551 Test Loss: 0.986 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0842006206512451
Epoch: 5, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.943 Vali Acc: 0.652 Test Loss: 0.943 Test Acc: 0.652
Validation loss decreased (-0.586945 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 1.115286111831665
Epoch: 6, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.864 Vali Acc: 0.623 Test Loss: 0.864 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0195050239562988
Epoch: 7, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.750 Vali Acc: 0.688 Test Loss: 0.750 Test Acc: 0.688
Validation loss decreased (-0.652164 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.1290321350097656
Epoch: 8, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.998 Vali Acc: 0.659 Test Loss: 0.998 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1684343814849854
Epoch: 9, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.704 Vali Acc: 0.674 Test Loss: 0.704 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0425388813018799
Epoch: 10, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.643 Vali Acc: 0.725 Test Loss: 0.643 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 1.0554568767547607
Epoch: 11, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.635 Vali Acc: 0.739 Test Loss: 0.635 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 12 cost time: 1.1245551109313965
Epoch: 12, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782602).  Saving model ...
Epoch: 13 cost time: 0.9213862419128418
Epoch: 13, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.612 Vali Acc: 0.768 Test Loss: 0.612 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0472419261932373
Epoch: 14, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.0922036170959473
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 1.0759999752044678
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.804 Test Loss: 0.585 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.042456865310669
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1945958137512207
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 19 cost time: 1.0119473934173584
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 0.9000720977783203
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9327569007873535
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0472991466522217
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.862 Test Loss: 0.498 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 23 cost time: 0.9822461605072021
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 24 cost time: 1.0595881938934326
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 0.8526692390441895
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 26 cost time: 0.9845688343048096
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0484223365783691
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9876768589019775
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0446360111236572
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0199601650238037
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.065990686416626
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0403807163238525
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2445261478424072
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 34 cost time: 0.9810290336608887
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 35 cost time: 0.983116865158081
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0159220695495605
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.862 Test Loss: 0.512 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0230648517608643
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 38 cost time: 1.1021506786346436
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.877 Test Loss: 0.484 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 39 cost time: 0.9340081214904785
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1161723136901855
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.877 Test Loss: 0.494 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2447161674499512
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.019711971282959
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.870 Test Loss: 0.486 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0560376644134521
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2302303314208984
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8581733703613281
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.877 Test Loss: 0.493 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0850811004638672
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.877 Test Loss: 0.497 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0545358657836914
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.877 Test Loss: 0.493 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1626396179199219
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 3654428
model size : 18.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8112902641296387
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.285 Vali Acc: 0.420 Test Loss: 1.285 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.1331171989440918
Epoch: 2, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.127 Vali Acc: 0.558 Test Loss: 1.127 Test Acc: 0.558
Validation loss decreased (-0.420277 --> -0.557960).  Saving model ...
Epoch: 3 cost time: 1.0601396560668945
Epoch: 3, Steps: 9 | Train Loss: 0.990 Vali Loss: 1.073 Vali Acc: 0.449 Test Loss: 1.073 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3046386241912842
Epoch: 4, Steps: 9 | Train Loss: 0.813 Vali Loss: 0.955 Vali Acc: 0.645 Test Loss: 0.955 Test Acc: 0.645
Validation loss decreased (-0.557960 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 1.4008259773254395
Epoch: 5, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.986 Vali Acc: 0.616 Test Loss: 0.986 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3172597885131836
Epoch: 6, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.725 Vali Acc: 0.696 Test Loss: 0.725 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.3979377746582031
Epoch: 7, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.765 Vali Acc: 0.674 Test Loss: 0.765 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.095438003540039
Epoch: 8, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.697 Vali Acc: 0.710 Test Loss: 0.697 Test Acc: 0.710
Validation loss decreased (-0.695645 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 1.2814829349517822
Epoch: 9, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.788 Vali Acc: 0.652 Test Loss: 0.788 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.026829481124878
Epoch: 10, Steps: 9 | Train Loss: 0.210 Vali Loss: 1.185 Vali Acc: 0.652 Test Loss: 1.185 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1955664157867432
Epoch: 11, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
Validation loss decreased (-0.710138 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 0.8847990036010742
Epoch: 12, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.586 Vali Acc: 0.797 Test Loss: 0.586 Test Acc: 0.797
Validation loss decreased (-0.746370 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 0.9526164531707764
Epoch: 13, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.912623405456543
Epoch: 14, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.722 Vali Acc: 0.768 Test Loss: 0.722 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2038919925689697
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.536 Vali Acc: 0.804 Test Loss: 0.536 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 1.1306219100952148
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.697 Vali Acc: 0.804 Test Loss: 0.697 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2366127967834473
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.654 Vali Acc: 0.790 Test Loss: 0.654 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9621989727020264
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 0.9474966526031494
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0332579612731934
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0772478580474854
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.826 Test Loss: 0.652 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0065021514892578
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.826 Test Loss: 0.612 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.233201265335083
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.833 Test Loss: 0.670 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2193329334259033
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.833 Test Loss: 0.670 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3179283142089844
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.826 Test Loss: 0.644 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.187936544418335
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0138704776763916
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0700559616088867
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.826 Test Loss: 0.635 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 3649820
model size : 18.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6563925743103027
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.393 Vali Acc: 0.355 Test Loss: 1.393 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.0444285869598389
Epoch: 2, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.200 Vali Acc: 0.435 Test Loss: 1.200 Test Acc: 0.435
Validation loss decreased (-0.355059 --> -0.434771).  Saving model ...
Epoch: 3 cost time: 0.9995861053466797
Epoch: 3, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.086 Vali Acc: 0.558 Test Loss: 1.086 Test Acc: 0.558
Validation loss decreased (-0.434771 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 0.9692685604095459
Epoch: 4, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.955 Vali Acc: 0.507 Test Loss: 0.955 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9521839618682861
Epoch: 5, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.866 Vali Acc: 0.609 Test Loss: 0.866 Test Acc: 0.609
Validation loss decreased (-0.557960 --> -0.608687).  Saving model ...
Epoch: 6 cost time: 1.2835838794708252
Epoch: 6, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.935 Vali Acc: 0.623 Test Loss: 0.935 Test Acc: 0.623
Validation loss decreased (-0.608687 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 1.109875202178955
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.934 Vali Acc: 0.580 Test Loss: 0.934 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1790404319763184
Epoch: 8, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.706 Vali Acc: 0.703 Test Loss: 0.706 Test Acc: 0.703
Validation loss decreased (-0.623179 --> -0.702891).  Saving model ...
Epoch: 9 cost time: 1.3133323192596436
Epoch: 9, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.0829088687896729
Epoch: 10, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.654 Vali Acc: 0.710 Test Loss: 0.654 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9938855171203613
Epoch: 11, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.753 Vali Acc: 0.703 Test Loss: 0.753 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.095797061920166
Epoch: 12, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.601 Vali Acc: 0.761 Test Loss: 0.601 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760864).  Saving model ...
Epoch: 13 cost time: 1.0340657234191895
Epoch: 13, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1638293266296387
Epoch: 14, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.580 Vali Acc: 0.790 Test Loss: 0.580 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 1.0189521312713623
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.768 Test Loss: 0.665 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2318737506866455
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 1.0273067951202393
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1982271671295166
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 19 cost time: 1.052839756011963
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.826 Test Loss: 0.707 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826080).  Saving model ...
Epoch: 20 cost time: 1.1267364025115967
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.727 Vali Acc: 0.819 Test Loss: 0.727 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.091015338897705
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.694 Vali Acc: 0.812 Test Loss: 0.694 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0696077346801758
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.826 Test Loss: 0.649 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 23 cost time: 1.080986738204956
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.833 Test Loss: 0.688 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 1.0388917922973633
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0280025005340576
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.848 Test Loss: 0.670 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.847819).  Saving model ...
Epoch: 26 cost time: 1.2229580879211426
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.848 Test Loss: 0.689 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9942691326141357
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.841 Test Loss: 0.701 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.217775583267212
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.841 Test Loss: 0.678 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.967949390411377
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.841 Test Loss: 0.681 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.36509370803833
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.841 Test Loss: 0.688 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1683590412139893
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0347888469696045
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.841 Test Loss: 0.687 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9940321445465088
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.841 Test Loss: 0.694 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9298763275146484
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.841 Test Loss: 0.697 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1624608039855957
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.841 Test Loss: 0.696 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 3645212
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0713672637939453
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.391 Vali Acc: 0.399 Test Loss: 1.391 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 1.0296711921691895
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.296 Vali Acc: 0.319 Test Loss: 1.296 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2998661994934082
Epoch: 3, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.127 Vali Acc: 0.406 Test Loss: 1.127 Test Acc: 0.406
Validation loss decreased (-0.398537 --> -0.405786).  Saving model ...
Epoch: 4 cost time: 1.2265310287475586
Epoch: 4, Steps: 9 | Train Loss: 0.910 Vali Loss: 0.982 Vali Acc: 0.507 Test Loss: 0.982 Test Acc: 0.507
Validation loss decreased (-0.405786 --> -0.507237).  Saving model ...
Epoch: 5 cost time: 1.3572235107421875
Epoch: 5, Steps: 9 | Train Loss: 0.815 Vali Loss: 1.185 Vali Acc: 0.536 Test Loss: 1.185 Test Acc: 0.536
Validation loss decreased (-0.507237 --> -0.536220).  Saving model ...
Epoch: 6 cost time: 1.2040259838104248
Epoch: 6, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.835 Vali Acc: 0.616 Test Loss: 0.835 Test Acc: 0.616
Validation loss decreased (-0.536220 --> -0.615934).  Saving model ...
Epoch: 7 cost time: 1.1789770126342773
Epoch: 7, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.789 Vali Acc: 0.587 Test Loss: 0.789 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.235156774520874
Epoch: 8, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.724 Vali Acc: 0.674 Test Loss: 0.724 Test Acc: 0.674
Validation loss decreased (-0.615934 --> -0.673906).  Saving model ...
Epoch: 9 cost time: 1.0577178001403809
Epoch: 9, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.817 Vali Acc: 0.659 Test Loss: 0.817 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.129807949066162
Epoch: 10, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.754 Vali Acc: 0.732 Test Loss: 0.754 Test Acc: 0.732
Validation loss decreased (-0.673906 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 0.9705243110656738
Epoch: 11, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.664 Vali Acc: 0.746 Test Loss: 0.664 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 1.3897390365600586
Epoch: 12, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.058342695236206
Epoch: 13, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.567 Vali Acc: 0.761 Test Loss: 0.567 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760864).  Saving model ...
Epoch: 14 cost time: 1.281869649887085
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.656 Vali Acc: 0.761 Test Loss: 0.656 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.136033535003662
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.613 Vali Acc: 0.812 Test Loss: 0.613 Test Acc: 0.812
Validation loss decreased (-0.760864 --> -0.811588).  Saving model ...
Epoch: 16 cost time: 1.17755126953125
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.797 Test Loss: 0.687 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1833264827728271
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4033575057983398
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.804 Test Loss: 0.662 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4531142711639404
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 20 cost time: 1.021958589553833
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.826 Test Loss: 0.589 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1360878944396973
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.812 Test Loss: 0.712 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1771554946899414
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 1.2765753269195557
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2828471660614014
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 25 cost time: 1.2804796695709229
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.826 Test Loss: 0.618 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2469279766082764
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.826 Test Loss: 0.616 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4339852333068848
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1601948738098145
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1366419792175293
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 30 cost time: 1.126817226409912
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1479289531707764
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 32 cost time: 1.237945318222046
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 33 cost time: 1.3515253067016602
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1477341651916504
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3836555480957031
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1430606842041016
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1143193244934082
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.031571388244629
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2279698848724365
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2099997997283936
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2007200717926025
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2700982093811035
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 3462044
model size : 18.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9207277297973633
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.1151096820831299
Epoch: 2, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.182 Vali Acc: 0.377 Test Loss: 1.182 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376800).  Saving model ...
Epoch: 3 cost time: 0.979168176651001
Epoch: 3, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.122 Vali Acc: 0.594 Test Loss: 1.122 Test Acc: 0.594
Validation loss decreased (-0.376800 --> -0.594192).  Saving model ...
Epoch: 4 cost time: 0.971125602722168
Epoch: 4, Steps: 9 | Train Loss: 0.897 Vali Loss: 1.077 Vali Acc: 0.449 Test Loss: 1.077 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0634849071502686
Epoch: 5, Steps: 9 | Train Loss: 0.808 Vali Loss: 1.022 Vali Acc: 0.471 Test Loss: 1.022 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.138371467590332
Epoch: 6, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.867 Vali Acc: 0.659 Test Loss: 0.867 Test Acc: 0.659
Validation loss decreased (-0.594192 --> -0.659412).  Saving model ...
Epoch: 7 cost time: 1.222033977508545
Epoch: 7, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.3028090000152588
Epoch: 8, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.735 Vali Acc: 0.652 Test Loss: 0.735 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0918538570404053
Epoch: 9, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.758 Vali Acc: 0.696 Test Loss: 0.758 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9479763507843018
Epoch: 10, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.686 Vali Acc: 0.703 Test Loss: 0.686 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9945316314697266
Epoch: 11, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.559 Vali Acc: 0.754 Test Loss: 0.559 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753618).  Saving model ...
Epoch: 12 cost time: 1.0845487117767334
Epoch: 12, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
Validation loss decreased (-0.753618 --> -0.782602).  Saving model ...
Epoch: 13 cost time: 1.319610834121704
Epoch: 13, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2250080108642578
Epoch: 14, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.577 Vali Acc: 0.804 Test Loss: 0.577 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 0.9892761707305908
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 0.9597911834716797
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 0.9463746547698975
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0567667484283447
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2013750076293945
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1255340576171875
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.1485462188720703
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0365073680877686
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1364762783050537
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869560).  Saving model ...
Epoch: 24 cost time: 1.3525164127349854
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 25 cost time: 1.0528051853179932
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0556132793426514
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2563490867614746
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.0708673000335693
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.007075548171997
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 30 cost time: 1.3770732879638672
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1649675369262695
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 32 cost time: 1.0019516944885254
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1261391639709473
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 34 cost time: 1.1905996799468994
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2162339687347412
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.168255090713501
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.877 Test Loss: 0.486 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0296502113342285
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2615153789520264
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.877 Test Loss: 0.461 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 39 cost time: 1.0774755477905273
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0236997604370117
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 41 cost time: 1.064049243927002
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1390388011932373
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1780931949615479
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3028795719146729
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.050074815750122
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0743966102600098
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.224076509475708
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2032253742218018
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.877 Test Loss: 0.469 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.142094373703003
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1164517402648926
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 3457436
model size : 18.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4812116622924805
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.357 Vali Acc: 0.442 Test Loss: 1.357 Test Acc: 0.442
Validation loss decreased (inf --> -0.442015).  Saving model ...
Epoch: 2 cost time: 0.9396359920501709
Epoch: 2, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.242 Vali Acc: 0.319 Test Loss: 1.242 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9113020896911621
Epoch: 3, Steps: 9 | Train Loss: 1.023 Vali Loss: 1.118 Vali Acc: 0.536 Test Loss: 1.118 Test Acc: 0.536
Validation loss decreased (-0.442015 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 0.8062925338745117
Epoch: 4, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.051 Vali Acc: 0.486 Test Loss: 1.051 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9288172721862793
Epoch: 5, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.945 Vali Acc: 0.572 Test Loss: 0.945 Test Acc: 0.572
Validation loss decreased (-0.536221 --> -0.572454).  Saving model ...
Epoch: 6 cost time: 0.8837385177612305
Epoch: 6, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.956 Vali Acc: 0.616 Test Loss: 0.956 Test Acc: 0.616
Validation loss decreased (-0.572454 --> -0.615932).  Saving model ...
Epoch: 7 cost time: 0.9689598083496094
Epoch: 7, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.821 Vali Acc: 0.638 Test Loss: 0.821 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637673).  Saving model ...
Epoch: 8 cost time: 0.8690505027770996
Epoch: 8, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.746 Vali Acc: 0.674 Test Loss: 0.746 Test Acc: 0.674
Validation loss decreased (-0.637673 --> -0.673906).  Saving model ...
Epoch: 9 cost time: 1.0942020416259766
Epoch: 9, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.797 Vali Acc: 0.696 Test Loss: 0.797 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695644).  Saving model ...
Epoch: 10 cost time: 0.8937845230102539
Epoch: 10, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
Validation loss decreased (-0.695644 --> -0.717385).  Saving model ...
Epoch: 11 cost time: 0.8480989933013916
Epoch: 11, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.820 Vali Acc: 0.746 Test Loss: 0.820 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746369).  Saving model ...
Epoch: 12 cost time: 0.8539254665374756
Epoch: 12, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.707 Vali Acc: 0.739 Test Loss: 0.707 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8317618370056152
Epoch: 13, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.680 Vali Acc: 0.790 Test Loss: 0.680 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789848).  Saving model ...
Epoch: 14 cost time: 0.8951904773712158
Epoch: 14, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.537 Vali Acc: 0.790 Test Loss: 0.537 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789850).  Saving model ...
Epoch: 15 cost time: 0.9080262184143066
Epoch: 15, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.088735818862915
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.645 Vali Acc: 0.804 Test Loss: 0.645 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804341).  Saving model ...
Epoch: 17 cost time: 1.0249741077423096
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 1.0198137760162354
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 1.0365965366363525
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.151639699935913
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 1.0613651275634766
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 22 cost time: 1.245286226272583
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2411131858825684
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.862 Test Loss: 0.535 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 24 cost time: 0.8902251720428467
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.855 Test Loss: 0.546 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1067228317260742
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0336549282073975
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0205159187316895
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.862 Test Loss: 0.568 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0263242721557617
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.862 Test Loss: 0.547 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9486711025238037
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.004462718963623
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.862 Test Loss: 0.555 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8793587684631348
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.862 Test Loss: 0.552 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1945397853851318
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1139702796936035
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 3452828
model size : 18.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5629308223724365
Epoch: 1, Steps: 9 | Train Loss: 1.524 Vali Loss: 1.462 Vali Acc: 0.290 Test Loss: 1.462 Test Acc: 0.290
Validation loss decreased (inf --> -0.289840).  Saving model ...
Epoch: 2 cost time: 0.9176404476165771
Epoch: 2, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.213 Vali Acc: 0.543 Test Loss: 1.213 Test Acc: 0.543
Validation loss decreased (-0.289840 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 1.0614027976989746
Epoch: 3, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.066 Vali Acc: 0.464 Test Loss: 1.066 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9225316047668457
Epoch: 4, Steps: 9 | Train Loss: 0.888 Vali Loss: 1.001 Vali Acc: 0.616 Test Loss: 1.001 Test Acc: 0.616
Validation loss decreased (-0.543466 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.0180995464324951
Epoch: 5, Steps: 9 | Train Loss: 0.817 Vali Loss: 1.015 Vali Acc: 0.514 Test Loss: 1.015 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8288116455078125
Epoch: 6, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.891 Vali Acc: 0.638 Test Loss: 0.891 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 0.9893538951873779
Epoch: 7, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.882 Vali Acc: 0.630 Test Loss: 0.882 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9936747550964355
Epoch: 8, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.903 Vali Acc: 0.558 Test Loss: 0.903 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0029163360595703
Epoch: 9, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.788 Vali Acc: 0.609 Test Loss: 0.788 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.170917272567749
Epoch: 10, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
Validation loss decreased (-0.637672 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 0.9693036079406738
Epoch: 11, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 0.9491286277770996
Epoch: 12, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9179272651672363
Epoch: 13, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746371).  Saving model ...
Epoch: 14 cost time: 0.8727593421936035
Epoch: 14, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775356).  Saving model ...
Epoch: 15 cost time: 1.316823959350586
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.635 Vali Acc: 0.797 Test Loss: 0.635 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797095).  Saving model ...
Epoch: 16 cost time: 1.0033378601074219
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2991256713867188
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.612 Vali Acc: 0.768 Test Loss: 0.612 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0597777366638184
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 1.0430614948272705
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.563 Vali Acc: 0.848 Test Loss: 0.563 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847820).  Saving model ...
Epoch: 20 cost time: 0.9816546440124512
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.848 Test Loss: 0.612 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8812448978424072
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 22 cost time: 0.9691081047058105
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.855 Test Loss: 0.565 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 23 cost time: 0.8779194355010986
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.862 Test Loss: 0.550 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 24 cost time: 1.0514836311340332
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0718333721160889
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.848 Test Loss: 0.590 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.989220380783081
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9722425937652588
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.927100658416748
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.862 Test Loss: 0.589 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9633779525756836
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.855 Test Loss: 0.610 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9121880531311035
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9815108776092529
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9423985481262207
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.855 Test Loss: 0.598 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8935129642486572
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.855 Test Loss: 0.604 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 3448220
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1824517250061035
Epoch: 1, Steps: 9 | Train Loss: 1.630 Vali Loss: 1.479 Vali Acc: 0.188 Test Loss: 1.479 Test Acc: 0.188
Validation loss decreased (inf --> -0.188391).  Saving model ...
Epoch: 2 cost time: 1.0614070892333984
Epoch: 2, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.342 Vali Acc: 0.348 Test Loss: 1.342 Test Acc: 0.348
Validation loss decreased (-0.188391 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.0593972206115723
Epoch: 3, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.347813 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 1.0758721828460693
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.097 Vali Acc: 0.493 Test Loss: 1.097 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492743).  Saving model ...
Epoch: 5 cost time: 0.8911030292510986
Epoch: 5, Steps: 9 | Train Loss: 0.895 Vali Loss: 1.007 Vali Acc: 0.543 Test Loss: 1.007 Test Acc: 0.543
Validation loss decreased (-0.492743 --> -0.543468).  Saving model ...
Epoch: 6 cost time: 0.8998591899871826
Epoch: 6, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.895 Vali Acc: 0.609 Test Loss: 0.895 Test Acc: 0.609
Validation loss decreased (-0.543468 --> -0.608687).  Saving model ...
Epoch: 7 cost time: 0.9567797183990479
Epoch: 7, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.816 Vali Acc: 0.652 Test Loss: 0.816 Test Acc: 0.652
Validation loss decreased (-0.608687 --> -0.652166).  Saving model ...
Epoch: 8 cost time: 1.1312835216522217
Epoch: 8, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.839 Vali Acc: 0.667 Test Loss: 0.839 Test Acc: 0.667
Validation loss decreased (-0.652166 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 1.0930228233337402
Epoch: 9, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.684 Vali Acc: 0.696 Test Loss: 0.684 Test Acc: 0.696
Validation loss decreased (-0.666658 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 1.3661503791809082
Epoch: 10, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.655 Vali Acc: 0.696 Test Loss: 0.655 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695646).  Saving model ...
Epoch: 11 cost time: 1.1128275394439697
Epoch: 11, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.746 Vali Acc: 0.703 Test Loss: 0.746 Test Acc: 0.703
Validation loss decreased (-0.695646 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 1.050374984741211
Epoch: 12, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.750 Vali Acc: 0.710 Test Loss: 0.750 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710137).  Saving model ...
Epoch: 13 cost time: 1.0316872596740723
Epoch: 13, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.631 Vali Acc: 0.754 Test Loss: 0.631 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.1901743412017822
Epoch: 14, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.589 Vali Acc: 0.754 Test Loss: 0.589 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 1.0470237731933594
Epoch: 15, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.607 Vali Acc: 0.754 Test Loss: 0.607 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1520118713378906
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.034041166305542
Epoch: 17, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.518 Vali Acc: 0.797 Test Loss: 0.518 Test Acc: 0.797
Validation loss decreased (-0.753617 --> -0.797096).  Saving model ...
Epoch: 18 cost time: 0.9499862194061279
Epoch: 18, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9188261032104492
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.658 Vali Acc: 0.739 Test Loss: 0.658 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9882779121398926
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.588 Vali Acc: 0.804 Test Loss: 0.588 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 21 cost time: 0.9266798496246338
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 1.064206600189209
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 23 cost time: 1.1211607456207275
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0263497829437256
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1929728984832764
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.571 Vali Acc: 0.804 Test Loss: 0.571 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0311317443847656
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9298923015594482
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3468613624572754
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9289393424987793
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1561977863311768
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 31 cost time: 0.9567916393280029
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8581225872039795
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 0.9424676895141602
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0596013069152832
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 35 cost time: 0.9227118492126465
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.969071626663208
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8958892822265625
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9968156814575195
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1627874374389648
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 40 cost time: 1.0349290370941162
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0340240001678467
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0576756000518799
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 43 cost time: 0.9034311771392822
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9979569911956787
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.992546796798706
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9239182472229004
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2302780151367188
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9873006343841553
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0593757629394531
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 50 cost time: 0.948246955871582
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.105729103088379
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3529250621795654
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0377261638641357
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.238368034362793
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1736667156219482
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.035120964050293
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.06351900100708
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.1469230651855469
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.0482470989227295
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 1635612
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1015422344207764
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.363 Vali Acc: 0.413 Test Loss: 1.363 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 1.0144858360290527
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.239 Vali Acc: 0.551 Test Loss: 1.239 Test Acc: 0.551
Validation loss decreased (-0.413030 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 1.0665223598480225
Epoch: 3, Steps: 9 | Train Loss: 1.182 Vali Loss: 1.131 Vali Acc: 0.442 Test Loss: 1.131 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0277035236358643
Epoch: 4, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.037 Vali Acc: 0.601 Test Loss: 1.037 Test Acc: 0.601
Validation loss decreased (-0.550712 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.0954852104187012
Epoch: 5, Steps: 9 | Train Loss: 0.864 Vali Loss: 0.942 Vali Acc: 0.609 Test Loss: 0.942 Test Acc: 0.609
Validation loss decreased (-0.601439 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 1.040827989578247
Epoch: 6, Steps: 9 | Train Loss: 0.693 Vali Loss: 0.865 Vali Acc: 0.645 Test Loss: 0.865 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.0270192623138428
Epoch: 7, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.852 Vali Acc: 0.638 Test Loss: 0.852 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9493429660797119
Epoch: 8, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.752 Vali Acc: 0.696 Test Loss: 0.752 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.0464797019958496
Epoch: 9, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 0.8344910144805908
Epoch: 10, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.693 Vali Acc: 0.732 Test Loss: 0.693 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 0.9797160625457764
Epoch: 11, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 12 cost time: 1.1569015979766846
Epoch: 12, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 1.1770703792572021
Epoch: 13, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.804 Vali Acc: 0.732 Test Loss: 0.804 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1659197807312012
Epoch: 14, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.614 Vali Acc: 0.746 Test Loss: 0.614 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.094099521636963
Epoch: 15, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.745 Vali Acc: 0.754 Test Loss: 0.745 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0019676685333252
Epoch: 16, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 17 cost time: 0.9225594997406006
Epoch: 17, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.764 Vali Acc: 0.710 Test Loss: 0.764 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8656904697418213
Epoch: 18, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.690 Vali Acc: 0.804 Test Loss: 0.690 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804341).  Saving model ...
Epoch: 19 cost time: 1.1215217113494873
Epoch: 19, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0472142696380615
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.663 Vali Acc: 0.790 Test Loss: 0.663 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0743398666381836
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 22 cost time: 1.1099441051483154
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.03887939453125
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 24 cost time: 1.06040620803833
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 1.048436164855957
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4735350608825684
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0165095329284668
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2193632125854492
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9689574241638184
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 1.255296230316162
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2025575637817383
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9838578701019287
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0708231925964355
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0670416355133057
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847820).  Saving model ...
Epoch: 35 cost time: 1.0788698196411133
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0466430187225342
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1192104816436768
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.848 Test Loss: 0.601 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1191039085388184
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1119682788848877
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.910977840423584
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9466631412506104
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 42 cost time: 1.2107980251312256
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1076016426086426
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1432065963745117
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2671422958374023
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2996039390563965
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0247275829315186
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.11647367477417
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.209705114364624
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.053755760192871
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0867948532104492
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 1633308
model size : 8.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6822750568389893
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.340 Vali Acc: 0.377 Test Loss: 1.340 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 1.0508711338043213
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.210 Vali Acc: 0.478 Test Loss: 1.210 Test Acc: 0.478
Validation loss decreased (-0.376798 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 0.8871514797210693
Epoch: 3, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.102 Vali Acc: 0.609 Test Loss: 1.102 Test Acc: 0.609
Validation loss decreased (-0.478249 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 0.9647536277770996
Epoch: 4, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.012 Vali Acc: 0.529 Test Loss: 1.012 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.914513111114502
Epoch: 5, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.958 Vali Acc: 0.616 Test Loss: 0.958 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 0.9662952423095703
Epoch: 6, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.882 Vali Acc: 0.609 Test Loss: 0.882 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9500133991241455
Epoch: 7, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.615932 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.0317752361297607
Epoch: 8, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.839 Vali Acc: 0.645 Test Loss: 0.839 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0879247188568115
Epoch: 9, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.1114246845245361
Epoch: 10, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.903 Vali Acc: 0.667 Test Loss: 0.903 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0856235027313232
Epoch: 11, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.649 Vali Acc: 0.681 Test Loss: 0.649 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.890977144241333
Epoch: 12, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9126794338226318
Epoch: 13, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
Validation loss decreased (-0.717384 --> -0.775356).  Saving model ...
Epoch: 14 cost time: 1.0051119327545166
Epoch: 14, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9117915630340576
Epoch: 15, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.9604432582855225
Epoch: 16, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1417887210845947
Epoch: 17, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.649 Vali Acc: 0.790 Test Loss: 0.649 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9719386100769043
Epoch: 18, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0661695003509521
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 20 cost time: 1.1261279582977295
Epoch: 20, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8597471714019775
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 22 cost time: 1.0076076984405518
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8701670169830322
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 24 cost time: 1.1242072582244873
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 25 cost time: 1.1563823223114014
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.0810811519622803
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0245001316070557
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 28 cost time: 1.0740573406219482
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1008059978485107
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9957242012023926
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 31 cost time: 1.050257921218872
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 32 cost time: 0.9164273738861084
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 33 cost time: 0.974456787109375
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0977497100830078
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0557215213775635
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9804263114929199
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.862 Test Loss: 0.510 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 37 cost time: 0.8808751106262207
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8838164806365967
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0235395431518555
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2383596897125244
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.058061122894287
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9041483402252197
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1013574600219727
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.862 Test Loss: 0.524 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1364595890045166
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.971653938293457
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9494342803955078
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1631004
model size : 8.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1944236755371094
Epoch: 1, Steps: 9 | Train Loss: 1.526 Vali Loss: 1.352 Vali Acc: 0.312 Test Loss: 1.352 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.8323943614959717
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.217 Vali Acc: 0.457 Test Loss: 1.217 Test Acc: 0.457
Validation loss decreased (-0.311581 --> -0.456510).  Saving model ...
Epoch: 3 cost time: 0.9120745658874512
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
Validation loss decreased (-0.456510 --> -0.485496).  Saving model ...
Epoch: 4 cost time: 1.0555419921875
Epoch: 4, Steps: 9 | Train Loss: 0.981 Vali Loss: 1.026 Vali Acc: 0.572 Test Loss: 1.026 Test Acc: 0.572
Validation loss decreased (-0.485496 --> -0.572454).  Saving model ...
Epoch: 5 cost time: 0.9267668724060059
Epoch: 5, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.959 Vali Acc: 0.500 Test Loss: 0.959 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9297754764556885
Epoch: 6, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.854 Vali Acc: 0.681 Test Loss: 0.854 Test Acc: 0.681
Validation loss decreased (-0.572454 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.0799715518951416
Epoch: 7, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.785 Vali Acc: 0.630 Test Loss: 0.785 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0345783233642578
Epoch: 8, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.737 Vali Acc: 0.732 Test Loss: 0.737 Test Acc: 0.732
Validation loss decreased (-0.681151 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 0.849862813949585
Epoch: 9, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.656 Vali Acc: 0.725 Test Loss: 0.656 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0773932933807373
Epoch: 10, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.708 Vali Acc: 0.703 Test Loss: 0.708 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.385680913925171
Epoch: 11, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.718 Vali Acc: 0.659 Test Loss: 0.718 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1647529602050781
Epoch: 12, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0597081184387207
Epoch: 13, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.635 Vali Acc: 0.725 Test Loss: 0.635 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0227973461151123
Epoch: 14, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.697 Vali Acc: 0.710 Test Loss: 0.697 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8931262493133545
Epoch: 15, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.643 Vali Acc: 0.761 Test Loss: 0.643 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 16 cost time: 1.0107815265655518
Epoch: 16, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.607 Vali Acc: 0.739 Test Loss: 0.607 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0102741718292236
Epoch: 17, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.820 Vali Acc: 0.761 Test Loss: 0.820 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9101030826568604
Epoch: 18, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0666625499725342
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0071237087249756
Epoch: 20, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
Validation loss decreased (-0.760863 --> -0.811588).  Saving model ...
Epoch: 21 cost time: 1.0276966094970703
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.797 Test Loss: 0.605 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0403718948364258
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.680 Vali Acc: 0.797 Test Loss: 0.680 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.125000238418579
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.609 Vali Acc: 0.797 Test Loss: 0.609 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.106884241104126
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.590 Vali Acc: 0.804 Test Loss: 0.590 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0432448387145996
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9550127983093262
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 27 cost time: 1.0551350116729736
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9462690353393555
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.812 Test Loss: 0.607 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.13482666015625
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.21038818359375
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826081).  Saving model ...
Epoch: 31 cost time: 0.8605213165283203
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9765512943267822
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 1.0499205589294434
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.826 Test Loss: 0.589 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.013890027999878
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.826 Test Loss: 0.587 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8752608299255371
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.826 Test Loss: 0.594 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9293422698974609
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0454516410827637
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9881875514984131
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0680878162384033
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0227634906768799
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9485490322113037
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8801069259643555
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 43 cost time: 0.9193911552429199
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.848 Test Loss: 0.587 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 44 cost time: 1.05958890914917
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.939455509185791
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9125275611877441
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.848 Test Loss: 0.588 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1770644187927246
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9465367794036865
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.848 Test Loss: 0.589 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.106450080871582
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 50 cost time: 0.9245398044586182
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0453739166259766
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.855 Test Loss: 0.580 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 52 cost time: 0.956718921661377
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9875285625457764
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8744316101074219
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9584290981292725
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.855 Test Loss: 0.586 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9643990993499756
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.848 Test Loss: 0.584 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9874184131622314
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8249208927154541
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8837404251098633
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.862 Test Loss: 0.600 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 60 cost time: 1.0349247455596924
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.862 Test Loss: 0.602 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8338391780853271
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.862 Test Loss: 0.604 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0805160999298096
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 63 cost time: 0.8297290802001953
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 64 cost time: 0.8624215126037598
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.862 Test Loss: 0.570 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 65 cost time: 0.7897157669067383
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9930994510650635
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1146039962768555
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8341188430786133
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.9554576873779297
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.9813227653503418
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.0430819988250732
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.0497264862060547
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.9176480770111084
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.862 Test Loss: 0.575 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.9434609413146973
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1628700
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0702590942382812
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.346 Vali Acc: 0.290 Test Loss: 1.346 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 1.117293357849121
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.232 Vali Acc: 0.529 Test Loss: 1.232 Test Acc: 0.529
Validation loss decreased (-0.289842 --> -0.528973).  Saving model ...
Epoch: 3 cost time: 1.133821725845337
Epoch: 3, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.123 Vali Acc: 0.493 Test Loss: 1.123 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8969728946685791
Epoch: 4, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.022 Vali Acc: 0.609 Test Loss: 1.022 Test Acc: 0.609
Validation loss decreased (-0.528973 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 0.9723939895629883
Epoch: 5, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.939 Vali Acc: 0.623 Test Loss: 0.939 Test Acc: 0.623
Validation loss decreased (-0.608685 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 1.0313498973846436
Epoch: 6, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.876 Vali Acc: 0.652 Test Loss: 0.876 Test Acc: 0.652
Validation loss decreased (-0.623179 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 0.9559845924377441
Epoch: 7, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.858 Vali Acc: 0.645 Test Loss: 0.858 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9584457874298096
Epoch: 8, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.768 Vali Acc: 0.696 Test Loss: 0.768 Test Acc: 0.696
Validation loss decreased (-0.652165 --> -0.695644).  Saving model ...
Epoch: 9 cost time: 0.8967318534851074
Epoch: 9, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
Validation loss decreased (-0.695644 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 0.9271798133850098
Epoch: 10, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.682 Vali Acc: 0.725 Test Loss: 0.682 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 1.0876941680908203
Epoch: 11, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.649 Vali Acc: 0.732 Test Loss: 0.649 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 12 cost time: 1.0500373840332031
Epoch: 12, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.633 Vali Acc: 0.732 Test Loss: 0.633 Test Acc: 0.732
Validation loss decreased (-0.731878 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 1.0611882209777832
Epoch: 13, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.723 Vali Acc: 0.732 Test Loss: 0.723 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3778903484344482
Epoch: 14, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.595 Vali Acc: 0.754 Test Loss: 0.595 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 0.9969649314880371
Epoch: 15, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.584 Vali Acc: 0.790 Test Loss: 0.584 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789849).  Saving model ...
Epoch: 16 cost time: 0.9372756481170654
Epoch: 16, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0149850845336914
Epoch: 17, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.610 Vali Acc: 0.797 Test Loss: 0.610 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 18 cost time: 1.0134787559509277
Epoch: 18, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2130632400512695
Epoch: 19, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 20 cost time: 1.12945556640625
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0635638236999512
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.276350975036621
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 23 cost time: 1.2273266315460205
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 1.0424253940582275
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.173790693283081
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 0.8572676181793213
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 27 cost time: 1.2139477729797363
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9106295108795166
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0960321426391602
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9843814373016357
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0766191482543945
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 32 cost time: 1.0942847728729248
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0966932773590088
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 34 cost time: 1.1533689498901367
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2887957096099854
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 36 cost time: 1.052553653717041
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 37 cost time: 0.9013674259185791
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 38 cost time: 0.9880156517028809
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2309584617614746
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0395331382751465
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.300114631652832
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 42 cost time: 1.0901315212249756
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.088752269744873
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1660549640655518
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1795361042022705
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2286162376403809
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2442352771759033
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 48 cost time: 0.9939813613891602
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4406871795654297
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9915242195129395
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.855 Test Loss: 0.534 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2112207412719727
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 52 cost time: 0.961545467376709
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.119929313659668
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0505704879760742
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 55 cost time: 1.082320213317871
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3454766273498535
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1296415328979492
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.136089563369751
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 59 cost time: 0.9164509773254395
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 60 cost time: 1.0159499645233154
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.862 Test Loss: 0.546 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0977520942687988
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.855 Test Loss: 0.536 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0499069690704346
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1101293563842773
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.855 Test Loss: 0.530 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0118441581726074
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.0947494506835938
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 66 cost time: 1.0906741619110107
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9877519607543945
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9755029678344727
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.175159215927124
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 70 cost time: 1.1476185321807861
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 71 cost time: 0.9569053649902344
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.100560188293457
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0488758087158203
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.862 Test Loss: 0.529 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9951167106628418
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.2490122318267822
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.9310829639434814
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.0014185905456543
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.870 Test Loss: 0.524 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 78 cost time: 0.9521327018737793
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.099928855895996
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.2355024814605713
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.0953338146209717
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.9454407691955566
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.870 Test Loss: 0.528 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.0219721794128418
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 84 cost time: 1.14109468460083
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0048828125
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 86 cost time: 1.1920995712280273
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.8812277317047119
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.1343975067138672
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.0581104755401611
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.0269975662231445
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.1630096435546875
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.0923235416412354
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 93 cost time: 1.076127290725708
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.9383208751678467
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.0012221336364746
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.870 Test Loss: 0.551 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.1006824970245361
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.877 Test Loss: 0.539 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.0364899635314941
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 98 cost time: 1.0665011405944824
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.877 Test Loss: 0.543 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.9895045757293701
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.1014845371246338
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1240860
model size : 7.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0482993125915527
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.363 Vali Acc: 0.355 Test Loss: 1.363 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.0535602569580078
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.270 Vali Acc: 0.406 Test Loss: 1.270 Test Acc: 0.406
Validation loss decreased (-0.355059 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.1658294200897217
Epoch: 3, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.225 Vali Acc: 0.428 Test Loss: 1.225 Test Acc: 0.428
Validation loss decreased (-0.405784 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.9566032886505127
Epoch: 4, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.082 Vali Acc: 0.486 Test Loss: 1.082 Test Acc: 0.486
Validation loss decreased (-0.427524 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 1.1701455116271973
Epoch: 5, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.997 Vali Acc: 0.587 Test Loss: 0.997 Test Acc: 0.587
Validation loss decreased (-0.485496 --> -0.586947).  Saving model ...
Epoch: 6 cost time: 0.9663827419281006
Epoch: 6, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.921 Vali Acc: 0.659 Test Loss: 0.921 Test Acc: 0.659
Validation loss decreased (-0.586947 --> -0.659411).  Saving model ...
Epoch: 7 cost time: 0.9305076599121094
Epoch: 7, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.860 Vali Acc: 0.667 Test Loss: 0.860 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 0.869631290435791
Epoch: 8, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.800 Vali Acc: 0.638 Test Loss: 0.800 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9404172897338867
Epoch: 9, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.1037564277648926
Epoch: 10, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.722 Vali Acc: 0.725 Test Loss: 0.722 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724630).  Saving model ...
Epoch: 11 cost time: 1.014190435409546
Epoch: 11, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.829841136932373
Epoch: 12, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.633 Vali Acc: 0.754 Test Loss: 0.633 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 0.9235694408416748
Epoch: 13, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.694 Vali Acc: 0.725 Test Loss: 0.694 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0519402027130127
Epoch: 14, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 15 cost time: 0.9526846408843994
Epoch: 15, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9960870742797852
Epoch: 16, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.593 Vali Acc: 0.775 Test Loss: 0.593 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 17 cost time: 0.8689329624176025
Epoch: 17, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8486502170562744
Epoch: 18, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.0119802951812744
Epoch: 19, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9913191795349121
Epoch: 20, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.658 Vali Acc: 0.819 Test Loss: 0.658 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818834).  Saving model ...
Epoch: 21 cost time: 1.090270757675171
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.542 Vali Acc: 0.804 Test Loss: 0.542 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0643043518066406
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 0.9459412097930908
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9966926574707031
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 0.9091460704803467
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 1.002594232559204
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 1.0640993118286133
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 28 cost time: 1.0391364097595215
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.545 Vali Acc: 0.848 Test Loss: 0.545 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9951667785644531
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 30 cost time: 1.1325762271881104
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 31 cost time: 1.0550007820129395
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1463079452514648
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 33 cost time: 1.1486005783081055
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 1.0502958297729492
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 35 cost time: 0.905001163482666
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 0.9322919845581055
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 37 cost time: 1.0074894428253174
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 38 cost time: 1.3236627578735352
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 39 cost time: 1.1446502208709717
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 40 cost time: 0.963892936706543
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 41 cost time: 0.921140193939209
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9527316093444824
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9230928421020508
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0137522220611572
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 45 cost time: 1.0381453037261963
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 46 cost time: 0.953941822052002
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 47 cost time: 1.4224014282226562
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9970858097076416
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9933502674102783
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0668973922729492
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 51 cost time: 1.3188092708587646
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9249215126037598
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0990722179412842
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0772740840911865
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.99784255027771
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 56 cost time: 1.036224365234375
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 57 cost time: 1.202256679534912
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1223387718200684
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9827268123626709
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 60 cost time: 0.9675230979919434
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 61 cost time: 0.9876165390014648
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0739922523498535
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 63 cost time: 1.1520462036132812
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 64 cost time: 0.9659645557403564
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1590688228607178
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 66 cost time: 1.0524957180023193
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 67 cost time: 0.92354416847229
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1753957271575928
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1986334323883057
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.10353422164917
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.181366205215454
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.9891176223754883
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0923426151275635
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.877 Test Loss: 0.461 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.2765843868255615
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.9254486560821533
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.0333211421966553
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1238556
model size : 7.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.062969923019409
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.306 Vali Acc: 0.435 Test Loss: 1.306 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 0.9396514892578125
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.194 Vali Acc: 0.551 Test Loss: 1.194 Test Acc: 0.551
Validation loss decreased (-0.434770 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 1.0712456703186035
Epoch: 3, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.092 Vali Acc: 0.601 Test Loss: 1.092 Test Acc: 0.601
Validation loss decreased (-0.550713 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 0.9835877418518066
Epoch: 4, Steps: 9 | Train Loss: 0.989 Vali Loss: 0.981 Vali Acc: 0.616 Test Loss: 0.981 Test Acc: 0.616
Validation loss decreased (-0.601438 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 0.940295934677124
Epoch: 5, Steps: 9 | Train Loss: 0.890 Vali Loss: 0.922 Vali Acc: 0.667 Test Loss: 0.922 Test Acc: 0.667
Validation loss decreased (-0.615932 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 1.081045150756836
Epoch: 6, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.851 Vali Acc: 0.609 Test Loss: 0.851 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.014392614364624
Epoch: 7, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 0.9231822490692139
Epoch: 8, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.759 Vali Acc: 0.696 Test Loss: 0.759 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2490735054016113
Epoch: 9, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.658 Vali Acc: 0.725 Test Loss: 0.658 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.3091139793395996
Epoch: 10, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.642 Vali Acc: 0.768 Test Loss: 0.642 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 11 cost time: 1.1879746913909912
Epoch: 11, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1156644821166992
Epoch: 12, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.673 Vali Acc: 0.710 Test Loss: 0.673 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2837462425231934
Epoch: 13, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0303881168365479
Epoch: 14, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.531 Vali Acc: 0.797 Test Loss: 0.531 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 1.0744891166687012
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.603 Vali Acc: 0.768 Test Loss: 0.603 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2586219310760498
Epoch: 16, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3014097213745117
Epoch: 17, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.674 Vali Acc: 0.725 Test Loss: 0.674 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1208231449127197
Epoch: 18, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 19 cost time: 1.2845687866210938
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.768 Test Loss: 0.590 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9604568481445312
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.577 Vali Acc: 0.797 Test Loss: 0.577 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.20108962059021
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.570 Vali Acc: 0.797 Test Loss: 0.570 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5523254871368408
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.580 Vali Acc: 0.797 Test Loss: 0.580 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6029596328735352
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.605 Vali Acc: 0.812 Test Loss: 0.605 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0459225177764893
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2763259410858154
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2414019107818604
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 27 cost time: 1.2401199340820312
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1149380207061768
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 29 cost time: 1.2121021747589111
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 30 cost time: 1.3243632316589355
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3670916557312012
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 32 cost time: 1.1551694869995117
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 33 cost time: 1.2782485485076904
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.281013011932373
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3228683471679688
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3674588203430176
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.249824047088623
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.848 Test Loss: 0.575 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 38 cost time: 1.3282387256622314
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8451075553894043
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.353144645690918
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.848 Test Loss: 0.597 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.237401008605957
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2738900184631348
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.848 Test Loss: 0.589 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0858910083770752
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.855 Test Loss: 0.595 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 44 cost time: 1.1680996417999268
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.848 Test Loss: 0.601 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5440988540649414
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 46 cost time: 1.3077497482299805
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0726008415222168
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.855 Test Loss: 0.605 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2424631118774414
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.855 Test Loss: 0.603 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1597485542297363
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.286672830581665
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1221988201141357
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.855 Test Loss: 0.608 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.467421531677246
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.855 Test Loss: 0.606 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.326350450515747
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.855 Test Loss: 0.609 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.2176873683929443
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2804138660430908
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.848 Test Loss: 0.607 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1236252
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.890031576156616
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.314 Vali Acc: 0.420 Test Loss: 1.314 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.0038580894470215
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.235 Vali Acc: 0.449 Test Loss: 1.235 Test Acc: 0.449
Validation loss decreased (-0.420277 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.9760494232177734
Epoch: 3, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.160 Vali Acc: 0.478 Test Loss: 1.160 Test Acc: 0.478
Validation loss decreased (-0.449263 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 1.000213861465454
Epoch: 4, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.045 Vali Acc: 0.493 Test Loss: 1.045 Test Acc: 0.493
Validation loss decreased (-0.478249 --> -0.492743).  Saving model ...
Epoch: 5 cost time: 1.1675732135772705
Epoch: 5, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.954 Vali Acc: 0.623 Test Loss: 0.954 Test Acc: 0.623
Validation loss decreased (-0.492743 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 0.953190803527832
Epoch: 6, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.920 Vali Acc: 0.522 Test Loss: 0.920 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0000450611114502
Epoch: 7, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.808 Vali Acc: 0.630 Test Loss: 0.808 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630427).  Saving model ...
Epoch: 8 cost time: 0.9664740562438965
Epoch: 8, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.768 Vali Acc: 0.674 Test Loss: 0.768 Test Acc: 0.674
Validation loss decreased (-0.630427 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 0.952120304107666
Epoch: 9, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.778 Vali Acc: 0.681 Test Loss: 0.778 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 1.1948916912078857
Epoch: 10, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 1.0203890800476074
Epoch: 11, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.623 Vali Acc: 0.739 Test Loss: 0.623 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 12 cost time: 1.0337333679199219
Epoch: 12, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.640 Vali Acc: 0.732 Test Loss: 0.640 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.205265998840332
Epoch: 13, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.558 Vali Acc: 0.739 Test Loss: 0.558 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739125).  Saving model ...
Epoch: 14 cost time: 0.9840600490570068
Epoch: 14, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.643 Vali Acc: 0.768 Test Loss: 0.643 Test Acc: 0.768
Validation loss decreased (-0.739125 --> -0.768110).  Saving model ...
Epoch: 15 cost time: 0.8818345069885254
Epoch: 15, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9769206047058105
Epoch: 16, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 17 cost time: 0.9757373332977295
Epoch: 17, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.655 Vali Acc: 0.746 Test Loss: 0.655 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9366500377655029
Epoch: 18, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.617 Vali Acc: 0.812 Test Loss: 0.617 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811588).  Saving model ...
Epoch: 19 cost time: 1.1048839092254639
Epoch: 19, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0899274349212646
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9697592258453369
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1175751686096191
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 1.1164686679840088
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.671 Vali Acc: 0.804 Test Loss: 0.671 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.010106086730957
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9882018566131592
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9516489505767822
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9730041027069092
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.925079345703125
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9490456581115723
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0370652675628662
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9883897304534912
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8257191181182861
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 1233948
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.747528314590454
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 0.9933137893676758
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.280 Vali Acc: 0.341 Test Loss: 1.280 Test Acc: 0.341
Validation loss decreased (-0.275348 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 1.1270902156829834
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
Validation loss decreased (-0.340567 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.9591324329376221
Epoch: 4, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.073 Vali Acc: 0.471 Test Loss: 1.073 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0842103958129883
Epoch: 5, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.980 Vali Acc: 0.478 Test Loss: 0.980 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.141826868057251
Epoch: 6, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.896 Vali Acc: 0.652 Test Loss: 0.896 Test Acc: 0.652
Validation loss decreased (-0.514481 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 0.9833269119262695
Epoch: 7, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.868 Vali Acc: 0.572 Test Loss: 0.868 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9206199645996094
Epoch: 8, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.827 Vali Acc: 0.659 Test Loss: 0.827 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 1.0066442489624023
Epoch: 9, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.761 Vali Acc: 0.703 Test Loss: 0.761 Test Acc: 0.703
Validation loss decreased (-0.659412 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.1242105960845947
Epoch: 10, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 0.8907876014709473
Epoch: 11, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 0.9771032333374023
Epoch: 12, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 13 cost time: 0.9281558990478516
Epoch: 13, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9332239627838135
Epoch: 14, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.616 Vali Acc: 0.746 Test Loss: 0.616 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9677255153656006
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 0.9235033988952637
Epoch: 16, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0188548564910889
Epoch: 17, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.015333890914917
Epoch: 18, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1069908142089844
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.511 Vali Acc: 0.797 Test Loss: 0.511 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 20 cost time: 1.0177009105682373
Epoch: 20, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0459225177764893
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.570 Vali Acc: 0.790 Test Loss: 0.570 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1632256507873535
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 23 cost time: 1.0560128688812256
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1488864421844482
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.668 Vali Acc: 0.804 Test Loss: 0.668 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9905905723571777
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.567 Vali Acc: 0.804 Test Loss: 0.567 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8421192169189453
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 0.9750919342041016
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 28 cost time: 1.1621599197387695
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9985320568084717
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.826 Test Loss: 0.606 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 30 cost time: 1.2367746829986572
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 31 cost time: 1.190096139907837
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 32 cost time: 0.8807418346405029
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8377048969268799
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3203635215759277
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 35 cost time: 1.1062872409820557
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0642719268798828
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9608371257781982
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 38 cost time: 1.0052478313446045
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2374086380004883
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0677859783172607
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2661805152893066
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2372326850891113
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1896543502807617
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 44 cost time: 1.2978887557983398
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.138167142868042
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1230781078338623
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0969204902648926
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.848 Test Loss: 0.544 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1777069568634033
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 49 cost time: 1.0217621326446533
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0374295711517334
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.848 Test Loss: 0.546 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2561852931976318
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4861326217651367
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.848 Test Loss: 0.551 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.291839838027954
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1867218017578125
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.848 Test Loss: 0.534 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 55 cost time: 1.0336146354675293
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.964022159576416
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 57 cost time: 0.9478495121002197
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.855 Test Loss: 0.542 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 58 cost time: 0.9334862232208252
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 59 cost time: 0.9561684131622314
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0215582847595215
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1523020267486572
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1230461597442627
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.855 Test Loss: 0.546 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.3405005931854248
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.855 Test Loss: 0.546 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0427355766296387
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1809556484222412
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0895164012908936
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.0553638935089111
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.862 Test Loss: 0.548 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.9030876159667969
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1043484
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6821954250335693
Epoch: 1, Steps: 9 | Train Loss: 1.511 Vali Loss: 1.408 Vali Acc: 0.290 Test Loss: 1.408 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.0224857330322266
Epoch: 2, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.282 Vali Acc: 0.384 Test Loss: 1.282 Test Acc: 0.384
Validation loss decreased (-0.289841 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.9904186725616455
Epoch: 3, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.384045 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 1.2184765338897705
Epoch: 4, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.068 Vali Acc: 0.558 Test Loss: 1.068 Test Acc: 0.558
Validation loss decreased (-0.514481 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 1.090545892715454
Epoch: 5, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.990 Vali Acc: 0.609 Test Loss: 0.990 Test Acc: 0.609
Validation loss decreased (-0.557960 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 1.1447782516479492
Epoch: 6, Steps: 9 | Train Loss: 0.757 Vali Loss: 0.902 Vali Acc: 0.601 Test Loss: 0.902 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3546395301818848
Epoch: 7, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.928 Vali Acc: 0.601 Test Loss: 0.928 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0394930839538574
Epoch: 8, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.812 Vali Acc: 0.623 Test Loss: 0.812 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623180).  Saving model ...
Epoch: 9 cost time: 1.176628828048706
Epoch: 9, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.810 Vali Acc: 0.645 Test Loss: 0.810 Test Acc: 0.645
Validation loss decreased (-0.623180 --> -0.644919).  Saving model ...
Epoch: 10 cost time: 1.12019944190979
Epoch: 10, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.741 Vali Acc: 0.667 Test Loss: 0.741 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 11 cost time: 1.262155532836914
Epoch: 11, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.707 Vali Acc: 0.688 Test Loss: 0.707 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 12 cost time: 1.1326870918273926
Epoch: 12, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.668 Vali Acc: 0.710 Test Loss: 0.668 Test Acc: 0.710
Validation loss decreased (-0.688399 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 0.9949557781219482
Epoch: 13, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 14 cost time: 0.9733881950378418
Epoch: 14, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.588 Vali Acc: 0.754 Test Loss: 0.588 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 0.9740374088287354
Epoch: 15, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.788 Vali Acc: 0.725 Test Loss: 0.788 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0141267776489258
Epoch: 16, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.592 Vali Acc: 0.703 Test Loss: 0.592 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0189497470855713
Epoch: 17, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.606 Vali Acc: 0.768 Test Loss: 0.606 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 18 cost time: 1.165595293045044
Epoch: 18, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.562 Vali Acc: 0.761 Test Loss: 0.562 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1313464641571045
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 20 cost time: 0.9582574367523193
Epoch: 20, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2339632511138916
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.797 Test Loss: 0.548 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 22 cost time: 1.0199534893035889
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 1.1773757934570312
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2086257934570312
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 25 cost time: 1.0504887104034424
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 26 cost time: 1.1337361335754395
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.590 Vali Acc: 0.790 Test Loss: 0.590 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1962924003601074
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 28 cost time: 1.051370620727539
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1367816925048828
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 1.1935279369354248
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 31 cost time: 1.1865229606628418
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0986270904541016
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2796142101287842
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1258845329284668
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 35 cost time: 1.1705334186553955
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2634544372558594
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 37 cost time: 1.311018466949463
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.848 Test Loss: 0.534 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.12343430519104
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1068923473358154
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0720489025115967
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.855 Test Loss: 0.537 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9867663383483887
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.848 Test Loss: 0.545 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1190791130065918
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2073338031768799
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0950191020965576
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.855 Test Loss: 0.537 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0423002243041992
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 46 cost time: 1.2409989833831787
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1181371212005615
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.855 Test Loss: 0.539 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9816961288452148
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1286678314208984
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.862 Test Loss: 0.535 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1571133136749268
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8873705863952637
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.083315372467041
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 53 cost time: 1.2120418548583984
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0951223373413086
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9971168041229248
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1820785999298096
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0942058563232422
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.862 Test Loss: 0.547 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.3151049613952637
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.156938076019287
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.1065359115600586
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.2769582271575928
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 62 cost time: 1.1399333477020264
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.870 Test Loss: 0.532 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2758235931396484
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.870 Test Loss: 0.538 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.215851068496704
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.870 Test Loss: 0.541 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.2436802387237549
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.862 Test Loss: 0.546 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.0207099914550781
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.1152162551879883
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.870 Test Loss: 0.532 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.1189708709716797
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.0886485576629639
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.0602364540100098
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.30714750289917
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.870 Test Loss: 0.541 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1041180
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.197608232498169
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.382 Vali Acc: 0.254 Test Loss: 1.382 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.210888147354126
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.265 Vali Acc: 0.384 Test Loss: 1.265 Test Acc: 0.384
Validation loss decreased (-0.253609 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.0762109756469727
Epoch: 3, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.153 Vali Acc: 0.478 Test Loss: 1.153 Test Acc: 0.478
Validation loss decreased (-0.384045 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.9886271953582764
Epoch: 4, Steps: 9 | Train Loss: 1.019 Vali Loss: 1.061 Vali Acc: 0.493 Test Loss: 1.061 Test Acc: 0.493
Validation loss decreased (-0.478249 --> -0.492743).  Saving model ...
Epoch: 5 cost time: 1.1954195499420166
Epoch: 5, Steps: 9 | Train Loss: 0.919 Vali Loss: 0.965 Vali Acc: 0.623 Test Loss: 0.965 Test Acc: 0.623
Validation loss decreased (-0.492743 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 1.080068826675415
Epoch: 6, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.949 Vali Acc: 0.587 Test Loss: 0.949 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.211186408996582
Epoch: 7, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.888 Vali Acc: 0.587 Test Loss: 0.888 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2062702178955078
Epoch: 8, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.844 Vali Acc: 0.652 Test Loss: 0.844 Test Acc: 0.652
Validation loss decreased (-0.623179 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 1.022080421447754
Epoch: 9, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.748 Vali Acc: 0.732 Test Loss: 0.748 Test Acc: 0.732
Validation loss decreased (-0.652165 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.163456916809082
Epoch: 10, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.782 Vali Acc: 0.674 Test Loss: 0.782 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3465633392333984
Epoch: 11, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5274276733398438
Epoch: 12, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 1.3919932842254639
Epoch: 13, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.655 Vali Acc: 0.710 Test Loss: 0.655 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2166330814361572
Epoch: 14, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.728 Vali Acc: 0.710 Test Loss: 0.728 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0811705589294434
Epoch: 15, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775357).  Saving model ...
Epoch: 16 cost time: 1.0487327575683594
Epoch: 16, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.539 Vali Acc: 0.790 Test Loss: 0.539 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 1.056408166885376
Epoch: 17, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1165611743927002
Epoch: 18, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.084036111831665
Epoch: 19, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.510 Vali Acc: 0.790 Test Loss: 0.510 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 20 cost time: 0.9474685192108154
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.479 Vali Acc: 0.797 Test Loss: 0.479 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797097).  Saving model ...
Epoch: 21 cost time: 1.0627624988555908
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2193381786346436
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
Validation loss decreased (-0.797097 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 1.088266134262085
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.468 Vali Acc: 0.819 Test Loss: 0.468 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 24 cost time: 0.9579434394836426
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 25 cost time: 1.2727060317993164
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 0.9309463500976562
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0982255935668945
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 28 cost time: 1.0329678058624268
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1076767444610596
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 1.1174004077911377
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 1.0335443019866943
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 1.3626134395599365
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2986338138580322
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 34 cost time: 0.9591853618621826
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0616567134857178
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9296808242797852
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 1.0653369426727295
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 1.042646884918213
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 39 cost time: 1.2368738651275635
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 40 cost time: 1.0995290279388428
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 41 cost time: 1.0229487419128418
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.419215440750122
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0667333602905273
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3483262062072754
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0586473941802979
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0863630771636963
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 47 cost time: 1.1532316207885742
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.177351713180542
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0589826107025146
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 50 cost time: 1.1698765754699707
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.041015625
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2317941188812256
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9731216430664062
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.891 Test Loss: 0.406 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1763889789581299
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 55 cost time: 0.9888553619384766
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 56 cost time: 1.0601768493652344
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.891 Test Loss: 0.398 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 57 cost time: 1.1547000408172607
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 58 cost time: 1.1054260730743408
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3453679084777832
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2878918647766113
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.891 Test Loss: 0.401 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2327539920806885
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.1271259784698486
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.891 Test Loss: 0.398 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.1516954898834229
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.1182563304901123
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.168529987335205
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.9711737632751465
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.057081937789917
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1038876
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.952542304992676
Epoch: 1, Steps: 9 | Train Loss: 1.444 Vali Loss: 1.366 Vali Acc: 0.290 Test Loss: 1.366 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.0773138999938965
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.260 Vali Acc: 0.377 Test Loss: 1.260 Test Acc: 0.377
Validation loss decreased (-0.289841 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 0.9443151950836182
Epoch: 3, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.150 Vali Acc: 0.551 Test Loss: 1.150 Test Acc: 0.551
Validation loss decreased (-0.376799 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 0.9479870796203613
Epoch: 4, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.069 Vali Acc: 0.587 Test Loss: 1.069 Test Acc: 0.587
Validation loss decreased (-0.550713 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 0.9738123416900635
Epoch: 5, Steps: 9 | Train Loss: 0.908 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0533530712127686
Epoch: 6, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.959 Vali Acc: 0.522 Test Loss: 0.959 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.989393949508667
Epoch: 7, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.855 Vali Acc: 0.594 Test Loss: 0.855 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594194).  Saving model ...
Epoch: 8 cost time: 1.2203044891357422
Epoch: 8, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.809 Vali Acc: 0.659 Test Loss: 0.809 Test Acc: 0.659
Validation loss decreased (-0.594194 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 0.8939545154571533
Epoch: 9, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.767 Vali Acc: 0.674 Test Loss: 0.767 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 1.0648062229156494
Epoch: 10, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.735 Vali Acc: 0.696 Test Loss: 0.735 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 0.9251644611358643
Epoch: 11, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.773 Vali Acc: 0.609 Test Loss: 0.773 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9734494686126709
Epoch: 12, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 0.9856266975402832
Epoch: 13, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739123).  Saving model ...
Epoch: 14 cost time: 1.0633025169372559
Epoch: 14, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1233201026916504
Epoch: 15, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 0.8239588737487793
Epoch: 16, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 17 cost time: 1.0001990795135498
Epoch: 17, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.573 Vali Acc: 0.768 Test Loss: 0.573 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 18 cost time: 1.223496675491333
Epoch: 18, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.542 Vali Acc: 0.790 Test Loss: 0.542 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 0.8942060470581055
Epoch: 19, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9538190364837646
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.585 Vali Acc: 0.754 Test Loss: 0.585 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2470812797546387
Epoch: 21, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.797 Vali Acc: 0.775 Test Loss: 0.797 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9762134552001953
Epoch: 22, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0445866584777832
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.640 Vali Acc: 0.812 Test Loss: 0.640 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811588).  Saving model ...
Epoch: 24 cost time: 0.9034874439239502
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 25 cost time: 0.9514265060424805
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.797 Test Loss: 0.623 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0103893280029297
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 0.9520759582519531
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9471583366394043
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.826 Test Loss: 0.616 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 29 cost time: 1.1706581115722656
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 1.137556791305542
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 1.1426000595092773
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 32 cost time: 0.8871216773986816
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0831031799316406
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1389415264129639
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847820).  Saving model ...
Epoch: 35 cost time: 0.9646577835083008
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0330328941345215
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1954119205474854
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9828405380249023
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0250234603881836
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9117717742919922
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 41 cost time: 1.0790314674377441
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9987616539001465
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.848 Test Loss: 0.617 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.131439208984375
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.848 Test Loss: 0.601 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0006580352783203
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.855 Test Loss: 0.597 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 45 cost time: 1.0126965045928955
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0680146217346191
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9428279399871826
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.855 Test Loss: 0.610 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.070108413696289
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.855 Test Loss: 0.623 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8901767730712891
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.855 Test Loss: 0.612 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0014173984527588
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.855 Test Loss: 0.604 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.885462760925293
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.855 Test Loss: 0.621 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.059966802597046
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.855 Test Loss: 0.611 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8697037696838379
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.848 Test Loss: 0.622 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.8670129776000977
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.848 Test Loss: 0.618 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1036572
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.117744207382202
Epoch: 1, Steps: 9 | Train Loss: 1.478 Vali Loss: 1.339 Vali Acc: 0.370 Test Loss: 1.339 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.469489336013794
Epoch: 2, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.259 Vali Acc: 0.348 Test Loss: 1.259 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1580531597137451
Epoch: 3, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.189 Vali Acc: 0.478 Test Loss: 1.189 Test Acc: 0.478
Validation loss decreased (-0.369552 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 1.2006456851959229
Epoch: 4, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.071 Vali Acc: 0.565 Test Loss: 1.071 Test Acc: 0.565
Validation loss decreased (-0.478249 --> -0.565207).  Saving model ...
Epoch: 5 cost time: 1.0364797115325928
Epoch: 5, Steps: 9 | Train Loss: 0.905 Vali Loss: 1.004 Vali Acc: 0.558 Test Loss: 1.004 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0522816181182861
Epoch: 6, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.978 Vali Acc: 0.594 Test Loss: 0.978 Test Acc: 0.594
Validation loss decreased (-0.565207 --> -0.594193).  Saving model ...
Epoch: 7 cost time: 1.2140984535217285
Epoch: 7, Steps: 9 | Train Loss: 0.727 Vali Loss: 0.870 Vali Acc: 0.630 Test Loss: 0.870 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630426).  Saving model ...
Epoch: 8 cost time: 1.4174034595489502
Epoch: 8, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.819 Vali Acc: 0.652 Test Loss: 0.819 Test Acc: 0.652
Validation loss decreased (-0.630426 --> -0.652166).  Saving model ...
Epoch: 9 cost time: 1.2386527061462402
Epoch: 9, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.852 Vali Acc: 0.674 Test Loss: 0.852 Test Acc: 0.674
Validation loss decreased (-0.652166 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 0.908128023147583
Epoch: 10, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.743 Vali Acc: 0.696 Test Loss: 0.743 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.0243873596191406
Epoch: 11, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 1.176530122756958
Epoch: 12, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1274523735046387
Epoch: 13, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.600 Vali Acc: 0.739 Test Loss: 0.600 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 1.2049789428710938
Epoch: 14, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 15 cost time: 1.1553702354431152
Epoch: 15, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.595 Vali Acc: 0.783 Test Loss: 0.595 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 1.289635419845581
Epoch: 16, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.609 Vali Acc: 0.732 Test Loss: 0.609 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2244656085968018
Epoch: 17, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.676 Vali Acc: 0.739 Test Loss: 0.676 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3262195587158203
Epoch: 18, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.641 Vali Acc: 0.754 Test Loss: 0.641 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9816727638244629
Epoch: 19, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 20 cost time: 1.1259310245513916
Epoch: 20, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1881935596466064
Epoch: 21, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1912543773651123
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.580 Vali Acc: 0.790 Test Loss: 0.580 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2017009258270264
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826083).  Saving model ...
Epoch: 24 cost time: 0.9653439521789551
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3608684539794922
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.477 Vali Acc: 0.812 Test Loss: 0.477 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1264448165893555
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1754264831542969
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 28 cost time: 1.2538552284240723
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 1.044640064239502
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 1.360734224319458
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.364281177520752
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4294395446777344
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1269755363464355
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1040802001953125
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2588708400726318
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 1.466392993927002
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3256618976593018
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3364393711090088
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2751343250274658
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0943434238433838
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 41 cost time: 1.26643705368042
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9878416061401367
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1537132263183594
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2930939197540283
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1122233867645264
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1995291709899902
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.135164499282837
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1525897979736328
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0185356140136719
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.161329746246338
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 944796
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1999056339263916
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.300 Vali Acc: 0.384 Test Loss: 1.300 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.2708494663238525
Epoch: 2, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.213 Vali Acc: 0.493 Test Loss: 1.213 Test Acc: 0.493
Validation loss decreased (-0.384045 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 1.074293613433838
Epoch: 3, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.118 Vali Acc: 0.464 Test Loss: 1.118 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.153545618057251
Epoch: 4, Steps: 9 | Train Loss: 0.999 Vali Loss: 1.066 Vali Acc: 0.536 Test Loss: 1.066 Test Acc: 0.536
Validation loss decreased (-0.492741 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 1.0062010288238525
Epoch: 5, Steps: 9 | Train Loss: 0.920 Vali Loss: 0.983 Vali Acc: 0.514 Test Loss: 0.983 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0002732276916504
Epoch: 6, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.915 Vali Acc: 0.652 Test Loss: 0.915 Test Acc: 0.652
Validation loss decreased (-0.536221 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 1.0997920036315918
Epoch: 7, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.841 Vali Acc: 0.674 Test Loss: 0.841 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.1158714294433594
Epoch: 8, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.798 Vali Acc: 0.659 Test Loss: 0.798 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0640418529510498
Epoch: 9, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.673905 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.146737813949585
Epoch: 10, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 1.0275282859802246
Epoch: 11, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.686 Vali Acc: 0.725 Test Loss: 0.686 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 0.9672784805297852
Epoch: 12, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.712 Vali Acc: 0.710 Test Loss: 0.712 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7735016345977783
Epoch: 13, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.602 Vali Acc: 0.725 Test Loss: 0.602 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724632).  Saving model ...
Epoch: 14 cost time: 0.926192045211792
Epoch: 14, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.640 Vali Acc: 0.696 Test Loss: 0.640 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.902099609375
Epoch: 15, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.633 Vali Acc: 0.754 Test Loss: 0.633 Test Acc: 0.754
Validation loss decreased (-0.724632 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 0.7998831272125244
Epoch: 16, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9771265983581543
Epoch: 17, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.615 Vali Acc: 0.754 Test Loss: 0.615 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 18 cost time: 0.8646910190582275
Epoch: 18, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.537 Vali Acc: 0.804 Test Loss: 0.537 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 1.0519092082977295
Epoch: 19, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9124205112457275
Epoch: 20, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1661312580108643
Epoch: 21, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 1.041996955871582
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.584 Vali Acc: 0.775 Test Loss: 0.584 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0629563331604004
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9576952457427979
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 25 cost time: 0.8815417289733887
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.479 Vali Acc: 0.812 Test Loss: 0.479 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8997187614440918
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 27 cost time: 0.9852409362792969
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 0.9938664436340332
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 1.0268385410308838
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 0.8267936706542969
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 31 cost time: 1.0462958812713623
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 32 cost time: 1.0025041103363037
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9163525104522705
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8600461483001709
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0499255657196045
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0485992431640625
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 37 cost time: 1.0085697174072266
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9568464756011963
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3112621307373047
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.144624948501587
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0250043869018555
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 42 cost time: 1.0199990272521973
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 43 cost time: 1.0314271450042725
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.895392656326294
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9564762115478516
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.848 Test Loss: 0.471 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9899041652679443
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8596470355987549
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1246981620788574
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8244209289550781
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8499093055725098
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9211316108703613
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7774038314819336
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 942492
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4421169757843018
Epoch: 1, Steps: 9 | Train Loss: 1.519 Vali Loss: 1.372 Vali Acc: 0.319 Test Loss: 1.372 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.0476160049438477
Epoch: 2, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.277 Vali Acc: 0.312 Test Loss: 1.277 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0874683856964111
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.153 Vali Acc: 0.522 Test Loss: 1.153 Test Acc: 0.522
Validation loss decreased (-0.318827 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 1.0872011184692383
Epoch: 4, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.000331163406372
Epoch: 5, Steps: 9 | Train Loss: 0.922 Vali Loss: 1.001 Vali Acc: 0.594 Test Loss: 1.001 Test Acc: 0.594
Validation loss decreased (-0.521728 --> -0.594193).  Saving model ...
Epoch: 6 cost time: 1.0002751350402832
Epoch: 6, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.927 Vali Acc: 0.522 Test Loss: 0.927 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2044503688812256
Epoch: 7, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.925 Vali Acc: 0.609 Test Loss: 0.925 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608686).  Saving model ...
Epoch: 8 cost time: 1.0768578052520752
Epoch: 8, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.830 Vali Acc: 0.616 Test Loss: 0.830 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615934).  Saving model ...
Epoch: 9 cost time: 1.0780460834503174
Epoch: 9, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.809 Vali Acc: 0.645 Test Loss: 0.809 Test Acc: 0.645
Validation loss decreased (-0.615934 --> -0.644919).  Saving model ...
Epoch: 10 cost time: 1.095458745956421
Epoch: 10, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.747 Vali Acc: 0.667 Test Loss: 0.747 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 11 cost time: 0.8447620868682861
Epoch: 11, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.686 Vali Acc: 0.725 Test Loss: 0.686 Test Acc: 0.725
Validation loss decreased (-0.666659 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 1.0818297863006592
Epoch: 12, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.076383113861084
Epoch: 13, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.713 Vali Acc: 0.725 Test Loss: 0.713 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.023099422454834
Epoch: 14, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.692 Vali Acc: 0.703 Test Loss: 0.692 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0283057689666748
Epoch: 15, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 1.0411930084228516
Epoch: 16, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.593 Vali Acc: 0.768 Test Loss: 0.593 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 17 cost time: 1.0281062126159668
Epoch: 17, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.554 Vali Acc: 0.775 Test Loss: 0.554 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 18 cost time: 1.0335898399353027
Epoch: 18, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 19 cost time: 0.9632773399353027
Epoch: 19, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.584 Vali Acc: 0.775 Test Loss: 0.584 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1230049133300781
Epoch: 20, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0167109966278076
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.553 Vali Acc: 0.804 Test Loss: 0.553 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 1.1005604267120361
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.570 Vali Acc: 0.768 Test Loss: 0.570 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0732245445251465
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.804 Test Loss: 0.552 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 24 cost time: 1.0710797309875488
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 0.9573431015014648
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 1.0346605777740479
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1479694843292236
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0305500030517578
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1012001037597656
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 1.0168826580047607
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 31 cost time: 1.1178889274597168
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 32 cost time: 0.9425866603851318
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 33 cost time: 1.0849661827087402
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1651694774627686
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0481739044189453
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.179220199584961
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1621720790863037
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9511370658874512
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0528528690338135
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 40 cost time: 1.1032543182373047
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 41 cost time: 1.1614055633544922
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 42 cost time: 0.856837272644043
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1216309070587158
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 44 cost time: 1.1299965381622314
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 45 cost time: 1.3131277561187744
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 46 cost time: 1.0326273441314697
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.066826581954956
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9813475608825684
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3684718608856201
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0664691925048828
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.870 Test Loss: 0.495 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0840590000152588
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.2048919200897217
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1645634174346924
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0681324005126953
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0625972747802734
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.870 Test Loss: 0.496 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 940188
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.038719415664673
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.336 Vali Acc: 0.326 Test Loss: 1.336 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.1403326988220215
Epoch: 2, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.216 Vali Acc: 0.406 Test Loss: 1.216 Test Acc: 0.406
Validation loss decreased (-0.326074 --> -0.405785).  Saving model ...
Epoch: 3 cost time: 1.2345881462097168
Epoch: 3, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.114 Vali Acc: 0.609 Test Loss: 1.114 Test Acc: 0.609
Validation loss decreased (-0.405785 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 1.0279579162597656
Epoch: 4, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2876501083374023
Epoch: 5, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.971 Vali Acc: 0.645 Test Loss: 0.971 Test Acc: 0.645
Validation loss decreased (-0.608685 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 1.2717857360839844
Epoch: 6, Steps: 9 | Train Loss: 0.833 Vali Loss: 0.898 Vali Acc: 0.543 Test Loss: 0.898 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9695475101470947
Epoch: 7, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.853 Vali Acc: 0.667 Test Loss: 0.853 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 1.090993881225586
Epoch: 8, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.780 Vali Acc: 0.688 Test Loss: 0.780 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 1.2999777793884277
Epoch: 9, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.808 Vali Acc: 0.638 Test Loss: 0.808 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.094639778137207
Epoch: 10, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.707 Vali Acc: 0.725 Test Loss: 0.707 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 1.1769709587097168
Epoch: 11, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.686 Vali Acc: 0.703 Test Loss: 0.686 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9676141738891602
Epoch: 12, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.723 Vali Acc: 0.681 Test Loss: 0.723 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0998988151550293
Epoch: 13, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 0.909832239151001
Epoch: 14, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.731 Vali Acc: 0.696 Test Loss: 0.731 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.137894630432129
Epoch: 15, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.640 Vali Acc: 0.761 Test Loss: 0.640 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760863).  Saving model ...
Epoch: 16 cost time: 1.2680778503417969
Epoch: 16, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 17 cost time: 1.332566499710083
Epoch: 17, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797096).  Saving model ...
Epoch: 18 cost time: 1.3031461238861084
Epoch: 18, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2781341075897217
Epoch: 19, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.720 Vali Acc: 0.775 Test Loss: 0.720 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.265380859375
Epoch: 20, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.591 Vali Acc: 0.761 Test Loss: 0.591 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0315282344818115
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3210222721099854
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.569 Vali Acc: 0.768 Test Loss: 0.569 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.219057321548462
Epoch: 23, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 24 cost time: 1.408073902130127
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.546 Vali Acc: 0.797 Test Loss: 0.546 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.242074966430664
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.221128225326538
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 1.1120400428771973
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.064934492111206
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3151397705078125
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 1.2560408115386963
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6375815868377686
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2905809879302979
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1685168743133545
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0996437072753906
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2135095596313477
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1303200721740723
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3596680164337158
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0351481437683105
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9353227615356445
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 937884
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9212002754211426
Epoch: 1, Steps: 9 | Train Loss: 1.513 Vali Loss: 1.443 Vali Acc: 0.181 Test Loss: 1.443 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 0.9806642532348633
Epoch: 2, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.387 Vali Acc: 0.326 Test Loss: 1.387 Test Acc: 0.326
Validation loss decreased (-0.181145 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 0.9675030708312988
Epoch: 3, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.273 Vali Acc: 0.326 Test Loss: 1.273 Test Acc: 0.326
Validation loss decreased (-0.326073 --> -0.326074).  Saving model ...
Epoch: 4 cost time: 1.025097370147705
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.165 Vali Acc: 0.471 Test Loss: 1.165 Test Acc: 0.471
Validation loss decreased (-0.326074 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 1.2349214553833008
Epoch: 5, Steps: 9 | Train Loss: 0.976 Vali Loss: 1.054 Vali Acc: 0.529 Test Loss: 1.054 Test Acc: 0.529
Validation loss decreased (-0.471003 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 0.914637565612793
Epoch: 6, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.974 Vali Acc: 0.652 Test Loss: 0.974 Test Acc: 0.652
Validation loss decreased (-0.528975 --> -0.652164).  Saving model ...
Epoch: 7 cost time: 0.9520721435546875
Epoch: 7, Steps: 9 | Train Loss: 0.831 Vali Loss: 0.914 Vali Acc: 0.616 Test Loss: 0.914 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8817603588104248
Epoch: 8, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.845 Vali Acc: 0.710 Test Loss: 0.845 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710136).  Saving model ...
Epoch: 9 cost time: 1.345278024673462
Epoch: 9, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.788 Vali Acc: 0.674 Test Loss: 0.788 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9871134757995605
Epoch: 10, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.752 Vali Acc: 0.703 Test Loss: 0.752 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0401716232299805
Epoch: 11, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.687 Vali Acc: 0.725 Test Loss: 0.687 Test Acc: 0.725
Validation loss decreased (-0.710136 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 1.0420722961425781
Epoch: 12, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.668 Vali Acc: 0.710 Test Loss: 0.668 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0548455715179443
Epoch: 13, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 14 cost time: 1.037327527999878
Epoch: 14, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.640 Vali Acc: 0.725 Test Loss: 0.640 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0629358291625977
Epoch: 15, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.001335859298706
Epoch: 16, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.586 Vali Acc: 0.754 Test Loss: 0.586 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 17 cost time: 1.008521556854248
Epoch: 17, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0959060192108154
Epoch: 18, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.591 Vali Acc: 0.739 Test Loss: 0.591 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1413800716400146
Epoch: 19, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775356).  Saving model ...
Epoch: 20 cost time: 0.8822886943817139
Epoch: 20, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.554 Vali Acc: 0.797 Test Loss: 0.554 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 21 cost time: 1.0141255855560303
Epoch: 21, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0482449531555176
Epoch: 22, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 1.0189530849456787
Epoch: 23, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.625 Vali Acc: 0.804 Test Loss: 0.625 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9623160362243652
Epoch: 24, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.578 Vali Acc: 0.804 Test Loss: 0.578 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9946506023406982
Epoch: 25, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0173969268798828
Epoch: 26, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 0.8567197322845459
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.898423433303833
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0273914337158203
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0884065628051758
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0496902465820312
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.037855863571167
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 33 cost time: 1.0699243545532227
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9179117679595947
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8964481353759766
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 36 cost time: 0.9721336364746094
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.009704828262329
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0966613292694092
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9763588905334473
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9772582054138184
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8414068222045898
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9038839340209961
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.349548578262329
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.07875394821167
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3417105674743652
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 622748
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.992333173751831
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.06858491897583
Epoch: 2, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.290 Vali Acc: 0.399 Test Loss: 1.290 Test Acc: 0.399
Validation loss decreased (-0.333320 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.8658037185668945
Epoch: 3, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.206 Vali Acc: 0.514 Test Loss: 1.206 Test Acc: 0.514
Validation loss decreased (-0.398538 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.9554331302642822
Epoch: 4, Steps: 9 | Train Loss: 1.105 Vali Loss: 1.106 Vali Acc: 0.420 Test Loss: 1.106 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0806105136871338
Epoch: 5, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.016 Vali Acc: 0.630 Test Loss: 1.016 Test Acc: 0.630
Validation loss decreased (-0.514481 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.0781989097595215
Epoch: 6, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.967 Vali Acc: 0.623 Test Loss: 0.967 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1863784790039062
Epoch: 7, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.885 Vali Acc: 0.645 Test Loss: 0.885 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.1658031940460205
Epoch: 8, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.808 Vali Acc: 0.623 Test Loss: 0.808 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.161428451538086
Epoch: 9, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.731 Vali Acc: 0.739 Test Loss: 0.731 Test Acc: 0.739
Validation loss decreased (-0.644919 --> -0.739123).  Saving model ...
Epoch: 10 cost time: 1.0770745277404785
Epoch: 10, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0468318462371826
Epoch: 11, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 1.0270416736602783
Epoch: 12, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0552308559417725
Epoch: 13, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.597 Vali Acc: 0.754 Test Loss: 0.597 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 1.1046338081359863
Epoch: 14, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.605 Vali Acc: 0.746 Test Loss: 0.605 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3257207870483398
Epoch: 15, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.574 Vali Acc: 0.768 Test Loss: 0.574 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 16 cost time: 1.153202772140503
Epoch: 16, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.576 Vali Acc: 0.761 Test Loss: 0.576 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1550123691558838
Epoch: 17, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 0.9516720771789551
Epoch: 18, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0547945499420166
Epoch: 19, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1497511863708496
Epoch: 20, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.553 Vali Acc: 0.804 Test Loss: 0.553 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 21 cost time: 0.878349781036377
Epoch: 21, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9771881103515625
Epoch: 22, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 0.9643197059631348
Epoch: 23, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.565 Vali Acc: 0.797 Test Loss: 0.565 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3025169372558594
Epoch: 24, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.542 Vali Acc: 0.797 Test Loss: 0.542 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0612542629241943
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1073551177978516
Epoch: 26, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.550 Vali Acc: 0.804 Test Loss: 0.550 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.184729814529419
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1200025081634521
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1806132793426514
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 30 cost time: 1.1103804111480713
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 31 cost time: 0.9997806549072266
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1730334758758545
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 1.1442453861236572
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.178267002105713
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 35 cost time: 1.0914075374603271
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 36 cost time: 1.0757696628570557
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.848 Test Loss: 0.555 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1547503471374512
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0812902450561523
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.137300729751587
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.966660737991333
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 41 cost time: 1.157485008239746
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3454606533050537
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3031635284423828
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.175722360610962
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.855 Test Loss: 0.575 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.368638038635254
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.7336664199829102
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.855 Test Loss: 0.570 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.5313174724578857
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1815950870513916
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0227653980255127
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3299438953399658
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.855 Test Loss: 0.576 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 621596
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3836824893951416
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.351 Vali Acc: 0.326 Test Loss: 1.351 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.9917821884155273
Epoch: 2, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.300 Vali Acc: 0.312 Test Loss: 1.300 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2134571075439453
Epoch: 3, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.204 Vali Acc: 0.464 Test Loss: 1.204 Test Acc: 0.464
Validation loss decreased (-0.326073 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 0.968839168548584
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
Validation loss decreased (-0.463756 --> -0.514482).  Saving model ...
Epoch: 5 cost time: 1.1222615242004395
Epoch: 5, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.050 Vali Acc: 0.587 Test Loss: 1.050 Test Acc: 0.587
Validation loss decreased (-0.514482 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 0.9182093143463135
Epoch: 6, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.978 Vali Acc: 0.543 Test Loss: 0.978 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9144625663757324
Epoch: 7, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.926 Vali Acc: 0.623 Test Loss: 0.926 Test Acc: 0.623
Validation loss decreased (-0.586946 --> -0.623179).  Saving model ...
Epoch: 8 cost time: 1.4062919616699219
Epoch: 8, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.870 Vali Acc: 0.638 Test Loss: 0.870 Test Acc: 0.638
Validation loss decreased (-0.623179 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 1.1454682350158691
Epoch: 9, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.775 Vali Acc: 0.688 Test Loss: 0.775 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 0.8726260662078857
Epoch: 10, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.729 Vali Acc: 0.696 Test Loss: 0.729 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.371565580368042
Epoch: 11, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.711 Vali Acc: 0.667 Test Loss: 0.711 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0550401210784912
Epoch: 12, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 13 cost time: 1.0500469207763672
Epoch: 13, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.628 Vali Acc: 0.725 Test Loss: 0.628 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0451016426086426
Epoch: 14, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 15 cost time: 0.9452784061431885
Epoch: 15, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
Validation loss decreased (-0.746371 --> -0.746371).  Saving model ...
Epoch: 16 cost time: 1.0050158500671387
Epoch: 16, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 17 cost time: 1.2057790756225586
Epoch: 17, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 0.9657509326934814
Epoch: 18, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.631 Vali Acc: 0.768 Test Loss: 0.631 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9769959449768066
Epoch: 19, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9616901874542236
Epoch: 20, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.603 Vali Acc: 0.790 Test Loss: 0.603 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 0.8448493480682373
Epoch: 21, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811588).  Saving model ...
Epoch: 22 cost time: 0.897120475769043
Epoch: 22, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 23 cost time: 1.1221492290496826
Epoch: 23, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1813194751739502
Epoch: 24, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.053513765335083
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 26 cost time: 1.1850450038909912
Epoch: 26, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.572 Vali Acc: 0.804 Test Loss: 0.572 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0365982055664062
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 1.0458836555480957
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 1.0742137432098389
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9846642017364502
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9885854721069336
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1264350414276123
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9210870265960693
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.065117359161377
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.163693904876709
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0160143375396729
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0346338748931885
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0575251579284668
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 620444
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6393983364105225
Epoch: 1, Steps: 9 | Train Loss: 1.563 Vali Loss: 1.405 Vali Acc: 0.297 Test Loss: 1.405 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 0.9089791774749756
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.307 Vali Acc: 0.464 Test Loss: 1.307 Test Acc: 0.464
Validation loss decreased (-0.297087 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 0.9902324676513672
Epoch: 3, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.191 Vali Acc: 0.457 Test Loss: 1.191 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1048061847686768
Epoch: 4, Steps: 9 | Train Loss: 1.097 Vali Loss: 1.112 Vali Acc: 0.493 Test Loss: 1.112 Test Acc: 0.493
Validation loss decreased (-0.463755 --> -0.492742).  Saving model ...
Epoch: 5 cost time: 0.9791741371154785
Epoch: 5, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.027 Vali Acc: 0.565 Test Loss: 1.027 Test Acc: 0.565
Validation loss decreased (-0.492742 --> -0.565207).  Saving model ...
Epoch: 6 cost time: 0.936931848526001
Epoch: 6, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.956 Vali Acc: 0.565 Test Loss: 0.956 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565208).  Saving model ...
Epoch: 7 cost time: 1.0261943340301514
Epoch: 7, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.942 Vali Acc: 0.616 Test Loss: 0.942 Test Acc: 0.616
Validation loss decreased (-0.565208 --> -0.615933).  Saving model ...
Epoch: 8 cost time: 1.0023472309112549
Epoch: 8, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.849 Vali Acc: 0.630 Test Loss: 0.849 Test Acc: 0.630
Validation loss decreased (-0.615933 --> -0.630426).  Saving model ...
Epoch: 9 cost time: 0.9588184356689453
Epoch: 9, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.834 Vali Acc: 0.696 Test Loss: 0.834 Test Acc: 0.696
Validation loss decreased (-0.630426 --> -0.695644).  Saving model ...
Epoch: 10 cost time: 1.0153172016143799
Epoch: 10, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.746 Vali Acc: 0.710 Test Loss: 0.746 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710137).  Saving model ...
Epoch: 11 cost time: 0.8247864246368408
Epoch: 11, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.713 Vali Acc: 0.688 Test Loss: 0.713 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0976157188415527
Epoch: 12, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.691 Vali Acc: 0.681 Test Loss: 0.691 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8595108985900879
Epoch: 13, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.674 Vali Acc: 0.725 Test Loss: 0.674 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 14 cost time: 0.9104452133178711
Epoch: 14, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.658 Vali Acc: 0.725 Test Loss: 0.658 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 15 cost time: 0.9836766719818115
Epoch: 15, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760864).  Saving model ...
Epoch: 16 cost time: 0.8844776153564453
Epoch: 16, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.594 Vali Acc: 0.768 Test Loss: 0.594 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 17 cost time: 1.0918807983398438
Epoch: 17, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.638 Vali Acc: 0.754 Test Loss: 0.638 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.37697172164917
Epoch: 18, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.597 Vali Acc: 0.754 Test Loss: 0.597 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.080282211303711
Epoch: 19, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.668 Vali Acc: 0.754 Test Loss: 0.668 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2374818325042725
Epoch: 20, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0365679264068604
Epoch: 21, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.671 Vali Acc: 0.797 Test Loss: 0.671 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797095).  Saving model ...
Epoch: 22 cost time: 0.9359374046325684
Epoch: 22, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 1.096534013748169
Epoch: 23, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.633 Vali Acc: 0.797 Test Loss: 0.633 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9373035430908203
Epoch: 24, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0845353603363037
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0644958019256592
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9513447284698486
Epoch: 27, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1288628578186035
Epoch: 28, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.588 Vali Acc: 0.797 Test Loss: 0.588 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9401938915252686
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 30 cost time: 0.8618412017822266
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.064563274383545
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9240598678588867
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.804527997970581
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 34 cost time: 0.9861264228820801
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7811233997344971
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0272905826568604
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0745975971221924
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.578 Vali Acc: 0.826 Test Loss: 0.578 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9566798210144043
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 0.9680962562561035
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.0224990844726562
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.164698839187622
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.040980339050293
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1216042041778564
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 1.0831568241119385
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2110693454742432
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 46 cost time: 1.2913424968719482
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0653457641601562
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 48 cost time: 0.8996682167053223
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.017768383026123
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 50 cost time: 1.3724088668823242
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.841 Test Loss: 0.606 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9334547519683838
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1262845993041992
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1452176570892334
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.295769214630127
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.0897057056427002
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1167247295379639
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.848 Test Loss: 0.607 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 57 cost time: 1.1697585582733154
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2111461162567139
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9908499717712402
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8385627269744873
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.848 Test Loss: 0.613 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.917111873626709
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.848 Test Loss: 0.618 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9654660224914551
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.848 Test Loss: 0.586 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 63 cost time: 0.9420015811920166
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0407602787017822
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.841 Test Loss: 0.658 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1726675033569336
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.855 Test Loss: 0.598 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 66 cost time: 0.9972660541534424
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.070441722869873
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.848 Test Loss: 0.631 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0507712364196777
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855067).  Saving model ...
Epoch: 69 cost time: 0.9771358966827393
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0273635387420654
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.848 Test Loss: 0.644 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.1519289016723633
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.0127959251403809
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.9498608112335205
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 74 cost time: 0.9695608615875244
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.855 Test Loss: 0.611 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9386591911315918
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.855 Test Loss: 0.613 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9308700561523438
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.855 Test Loss: 0.617 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9027025699615479
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.855 Test Loss: 0.620 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.1486284732818604
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.9357130527496338
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.848 Test Loss: 0.623 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.9290049076080322
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.855 Test Loss: 0.623 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.0622210502624512
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.855 Test Loss: 0.634 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.2563002109527588
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.855 Test Loss: 0.626 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.299281120300293
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.855 Test Loss: 0.598 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 619292
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7562003135681152
Epoch: 1, Steps: 9 | Train Loss: 1.527 Vali Loss: 1.399 Vali Acc: 0.232 Test Loss: 1.399 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.9430127143859863
Epoch: 2, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.380 Vali Acc: 0.225 Test Loss: 1.380 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9994196891784668
Epoch: 3, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.234 Vali Acc: 0.428 Test Loss: 1.234 Test Acc: 0.428
Validation loss decreased (-0.231870 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 1.0838627815246582
Epoch: 4, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.149 Vali Acc: 0.471 Test Loss: 1.149 Test Acc: 0.471
Validation loss decreased (-0.427524 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 1.157911777496338
Epoch: 5, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.069 Vali Acc: 0.623 Test Loss: 1.069 Test Acc: 0.623
Validation loss decreased (-0.471003 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 1.0888149738311768
Epoch: 6, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.992 Vali Acc: 0.594 Test Loss: 0.992 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1207711696624756
Epoch: 7, Steps: 9 | Train Loss: 0.852 Vali Loss: 0.941 Vali Acc: 0.536 Test Loss: 0.941 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.202683925628662
Epoch: 8, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.882 Vali Acc: 0.667 Test Loss: 0.882 Test Acc: 0.667
Validation loss decreased (-0.623178 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 0.9852719306945801
Epoch: 9, Steps: 9 | Train Loss: 0.641 Vali Loss: 0.823 Vali Acc: 0.609 Test Loss: 0.823 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2963707447052002
Epoch: 10, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 11 cost time: 1.1850721836090088
Epoch: 11, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.724 Vali Acc: 0.681 Test Loss: 0.724 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 12 cost time: 0.957085132598877
Epoch: 12, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.676 Vali Acc: 0.725 Test Loss: 0.676 Test Acc: 0.725
Validation loss decreased (-0.681152 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 1.2228007316589355
Epoch: 13, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.661 Vali Acc: 0.696 Test Loss: 0.661 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.945570707321167
Epoch: 14, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.681 Vali Acc: 0.710 Test Loss: 0.681 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.144139051437378
Epoch: 15, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.627 Vali Acc: 0.754 Test Loss: 0.627 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 1.1172103881835938
Epoch: 16, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.597 Vali Acc: 0.768 Test Loss: 0.597 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 17 cost time: 1.169135332107544
Epoch: 17, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 0.9838447570800781
Epoch: 18, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.585 Vali Acc: 0.768 Test Loss: 0.585 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9500341415405273
Epoch: 19, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.571 Vali Acc: 0.804 Test Loss: 0.571 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 20 cost time: 0.933358907699585
Epoch: 20, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.597 Vali Acc: 0.768 Test Loss: 0.597 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9217333793640137
Epoch: 21, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1199438571929932
Epoch: 22, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 23 cost time: 0.8693084716796875
Epoch: 23, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.603 Vali Acc: 0.768 Test Loss: 0.603 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0446374416351318
Epoch: 24, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 25 cost time: 0.9400129318237305
Epoch: 25, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0894262790679932
Epoch: 26, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0372421741485596
Epoch: 27, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2048077583312988
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8574111461639404
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9734756946563721
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.566 Vali Acc: 0.826 Test Loss: 0.566 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0764923095703125
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.210756540298462
Epoch: 32, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9922530651092529
Epoch: 33, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0678431987762451
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 424604
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.397536277770996
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.377 Vali Acc: 0.290 Test Loss: 1.377 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.0524110794067383
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.306 Vali Acc: 0.406 Test Loss: 1.306 Test Acc: 0.406
Validation loss decreased (-0.289841 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.9519200325012207
Epoch: 3, Steps: 9 | Train Loss: 1.242 Vali Loss: 1.227 Vali Acc: 0.471 Test Loss: 1.227 Test Acc: 0.471
Validation loss decreased (-0.405784 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.8979926109313965
Epoch: 4, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.144 Vali Acc: 0.493 Test Loss: 1.144 Test Acc: 0.493
Validation loss decreased (-0.471002 --> -0.492742).  Saving model ...
Epoch: 5 cost time: 0.9663300514221191
Epoch: 5, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.071 Vali Acc: 0.572 Test Loss: 1.071 Test Acc: 0.572
Validation loss decreased (-0.492742 --> -0.572453).  Saving model ...
Epoch: 6 cost time: 0.8842127323150635
Epoch: 6, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.019 Vali Acc: 0.565 Test Loss: 1.019 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0588607788085938
Epoch: 7, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.955 Vali Acc: 0.659 Test Loss: 0.955 Test Acc: 0.659
Validation loss decreased (-0.572453 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 0.953026294708252
Epoch: 8, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.888 Vali Acc: 0.609 Test Loss: 0.888 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1344218254089355
Epoch: 9, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.833 Vali Acc: 0.667 Test Loss: 0.833 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 1.154747486114502
Epoch: 10, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.794 Vali Acc: 0.688 Test Loss: 0.794 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 0.9620897769927979
Epoch: 11, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.736 Vali Acc: 0.681 Test Loss: 0.736 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0937962532043457
Epoch: 12, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.714 Vali Acc: 0.703 Test Loss: 0.714 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 0.8939127922058105
Epoch: 13, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 1.0575191974639893
Epoch: 14, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.644 Vali Acc: 0.725 Test Loss: 0.644 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 15 cost time: 0.7945511341094971
Epoch: 15, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0738306045532227
Epoch: 16, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.577 Vali Acc: 0.754 Test Loss: 0.577 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 17 cost time: 1.1095077991485596
Epoch: 17, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1166744232177734
Epoch: 18, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.625 Vali Acc: 0.703 Test Loss: 0.625 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2519521713256836
Epoch: 19, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0443229675292969
Epoch: 20, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.580 Vali Acc: 0.739 Test Loss: 0.580 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0619587898254395
Epoch: 21, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.579 Vali Acc: 0.739 Test Loss: 0.579 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0138654708862305
Epoch: 22, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.601 Vali Acc: 0.761 Test Loss: 0.601 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 23 cost time: 0.861147403717041
Epoch: 23, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9504733085632324
Epoch: 24, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.538 Vali Acc: 0.754 Test Loss: 0.538 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0980236530303955
Epoch: 25, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.554 Vali Acc: 0.797 Test Loss: 0.554 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797096).  Saving model ...
Epoch: 26 cost time: 0.9757986068725586
Epoch: 26, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.576 Vali Acc: 0.754 Test Loss: 0.576 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2319917678833008
Epoch: 27, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0622787475585938
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.775 Test Loss: 0.577 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.957888126373291
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0521254539489746
Epoch: 30, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 31 cost time: 0.9722607135772705
Epoch: 31, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.601 Vali Acc: 0.775 Test Loss: 0.601 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0878427028656006
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 33 cost time: 0.8832077980041504
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 34 cost time: 1.1900949478149414
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9376444816589355
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2305595874786377
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.308150053024292
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0700693130493164
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.179595708847046
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1724045276641846
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.050658941268921
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7931725978851318
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1084563732147217
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 423452
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.728423595428467
Epoch: 1, Steps: 9 | Train Loss: 1.518 Vali Loss: 1.373 Vali Acc: 0.355 Test Loss: 1.373 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.8952550888061523
Epoch: 2, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.301 Vali Acc: 0.435 Test Loss: 1.301 Test Acc: 0.435
Validation loss decreased (-0.355059 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 1.0194299221038818
Epoch: 3, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.225 Vali Acc: 0.493 Test Loss: 1.225 Test Acc: 0.493
Validation loss decreased (-0.434770 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 0.9053573608398438
Epoch: 4, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.122 Vali Acc: 0.601 Test Loss: 1.122 Test Acc: 0.601
Validation loss decreased (-0.492741 --> -0.601438).  Saving model ...
Epoch: 5 cost time: 0.9127204418182373
Epoch: 5, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.059 Vali Acc: 0.623 Test Loss: 1.059 Test Acc: 0.623
Validation loss decreased (-0.601438 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 1.0131621360778809
Epoch: 6, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.976 Vali Acc: 0.638 Test Loss: 0.976 Test Acc: 0.638
Validation loss decreased (-0.623178 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 0.8101415634155273
Epoch: 7, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.910 Vali Acc: 0.659 Test Loss: 0.910 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 0.8463671207427979
Epoch: 8, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.854 Vali Acc: 0.667 Test Loss: 0.854 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 0.9259428977966309
Epoch: 9, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 1.0715861320495605
Epoch: 10, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.773 Vali Acc: 0.681 Test Loss: 0.773 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8124074935913086
Epoch: 11, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.704 Vali Acc: 0.725 Test Loss: 0.704 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 0.752338171005249
Epoch: 12, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.698 Vali Acc: 0.688 Test Loss: 0.698 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9049851894378662
Epoch: 13, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.649 Vali Acc: 0.710 Test Loss: 0.649 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.893251895904541
Epoch: 14, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.622 Vali Acc: 0.725 Test Loss: 0.622 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724631).  Saving model ...
Epoch: 15 cost time: 0.9217591285705566
Epoch: 15, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.637 Vali Acc: 0.717 Test Loss: 0.637 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1146585941314697
Epoch: 16, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.617 Vali Acc: 0.754 Test Loss: 0.617 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 17 cost time: 0.9304430484771729
Epoch: 17, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.584 Vali Acc: 0.775 Test Loss: 0.584 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775356).  Saving model ...
Epoch: 18 cost time: 0.793886661529541
Epoch: 18, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.603 Vali Acc: 0.768 Test Loss: 0.603 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3218913078308105
Epoch: 19, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.595 Vali Acc: 0.775 Test Loss: 0.595 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.939155101776123
Epoch: 20, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.575 Vali Acc: 0.768 Test Loss: 0.575 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9335064888000488
Epoch: 21, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 22 cost time: 0.9140584468841553
Epoch: 22, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0878973007202148
Epoch: 23, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 24 cost time: 1.0794808864593506
Epoch: 24, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.979907751083374
Epoch: 25, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 26 cost time: 0.8093883991241455
Epoch: 26, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9998865127563477
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9628229141235352
Epoch: 28, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.603 Vali Acc: 0.797 Test Loss: 0.603 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.982194185256958
Epoch: 29, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9422528743743896
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9772162437438965
Epoch: 31, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.611 Vali Acc: 0.812 Test Loss: 0.611 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8565404415130615
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9325861930847168
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9252421855926514
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0192654132843018
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 422300
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0140180587768555
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.331 Vali Acc: 0.413 Test Loss: 1.331 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 1.244356632232666
Epoch: 2, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.285 Vali Acc: 0.312 Test Loss: 1.285 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0904431343078613
Epoch: 3, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.192 Vali Acc: 0.507 Test Loss: 1.192 Test Acc: 0.507
Validation loss decreased (-0.413030 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 0.9898910522460938
Epoch: 4, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.507234 --> -0.514482).  Saving model ...
Epoch: 5 cost time: 0.9795327186584473
Epoch: 5, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.055 Vali Acc: 0.630 Test Loss: 1.055 Test Acc: 0.630
Validation loss decreased (-0.514482 --> -0.630424).  Saving model ...
Epoch: 6 cost time: 0.9399020671844482
Epoch: 6, Steps: 9 | Train Loss: 0.890 Vali Loss: 0.986 Vali Acc: 0.587 Test Loss: 0.986 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1814587116241455
Epoch: 7, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.925 Vali Acc: 0.652 Test Loss: 0.925 Test Acc: 0.652
Validation loss decreased (-0.630424 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 0.9240114688873291
Epoch: 8, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.885 Vali Acc: 0.681 Test Loss: 0.885 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681151).  Saving model ...
Epoch: 9 cost time: 1.1713871955871582
Epoch: 9, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.818 Vali Acc: 0.674 Test Loss: 0.818 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9500598907470703
Epoch: 10, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.784 Vali Acc: 0.696 Test Loss: 0.784 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 11 cost time: 0.9349696636199951
Epoch: 11, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.747 Vali Acc: 0.696 Test Loss: 0.747 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695645).  Saving model ...
Epoch: 12 cost time: 1.1038153171539307
Epoch: 12, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 0.9952106475830078
Epoch: 13, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.672 Vali Acc: 0.703 Test Loss: 0.672 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.043924331665039
Epoch: 14, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 15 cost time: 0.9595015048980713
Epoch: 15, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.621 Vali Acc: 0.739 Test Loss: 0.621 Test Acc: 0.739
Validation loss decreased (-0.717385 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 0.9178483486175537
Epoch: 16, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.644 Vali Acc: 0.746 Test Loss: 0.644 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 17 cost time: 0.9529504776000977
Epoch: 17, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.029550552368164
Epoch: 18, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.600 Vali Acc: 0.761 Test Loss: 0.600 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760864).  Saving model ...
Epoch: 19 cost time: 1.1363110542297363
Epoch: 19, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.617 Vali Acc: 0.754 Test Loss: 0.617 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0057456493377686
Epoch: 20, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1539547443389893
Epoch: 21, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.579 Vali Acc: 0.754 Test Loss: 0.579 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.011561632156372
Epoch: 22, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1513090133666992
Epoch: 23, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782603).  Saving model ...
Epoch: 24 cost time: 1.0258841514587402
Epoch: 24, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9243044853210449
Epoch: 25, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 26 cost time: 0.8612029552459717
Epoch: 26, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.572 Vali Acc: 0.790 Test Loss: 0.572 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 27 cost time: 1.1069042682647705
Epoch: 27, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0262649059295654
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 29 cost time: 0.9717049598693848
Epoch: 29, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1344795227050781
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.595 Vali Acc: 0.790 Test Loss: 0.595 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9541587829589844
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.624 Vali Acc: 0.790 Test Loss: 0.624 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.166529893875122
Epoch: 32, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.617 Vali Acc: 0.790 Test Loss: 0.617 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.068617582321167
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.804 Test Loss: 0.582 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 34 cost time: 1.1007599830627441
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.581 Vali Acc: 0.797 Test Loss: 0.581 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9593250751495361
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 36 cost time: 0.9953150749206543
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1575429439544678
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 38 cost time: 1.2890384197235107
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 39 cost time: 0.8725652694702148
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0187039375305176
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.292832612991333
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0551958084106445
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 43 cost time: 0.9184527397155762
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9703071117401123
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 45 cost time: 0.9129035472869873
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 46 cost time: 1.1557176113128662
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0512335300445557
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 48 cost time: 1.0069048404693604
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0232810974121094
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8779740333557129
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.177236557006836
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.3503422737121582
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0887784957885742
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.826 Test Loss: 0.616 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0345993041992188
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2163138389587402
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9976119995117188
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.0527019500732422
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 421148
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0201661586761475
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.321 Vali Acc: 0.384 Test Loss: 1.321 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.0014750957489014
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.261 Vali Acc: 0.391 Test Loss: 1.261 Test Acc: 0.391
Validation loss decreased (-0.384045 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 0.85357666015625
Epoch: 3, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.195 Vali Acc: 0.435 Test Loss: 1.195 Test Acc: 0.435
Validation loss decreased (-0.391292 --> -0.434771).  Saving model ...
Epoch: 4 cost time: 1.0904834270477295
Epoch: 4, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.132 Vali Acc: 0.486 Test Loss: 1.132 Test Acc: 0.486
Validation loss decreased (-0.434771 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 1.0201911926269531
Epoch: 5, Steps: 9 | Train Loss: 1.041 Vali Loss: 1.067 Vali Acc: 0.493 Test Loss: 1.067 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492743).  Saving model ...
Epoch: 6 cost time: 0.8401401042938232
Epoch: 6, Steps: 9 | Train Loss: 0.951 Vali Loss: 1.005 Vali Acc: 0.572 Test Loss: 1.005 Test Acc: 0.572
Validation loss decreased (-0.492743 --> -0.572454).  Saving model ...
Epoch: 7 cost time: 1.0505564212799072
Epoch: 7, Steps: 9 | Train Loss: 0.840 Vali Loss: 0.962 Vali Acc: 0.594 Test Loss: 0.962 Test Acc: 0.594
Validation loss decreased (-0.572454 --> -0.594193).  Saving model ...
Epoch: 8 cost time: 0.8896605968475342
Epoch: 8, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.912 Vali Acc: 0.616 Test Loss: 0.912 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615933).  Saving model ...
Epoch: 9 cost time: 1.0149548053741455
Epoch: 9, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.876 Vali Acc: 0.630 Test Loss: 0.876 Test Acc: 0.630
Validation loss decreased (-0.615933 --> -0.630426).  Saving model ...
Epoch: 10 cost time: 1.2325310707092285
Epoch: 10, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.839 Vali Acc: 0.652 Test Loss: 0.839 Test Acc: 0.652
Validation loss decreased (-0.630426 --> -0.652166).  Saving model ...
Epoch: 11 cost time: 1.0052928924560547
Epoch: 11, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.781 Vali Acc: 0.674 Test Loss: 0.781 Test Acc: 0.674
Validation loss decreased (-0.652166 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 1.1239228248596191
Epoch: 12, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.759 Vali Acc: 0.696 Test Loss: 0.759 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 13 cost time: 0.9900670051574707
Epoch: 13, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.707 Vali Acc: 0.703 Test Loss: 0.707 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 0.9981837272644043
Epoch: 14, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 15 cost time: 0.916921854019165
Epoch: 15, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.650 Vali Acc: 0.725 Test Loss: 0.650 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9442338943481445
Epoch: 16, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0611796379089355
Epoch: 17, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.626 Vali Acc: 0.725 Test Loss: 0.626 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1973974704742432
Epoch: 18, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1789734363555908
Epoch: 19, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.622 Vali Acc: 0.710 Test Loss: 0.622 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.213913917541504
Epoch: 20, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746371).  Saving model ...
Epoch: 21 cost time: 1.012603998184204
Epoch: 21, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.746371 --> -0.746371).  Saving model ...
Epoch: 22 cost time: 0.9191372394561768
Epoch: 22, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.660 Vali Acc: 0.746 Test Loss: 0.660 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2018160820007324
Epoch: 23, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.576 Vali Acc: 0.754 Test Loss: 0.576 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 24 cost time: 1.2315771579742432
Epoch: 24, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.591 Vali Acc: 0.768 Test Loss: 0.591 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 25 cost time: 1.0754845142364502
Epoch: 25, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1736583709716797
Epoch: 26, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.604 Vali Acc: 0.754 Test Loss: 0.604 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0309138298034668
Epoch: 27, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.594 Vali Acc: 0.790 Test Loss: 0.594 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 28 cost time: 1.0502800941467285
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.627 Vali Acc: 0.754 Test Loss: 0.627 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9864282608032227
Epoch: 29, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.604 Vali Acc: 0.768 Test Loss: 0.604 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9547712802886963
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.944216251373291
Epoch: 31, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9721307754516602
Epoch: 32, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.613 Vali Acc: 0.790 Test Loss: 0.613 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1470131874084473
Epoch: 33, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9523811340332031
Epoch: 34, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.594 Vali Acc: 0.790 Test Loss: 0.594 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1541564464569092
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.602 Vali Acc: 0.797 Test Loss: 0.602 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 36 cost time: 0.9703013896942139
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.612 Vali Acc: 0.797 Test Loss: 0.612 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1720044612884521
Epoch: 37, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.790 Test Loss: 0.604 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9420421123504639
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.790 Test Loss: 0.606 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8811793327331543
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.797 Test Loss: 0.592 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 40 cost time: 0.9404656887054443
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0256028175354004
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.620 Vali Acc: 0.797 Test Loss: 0.620 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.14801025390625
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.607 Vali Acc: 0.797 Test Loss: 0.607 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0777356624603271
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 44 cost time: 0.9809234142303467
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 45 cost time: 0.9802920818328857
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.804 Test Loss: 0.593 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 46 cost time: 0.9765300750732422
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 47 cost time: 0.9486367702484131
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8613731861114502
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.804 Test Loss: 0.602 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8292512893676758
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.039292335510254
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.070568323135376
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0954539775848389
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 53 cost time: 1.0148000717163086
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 54 cost time: 0.9174931049346924
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.812 Test Loss: 0.608 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9164559841156006
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.121093511581421
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0720198154449463
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.812 Test Loss: 0.616 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.345379114151001
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.819 Test Loss: 0.619 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.0924222469329834
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9853227138519287
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1455092430114746
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9664552211761475
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833327).  Saving model ...
Epoch: 63 cost time: 1.081580638885498
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0778319835662842
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0156476497650146
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.039710283279419
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.826 Test Loss: 0.619 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.1292240619659424
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1304450035095215
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.826 Test Loss: 0.624 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.109760046005249
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.1253995895385742
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 71 cost time: 0.9263412952423096
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1332950592041016
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.9741480350494385
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0838122367858887
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1363024711608887
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.9703347682952881
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.2201817035675049
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.0370204448699951
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.9648635387420654
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 80 cost time: 1.0493686199188232
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.9468245506286621
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.0766544342041016
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.0392799377441406
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.848 Test Loss: 0.617 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.0450401306152344
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.848 Test Loss: 0.622 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.0242962837219238
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.276930332183838
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.848 Test Loss: 0.622 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.9824442863464355
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.848 Test Loss: 0.622 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.9294946193695068
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.855 Test Loss: 0.622 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 89 cost time: 1.0851414203643799
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.855 Test Loss: 0.618 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 90 cost time: 0.954291582107544
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.1254863739013672
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.841 Test Loss: 0.637 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.0604312419891357
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.1070375442504883
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.855 Test Loss: 0.620 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.9045505523681641
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.855 Test Loss: 0.616 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 95 cost time: 0.8850512504577637
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.855 Test Loss: 0.619 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.9804058074951172
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.0043835639953613
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.855 Test Loss: 0.627 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.9831986427307129
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.9103765487670898
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.862 Test Loss: 0.614 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862313).  Saving model ...
Epoch: 100 cost time: 0.881439208984375
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.862 Test Loss: 0.622 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 325532
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.081554651260376
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.325 Vali Acc: 0.384 Test Loss: 1.325 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.2604248523712158
Epoch: 2, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.272 Vali Acc: 0.464 Test Loss: 1.272 Test Acc: 0.464
Validation loss decreased (-0.384045 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 1.180284023284912
Epoch: 3, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.191 Vali Acc: 0.594 Test Loss: 1.191 Test Acc: 0.594
Validation loss decreased (-0.463755 --> -0.594191).  Saving model ...
Epoch: 4 cost time: 1.1095378398895264
Epoch: 4, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.132 Vali Acc: 0.623 Test Loss: 1.132 Test Acc: 0.623
Validation loss decreased (-0.594191 --> -0.623177).  Saving model ...
Epoch: 5 cost time: 1.321500301361084
Epoch: 5, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.071 Vali Acc: 0.587 Test Loss: 1.071 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1506402492523193
Epoch: 6, Steps: 9 | Train Loss: 0.927 Vali Loss: 1.014 Vali Acc: 0.572 Test Loss: 1.014 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.008007287979126
Epoch: 7, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.961 Vali Acc: 0.616 Test Loss: 0.961 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9820618629455566
Epoch: 8, Steps: 9 | Train Loss: 0.746 Vali Loss: 0.905 Vali Acc: 0.645 Test Loss: 0.905 Test Acc: 0.645
Validation loss decreased (-0.623177 --> -0.644918).  Saving model ...
Epoch: 9 cost time: 1.0698192119598389
Epoch: 9, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.866 Vali Acc: 0.652 Test Loss: 0.866 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 1.2475802898406982
Epoch: 10, Steps: 9 | Train Loss: 0.584 Vali Loss: 0.816 Vali Acc: 0.688 Test Loss: 0.816 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 1.0220961570739746
Epoch: 11, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.767 Vali Acc: 0.696 Test Loss: 0.767 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695644).  Saving model ...
Epoch: 12 cost time: 1.0905649662017822
Epoch: 12, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.744 Vali Acc: 0.674 Test Loss: 0.744 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1617834568023682
Epoch: 13, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.747 Vali Acc: 0.674 Test Loss: 0.747 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0913927555084229
Epoch: 14, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.673 Vali Acc: 0.688 Test Loss: 0.673 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2455706596374512
Epoch: 15, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.678 Vali Acc: 0.725 Test Loss: 0.678 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724631).  Saving model ...
Epoch: 16 cost time: 1.1518115997314453
Epoch: 16, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.629 Vali Acc: 0.710 Test Loss: 0.629 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0930266380310059
Epoch: 17, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3561625480651855
Epoch: 18, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.616 Vali Acc: 0.725 Test Loss: 0.616 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724632).  Saving model ...
Epoch: 19 cost time: 1.2098937034606934
Epoch: 19, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3881399631500244
Epoch: 20, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
Validation loss decreased (-0.724632 --> -0.760864).  Saving model ...
Epoch: 21 cost time: 1.2281477451324463
Epoch: 21, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.693 Vali Acc: 0.754 Test Loss: 0.693 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1863982677459717
Epoch: 22, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0353586673736572
Epoch: 23, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.584 Vali Acc: 0.775 Test Loss: 0.584 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775356).  Saving model ...
Epoch: 24 cost time: 1.1470322608947754
Epoch: 24, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 25 cost time: 1.2247188091278076
Epoch: 25, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.636 Vali Acc: 0.768 Test Loss: 0.636 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9926557540893555
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.581 Vali Acc: 0.790 Test Loss: 0.581 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 27 cost time: 1.338381052017212
Epoch: 27, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.624 Vali Acc: 0.768 Test Loss: 0.624 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1107065677642822
Epoch: 28, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.567 Vali Acc: 0.797 Test Loss: 0.567 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 29 cost time: 1.3699302673339844
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.633 Vali Acc: 0.768 Test Loss: 0.633 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9904851913452148
Epoch: 30, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9926772117614746
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.589 Vali Acc: 0.797 Test Loss: 0.589 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.126387357711792
Epoch: 32, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.568 Vali Acc: 0.790 Test Loss: 0.568 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0718967914581299
Epoch: 33, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.596 Vali Acc: 0.790 Test Loss: 0.596 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9966697692871094
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0571892261505127
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.577 Vali Acc: 0.797 Test Loss: 0.577 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3168909549713135
Epoch: 36, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.577 Vali Acc: 0.797 Test Loss: 0.577 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9693865776062012
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.570 Vali Acc: 0.790 Test Loss: 0.570 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0632503032684326
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 324380
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7596514225006104
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.369 Vali Acc: 0.283 Test Loss: 1.369 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.2574725151062012
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.318 Vali Acc: 0.348 Test Loss: 1.318 Test Acc: 0.348
Validation loss decreased (-0.282595 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.2029919624328613
Epoch: 3, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.229 Vali Acc: 0.413 Test Loss: 1.229 Test Acc: 0.413
Validation loss decreased (-0.347813 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 0.995821475982666
Epoch: 4, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.145 Vali Acc: 0.572 Test Loss: 1.145 Test Acc: 0.572
Validation loss decreased (-0.413031 --> -0.572452).  Saving model ...
Epoch: 5 cost time: 0.9195652008056641
Epoch: 5, Steps: 9 | Train Loss: 1.019 Vali Loss: 1.067 Vali Acc: 0.594 Test Loss: 1.067 Test Acc: 0.594
Validation loss decreased (-0.572452 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 1.0714523792266846
Epoch: 6, Steps: 9 | Train Loss: 0.940 Vali Loss: 1.006 Vali Acc: 0.580 Test Loss: 1.006 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.120042085647583
Epoch: 7, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.959 Vali Acc: 0.594 Test Loss: 0.959 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594193).  Saving model ...
Epoch: 8 cost time: 0.9840757846832275
Epoch: 8, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.906 Vali Acc: 0.638 Test Loss: 0.906 Test Acc: 0.638
Validation loss decreased (-0.594193 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 1.0377910137176514
Epoch: 9, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.842 Vali Acc: 0.667 Test Loss: 0.842 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 1.328037977218628
Epoch: 10, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.787 Vali Acc: 0.667 Test Loss: 0.787 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666659).  Saving model ...
Epoch: 11 cost time: 0.9810013771057129
Epoch: 11, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.775 Vali Acc: 0.667 Test Loss: 0.775 Test Acc: 0.667
Validation loss decreased (-0.666659 --> -0.666659).  Saving model ...
Epoch: 12 cost time: 0.972517728805542
Epoch: 12, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.730 Vali Acc: 0.681 Test Loss: 0.730 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681152).  Saving model ...
Epoch: 13 cost time: 1.1859443187713623
Epoch: 13, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.696 Vali Acc: 0.710 Test Loss: 0.696 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 14 cost time: 1.0316030979156494
Epoch: 14, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.712 Vali Acc: 0.696 Test Loss: 0.712 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1780612468719482
Epoch: 15, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 16 cost time: 1.0881948471069336
Epoch: 16, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.667 Vali Acc: 0.710 Test Loss: 0.667 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.085240364074707
Epoch: 17, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.731878 --> -0.760864).  Saving model ...
Epoch: 18 cost time: 0.933429479598999
Epoch: 18, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0045361518859863
Epoch: 19, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.053934097290039
Epoch: 20, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.578 Vali Acc: 0.739 Test Loss: 0.578 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1505911350250244
Epoch: 21, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.578 Vali Acc: 0.768 Test Loss: 0.578 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 22 cost time: 0.9315013885498047
Epoch: 22, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.580 Vali Acc: 0.739 Test Loss: 0.580 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9482347965240479
Epoch: 23, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.570 Vali Acc: 0.790 Test Loss: 0.570 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 24 cost time: 0.9752299785614014
Epoch: 24, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.613 Vali Acc: 0.739 Test Loss: 0.613 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0050418376922607
Epoch: 25, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.580 Vali Acc: 0.790 Test Loss: 0.580 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1089255809783936
Epoch: 26, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 27 cost time: 1.0342886447906494
Epoch: 27, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.626 Vali Acc: 0.775 Test Loss: 0.626 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0611650943756104
Epoch: 28, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1367571353912354
Epoch: 29, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.542 Vali Acc: 0.790 Test Loss: 0.542 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9664433002471924
Epoch: 30, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.576 Vali Acc: 0.790 Test Loss: 0.576 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1752448081970215
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 32 cost time: 1.1524250507354736
Epoch: 32, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2166836261749268
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9895923137664795
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 35 cost time: 0.885697603225708
Epoch: 35, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2530364990234375
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2157368659973145
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.069256067276001
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 39 cost time: 1.0044429302215576
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0504889488220215
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.310300588607788
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 1.1592888832092285
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9879369735717773
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1147925853729248
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1412091255187988
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0698728561401367
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.147082805633545
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1825966835021973
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1843681335449219
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.132554054260254
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2579386234283447
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 323228
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.950277090072632
Epoch: 1, Steps: 9 | Train Loss: 1.491 Vali Loss: 1.435 Vali Acc: 0.290 Test Loss: 1.435 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.9454896450042725
Epoch: 2, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.364 Vali Acc: 0.362 Test Loss: 1.364 Test Acc: 0.362
Validation loss decreased (-0.289841 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 0.8806679248809814
Epoch: 3, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.280 Vali Acc: 0.435 Test Loss: 1.280 Test Acc: 0.435
Validation loss decreased (-0.362305 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 0.8372726440429688
Epoch: 4, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.216 Vali Acc: 0.420 Test Loss: 1.216 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1089117527008057
Epoch: 5, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.133 Vali Acc: 0.594 Test Loss: 1.133 Test Acc: 0.594
Validation loss decreased (-0.434770 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 0.9326131343841553
Epoch: 6, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.096 Vali Acc: 0.384 Test Loss: 1.096 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9175348281860352
Epoch: 7, Steps: 9 | Train Loss: 0.922 Vali Loss: 1.028 Vali Acc: 0.594 Test Loss: 1.028 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594193).  Saving model ...
Epoch: 8 cost time: 1.0842735767364502
Epoch: 8, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.950 Vali Acc: 0.572 Test Loss: 0.950 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1297402381896973
Epoch: 9, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.907 Vali Acc: 0.623 Test Loss: 0.907 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623179).  Saving model ...
Epoch: 10 cost time: 1.2748456001281738
Epoch: 10, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.841 Vali Acc: 0.659 Test Loss: 0.841 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659412).  Saving model ...
Epoch: 11 cost time: 0.9796111583709717
Epoch: 11, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.802 Vali Acc: 0.681 Test Loss: 0.802 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681151).  Saving model ...
Epoch: 12 cost time: 1.0779337882995605
Epoch: 12, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.746 Vali Acc: 0.659 Test Loss: 0.746 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8208212852478027
Epoch: 13, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.708 Vali Acc: 0.681 Test Loss: 0.708 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 0.9792289733886719
Epoch: 14, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.677 Vali Acc: 0.703 Test Loss: 0.677 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702892).  Saving model ...
Epoch: 15 cost time: 0.8713951110839844
Epoch: 15, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.704 Vali Acc: 0.696 Test Loss: 0.704 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.089634656906128
Epoch: 16, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
Validation loss decreased (-0.702892 --> -0.717385).  Saving model ...
Epoch: 17 cost time: 0.9226090908050537
Epoch: 17, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 18 cost time: 0.978919267654419
Epoch: 18, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.584 Vali Acc: 0.754 Test Loss: 0.584 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753617).  Saving model ...
Epoch: 19 cost time: 0.8877205848693848
Epoch: 19, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9451677799224854
Epoch: 20, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9538543224334717
Epoch: 21, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7688157558441162
Epoch: 22, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.617 Vali Acc: 0.768 Test Loss: 0.617 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 23 cost time: 0.8456127643585205
Epoch: 23, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775356).  Saving model ...
Epoch: 24 cost time: 0.8563501834869385
Epoch: 24, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.595 Vali Acc: 0.775 Test Loss: 0.595 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 25 cost time: 0.9634480476379395
Epoch: 25, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 26 cost time: 0.912492036819458
Epoch: 26, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 27 cost time: 0.850379228591919
Epoch: 27, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9125466346740723
Epoch: 28, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9307296276092529
Epoch: 29, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9384050369262695
Epoch: 30, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.579 Vali Acc: 0.797 Test Loss: 0.579 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 31 cost time: 0.9476721286773682
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8563618659973145
Epoch: 32, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 33 cost time: 0.8832032680511475
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.024122953414917
Epoch: 34, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 35 cost time: 1.0811781883239746
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 36 cost time: 0.8249597549438477
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 37 cost time: 0.7669472694396973
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.016270399093628
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0017120838165283
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 40 cost time: 0.8128366470336914
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 41 cost time: 0.944328784942627
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0723052024841309
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 43 cost time: 0.9422221183776855
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9564220905303955
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0161149501800537
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0509181022644043
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9264767169952393
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9602320194244385
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9914062023162842
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9423387050628662
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9146559238433838
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 52 cost time: 0.8906793594360352
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 53 cost time: 0.9298627376556396
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.081775188446045
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.074878454208374
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1185712814331055
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.848 Test Loss: 0.586 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9744417667388916
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 58 cost time: 0.8427555561065674
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.855 Test Loss: 0.583 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8032641410827637
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.94187331199646
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 61 cost time: 0.8147742748260498
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9066157341003418
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9550085067749023
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.855 Test Loss: 0.591 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9625186920166016
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.855 Test Loss: 0.583 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.194566249847412
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.2577009201049805
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.9011754989624023
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.9633009433746338
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8042340278625488
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.7604243755340576
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 71 cost time: 0.9457228183746338
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.862 Test Loss: 0.572 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 72 cost time: 0.9387056827545166
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.876347541809082
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.862 Test Loss: 0.587 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.0274591445922852
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9457237720489502
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.862 Test Loss: 0.582 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.8575913906097412
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.862 Test Loss: 0.590 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.8523507118225098
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.1414144039154053
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.862 Test Loss: 0.586 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.9913313388824463
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.987450122833252
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.05843186378479
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.870 Test Loss: 0.573 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869559).  Saving model ...
Epoch: 82 cost time: 0.8993678092956543
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.887737512588501
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9740853309631348
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8906865119934082
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.870 Test Loss: 0.592 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.9398922920227051
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.862 Test Loss: 0.604 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.9370262622833252
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.862 Test Loss: 0.600 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.0878362655639648
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.862 Test Loss: 0.602 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.9068331718444824
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.862 Test Loss: 0.609 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.9613902568817139
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.862 Test Loss: 0.613 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.1436476707458496
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.870 Test Loss: 0.606 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 322076
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0903096199035645
Epoch: 1, Steps: 9 | Train Loss: 1.549 Vali Loss: 1.393 Vali Acc: 0.232 Test Loss: 1.393 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.9331967830657959
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.337 Vali Acc: 0.406 Test Loss: 1.337 Test Acc: 0.406
Validation loss decreased (-0.231870 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.1453187465667725
Epoch: 3, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.261 Vali Acc: 0.522 Test Loss: 1.261 Test Acc: 0.522
Validation loss decreased (-0.405784 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.0266587734222412
Epoch: 4, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.183 Vali Acc: 0.529 Test Loss: 1.183 Test Acc: 0.529
Validation loss decreased (-0.521727 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 0.9877054691314697
Epoch: 5, Steps: 9 | Train Loss: 1.124 Vali Loss: 1.123 Vali Acc: 0.522 Test Loss: 1.123 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.181959629058838
Epoch: 6, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.058 Vali Acc: 0.587 Test Loss: 1.058 Test Acc: 0.587
Validation loss decreased (-0.528974 --> -0.586946).  Saving model ...
Epoch: 7 cost time: 0.9819498062133789
Epoch: 7, Steps: 9 | Train Loss: 0.890 Vali Loss: 0.994 Vali Acc: 0.558 Test Loss: 0.994 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9123094081878662
Epoch: 8, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.936 Vali Acc: 0.645 Test Loss: 0.936 Test Acc: 0.645
Validation loss decreased (-0.586946 --> -0.644918).  Saving model ...
Epoch: 9 cost time: 0.8359806537628174
Epoch: 9, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.908 Vali Acc: 0.630 Test Loss: 0.908 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8303482532501221
Epoch: 10, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.869 Vali Acc: 0.638 Test Loss: 0.869 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9577994346618652
Epoch: 11, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.837 Vali Acc: 0.674 Test Loss: 0.837 Test Acc: 0.674
Validation loss decreased (-0.644918 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 0.9086453914642334
Epoch: 12, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.767 Vali Acc: 0.703 Test Loss: 0.767 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 1.0220344066619873
Epoch: 13, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.725 Vali Acc: 0.703 Test Loss: 0.725 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 1.0173676013946533
Epoch: 14, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 15 cost time: 1.0193955898284912
Epoch: 15, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717384).  Saving model ...
Epoch: 16 cost time: 0.846278190612793
Epoch: 16, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 17 cost time: 0.8781967163085938
Epoch: 17, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 18 cost time: 1.0322520732879639
Epoch: 18, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.719 Vali Acc: 0.710 Test Loss: 0.719 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8451998233795166
Epoch: 19, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.616 Vali Acc: 0.754 Test Loss: 0.616 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 20 cost time: 0.8917899131774902
Epoch: 20, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.899315357208252
Epoch: 21, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 22 cost time: 0.9410965442657471
Epoch: 22, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0194246768951416
Epoch: 23, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775356).  Saving model ...
Epoch: 24 cost time: 1.0111629962921143
Epoch: 24, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 25 cost time: 1.2020719051361084
Epoch: 25, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 26 cost time: 1.0634608268737793
Epoch: 26, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.644 Vali Acc: 0.746 Test Loss: 0.644 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0944874286651611
Epoch: 27, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818835).  Saving model ...
Epoch: 28 cost time: 0.9308121204376221
Epoch: 28, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.681 Vali Acc: 0.746 Test Loss: 0.681 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9587571620941162
Epoch: 29, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0623173713684082
Epoch: 30, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.614 Vali Acc: 0.790 Test Loss: 0.614 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.866008996963501
Epoch: 31, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8199014663696289
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.659 Vali Acc: 0.812 Test Loss: 0.659 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9450159072875977
Epoch: 33, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9526758193969727
Epoch: 34, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9433841705322266
Epoch: 35, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 36 cost time: 0.8325765132904053
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9858705997467041
Epoch: 37, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9683358669281006
Epoch: 38, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.619 Vali Acc: 0.819 Test Loss: 0.619 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9416341781616211
Epoch: 39, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4361755847930908
Epoch: 40, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.144115686416626
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.198369026184082
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2155201435089111
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.826 Test Loss: 0.606 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.062958002090454
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 45 cost time: 1.1762588024139404
Epoch: 45, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2241766452789307
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3766074180603027
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.833 Test Loss: 0.627 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3695714473724365
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 49 cost time: 1.212207317352295
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.480564832687378
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0218281745910645
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0735197067260742
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 53 cost time: 1.3855350017547607
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 54 cost time: 1.2201714515686035
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1262266635894775
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.308284044265747
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2161355018615723
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2316689491271973
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.841 Test Loss: 0.640 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1942403316497803
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.4998753070831299
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 61 cost time: 1.2604711055755615
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2915215492248535
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.848 Test Loss: 0.613 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.6766691207885742
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.848 Test Loss: 0.616 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.2399044036865234
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.848 Test Loss: 0.620 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.4134063720703125
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.1208381652832031
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.032696008682251
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.0440168380737305
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.841 Test Loss: 0.630 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.1681451797485352
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.177182912826538
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.848 Test Loss: 0.627 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 275996
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9307034015655518
Epoch: 1, Steps: 9 | Train Loss: 1.521 Vali Loss: 1.440 Vali Acc: 0.210 Test Loss: 1.440 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 1.1473631858825684
Epoch: 2, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.377 Vali Acc: 0.333 Test Loss: 1.377 Test Acc: 0.333
Validation loss decreased (-0.210131 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.9223647117614746
Epoch: 3, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.291 Vali Acc: 0.384 Test Loss: 1.291 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384045).  Saving model ...
Epoch: 4 cost time: 1.2363560199737549
Epoch: 4, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.214 Vali Acc: 0.471 Test Loss: 1.214 Test Acc: 0.471
Validation loss decreased (-0.384045 --> -0.471002).  Saving model ...
Epoch: 5 cost time: 1.2613821029663086
Epoch: 5, Steps: 9 | Train Loss: 1.100 Vali Loss: 1.138 Vali Acc: 0.493 Test Loss: 1.138 Test Acc: 0.493
Validation loss decreased (-0.471002 --> -0.492742).  Saving model ...
Epoch: 6 cost time: 1.0490708351135254
Epoch: 6, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.061 Vali Acc: 0.587 Test Loss: 1.061 Test Acc: 0.587
Validation loss decreased (-0.492742 --> -0.586946).  Saving model ...
Epoch: 7 cost time: 1.2304534912109375
Epoch: 7, Steps: 9 | Train Loss: 0.922 Vali Loss: 0.997 Vali Acc: 0.609 Test Loss: 0.997 Test Acc: 0.609
Validation loss decreased (-0.586946 --> -0.608686).  Saving model ...
Epoch: 8 cost time: 1.0446882247924805
Epoch: 8, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.940 Vali Acc: 0.536 Test Loss: 0.940 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9417436122894287
Epoch: 9, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.900 Vali Acc: 0.623 Test Loss: 0.900 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623179).  Saving model ...
Epoch: 10 cost time: 1.0704259872436523
Epoch: 10, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.871 Vali Acc: 0.572 Test Loss: 0.871 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0223255157470703
Epoch: 11, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.806 Vali Acc: 0.674 Test Loss: 0.806 Test Acc: 0.674
Validation loss decreased (-0.623179 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 1.0914101600646973
Epoch: 12, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.778 Vali Acc: 0.667 Test Loss: 0.778 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9782359600067139
Epoch: 13, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.759 Vali Acc: 0.710 Test Loss: 0.759 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710137).  Saving model ...
Epoch: 14 cost time: 1.1062383651733398
Epoch: 14, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.721 Vali Acc: 0.659 Test Loss: 0.721 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1027991771697998
Epoch: 15, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.701 Vali Acc: 0.732 Test Loss: 0.701 Test Acc: 0.732
Validation loss decreased (-0.710137 --> -0.731877).  Saving model ...
Epoch: 16 cost time: 1.1071712970733643
Epoch: 16, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.626 Vali Acc: 0.725 Test Loss: 0.626 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.037099838256836
Epoch: 17, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.689 Vali Acc: 0.710 Test Loss: 0.689 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2215917110443115
Epoch: 18, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.219520092010498
Epoch: 19, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5433435440063477
Epoch: 20, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.582 Vali Acc: 0.761 Test Loss: 0.582 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760864).  Saving model ...
Epoch: 21 cost time: 1.206413745880127
Epoch: 21, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.630 Vali Acc: 0.732 Test Loss: 0.630 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.16227388381958
Epoch: 22, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.611 Vali Acc: 0.754 Test Loss: 0.611 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3091721534729004
Epoch: 23, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.598 Vali Acc: 0.790 Test Loss: 0.598 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789849).  Saving model ...
Epoch: 24 cost time: 1.0087952613830566
Epoch: 24, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.609 Vali Acc: 0.739 Test Loss: 0.609 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8970472812652588
Epoch: 25, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 26 cost time: 1.298616647720337
Epoch: 26, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1018311977386475
Epoch: 27, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0062906742095947
Epoch: 28, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2502753734588623
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1302564144134521
Epoch: 30, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 31 cost time: 1.2863445281982422
Epoch: 31, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5515155792236328
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2178170680999756
Epoch: 33, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4614479541778564
Epoch: 34, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 35 cost time: 1.14213228225708
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0785441398620605
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2143235206604004
Epoch: 37, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.587 Vali Acc: 0.790 Test Loss: 0.587 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4510424137115479
Epoch: 38, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 39 cost time: 1.0855317115783691
Epoch: 39, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 40 cost time: 0.9693124294281006
Epoch: 40, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.025888442993164
Epoch: 41, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9798924922943115
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.587 Vali Acc: 0.804 Test Loss: 0.587 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.07551908493042
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.797 Test Loss: 0.596 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0473201274871826
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.107123613357544
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 46 cost time: 1.044790506362915
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.797 Test Loss: 0.581 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0453262329101562
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.804 Test Loss: 0.573 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1161892414093018
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1177031993865967
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2016825675964355
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.123169183731079
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.804 Test Loss: 0.575 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9161841869354248
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 53 cost time: 1.0162005424499512
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8918612003326416
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 55 cost time: 1.0047850608825684
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2494406700134277
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0401971340179443
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.3356966972351074
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.401087760925293
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 60 cost time: 1.0748882293701172
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 61 cost time: 1.1300697326660156
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 62 cost time: 1.3463332653045654
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3640191555023193
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.146733045578003
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1997790336608887
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.1289308071136475
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 67 cost time: 0.948007345199585
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.4225997924804688
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.3149333000183105
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.3062794208526611
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1718883514404297
Epoch: 71, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 72 cost time: 1.0617594718933105
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8642673492431641
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.1614019870758057
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.3612709045410156
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.2997384071350098
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 77 cost time: 1.124314785003662
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.9986016750335693
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9305310249328613
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.104060173034668
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.2490546703338623
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.1544458866119385
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.1493782997131348
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.1591556072235107
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.2795019149780273
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.123640775680542
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 87 cost time: 0.977097749710083
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 88 cost time: 1.1187524795532227
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 89 cost time: 1.1357975006103516
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.0539577007293701
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9728963375091553
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.166132926940918
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.1810410022735596
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.0998754501342773
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.8657395839691162
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.9301776885986328
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.004035234451294
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 98 cost time: 1.0599961280822754
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 99 cost time: 1.094905138015747
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.099843978881836
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 274844
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.033797025680542
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.395 Vali Acc: 0.268 Test Loss: 1.395 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.0719752311706543
Epoch: 2, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.339 Vali Acc: 0.348 Test Loss: 1.339 Test Acc: 0.348
Validation loss decreased (-0.268102 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.0145833492279053
Epoch: 3, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.253 Vali Acc: 0.428 Test Loss: 1.253 Test Acc: 0.428
Validation loss decreased (-0.347813 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.7663018703460693
Epoch: 4, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.204 Vali Acc: 0.428 Test Loss: 1.204 Test Acc: 0.428
Validation loss decreased (-0.427524 --> -0.427524).  Saving model ...
Epoch: 5 cost time: 0.9475498199462891
Epoch: 5, Steps: 9 | Train Loss: 1.112 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
Validation loss decreased (-0.427524 --> -0.514482).  Saving model ...
Epoch: 6 cost time: 0.8667850494384766
Epoch: 6, Steps: 9 | Train Loss: 0.981 Vali Loss: 1.039 Vali Acc: 0.565 Test Loss: 1.039 Test Acc: 0.565
Validation loss decreased (-0.514482 --> -0.565207).  Saving model ...
Epoch: 7 cost time: 0.9289267063140869
Epoch: 7, Steps: 9 | Train Loss: 0.840 Vali Loss: 0.975 Vali Acc: 0.609 Test Loss: 0.975 Test Acc: 0.609
Validation loss decreased (-0.565207 --> -0.608686).  Saving model ...
Epoch: 8 cost time: 0.9318671226501465
Epoch: 8, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.920 Vali Acc: 0.623 Test Loss: 0.920 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623179).  Saving model ...
Epoch: 9 cost time: 0.8874311447143555
Epoch: 9, Steps: 9 | Train Loss: 0.736 Vali Loss: 0.873 Vali Acc: 0.652 Test Loss: 0.873 Test Acc: 0.652
Validation loss decreased (-0.623179 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 0.9323654174804688
Epoch: 10, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.830 Vali Acc: 0.681 Test Loss: 0.830 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681151).  Saving model ...
Epoch: 11 cost time: 0.8053061962127686
Epoch: 11, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.805 Vali Acc: 0.572 Test Loss: 0.805 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8786313533782959
Epoch: 12, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.795 Vali Acc: 0.667 Test Loss: 0.795 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9732584953308105
Epoch: 13, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.727 Vali Acc: 0.681 Test Loss: 0.727 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 0.862102746963501
Epoch: 14, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.753 Vali Acc: 0.681 Test Loss: 0.753 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9310512542724609
Epoch: 15, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.689 Vali Acc: 0.710 Test Loss: 0.689 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 16 cost time: 0.9152474403381348
Epoch: 16, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 17 cost time: 0.8800597190856934
Epoch: 17, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746370).  Saving model ...
Epoch: 18 cost time: 0.7790720462799072
Epoch: 18, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3160479068756104
Epoch: 19, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0488696098327637
Epoch: 20, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9883081912994385
Epoch: 21, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.715 Vali Acc: 0.761 Test Loss: 0.715 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760862).  Saving model ...
Epoch: 22 cost time: 0.9328963756561279
Epoch: 22, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.599 Vali Acc: 0.739 Test Loss: 0.599 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0587420463562012
Epoch: 23, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8423285484313965
Epoch: 24, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.608 Vali Acc: 0.790 Test Loss: 0.608 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789849).  Saving model ...
Epoch: 25 cost time: 0.8782529830932617
Epoch: 25, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9297740459442139
Epoch: 26, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9265966415405273
Epoch: 27, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 28 cost time: 0.8524289131164551
Epoch: 28, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9701192378997803
Epoch: 29, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.604 Vali Acc: 0.797 Test Loss: 0.604 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8871829509735107
Epoch: 30, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.596 Vali Acc: 0.790 Test Loss: 0.596 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8904187679290771
Epoch: 31, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9174261093139648
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8179817199707031
Epoch: 33, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8096818923950195
Epoch: 34, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9180281162261963
Epoch: 35, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.649 Vali Acc: 0.790 Test Loss: 0.649 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9261183738708496
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8403692245483398
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 38 cost time: 0.970916748046875
Epoch: 38, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9231181144714355
Epoch: 39, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.623 Vali Acc: 0.804 Test Loss: 0.623 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9046742916107178
Epoch: 40, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.020465612411499
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.650 Vali Acc: 0.790 Test Loss: 0.650 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8567297458648682
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 43 cost time: 0.8026654720306396
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.804 Test Loss: 0.637 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9404001235961914
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8806056976318359
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8501937389373779
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.650 Vali Acc: 0.797 Test Loss: 0.650 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.92392897605896
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0080726146697998
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0375096797943115
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0826244354248047
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8788304328918457
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.9435279369354248
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 53 cost time: 0.8697762489318848
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 54 cost time: 0.9116358757019043
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9347448348999023
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 56 cost time: 0.8553998470306396
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.841 Test Loss: 0.636 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840573).  Saving model ...
Epoch: 57 cost time: 0.9539225101470947
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.97202467918396
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.841 Test Loss: 0.646 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1205956935882568
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.637 Vali Acc: 0.848 Test Loss: 0.637 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 60 cost time: 0.9598746299743652
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.841 Test Loss: 0.649 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8104298114776611
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.848 Test Loss: 0.650 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8830842971801758
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.848 Test Loss: 0.639 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8935580253601074
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.848 Test Loss: 0.640 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9260802268981934
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.848 Test Loss: 0.634 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 65 cost time: 1.1217987537384033
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.848 Test Loss: 0.632 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 66 cost time: 1.039062261581421
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.848 Test Loss: 0.651 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8506839275360107
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.848 Test Loss: 0.630 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 68 cost time: 0.9222157001495361
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.848 Test Loss: 0.641 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.042443037033081
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.848 Test Loss: 0.656 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.0791137218475342
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.848 Test Loss: 0.637 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.791466474533081
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.848 Test Loss: 0.628 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 72 cost time: 0.8071417808532715
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.848 Test Loss: 0.636 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.993741512298584
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.848 Test Loss: 0.637 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.054150104522705
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.848 Test Loss: 0.644 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9345896244049072
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.848 Test Loss: 0.639 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.1165237426757812
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.848 Test Loss: 0.639 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.996060848236084
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.848 Test Loss: 0.664 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.9183754920959473
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.848 Test Loss: 0.648 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.0670533180236816
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.855 Test Loss: 0.627 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 80 cost time: 0.927640438079834
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.855 Test Loss: 0.653 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.9075684547424316
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.855 Test Loss: 0.650 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.8763110637664795
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.848 Test Loss: 0.659 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.0416383743286133
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.848 Test Loss: 0.678 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.0813932418823242
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.855 Test Loss: 0.657 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.2390496730804443
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.855 Test Loss: 0.643 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.9245483875274658
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.855 Test Loss: 0.643 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.8399837017059326
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.855 Test Loss: 0.641 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.949434757232666
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.855 Test Loss: 0.641 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.8413417339324951
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.855 Test Loss: 0.636 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 273692
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.920746326446533
Epoch: 1, Steps: 9 | Train Loss: 1.520 Vali Loss: 1.370 Vali Acc: 0.290 Test Loss: 1.370 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.8855230808258057
Epoch: 2, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.341 Vali Acc: 0.341 Test Loss: 1.341 Test Acc: 0.341
Validation loss decreased (-0.289841 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.9223928451538086
Epoch: 3, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.254 Vali Acc: 0.457 Test Loss: 1.254 Test Acc: 0.457
Validation loss decreased (-0.340566 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 0.8687417507171631
Epoch: 4, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.184 Vali Acc: 0.399 Test Loss: 1.184 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9773211479187012
Epoch: 5, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.122 Vali Acc: 0.594 Test Loss: 1.122 Test Acc: 0.594
Validation loss decreased (-0.456509 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 1.1412250995635986
Epoch: 6, Steps: 9 | Train Loss: 0.973 Vali Loss: 1.056 Vali Acc: 0.464 Test Loss: 1.056 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1685936450958252
Epoch: 7, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.004 Vali Acc: 0.630 Test Loss: 1.004 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 8 cost time: 1.065168857574463
Epoch: 8, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.917 Vali Acc: 0.616 Test Loss: 0.917 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.960737943649292
Epoch: 9, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.880 Vali Acc: 0.630 Test Loss: 0.880 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630426).  Saving model ...
Epoch: 10 cost time: 1.0822088718414307
Epoch: 10, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.825 Vali Acc: 0.659 Test Loss: 0.825 Test Acc: 0.659
Validation loss decreased (-0.630426 --> -0.659412).  Saving model ...
Epoch: 11 cost time: 0.9173805713653564
Epoch: 11, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.792 Vali Acc: 0.652 Test Loss: 0.792 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8712284564971924
Epoch: 12, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 0.936873197555542
Epoch: 13, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.760 Vali Acc: 0.681 Test Loss: 0.760 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681152).  Saving model ...
Epoch: 14 cost time: 1.0373516082763672
Epoch: 14, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.725 Vali Acc: 0.681 Test Loss: 0.725 Test Acc: 0.681
Validation loss decreased (-0.681152 --> -0.681152).  Saving model ...
Epoch: 15 cost time: 1.1544301509857178
Epoch: 15, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.672 Vali Acc: 0.696 Test Loss: 0.672 Test Acc: 0.696
Validation loss decreased (-0.681152 --> -0.695645).  Saving model ...
Epoch: 16 cost time: 1.0009984970092773
Epoch: 16, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.707 Vali Acc: 0.703 Test Loss: 0.707 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 17 cost time: 0.9111249446868896
Epoch: 17, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.614 Vali Acc: 0.703 Test Loss: 0.614 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702892).  Saving model ...
Epoch: 18 cost time: 1.128885269165039
Epoch: 18, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.645 Vali Acc: 0.696 Test Loss: 0.645 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0545330047607422
Epoch: 19, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.632 Vali Acc: 0.739 Test Loss: 0.632 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 20 cost time: 0.9633316993713379
Epoch: 20, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.646 Vali Acc: 0.710 Test Loss: 0.646 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0445928573608398
Epoch: 21, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760863).  Saving model ...
Epoch: 22 cost time: 0.9696979522705078
Epoch: 22, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.592 Vali Acc: 0.754 Test Loss: 0.592 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9708857536315918
Epoch: 23, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.606 Vali Acc: 0.768 Test Loss: 0.606 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 24 cost time: 0.8636224269866943
Epoch: 24, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.976149320602417
Epoch: 25, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 26 cost time: 0.9553899765014648
Epoch: 26, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0859086513519287
Epoch: 27, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.611 Vali Acc: 0.761 Test Loss: 0.611 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9183294773101807
Epoch: 28, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1118547916412354
Epoch: 29, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.572 Vali Acc: 0.768 Test Loss: 0.572 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0684006214141846
Epoch: 30, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0901882648468018
Epoch: 31, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.587 Vali Acc: 0.797 Test Loss: 0.587 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 32 cost time: 0.9991798400878906
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.584 Vali Acc: 0.775 Test Loss: 0.584 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.098555326461792
Epoch: 33, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.611 Vali Acc: 0.797 Test Loss: 0.611 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1503605842590332
Epoch: 34, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 35 cost time: 0.8948969841003418
Epoch: 35, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818834).  Saving model ...
Epoch: 36 cost time: 0.9310262203216553
Epoch: 36, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.620 Vali Acc: 0.812 Test Loss: 0.620 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9969637393951416
Epoch: 37, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0109968185424805
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 39 cost time: 0.8973197937011719
Epoch: 39, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.804 Test Loss: 0.602 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8504540920257568
Epoch: 40, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0487802028656006
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 42 cost time: 0.9772512912750244
Epoch: 42, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8437082767486572
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1206583976745605
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0430831909179688
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.098876714706421
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 47 cost time: 0.9091551303863525
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8874108791351318
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0244696140289307
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0244503021240234
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.826 Test Loss: 0.615 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0010864734649658
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0336236953735352
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.841 Test Loss: 0.589 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 53 cost time: 1.0994420051574707
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0546927452087402
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9575579166412354
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1024363040924072
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 57 cost time: 1.2628755569458008
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0180108547210693
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1310508251190186
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1677446365356445
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.093282699584961
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.1189906597137451
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0447938442230225
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 64 cost time: 1.0025110244750977
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.000702142715454
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0452044010162354
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.0490634441375732
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 68 cost time: 0.9698150157928467
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9839134216308594
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9122254848480225
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.0063574314117432
Epoch: 71, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.848 Test Loss: 0.538 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 72 cost time: 0.8959200382232666
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.2071247100830078
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.9399604797363281
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.065762996673584
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9766116142272949
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.023993730545044
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.9877707958221436
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.0797569751739502
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.2704579830169678
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.1931684017181396
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 272540
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.663041353225708
Epoch: 1, Steps: 9 | Train Loss: 1.636 Vali Loss: 1.500 Vali Acc: 0.203 Test Loss: 1.500 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 0.8584144115447998
Epoch: 2, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.394 Vali Acc: 0.268 Test Loss: 1.394 Test Acc: 0.268
Validation loss decreased (-0.202884 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 0.9319813251495361
Epoch: 3, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.359 Vali Acc: 0.341 Test Loss: 1.359 Test Acc: 0.341
Validation loss decreased (-0.268102 --> -0.340566).  Saving model ...
Epoch: 4 cost time: 1.0182781219482422
Epoch: 4, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.298 Vali Acc: 0.362 Test Loss: 1.298 Test Acc: 0.362
Validation loss decreased (-0.340566 --> -0.362306).  Saving model ...
Epoch: 5 cost time: 1.0949265956878662
Epoch: 5, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.235 Vali Acc: 0.384 Test Loss: 1.235 Test Acc: 0.384
Validation loss decreased (-0.362306 --> -0.384046).  Saving model ...
Epoch: 6 cost time: 0.9549858570098877
Epoch: 6, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.164 Vali Acc: 0.457 Test Loss: 1.164 Test Acc: 0.457
Validation loss decreased (-0.384046 --> -0.456510).  Saving model ...
Epoch: 7 cost time: 1.1445417404174805
Epoch: 7, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.093 Vali Acc: 0.478 Test Loss: 1.093 Test Acc: 0.478
Validation loss decreased (-0.456510 --> -0.478250).  Saving model ...
Epoch: 8 cost time: 0.9700326919555664
Epoch: 8, Steps: 9 | Train Loss: 0.955 Vali Loss: 1.033 Vali Acc: 0.471 Test Loss: 1.033 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9040687084197998
Epoch: 9, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.968 Vali Acc: 0.609 Test Loss: 0.968 Test Acc: 0.609
Validation loss decreased (-0.478250 --> -0.608686).  Saving model ...
Epoch: 10 cost time: 0.8897984027862549
Epoch: 10, Steps: 9 | Train Loss: 0.781 Vali Loss: 0.913 Vali Acc: 0.594 Test Loss: 0.913 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1178467273712158
Epoch: 11, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.839 Vali Acc: 0.667 Test Loss: 0.839 Test Acc: 0.667
Validation loss decreased (-0.608686 --> -0.666658).  Saving model ...
Epoch: 12 cost time: 0.9578127861022949
Epoch: 12, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.785 Vali Acc: 0.681 Test Loss: 0.785 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681152).  Saving model ...
Epoch: 13 cost time: 1.0985476970672607
Epoch: 13, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.748 Vali Acc: 0.710 Test Loss: 0.748 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710137).  Saving model ...
Epoch: 14 cost time: 1.0109460353851318
Epoch: 14, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.718 Vali Acc: 0.681 Test Loss: 0.718 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0372309684753418
Epoch: 15, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.704 Vali Acc: 0.681 Test Loss: 0.704 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9722409248352051
Epoch: 16, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.692 Vali Acc: 0.703 Test Loss: 0.692 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.241426944732666
Epoch: 17, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.639 Vali Acc: 0.710 Test Loss: 0.639 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710139).  Saving model ...
Epoch: 18 cost time: 1.0674850940704346
Epoch: 18, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.683 Vali Acc: 0.725 Test Loss: 0.683 Test Acc: 0.725
Validation loss decreased (-0.710139 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 1.0596275329589844
Epoch: 19, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9089522361755371
Epoch: 20, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.647 Vali Acc: 0.761 Test Loss: 0.647 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 21 cost time: 0.8597991466522217
Epoch: 21, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.038177728652954
Epoch: 22, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782603).  Saving model ...
Epoch: 23 cost time: 1.0836737155914307
Epoch: 23, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.612 Vali Acc: 0.754 Test Loss: 0.612 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9360897541046143
Epoch: 24, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 0.8910989761352539
Epoch: 25, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 26 cost time: 1.057102918624878
Epoch: 26, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.585 Vali Acc: 0.797 Test Loss: 0.585 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9286270141601562
Epoch: 27, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0340631008148193
Epoch: 28, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 29 cost time: 0.8506128787994385
Epoch: 29, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 30 cost time: 1.03963041305542
Epoch: 30, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 31 cost time: 0.8906278610229492
Epoch: 31, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 32 cost time: 0.9310598373413086
Epoch: 32, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9049723148345947
Epoch: 33, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 34 cost time: 0.9667263031005859
Epoch: 34, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8202276229858398
Epoch: 35, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.12733793258667
Epoch: 36, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8047418594360352
Epoch: 37, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9208736419677734
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 39 cost time: 1.060807466506958
Epoch: 39, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 40 cost time: 0.8992321491241455
Epoch: 40, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.194735050201416
Epoch: 41, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3577709197998047
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 43 cost time: 0.9815530776977539
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.031914234161377
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.531 Vali Acc: 0.855 Test Loss: 0.531 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9517834186553955
Epoch: 45, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 46 cost time: 0.8278896808624268
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8605291843414307
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0328445434570312
Epoch: 48, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0734467506408691
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0229358673095703
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.005138635635376
Epoch: 51, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0010063648223877
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 53 cost time: 0.9380605220794678
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.941802978515625
Epoch: 54, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8940656185150146
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9310142993927002
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9864308834075928
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9134328365325928
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9388628005981445
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9750590324401855
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.8821306228637695
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9243097305297852
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 263772
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8618452548980713
Epoch: 1, Steps: 9 | Train Loss: 1.519 Vali Loss: 1.456 Vali Acc: 0.297 Test Loss: 1.456 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 1.2845463752746582
Epoch: 2, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.400 Vali Acc: 0.232 Test Loss: 1.400 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0122709274291992
Epoch: 3, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.345 Vali Acc: 0.268 Test Loss: 1.345 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.019932508468628
Epoch: 4, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.276 Vali Acc: 0.464 Test Loss: 1.276 Test Acc: 0.464
Validation loss decreased (-0.297087 --> -0.463755).  Saving model ...
Epoch: 5 cost time: 0.8681514263153076
Epoch: 5, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.221 Vali Acc: 0.529 Test Loss: 1.221 Test Acc: 0.529
Validation loss decreased (-0.463755 --> -0.528973).  Saving model ...
Epoch: 6 cost time: 0.9701478481292725
Epoch: 6, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.150 Vali Acc: 0.442 Test Loss: 1.150 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.007084608078003
Epoch: 7, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.069 Vali Acc: 0.572 Test Loss: 1.069 Test Acc: 0.572
Validation loss decreased (-0.528973 --> -0.572453).  Saving model ...
Epoch: 8 cost time: 0.8254132270812988
Epoch: 8, Steps: 9 | Train Loss: 0.927 Vali Loss: 1.003 Vali Acc: 0.609 Test Loss: 1.003 Test Acc: 0.609
Validation loss decreased (-0.572453 --> -0.608686).  Saving model ...
Epoch: 9 cost time: 1.028120994567871
Epoch: 9, Steps: 9 | Train Loss: 0.827 Vali Loss: 0.941 Vali Acc: 0.630 Test Loss: 0.941 Test Acc: 0.630
Validation loss decreased (-0.608686 --> -0.630425).  Saving model ...
Epoch: 10 cost time: 0.9693777561187744
Epoch: 10, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.891 Vali Acc: 0.645 Test Loss: 0.891 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644919).  Saving model ...
Epoch: 11 cost time: 0.9476535320281982
Epoch: 11, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.838 Vali Acc: 0.674 Test Loss: 0.838 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 1.075862169265747
Epoch: 12, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
Validation loss decreased (-0.673905 --> -0.717383).  Saving model ...
Epoch: 13 cost time: 0.9762167930603027
Epoch: 13, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.740 Vali Acc: 0.703 Test Loss: 0.740 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1723802089691162
Epoch: 14, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717384).  Saving model ...
Epoch: 15 cost time: 0.8652079105377197
Epoch: 15, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.689 Vali Acc: 0.725 Test Loss: 0.689 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 16 cost time: 0.8736081123352051
Epoch: 16, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1572492122650146
Epoch: 17, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.652 Vali Acc: 0.732 Test Loss: 0.652 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 18 cost time: 0.8358769416809082
Epoch: 18, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.627 Vali Acc: 0.739 Test Loss: 0.627 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739124).  Saving model ...
Epoch: 19 cost time: 1.0345838069915771
Epoch: 19, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.632 Vali Acc: 0.739 Test Loss: 0.632 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9936754703521729
Epoch: 20, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 21 cost time: 0.8650891780853271
Epoch: 21, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.567 Vali Acc: 0.754 Test Loss: 0.567 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753618).  Saving model ...
Epoch: 22 cost time: 0.8866958618164062
Epoch: 22, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
Validation loss decreased (-0.753618 --> -0.760864).  Saving model ...
Epoch: 23 cost time: 0.9571061134338379
Epoch: 23, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.576 Vali Acc: 0.761 Test Loss: 0.576 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9079227447509766
Epoch: 24, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8741331100463867
Epoch: 25, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.566 Vali Acc: 0.790 Test Loss: 0.566 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789849).  Saving model ...
Epoch: 26 cost time: 0.9453914165496826
Epoch: 26, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.548 Vali Acc: 0.790 Test Loss: 0.548 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 27 cost time: 0.9545116424560547
Epoch: 27, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9678764343261719
Epoch: 28, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.558 Vali Acc: 0.797 Test Loss: 0.558 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 29 cost time: 0.9392094612121582
Epoch: 29, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.537 Vali Acc: 0.790 Test Loss: 0.537 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1581385135650635
Epoch: 30, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 31 cost time: 1.0327308177947998
Epoch: 31, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9979119300842285
Epoch: 32, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 33 cost time: 1.071923017501831
Epoch: 33, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1346392631530762
Epoch: 34, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0740134716033936
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.506 Vali Acc: 0.812 Test Loss: 0.506 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0890100002288818
Epoch: 36, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 37 cost time: 0.978623628616333
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 38 cost time: 0.821540355682373
Epoch: 38, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 39 cost time: 0.9041399955749512
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.056762933731079
Epoch: 40, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 41 cost time: 0.9412400722503662
Epoch: 41, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0131769180297852
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 43 cost time: 1.0154807567596436
Epoch: 43, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8447446823120117
Epoch: 44, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 45 cost time: 0.8653519153594971
Epoch: 45, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 46 cost time: 1.0154337882995605
Epoch: 46, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9849529266357422
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.906757116317749
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9698138236999512
Epoch: 49, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 50 cost time: 0.9224824905395508
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.836489200592041
Epoch: 51, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0046849250793457
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.92745041847229
Epoch: 53, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9295670986175537
Epoch: 54, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8930237293243408
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.9665026664733887
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.0721783638000488
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.9976284503936768
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.525745153427124
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 263196
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4614086151123047
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.414 Vali Acc: 0.304 Test Loss: 1.414 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.8933143615722656
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.369 Vali Acc: 0.413 Test Loss: 1.369 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 0.9131848812103271
Epoch: 3, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.322 Vali Acc: 0.420 Test Loss: 1.322 Test Acc: 0.420
Validation loss decreased (-0.413030 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 0.9765005111694336
Epoch: 4, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.265 Vali Acc: 0.449 Test Loss: 1.265 Test Acc: 0.449
Validation loss decreased (-0.420277 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 0.9028747081756592
Epoch: 5, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.204 Vali Acc: 0.529 Test Loss: 1.204 Test Acc: 0.529
Validation loss decreased (-0.449263 --> -0.528973).  Saving model ...
Epoch: 6 cost time: 0.8513507843017578
Epoch: 6, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.146 Vali Acc: 0.587 Test Loss: 1.146 Test Acc: 0.587
Validation loss decreased (-0.528973 --> -0.586945).  Saving model ...
Epoch: 7 cost time: 1.0346887111663818
Epoch: 7, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.084 Vali Acc: 0.507 Test Loss: 1.084 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.289926290512085
Epoch: 8, Steps: 9 | Train Loss: 0.955 Vali Loss: 1.019 Vali Acc: 0.616 Test Loss: 1.019 Test Acc: 0.616
Validation loss decreased (-0.586945 --> -0.615932).  Saving model ...
Epoch: 9 cost time: 1.145857334136963
Epoch: 9, Steps: 9 | Train Loss: 0.827 Vali Loss: 0.963 Vali Acc: 0.616 Test Loss: 0.963 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615932).  Saving model ...
Epoch: 10 cost time: 0.9175548553466797
Epoch: 10, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.914 Vali Acc: 0.659 Test Loss: 0.914 Test Acc: 0.659
Validation loss decreased (-0.615932 --> -0.659411).  Saving model ...
Epoch: 11 cost time: 0.8577539920806885
Epoch: 11, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.857 Vali Acc: 0.659 Test Loss: 0.857 Test Acc: 0.659
Validation loss decreased (-0.659411 --> -0.659412).  Saving model ...
Epoch: 12 cost time: 0.8284180164337158
Epoch: 12, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.797 Vali Acc: 0.674 Test Loss: 0.797 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 1.12845778465271
Epoch: 13, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.748 Vali Acc: 0.703 Test Loss: 0.748 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 1.0430312156677246
Epoch: 14, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.725 Vali Acc: 0.703 Test Loss: 0.725 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 15 cost time: 0.8848648071289062
Epoch: 15, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 16 cost time: 0.9271121025085449
Epoch: 16, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.670 Vali Acc: 0.739 Test Loss: 0.670 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 17 cost time: 1.0755207538604736
Epoch: 17, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 18 cost time: 0.9190385341644287
Epoch: 18, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 19 cost time: 0.9866783618927002
Epoch: 19, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.641 Vali Acc: 0.739 Test Loss: 0.641 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9517030715942383
Epoch: 20, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.620 Vali Acc: 0.754 Test Loss: 0.620 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 21 cost time: 1.022205114364624
Epoch: 21, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 22 cost time: 0.9564621448516846
Epoch: 22, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9000017642974854
Epoch: 23, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 24 cost time: 0.9757719039916992
Epoch: 24, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 25 cost time: 1.0709474086761475
Epoch: 25, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.580 Vali Acc: 0.797 Test Loss: 0.580 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 26 cost time: 0.9586789608001709
Epoch: 26, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.565 Vali Acc: 0.797 Test Loss: 0.565 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 27 cost time: 0.9030194282531738
Epoch: 27, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.594 Vali Acc: 0.797 Test Loss: 0.594 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0719783306121826
Epoch: 28, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.556 Vali Acc: 0.790 Test Loss: 0.556 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0967319011688232
Epoch: 29, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.577 Vali Acc: 0.804 Test Loss: 0.577 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 30 cost time: 1.1053824424743652
Epoch: 30, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 31 cost time: 1.001774787902832
Epoch: 31, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 32 cost time: 0.9253630638122559
Epoch: 32, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 33 cost time: 1.0475945472717285
Epoch: 33, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 34 cost time: 0.9158945083618164
Epoch: 34, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9569509029388428
Epoch: 35, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.064453125
Epoch: 36, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 37 cost time: 0.8664760589599609
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.080674409866333
Epoch: 38, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.00132155418396
Epoch: 39, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1145308017730713
Epoch: 40, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 41 cost time: 0.991844892501831
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1750779151916504
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2102608680725098
Epoch: 43, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 44 cost time: 0.987659215927124
Epoch: 44, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8843772411346436
Epoch: 45, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 46 cost time: 0.8192353248596191
Epoch: 46, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0478260517120361
Epoch: 47, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0821690559387207
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.139103651046753
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9579586982727051
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1791136264801025
Epoch: 51, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.3257122039794922
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0071220397949219
Epoch: 53, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.114910364151001
Epoch: 54, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2514748573303223
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 262620
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.507575273513794
Epoch: 1, Steps: 9 | Train Loss: 1.644 Vali Loss: 1.454 Vali Acc: 0.225 Test Loss: 1.454 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 0.8409891128540039
Epoch: 2, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.388 Vali Acc: 0.391 Test Loss: 1.388 Test Acc: 0.391
Validation loss decreased (-0.224623 --> -0.391290).  Saving model ...
Epoch: 3 cost time: 0.912067174911499
Epoch: 3, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.356 Vali Acc: 0.326 Test Loss: 1.356 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9086005687713623
Epoch: 4, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.267 Vali Acc: 0.413 Test Loss: 1.267 Test Acc: 0.413
Validation loss decreased (-0.391290 --> -0.413031).  Saving model ...
Epoch: 5 cost time: 1.0000107288360596
Epoch: 5, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.218 Vali Acc: 0.377 Test Loss: 1.218 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8562448024749756
Epoch: 6, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.150 Vali Acc: 0.522 Test Loss: 1.150 Test Acc: 0.522
Validation loss decreased (-0.413031 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 0.8570849895477295
Epoch: 7, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 8 cost time: 0.897289514541626
Epoch: 8, Steps: 9 | Train Loss: 0.942 Vali Loss: 1.045 Vali Acc: 0.514 Test Loss: 1.045 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8483831882476807
Epoch: 9, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.972 Vali Acc: 0.587 Test Loss: 0.972 Test Acc: 0.587
Validation loss decreased (-0.521728 --> -0.586947).  Saving model ...
Epoch: 10 cost time: 0.9738080501556396
Epoch: 10, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.914 Vali Acc: 0.638 Test Loss: 0.914 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 11 cost time: 0.8614544868469238
Epoch: 11, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.865 Vali Acc: 0.630 Test Loss: 0.865 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9925484657287598
Epoch: 12, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.794 Vali Acc: 0.674 Test Loss: 0.794 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 0.8829317092895508
Epoch: 13, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.761 Vali Acc: 0.696 Test Loss: 0.761 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 14 cost time: 0.7887129783630371
Epoch: 14, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.708 Vali Acc: 0.717 Test Loss: 0.708 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 15 cost time: 0.77545166015625
Epoch: 15, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.691 Vali Acc: 0.739 Test Loss: 0.691 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 0.7925770282745361
Epoch: 16, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.659 Vali Acc: 0.725 Test Loss: 0.659 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9254186153411865
Epoch: 17, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.652 Vali Acc: 0.725 Test Loss: 0.652 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9133834838867188
Epoch: 18, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.642 Vali Acc: 0.725 Test Loss: 0.642 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.051069974899292
Epoch: 19, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.630 Vali Acc: 0.754 Test Loss: 0.630 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 20 cost time: 0.9134438037872314
Epoch: 20, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.619 Vali Acc: 0.768 Test Loss: 0.619 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 21 cost time: 0.9116628170013428
Epoch: 21, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8846220970153809
Epoch: 22, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.593 Vali Acc: 0.775 Test Loss: 0.593 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775356).  Saving model ...
Epoch: 23 cost time: 0.9441714286804199
Epoch: 23, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 24 cost time: 0.9092223644256592
Epoch: 24, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9443075656890869
Epoch: 25, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.576 Vali Acc: 0.775 Test Loss: 0.576 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9643363952636719
Epoch: 26, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.598 Vali Acc: 0.790 Test Loss: 0.598 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789849).  Saving model ...
Epoch: 27 cost time: 1.0363047122955322
Epoch: 27, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 28 cost time: 0.9183988571166992
Epoch: 28, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8566727638244629
Epoch: 29, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 1.0611045360565186
Epoch: 30, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.511 Vali Acc: 0.819 Test Loss: 0.511 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7609043121337891
Epoch: 31, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.536 Vali Acc: 0.797 Test Loss: 0.536 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.741290807723999
Epoch: 32, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0238232612609863
Epoch: 33, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7859430313110352
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 35 cost time: 1.0392236709594727
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0556080341339111
Epoch: 36, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 37 cost time: 1.0166535377502441
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 38 cost time: 1.0526039600372314
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9161791801452637
Epoch: 39, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.847710371017456
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9710252285003662
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0074455738067627
Epoch: 42, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 43 cost time: 1.011953353881836
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 44 cost time: 0.9201760292053223
Epoch: 44, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.09613037109375
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8357424736022949
Epoch: 46, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9283990859985352
Epoch: 47, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.033621072769165
Epoch: 48, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0113451480865479
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0589854717254639
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8183376789093018
Epoch: 51, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.8782532215118408
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 53 cost time: 1.1084976196289062
Epoch: 53, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7570896148681641
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0756340026855469
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 56 cost time: 0.8636767864227295
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9614977836608887
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.980921745300293
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.932558536529541
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0044608116149902
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8583688735961914
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.020015001296997
Epoch: 62, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.0453298091888428
Epoch: 63, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.9399664402008057
Epoch: 64, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8282985687255859
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 66 cost time: 0.8981566429138184
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 67 cost time: 0.9320530891418457
Epoch: 67, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8502078056335449
Epoch: 68, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8423991203308105
Epoch: 69, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9954586029052734
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 71 cost time: 0.8451507091522217
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 72 cost time: 0.8837311267852783
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9410336017608643
Epoch: 73, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.9963676929473877
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9855642318725586
Epoch: 75, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.0495338439941406
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.9144928455352783
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 78 cost time: 1.1202046871185303
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.862 Test Loss: 0.410 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 79 cost time: 1.0077059268951416
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9506180286407471
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.9450380802154541
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.1097371578216553
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 83 cost time: 0.8630645275115967
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 84 cost time: 1.2001442909240723
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 85 cost time: 1.0307378768920898
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 86 cost time: 1.0060858726501465
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.8724794387817383
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.0510334968566895
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.989206075668335
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.8102982044219971
Epoch: 90, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.0348613262176514
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.8855068683624268
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 1.2127635478973389
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.142232894897461
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.90763258934021
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 262044
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.898613929748535
Epoch: 1, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.274 Vali Acc: 0.384 Test Loss: 1.274 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 0.9402339458465576
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.247 Vali Acc: 0.428 Test Loss: 1.247 Test Acc: 0.428
Validation loss decreased (-0.384045 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 1.008854627609253
Epoch: 3, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.215 Vali Acc: 0.406 Test Loss: 1.215 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8385317325592041
Epoch: 4, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.427524 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 0.8690881729125977
Epoch: 5, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.114 Vali Acc: 0.478 Test Loss: 1.114 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.930809736251831
Epoch: 6, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.089 Vali Acc: 0.471 Test Loss: 1.089 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1202797889709473
Epoch: 7, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.028 Vali Acc: 0.529 Test Loss: 1.028 Test Acc: 0.529
Validation loss decreased (-0.485496 --> -0.528975).  Saving model ...
Epoch: 8 cost time: 1.2276413440704346
Epoch: 8, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.989 Vali Acc: 0.565 Test Loss: 0.989 Test Acc: 0.565
Validation loss decreased (-0.528975 --> -0.565208).  Saving model ...
Epoch: 9 cost time: 1.0941581726074219
Epoch: 9, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.941 Vali Acc: 0.594 Test Loss: 0.941 Test Acc: 0.594
Validation loss decreased (-0.565208 --> -0.594193).  Saving model ...
Epoch: 10 cost time: 0.9922447204589844
Epoch: 10, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.891 Vali Acc: 0.630 Test Loss: 0.891 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630426).  Saving model ...
Epoch: 11 cost time: 0.8604228496551514
Epoch: 11, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.854 Vali Acc: 0.609 Test Loss: 0.854 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9054825305938721
Epoch: 12, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.817 Vali Acc: 0.681 Test Loss: 0.817 Test Acc: 0.681
Validation loss decreased (-0.630426 --> -0.681151).  Saving model ...
Epoch: 13 cost time: 0.9402828216552734
Epoch: 13, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.771 Vali Acc: 0.667 Test Loss: 0.771 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8843307495117188
Epoch: 14, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.739 Vali Acc: 0.710 Test Loss: 0.739 Test Acc: 0.710
Validation loss decreased (-0.681151 --> -0.710138).  Saving model ...
Epoch: 15 cost time: 0.9762954711914062
Epoch: 15, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.713 Vali Acc: 0.710 Test Loss: 0.713 Test Acc: 0.710
Validation loss decreased (-0.710138 --> -0.710138).  Saving model ...
Epoch: 16 cost time: 1.0416579246520996
Epoch: 16, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 17 cost time: 0.988471508026123
Epoch: 17, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.676 Vali Acc: 0.696 Test Loss: 0.676 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9000942707061768
Epoch: 18, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.636 Vali Acc: 0.725 Test Loss: 0.636 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 0.9107112884521484
Epoch: 19, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.650 Vali Acc: 0.725 Test Loss: 0.650 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.052659034729004
Epoch: 20, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.106060266494751
Epoch: 21, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 22 cost time: 0.9332869052886963
Epoch: 22, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8331067562103271
Epoch: 23, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.626 Vali Acc: 0.754 Test Loss: 0.626 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9337754249572754
Epoch: 24, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.622 Vali Acc: 0.775 Test Loss: 0.622 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 25 cost time: 0.8625743389129639
Epoch: 25, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9635097980499268
Epoch: 26, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0821201801300049
Epoch: 27, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.633 Vali Acc: 0.732 Test Loss: 0.633 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0449833869934082
Epoch: 28, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9198222160339355
Epoch: 29, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 30 cost time: 1.1159274578094482
Epoch: 30, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 31 cost time: 0.7822186946868896
Epoch: 31, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 32 cost time: 0.8716738224029541
Epoch: 32, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.601 Vali Acc: 0.797 Test Loss: 0.601 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797095).  Saving model ...
Epoch: 33 cost time: 0.8032932281494141
Epoch: 33, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.601 Vali Acc: 0.797 Test Loss: 0.601 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9349660873413086
Epoch: 34, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 35 cost time: 0.8270022869110107
Epoch: 35, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9103596210479736
Epoch: 36, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8657991886138916
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9509892463684082
Epoch: 38, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9342479705810547
Epoch: 39, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.949066162109375
Epoch: 40, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 41 cost time: 0.841392993927002
Epoch: 41, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.590 Vali Acc: 0.804 Test Loss: 0.590 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8095431327819824
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9912898540496826
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 44 cost time: 0.8591911792755127
Epoch: 44, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 45 cost time: 0.7618708610534668
Epoch: 45, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 46 cost time: 0.7198588848114014
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8724539279937744
Epoch: 47, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7602014541625977
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9176428318023682
Epoch: 49, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8070297241210938
Epoch: 50, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9546675682067871
Epoch: 51, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9566144943237305
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0138294696807861
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0952198505401611
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9353435039520264
Epoch: 55, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 163932
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6192123889923096
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.357 Vali Acc: 0.341 Test Loss: 1.357 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.9529173374176025
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.324 Vali Acc: 0.377 Test Loss: 1.324 Test Acc: 0.377
Validation loss decreased (-0.340566 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.8114814758300781
Epoch: 3, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.282 Vali Acc: 0.435 Test Loss: 1.282 Test Acc: 0.435
Validation loss decreased (-0.376798 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 1.004103660583496
Epoch: 4, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.240 Vali Acc: 0.478 Test Loss: 1.240 Test Acc: 0.478
Validation loss decreased (-0.434770 --> -0.478248).  Saving model ...
Epoch: 5 cost time: 1.0750706195831299
Epoch: 5, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.191 Vali Acc: 0.536 Test Loss: 1.191 Test Acc: 0.536
Validation loss decreased (-0.478248 --> -0.536220).  Saving model ...
Epoch: 6 cost time: 0.796583890914917
Epoch: 6, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.144 Vali Acc: 0.572 Test Loss: 1.144 Test Acc: 0.572
Validation loss decreased (-0.536220 --> -0.572452).  Saving model ...
Epoch: 7 cost time: 0.8271152973175049
Epoch: 7, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.089 Vali Acc: 0.507 Test Loss: 1.089 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9480164051055908
Epoch: 8, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.050 Vali Acc: 0.594 Test Loss: 1.050 Test Acc: 0.594
Validation loss decreased (-0.572452 --> -0.594192).  Saving model ...
Epoch: 9 cost time: 0.9032833576202393
Epoch: 9, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.979 Vali Acc: 0.609 Test Loss: 0.979 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608686).  Saving model ...
Epoch: 10 cost time: 0.9344825744628906
Epoch: 10, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.912 Vali Acc: 0.638 Test Loss: 0.912 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637672).  Saving model ...
Epoch: 11 cost time: 0.7778375148773193
Epoch: 11, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.883 Vali Acc: 0.630 Test Loss: 0.883 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9456918239593506
Epoch: 12, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.848 Vali Acc: 0.609 Test Loss: 0.848 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9394040107727051
Epoch: 13, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.785 Vali Acc: 0.710 Test Loss: 0.785 Test Acc: 0.710
Validation loss decreased (-0.637672 --> -0.710137).  Saving model ...
Epoch: 14 cost time: 1.0574047565460205
Epoch: 14, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.737 Vali Acc: 0.710 Test Loss: 0.737 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710138).  Saving model ...
Epoch: 15 cost time: 0.9196603298187256
Epoch: 15, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.726 Vali Acc: 0.732 Test Loss: 0.726 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731877).  Saving model ...
Epoch: 16 cost time: 0.8240528106689453
Epoch: 16, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.693 Vali Acc: 0.732 Test Loss: 0.693 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731877).  Saving model ...
Epoch: 17 cost time: 0.9082832336425781
Epoch: 17, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9784328937530518
Epoch: 18, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9304211139678955
Epoch: 19, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.652 Vali Acc: 0.732 Test Loss: 0.652 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 20 cost time: 1.017308235168457
Epoch: 20, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.634 Vali Acc: 0.725 Test Loss: 0.634 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9899203777313232
Epoch: 21, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.625 Vali Acc: 0.746 Test Loss: 0.625 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 22 cost time: 1.275407075881958
Epoch: 22, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.614 Vali Acc: 0.739 Test Loss: 0.614 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0896880626678467
Epoch: 23, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.607 Vali Acc: 0.754 Test Loss: 0.607 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 24 cost time: 1.1070599555969238
Epoch: 24, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 25 cost time: 1.0285496711730957
Epoch: 25, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.606 Vali Acc: 0.768 Test Loss: 0.606 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 26 cost time: 1.0290672779083252
Epoch: 26, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.074826955795288
Epoch: 27, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.596 Vali Acc: 0.768 Test Loss: 0.596 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 28 cost time: 0.9020113945007324
Epoch: 28, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.952937126159668
Epoch: 29, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.575 Vali Acc: 0.790 Test Loss: 0.575 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 30 cost time: 1.2558538913726807
Epoch: 30, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1965198516845703
Epoch: 31, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.581 Vali Acc: 0.797 Test Loss: 0.581 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 32 cost time: 0.8958079814910889
Epoch: 32, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.566 Vali Acc: 0.797 Test Loss: 0.566 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 33 cost time: 0.9064803123474121
Epoch: 33, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.546 Vali Acc: 0.790 Test Loss: 0.546 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9325406551361084
Epoch: 34, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.544 Vali Acc: 0.797 Test Loss: 0.544 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 35 cost time: 0.8818190097808838
Epoch: 35, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 36 cost time: 0.8628389835357666
Epoch: 36, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7731952667236328
Epoch: 37, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9543192386627197
Epoch: 38, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.963810920715332
Epoch: 39, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 40 cost time: 1.042330265045166
Epoch: 40, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0748741626739502
Epoch: 41, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 0.9904768466949463
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.838259220123291
Epoch: 43, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9576153755187988
Epoch: 44, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0473699569702148
Epoch: 45, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9675366878509521
Epoch: 46, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 47 cost time: 0.8697969913482666
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1296217441558838
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2787580490112305
Epoch: 49, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 50 cost time: 1.0794734954833984
Epoch: 50, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 51 cost time: 1.0283701419830322
Epoch: 51, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 52 cost time: 1.0406913757324219
Epoch: 52, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9783680438995361
Epoch: 53, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 54 cost time: 0.9031009674072266
Epoch: 54, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9164540767669678
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9474022388458252
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 57 cost time: 0.9394214153289795
Epoch: 57, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1922247409820557
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9436562061309814
Epoch: 59, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9747600555419922
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.082451581954956
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8890457153320312
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 63 cost time: 0.901531457901001
Epoch: 63, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 64 cost time: 0.9922831058502197
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9384827613830566
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.189969778060913
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.1029186248779297
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.855 Test Loss: 0.458 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9850232601165771
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.9762775897979736
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.0843274593353271
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.1869349479675293
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.2373502254486084
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.1073851585388184
Epoch: 73, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 74 cost time: 1.173832893371582
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.4080970287322998
Epoch: 75, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.3747992515563965
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.2433574199676514
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.2522411346435547
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.1693081855773926
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.0946040153503418
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.1336987018585205
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.2979042530059814
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.1744306087493896
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 163356
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8760485649108887
Epoch: 1, Steps: 9 | Train Loss: 1.534 Vali Loss: 1.400 Vali Acc: 0.268 Test Loss: 1.400 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.1480274200439453
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.356 Vali Acc: 0.355 Test Loss: 1.356 Test Acc: 0.355
Validation loss decreased (-0.268102 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.0313045978546143
Epoch: 3, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.332 Vali Acc: 0.391 Test Loss: 1.332 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 1.089189052581787
Epoch: 4, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.057265043258667
Epoch: 5, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.211 Vali Acc: 0.493 Test Loss: 1.211 Test Acc: 0.493
Validation loss decreased (-0.391291 --> -0.492742).  Saving model ...
Epoch: 6 cost time: 0.959892749786377
Epoch: 6, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.162 Vali Acc: 0.558 Test Loss: 1.162 Test Acc: 0.558
Validation loss decreased (-0.492742 --> -0.557959).  Saving model ...
Epoch: 7 cost time: 1.1254396438598633
Epoch: 7, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.109 Vali Acc: 0.464 Test Loss: 1.109 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2442176342010498
Epoch: 8, Steps: 9 | Train Loss: 0.989 Vali Loss: 1.056 Vali Acc: 0.580 Test Loss: 1.056 Test Acc: 0.580
Validation loss decreased (-0.557959 --> -0.579700).  Saving model ...
Epoch: 9 cost time: 1.0545904636383057
Epoch: 9, Steps: 9 | Train Loss: 0.891 Vali Loss: 1.003 Vali Acc: 0.572 Test Loss: 1.003 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9361424446105957
Epoch: 10, Steps: 9 | Train Loss: 0.836 Vali Loss: 0.956 Vali Acc: 0.572 Test Loss: 0.956 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1012213230133057
Epoch: 11, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.904 Vali Acc: 0.638 Test Loss: 0.904 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637672).  Saving model ...
Epoch: 12 cost time: 1.1427843570709229
Epoch: 12, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.841 Vali Acc: 0.638 Test Loss: 0.841 Test Acc: 0.638
Validation loss decreased (-0.637672 --> -0.637673).  Saving model ...
Epoch: 13 cost time: 1.3435750007629395
Epoch: 13, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
Validation loss decreased (-0.637673 --> -0.673905).  Saving model ...
Epoch: 14 cost time: 1.1871976852416992
Epoch: 14, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.753 Vali Acc: 0.681 Test Loss: 0.753 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681152).  Saving model ...
Epoch: 15 cost time: 1.259631633758545
Epoch: 15, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.726 Vali Acc: 0.696 Test Loss: 0.726 Test Acc: 0.696
Validation loss decreased (-0.681152 --> -0.695645).  Saving model ...
Epoch: 16 cost time: 1.0129363536834717
Epoch: 16, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 17 cost time: 0.8794996738433838
Epoch: 17, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.684 Vali Acc: 0.703 Test Loss: 0.684 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1987524032592773
Epoch: 18, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.677 Vali Acc: 0.725 Test Loss: 0.677 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 0.9875750541687012
Epoch: 19, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 20 cost time: 1.0458781719207764
Epoch: 20, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746370).  Saving model ...
Epoch: 21 cost time: 1.140547513961792
Epoch: 21, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.633 Vali Acc: 0.732 Test Loss: 0.633 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0400140285491943
Epoch: 22, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 23 cost time: 1.565216302871704
Epoch: 23, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0217647552490234
Epoch: 24, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 25 cost time: 0.9322147369384766
Epoch: 25, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.610 Vali Acc: 0.754 Test Loss: 0.610 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.95046067237854
Epoch: 26, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 27 cost time: 0.8871850967407227
Epoch: 27, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3168087005615234
Epoch: 28, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 29 cost time: 1.1392130851745605
Epoch: 29, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.609 Vali Acc: 0.790 Test Loss: 0.609 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1712746620178223
Epoch: 30, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1397769451141357
Epoch: 31, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 32 cost time: 1.1457371711730957
Epoch: 32, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.585 Vali Acc: 0.804 Test Loss: 0.585 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9250147342681885
Epoch: 33, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0330803394317627
Epoch: 34, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9533445835113525
Epoch: 35, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 36 cost time: 1.1121940612792969
Epoch: 36, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2510507106781006
Epoch: 37, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9593875408172607
Epoch: 38, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0632703304290771
Epoch: 39, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.001363754272461
Epoch: 40, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 1.0392704010009766
Epoch: 41, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8723020553588867
Epoch: 42, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 43 cost time: 1.0328083038330078
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 44 cost time: 1.167464017868042
Epoch: 44, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1174230575561523
Epoch: 45, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2839102745056152
Epoch: 46, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.158207893371582
Epoch: 47, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 48 cost time: 1.1519231796264648
Epoch: 48, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1203992366790771
Epoch: 49, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 50 cost time: 0.9164090156555176
Epoch: 50, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1088030338287354
Epoch: 51, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9374411106109619
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9805393218994141
Epoch: 53, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 54 cost time: 0.9188063144683838
Epoch: 54, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 55 cost time: 0.8444125652313232
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9034008979797363
Epoch: 56, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1402702331542969
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 58 cost time: 0.8402163982391357
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9325761795043945
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 60 cost time: 0.9712429046630859
Epoch: 60, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9041461944580078
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.238044261932373
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0582191944122314
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0561563968658447
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1215920448303223
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.9145717620849609
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.3006963729858398
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.8907473087310791
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.3534343242645264
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 70 cost time: 0.9627976417541504
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 71 cost time: 0.9400856494903564
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.2873492240905762
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1486694812774658
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 74 cost time: 0.8680334091186523
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.0644590854644775
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9600591659545898
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9055235385894775
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.3411705493927002
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.07039475440979
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.2790477275848389
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.210383415222168
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.236011028289795
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.205369472503662
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 162780
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8068485260009766
Epoch: 1, Steps: 9 | Train Loss: 1.564 Vali Loss: 1.496 Vali Acc: 0.181 Test Loss: 1.496 Test Acc: 0.181
Validation loss decreased (inf --> -0.181144).  Saving model ...
Epoch: 2 cost time: 1.1052613258361816
Epoch: 2, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.441 Vali Acc: 0.362 Test Loss: 1.441 Test Acc: 0.362
Validation loss decreased (-0.181144 --> -0.362304).  Saving model ...
Epoch: 3 cost time: 0.899742603302002
Epoch: 3, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.387 Vali Acc: 0.246 Test Loss: 1.387 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8118267059326172
Epoch: 4, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.335 Vali Acc: 0.399 Test Loss: 1.335 Test Acc: 0.399
Validation loss decreased (-0.362304 --> -0.398537).  Saving model ...
Epoch: 5 cost time: 0.8087546825408936
Epoch: 5, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.279 Vali Acc: 0.377 Test Loss: 1.279 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9056191444396973
Epoch: 6, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.209 Vali Acc: 0.543 Test Loss: 1.209 Test Acc: 0.543
Validation loss decreased (-0.398537 --> -0.543466).  Saving model ...
Epoch: 7 cost time: 0.8003287315368652
Epoch: 7, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.147 Vali Acc: 0.580 Test Loss: 1.147 Test Acc: 0.580
Validation loss decreased (-0.543466 --> -0.579699).  Saving model ...
Epoch: 8 cost time: 0.8919830322265625
Epoch: 8, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.081 Vali Acc: 0.594 Test Loss: 1.081 Test Acc: 0.594
Validation loss decreased (-0.579699 --> -0.594192).  Saving model ...
Epoch: 9 cost time: 0.8018121719360352
Epoch: 9, Steps: 9 | Train Loss: 0.940 Vali Loss: 1.009 Vali Acc: 0.601 Test Loss: 1.009 Test Acc: 0.601
Validation loss decreased (-0.594192 --> -0.601439).  Saving model ...
Epoch: 10 cost time: 1.0747721195220947
Epoch: 10, Steps: 9 | Train Loss: 0.834 Vali Loss: 0.945 Vali Acc: 0.616 Test Loss: 0.945 Test Acc: 0.616
Validation loss decreased (-0.601439 --> -0.615933).  Saving model ...
Epoch: 11 cost time: 0.9074814319610596
Epoch: 11, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.894 Vali Acc: 0.645 Test Loss: 0.894 Test Acc: 0.645
Validation loss decreased (-0.615933 --> -0.644919).  Saving model ...
Epoch: 12 cost time: 0.8744118213653564
Epoch: 12, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.845 Vali Acc: 0.645 Test Loss: 0.845 Test Acc: 0.645
Validation loss decreased (-0.644919 --> -0.644919).  Saving model ...
Epoch: 13 cost time: 0.8843743801116943
Epoch: 13, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.793 Vali Acc: 0.703 Test Loss: 0.793 Test Acc: 0.703
Validation loss decreased (-0.644919 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 0.9783306121826172
Epoch: 14, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.746 Vali Acc: 0.710 Test Loss: 0.746 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710137).  Saving model ...
Epoch: 15 cost time: 0.9956984519958496
Epoch: 15, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.699 Vali Acc: 0.710 Test Loss: 0.699 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710138).  Saving model ...
Epoch: 16 cost time: 1.0280048847198486
Epoch: 16, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.660 Vali Acc: 0.725 Test Loss: 0.660 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 17 cost time: 0.7579820156097412
Epoch: 17, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 18 cost time: 0.8314452171325684
Epoch: 18, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.612 Vali Acc: 0.754 Test Loss: 0.612 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 19 cost time: 0.8816637992858887
Epoch: 19, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.621 Vali Acc: 0.754 Test Loss: 0.621 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8616600036621094
Epoch: 20, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.605 Vali Acc: 0.739 Test Loss: 0.605 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.909050703048706
Epoch: 21, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775357).  Saving model ...
Epoch: 22 cost time: 0.7825932502746582
Epoch: 22, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 23 cost time: 0.901914119720459
Epoch: 23, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 24 cost time: 0.883479118347168
Epoch: 24, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.542 Vali Acc: 0.797 Test Loss: 0.542 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 0.8643207550048828
Epoch: 25, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.540 Vali Acc: 0.768 Test Loss: 0.540 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9192516803741455
Epoch: 26, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 27 cost time: 0.9499146938323975
Epoch: 27, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9165158271789551
Epoch: 28, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 29 cost time: 0.9198527336120605
Epoch: 29, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8547823429107666
Epoch: 30, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847821).  Saving model ...
Epoch: 31 cost time: 0.8758156299591064
Epoch: 31, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9225502014160156
Epoch: 32, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8715181350708008
Epoch: 33, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.834942102432251
Epoch: 34, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8480205535888672
Epoch: 35, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.467 Vali Acc: 0.826 Test Loss: 0.467 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7794127464294434
Epoch: 36, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9896211624145508
Epoch: 37, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.928494930267334
Epoch: 38, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8670642375946045
Epoch: 39, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8602964878082275
Epoch: 40, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 41 cost time: 0.6792628765106201
Epoch: 41, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.119734287261963
Epoch: 42, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8643491268157959
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 44 cost time: 0.8312230110168457
Epoch: 44, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 45 cost time: 0.9314649105072021
Epoch: 45, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0210864543914795
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9606904983520508
Epoch: 47, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 48 cost time: 0.9915311336517334
Epoch: 48, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 49 cost time: 0.881464958190918
Epoch: 49, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 50 cost time: 1.0133914947509766
Epoch: 50, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0131146907806396
Epoch: 51, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9094944000244141
Epoch: 52, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0321764945983887
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8200719356536865
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.839545726776123
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.9589827060699463
Epoch: 56, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.905397891998291
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.9292511940002441
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.8496429920196533
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 162204
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.578742265701294
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.431 Vali Acc: 0.290 Test Loss: 1.431 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.9097318649291992
Epoch: 2, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.408 Vali Acc: 0.225 Test Loss: 1.408 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9976644515991211
Epoch: 3, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.370 Vali Acc: 0.268 Test Loss: 1.370 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9128661155700684
Epoch: 4, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.321 Vali Acc: 0.370 Test Loss: 1.321 Test Acc: 0.370
Validation loss decreased (-0.289841 --> -0.369552).  Saving model ...
Epoch: 5 cost time: 0.8108234405517578
Epoch: 5, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.278 Vali Acc: 0.420 Test Loss: 1.278 Test Acc: 0.420
Validation loss decreased (-0.369552 --> -0.420277).  Saving model ...
Epoch: 6 cost time: 1.0157504081726074
Epoch: 6, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.236 Vali Acc: 0.464 Test Loss: 1.236 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463756).  Saving model ...
Epoch: 7 cost time: 0.857987642288208
Epoch: 7, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.192 Vali Acc: 0.355 Test Loss: 1.192 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9272205829620361
Epoch: 8, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.131 Vali Acc: 0.536 Test Loss: 1.131 Test Acc: 0.536
Validation loss decreased (-0.463756 --> -0.536221).  Saving model ...
Epoch: 9 cost time: 0.8680934906005859
Epoch: 9, Steps: 9 | Train Loss: 0.988 Vali Loss: 1.086 Vali Acc: 0.536 Test Loss: 1.086 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 10 cost time: 0.9200496673583984
Epoch: 10, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.048 Vali Acc: 0.486 Test Loss: 1.048 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0273511409759521
Epoch: 11, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.998 Vali Acc: 0.601 Test Loss: 0.998 Test Acc: 0.601
Validation loss decreased (-0.536221 --> -0.601439).  Saving model ...
Epoch: 12 cost time: 1.1846106052398682
Epoch: 12, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.954 Vali Acc: 0.601 Test Loss: 0.954 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601440).  Saving model ...
Epoch: 13 cost time: 0.9013521671295166
Epoch: 13, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.916 Vali Acc: 0.630 Test Loss: 0.916 Test Acc: 0.630
Validation loss decreased (-0.601440 --> -0.630426).  Saving model ...
Epoch: 14 cost time: 0.8146419525146484
Epoch: 14, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.857 Vali Acc: 0.645 Test Loss: 0.857 Test Acc: 0.645
Validation loss decreased (-0.630426 --> -0.644919).  Saving model ...
Epoch: 15 cost time: 0.8318617343902588
Epoch: 15, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.839 Vali Acc: 0.674 Test Loss: 0.839 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673905).  Saving model ...
Epoch: 16 cost time: 0.9275062084197998
Epoch: 16, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.809 Vali Acc: 0.688 Test Loss: 0.809 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688398).  Saving model ...
Epoch: 17 cost time: 0.8554446697235107
Epoch: 17, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.760 Vali Acc: 0.696 Test Loss: 0.760 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 1.1215381622314453
Epoch: 18, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 19 cost time: 0.8519952297210693
Epoch: 19, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.707 Vali Acc: 0.725 Test Loss: 0.707 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9231574535369873
Epoch: 20, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.695 Vali Acc: 0.739 Test Loss: 0.695 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739123).  Saving model ...
Epoch: 21 cost time: 1.0266566276550293
Epoch: 21, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.666 Vali Acc: 0.739 Test Loss: 0.666 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739124).  Saving model ...
Epoch: 22 cost time: 0.754692554473877
Epoch: 22, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.631 Vali Acc: 0.754 Test Loss: 0.631 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 23 cost time: 0.8351414203643799
Epoch: 23, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.861497163772583
Epoch: 24, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8045299053192139
Epoch: 25, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.634 Vali Acc: 0.754 Test Loss: 0.634 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3232831954956055
Epoch: 26, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.977651834487915
Epoch: 27, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.619 Vali Acc: 0.754 Test Loss: 0.619 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 28 cost time: 0.8985018730163574
Epoch: 28, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 29 cost time: 0.7519071102142334
Epoch: 29, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.601 Vali Acc: 0.754 Test Loss: 0.601 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.961693286895752
Epoch: 30, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 31 cost time: 0.7542636394500732
Epoch: 31, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782603).  Saving model ...
Epoch: 32 cost time: 0.9949650764465332
Epoch: 32, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0284068584442139
Epoch: 33, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 34 cost time: 0.7906899452209473
Epoch: 34, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.569 Vali Acc: 0.790 Test Loss: 0.569 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 35 cost time: 0.8482415676116943
Epoch: 35, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.566 Vali Acc: 0.790 Test Loss: 0.566 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 36 cost time: 0.8322415351867676
Epoch: 36, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.022242784500122
Epoch: 37, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 38 cost time: 0.7724227905273438
Epoch: 38, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.572 Vali Acc: 0.790 Test Loss: 0.572 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8798959255218506
Epoch: 39, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.575 Vali Acc: 0.790 Test Loss: 0.575 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9571118354797363
Epoch: 40, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 41 cost time: 0.8718297481536865
Epoch: 41, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 42 cost time: 0.9615402221679688
Epoch: 42, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8880083560943604
Epoch: 43, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0259637832641602
Epoch: 44, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8315243721008301
Epoch: 45, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.99519944190979
Epoch: 46, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.536 Vali Acc: 0.804 Test Loss: 0.536 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8416256904602051
Epoch: 47, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 48 cost time: 0.8884224891662598
Epoch: 48, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8632464408874512
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.871284008026123
Epoch: 50, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8637096881866455
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8148868083953857
Epoch: 52, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8226425647735596
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 54 cost time: 0.7938458919525146
Epoch: 54, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 55 cost time: 0.9444503784179688
Epoch: 55, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7682914733886719
Epoch: 56, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8211064338684082
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 58 cost time: 0.9039483070373535
Epoch: 58, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8025369644165039
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8866438865661621
Epoch: 60, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 61 cost time: 0.757854700088501
Epoch: 61, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 62 cost time: 0.7740359306335449
Epoch: 62, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8679196834564209
Epoch: 63, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8941631317138672
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7353382110595703
Epoch: 65, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8904304504394531
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8552205562591553
Epoch: 67, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 68 cost time: 0.8507137298583984
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9640512466430664
Epoch: 69, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9330058097839355
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8818278312683105
Epoch: 71, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.1066503524780273
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 73 cost time: 0.8293449878692627
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7193374633789062
Epoch: 74, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 75 cost time: 0.734102725982666
Epoch: 75, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8363454341888428
Epoch: 76, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.95184326171875
Epoch: 77, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.8155679702758789
Epoch: 78, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 79 cost time: 0.8328404426574707
Epoch: 79, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8218188285827637
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 81 cost time: 0.8379087448120117
Epoch: 81, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8277068138122559
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 83 cost time: 0.9383225440979004
Epoch: 83, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6878988742828369
Epoch: 84, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7185535430908203
Epoch: 85, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.9919946193695068
Epoch: 86, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 87 cost time: 0.802804708480835
Epoch: 87, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.448 Vali Acc: 0.870 Test Loss: 0.448 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8345227241516113
Epoch: 88, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.089254379272461
Epoch: 89, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.0501599311828613
Epoch: 90, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 91 cost time: 1.0048425197601318
Epoch: 91, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.870 Test Loss: 0.448 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.869347333908081
Epoch: 92, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.8339235782623291
Epoch: 93, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.7939474582672119
Epoch: 94, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.877 Test Loss: 0.442 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 95 cost time: 0.9193263053894043
Epoch: 95, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 96 cost time: 0.8323609828948975
Epoch: 96, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.8853542804718018
Epoch: 97, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8286094665527344
Epoch: 98, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.877 Test Loss: 0.461 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8925864696502686
Epoch: 99, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.9124264717102051
Epoch: 100, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 114012
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9037024974823
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.335 Vali Acc: 0.326 Test Loss: 1.335 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.2489173412322998
Epoch: 2, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.292 Vali Acc: 0.399 Test Loss: 1.292 Test Acc: 0.399
Validation loss decreased (-0.326074 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 1.1745789051055908
Epoch: 3, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.284 Vali Acc: 0.420 Test Loss: 1.284 Test Acc: 0.420
Validation loss decreased (-0.398538 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 0.915571928024292
Epoch: 4, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.217 Vali Acc: 0.464 Test Loss: 1.217 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 0.9571144580841064
Epoch: 5, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.174 Vali Acc: 0.565 Test Loss: 1.174 Test Acc: 0.565
Validation loss decreased (-0.463756 --> -0.565206).  Saving model ...
Epoch: 6 cost time: 1.0297436714172363
Epoch: 6, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.118 Vali Acc: 0.580 Test Loss: 1.118 Test Acc: 0.580
Validation loss decreased (-0.565206 --> -0.579699).  Saving model ...
Epoch: 7 cost time: 1.1491367816925049
Epoch: 7, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0573418140411377
Epoch: 8, Steps: 9 | Train Loss: 0.993 Vali Loss: 1.030 Vali Acc: 0.623 Test Loss: 1.030 Test Acc: 0.623
Validation loss decreased (-0.579699 --> -0.623178).  Saving model ...
Epoch: 9 cost time: 0.9353830814361572
Epoch: 9, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.981 Vali Acc: 0.601 Test Loss: 0.981 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0984127521514893
Epoch: 10, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.945 Vali Acc: 0.645 Test Loss: 0.945 Test Acc: 0.645
Validation loss decreased (-0.623178 --> -0.644918).  Saving model ...
Epoch: 11 cost time: 1.1086723804473877
Epoch: 11, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.907 Vali Acc: 0.659 Test Loss: 0.907 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659411).  Saving model ...
Epoch: 12 cost time: 1.0162429809570312
Epoch: 12, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.866 Vali Acc: 0.638 Test Loss: 0.866 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9419417381286621
Epoch: 13, Steps: 9 | Train Loss: 0.706 Vali Loss: 0.814 Vali Acc: 0.703 Test Loss: 0.814 Test Acc: 0.703
Validation loss decreased (-0.659411 --> -0.702890).  Saving model ...
Epoch: 14 cost time: 0.802288293838501
Epoch: 14, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.777 Vali Acc: 0.688 Test Loss: 0.777 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8182871341705322
Epoch: 15, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.769 Vali Acc: 0.696 Test Loss: 0.769 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.791449785232544
Epoch: 16, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.732 Vali Acc: 0.710 Test Loss: 0.732 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710138).  Saving model ...
Epoch: 17 cost time: 0.9466843605041504
Epoch: 17, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.720 Vali Acc: 0.710 Test Loss: 0.720 Test Acc: 0.710
Validation loss decreased (-0.710138 --> -0.710138).  Saving model ...
Epoch: 18 cost time: 0.9286160469055176
Epoch: 18, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 0.9204914569854736
Epoch: 19, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.649 Vali Acc: 0.717 Test Loss: 0.649 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7976627349853516
Epoch: 20, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 21 cost time: 0.9126412868499756
Epoch: 21, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.631 Vali Acc: 0.732 Test Loss: 0.631 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.066251516342163
Epoch: 22, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.618 Vali Acc: 0.754 Test Loss: 0.618 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 23 cost time: 0.9003441333770752
Epoch: 23, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.605 Vali Acc: 0.754 Test Loss: 0.605 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 24 cost time: 1.031865119934082
Epoch: 24, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.590 Vali Acc: 0.754 Test Loss: 0.590 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 25 cost time: 0.9524586200714111
Epoch: 25, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.599 Vali Acc: 0.754 Test Loss: 0.599 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8803122043609619
Epoch: 26, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.586 Vali Acc: 0.790 Test Loss: 0.586 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789849).  Saving model ...
Epoch: 27 cost time: 0.9454605579376221
Epoch: 27, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.119957685470581
Epoch: 28, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.624 Vali Acc: 0.754 Test Loss: 0.624 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0166704654693604
Epoch: 29, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0529358386993408
Epoch: 30, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.138167142868042
Epoch: 31, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 32 cost time: 0.851407527923584
Epoch: 32, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0582563877105713
Epoch: 33, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.587 Vali Acc: 0.783 Test Loss: 0.587 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9581878185272217
Epoch: 34, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.094315528869629
Epoch: 35, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.540 Vali Acc: 0.804 Test Loss: 0.540 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 36 cost time: 0.8775286674499512
Epoch: 36, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.550 Vali Acc: 0.797 Test Loss: 0.550 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.046273946762085
Epoch: 37, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9411053657531738
Epoch: 38, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.572 Vali Acc: 0.804 Test Loss: 0.572 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9675168991088867
Epoch: 39, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 40 cost time: 0.9943516254425049
Epoch: 40, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818835).  Saving model ...
Epoch: 41 cost time: 0.9274253845214844
Epoch: 41, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.546 Vali Acc: 0.804 Test Loss: 0.546 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1995656490325928
Epoch: 42, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8550608158111572
Epoch: 43, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9003133773803711
Epoch: 44, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8965563774108887
Epoch: 45, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 46 cost time: 1.2579338550567627
Epoch: 46, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.520 Vali Acc: 0.826 Test Loss: 0.520 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 47 cost time: 1.1344175338745117
Epoch: 47, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0856547355651855
Epoch: 48, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 49 cost time: 0.9766442775726318
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 50 cost time: 0.8996798992156982
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.014033555984497
Epoch: 51, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0723497867584229
Epoch: 52, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 53 cost time: 1.0102851390838623
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 54 cost time: 1.2467713356018066
Epoch: 54, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 55 cost time: 1.0214948654174805
Epoch: 55, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0888822078704834
Epoch: 56, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.095834493637085
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.903684139251709
Epoch: 58, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8526966571807861
Epoch: 59, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9575815200805664
Epoch: 60, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9438009262084961
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0532007217407227
Epoch: 62, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 63 cost time: 1.0090241432189941
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7640974521636963
Epoch: 64, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9724082946777344
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8797733783721924
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9112331867218018
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9592258930206299
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.9113850593566895
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.048163652420044
Epoch: 70, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.1723475456237793
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.010066032409668
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 73 cost time: 0.9358780384063721
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 74 cost time: 0.9321413040161133
Epoch: 74, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 75 cost time: 0.9496817588806152
Epoch: 75, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0908489227294922
Epoch: 76, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.094926118850708
Epoch: 77, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 78 cost time: 1.0512609481811523
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9547774791717529
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.448 Vali Acc: 0.870 Test Loss: 0.448 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 80 cost time: 1.066446304321289
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 81 cost time: 0.9808564186096191
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.0319409370422363
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.189314842224121
Epoch: 83, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.9535136222839355
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.9553818702697754
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.9198379516601562
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.877 Test Loss: 0.442 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 87 cost time: 0.8297362327575684
Epoch: 87, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.4459993839263916
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.1166529655456543
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.290623664855957
Epoch: 90, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.2190744876861572
Epoch: 91, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 92 cost time: 0.9651720523834229
Epoch: 92, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.0965964794158936
Epoch: 93, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.8596549034118652
Epoch: 94, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.9784626960754395
Epoch: 95, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.008366346359253
Epoch: 96, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 1.070871114730835
Epoch: 97, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 1.1087281703948975
Epoch: 98, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 0.97589111328125
Epoch: 99, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 1.0964553356170654
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 113436
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9239425659179688
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.417 Vali Acc: 0.188 Test Loss: 1.417 Test Acc: 0.188
Validation loss decreased (inf --> -0.188392).  Saving model ...
Epoch: 2 cost time: 0.9389665126800537
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.385 Vali Acc: 0.304 Test Loss: 1.385 Test Acc: 0.304
Validation loss decreased (-0.188392 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 0.9151961803436279
Epoch: 3, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.353 Vali Acc: 0.377 Test Loss: 1.353 Test Acc: 0.377
Validation loss decreased (-0.304334 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.834707498550415
Epoch: 4, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.295 Vali Acc: 0.312 Test Loss: 1.295 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8646852970123291
Epoch: 5, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.229 Vali Acc: 0.457 Test Loss: 1.229 Test Acc: 0.457
Validation loss decreased (-0.376798 --> -0.456509).  Saving model ...
Epoch: 6 cost time: 0.8066020011901855
Epoch: 6, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.171 Vali Acc: 0.507 Test Loss: 1.171 Test Acc: 0.507
Validation loss decreased (-0.456509 --> -0.507235).  Saving model ...
Epoch: 7 cost time: 0.9594459533691406
Epoch: 7, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.127 Vali Acc: 0.478 Test Loss: 1.127 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1401538848876953
Epoch: 8, Steps: 9 | Train Loss: 0.976 Vali Loss: 1.070 Vali Acc: 0.551 Test Loss: 1.070 Test Acc: 0.551
Validation loss decreased (-0.507235 --> -0.550714).  Saving model ...
Epoch: 9 cost time: 0.9770500659942627
Epoch: 9, Steps: 9 | Train Loss: 0.905 Vali Loss: 1.025 Vali Acc: 0.580 Test Loss: 1.025 Test Acc: 0.580
Validation loss decreased (-0.550714 --> -0.579700).  Saving model ...
Epoch: 10 cost time: 0.910057783126831
Epoch: 10, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.977 Vali Acc: 0.522 Test Loss: 0.977 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9936752319335938
Epoch: 11, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.925 Vali Acc: 0.623 Test Loss: 0.925 Test Acc: 0.623
Validation loss decreased (-0.579700 --> -0.623179).  Saving model ...
Epoch: 12 cost time: 0.926720142364502
Epoch: 12, Steps: 9 | Train Loss: 0.663 Vali Loss: 0.877 Vali Acc: 0.630 Test Loss: 0.877 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630426).  Saving model ...
Epoch: 13 cost time: 0.8886141777038574
Epoch: 13, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.843 Vali Acc: 0.667 Test Loss: 0.843 Test Acc: 0.667
Validation loss decreased (-0.630426 --> -0.666658).  Saving model ...
Epoch: 14 cost time: 0.9577286243438721
Epoch: 14, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.806 Vali Acc: 0.674 Test Loss: 0.806 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 15 cost time: 0.9241335391998291
Epoch: 15, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.763 Vali Acc: 0.674 Test Loss: 0.763 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 16 cost time: 0.8891096115112305
Epoch: 16, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.732 Vali Acc: 0.703 Test Loss: 0.732 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 17 cost time: 1.19677734375
Epoch: 17, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 18 cost time: 1.0185046195983887
Epoch: 18, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.721 Vali Acc: 0.710 Test Loss: 0.721 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1784641742706299
Epoch: 19, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 20 cost time: 0.8853528499603271
Epoch: 20, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.677 Vali Acc: 0.725 Test Loss: 0.677 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0385568141937256
Epoch: 21, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 22 cost time: 1.0165791511535645
Epoch: 22, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.677 Vali Acc: 0.725 Test Loss: 0.677 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9486310482025146
Epoch: 23, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 24 cost time: 0.9448297023773193
Epoch: 24, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 25 cost time: 0.901181697845459
Epoch: 25, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.651 Vali Acc: 0.739 Test Loss: 0.651 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9178705215454102
Epoch: 26, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.650 Vali Acc: 0.739 Test Loss: 0.650 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0485990047454834
Epoch: 27, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775356).  Saving model ...
Epoch: 28 cost time: 1.0396790504455566
Epoch: 28, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.625 Vali Acc: 0.739 Test Loss: 0.625 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9039850234985352
Epoch: 29, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.626 Vali Acc: 0.790 Test Loss: 0.626 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 30 cost time: 0.9245405197143555
Epoch: 30, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9329900741577148
Epoch: 31, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9649267196655273
Epoch: 32, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9874053001403809
Epoch: 33, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.628 Vali Acc: 0.790 Test Loss: 0.628 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0916504859924316
Epoch: 34, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9716269969940186
Epoch: 35, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.606 Vali Acc: 0.804 Test Loss: 0.606 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 36 cost time: 1.005885124206543
Epoch: 36, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.600 Vali Acc: 0.790 Test Loss: 0.600 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9447803497314453
Epoch: 37, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.605 Vali Acc: 0.790 Test Loss: 0.605 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.297363519668579
Epoch: 38, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.606 Vali Acc: 0.790 Test Loss: 0.606 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1445057392120361
Epoch: 39, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.620 Vali Acc: 0.790 Test Loss: 0.620 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8395555019378662
Epoch: 40, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.616 Vali Acc: 0.790 Test Loss: 0.616 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9272646903991699
Epoch: 41, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.624 Vali Acc: 0.797 Test Loss: 0.624 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0487096309661865
Epoch: 42, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 43 cost time: 0.9344496726989746
Epoch: 43, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.584 Vali Acc: 0.804 Test Loss: 0.584 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1444799900054932
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9318475723266602
Epoch: 45, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8666675090789795
Epoch: 46, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1260533332824707
Epoch: 47, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9304890632629395
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9679598808288574
Epoch: 49, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0296940803527832
Epoch: 50, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9824872016906738
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0165085792541504
Epoch: 52, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 112860
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4294416904449463
Epoch: 1, Steps: 9 | Train Loss: 1.487 Vali Loss: 1.432 Vali Acc: 0.261 Test Loss: 1.432 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 0.8301708698272705
Epoch: 2, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.404 Vali Acc: 0.348 Test Loss: 1.404 Test Acc: 0.348
Validation loss decreased (-0.260855 --> -0.347812).  Saving model ...
Epoch: 3 cost time: 0.9513394832611084
Epoch: 3, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.359 Vali Acc: 0.341 Test Loss: 1.359 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9128687381744385
Epoch: 4, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.315 Vali Acc: 0.406 Test Loss: 1.315 Test Acc: 0.406
Validation loss decreased (-0.347812 --> -0.405784).  Saving model ...
Epoch: 5 cost time: 0.8719391822814941
Epoch: 5, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.265 Vali Acc: 0.529 Test Loss: 1.265 Test Acc: 0.529
Validation loss decreased (-0.405784 --> -0.528973).  Saving model ...
Epoch: 6 cost time: 0.8804788589477539
Epoch: 6, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.215 Vali Acc: 0.457 Test Loss: 1.215 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8669688701629639
Epoch: 7, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.167 Vali Acc: 0.457 Test Loss: 1.167 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9083435535430908
Epoch: 8, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.118 Vali Acc: 0.565 Test Loss: 1.118 Test Acc: 0.565
Validation loss decreased (-0.528973 --> -0.565206).  Saving model ...
Epoch: 9 cost time: 0.7899398803710938
Epoch: 9, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.076 Vali Acc: 0.507 Test Loss: 1.076 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8049452304840088
Epoch: 10, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0578622817993164
Epoch: 11, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.985 Vali Acc: 0.645 Test Loss: 0.985 Test Acc: 0.645
Validation loss decreased (-0.565206 --> -0.644918).  Saving model ...
Epoch: 12 cost time: 0.9743683338165283
Epoch: 12, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.934 Vali Acc: 0.529 Test Loss: 0.934 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0387122631072998
Epoch: 13, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.880 Vali Acc: 0.659 Test Loss: 0.880 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659411).  Saving model ...
Epoch: 14 cost time: 1.0012423992156982
Epoch: 14, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.848 Vali Acc: 0.652 Test Loss: 0.848 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9764702320098877
Epoch: 15, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.800 Vali Acc: 0.667 Test Loss: 0.800 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666659).  Saving model ...
Epoch: 16 cost time: 1.0225279331207275
Epoch: 16, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.761 Vali Acc: 0.681 Test Loss: 0.761 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681152).  Saving model ...
Epoch: 17 cost time: 0.7832450866699219
Epoch: 17, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.715 Vali Acc: 0.710 Test Loss: 0.715 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 18 cost time: 0.897454023361206
Epoch: 18, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.717 Vali Acc: 0.710 Test Loss: 0.717 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8432941436767578
Epoch: 19, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 20 cost time: 0.8343236446380615
Epoch: 20, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.660 Vali Acc: 0.725 Test Loss: 0.660 Test Acc: 0.725
Validation loss decreased (-0.717385 --> -0.724631).  Saving model ...
Epoch: 21 cost time: 0.9779152870178223
Epoch: 21, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 22 cost time: 1.1261019706726074
Epoch: 22, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.644 Vali Acc: 0.717 Test Loss: 0.644 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0771114826202393
Epoch: 23, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8960394859313965
Epoch: 24, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 25 cost time: 0.9595301151275635
Epoch: 25, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8581657409667969
Epoch: 26, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2860188484191895
Epoch: 27, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.591 Vali Acc: 0.754 Test Loss: 0.591 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 28 cost time: 0.9888858795166016
Epoch: 28, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.569 Vali Acc: 0.754 Test Loss: 0.569 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 29 cost time: 1.0013575553894043
Epoch: 29, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.597 Vali Acc: 0.768 Test Loss: 0.597 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 30 cost time: 1.1808009147644043
Epoch: 30, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0697906017303467
Epoch: 31, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 32 cost time: 0.9194462299346924
Epoch: 32, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.569 Vali Acc: 0.790 Test Loss: 0.569 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789849).  Saving model ...
Epoch: 33 cost time: 0.910386323928833
Epoch: 33, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.553 Vali Acc: 0.804 Test Loss: 0.553 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 34 cost time: 0.8828527927398682
Epoch: 34, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.577 Vali Acc: 0.797 Test Loss: 0.577 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9567923545837402
Epoch: 35, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0804283618927002
Epoch: 36, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0318870544433594
Epoch: 37, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 38 cost time: 1.0975770950317383
Epoch: 38, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1287343502044678
Epoch: 39, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 40 cost time: 1.1380960941314697
Epoch: 40, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 41 cost time: 1.2312908172607422
Epoch: 41, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 42 cost time: 0.979729413986206
Epoch: 42, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0181879997253418
Epoch: 43, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8789374828338623
Epoch: 44, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.945270299911499
Epoch: 45, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 46 cost time: 0.7801597118377686
Epoch: 46, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 47 cost time: 1.0345954895019531
Epoch: 47, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0858304500579834
Epoch: 48, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9608762264251709
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 50 cost time: 0.8836812973022461
Epoch: 50, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9309582710266113
Epoch: 51, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 52 cost time: 0.9853050708770752
Epoch: 52, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 53 cost time: 1.0643157958984375
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1177756786346436
Epoch: 54, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9972071647644043
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 56 cost time: 1.0412437915802002
Epoch: 56, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9992074966430664
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.235945701599121
Epoch: 58, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1254546642303467
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8185603618621826
Epoch: 60, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9199385643005371
Epoch: 61, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 62 cost time: 1.1196165084838867
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 63 cost time: 0.8569011688232422
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 64 cost time: 1.0964562892913818
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0368740558624268
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.045853614807129
Epoch: 66, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 67 cost time: 1.0275135040283203
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 68 cost time: 0.9944925308227539
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.811255931854248
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.0727825164794922
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9813263416290283
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 72 cost time: 0.967099666595459
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.1541974544525146
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.0365548133850098
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.8562502861022949
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.884 Test Loss: 0.438 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9325056076049805
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.8659453392028809
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.0286648273468018
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.9412662982940674
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.9774892330169678
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.884 Test Loss: 0.427 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 81 cost time: 0.8236989974975586
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 82 cost time: 1.0048809051513672
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9981510639190674
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.0140645503997803
Epoch: 84, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8254988193511963
Epoch: 85, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.891 Test Loss: 0.428 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 86 cost time: 0.8861191272735596
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7699747085571289
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.884 Test Loss: 0.453 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.140320062637329
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.9325852394104004
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.1651132106781006
Epoch: 90, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.0652098655700684
Epoch: 91, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.9232180118560791
Epoch: 92, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.8679065704345703
Epoch: 93, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.8579075336456299
Epoch: 94, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.9665594100952148
Epoch: 95, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 112284
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8924734592437744
Epoch: 1, Steps: 9 | Train Loss: 1.483 Vali Loss: 1.439 Vali Acc: 0.297 Test Loss: 1.439 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 0.9851779937744141
Epoch: 2, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.396 Vali Acc: 0.333 Test Loss: 1.396 Test Acc: 0.333
Validation loss decreased (-0.297087 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 0.9843719005584717
Epoch: 3, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.350 Vali Acc: 0.333 Test Loss: 1.350 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.9083311557769775
Epoch: 4, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.305 Vali Acc: 0.370 Test Loss: 1.305 Test Acc: 0.370
Validation loss decreased (-0.333320 --> -0.369552).  Saving model ...
Epoch: 5 cost time: 0.8420200347900391
Epoch: 5, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.271 Vali Acc: 0.464 Test Loss: 1.271 Test Acc: 0.464
Validation loss decreased (-0.369552 --> -0.463755).  Saving model ...
Epoch: 6 cost time: 0.8216898441314697
Epoch: 6, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.229 Vali Acc: 0.478 Test Loss: 1.229 Test Acc: 0.478
Validation loss decreased (-0.463755 --> -0.478249).  Saving model ...
Epoch: 7 cost time: 0.8840022087097168
Epoch: 7, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.171 Vali Acc: 0.449 Test Loss: 1.171 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8285741806030273
Epoch: 8, Steps: 9 | Train Loss: 1.056 Vali Loss: 1.116 Vali Acc: 0.565 Test Loss: 1.116 Test Acc: 0.565
Validation loss decreased (-0.478249 --> -0.565206).  Saving model ...
Epoch: 9 cost time: 0.8515856266021729
Epoch: 9, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.070 Vali Acc: 0.572 Test Loss: 1.070 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572453).  Saving model ...
Epoch: 10 cost time: 0.9021625518798828
Epoch: 10, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.012 Vali Acc: 0.587 Test Loss: 1.012 Test Acc: 0.587
Validation loss decreased (-0.572453 --> -0.586946).  Saving model ...
Epoch: 11 cost time: 0.8881616592407227
Epoch: 11, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.962 Vali Acc: 0.587 Test Loss: 0.962 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 12 cost time: 0.9820277690887451
Epoch: 12, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.914 Vali Acc: 0.630 Test Loss: 0.914 Test Acc: 0.630
Validation loss decreased (-0.586947 --> -0.630426).  Saving model ...
Epoch: 13 cost time: 0.9914031028747559
Epoch: 13, Steps: 9 | Train Loss: 0.713 Vali Loss: 0.868 Vali Acc: 0.616 Test Loss: 0.868 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9328484535217285
Epoch: 14, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.846 Vali Acc: 0.667 Test Loss: 0.846 Test Acc: 0.667
Validation loss decreased (-0.630426 --> -0.666658).  Saving model ...
Epoch: 15 cost time: 0.8111460208892822
Epoch: 15, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.806 Vali Acc: 0.674 Test Loss: 0.806 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 16 cost time: 0.785982608795166
Epoch: 16, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.776 Vali Acc: 0.674 Test Loss: 0.776 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 17 cost time: 1.1841506958007812
Epoch: 17, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.750 Vali Acc: 0.696 Test Loss: 0.750 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 0.7847793102264404
Epoch: 18, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.718 Vali Acc: 0.688 Test Loss: 0.718 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0122652053833008
Epoch: 19, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.687 Vali Acc: 0.703 Test Loss: 0.687 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702892).  Saving model ...
Epoch: 20 cost time: 0.7140238285064697
Epoch: 20, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
Validation loss decreased (-0.702892 --> -0.717385).  Saving model ...
Epoch: 21 cost time: 0.7964560985565186
Epoch: 21, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.684 Vali Acc: 0.710 Test Loss: 0.684 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8754065036773682
Epoch: 22, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.649 Vali Acc: 0.710 Test Loss: 0.649 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9377758502960205
Epoch: 23, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.658 Vali Acc: 0.703 Test Loss: 0.658 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.896446704864502
Epoch: 24, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
Validation loss decreased (-0.717385 --> -0.717385).  Saving model ...
Epoch: 25 cost time: 0.853351354598999
Epoch: 25, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
Validation loss decreased (-0.717385 --> -0.731878).  Saving model ...
Epoch: 26 cost time: 0.8989758491516113
Epoch: 26, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.625 Vali Acc: 0.739 Test Loss: 0.625 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739124).  Saving model ...
Epoch: 27 cost time: 0.8714187145233154
Epoch: 27, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8738131523132324
Epoch: 28, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.612 Vali Acc: 0.739 Test Loss: 0.612 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 29 cost time: 0.8904094696044922
Epoch: 29, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 30 cost time: 0.9446384906768799
Epoch: 30, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.620 Vali Acc: 0.725 Test Loss: 0.620 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8541088104248047
Epoch: 31, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8422937393188477
Epoch: 32, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760864).  Saving model ...
Epoch: 33 cost time: 0.873671293258667
Epoch: 33, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.601 Vali Acc: 0.754 Test Loss: 0.601 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8237464427947998
Epoch: 34, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775356).  Saving model ...
Epoch: 35 cost time: 0.9352223873138428
Epoch: 35, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9861853122711182
Epoch: 36, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.589 Vali Acc: 0.754 Test Loss: 0.589 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.052027702331543
Epoch: 37, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.560 Vali Acc: 0.768 Test Loss: 0.560 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9235033988952637
Epoch: 38, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 39 cost time: 0.9711182117462158
Epoch: 39, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.092827320098877
Epoch: 40, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.563 Vali Acc: 0.790 Test Loss: 0.563 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 41 cost time: 0.9037156105041504
Epoch: 41, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.804 Test Loss: 0.552 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 42 cost time: 0.8281829357147217
Epoch: 42, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.546 Vali Acc: 0.804 Test Loss: 0.546 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 43 cost time: 0.8762738704681396
Epoch: 43, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.910956621170044
Epoch: 44, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7108242511749268
Epoch: 45, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 46 cost time: 0.8136601448059082
Epoch: 46, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.804 Test Loss: 0.545 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7816345691680908
Epoch: 47, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.529 Vali Acc: 0.804 Test Loss: 0.529 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.942305326461792
Epoch: 48, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 49 cost time: 1.0881569385528564
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9933662414550781
Epoch: 50, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8465964794158936
Epoch: 51, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 52 cost time: 0.9350497722625732
Epoch: 52, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0032804012298584
Epoch: 53, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9551980495452881
Epoch: 54, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9302835464477539
Epoch: 55, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1383476257324219
Epoch: 56, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9245166778564453
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0041682720184326
Epoch: 58, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 59 cost time: 0.9732239246368408
Epoch: 59, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8140485286712646
Epoch: 60, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9278616905212402
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8601231575012207
Epoch: 62, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1738619804382324
Epoch: 63, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7848930358886719
Epoch: 64, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.566 Vali Acc: 0.826 Test Loss: 0.566 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8939199447631836
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 66 cost time: 0.8803839683532715
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9282701015472412
Epoch: 67, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0069079399108887
Epoch: 68, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 69 cost time: 0.9047448635101318
Epoch: 69, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 70 cost time: 0.9001257419586182
Epoch: 70, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8012025356292725
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9017689228057861
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 73 cost time: 0.8461787700653076
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 74 cost time: 0.9679419994354248
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9285962581634521
Epoch: 75, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8749170303344727
Epoch: 76, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9012250900268555
Epoch: 77, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.9000823497772217
Epoch: 78, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.841 Test Loss: 0.579 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.79298996925354
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.8648900985717773
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.9306697845458984
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.9521234035491943
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.0094995498657227
Epoch: 83, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 89052
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.320573568344116
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.409 Vali Acc: 0.217 Test Loss: 1.409 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 0.7495272159576416
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.365 Vali Acc: 0.377 Test Loss: 1.365 Test Acc: 0.377
Validation loss decreased (-0.217377 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.8881289958953857
Epoch: 3, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.336 Vali Acc: 0.370 Test Loss: 1.336 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9724500179290771
Epoch: 4, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.306 Vali Acc: 0.428 Test Loss: 1.306 Test Acc: 0.428
Validation loss decreased (-0.376798 --> -0.427523).  Saving model ...
Epoch: 5 cost time: 0.79306960105896
Epoch: 5, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.256 Vali Acc: 0.391 Test Loss: 1.256 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8956224918365479
Epoch: 6, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.208 Vali Acc: 0.413 Test Loss: 1.208 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9078731536865234
Epoch: 7, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.164 Vali Acc: 0.457 Test Loss: 1.164 Test Acc: 0.457
Validation loss decreased (-0.427523 --> -0.456510).  Saving model ...
Epoch: 8 cost time: 0.9432871341705322
Epoch: 8, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.111 Vali Acc: 0.471 Test Loss: 1.111 Test Acc: 0.471
Validation loss decreased (-0.456510 --> -0.471003).  Saving model ...
Epoch: 9 cost time: 0.9615449905395508
Epoch: 9, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.070 Vali Acc: 0.478 Test Loss: 1.070 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478250).  Saving model ...
Epoch: 10 cost time: 0.7909939289093018
Epoch: 10, Steps: 9 | Train Loss: 0.923 Vali Loss: 1.025 Vali Acc: 0.572 Test Loss: 1.025 Test Acc: 0.572
Validation loss decreased (-0.478250 --> -0.572454).  Saving model ...
Epoch: 11 cost time: 0.8648660182952881
Epoch: 11, Steps: 9 | Train Loss: 0.853 Vali Loss: 0.968 Vali Acc: 0.580 Test Loss: 0.968 Test Acc: 0.580
Validation loss decreased (-0.572454 --> -0.579700).  Saving model ...
Epoch: 12 cost time: 0.8027451038360596
Epoch: 12, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.930 Vali Acc: 0.601 Test Loss: 0.930 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601440).  Saving model ...
Epoch: 13 cost time: 0.8090040683746338
Epoch: 13, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.892 Vali Acc: 0.616 Test Loss: 0.892 Test Acc: 0.616
Validation loss decreased (-0.601440 --> -0.615933).  Saving model ...
Epoch: 14 cost time: 0.8764739036560059
Epoch: 14, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.838 Vali Acc: 0.645 Test Loss: 0.838 Test Acc: 0.645
Validation loss decreased (-0.615933 --> -0.644919).  Saving model ...
Epoch: 15 cost time: 0.7781407833099365
Epoch: 15, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.811 Vali Acc: 0.645 Test Loss: 0.811 Test Acc: 0.645
Validation loss decreased (-0.644919 --> -0.644919).  Saving model ...
Epoch: 16 cost time: 1.041731357574463
Epoch: 16, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.779 Vali Acc: 0.696 Test Loss: 0.779 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695644).  Saving model ...
Epoch: 17 cost time: 0.9050197601318359
Epoch: 17, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.731 Vali Acc: 0.652 Test Loss: 0.731 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0106191635131836
Epoch: 18, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.691 Vali Acc: 0.732 Test Loss: 0.691 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 19 cost time: 0.773064136505127
Epoch: 19, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731877).  Saving model ...
Epoch: 20 cost time: 0.893186092376709
Epoch: 20, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 21 cost time: 1.128549575805664
Epoch: 21, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9664380550384521
Epoch: 22, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.655 Vali Acc: 0.703 Test Loss: 0.655 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9452931880950928
Epoch: 23, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.622 Vali Acc: 0.739 Test Loss: 0.622 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 24 cost time: 0.9608261585235596
Epoch: 24, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.632 Vali Acc: 0.725 Test Loss: 0.632 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7541804313659668
Epoch: 25, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.601 Vali Acc: 0.739 Test Loss: 0.601 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 26 cost time: 0.857048511505127
Epoch: 26, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.614 Vali Acc: 0.739 Test Loss: 0.614 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8096218109130859
Epoch: 27, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.588 Vali Acc: 0.754 Test Loss: 0.588 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 28 cost time: 0.8911757469177246
Epoch: 28, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7095568180084229
Epoch: 29, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 30 cost time: 0.9065263271331787
Epoch: 30, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.559 Vali Acc: 0.768 Test Loss: 0.559 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 31 cost time: 0.7181448936462402
Epoch: 31, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775356).  Saving model ...
Epoch: 32 cost time: 0.8122730255126953
Epoch: 32, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9463531970977783
Epoch: 33, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.565 Vali Acc: 0.790 Test Loss: 0.565 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 34 cost time: 0.8975317478179932
Epoch: 34, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7415835857391357
Epoch: 35, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 36 cost time: 0.770132303237915
Epoch: 36, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7534327507019043
Epoch: 37, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7684569358825684
Epoch: 38, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8371264934539795
Epoch: 39, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7380034923553467
Epoch: 40, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 41 cost time: 0.8419101238250732
Epoch: 41, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.546 Vali Acc: 0.797 Test Loss: 0.546 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9207508563995361
Epoch: 42, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8814256191253662
Epoch: 43, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6848702430725098
Epoch: 44, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8817989826202393
Epoch: 45, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.931298017501831
Epoch: 46, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0004525184631348
Epoch: 47, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8350565433502197
Epoch: 48, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7658021450042725
Epoch: 49, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8928709030151367
Epoch: 50, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.812 Test Loss: 0.512 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 88476
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4606032371520996
Epoch: 1, Steps: 9 | Train Loss: 1.974 Vali Loss: 1.692 Vali Acc: 0.217 Test Loss: 1.692 Test Acc: 0.217
Validation loss decreased (inf --> -0.217374).  Saving model ...
Epoch: 2 cost time: 0.8325774669647217
Epoch: 2, Steps: 9 | Train Loss: 1.579 Vali Loss: 1.455 Vali Acc: 0.188 Test Loss: 1.455 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0979321002960205
Epoch: 3, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.434 Vali Acc: 0.326 Test Loss: 1.434 Test Acc: 0.326
Validation loss decreased (-0.217374 --> -0.326073).  Saving model ...
Epoch: 4 cost time: 0.9320838451385498
Epoch: 4, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
Validation loss decreased (-0.326073 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.8790116310119629
Epoch: 5, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.296 Vali Acc: 0.399 Test Loss: 1.296 Test Acc: 0.399
Validation loss decreased (-0.333320 --> -0.398538).  Saving model ...
Epoch: 6 cost time: 0.8432483673095703
Epoch: 6, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.241 Vali Acc: 0.435 Test Loss: 1.241 Test Acc: 0.435
Validation loss decreased (-0.398538 --> -0.434770).  Saving model ...
Epoch: 7 cost time: 0.7595112323760986
Epoch: 7, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.182 Vali Acc: 0.536 Test Loss: 1.182 Test Acc: 0.536
Validation loss decreased (-0.434770 --> -0.536220).  Saving model ...
Epoch: 8 cost time: 0.7533636093139648
Epoch: 8, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.127 Vali Acc: 0.471 Test Loss: 1.127 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9783182144165039
Epoch: 9, Steps: 9 | Train Loss: 0.989 Vali Loss: 1.074 Vali Acc: 0.551 Test Loss: 1.074 Test Acc: 0.551
Validation loss decreased (-0.536220 --> -0.550714).  Saving model ...
Epoch: 10 cost time: 0.8210031986236572
Epoch: 10, Steps: 9 | Train Loss: 0.927 Vali Loss: 1.024 Vali Acc: 0.580 Test Loss: 1.024 Test Acc: 0.580
Validation loss decreased (-0.550714 --> -0.579700).  Saving model ...
Epoch: 11 cost time: 0.9395942687988281
Epoch: 11, Steps: 9 | Train Loss: 0.864 Vali Loss: 0.986 Vali Acc: 0.594 Test Loss: 0.986 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 12 cost time: 0.9713857173919678
Epoch: 12, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.947 Vali Acc: 0.529 Test Loss: 0.947 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9930319786071777
Epoch: 13, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.895 Vali Acc: 0.645 Test Loss: 0.895 Test Acc: 0.645
Validation loss decreased (-0.594193 --> -0.644919).  Saving model ...
Epoch: 14 cost time: 0.9744293689727783
Epoch: 14, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.870 Vali Acc: 0.638 Test Loss: 0.870 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9174737930297852
Epoch: 15, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.812 Vali Acc: 0.703 Test Loss: 0.812 Test Acc: 0.703
Validation loss decreased (-0.644919 --> -0.702890).  Saving model ...
Epoch: 16 cost time: 1.0311996936798096
Epoch: 16, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.809 Vali Acc: 0.681 Test Loss: 0.809 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9491839408874512
Epoch: 17, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.758 Vali Acc: 0.674 Test Loss: 0.758 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0222065448760986
Epoch: 18, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.712 Vali Acc: 0.703 Test Loss: 0.712 Test Acc: 0.703
Validation loss decreased (-0.702890 --> -0.702891).  Saving model ...
Epoch: 19 cost time: 1.1773951053619385
Epoch: 19, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 20 cost time: 1.0903348922729492
Epoch: 20, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.095933198928833
Epoch: 21, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.672 Vali Acc: 0.725 Test Loss: 0.672 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 22 cost time: 0.9717724323272705
Epoch: 22, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.671 Vali Acc: 0.746 Test Loss: 0.671 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 23 cost time: 0.8456165790557861
Epoch: 23, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.088388442993164
Epoch: 24, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.069962739944458
Epoch: 25, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.636 Vali Acc: 0.739 Test Loss: 0.636 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.350708246231079
Epoch: 26, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.632 Vali Acc: 0.739 Test Loss: 0.632 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8710081577301025
Epoch: 27, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.600 Vali Acc: 0.768 Test Loss: 0.600 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 28 cost time: 0.9701905250549316
Epoch: 28, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9412193298339844
Epoch: 29, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.594 Vali Acc: 0.754 Test Loss: 0.594 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8764259815216064
Epoch: 30, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.625 Vali Acc: 0.768 Test Loss: 0.625 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9669404029846191
Epoch: 31, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.622 Vali Acc: 0.739 Test Loss: 0.622 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0047569274902344
Epoch: 32, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 33 cost time: 1.3335793018341064
Epoch: 33, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9332318305969238
Epoch: 34, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.602 Vali Acc: 0.768 Test Loss: 0.602 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.090313196182251
Epoch: 35, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 36 cost time: 0.8177528381347656
Epoch: 36, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3288726806640625
Epoch: 37, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1798686981201172
Epoch: 38, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 39 cost time: 0.9432597160339355
Epoch: 39, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.561 Vali Acc: 0.797 Test Loss: 0.561 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9464008808135986
Epoch: 40, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 41 cost time: 1.08327054977417
Epoch: 41, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0561563968658447
Epoch: 42, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.554 Vali Acc: 0.812 Test Loss: 0.554 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1365578174591064
Epoch: 43, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 44 cost time: 1.193222999572754
Epoch: 44, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 45 cost time: 1.3001797199249268
Epoch: 45, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 0.9000921249389648
Epoch: 46, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 47 cost time: 0.8538854122161865
Epoch: 47, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9056189060211182
Epoch: 48, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9741673469543457
Epoch: 49, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 50 cost time: 1.0939793586730957
Epoch: 50, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0092015266418457
Epoch: 51, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.01186203956604
Epoch: 52, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8565068244934082
Epoch: 53, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8271498680114746
Epoch: 54, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1683027744293213
Epoch: 55, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.962632417678833
Epoch: 56, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.935999870300293
Epoch: 57, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 58 cost time: 0.892012357711792
Epoch: 58, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 59 cost time: 1.0432655811309814
Epoch: 59, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9866492748260498
Epoch: 60, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1610238552093506
Epoch: 61, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0568583011627197
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1298770904541016
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8757624626159668
Epoch: 64, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 65 cost time: 1.158031940460205
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9037668704986572
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8991377353668213
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.2789812088012695
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 69 cost time: 0.9654700756072998
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0368661880493164
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 71 cost time: 0.9402139186859131
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9608132839202881
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 73 cost time: 0.8000378608703613
Epoch: 73, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 74 cost time: 0.9399292469024658
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1672735214233398
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.018894910812378
Epoch: 76, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9789721965789795
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 78 cost time: 1.060577630996704
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9198706150054932
Epoch: 79, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.0042188167572021
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.0331859588623047
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.9514491558074951
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 83 cost time: 0.9729244709014893
Epoch: 83, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.220836877822876
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.0994837284088135
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.0989549160003662
Epoch: 86, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.1651737689971924
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 88 cost time: 0.9874801635742188
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 89 cost time: 0.9936137199401855
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8744668960571289
Epoch: 90, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9755122661590576
Epoch: 91, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.0405056476593018
Epoch: 92, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.4043316841125488
Epoch: 93, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.0444843769073486
Epoch: 94, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.9907236099243164
Epoch: 95, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.9449992179870605
Epoch: 96, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.0072665214538574
Epoch: 97, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 98 cost time: 0.8345451354980469
Epoch: 98, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8688516616821289
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 100 cost time: 1.076310634613037
Epoch: 100, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 87900
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.701774835586548
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.366 Vali Acc: 0.297 Test Loss: 1.366 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.826056957244873
Epoch: 2, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.342 Vali Acc: 0.355 Test Loss: 1.342 Test Acc: 0.355
Validation loss decreased (-0.297088 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.9384725093841553
Epoch: 3, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.312 Vali Acc: 0.449 Test Loss: 1.312 Test Acc: 0.449
Validation loss decreased (-0.355059 --> -0.449262).  Saving model ...
Epoch: 4 cost time: 0.9074227809906006
Epoch: 4, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.266 Vali Acc: 0.449 Test Loss: 1.266 Test Acc: 0.449
Validation loss decreased (-0.449262 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 1.1048784255981445
Epoch: 5, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.449263 --> -0.485495).  Saving model ...
Epoch: 6 cost time: 1.052269697189331
Epoch: 6, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.177 Vali Acc: 0.572 Test Loss: 1.177 Test Acc: 0.572
Validation loss decreased (-0.485495 --> -0.572452).  Saving model ...
Epoch: 7 cost time: 0.7917194366455078
Epoch: 7, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.140 Vali Acc: 0.478 Test Loss: 1.140 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9832038879394531
Epoch: 8, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.101 Vali Acc: 0.558 Test Loss: 1.101 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.889268159866333
Epoch: 9, Steps: 9 | Train Loss: 0.941 Vali Loss: 1.049 Vali Acc: 0.616 Test Loss: 1.049 Test Acc: 0.616
Validation loss decreased (-0.572452 --> -0.615932).  Saving model ...
Epoch: 10 cost time: 0.9561543464660645
Epoch: 10, Steps: 9 | Train Loss: 0.888 Vali Loss: 1.008 Vali Acc: 0.594 Test Loss: 1.008 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1748430728912354
Epoch: 11, Steps: 9 | Train Loss: 0.807 Vali Loss: 0.965 Vali Acc: 0.551 Test Loss: 0.965 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.207045316696167
Epoch: 12, Steps: 9 | Train Loss: 0.733 Vali Loss: 0.916 Vali Acc: 0.616 Test Loss: 0.916 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615933).  Saving model ...
Epoch: 13 cost time: 1.088402509689331
Epoch: 13, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.869 Vali Acc: 0.638 Test Loss: 0.869 Test Acc: 0.638
Validation loss decreased (-0.615933 --> -0.637672).  Saving model ...
Epoch: 14 cost time: 1.053257942199707
Epoch: 14, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.840 Vali Acc: 0.688 Test Loss: 0.840 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688397).  Saving model ...
Epoch: 15 cost time: 0.8777687549591064
Epoch: 15, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.831 Vali Acc: 0.638 Test Loss: 0.831 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1143200397491455
Epoch: 16, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.777 Vali Acc: 0.703 Test Loss: 0.777 Test Acc: 0.703
Validation loss decreased (-0.688397 --> -0.702891).  Saving model ...
Epoch: 17 cost time: 0.8452122211456299
Epoch: 17, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.765 Vali Acc: 0.703 Test Loss: 0.765 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 18 cost time: 0.9364438056945801
Epoch: 18, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.726 Vali Acc: 0.732 Test Loss: 0.726 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 19 cost time: 0.9662277698516846
Epoch: 19, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.706 Vali Acc: 0.710 Test Loss: 0.706 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.352388620376587
Epoch: 20, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 21 cost time: 0.9629354476928711
Epoch: 21, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.659 Vali Acc: 0.746 Test Loss: 0.659 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2411603927612305
Epoch: 22, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.648 Vali Acc: 0.754 Test Loss: 0.648 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3044140338897705
Epoch: 23, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.637 Vali Acc: 0.754 Test Loss: 0.637 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9603462219238281
Epoch: 24, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0794341564178467
Epoch: 25, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.614 Vali Acc: 0.739 Test Loss: 0.614 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8610353469848633
Epoch: 26, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9132368564605713
Epoch: 27, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1472318172454834
Epoch: 28, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 29 cost time: 1.1409399509429932
Epoch: 29, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2583727836608887
Epoch: 30, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.585 Vali Acc: 0.739 Test Loss: 0.585 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9726839065551758
Epoch: 31, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.598 Vali Acc: 0.790 Test Loss: 0.598 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 32 cost time: 1.129591703414917
Epoch: 32, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.570 Vali Acc: 0.797 Test Loss: 0.570 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 33 cost time: 0.9260318279266357
Epoch: 33, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.579 Vali Acc: 0.768 Test Loss: 0.579 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.925180196762085
Epoch: 34, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.569 Vali Acc: 0.797 Test Loss: 0.569 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 35 cost time: 0.9189944267272949
Epoch: 35, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8148200511932373
Epoch: 36, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 37 cost time: 1.0290751457214355
Epoch: 37, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9168951511383057
Epoch: 38, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.573 Vali Acc: 0.790 Test Loss: 0.573 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9410190582275391
Epoch: 39, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.572 Vali Acc: 0.804 Test Loss: 0.572 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9888086318969727
Epoch: 40, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.532 Vali Acc: 0.790 Test Loss: 0.532 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0364065170288086
Epoch: 41, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8125805854797363
Epoch: 42, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.921090841293335
Epoch: 43, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 44 cost time: 0.8259551525115967
Epoch: 44, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.527 Vali Acc: 0.797 Test Loss: 0.527 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9865851402282715
Epoch: 45, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 46 cost time: 1.1665754318237305
Epoch: 46, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 47 cost time: 0.930534839630127
Epoch: 47, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.100252628326416
Epoch: 48, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 49 cost time: 1.1034266948699951
Epoch: 49, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0207605361938477
Epoch: 50, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 51 cost time: 0.773052453994751
Epoch: 51, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.01881742477417
Epoch: 52, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9661655426025391
Epoch: 53, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 54 cost time: 0.9397053718566895
Epoch: 54, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2476143836975098
Epoch: 55, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 56 cost time: 0.9253172874450684
Epoch: 56, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1417369842529297
Epoch: 57, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 58 cost time: 0.8632197380065918
Epoch: 58, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 59 cost time: 0.8666553497314453
Epoch: 59, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9445254802703857
Epoch: 60, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 61 cost time: 0.9695215225219727
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 62 cost time: 1.0317630767822266
Epoch: 62, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0623981952667236
Epoch: 63, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9327552318572998
Epoch: 64, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1117501258850098
Epoch: 65, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 66 cost time: 0.8518266677856445
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8251745700836182
Epoch: 67, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1353776454925537
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1065523624420166
Epoch: 69, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 70 cost time: 1.0633258819580078
Epoch: 70, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.0893487930297852
Epoch: 71, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9881813526153564
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.0803866386413574
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 74 cost time: 0.9911787509918213
Epoch: 74, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9076027870178223
Epoch: 75, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8997149467468262
Epoch: 76, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9716148376464844
Epoch: 77, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8348169326782227
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.1161999702453613
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.8721907138824463
Epoch: 80, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.092296838760376
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.0585896968841553
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.7909832000732422
Epoch: 83, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_Crossformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 87324
model size : 1.01MB
